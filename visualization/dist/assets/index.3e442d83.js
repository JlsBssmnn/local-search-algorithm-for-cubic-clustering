var p0=Object.defineProperty;var d0=(rr,ar,v)=>ar in rr?p0(rr,ar,{enumerable:!0,configurable:!0,writable:!0,value:v}):rr[ar]=v;var Uc=(rr,ar,v)=>(d0(rr,typeof ar!="symbol"?ar+"":ar,v),v);(function(){const ar=document.createElement("link").relList;if(ar&&ar.supports&&ar.supports("modulepreload"))return;for(const Z of document.querySelectorAll('link[rel="modulepreload"]'))J(Z);new MutationObserver(Z=>{for(const p of Z)if(p.type==="childList")for(const g of p.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&J(g)}).observe(document,{childList:!0,subtree:!0});function v(Z){const p={};return Z.integrity&&(p.integrity=Z.integrity),Z.referrerpolicy&&(p.referrerPolicy=Z.referrerpolicy),Z.crossorigin==="use-credentials"?p.credentials="include":Z.crossorigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function J(Z){if(Z.ep)return;Z.ep=!0;const p=v(Z);fetch(Z.href,p)}})();function Ss(){}const wp=rr=>rr;function Tp(rr){return rr()}function ip(){return Object.create(null)}function sl(rr){rr.forEach(Tp)}function kp(rr){return typeof rr=="function"}function Nl(rr,ar){return rr!=rr?ar==ar:rr!==ar||rr&&typeof rr=="object"||typeof rr=="function"}function m0(rr){return Object.keys(rr).length===0}const Mp=typeof window<"u";let g0=Mp?()=>window.performance.now():()=>Date.now(),Pf=Mp?rr=>requestAnimationFrame(rr):Ss;const mc=new Set;function Ap(rr){mc.forEach(ar=>{ar.c(rr)||(mc.delete(ar),ar.f())}),mc.size!==0&&Pf(Ap)}function v0(rr){let ar;return mc.size===0&&Pf(Ap),{promise:new Promise(v=>{mc.add(ar={c:rr,f:v})}),abort(){mc.delete(ar)}}}function Ga(rr,ar){rr.appendChild(ar)}function Sp(rr){if(!rr)return document;const ar=rr.getRootNode?rr.getRootNode():rr.ownerDocument;return ar&&ar.host?ar:rr.ownerDocument}function y0(rr){const ar=fi("style");return x0(Sp(rr),ar),ar.sheet}function x0(rr,ar){return Ga(rr.head||rr,ar),ar.sheet}function xo(rr,ar,v){rr.insertBefore(ar,v||null)}function $i(rr){rr.parentNode.removeChild(rr)}function If(rr,ar){for(let v=0;v<rr.length;v+=1)rr[v]&&rr[v].d(ar)}function fi(rr){return document.createElement(rr)}function us(rr){return document.createTextNode(rr)}function gs(){return us(" ")}function Ep(){return us("")}function bl(rr,ar,v,J){return rr.addEventListener(ar,v,J),()=>rr.removeEventListener(ar,v,J)}function li(rr,ar,v){v==null?rr.removeAttribute(ar):rr.getAttribute(ar)!==v&&rr.setAttribute(ar,v)}function Ef(rr){return rr===""?null:+rr}function b0(rr){return Array.from(rr.childNodes)}function Bl(rr,ar){ar=""+ar,rr.wholeText!==ar&&(rr.data=ar)}function Cu(rr,ar){rr.value=ar==null?"":ar}function _0(rr,ar,v,J){v===null?rr.style.removeProperty(ar):rr.style.setProperty(ar,v,J?"important":"")}function op(rr,ar){for(let v=0;v<rr.options.length;v+=1){const J=rr.options[v];if(J.__value===ar){J.selected=!0;return}}rr.selectedIndex=-1}function w0(rr){const ar=rr.querySelector(":checked")||rr.options[0];return ar&&ar.__value}function Lp(rr,ar,{bubbles:v=!1,cancelable:J=!1}={}){const Z=document.createEvent("CustomEvent");return Z.initCustomEvent(rr,v,J,ar),Z}const Du=new Map;let Ru=0;function T0(rr){let ar=5381,v=rr.length;for(;v--;)ar=(ar<<5)-ar^rr.charCodeAt(v);return ar>>>0}function k0(rr,ar){const v={stylesheet:y0(ar),rules:{}};return Du.set(rr,v),v}function sp(rr,ar,v,J,Z,p,g,b=0){const y=16.666/J;let e=`{
`;for(let i=0;i<=1;i+=y){const u=ar+(v-ar)*p(i);e+=i*100+`%{${g(u,1-u)}}
`}const n=e+`100% {${g(v,1-v)}}
}`,t=`__svelte_${T0(n)}_${b}`,a=Sp(rr),{stylesheet:r,rules:m}=Du.get(a)||k0(a,rr);m[t]||(m[t]=!0,r.insertRule(`@keyframes ${t} ${n}`,r.cssRules.length));const o=rr.style.animation||"";return rr.style.animation=`${o?`${o}, `:""}${t} ${J}ms linear ${Z}ms 1 both`,Ru+=1,t}function M0(rr,ar){const v=(rr.style.animation||"").split(", "),J=v.filter(ar?p=>p.indexOf(ar)<0:p=>p.indexOf("__svelte")===-1),Z=v.length-J.length;Z&&(rr.style.animation=J.join(", "),Ru-=Z,Ru||A0())}function A0(){Pf(()=>{Ru||(Du.forEach(rr=>{const{ownerNode:ar}=rr.stylesheet;ar&&$i(ar)}),Du.clear())})}let Yc;function qc(rr){Yc=rr}function Cp(){if(!Yc)throw new Error("Function called outside component initialization");return Yc}function S0(rr){Cp().$$.on_mount.push(rr)}function Pp(){const rr=Cp();return(ar,v,{cancelable:J=!1}={})=>{const Z=rr.$$.callbacks[ar];if(Z){const p=Lp(ar,v,{cancelable:J});return Z.slice().forEach(g=>{g.call(rr,p)}),!p.defaultPrevented}return!0}}const Hc=[],gc=[],Ou=[],Lf=[],Ip=Promise.resolve();let Cf=!1;function Op(){Cf||(Cf=!0,Ip.then(zp))}function E0(){return Op(),Ip}function vc(rr){Ou.push(rr)}function wf(rr){Lf.push(rr)}const Tf=new Set;let Pu=0;function zp(){const rr=Yc;do{for(;Pu<Hc.length;){const ar=Hc[Pu];Pu++,qc(ar),L0(ar.$$)}for(qc(null),Hc.length=0,Pu=0;gc.length;)gc.pop()();for(let ar=0;ar<Ou.length;ar+=1){const v=Ou[ar];Tf.has(v)||(Tf.add(v),v())}Ou.length=0}while(Hc.length);for(;Lf.length;)Lf.pop()();Cf=!1,Tf.clear(),qc(rr)}function L0(rr){if(rr.fragment!==null){rr.update(),sl(rr.before_update);const ar=rr.dirty;rr.dirty=[-1],rr.fragment&&rr.fragment.p(rr.ctx,ar),rr.after_update.forEach(vc)}}let Vc;function C0(){return Vc||(Vc=Promise.resolve(),Vc.then(()=>{Vc=null})),Vc}function kf(rr,ar,v){rr.dispatchEvent(Lp(`${ar?"intro":"outro"}${v}`))}const zu=new Set;let il;function P0(){il={r:0,c:[],p:il}}function I0(){il.r||sl(il.c),il=il.p}function Hs(rr,ar){rr&&rr.i&&(zu.delete(rr),rr.i(ar))}function ol(rr,ar,v,J){if(rr&&rr.o){if(zu.has(rr))return;zu.add(rr),il.c.push(()=>{zu.delete(rr),J&&(v&&rr.d(1),J())}),rr.o(ar)}else J&&J()}const O0={duration:0};function lp(rr,ar,v,J){let Z=ar(rr,v),p=J?0:1,g=null,b=null,y=null;function e(){y&&M0(rr,y)}function n(a,r){const m=a.b-p;return r*=Math.abs(m),{a:p,b:a.b,d:m,duration:r,start:a.start,end:a.start+r,group:a.group}}function t(a){const{delay:r=0,duration:m=300,easing:o=wp,tick:i=Ss,css:u}=Z||O0,f={start:g0()+r,b:a};a||(f.group=il,il.r+=1),g||b?b=f:(u&&(e(),y=sp(rr,p,a,m,r,o,u)),a&&i(0,1),g=n(f,m),vc(()=>kf(rr,a,"start")),v0(l=>{if(b&&l>b.start&&(g=n(b,m),b=null,kf(rr,g.b,"start"),u&&(e(),y=sp(rr,p,g.b,g.duration,0,o,Z.css))),g){if(l>=g.end)i(p=g.b,1-p),kf(rr,g.b,"end"),b||(g.b?e():--g.group.r||sl(g.group.c)),g=null;else if(l>=g.start){const h=l-g.start;p=g.a+g.d*o(h/g.duration),i(p,1-p)}}return!!(g||b)}))}return{run(a){kp(Z)?C0().then(()=>{Z=Z(),t(a)}):t(a)},end(){e(),g=b=null}}}function Mf(rr,ar,v){const J=rr.$$.props[ar];J!==void 0&&(rr.$$.bound[J]=v,v(rr.$$.ctx[J]))}function Fl(rr){rr&&rr.c()}function _l(rr,ar,v,J){const{fragment:Z,on_mount:p,on_destroy:g,after_update:b}=rr.$$;Z&&Z.m(ar,v),J||vc(()=>{const y=p.map(Tp).filter(kp);g?g.push(...y):sl(y),rr.$$.on_mount=[]}),b.forEach(vc)}function wl(rr,ar){const v=rr.$$;v.fragment!==null&&(sl(v.on_destroy),v.fragment&&v.fragment.d(ar),v.on_destroy=v.fragment=null,v.ctx=[])}function z0(rr,ar){rr.$$.dirty[0]===-1&&(Hc.push(rr),Op(),rr.$$.dirty.fill(0)),rr.$$.dirty[ar/31|0]|=1<<ar%31}function jl(rr,ar,v,J,Z,p,g,b=[-1]){const y=Yc;qc(rr);const e=rr.$$={fragment:null,ctx:null,props:p,update:Ss,not_equal:Z,bound:ip(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(ar.context||(y?y.$$.context:[])),callbacks:ip(),dirty:b,skip_bound:!1,root:ar.target||y.$$.root};g&&g(e.root);let n=!1;if(e.ctx=v?v(rr,ar.props||{},(t,a,...r)=>{const m=r.length?r[0]:a;return e.ctx&&Z(e.ctx[t],e.ctx[t]=m)&&(!e.skip_bound&&e.bound[t]&&e.bound[t](m),n&&z0(rr,t)),a}):[],e.update(),n=!0,sl(e.before_update),e.fragment=J?J(e.ctx):!1,ar.target){if(ar.hydrate){const t=b0(ar.target);e.fragment&&e.fragment.l(t),t.forEach($i)}else e.fragment&&e.fragment.c();ar.intro&&Hs(rr.$$.fragment),_l(rr,ar.target,ar.anchor,ar.customElement),zp()}qc(y)}class Ul{$destroy(){wl(this,1),this.$destroy=Ss}$on(ar,v){const J=this.$$.callbacks[ar]||(this.$$.callbacks[ar]=[]);return J.push(v),()=>{const Z=J.indexOf(v);Z!==-1&&J.splice(Z,1)}}$set(ar){this.$$set&&!m0(ar)&&(this.$$.skip_bound=!0,this.$$set(ar),this.$$.skip_bound=!1)}}function D0(rr,ar,v,J){return window.generateData(rr,ar,v,J)}function R0(rr,ar,v){return window.partitionData(rr,ar,v)}function Gc(rr,ar){return rr.X*ar.X+rr.Y*ar.Y+rr.Z*ar.Z}function Rl(rr,ar){return{X:rr.X*ar,Y:rr.Y*ar,Z:rr.Z*ar}}function xl(rr,ar){return{X:rr.X+ar.X,Y:rr.Y+ar.Y,Z:rr.Z+ar.Z}}function F0(rr){return Math.sqrt(rr.X**2+rr.Y**2)}function cp(rr){const ar=F0(rr);return{X:rr.X/ar,Y:rr.Y/ar}}function up(rr,ar){return{X:rr.X-ar.X,Y:rr.Y-ar.Y}}function B0(rr,ar){let v=Math.atan2(rr.Y,rr.X)-Math.atan2(ar.Y,ar.X);return v>Math.PI?v-=2*Math.PI:v<-Math.PI&&(v+=2*Math.PI),v}function N0(rr,ar,v,J){const Z=ar-Gc(rr,v),p=Gc(rr,J);if(p===0)return Z===0?"all":"none";const g=Z/p;return g<0||g>1?"none":xl(v,Rl(J,g))}class j0{constructor(ar,v,J,Z){Uc(this,"corner");Uc(this,"width");Uc(this,"height");Uc(this,"depth");this.corner=ar,this.width={X:v,Y:0,Z:0},this.height={X:0,Y:0,Z:J},this.depth={X:0,Y:Z,Z:0}}getSides(){const ar=[],v=this.corner,J=xl(xl(v,this.width),this.depth),Z=xl(xl(v,this.width),this.height),p=xl(xl(v,this.height),this.depth);return ar.push({start:v,direction:this.width}),ar.push({start:v,direction:this.height}),ar.push({start:v,direction:this.depth}),ar.push({start:J,direction:Rl(this.width,-1)}),ar.push({start:J,direction:this.height}),ar.push({start:J,direction:Rl(this.depth,-1)}),ar.push({start:Z,direction:Rl(this.width,-1)}),ar.push({start:Z,direction:Rl(this.height,-1)}),ar.push({start:Z,direction:this.depth}),ar.push({start:p,direction:this.width}),ar.push({start:p,direction:Rl(this.height,-1)}),ar.push({start:p,direction:Rl(this.depth,-1)}),ar}planeIntersect(ar,v){const J=this.getSides(),Z=new Set;for(const p of J){const g=N0(ar,v,p.start,p.direction);if(g!=="none"&&(g=="all"?(Z.add(JSON.stringify(p.start)),Z.add(JSON.stringify(xl(p.start,p.direction)))):Z.add(JSON.stringify(g)),Z.size>=6))break}return[...Z].map(p=>JSON.parse(p))}planeIntersectSorted(ar,v){const J=this.planeIntersect(ar,v),Z=[];Gc(ar,{X:1,Y:0,Z:0})==0&&Z.push("X"),Gc(ar,{X:0,Y:1,Z:0})==0&&Z.push("Y"),Gc(ar,{X:0,Y:0,Z:1})==0&&Z.push("Z"),Z.length<2&&(Z.includes("X")||Z.push("X"),Z.push("Y"));const p=J.map(r=>({X:r[Z[0]],Y:r[Z[1]]}));let g=1/0,b=1/0,y=-1/0,e=-1/0;for(const r of p)r.X<g&&(g=r.X),r.Y<b&&(b=r.Y),r.X>y&&(y=r.X),r.Y>e&&(e=r.Y);const n={X:g+(y-g)/2,Y:b+(e-b)/2},t=cp(up(p[0],n)),a=p.map(r=>{const m=cp(up(r,n));return B0(t,m)});return p.map((r,m)=>({vec:r,i:m,angle:a[m]})).sort((r,m)=>r.angle-m.angle).map(r=>J[r.i])}}function fp(rr,{delay:ar=0,duration:v=400,easing:J=wp}={}){const Z=+getComputedStyle(rr).opacity;return{delay:ar,duration:v,easing:J,css:p=>`opacity: ${p*Z}`}}function hp(rr,ar,v){const J=rr.slice();return J[11]=ar[v],J[13]=v,J}function pp(rr){let ar;return{c(){ar=fi("hr"),li(ar,"class","line svelte-1uv0yw7")},m(v,J){xo(v,ar,J)},d(v){v&&$i(ar)}}}function dp(rr){let ar,v=rr[11].title+"",J,Z,p,g,b=rr[11].f()+"",y,e,n,t=rr[13]<rr[0].length-1&&pp();return{c(){ar=fi("div"),J=us(v),Z=us(":"),p=gs(),g=fi("div"),y=us(b),e=gs(),t&&t.c(),n=Ep(),li(ar,"class","key svelte-1uv0yw7"),li(g,"class","value svelte-1uv0yw7")},m(a,r){xo(a,ar,r),Ga(ar,J),Ga(ar,Z),xo(a,p,r),xo(a,g,r),Ga(g,y),xo(a,e,r),t&&t.m(a,r),xo(a,n,r)},p(a,r){r&1&&v!==(v=a[11].title+"")&&Bl(J,v),r&1&&b!==(b=a[11].f()+"")&&Bl(y,b),a[13]<a[0].length-1?t||(t=pp(),t.c(),t.m(n.parentNode,n)):t&&(t.d(1),t=null)},d(a){a&&$i(ar),a&&$i(p),a&&$i(g),a&&$i(e),t&&t.d(a),a&&$i(n)}}}function U0(rr){let ar,v,J,Z,p,g,b=rr[0],y=[];for(let e=0;e<b.length;e+=1)y[e]=dp(hp(rr,b,e));return{c(){ar=fi("div"),v=fi("div"),v.textContent="Evaluation",J=gs(),Z=fi("div");for(let e=0;e<y.length;e+=1)y[e].c();li(v,"class","title"),li(Z,"class","evaluation svelte-1uv0yw7")},m(e,n){xo(e,ar,n),Ga(ar,v),Ga(ar,J),Ga(ar,Z);for(let t=0;t<y.length;t+=1)y[t].m(Z,null);g=!0},p(e,[n]){if(n&1){b=e[0];let t;for(t=0;t<b.length;t+=1){const a=hp(e,b,t);y[t]?y[t].p(a,n):(y[t]=dp(a),y[t].c(),y[t].m(Z,null))}for(;t<y.length;t+=1)y[t].d(1);y.length=b.length}},i(e){g||(vc(()=>{p||(p=lp(ar,fp,{},!0)),p.run(1)}),g=!0)},o(e){p||(p=lp(ar,fp,{},!1)),p.run(0),g=!1},d(e){e&&$i(ar),If(y,e),e&&p&&p.end()}}}function V0(rr,ar,v){let J,Z,p,g,b,y,e,n,t,{evaluation:a}=ar,{numOfPlanes:r}=ar;return rr.$$set=m=>{"evaluation"in m&&v(1,a=m.evaluation),"numOfPlanes"in m&&v(2,r=m.numOfPlanes)},rr.$$.update=()=>{rr.$$.dirty&2&&v(7,{Accuracy:J,TruePositives:Z,FalsePositives:p,FalseNegatives:g,ComputedPlanes:b}=a,J,(v(9,Z),v(1,a)),(v(10,p),v(1,a)),(v(8,g),v(1,a)),(v(6,b),v(1,a))),rr.$$.dirty&1536&&v(5,y=Z/(Z+p)),rr.$$.dirty&768&&v(4,e=Z/(Z+g)),rr.$$.dirty&48&&v(3,n=2*y*e/(y+e)),rr.$$.dirty&252&&v(0,t=[{title:"Accuracy",f:()=>`${Math.round(J*1e4)/100}%`},{title:"Number of computed planes / actual planes",f:()=>`${b.length} / ${r}`},{title:"Precision",f:()=>Object.is(y,NaN)?"-":`${Math.round(y*1e3)/1e3}`},{title:"Recall",f:()=>Object.is(e,NaN)?"-":`${Math.round(e*1e3)/1e3}`},{title:"F1-Score",f:()=>Object.is(n,NaN)?"-":`${Math.round(n*1e3)/1e3}`}])},[t,a,r,n,e,y,b,J,g,Z,p]}class H0 extends Ul{constructor(ar){super(),jl(this,ar,V0,U0,Nl,{evaluation:1,numOfPlanes:2})}}function mp(rr,ar,v){const J=rr.slice();return J[12]=ar[v],J[13]=ar,J[14]=v,J}function gp(rr,ar,v){const J=rr.slice();return J[15]=ar[v],J}function q0(rr){let ar,v,J,Z=rr[12].options,p=[];for(let b=0;b<Z.length;b+=1)p[b]=vp(gp(rr,Z,b));function g(){rr[9].call(ar,rr[12])}return{c(){ar=fi("select");for(let b=0;b<p.length;b+=1)p[b].c();_0(ar,"grid-column","2 / 4"),li(ar,"class","svelte-1j7isxu"),rr[4][rr[12].field]===void 0&&vc(g)},m(b,y){xo(b,ar,y);for(let e=0;e<p.length;e+=1)p[e].m(ar,null);op(ar,rr[4][rr[12].field]),v||(J=bl(ar,"change",g),v=!0)},p(b,y){if(rr=b,y&2){Z=rr[12].options;let e;for(e=0;e<Z.length;e+=1){const n=gp(rr,Z,e);p[e]?p[e].p(n,y):(p[e]=vp(n),p[e].c(),p[e].m(ar,null))}for(;e<p.length;e+=1)p[e].d(1);p.length=Z.length}y&18&&op(ar,rr[4][rr[12].field])},d(b){b&&$i(ar),If(p,b),v=!1,J()}}}function G0(rr){let ar,v,J,Z,p,g,b,y;function e(){rr[7].call(ar,rr[12])}function n(){rr[8].call(J,rr[12])}return{c(){ar=fi("input"),v=gs(),J=fi("input"),li(ar,"type","number"),li(ar,"class","svelte-1j7isxu"),li(J,"type","range"),li(J,"min",Z=rr[12].minValue),li(J,"max",p=rr[12].maxValue),li(J,"step",g=rr[12].step)},m(t,a){xo(t,ar,a),Cu(ar,rr[4][rr[12].field]),xo(t,v,a),xo(t,J,a),Cu(J,rr[4][rr[12].field]),b||(y=[bl(ar,"input",e),bl(J,"change",n),bl(J,"input",n)],b=!0)},p(t,a){rr=t,a&18&&Ef(ar.value)!==rr[4][rr[12].field]&&Cu(ar,rr[4][rr[12].field]),a&2&&Z!==(Z=rr[12].minValue)&&li(J,"min",Z),a&2&&p!==(p=rr[12].maxValue)&&li(J,"max",p),a&2&&g!==(g=rr[12].step)&&li(J,"step",g),a&18&&Cu(J,rr[4][rr[12].field])},d(t){t&&$i(ar),t&&$i(v),t&&$i(J),b=!1,sl(y)}}}function vp(rr){let ar,v=rr[15]+"",J,Z;return{c(){ar=fi("option"),J=us(v),ar.__value=Z=rr[15],ar.value=ar.__value},m(p,g){xo(p,ar,g),Ga(ar,J)},p(p,g){g&2&&v!==(v=p[15]+"")&&Bl(J,v),g&2&&Z!==(Z=p[15])&&(ar.__value=Z,ar.value=ar.__value)},d(p){p&&$i(ar)}}}function yp(rr){let ar=rr[12].name+"",v,J,Z;function p(y,e){return"minValue"in y[12]?G0:q0}let g=p(rr),b=g(rr);return{c(){v=us(ar),J=us(`:\xA0
		`),b.c(),Z=Ep()},m(y,e){xo(y,v,e),xo(y,J,e),b.m(y,e),xo(y,Z,e)},p(y,e){e&2&&ar!==(ar=y[12].name+"")&&Bl(v,ar),g===(g=p(y))&&b?b.p(y,e):(b.d(1),b=g(y),b&&(b.c(),b.m(Z.parentNode,Z)))},d(y){y&&$i(v),y&&$i(J),b.d(y),y&&$i(Z)}}}function Y0(rr){let ar,v,J,Z,p,g,b,y,e,n,t,a,r,m,o,i=rr[1],u=[];for(let f=0;f<i.length;f+=1)u[f]=yp(mp(rr,i,f));return{c(){ar=fi("div"),v=fi("div"),J=us(rr[0]),Z=gs(),p=fi("div");for(let f=0;f<u.length;f+=1)u[f].c();g=gs(),b=fi("div"),y=fi("label"),e=fi("input"),n=us(`
		Auto update\xA0`),t=gs(),a=fi("button"),r=us(rr[2]),li(v,"class","title"),li(p,"class","settings svelte-1j7isxu"),li(e,"type","checkbox"),li(y,"title","Automatically update the visualization if you change the values?"),li(b,"class","bot svelte-1j7isxu")},m(f,l){xo(f,ar,l),Ga(ar,v),Ga(v,J),Ga(ar,Z),Ga(ar,p);for(let h=0;h<u.length;h+=1)u[h].m(p,null);Ga(ar,g),Ga(ar,b),Ga(b,y),Ga(y,e),e.checked=rr[3],Ga(y,n),Ga(b,t),Ga(b,a),Ga(a,r),m||(o=[bl(e,"change",rr[10]),bl(a,"click",rr[5])],m=!0)},p(f,[l]){if(l&1&&Bl(J,f[0]),l&18){i=f[1];let h;for(h=0;h<i.length;h+=1){const d=mp(f,i,h);u[h]?u[h].p(d,l):(u[h]=yp(d),u[h].c(),u[h].m(p,null))}for(;h<u.length;h+=1)u[h].d(1);u.length=i.length}l&8&&(e.checked=f[3]),l&4&&Bl(r,f[2])},i:Ss,o:Ss,d(f){f&&$i(ar),If(u,f),m=!1,sl(o)}}}function W0(rr,ar,v){let{title:J}=ar,{items:Z}=ar,{submissionText:p}=ar,{submissionEventName:g}=ar,b=!1;const y=Z.reduce((o,i)=>Object.assign(o,{[i.field]:i.defaultValue}),{}),e=Pp();function n(){e(g,y)}function t(o){y[o.field]=Ef(this.value),v(4,y),v(1,Z)}function a(o){y[o.field]=Ef(this.value),v(4,y),v(1,Z)}function r(o){y[o.field]=w0(this),v(4,y),v(1,Z)}function m(){b=this.checked,v(3,b)}return rr.$$set=o=>{"title"in o&&v(0,J=o.title),"items"in o&&v(1,Z=o.items),"submissionText"in o&&v(2,p=o.submissionText),"submissionEventName"in o&&v(6,g=o.submissionEventName)},rr.$$.update=()=>{rr.$$.dirty&24&&b&&n()},[J,Z,p,b,y,n,g,t,a,r,m]}class xp extends Ul{constructor(ar){super(),jl(this,ar,W0,Y0,Nl,{title:0,items:1,submissionText:2,submissionEventName:6})}}function bp(rr){let ar,v;return ar=new H0({props:{evaluation:rr[0],numOfPlanes:rr[1]}}),{c(){Fl(ar.$$.fragment)},m(J,Z){_l(ar,J,Z),v=!0},p(J,Z){const p={};Z&1&&(p.evaluation=J[0]),Z&2&&(p.numOfPlanes=J[1]),ar.$set(p)},i(J){v||(Hs(ar.$$.fragment,J),v=!0)},o(J){ol(ar.$$.fragment,J),v=!1},d(J){wl(ar,J)}}}function X0(rr){let ar,v,J,Z,p,g;v=new xp({props:{title:"Data generation",items:rr[4],submissionText:"Display data",submissionEventName:"datagenEvent"}}),v.$on("datagenEvent",rr[2]),Z=new xp({props:{title:"Partitioning algorithm",items:rr[5],submissionText:"Compute planes",submissionEventName:"partitionEvent"}}),Z.$on("partitionEvent",rr[3]);let b=rr[0]!=null&&bp(rr);return{c(){ar=fi("div"),Fl(v.$$.fragment),J=gs(),Fl(Z.$$.fragment),p=gs(),b&&b.c(),li(ar,"class","container svelte-1ykeokk")},m(y,e){xo(y,ar,e),_l(v,ar,null),Ga(ar,J),_l(Z,ar,null),Ga(ar,p),b&&b.m(ar,null),g=!0},p(y,[e]){y[0]!=null?b?(b.p(y,e),e&1&&Hs(b,1)):(b=bp(y),b.c(),Hs(b,1),b.m(ar,null)):b&&(P0(),ol(b,1,1,()=>{b=null}),I0())},i(y){g||(Hs(v.$$.fragment,y),Hs(Z.$$.fragment,y),Hs(b),g=!0)},o(y){ol(v.$$.fragment,y),ol(Z.$$.fragment,y),ol(b),g=!1},d(y){y&&$i(ar),wl(v),wl(Z),b&&b.d()}}}function Z0(rr,ar,v){let{evaluation:J}=ar;const Z=Pp();let p;function g(n){v(1,p=n.detail.numOfPlanes),Z("display",n.detail)}function b(n){Z("partitionEvent",n.detail)}const y=[{name:"Number of planes",field:"numOfPlanes",defaultValue:2,minValue:1,maxValue:10},{name:"Points per plane",field:"pointsPerPlane",defaultValue:5,minValue:1,maxValue:100},{name:"Noise mean",field:"mean",defaultValue:0,minValue:-1,maxValue:1,step:1e-4},{name:"Noise standard deviation",field:"stddev",defaultValue:1e-4,minValue:0,maxValue:.5,step:1e-5}],e=[{name:"Algorithm",field:"algorithm",defaultValue:"GreedyJoining",options:["GreedyJoining","GreedyMoving"]},{name:"Threshold",field:"threshold",defaultValue:5e-4,minValue:0,maxValue:1,step:1e-5},{name:"Amplification",field:"amplification",defaultValue:1,minValue:1,maxValue:200,step:1}];return rr.$$set=n=>{"evaluation"in n&&v(0,J=n.evaluation)},[J,p,g,b,y,e]}class J0 extends Ul{constructor(ar){super(),jl(this,ar,Z0,X0,Nl,{evaluation:0})}}function K0(rr){let ar,v,J,Z,p,g,b,y,e,n,t,a,r,m,o,i,u,f,l,h;return{c(){ar=fi("div"),v=fi("div"),J=fi("div"),Z=fi("label"),p=fi("input"),g=us(`
				Show planes`),b=gs(),y=fi("div"),e=fi("label"),n=fi("input"),t=us(`
				Colorize points`),a=gs(),r=fi("div"),m=fi("div"),o=us("Visualization status:\xA0"),i=fi("div"),u=us(rr[2]),li(p,"type","checkbox"),li(J,"class","item svelte-mow38x"),li(J,"title","Show computed planes"),li(n,"type","checkbox"),li(y,"class","item svelte-mow38x"),li(y,"title","Color the points such that you can see the correct partitioning"),li(i,"style",f=`color: ${rr[2]=="ready"?"green":"red"}; display: inline;`),li(r,"class","item svelte-mow38x"),li(r,"title","Shows whether or not the algorithms is currently computing a partitioning"),li(v,"class","utilityBox svelte-mow38x"),li(ar,"class","border svelte-mow38x")},m(d,s){xo(d,ar,s),Ga(ar,v),Ga(v,J),Ga(J,Z),Ga(Z,p),p.checked=rr[0],Ga(Z,g),Ga(v,b),Ga(v,y),Ga(y,e),Ga(e,n),n.checked=rr[1],Ga(e,t),Ga(v,a),Ga(v,r),Ga(r,m),Ga(m,o),Ga(m,i),Ga(i,u),l||(h=[bl(p,"change",rr[3]),bl(n,"change",rr[4])],l=!0)},p(d,[s]){s&1&&(p.checked=d[0]),s&2&&(n.checked=d[1]),s&4&&Bl(u,d[2]),s&4&&f!==(f=`color: ${d[2]=="ready"?"green":"red"}; display: inline;`)&&li(i,"style",f)},i:Ss,o:Ss,d(d){d&&$i(ar),l=!1,sl(h)}}}function Q0(rr,ar,v){let{visualizationStatus:J}=ar,{showPlanes:Z}=ar,{colorizePoints:p}=ar;function g(){Z=this.checked,v(0,Z)}function b(){p=this.checked,v(1,p)}return rr.$$set=y=>{"visualizationStatus"in y&&v(2,J=y.visualizationStatus),"showPlanes"in y&&v(0,Z=y.showPlanes),"colorizePoints"in y&&v(1,p=y.colorizePoints)},[Z,p,J,g,b]}class $0 extends Ul{constructor(ar){super(),jl(this,ar,Q0,K0,Nl,{visualizationStatus:2,showPlanes:0,colorizePoints:1})}}var Wi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function em(rr){return rr&&rr.__esModule&&Object.prototype.hasOwnProperty.call(rr,"default")?rr.default:rr}function Iu(rr){throw new Error('Could not dynamically require "'+rr+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Dp={exports:{}};(function(rr,ar){(function(v){rr.exports=v()})(function(){return function v(J,Z,p){function g(e,n){if(!Z[e]){if(!J[e]){var t=typeof Iu=="function"&&Iu;if(!n&&t)return t(e,!0);if(b)return b(e,!0);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}var r=Z[e]={exports:{}};J[e][0].call(r.exports,function(m){return g(J[e][1][m]||m)},r,r.exports,v,J,Z,p)}return Z[e].exports}for(var b=typeof Iu=="function"&&Iu,y=0;y<p.length;y++)g(p[y]);return g}({1:[function(v,J,Z){var p=v("../src/lib"),g={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var b in g){var y=b.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");p.addStyleRule(y,g[b])}},{"../src/lib":515}],2:[function(v,J,Z){J.exports=v("../src/transforms/aggregate")},{"../src/transforms/aggregate":1127}],3:[function(v,J,Z){J.exports=v("../src/traces/bar")},{"../src/traces/bar":665}],4:[function(v,J,Z){J.exports=v("../src/traces/barpolar")},{"../src/traces/barpolar":678}],5:[function(v,J,Z){J.exports=v("../src/traces/box")},{"../src/traces/box":688}],6:[function(v,J,Z){J.exports=v("../src/components/calendars")},{"../src/components/calendars":365}],7:[function(v,J,Z){J.exports=v("../src/traces/candlestick")},{"../src/traces/candlestick":697}],8:[function(v,J,Z){J.exports=v("../src/traces/carpet")},{"../src/traces/carpet":716}],9:[function(v,J,Z){J.exports=v("../src/traces/choropleth")},{"../src/traces/choropleth":730}],10:[function(v,J,Z){J.exports=v("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":737}],11:[function(v,J,Z){J.exports=v("../src/traces/cone")},{"../src/traces/cone":743}],12:[function(v,J,Z){J.exports=v("../src/traces/contour")},{"../src/traces/contour":758}],13:[function(v,J,Z){J.exports=v("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":769}],14:[function(v,J,Z){J.exports=v("../src/core")},{"../src/core":493}],15:[function(v,J,Z){J.exports=v("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":777}],16:[function(v,J,Z){J.exports=v("../src/transforms/filter")},{"../src/transforms/filter":1128}],17:[function(v,J,Z){J.exports=v("../src/traces/funnel")},{"../src/traces/funnel":787}],18:[function(v,J,Z){J.exports=v("../src/traces/funnelarea")},{"../src/traces/funnelarea":796}],19:[function(v,J,Z){J.exports=v("../src/transforms/groupby")},{"../src/transforms/groupby":1129}],20:[function(v,J,Z){J.exports=v("../src/traces/heatmap")},{"../src/traces/heatmap":809}],21:[function(v,J,Z){J.exports=v("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":820}],22:[function(v,J,Z){J.exports=v("../src/traces/histogram")},{"../src/traces/histogram":832}],23:[function(v,J,Z){J.exports=v("../src/traces/histogram2d")},{"../src/traces/histogram2d":838}],24:[function(v,J,Z){J.exports=v("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":842}],25:[function(v,J,Z){J.exports=v("../src/traces/icicle")},{"../src/traces/icicle":848}],26:[function(v,J,Z){J.exports=v("../src/traces/image")},{"../src/traces/image":861}],27:[function(v,J,Z){var p=v("./core");p.register([v("./bar"),v("./box"),v("./heatmap"),v("./histogram"),v("./histogram2d"),v("./histogram2dcontour"),v("./contour"),v("./scatterternary"),v("./violin"),v("./funnel"),v("./waterfall"),v("./image"),v("./pie"),v("./sunburst"),v("./treemap"),v("./icicle"),v("./funnelarea"),v("./scatter3d"),v("./surface"),v("./isosurface"),v("./volume"),v("./mesh3d"),v("./cone"),v("./streamtube"),v("./scattergeo"),v("./choropleth"),v("./scattergl"),v("./splom"),v("./pointcloud"),v("./heatmapgl"),v("./parcoords"),v("./parcats"),v("./scattermapbox"),v("./choroplethmapbox"),v("./densitymapbox"),v("./sankey"),v("./indicator"),v("./table"),v("./carpet"),v("./scattercarpet"),v("./contourcarpet"),v("./ohlc"),v("./candlestick"),v("./scatterpolar"),v("./scatterpolargl"),v("./barpolar"),v("./scattersmith"),v("./aggregate"),v("./filter"),v("./groupby"),v("./sort"),v("./calendars")]),J.exports=p},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(v,J,Z){J.exports=v("../src/traces/indicator")},{"../src/traces/indicator":869}],29:[function(v,J,Z){J.exports=v("../src/traces/isosurface")},{"../src/traces/isosurface":875}],30:[function(v,J,Z){J.exports=v("../src/traces/mesh3d")},{"../src/traces/mesh3d":880}],31:[function(v,J,Z){J.exports=v("../src/traces/ohlc")},{"../src/traces/ohlc":885}],32:[function(v,J,Z){J.exports=v("../src/traces/parcats")},{"../src/traces/parcats":894}],33:[function(v,J,Z){J.exports=v("../src/traces/parcoords")},{"../src/traces/parcoords":905}],34:[function(v,J,Z){J.exports=v("../src/traces/pie")},{"../src/traces/pie":916}],35:[function(v,J,Z){J.exports=v("../src/traces/pointcloud")},{"../src/traces/pointcloud":925}],36:[function(v,J,Z){J.exports=v("../src/traces/sankey")},{"../src/traces/sankey":931}],37:[function(v,J,Z){J.exports=v("../src/traces/scatter3d")},{"../src/traces/scatter3d":969}],38:[function(v,J,Z){J.exports=v("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":976}],39:[function(v,J,Z){J.exports=v("../src/traces/scattergeo")},{"../src/traces/scattergeo":984}],40:[function(v,J,Z){J.exports=v("../src/traces/scattergl")},{"../src/traces/scattergl":998}],41:[function(v,J,Z){J.exports=v("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1008}],42:[function(v,J,Z){J.exports=v("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1016}],43:[function(v,J,Z){J.exports=v("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1024}],44:[function(v,J,Z){J.exports=v("../src/traces/scattersmith")},{"../src/traces/scattersmith":1031}],45:[function(v,J,Z){J.exports=v("../src/traces/scatterternary")},{"../src/traces/scatterternary":1039}],46:[function(v,J,Z){J.exports=v("../src/transforms/sort")},{"../src/transforms/sort":1131}],47:[function(v,J,Z){J.exports=v("../src/traces/splom")},{"../src/traces/splom":1049}],48:[function(v,J,Z){J.exports=v("../src/traces/streamtube")},{"../src/traces/streamtube":1057}],49:[function(v,J,Z){J.exports=v("../src/traces/sunburst")},{"../src/traces/sunburst":1065}],50:[function(v,J,Z){J.exports=v("../src/traces/surface")},{"../src/traces/surface":1074}],51:[function(v,J,Z){J.exports=v("../src/traces/table")},{"../src/traces/table":1082}],52:[function(v,J,Z){J.exports=v("../src/traces/treemap")},{"../src/traces/treemap":1093}],53:[function(v,J,Z){J.exports=v("../src/traces/violin")},{"../src/traces/violin":1106}],54:[function(v,J,Z){J.exports=v("../src/traces/volume")},{"../src/traces/volume":1114}],55:[function(v,J,Z){J.exports=v("../src/traces/waterfall")},{"../src/traces/waterfall":1122}],56:[function(v,J,Z){(function(p,g){typeof Z=="object"&&J!==void 0?g(Z,v("d3-array"),v("d3-collection"),v("d3-shape"),v("elementary-circuits-directed-graph")):g(p.d3=p.d3||{},p.d3,p.d3,p.d3,null)})(this,function(p,g,b,y,e){function n(re){return re.target.depth}function t(re,ne){return re.sourceLinks.length?re.depth:ne-1}function a(re){return function(){return re}}e=e&&e.hasOwnProperty("default")?e.default:e;var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(re){return typeof re}:function(re){return re&&typeof Symbol=="function"&&re.constructor===Symbol&&re!==Symbol.prototype?"symbol":typeof re};function m(re,ne){return i(re.source,ne.source)||re.index-ne.index}function o(re,ne){return i(re.target,ne.target)||re.index-ne.index}function i(re,ne){return re.partOfCycle===ne.partOfCycle?re.y0-ne.y0:re.circularLinkType==="top"||ne.circularLinkType==="bottom"?-1:1}function u(re){return re.value}function f(re){return(re.y0+re.y1)/2}function l(re){return f(re.source)}function h(re){return f(re.target)}function d(re){return re.index}function s(re){return re.nodes}function x(re){return re.links}function c(re,ne){var le=re.get(ne);if(!le)throw new Error("missing: "+ne);return le}function T(re,ne){return ne(re)}function _(re,ne,le){var oe=0;if(le===null){for(var de=[],se=0;se<re.links.length;se++){var me=re.links[se],Te=me.source.index,_e=me.target.index;de[Te]||(de[Te]=[]),de[_e]||(de[_e]=[]),de[Te].indexOf(_e)===-1&&de[Te].push(_e)}var be=e(de);be.sort(function(ve,Me){return ve.length-Me.length});var Ce={};for(se=0;se<be.length;se++){var fe=be[se].slice(-2);Ce[fe[0]]||(Ce[fe[0]]={}),Ce[fe[0]][fe[1]]=!0}re.links.forEach(function(ve){var Me=ve.target.index,ke=ve.source.index;Me===ke||Ce[ke]&&Ce[ke][Me]?(ve.circular=!0,ve.circularLinkID=oe,oe+=1):ve.circular=!1})}else re.links.forEach(function(ve){ve.source[le]<ve.target[le]?ve.circular=!1:(ve.circular=!0,ve.circularLinkID=oe,oe+=1)})}function w(re,ne){var le=0,oe=0;re.links.forEach(function(de){de.circular&&(de.source.circularLinkType||de.target.circularLinkType?de.circularLinkType=de.source.circularLinkType?de.source.circularLinkType:de.target.circularLinkType:de.circularLinkType=le<oe?"top":"bottom",de.circularLinkType=="top"?le+=1:oe+=1,re.nodes.forEach(function(se){T(se,ne)!=T(de.source,ne)&&T(se,ne)!=T(de.target,ne)||(se.circularLinkType=de.circularLinkType)}))}),re.links.forEach(function(de){de.circular&&(de.source.circularLinkType==de.target.circularLinkType&&(de.circularLinkType=de.source.circularLinkType),Q(de,ne)&&(de.circularLinkType=de.source.circularLinkType))})}function k(re){var ne=Math.abs(re.y1-re.y0),le=Math.abs(re.target.x0-re.source.x1);return Math.atan(le/ne)}function L(re,ne){var le=0;re.sourceLinks.forEach(function(de){le=de.circular&&!Q(de,ne)?le+1:le});var oe=0;return re.targetLinks.forEach(function(de){oe=de.circular&&!Q(de,ne)?oe+1:oe}),le+oe}function A(re){var ne=re.source.sourceLinks,le=0;ne.forEach(function(se){le=se.circular?le+1:le});var oe=re.target.targetLinks,de=0;return oe.forEach(function(se){de=se.circular?de+1:de}),!(le>1||de>1)}function I(re,ne,le){return re.sort(S),re.forEach(function(oe,de){var se,me,Te=0;if(Q(oe,le)&&A(oe))oe.circularPathData.verticalBuffer=Te+oe.width/2;else{for(var _e=0;_e<de;_e++)if(se=re[de],me=re[_e],!(se.source.column<me.target.column||se.target.column>me.source.column)){var be=re[_e].circularPathData.verticalBuffer+re[_e].width/2+ne;Te=be>Te?be:Te}oe.circularPathData.verticalBuffer=Te+oe.width/2}}),re}function P(re,ne,le,oe){var de=g.min(re.links,function(se){return se.source.y0});re.links.forEach(function(se){se.circular&&(se.circularPathData={})}),I(re.links.filter(function(se){return se.circularLinkType=="top"}),ne,oe),I(re.links.filter(function(se){return se.circularLinkType=="bottom"}),ne,oe),re.links.forEach(function(se){if(se.circular){if(se.circularPathData.arcRadius=se.width+10,se.circularPathData.leftNodeBuffer=5,se.circularPathData.rightNodeBuffer=5,se.circularPathData.sourceWidth=se.source.x1-se.source.x0,se.circularPathData.sourceX=se.source.x0+se.circularPathData.sourceWidth,se.circularPathData.targetX=se.target.x0,se.circularPathData.sourceY=se.y0,se.circularPathData.targetY=se.y1,Q(se,oe)&&A(se))se.circularPathData.leftSmallArcRadius=10+se.width/2,se.circularPathData.leftLargeArcRadius=10+se.width/2,se.circularPathData.rightSmallArcRadius=10+se.width/2,se.circularPathData.rightLargeArcRadius=10+se.width/2,se.circularLinkType=="bottom"?(se.circularPathData.verticalFullExtent=se.source.y1+25+se.circularPathData.verticalBuffer,se.circularPathData.verticalLeftInnerExtent=se.circularPathData.verticalFullExtent-se.circularPathData.leftLargeArcRadius,se.circularPathData.verticalRightInnerExtent=se.circularPathData.verticalFullExtent-se.circularPathData.rightLargeArcRadius):(se.circularPathData.verticalFullExtent=se.source.y0-25-se.circularPathData.verticalBuffer,se.circularPathData.verticalLeftInnerExtent=se.circularPathData.verticalFullExtent+se.circularPathData.leftLargeArcRadius,se.circularPathData.verticalRightInnerExtent=se.circularPathData.verticalFullExtent+se.circularPathData.rightLargeArcRadius);else{var me=se.source.column,Te=se.circularLinkType,_e=re.links.filter(function(fe){return fe.source.column==me&&fe.circularLinkType==Te});se.circularLinkType=="bottom"?_e.sort(D):_e.sort(E);var be=0;_e.forEach(function(fe,ve){fe.circularLinkID==se.circularLinkID&&(se.circularPathData.leftSmallArcRadius=10+se.width/2+be,se.circularPathData.leftLargeArcRadius=10+se.width/2+ve*ne+be),be+=fe.width}),me=se.target.column,_e=re.links.filter(function(fe){return fe.target.column==me&&fe.circularLinkType==Te}),se.circularLinkType=="bottom"?_e.sort(H):_e.sort(R),be=0,_e.forEach(function(fe,ve){fe.circularLinkID==se.circularLinkID&&(se.circularPathData.rightSmallArcRadius=10+se.width/2+be,se.circularPathData.rightLargeArcRadius=10+se.width/2+ve*ne+be),be+=fe.width}),se.circularLinkType=="bottom"?(se.circularPathData.verticalFullExtent=Math.max(le,se.source.y1,se.target.y1)+25+se.circularPathData.verticalBuffer,se.circularPathData.verticalLeftInnerExtent=se.circularPathData.verticalFullExtent-se.circularPathData.leftLargeArcRadius,se.circularPathData.verticalRightInnerExtent=se.circularPathData.verticalFullExtent-se.circularPathData.rightLargeArcRadius):(se.circularPathData.verticalFullExtent=de-25-se.circularPathData.verticalBuffer,se.circularPathData.verticalLeftInnerExtent=se.circularPathData.verticalFullExtent+se.circularPathData.leftLargeArcRadius,se.circularPathData.verticalRightInnerExtent=se.circularPathData.verticalFullExtent+se.circularPathData.rightLargeArcRadius)}se.circularPathData.leftInnerExtent=se.circularPathData.sourceX+se.circularPathData.leftNodeBuffer,se.circularPathData.rightInnerExtent=se.circularPathData.targetX-se.circularPathData.rightNodeBuffer,se.circularPathData.leftFullExtent=se.circularPathData.sourceX+se.circularPathData.leftLargeArcRadius+se.circularPathData.leftNodeBuffer,se.circularPathData.rightFullExtent=se.circularPathData.targetX-se.circularPathData.rightLargeArcRadius-se.circularPathData.rightNodeBuffer}if(se.circular)se.path=function(fe){var ve="";return ve=fe.circularLinkType=="top"?"M"+fe.circularPathData.sourceX+" "+fe.circularPathData.sourceY+" L"+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.sourceY+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftSmallArcRadius+" 0 0 0 "+fe.circularPathData.leftFullExtent+" "+(fe.circularPathData.sourceY-fe.circularPathData.leftSmallArcRadius)+" L"+fe.circularPathData.leftFullExtent+" "+fe.circularPathData.verticalLeftInnerExtent+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftLargeArcRadius+" 0 0 0 "+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.verticalFullExtent+" L"+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.verticalFullExtent+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightLargeArcRadius+" 0 0 0 "+fe.circularPathData.rightFullExtent+" "+fe.circularPathData.verticalRightInnerExtent+" L"+fe.circularPathData.rightFullExtent+" "+(fe.circularPathData.targetY-fe.circularPathData.rightSmallArcRadius)+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightSmallArcRadius+" 0 0 0 "+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.targetY+" L"+fe.circularPathData.targetX+" "+fe.circularPathData.targetY:"M"+fe.circularPathData.sourceX+" "+fe.circularPathData.sourceY+" L"+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.sourceY+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftSmallArcRadius+" 0 0 1 "+fe.circularPathData.leftFullExtent+" "+(fe.circularPathData.sourceY+fe.circularPathData.leftSmallArcRadius)+" L"+fe.circularPathData.leftFullExtent+" "+fe.circularPathData.verticalLeftInnerExtent+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftLargeArcRadius+" 0 0 1 "+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.verticalFullExtent+" L"+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.verticalFullExtent+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightLargeArcRadius+" 0 0 1 "+fe.circularPathData.rightFullExtent+" "+fe.circularPathData.verticalRightInnerExtent+" L"+fe.circularPathData.rightFullExtent+" "+(fe.circularPathData.targetY+fe.circularPathData.rightSmallArcRadius)+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightSmallArcRadius+" 0 0 1 "+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.targetY+" L"+fe.circularPathData.targetX+" "+fe.circularPathData.targetY,ve}(se);else{var Ce=y.linkHorizontal().source(function(fe){return[fe.source.x0+(fe.source.x1-fe.source.x0),fe.y0]}).target(function(fe){return[fe.target.x0,fe.y1]});se.path=Ce(se)}})}function S(re,ne){return V(re)==V(ne)?re.circularLinkType=="bottom"?D(re,ne):E(re,ne):V(ne)-V(re)}function E(re,ne){return re.y0-ne.y0}function D(re,ne){return ne.y0-re.y0}function R(re,ne){return re.y1-ne.y1}function H(re,ne){return ne.y1-re.y1}function V(re){return re.target.column-re.source.column}function X(re){return re.target.x0-re.source.x1}function $(re,ne){var le=k(re),oe=X(ne)/Math.tan(le);return j(re)=="up"?re.y1+oe:re.y1-oe}function G(re,ne){var le=k(re),oe=X(ne)/Math.tan(le);return j(re)=="up"?re.y1-oe:re.y1+oe}function W(re,ne,le,oe){re.links.forEach(function(de){if(!de.circular&&de.target.column-de.source.column>1){var se=de.source.column+1,me=de.target.column-1,Te=1,_e=me-se+1;for(Te=1;se<=me;se++,Te++)re.nodes.forEach(function(be){if(be.column==se){var Ce,fe=Te/(_e+1),ve=Math.pow(1-fe,3),Me=3*fe*Math.pow(1-fe,2),ke=3*Math.pow(fe,2)*(1-fe),Le=Math.pow(fe,3),ze=ve*de.y0+Me*de.y0+ke*de.y1+Le*de.y1,Re=ze-de.width/2,Oe=ze+de.width/2;Re>be.y0&&Re<be.y1?(Ce=be.y1-Re+10,Ce=be.circularLinkType=="bottom"?Ce:-Ce,be=N(be,Ce,ne,le),re.nodes.forEach(function(Ze){T(Ze,oe)!=T(be,oe)&&Ze.column==be.column&&te(be,Ze)&&N(Ze,Ce,ne,le)})):(Oe>be.y0&&Oe<be.y1||Re<be.y0&&Oe>be.y1)&&(Ce=Oe-be.y0+10,be=N(be,Ce,ne,le),re.nodes.forEach(function(Ze){T(Ze,oe)!=T(be,oe)&&Ze.column==be.column&&Ze.y0<be.y1&&Ze.y1>be.y1&&N(Ze,Ce,ne,le)}))}})}})}function te(re,ne){return re.y0>ne.y0&&re.y0<ne.y1||re.y1>ne.y0&&re.y1<ne.y1||re.y0<ne.y0&&re.y1>ne.y1}function N(re,ne,le,oe){return re.y0+ne>=le&&re.y1+ne<=oe&&(re.y0=re.y0+ne,re.y1=re.y1+ne,re.targetLinks.forEach(function(de){de.y1=de.y1+ne}),re.sourceLinks.forEach(function(de){de.y0=de.y0+ne})),re}function B(re,ne,le,oe){re.nodes.forEach(function(de){oe&&de.y+(de.y1-de.y0)>ne&&(de.y=de.y-(de.y+(de.y1-de.y0)-ne));var se=re.links.filter(function(_e){return T(_e.source,le)==T(de,le)}),me=se.length;me>1&&se.sort(function(_e,be){if(!_e.circular&&!be.circular){if(_e.target.column==be.target.column||!ee(_e,be))return _e.y1-be.y1;if(_e.target.column>be.target.column){var Ce=G(be,_e);return _e.y1-Ce}if(be.target.column>_e.target.column)return G(_e,be)-be.y1}return _e.circular&&!be.circular?_e.circularLinkType=="top"?-1:1:be.circular&&!_e.circular?be.circularLinkType=="top"?1:-1:_e.circular&&be.circular?_e.circularLinkType===be.circularLinkType&&_e.circularLinkType=="top"?_e.target.column===be.target.column?_e.target.y1-be.target.y1:be.target.column-_e.target.column:_e.circularLinkType===be.circularLinkType&&_e.circularLinkType=="bottom"?_e.target.column===be.target.column?be.target.y1-_e.target.y1:_e.target.column-be.target.column:_e.circularLinkType=="top"?-1:1:void 0});var Te=de.y0;se.forEach(function(_e){_e.y0=Te+_e.width/2,Te+=_e.width}),se.forEach(function(_e,be){if(_e.circularLinkType=="bottom"){for(var Ce=be+1,fe=0;Ce<me;Ce++)fe+=se[Ce].width;_e.y0=de.y1-fe-_e.width/2}})})}function U(re,ne,le){re.nodes.forEach(function(oe){var de=re.links.filter(function(Te){return T(Te.target,le)==T(oe,le)}),se=de.length;se>1&&de.sort(function(Te,_e){if(!Te.circular&&!_e.circular){if(Te.source.column==_e.source.column||!ee(Te,_e))return Te.y0-_e.y0;if(_e.source.column<Te.source.column){var be=$(_e,Te);return Te.y0-be}if(Te.source.column<_e.source.column)return $(Te,_e)-_e.y0}return Te.circular&&!_e.circular?Te.circularLinkType=="top"?-1:1:_e.circular&&!Te.circular?_e.circularLinkType=="top"?1:-1:Te.circular&&_e.circular?Te.circularLinkType===_e.circularLinkType&&Te.circularLinkType=="top"?Te.source.column===_e.source.column?Te.source.y1-_e.source.y1:Te.source.column-_e.source.column:Te.circularLinkType===_e.circularLinkType&&Te.circularLinkType=="bottom"?Te.source.column===_e.source.column?Te.source.y1-_e.source.y1:_e.source.column-Te.source.column:Te.circularLinkType=="top"?-1:1:void 0});var me=oe.y0;de.forEach(function(Te){Te.y1=me+Te.width/2,me+=Te.width}),de.forEach(function(Te,_e){if(Te.circularLinkType=="bottom"){for(var be=_e+1,Ce=0;be<se;be++)Ce+=de[be].width;Te.y1=oe.y1-Ce-Te.width/2}})})}function ee(re,ne){return j(re)==j(ne)}function j(re){return re.y0-re.y1>0?"up":"down"}function Q(re,ne){return T(re.source,ne)==T(re.target,ne)}function K(re,ne,le){var oe=re.nodes,de=re.links,se=!1,me=!1;if(de.forEach(function(be){be.circularLinkType=="top"?se=!0:be.circularLinkType=="bottom"&&(me=!0)}),se==0||me==0){var Te=g.min(oe,function(be){return be.y0}),_e=(le-ne)/(g.max(oe,function(be){return be.y1})-Te);oe.forEach(function(be){var Ce=(be.y1-be.y0)*_e;be.y0=(be.y0-Te)*_e,be.y1=be.y0+Ce}),de.forEach(function(be){be.y0=(be.y0-Te)*_e,be.y1=(be.y1-Te)*_e,be.width=be.width*_e})}}p.sankeyCircular=function(){var re,ne,le=0,oe=0,de=1,se=1,me=24,Te=d,_e=t,be=s,Ce=x,fe=32,ve=2,Me=null;function ke(){var Pe={nodes:be.apply(null,arguments),links:Ce.apply(null,arguments)};Le(Pe),_(Pe,Te,Me),ze(Pe),Re(Pe),w(Pe,Te),Oe(Pe,fe,Te),Ze(Pe);for(var Ie=4,Be=0;Be<Ie;Be++)B(Pe,se,Te),U(Pe,se,Te),W(Pe,oe,se,Te),B(Pe,se,Te),U(Pe,se,Te);return K(Pe,oe,se),P(Pe,ve,se,Te),Pe}function Le(Pe){Pe.nodes.forEach(function(Be,Fe){Be.index=Fe,Be.sourceLinks=[],Be.targetLinks=[]});var Ie=b.map(Pe.nodes,Te);return Pe.links.forEach(function(Be,Fe){Be.index=Fe;var $e=Be.source,ot=Be.target;($e===void 0?"undefined":r($e))!=="object"&&($e=Be.source=c(Ie,$e)),(ot===void 0?"undefined":r(ot))!=="object"&&(ot=Be.target=c(Ie,ot)),$e.sourceLinks.push(Be),ot.targetLinks.push(Be)}),Pe}function ze(Pe){Pe.nodes.forEach(function(Ie){Ie.partOfCycle=!1,Ie.value=Math.max(g.sum(Ie.sourceLinks,u),g.sum(Ie.targetLinks,u)),Ie.sourceLinks.forEach(function(Be){Be.circular&&(Ie.partOfCycle=!0,Ie.circularLinkType=Be.circularLinkType)}),Ie.targetLinks.forEach(function(Be){Be.circular&&(Ie.partOfCycle=!0,Ie.circularLinkType=Be.circularLinkType)})})}function Re(Pe){var Ie,Be,Fe;for(Ie=Pe.nodes,Be=[],Fe=0;Ie.length;++Fe,Ie=Be,Be=[])Ie.forEach(function($e){$e.depth=Fe,$e.sourceLinks.forEach(function(ot){Be.indexOf(ot.target)<0&&!ot.circular&&Be.push(ot.target)})});for(Ie=Pe.nodes,Be=[],Fe=0;Ie.length;++Fe,Ie=Be,Be=[])Ie.forEach(function($e){$e.height=Fe,$e.targetLinks.forEach(function(ot){Be.indexOf(ot.source)<0&&!ot.circular&&Be.push(ot.source)})});Pe.nodes.forEach(function($e){$e.column=Math.floor(_e.call(null,$e,Fe))})}function Oe(Pe,Ie,Be){var Fe=b.nest().key(function(yt){return yt.column}).sortKeys(g.ascending).entries(Pe.nodes).map(function(yt){return yt.values});(function(yt){if(ne){var tt=1/0;Fe.forEach(function(qt){var er=se*ne/(qt.length+1);tt=er<tt?er:tt}),re=tt}var Ke=g.min(Fe,function(qt){return(se-oe-(qt.length-1)*re)/g.sum(qt,u)});Ke*=.3,Pe.links.forEach(function(qt){qt.width=qt.value*Ke});var vt=function(qt){var er=0,Jt=0,ir=0,Ht=0,Ue=g.max(qt.nodes,function(We){return We.column});return qt.links.forEach(function(We){We.circular&&(We.circularLinkType=="top"?er+=We.width:Jt+=We.width,We.target.column==0&&(Ht+=We.width),We.source.column==Ue&&(ir+=We.width))}),{top:er=er>0?er+25+10:er,bottom:Jt=Jt>0?Jt+25+10:Jt,left:Ht=Ht>0?Ht+25+10:Ht,right:ir=ir>0?ir+25+10:ir}}(Pe),Nt=function(qt,er){var Jt=g.max(qt.nodes,function(he){return he.column}),ir=de-le,Ht=se-oe,Ue=ir/(ir+er.right+er.left),We=Ht/(Ht+er.top+er.bottom);return le=le*Ue+er.left,de=er.right==0?de:de*Ue,oe=oe*We+er.top,se*=We,qt.nodes.forEach(function(he){he.x0=le+he.column*((de-le-me)/Jt),he.x1=he.x0+me}),We}(Pe,vt);Ke*=Nt,Pe.links.forEach(function(qt){qt.width=qt.value*Ke}),Fe.forEach(function(qt){var er=qt.length;qt.forEach(function(Jt,ir){Jt.depth==Fe.length-1&&er==1||Jt.depth==0&&er==1?(Jt.y0=se/2-Jt.value*Ke,Jt.y1=Jt.y0+Jt.value*Ke):Jt.partOfCycle?L(Jt,yt)==0?(Jt.y0=se/2+ir,Jt.y1=Jt.y0+Jt.value*Ke):Jt.circularLinkType=="top"?(Jt.y0=oe+ir,Jt.y1=Jt.y0+Jt.value*Ke):(Jt.y0=se-Jt.value*Ke-ir,Jt.y1=Jt.y0+Jt.value*Ke):vt.top==0||vt.bottom==0?(Jt.y0=(se-oe)/er*ir,Jt.y1=Jt.y0+Jt.value*Ke):(Jt.y0=(se-oe)/2-er/2+ir,Jt.y1=Jt.y0+Jt.value*Ke)})})})(Be),_t();for(var $e=1,ot=Ie;ot>0;--ot)pt($e*=.99,Be),_t();function pt(yt,tt){var Ke=Fe.length;Fe.forEach(function(vt){var Nt=vt.length,qt=vt[0].depth;vt.forEach(function(er){var Jt;if((er.sourceLinks.length||er.targetLinks.length)&&!(er.partOfCycle&&L(er,tt)>0))if(qt==0&&Nt==1)Jt=er.y1-er.y0,er.y0=se/2-Jt/2,er.y1=se/2+Jt/2;else if(qt==Ke-1&&Nt==1)Jt=er.y1-er.y0,er.y0=se/2-Jt/2,er.y1=se/2+Jt/2;else{var ir=g.mean(er.sourceLinks,h),Ht=g.mean(er.targetLinks,l),Ue=((ir&&Ht?(ir+Ht)/2:ir||Ht)-f(er))*yt;er.y0+=Ue,er.y1+=Ue}})})}function _t(){Fe.forEach(function(yt){var tt,Ke,vt,Nt=oe,qt=yt.length;for(yt.sort(i),vt=0;vt<qt;++vt)(Ke=Nt-(tt=yt[vt]).y0)>0&&(tt.y0+=Ke,tt.y1+=Ke),Nt=tt.y1+re;if((Ke=Nt-re-se)>0)for(Nt=tt.y0-=Ke,tt.y1-=Ke,vt=qt-2;vt>=0;--vt)(Ke=(tt=yt[vt]).y1+re-Nt)>0&&(tt.y0-=Ke,tt.y1-=Ke),Nt=tt.y0})}}function Ze(Pe){Pe.nodes.forEach(function(Ie){Ie.sourceLinks.sort(o),Ie.targetLinks.sort(m)}),Pe.nodes.forEach(function(Ie){var Be=Ie.y0,Fe=Be,$e=Ie.y1,ot=$e;Ie.sourceLinks.forEach(function(pt){pt.circular?(pt.y0=$e-pt.width/2,$e-=pt.width):(pt.y0=Be+pt.width/2,Be+=pt.width)}),Ie.targetLinks.forEach(function(pt){pt.circular?(pt.y1=ot-pt.width/2,ot-=pt.width):(pt.y1=Fe+pt.width/2,Fe+=pt.width)})})}return ke.nodeId=function(Pe){return arguments.length?(Te=typeof Pe=="function"?Pe:a(Pe),ke):Te},ke.nodeAlign=function(Pe){return arguments.length?(_e=typeof Pe=="function"?Pe:a(Pe),ke):_e},ke.nodeWidth=function(Pe){return arguments.length?(me=+Pe,ke):me},ke.nodePadding=function(Pe){return arguments.length?(re=+Pe,ke):re},ke.nodes=function(Pe){return arguments.length?(be=typeof Pe=="function"?Pe:a(Pe),ke):be},ke.links=function(Pe){return arguments.length?(Ce=typeof Pe=="function"?Pe:a(Pe),ke):Ce},ke.size=function(Pe){return arguments.length?(le=oe=0,de=+Pe[0],se=+Pe[1],ke):[de-le,se-oe]},ke.extent=function(Pe){return arguments.length?(le=+Pe[0][0],de=+Pe[1][0],oe=+Pe[0][1],se=+Pe[1][1],ke):[[le,oe],[de,se]]},ke.iterations=function(Pe){return arguments.length?(fe=+Pe,ke):fe},ke.circularLinkGap=function(Pe){return arguments.length?(ve=+Pe,ke):ve},ke.nodePaddingRatio=function(Pe){return arguments.length?(ne=+Pe,ke):ne},ke.sortNodes=function(Pe){return arguments.length?(Me=Pe,ke):Me},ke.update=function(Pe){return w(Pe,Te),Ze(Pe),Pe.links.forEach(function(Ie){Ie.circular&&(Ie.circularLinkType=Ie.y0+Ie.y1<se?"top":"bottom",Ie.source.circularLinkType=Ie.circularLinkType,Ie.target.circularLinkType=Ie.circularLinkType)}),B(Pe,se,Te,!1),U(Pe,se,Te),P(Pe,ve,se,Te),Pe},ke},p.sankeyCenter=function(re){return re.targetLinks.length?re.depth:re.sourceLinks.length?g.min(re.sourceLinks,n)-1:0},p.sankeyLeft=function(re){return re.depth},p.sankeyRight=function(re,ne){return ne-1-re.height},p.sankeyJustify=t,Object.defineProperty(p,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(v,J,Z){(function(p,g){typeof Z=="object"&&J!==void 0?g(Z,v("d3-array"),v("d3-collection"),v("d3-shape")):g(p.d3=p.d3||{},p.d3,p.d3,p.d3)})(this,function(p,g,b,y){function e(T){return T.target.depth}function n(T,_){return T.sourceLinks.length?T.depth:_-1}function t(T){return function(){return T}}function a(T,_){return m(T.source,_.source)||T.index-_.index}function r(T,_){return m(T.target,_.target)||T.index-_.index}function m(T,_){return T.y0-_.y0}function o(T){return T.value}function i(T){return(T.y0+T.y1)/2}function u(T){return i(T.source)*T.value}function f(T){return i(T.target)*T.value}function l(T){return T.index}function h(T){return T.nodes}function d(T){return T.links}function s(T,_){var w=T.get(_);if(!w)throw new Error("missing: "+_);return w}function x(T){return[T.source.x1,T.y0]}function c(T){return[T.target.x0,T.y1]}p.sankey=function(){var T=0,_=0,w=1,k=1,L=24,A=8,I=l,P=n,S=h,E=d,D=32;function R(){var W={nodes:S.apply(null,arguments),links:E.apply(null,arguments)};return H(W),V(W),X(W),$(W),G(W),W}function H(W){W.nodes.forEach(function(N,B){N.index=B,N.sourceLinks=[],N.targetLinks=[]});var te=b.map(W.nodes,I);W.links.forEach(function(N,B){N.index=B;var U=N.source,ee=N.target;typeof U!="object"&&(U=N.source=s(te,U)),typeof ee!="object"&&(ee=N.target=s(te,ee)),U.sourceLinks.push(N),ee.targetLinks.push(N)})}function V(W){W.nodes.forEach(function(te){te.value=Math.max(g.sum(te.sourceLinks,o),g.sum(te.targetLinks,o))})}function X(W){var te,N,B;for(te=W.nodes,N=[],B=0;te.length;++B,te=N,N=[])te.forEach(function(ee){ee.depth=B,ee.sourceLinks.forEach(function(j){N.indexOf(j.target)<0&&N.push(j.target)})});for(te=W.nodes,N=[],B=0;te.length;++B,te=N,N=[])te.forEach(function(ee){ee.height=B,ee.targetLinks.forEach(function(j){N.indexOf(j.source)<0&&N.push(j.source)})});var U=(w-T-L)/(B-1);W.nodes.forEach(function(ee){ee.x1=(ee.x0=T+Math.max(0,Math.min(B-1,Math.floor(P.call(null,ee,B))))*U)+L})}function $(W){var te=b.nest().key(function(Q){return Q.x0}).sortKeys(g.ascending).entries(W.nodes).map(function(Q){return Q.values});(function(){var Q=g.max(te,function(ne){return ne.length}),K=2/3*(k-_)/(Q-1);A>K&&(A=K);var re=g.min(te,function(ne){return(k-_-(ne.length-1)*A)/g.sum(ne,o)});te.forEach(function(ne){ne.forEach(function(le,oe){le.y1=(le.y0=oe)+le.value*re})}),W.links.forEach(function(ne){ne.width=ne.value*re})})(),j();for(var N=1,B=D;B>0;--B)ee(N*=.99),j(),U(N),j();function U(Q){te.forEach(function(K){K.forEach(function(re){if(re.targetLinks.length){var ne=(g.sum(re.targetLinks,u)/g.sum(re.targetLinks,o)-i(re))*Q;re.y0+=ne,re.y1+=ne}})})}function ee(Q){te.slice().reverse().forEach(function(K){K.forEach(function(re){if(re.sourceLinks.length){var ne=(g.sum(re.sourceLinks,f)/g.sum(re.sourceLinks,o)-i(re))*Q;re.y0+=ne,re.y1+=ne}})})}function j(){te.forEach(function(Q){var K,re,ne,le=_,oe=Q.length;for(Q.sort(m),ne=0;ne<oe;++ne)(re=le-(K=Q[ne]).y0)>0&&(K.y0+=re,K.y1+=re),le=K.y1+A;if((re=le-A-k)>0)for(le=K.y0-=re,K.y1-=re,ne=oe-2;ne>=0;--ne)(re=(K=Q[ne]).y1+A-le)>0&&(K.y0-=re,K.y1-=re),le=K.y0})}}function G(W){W.nodes.forEach(function(te){te.sourceLinks.sort(r),te.targetLinks.sort(a)}),W.nodes.forEach(function(te){var N=te.y0,B=N;te.sourceLinks.forEach(function(U){U.y0=N+U.width/2,N+=U.width}),te.targetLinks.forEach(function(U){U.y1=B+U.width/2,B+=U.width})})}return R.update=function(W){return G(W),W},R.nodeId=function(W){return arguments.length?(I=typeof W=="function"?W:t(W),R):I},R.nodeAlign=function(W){return arguments.length?(P=typeof W=="function"?W:t(W),R):P},R.nodeWidth=function(W){return arguments.length?(L=+W,R):L},R.nodePadding=function(W){return arguments.length?(A=+W,R):A},R.nodes=function(W){return arguments.length?(S=typeof W=="function"?W:t(W),R):S},R.links=function(W){return arguments.length?(E=typeof W=="function"?W:t(W),R):E},R.size=function(W){return arguments.length?(T=_=0,w=+W[0],k=+W[1],R):[w-T,k-_]},R.extent=function(W){return arguments.length?(T=+W[0][0],w=+W[1][0],_=+W[0][1],k=+W[1][1],R):[[T,_],[w,k]]},R.iterations=function(W){return arguments.length?(D=+W,R):D},R},p.sankeyCenter=function(T){return T.targetLinks.length?T.depth:T.sourceLinks.length?g.min(T.sourceLinks,e)-1:0},p.sankeyLeft=function(T){return T.depth},p.sankeyRight=function(T,_){return _-1-T.height},p.sankeyJustify=n,p.sankeyLinkHorizontal=function(){return y.linkHorizontal().source(x).target(c)},Object.defineProperty(p,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(v,J,Z){(function(){var p={version:"3.8.0"},g=[].slice,b=function(ce){return g.call(ce)},y=self.document;function e(ce){return ce&&(ce.ownerDocument||ce.document||ce).documentElement}function n(ce){return ce&&(ce.ownerDocument&&ce.ownerDocument.defaultView||ce.document&&ce||ce.defaultView)}if(y)try{b(y.documentElement.childNodes)[0].nodeType}catch{b=function(C){for(var z=C.length,F=new Array(z);z--;)F[z]=C[z];return F}}if(Date.now||(Date.now=function(){return+new Date}),y)try{y.createElement("DIV").style.setProperty("opacity",0,"")}catch{var t=this.Element.prototype,a=t.setAttribute,r=t.setAttributeNS,m=this.CSSStyleDeclaration.prototype,o=m.setProperty;t.setAttribute=function(C,z){a.call(this,C,z+"")},t.setAttributeNS=function(C,z,F){r.call(this,C,z,F+"")},m.setProperty=function(C,z,F){o.call(this,C,z+"",F)}}function i(ce,C){return ce<C?-1:ce>C?1:ce>=C?0:NaN}function u(ce){return ce===null?NaN:+ce}function f(ce){return!isNaN(ce)}function l(ce){return{left:function(C,z,F,q){for(arguments.length<3&&(F=0),arguments.length<4&&(q=C.length);F<q;){var ie=F+q>>>1;ce(C[ie],z)<0?F=ie+1:q=ie}return F},right:function(C,z,F,q){for(arguments.length<3&&(F=0),arguments.length<4&&(q=C.length);F<q;){var ie=F+q>>>1;ce(C[ie],z)>0?q=ie:F=ie+1}return F}}}p.ascending=i,p.descending=function(ce,C){return C<ce?-1:C>ce?1:C>=ce?0:NaN},p.min=function(ce,C){var z,F,q=-1,ie=ce.length;if(arguments.length===1){for(;++q<ie;)if((F=ce[q])!=null&&F>=F){z=F;break}for(;++q<ie;)(F=ce[q])!=null&&z>F&&(z=F)}else{for(;++q<ie;)if((F=C.call(ce,ce[q],q))!=null&&F>=F){z=F;break}for(;++q<ie;)(F=C.call(ce,ce[q],q))!=null&&z>F&&(z=F)}return z},p.max=function(ce,C){var z,F,q=-1,ie=ce.length;if(arguments.length===1){for(;++q<ie;)if((F=ce[q])!=null&&F>=F){z=F;break}for(;++q<ie;)(F=ce[q])!=null&&F>z&&(z=F)}else{for(;++q<ie;)if((F=C.call(ce,ce[q],q))!=null&&F>=F){z=F;break}for(;++q<ie;)(F=C.call(ce,ce[q],q))!=null&&F>z&&(z=F)}return z},p.extent=function(ce,C){var z,F,q,ie=-1,ue=ce.length;if(arguments.length===1){for(;++ie<ue;)if((F=ce[ie])!=null&&F>=F){z=q=F;break}for(;++ie<ue;)(F=ce[ie])!=null&&(z>F&&(z=F),q<F&&(q=F))}else{for(;++ie<ue;)if((F=C.call(ce,ce[ie],ie))!=null&&F>=F){z=q=F;break}for(;++ie<ue;)(F=C.call(ce,ce[ie],ie))!=null&&(z>F&&(z=F),q<F&&(q=F))}return[z,q]},p.sum=function(ce,C){var z,F=0,q=ce.length,ie=-1;if(arguments.length===1)for(;++ie<q;)f(z=+ce[ie])&&(F+=z);else for(;++ie<q;)f(z=+C.call(ce,ce[ie],ie))&&(F+=z);return F},p.mean=function(ce,C){var z,F=0,q=ce.length,ie=-1,ue=q;if(arguments.length===1)for(;++ie<q;)f(z=u(ce[ie]))?F+=z:--ue;else for(;++ie<q;)f(z=u(C.call(ce,ce[ie],ie)))?F+=z:--ue;if(ue)return F/ue},p.quantile=function(ce,C){var z=(ce.length-1)*C+1,F=Math.floor(z),q=+ce[F-1],ie=z-F;return ie?q+ie*(ce[F]-q):q},p.median=function(ce,C){var z,F=[],q=ce.length,ie=-1;if(arguments.length===1)for(;++ie<q;)f(z=u(ce[ie]))&&F.push(z);else for(;++ie<q;)f(z=u(C.call(ce,ce[ie],ie)))&&F.push(z);if(F.length)return p.quantile(F.sort(i),.5)},p.variance=function(ce,C){var z,F,q=ce.length,ie=0,ue=0,ge=-1,we=0;if(arguments.length===1)for(;++ge<q;)f(z=u(ce[ge]))&&(ue+=(F=z-ie)*(z-(ie+=F/++we)));else for(;++ge<q;)f(z=u(C.call(ce,ce[ge],ge)))&&(ue+=(F=z-ie)*(z-(ie+=F/++we)));if(we>1)return ue/(we-1)},p.deviation=function(){var ce=p.variance.apply(this,arguments);return ce&&Math.sqrt(ce)};var h=l(i);function d(ce){return ce.length}p.bisectLeft=h.left,p.bisect=p.bisectRight=h.right,p.bisector=function(ce){return l(ce.length===1?function(C,z){return i(ce(C),z)}:ce)},p.shuffle=function(ce,C,z){(ie=arguments.length)<3&&(z=ce.length,ie<2&&(C=0));for(var F,q,ie=z-C;ie;)q=Math.random()*ie--|0,F=ce[ie+C],ce[ie+C]=ce[q+C],ce[q+C]=F;return ce},p.permute=function(ce,C){for(var z=C.length,F=new Array(z);z--;)F[z]=ce[C[z]];return F},p.pairs=function(ce){for(var C=0,z=ce.length-1,F=ce[0],q=new Array(z<0?0:z);C<z;)q[C]=[F,F=ce[++C]];return q},p.transpose=function(ce){if(!(q=ce.length))return[];for(var C=-1,z=p.min(ce,d),F=new Array(z);++C<z;)for(var q,ie=-1,ue=F[C]=new Array(q);++ie<q;)ue[ie]=ce[ie][C];return F},p.zip=function(){return p.transpose(arguments)},p.keys=function(ce){var C=[];for(var z in ce)C.push(z);return C},p.values=function(ce){var C=[];for(var z in ce)C.push(ce[z]);return C},p.entries=function(ce){var C=[];for(var z in ce)C.push({key:z,value:ce[z]});return C},p.merge=function(ce){for(var C,z,F,q=ce.length,ie=-1,ue=0;++ie<q;)ue+=ce[ie].length;for(z=new Array(ue);--q>=0;)for(C=(F=ce[q]).length;--C>=0;)z[--ue]=F[C];return z};var s=Math.abs;function x(ce){for(var C=1;ce*C%1;)C*=10;return C}function c(ce,C){for(var z in C)Object.defineProperty(ce.prototype,z,{value:C[z],enumerable:!1})}function T(){this._=Object.create(null)}p.range=function(ce,C,z){if(arguments.length<3&&(z=1,arguments.length<2&&(C=ce,ce=0)),(C-ce)/z==1/0)throw new Error("infinite range");var F,q=[],ie=x(s(z)),ue=-1;if(ce*=ie,C*=ie,(z*=ie)<0)for(;(F=ce+z*++ue)>C;)q.push(F/ie);else for(;(F=ce+z*++ue)<C;)q.push(F/ie);return q},p.map=function(ce,C){var z=new T;if(ce instanceof T)ce.forEach(function(ge,we){z.set(ge,we)});else if(Array.isArray(ce)){var F,q=-1,ie=ce.length;if(arguments.length===1)for(;++q<ie;)z.set(q,ce[q]);else for(;++q<ie;)z.set(C.call(ce,F=ce[q],q),F)}else for(var ue in ce)z.set(ue,ce[ue]);return z};function _(ce){return(ce+="")=="__proto__"||ce[0]==="\0"?"\0"+ce:ce}function w(ce){return(ce+="")[0]==="\0"?ce.slice(1):ce}function k(ce){return _(ce)in this._}function L(ce){return(ce=_(ce))in this._&&delete this._[ce]}function A(){var ce=[];for(var C in this._)ce.push(w(C));return ce}function I(){var ce=0;for(var C in this._)++ce;return ce}function P(){for(var ce in this._)return!1;return!0}function S(){this._=Object.create(null)}function E(ce){return ce}function D(ce,C,z){return function(){var F=z.apply(C,arguments);return F===C?ce:F}}function R(ce,C){if(C in ce)return C;C=C.charAt(0).toUpperCase()+C.slice(1);for(var z=0,F=H.length;z<F;++z){var q=H[z]+C;if(q in ce)return q}}c(T,{has:k,get:function(ce){return this._[_(ce)]},set:function(ce,C){return this._[_(ce)]=C},remove:L,keys:A,values:function(){var ce=[];for(var C in this._)ce.push(this._[C]);return ce},entries:function(){var ce=[];for(var C in this._)ce.push({key:w(C),value:this._[C]});return ce},size:I,empty:P,forEach:function(ce){for(var C in this._)ce.call(this,w(C),this._[C])}}),p.nest=function(){var ce,C,z={},F=[],q=[];function ie(ue,ge,we){if(we>=F.length)return C?C.call(z,ge):ce?ge.sort(ce):ge;for(var Se,Ve,Je,at,bt=-1,Et=ge.length,kt=F[we++],At=new T;++bt<Et;)(at=At.get(Se=kt(Ve=ge[bt])))?at.push(Ve):At.set(Se,[Ve]);return ue?(Ve=ue(),Je=function(xt,zt){Ve.set(xt,ie(ue,zt,we))}):(Ve={},Je=function(xt,zt){Ve[xt]=ie(ue,zt,we)}),At.forEach(Je),Ve}return z.map=function(ue,ge){return ie(ge,ue,0)},z.entries=function(ue){return function ge(we,Se){if(Se>=F.length)return we;var Ve=[],Je=q[Se++];return we.forEach(function(at,bt){Ve.push({key:at,values:ge(bt,Se)})}),Je?Ve.sort(function(at,bt){return Je(at.key,bt.key)}):Ve}(ie(p.map,ue,0),0)},z.key=function(ue){return F.push(ue),z},z.sortKeys=function(ue){return q[F.length-1]=ue,z},z.sortValues=function(ue){return ce=ue,z},z.rollup=function(ue){return C=ue,z},z},p.set=function(ce){var C=new S;if(ce)for(var z=0,F=ce.length;z<F;++z)C.add(ce[z]);return C},c(S,{has:k,add:function(ce){return this._[_(ce+="")]=!0,ce},remove:L,values:A,size:I,empty:P,forEach:function(ce){for(var C in this._)ce.call(this,w(C))}}),p.behavior={},p.rebind=function(ce,C){for(var z,F=1,q=arguments.length;++F<q;)ce[z=arguments[F]]=D(ce,C,C[z]);return ce};var H=["webkit","ms","moz","Moz","o","O"];function V(){}function X(){}function $(ce){var C=[],z=new T;function F(){for(var q,ie=C,ue=-1,ge=ie.length;++ue<ge;)(q=ie[ue].on)&&q.apply(this,arguments);return ce}return F.on=function(q,ie){var ue,ge=z.get(q);return arguments.length<2?ge&&ge.on:(ge&&(ge.on=null,C=C.slice(0,ue=C.indexOf(ge)).concat(C.slice(ue+1)),z.remove(q)),ie&&C.push(z.set(q,{on:ie})),ce)},F}function G(){p.event.preventDefault()}function W(){for(var ce,C=p.event;ce=C.sourceEvent;)C=ce;return C}function te(ce){for(var C=new X,z=0,F=arguments.length;++z<F;)C[arguments[z]]=$(C);return C.of=function(q,ie){return function(ue){try{var ge=ue.sourceEvent=p.event;ue.target=ce,p.event=ue,C[ue.type].apply(q,ie)}finally{p.event=ge}}},C}p.dispatch=function(){for(var ce=new X,C=-1,z=arguments.length;++C<z;)ce[arguments[C]]=$(ce);return ce},X.prototype.on=function(ce,C){var z=ce.indexOf("."),F="";if(z>=0&&(F=ce.slice(z+1),ce=ce.slice(0,z)),ce)return arguments.length<2?this[ce].on(F):this[ce].on(F,C);if(arguments.length===2){if(C==null)for(ce in this)this.hasOwnProperty(ce)&&this[ce].on(F,null);return this}},p.event=null,p.requote=function(ce){return ce.replace(N,"\\$&")};var N=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,B={}.__proto__?function(ce,C){ce.__proto__=C}:function(ce,C){for(var z in C)ce[z]=C[z]};function U(ce){return B(ce,K),ce}var ee=function(ce,C){return C.querySelector(ce)},j=function(ce,C){return C.querySelectorAll(ce)},Q=function(ce,C){var z=ce.matches||ce[R(ce,"matchesSelector")];return(Q=function(F,q){return z.call(F,q)})(ce,C)};typeof Sizzle=="function"&&(ee=function(ce,C){return Sizzle(ce,C)[0]||null},j=Sizzle,Q=Sizzle.matchesSelector),p.selection=function(){return p.select(y.documentElement)};var K=p.selection.prototype=[];function re(ce){return typeof ce=="function"?ce:function(){return ee(ce,this)}}function ne(ce){return typeof ce=="function"?ce:function(){return j(ce,this)}}K.select=function(ce){var C,z,F,q,ie=[];ce=re(ce);for(var ue=-1,ge=this.length;++ue<ge;){ie.push(C=[]),C.parentNode=(F=this[ue]).parentNode;for(var we=-1,Se=F.length;++we<Se;)(q=F[we])?(C.push(z=ce.call(q,q.__data__,we,ue)),z&&"__data__"in q&&(z.__data__=q.__data__)):C.push(null)}return U(ie)},K.selectAll=function(ce){var C,z,F=[];ce=ne(ce);for(var q=-1,ie=this.length;++q<ie;)for(var ue=this[q],ge=-1,we=ue.length;++ge<we;)(z=ue[ge])&&(F.push(C=b(ce.call(z,z.__data__,ge,q))),C.parentNode=z);return U(F)};var le="http://www.w3.org/1999/xhtml",oe={svg:"http://www.w3.org/2000/svg",xhtml:le,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function de(ce,C){return ce=p.ns.qualify(ce),C==null?ce.local?function(){this.removeAttributeNS(ce.space,ce.local)}:function(){this.removeAttribute(ce)}:typeof C=="function"?ce.local?function(){var z=C.apply(this,arguments);z==null?this.removeAttributeNS(ce.space,ce.local):this.setAttributeNS(ce.space,ce.local,z)}:function(){var z=C.apply(this,arguments);z==null?this.removeAttribute(ce):this.setAttribute(ce,z)}:ce.local?function(){this.setAttributeNS(ce.space,ce.local,C)}:function(){this.setAttribute(ce,C)}}function se(ce){return ce.trim().replace(/\s+/g," ")}function me(ce){return new RegExp("(?:^|\\s+)"+p.requote(ce)+"(?:\\s+|$)","g")}function Te(ce){return(ce+"").trim().split(/^|\s+/)}function _e(ce,C){var z=(ce=Te(ce).map(be)).length;return typeof C=="function"?function(){for(var F=-1,q=C.apply(this,arguments);++F<z;)ce[F](this,q)}:function(){for(var F=-1;++F<z;)ce[F](this,C)}}function be(ce){var C=me(ce);return function(z,F){if(q=z.classList)return F?q.add(ce):q.remove(ce);var q=z.getAttribute("class")||"";F?(C.lastIndex=0,C.test(q)||z.setAttribute("class",se(q+" "+ce))):z.setAttribute("class",se(q.replace(C," ")))}}function Ce(ce,C,z){return C==null?function(){this.style.removeProperty(ce)}:typeof C=="function"?function(){var F=C.apply(this,arguments);F==null?this.style.removeProperty(ce):this.style.setProperty(ce,F,z)}:function(){this.style.setProperty(ce,C,z)}}function fe(ce,C){return C==null?function(){delete this[ce]}:typeof C=="function"?function(){var z=C.apply(this,arguments);z==null?delete this[ce]:this[ce]=z}:function(){this[ce]=C}}function ve(ce){return typeof ce=="function"?ce:(ce=p.ns.qualify(ce)).local?function(){return this.ownerDocument.createElementNS(ce.space,ce.local)}:function(){var C=this.ownerDocument,z=this.namespaceURI;return z===le&&C.documentElement.namespaceURI===le?C.createElement(ce):C.createElementNS(z,ce)}}function Me(){var ce=this.parentNode;ce&&ce.removeChild(this)}function ke(ce){return{__data__:ce}}function Le(ce){return function(){return Q(this,ce)}}function ze(ce){return arguments.length||(ce=i),function(C,z){return C&&z?ce(C.__data__,z.__data__):!C-!z}}function Re(ce,C){for(var z=0,F=ce.length;z<F;z++)for(var q,ie=ce[z],ue=0,ge=ie.length;ue<ge;ue++)(q=ie[ue])&&C(q,ue,z);return ce}function Oe(ce){return B(ce,Ze),ce}p.ns={prefix:oe,qualify:function(ce){var C=ce.indexOf(":"),z=ce;return C>=0&&(z=ce.slice(0,C))!=="xmlns"&&(ce=ce.slice(C+1)),oe.hasOwnProperty(z)?{space:oe[z],local:ce}:ce}},K.attr=function(ce,C){if(arguments.length<2){if(typeof ce=="string"){var z=this.node();return(ce=p.ns.qualify(ce)).local?z.getAttributeNS(ce.space,ce.local):z.getAttribute(ce)}for(C in ce)this.each(de(C,ce[C]));return this}return this.each(de(ce,C))},K.classed=function(ce,C){if(arguments.length<2){if(typeof ce=="string"){var z=this.node(),F=(ce=Te(ce)).length,q=-1;if(C=z.classList){for(;++q<F;)if(!C.contains(ce[q]))return!1}else for(C=z.getAttribute("class");++q<F;)if(!me(ce[q]).test(C))return!1;return!0}for(C in ce)this.each(_e(C,ce[C]));return this}return this.each(_e(ce,C))},K.style=function(ce,C,z){var F=arguments.length;if(F<3){if(typeof ce!="string"){for(z in F<2&&(C=""),ce)this.each(Ce(z,ce[z],C));return this}if(F<2){var q=this.node();return n(q).getComputedStyle(q,null).getPropertyValue(ce)}z=""}return this.each(Ce(ce,C,z))},K.property=function(ce,C){if(arguments.length<2){if(typeof ce=="string")return this.node()[ce];for(C in ce)this.each(fe(C,ce[C]));return this}return this.each(fe(ce,C))},K.text=function(ce){return arguments.length?this.each(typeof ce=="function"?function(){var C=ce.apply(this,arguments);this.textContent=C==null?"":C}:ce==null?function(){this.textContent=""}:function(){this.textContent=ce}):this.node().textContent},K.html=function(ce){return arguments.length?this.each(typeof ce=="function"?function(){var C=ce.apply(this,arguments);this.innerHTML=C==null?"":C}:ce==null?function(){this.innerHTML=""}:function(){this.innerHTML=ce}):this.node().innerHTML},K.append=function(ce){return ce=ve(ce),this.select(function(){return this.appendChild(ce.apply(this,arguments))})},K.insert=function(ce,C){return ce=ve(ce),C=re(C),this.select(function(){return this.insertBefore(ce.apply(this,arguments),C.apply(this,arguments)||null)})},K.remove=function(){return this.each(Me)},K.data=function(ce,C){var z,F,q=-1,ie=this.length;if(!arguments.length){for(ce=new Array(ie=(z=this[0]).length);++q<ie;)(F=z[q])&&(ce[q]=F.__data__);return ce}function ue(Ve,Je){var at,bt,Et,kt=Ve.length,At=Je.length,xt=Math.min(kt,At),zt=new Array(At),It=new Array(At),Bt=new Array(kt);if(C){var nr,gr=new T,Lr=new Array(kt);for(at=-1;++at<kt;)(bt=Ve[at])&&(gr.has(nr=C.call(bt,bt.__data__,at))?Bt[at]=bt:gr.set(nr,bt),Lr[at]=nr);for(at=-1;++at<At;)(bt=gr.get(nr=C.call(Je,Et=Je[at],at)))?bt!==!0&&(zt[at]=bt,bt.__data__=Et):It[at]=ke(Et),gr.set(nr,!0);for(at=-1;++at<kt;)at in Lr&&gr.get(Lr[at])!==!0&&(Bt[at]=Ve[at])}else{for(at=-1;++at<xt;)bt=Ve[at],Et=Je[at],bt?(bt.__data__=Et,zt[at]=bt):It[at]=ke(Et);for(;at<At;++at)It[at]=ke(Je[at]);for(;at<kt;++at)Bt[at]=Ve[at]}It.update=zt,It.parentNode=zt.parentNode=Bt.parentNode=Ve.parentNode,ge.push(It),we.push(zt),Se.push(Bt)}var ge=Oe([]),we=U([]),Se=U([]);if(typeof ce=="function")for(;++q<ie;)ue(z=this[q],ce.call(z,z.parentNode.__data__,q));else for(;++q<ie;)ue(z=this[q],ce);return we.enter=function(){return ge},we.exit=function(){return Se},we},K.datum=function(ce){return arguments.length?this.property("__data__",ce):this.property("__data__")},K.filter=function(ce){var C,z,F,q=[];typeof ce!="function"&&(ce=Le(ce));for(var ie=0,ue=this.length;ie<ue;ie++){q.push(C=[]),C.parentNode=(z=this[ie]).parentNode;for(var ge=0,we=z.length;ge<we;ge++)(F=z[ge])&&ce.call(F,F.__data__,ge,ie)&&C.push(F)}return U(q)},K.order=function(){for(var ce=-1,C=this.length;++ce<C;)for(var z,F=this[ce],q=F.length-1,ie=F[q];--q>=0;)(z=F[q])&&(ie&&ie!==z.nextSibling&&ie.parentNode.insertBefore(z,ie),ie=z);return this},K.sort=function(ce){ce=ze.apply(this,arguments);for(var C=-1,z=this.length;++C<z;)this[C].sort(ce);return this.order()},K.each=function(ce){return Re(this,function(C,z,F){ce.call(C,C.__data__,z,F)})},K.call=function(ce){var C=b(arguments);return ce.apply(C[0]=this,C),this},K.empty=function(){return!this.node()},K.node=function(){for(var ce=0,C=this.length;ce<C;ce++)for(var z=this[ce],F=0,q=z.length;F<q;F++){var ie=z[F];if(ie)return ie}return null},K.size=function(){var ce=0;return Re(this,function(){++ce}),ce};var Ze=[];function Pe(ce){var C,z;return function(F,q,ie){var ue,ge=ce[ie].update,we=ge.length;for(ie!=z&&(z=ie,C=0),q>=C&&(C=q+1);!(ue=ge[C])&&++C<we;);return ue}}function Ie(ce,C,z){var F="__on"+ce,q=ce.indexOf("."),ie=Fe;q>0&&(ce=ce.slice(0,q));var ue=Be.get(ce);function ge(){var we=this[F];we&&(this.removeEventListener(ce,we,we.$),delete this[F])}return ue&&(ce=ue,ie=$e),q?C?function(){var we=ie(C,b(arguments));ge.call(this),this.addEventListener(ce,this[F]=we,we.$=z),we._=C}:ge:C?V:function(){var we,Se=new RegExp("^__on([^.]+)"+p.requote(ce)+"$");for(var Ve in this)if(we=Ve.match(Se)){var Je=this[Ve];this.removeEventListener(we[1],Je,Je.$),delete this[Ve]}}}p.selection.enter=Oe,p.selection.enter.prototype=Ze,Ze.append=K.append,Ze.empty=K.empty,Ze.node=K.node,Ze.call=K.call,Ze.size=K.size,Ze.select=function(ce){for(var C,z,F,q,ie,ue=[],ge=-1,we=this.length;++ge<we;){F=(q=this[ge]).update,ue.push(C=[]),C.parentNode=q.parentNode;for(var Se=-1,Ve=q.length;++Se<Ve;)(ie=q[Se])?(C.push(F[Se]=z=ce.call(q.parentNode,ie.__data__,Se,ge)),z.__data__=ie.__data__):C.push(null)}return U(ue)},Ze.insert=function(ce,C){return arguments.length<2&&(C=Pe(this)),K.insert.call(this,ce,C)},p.select=function(ce){var C;return typeof ce=="string"?(C=[ee(ce,y)]).parentNode=y.documentElement:(C=[ce]).parentNode=e(ce),U([C])},p.selectAll=function(ce){var C;return typeof ce=="string"?(C=b(j(ce,y))).parentNode=y.documentElement:(C=b(ce)).parentNode=null,U([C])},K.on=function(ce,C,z){var F=arguments.length;if(F<3){if(typeof ce!="string"){for(z in F<2&&(C=!1),ce)this.each(Ie(z,ce[z],C));return this}if(F<2)return(F=this.node()["__on"+ce])&&F._;z=!1}return this.each(Ie(ce,C,z))};var Be=p.map({mouseenter:"mouseover",mouseleave:"mouseout"});function Fe(ce,C){return function(z){var F=p.event;p.event=z,C[0]=this.__data__;try{ce.apply(this,C)}finally{p.event=F}}}function $e(ce,C){var z=Fe(ce,C);return function(F){var q=F.relatedTarget;q&&(q===this||8&q.compareDocumentPosition(this))||z.call(this,F)}}y&&Be.forEach(function(ce){"on"+ce in y&&Be.remove(ce)});var ot,pt=0;function _t(ce){var C=".dragsuppress-"+ ++pt,z="click"+C,F=p.select(n(ce)).on("touchmove"+C,G).on("dragstart"+C,G).on("selectstart"+C,G);if(ot==null&&(ot=!("onselectstart"in ce)&&R(ce.style,"userSelect")),ot){var q=e(ce).style,ie=q[ot];q[ot]="none"}return function(ue){if(F.on(C,null),ot&&(q[ot]=ie),ue){var ge=function(){F.on(z,null)};F.on(z,function(){G(),ge()},!0),setTimeout(ge,0)}}}p.mouse=function(ce){return tt(ce,W())};var yt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function tt(ce,C){C.changedTouches&&(C=C.changedTouches[0]);var z=ce.ownerSVGElement||ce;if(z.createSVGPoint){var F=z.createSVGPoint();if(yt<0){var q=n(ce);if(q.scrollX||q.scrollY){var ie=(z=p.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();yt=!(ie.f||ie.e),z.remove()}}return yt?(F.x=C.pageX,F.y=C.pageY):(F.x=C.clientX,F.y=C.clientY),[(F=F.matrixTransform(ce.getScreenCTM().inverse())).x,F.y]}var ue=ce.getBoundingClientRect();return[C.clientX-ue.left-ce.clientLeft,C.clientY-ue.top-ce.clientTop]}function Ke(){return p.event.changedTouches[0].identifier}p.touch=function(ce,C,z){if(arguments.length<3&&(z=C,C=W().changedTouches),C){for(var F,q=0,ie=C.length;q<ie;++q)if((F=C[q]).identifier===z)return tt(ce,F)}},p.behavior.drag=function(){var ce=te(q,"drag","dragstart","dragend"),C=null,z=ie(V,p.mouse,n,"mousemove","mouseup"),F=ie(Ke,p.touch,E,"touchmove","touchend");function q(){this.on("mousedown.drag",z).on("touchstart.drag",F)}function ie(ue,ge,we,Se,Ve){return function(){var Je,at=this,bt=p.event.target.correspondingElement||p.event.target,Et=at.parentNode,kt=ce.of(at,arguments),At=0,xt=ue(),zt=".drag"+(xt==null?"":"-"+xt),It=p.select(we(bt)).on(Se+zt,gr).on(Ve+zt,Lr),Bt=_t(bt),nr=ge(Et,xt);function gr(){var Sr,$r,Qr=ge(Et,xt);Qr&&(Sr=Qr[0]-nr[0],$r=Qr[1]-nr[1],At|=Sr|$r,nr=Qr,kt({type:"drag",x:Qr[0]+Je[0],y:Qr[1]+Je[1],dx:Sr,dy:$r}))}function Lr(){ge(Et,xt)&&(It.on(Se+zt,null).on(Ve+zt,null),Bt(At),kt({type:"dragend"}))}Je=C?[(Je=C.apply(at,arguments)).x-nr[0],Je.y-nr[1]]:[0,0],kt({type:"dragstart"})}}return q.origin=function(ue){return arguments.length?(C=ue,q):C},p.rebind(q,ce,"on")},p.touches=function(ce,C){return arguments.length<2&&(C=W().touches),C?b(C).map(function(z){var F=tt(ce,z);return F.identifier=z.identifier,F}):[]};var vt=1e-6,Nt=Math.PI,qt=2*Nt,er=qt-vt,Jt=Nt/2,ir=Nt/180,Ht=180/Nt;function Ue(ce){return ce>1?Jt:ce<-1?-Jt:Math.asin(ce)}function We(ce){return((ce=Math.exp(ce))+1/ce)/2}var he=Math.SQRT2;p.interpolateZoom=function(ce,C){var z,F,q=ce[0],ie=ce[1],ue=ce[2],ge=C[0],we=C[1],Se=C[2],Ve=ge-q,Je=we-ie,at=Ve*Ve+Je*Je;if(at<1e-12)F=Math.log(Se/ue)/he,z=function(zt){return[q+zt*Ve,ie+zt*Je,ue*Math.exp(he*zt*F)]};else{var bt=Math.sqrt(at),Et=(Se*Se-ue*ue+4*at)/(2*ue*2*bt),kt=(Se*Se-ue*ue-4*at)/(2*Se*2*bt),At=Math.log(Math.sqrt(Et*Et+1)-Et),xt=Math.log(Math.sqrt(kt*kt+1)-kt);F=(xt-At)/he,z=function(zt){var It,Bt=zt*F,nr=We(At),gr=ue/(2*bt)*(nr*(It=he*Bt+At,((It=Math.exp(2*It))-1)/(It+1))-function(Lr){return((Lr=Math.exp(Lr))-1/Lr)/2}(At));return[q+gr*Ve,ie+gr*Je,ue*nr/We(he*Bt+At)]}}return z.duration=1e3*F,z},p.behavior.zoom=function(){var ce,C,z,F,q,ie,ue,ge,we,Se={x:0,y:0,k:1},Ve=[960,500],Je=qe,at=250,bt=0,Et="mousedown.zoom",kt="mousemove.zoom",At="mouseup.zoom",xt="touchstart.zoom",zt=te(It,"zoomstart","zoom","zoomend");function It(Wr){Wr.on(Et,sn).on(De+".zoom",Jn).on("dblclick.zoom",ha).on(xt,Vn)}function Bt(Wr){return[(Wr[0]-Se.x)/Se.k,(Wr[1]-Se.y)/Se.k]}function nr(Wr){Se.k=Math.max(Je[0],Math.min(Je[1],Wr))}function gr(Wr,Mn){Mn=function(Kn){return[Kn[0]*Se.k+Se.x,Kn[1]*Se.k+Se.y]}(Mn),Se.x+=Wr[0]-Mn[0],Se.y+=Wr[1]-Mn[1]}function Lr(Wr,Mn,Kn,Yn){Wr.__chart__={x:Se.x,y:Se.y,k:Se.k},nr(Math.pow(2,Yn)),gr(C=Mn,Kn),Wr=p.select(Wr),at>0&&(Wr=Wr.transition().duration(at)),Wr.call(It.event)}function Sr(){ue&&ue.domain(ie.range().map(function(Wr){return(Wr-Se.x)/Se.k}).map(ie.invert)),we&&we.domain(ge.range().map(function(Wr){return(Wr-Se.y)/Se.k}).map(ge.invert))}function $r(Wr){bt++||Wr({type:"zoomstart"})}function Qr(Wr){Sr(),Wr({type:"zoom",scale:Se.k,translate:[Se.x,Se.y]})}function fn(Wr){--bt||(Wr({type:"zoomend"}),C=null)}function sn(){var Wr=this,Mn=zt.of(Wr,arguments),Kn=0,Yn=p.select(n(Wr)).on(kt,La).on(At,ta),ia=Bt(p.mouse(Wr)),da=_t(Wr);function La(){Kn=1,gr(p.mouse(Wr),ia),Qr(Mn)}function ta(){Yn.on(kt,null).on(At,null),da(Kn),fn(Mn)}Is.call(Wr),$r(Mn)}function Vn(){var Wr,Mn=this,Kn=zt.of(Mn,arguments),Yn={},ia=0,da=".zoom-"+p.event.changedTouches[0].identifier,La="touchmove"+da,ta="touchend"+da,_a=[],ya=p.select(Mn),Ia=_t(Mn);function wa(){var Di=p.touches(Mn);return Wr=Se.k,Di.forEach(function(Ri){Ri.identifier in Yn&&(Yn[Ri.identifier]=Bt(Ri))}),Di}function Oa(){var Di=p.event.target;p.select(Di).on(La,Ha).on(ta,di),_a.push(Di);for(var Ri=p.event.changedTouches,pi=0,Ei=Ri.length;pi<Ei;++pi)Yn[Ri[pi].identifier]=null;var bi=wa(),Mo=Date.now();if(bi.length===1){if(Mo-q<500){var Zi=bi[0];Lr(Mn,Zi,Yn[Zi.identifier],Math.floor(Math.log(Se.k)/Math.LN2)+1),G()}q=Mo}else if(bi.length>1){Zi=bi[0];var Uo=bi[1],As=Zi[0]-Uo[0],Xs=Zi[1]-Uo[1];ia=As*As+Xs*Xs}}function Ha(){var Di,Ri,pi,Ei,bi=p.touches(Mn);Is.call(Mn);for(var Mo=0,Zi=bi.length;Mo<Zi;++Mo,Ei=null)if(pi=bi[Mo],Ei=Yn[pi.identifier]){if(Ri)break;Di=pi,Ri=Ei}if(Ei){var Uo=(Uo=pi[0]-Di[0])*Uo+(Uo=pi[1]-Di[1])*Uo,As=ia&&Math.sqrt(Uo/ia);Di=[(Di[0]+pi[0])/2,(Di[1]+pi[1])/2],Ri=[(Ri[0]+Ei[0])/2,(Ri[1]+Ei[1])/2],nr(As*Wr)}q=null,gr(Di,Ri),Qr(Kn)}function di(){if(p.event.touches.length){for(var Di=p.event.changedTouches,Ri=0,pi=Di.length;Ri<pi;++Ri)delete Yn[Di[Ri].identifier];for(var Ei in Yn)return void wa()}p.selectAll(_a).on(da,null),ya.on(Et,sn).on(xt,Vn),Ia(),fn(Kn)}Oa(),$r(Kn),ya.on(Et,null).on(xt,Oa)}function Jn(){var Wr=zt.of(this,arguments);F?clearTimeout(F):(Is.call(this),ce=Bt(C=z||p.mouse(this)),$r(Wr)),F=setTimeout(function(){F=null,fn(Wr)},50),G(),nr(Math.pow(2,.002*xe())*Se.k),gr(C,ce),Qr(Wr)}function ha(){var Wr=p.mouse(this),Mn=Math.log(Se.k)/Math.LN2;Lr(this,Wr,Bt(Wr),p.event.shiftKey?Math.ceil(Mn)-1:Math.floor(Mn)+1)}return De||(De="onwheel"in y?(xe=function(){return-p.event.deltaY*(p.event.deltaMode?120:1)},"wheel"):"onmousewheel"in y?(xe=function(){return p.event.wheelDelta},"mousewheel"):(xe=function(){return-p.event.detail},"MozMousePixelScroll")),It.event=function(Wr){Wr.each(function(){var Mn=zt.of(this,arguments),Kn=Se;bs?p.select(this).transition().each("start.zoom",function(){Se=this.__chart__||{x:0,y:0,k:1},$r(Mn)}).tween("zoom:zoom",function(){var Yn=Ve[0],ia=Ve[1],da=C?C[0]:Yn/2,La=C?C[1]:ia/2,ta=p.interpolateZoom([(da-Se.x)/Se.k,(La-Se.y)/Se.k,Yn/Se.k],[(da-Kn.x)/Kn.k,(La-Kn.y)/Kn.k,Yn/Kn.k]);return function(_a){var ya=ta(_a),Ia=Yn/ya[2];this.__chart__=Se={x:da-ya[0]*Ia,y:La-ya[1]*Ia,k:Ia},Qr(Mn)}}).each("interrupt.zoom",function(){fn(Mn)}).each("end.zoom",function(){fn(Mn)}):(this.__chart__=Se,$r(Mn),Qr(Mn),fn(Mn))})},It.translate=function(Wr){return arguments.length?(Se={x:+Wr[0],y:+Wr[1],k:Se.k},Sr(),It):[Se.x,Se.y]},It.scale=function(Wr){return arguments.length?(Se={x:Se.x,y:Se.y,k:null},nr(+Wr),Sr(),It):Se.k},It.scaleExtent=function(Wr){return arguments.length?(Je=Wr==null?qe:[+Wr[0],+Wr[1]],It):Je},It.center=function(Wr){return arguments.length?(z=Wr&&[+Wr[0],+Wr[1]],It):z},It.size=function(Wr){return arguments.length?(Ve=Wr&&[+Wr[0],+Wr[1]],It):Ve},It.duration=function(Wr){return arguments.length?(at=+Wr,It):at},It.x=function(Wr){return arguments.length?(ue=Wr,ie=Wr.copy(),Se={x:0,y:0,k:1},It):ue},It.y=function(Wr){return arguments.length?(we=Wr,ge=Wr.copy(),Se={x:0,y:0,k:1},It):we},p.rebind(It,zt,"on")};var xe,De,qe=[0,1/0];function Xe(){}function He(ce,C,z){return this instanceof He?(this.h=+ce,this.s=+C,void(this.l=+z)):arguments.length<2?ce instanceof He?new He(ce.h,ce.s,ce.l):Ar(""+ce,fr,He):new He(ce,C,z)}p.color=Xe,Xe.prototype.toString=function(){return this.rgb()+""},p.hsl=He;var st=He.prototype=new Xe;function it(ce,C,z){var F,q;function ie(ue){return Math.round(255*function(ge){return ge>360?ge-=360:ge<0&&(ge+=360),ge<60?F+(q-F)*ge/60:ge<180?q:ge<240?F+(q-F)*(240-ge)/60:F}(ue))}return ce=isNaN(ce)?0:(ce%=360)<0?ce+360:ce,C=isNaN(C)||C<0?0:C>1?1:C,F=2*(z=z<0?0:z>1?1:z)-(q=z<=.5?z*(1+C):z+C-z*C),new Mt(ie(ce+120),ie(ce),ie(ce-120))}function Tt(ce,C,z){return this instanceof Tt?(this.h=+ce,this.c=+C,void(this.l=+z)):arguments.length<2?ce instanceof Tt?new Tt(ce.h,ce.c,ce.l):Ae(ce instanceof ut?ce.l:(ce=Zt((ce=p.rgb(ce)).r,ce.g,ce.b)).l,ce.a,ce.b):new Tt(ce,C,z)}st.brighter=function(ce){return ce=Math.pow(.7,arguments.length?ce:1),new He(this.h,this.s,this.l/ce)},st.darker=function(ce){return ce=Math.pow(.7,arguments.length?ce:1),new He(this.h,this.s,ce*this.l)},st.rgb=function(){return it(this.h,this.s,this.l)},p.hcl=Tt;var Pt=Tt.prototype=new Xe;function rt(ce,C,z){return isNaN(ce)&&(ce=0),isNaN(C)&&(C=0),new ut(z,Math.cos(ce*=ir)*C,Math.sin(ce)*C)}function ut(ce,C,z){return this instanceof ut?(this.l=+ce,this.a=+C,void(this.b=+z)):arguments.length<2?ce instanceof ut?new ut(ce.l,ce.a,ce.b):ce instanceof Tt?rt(ce.h,ce.c,ce.l):Zt((ce=Mt(ce)).r,ce.g,ce.b):new ut(ce,C,z)}Pt.brighter=function(ce){return new Tt(this.h,this.c,Math.min(100,this.l+Ft*(arguments.length?ce:1)))},Pt.darker=function(ce){return new Tt(this.h,this.c,Math.max(0,this.l-Ft*(arguments.length?ce:1)))},Pt.rgb=function(){return rt(this.h,this.c,this.l).rgb()},p.lab=ut;var Ft=18,wt=ut.prototype=new Xe;function Lt(ce,C,z){var F=(ce+16)/116,q=F+C/500,ie=F-z/200;return new Mt(ft(3.2404542*(q=.95047*Ye(q))-1.5371385*(F=1*Ye(F))-.4985314*(ie=1.08883*Ye(ie))),ft(-.969266*q+1.8760108*F+.041556*ie),ft(.0556434*q-.2040259*F+1.0572252*ie))}function Ae(ce,C,z){return ce>0?new Tt(Math.atan2(z,C)*Ht,Math.sqrt(C*C+z*z),ce):new Tt(NaN,NaN,ce)}function Ye(ce){return ce>.206893034?ce*ce*ce:(ce-4/29)/7.787037}function nt(ce){return ce>.008856?Math.pow(ce,1/3):7.787037*ce+4/29}function ft(ce){return Math.round(255*(ce<=.00304?12.92*ce:1.055*Math.pow(ce,1/2.4)-.055))}function Mt(ce,C,z){return this instanceof Mt?(this.r=~~ce,this.g=~~C,void(this.b=~~z)):arguments.length<2?ce instanceof Mt?new Mt(ce.r,ce.g,ce.b):Ar(""+ce,Mt,it):new Mt(ce,C,z)}function Rt(ce){return new Mt(ce>>16,ce>>8&255,255&ce)}function Gt(ce){return Rt(ce)+""}wt.brighter=function(ce){return new ut(Math.min(100,this.l+Ft*(arguments.length?ce:1)),this.a,this.b)},wt.darker=function(ce){return new ut(Math.max(0,this.l-Ft*(arguments.length?ce:1)),this.a,this.b)},wt.rgb=function(){return Lt(this.l,this.a,this.b)},p.rgb=Mt;var jt=Mt.prototype=new Xe;function pr(ce){return ce<16?"0"+Math.max(0,ce).toString(16):Math.min(255,ce).toString(16)}function Ar(ce,C,z){var F,q,ie,ue=0,ge=0,we=0;if(F=/([a-z]+)\((.*)\)/.exec(ce=ce.toLowerCase()))switch(q=F[2].split(","),F[1]){case"hsl":return z(parseFloat(q[0]),parseFloat(q[1])/100,parseFloat(q[2])/100);case"rgb":return C($t(q[0]),$t(q[1]),$t(q[2]))}return(ie=hr.get(ce))?C(ie.r,ie.g,ie.b):(ce==null||ce.charAt(0)!=="#"||isNaN(ie=parseInt(ce.slice(1),16))||(ce.length===4?(ue=(3840&ie)>>4,ue|=ue>>4,ge=240&ie,ge|=ge>>4,we=15&ie,we|=we<<4):ce.length===7&&(ue=(16711680&ie)>>16,ge=(65280&ie)>>8,we=255&ie)),C(ue,ge,we))}function fr(ce,C,z){var F,q,ie=Math.min(ce/=255,C/=255,z/=255),ue=Math.max(ce,C,z),ge=ue-ie,we=(ue+ie)/2;return ge?(q=we<.5?ge/(ue+ie):ge/(2-ue-ie),F=ce==ue?(C-z)/ge+(C<z?6:0):C==ue?(z-ce)/ge+2:(ce-C)/ge+4,F*=60):(F=NaN,q=we>0&&we<1?0:F),new He(F,q,we)}function Zt(ce,C,z){var F=nt((.4124564*(ce=Qt(ce))+.3575761*(C=Qt(C))+.1804375*(z=Qt(z)))/.95047),q=nt((.2126729*ce+.7151522*C+.072175*z)/1);return ut(116*q-16,500*(F-q),200*(q-nt((.0193339*ce+.119192*C+.9503041*z)/1.08883)))}function Qt(ce){return(ce/=255)<=.04045?ce/12.92:Math.pow((ce+.055)/1.055,2.4)}function $t(ce){var C=parseFloat(ce);return ce.charAt(ce.length-1)==="%"?Math.round(2.55*C):C}jt.brighter=function(ce){ce=Math.pow(.7,arguments.length?ce:1);var C=this.r,z=this.g,F=this.b,q=30;return C||z||F?(C&&C<q&&(C=q),z&&z<q&&(z=q),F&&F<q&&(F=q),new Mt(Math.min(255,C/ce),Math.min(255,z/ce),Math.min(255,F/ce))):new Mt(q,q,q)},jt.darker=function(ce){return new Mt((ce=Math.pow(.7,arguments.length?ce:1))*this.r,ce*this.g,ce*this.b)},jt.hsl=function(){return fr(this.r,this.g,this.b)},jt.toString=function(){return"#"+pr(this.r)+pr(this.g)+pr(this.b)};var hr=p.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function vr(ce){return typeof ce=="function"?ce:function(){return ce}}function Mr(ce){return function(C,z,F){return arguments.length===2&&typeof z=="function"&&(F=z,z=null),Nr(C,z,ce,F)}}function Nr(ce,C,z,F){var q={},ie=p.dispatch("beforesend","progress","load","error"),ue={},ge=new XMLHttpRequest,we=null;function Se(){var Ve,Je=ge.status;if(!Je&&function(at){var bt=at.responseType;return bt&&bt!=="text"?at.response:at.responseText}(ge)||Je>=200&&Je<300||Je===304){try{Ve=z.call(q,ge)}catch(at){return void ie.error.call(q,at)}ie.load.call(q,Ve)}else ie.error.call(q,ge)}return self.XDomainRequest&&!("withCredentials"in ge)&&/^(http(s)?:)?\/\//.test(ce)&&(ge=new XDomainRequest),"onload"in ge?ge.onload=ge.onerror=Se:ge.onreadystatechange=function(){ge.readyState>3&&Se()},ge.onprogress=function(Ve){var Je=p.event;p.event=Ve;try{ie.progress.call(q,ge)}finally{p.event=Je}},q.header=function(Ve,Je){return Ve=(Ve+"").toLowerCase(),arguments.length<2?ue[Ve]:(Je==null?delete ue[Ve]:ue[Ve]=Je+"",q)},q.mimeType=function(Ve){return arguments.length?(C=Ve==null?null:Ve+"",q):C},q.responseType=function(Ve){return arguments.length?(we=Ve,q):we},q.response=function(Ve){return z=Ve,q},["get","post"].forEach(function(Ve){q[Ve]=function(){return q.send.apply(q,[Ve].concat(b(arguments)))}}),q.send=function(Ve,Je,at){if(arguments.length===2&&typeof Je=="function"&&(at=Je,Je=null),ge.open(Ve,ce,!0),C==null||"accept"in ue||(ue.accept=C+",*/*"),ge.setRequestHeader)for(var bt in ue)ge.setRequestHeader(bt,ue[bt]);return C!=null&&ge.overrideMimeType&&ge.overrideMimeType(C),we!=null&&(ge.responseType=we),at!=null&&q.on("error",at).on("load",function(Et){at(null,Et)}),ie.beforesend.call(q,ge),ge.send(Je==null?null:Je),q},q.abort=function(){return ge.abort(),q},p.rebind(q,ie,"on"),F==null?q:q.get(function(Ve){return Ve.length===1?function(Je,at){Ve(Je==null?at:null)}:Ve}(F))}hr.forEach(function(ce,C){hr.set(ce,Rt(C))}),p.functor=vr,p.xhr=Mr(E),p.dsv=function(ce,C){var z=new RegExp('["'+ce+`
]`),F=ce.charCodeAt(0);function q(Se,Ve,Je){arguments.length<3&&(Je=Ve,Ve=null);var at=Nr(Se,C,Ve==null?ie:ue(Ve),Je);return at.row=function(bt){return arguments.length?at.response((Ve=bt)==null?ie:ue(bt)):Ve},at}function ie(Se){return q.parse(Se.responseText)}function ue(Se){return function(Ve){return q.parse(Ve.responseText,Se)}}function ge(Se){return Se.map(we).join(ce)}function we(Se){return z.test(Se)?'"'+Se.replace(/\"/g,'""')+'"':Se}return q.parse=function(Se,Ve){var Je;return q.parseRows(Se,function(at,bt){if(Je)return Je(at,bt-1);var Et=function(kt){for(var At={},xt=at.length,zt=0;zt<xt;++zt)At[at[zt]]=kt[zt];return At};Je=Ve?function(kt,At){return Ve(Et(kt),At)}:Et})},q.parseRows=function(Se,Ve){var Je,at,bt={},Et={},kt=[],At=Se.length,xt=0,zt=0;function It(){if(xt>=At)return Et;if(at)return at=!1,bt;var nr=xt;if(Se.charCodeAt(nr)===34){for(var gr=nr;gr++<At;)if(Se.charCodeAt(gr)===34){if(Se.charCodeAt(gr+1)!==34)break;++gr}return xt=gr+2,(Lr=Se.charCodeAt(gr+1))===13?(at=!0,Se.charCodeAt(gr+2)===10&&++xt):Lr===10&&(at=!0),Se.slice(nr+1,gr).replace(/""/g,'"')}for(;xt<At;){var Lr,Sr=1;if((Lr=Se.charCodeAt(xt++))===10)at=!0;else if(Lr===13)at=!0,Se.charCodeAt(xt)===10&&(++xt,++Sr);else if(Lr!==F)continue;return Se.slice(nr,xt-Sr)}return Se.slice(nr)}for(;(Je=It())!==Et;){for(var Bt=[];Je!==bt&&Je!==Et;)Bt.push(Je),Je=It();Ve&&(Bt=Ve(Bt,zt++))==null||kt.push(Bt)}return kt},q.format=function(Se){if(Array.isArray(Se[0]))return q.formatRows(Se);var Ve=new S,Je=[];return Se.forEach(function(at){for(var bt in at)Ve.has(bt)||Je.push(Ve.add(bt))}),[Je.map(we).join(ce)].concat(Se.map(function(at){return Je.map(function(bt){return we(at[bt])}).join(ce)})).join(`
`)},q.formatRows=function(Se){return Se.map(ge).join(`
`)},q},p.csv=p.dsv(",","text/csv"),p.tsv=p.dsv("	","text/tab-separated-values");var Ur,Jr,mn,en,In=this[R(this,"requestAnimationFrame")]||function(ce){setTimeout(ce,17)};function vn(ce,C,z){var F=arguments.length;F<2&&(C=0),F<3&&(z=Date.now());var q=z+C,ie={c:ce,t:q,n:null};return Jr?Jr.n=ie:Ur=ie,Jr=ie,mn||(en=clearTimeout(en),mn=1,In(gn)),ie}function gn(){var ce=Sn(),C=Xn()-ce;C>24?(isFinite(C)&&(clearTimeout(en),en=setTimeout(gn,C)),mn=0):(mn=1,In(gn))}function Sn(){for(var ce=Date.now(),C=Ur;C;)ce>=C.t&&C.c(ce-C.t)&&(C.c=null),C=C.n;return ce}function Xn(){for(var ce,C=Ur,z=1/0;C;)C.c?(C.t<z&&(z=C.t),C=(ce=C).n):C=ce?ce.n=C.n:Ur=C.n;return Jr=ce,z}function Br(ce){return ce[0]}function pn(ce){return ce[1]}function on(ce){for(var C,z,F,q=ce.length,ie=[0,1],ue=2,ge=2;ge<q;ge++){for(;ue>1&&(C=ce[ie[ue-2]],z=ce[ie[ue-1]],F=ce[ge],(z[0]-C[0])*(F[1]-C[1])-(z[1]-C[1])*(F[0]-C[0])<=0);)--ue;ie[ue++]=ge}return ie.slice(0,ue)}function Yr(ce,C){return ce[0]-C[0]||ce[1]-C[1]}p.timer=function(){vn.apply(this,arguments)},p.timer.flush=function(){Sn(),Xn()},p.round=function(ce,C){return C?Math.round(ce*(C=Math.pow(10,C)))/C:Math.round(ce)},p.geom={},p.geom.hull=function(ce){var C=Br,z=pn;if(arguments.length)return F(ce);function F(q){if(q.length<3)return[];var ie,ue=vr(C),ge=vr(z),we=q.length,Se=[],Ve=[];for(ie=0;ie<we;ie++)Se.push([+ue.call(this,q[ie],ie),+ge.call(this,q[ie],ie),ie]);for(Se.sort(Yr),ie=0;ie<we;ie++)Ve.push([Se[ie][0],-Se[ie][1]]);var Je=on(Se),at=on(Ve),bt=at[0]===Je[0],Et=at[at.length-1]===Je[Je.length-1],kt=[];for(ie=Je.length-1;ie>=0;--ie)kt.push(q[Se[Je[ie]][2]]);for(ie=+bt;ie<at.length-Et;++ie)kt.push(q[Se[at[ie]][2]]);return kt}return F.x=function(q){return arguments.length?(C=q,F):C},F.y=function(q){return arguments.length?(z=q,F):z},F},p.geom.polygon=function(ce){return B(ce,Nn),ce};var Nn=p.geom.polygon.prototype=[];function Hn(ce,C,z){return(z[0]-C[0])*(ce[1]-C[1])<(z[1]-C[1])*(ce[0]-C[0])}function xn(ce,C,z,F){var q=ce[0],ie=z[0],ue=C[0]-q,ge=F[0]-ie,we=ce[1],Se=z[1],Ve=C[1]-we,Je=F[1]-Se,at=(ge*(we-Se)-Je*(q-ie))/(Je*ue-ge*Ve);return[q+at*ue,we+at*Ve]}function On(ce){var C=ce[0],z=ce[ce.length-1];return!(C[0]-z[0]||C[1]-z[1])}Nn.area=function(){for(var ce,C=-1,z=this.length,F=this[z-1],q=0;++C<z;)ce=F,F=this[C],q+=ce[1]*F[0]-ce[0]*F[1];return .5*q},Nn.centroid=function(ce){var C,z,F=-1,q=this.length,ie=0,ue=0,ge=this[q-1];for(arguments.length||(ce=-1/(6*this.area()));++F<q;)C=ge,ge=this[F],z=C[0]*ge[1]-ge[0]*C[1],ie+=(C[0]+ge[0])*z,ue+=(C[1]+ge[1])*z;return[ie*ce,ue*ce]},Nn.clip=function(ce){for(var C,z,F,q,ie,ue,ge=On(ce),we=-1,Se=this.length-On(this),Ve=this[Se-1];++we<Se;){for(C=ce.slice(),ce.length=0,q=this[we],ie=C[(F=C.length-ge)-1],z=-1;++z<F;)Hn(ue=C[z],Ve,q)?(Hn(ie,Ve,q)||ce.push(xn(ie,ue,Ve,q)),ce.push(ue)):Hn(ie,Ve,q)&&ce.push(xn(ie,ue,Ve,q)),ie=ue;ge&&ce.push(ce[0]),Ve=q}return ce};var ua,tr,yr,Ct,lr,dr=[],Fr=[];function Rr(){An(this),this.edge=this.site=this.circle=null}function zr(ce){var C=dr.pop()||new Rr;return C.site=ce,C}function Er(ce){yn(ce),yr.remove(ce),dr.push(ce),An(ce)}function xr(ce){var C=ce.circle,z=C.x,F=C.cy,q={x:z,y:F},ie=ce.P,ue=ce.N,ge=[ce];Er(ce);for(var we=ie;we.circle&&s(z-we.circle.x)<vt&&s(F-we.circle.cy)<vt;)ie=we.P,ge.unshift(we),Er(we),we=ie;ge.unshift(we),yn(we);for(var Se=ue;Se.circle&&s(z-Se.circle.x)<vt&&s(F-Se.circle.cy)<vt;)ue=Se.N,ge.push(Se),Er(Se),Se=ue;ge.push(Se),yn(Se);var Ve,Je=ge.length;for(Ve=1;Ve<Je;++Ve)Se=ge[Ve],we=ge[Ve-1],Zn(Se.edge,we.site,Se.site,q);we=ge[0],(Se=ge[Je-1]).edge=Ln(we.site,Se.site,null,q),rn(we),rn(Se)}function _r(ce){for(var C,z,F,q,ie=ce.x,ue=ce.y,ge=yr._;ge;)if((F=kr(ge,ue)-ie)>vt)ge=ge.L;else{if(!((q=ie-Cr(ge,ue))>vt)){F>-vt?(C=ge.P,z=ge):q>-vt?(C=ge,z=ge.N):C=z=ge;break}if(!ge.R){C=ge;break}ge=ge.R}var we=zr(ce);if(yr.insert(C,we),C||z){if(C===z)return yn(C),z=zr(C.site),yr.insert(we,z),we.edge=z.edge=Ln(C.site,we.site),rn(C),void rn(z);if(z){yn(C),yn(z);var Se=C.site,Ve=Se.x,Je=Se.y,at=ce.x-Ve,bt=ce.y-Je,Et=z.site,kt=Et.x-Ve,At=Et.y-Je,xt=2*(at*At-bt*kt),zt=at*at+bt*bt,It=kt*kt+At*At,Bt={x:(At*zt-bt*It)/xt+Ve,y:(at*It-kt*zt)/xt+Je};Zn(z.edge,Se,Et,Bt),we.edge=Ln(Se,ce,null,Bt),z.edge=Ln(ce,Et,null,Bt),rn(C),rn(z)}else we.edge=Ln(C.site,we.site)}}function kr(ce,C){var z=ce.site,F=z.x,q=z.y,ie=q-C;if(!ie)return F;var ue=ce.P;if(!ue)return-1/0;var ge=(z=ue.site).x,we=z.y,Se=we-C;if(!Se)return ge;var Ve=ge-F,Je=1/ie-1/Se,at=Ve/Se;return Je?(-at+Math.sqrt(at*at-2*Je*(Ve*Ve/(-2*Se)-we+Se/2+q-ie/2)))/Je+F:(F+ge)/2}function Cr(ce,C){var z=ce.N;if(z)return kr(z,C);var F=ce.site;return F.y===C?F.x:1/0}function Gr(ce){this.site=ce,this.edges=[]}function qr(ce,C){return C.angle-ce.angle}function tn(){An(this),this.x=this.y=this.arc=this.site=this.cy=null}function rn(ce){var C=ce.P,z=ce.N;if(C&&z){var F=C.site,q=ce.site,ie=z.site;if(F!==ie){var ue=q.x,ge=q.y,we=F.x-ue,Se=F.y-ge,Ve=ie.x-ue,Je=2*(we*(At=ie.y-ge)-Se*Ve);if(!(Je>=-1e-12)){var at=we*we+Se*Se,bt=Ve*Ve+At*At,Et=(At*at-Se*bt)/Je,kt=(we*bt-Ve*at)/Je,At=kt+ge,xt=Fr.pop()||new tn;xt.arc=ce,xt.site=q,xt.x=Et+ue,xt.y=At+Math.sqrt(Et*Et+kt*kt),xt.cy=At,ce.circle=xt;for(var zt=null,It=lr._;It;)if(xt.y<It.y||xt.y===It.y&&xt.x<=It.x){if(!It.L){zt=It.P;break}It=It.L}else{if(!It.R){zt=It;break}It=It.R}lr.insert(zt,xt),zt||(Ct=xt)}}}}function yn(ce){var C=ce.circle;C&&(C.P||(Ct=C.N),lr.remove(C),Fr.push(C),An(C),ce.circle=null)}function _n(ce,C){var z=ce.b;if(z)return!0;var F,q,ie=ce.a,ue=C[0][0],ge=C[1][0],we=C[0][1],Se=C[1][1],Ve=ce.l,Je=ce.r,at=Ve.x,bt=Ve.y,Et=Je.x,kt=Je.y,At=(at+Et)/2,xt=(bt+kt)/2;if(kt===bt){if(At<ue||At>=ge)return;if(at>Et){if(ie){if(ie.y>=Se)return}else ie={x:At,y:we};z={x:At,y:Se}}else{if(ie){if(ie.y<we)return}else ie={x:At,y:Se};z={x:At,y:we}}}else if(q=xt-(F=(at-Et)/(kt-bt))*At,F<-1||F>1)if(at>Et){if(ie){if(ie.y>=Se)return}else ie={x:(we-q)/F,y:we};z={x:(Se-q)/F,y:Se}}else{if(ie){if(ie.y<we)return}else ie={x:(Se-q)/F,y:Se};z={x:(we-q)/F,y:we}}else if(bt<kt){if(ie){if(ie.x>=ge)return}else ie={x:ue,y:F*ue+q};z={x:ge,y:F*ge+q}}else{if(ie){if(ie.x<ue)return}else ie={x:ge,y:F*ge+q};z={x:ue,y:F*ue+q}}return ce.a=ie,ce.b=z,!0}function wn(ce,C){this.l=ce,this.r=C,this.a=this.b=null}function Ln(ce,C,z,F){var q=new wn(ce,C);return ua.push(q),z&&Zn(q,ce,C,z),F&&Zn(q,C,ce,F),tr[ce.i].edges.push(new Aa(q,ce,C)),tr[C.i].edges.push(new Aa(q,C,ce)),q}function zn(ce,C,z){var F=new wn(ce,null);return F.a=C,F.b=z,ua.push(F),F}function Zn(ce,C,z,F){ce.a||ce.b?ce.l===z?ce.b=F:ce.a=F:(ce.a=F,ce.l=C,ce.r=z)}function Aa(ce,C,z){var F=ce.a,q=ce.b;this.edge=ce,this.site=C,this.angle=z?Math.atan2(z.y-C.y,z.x-C.x):ce.l===C?Math.atan2(q.x-F.x,F.y-q.y):Math.atan2(F.x-q.x,q.y-F.y)}function Ma(){this._=null}function An(ce){ce.U=ce.C=ce.L=ce.R=ce.P=ce.N=null}function ea(ce,C){var z=C,F=C.R,q=z.U;q?q.L===z?q.L=F:q.R=F:ce._=F,F.U=q,z.U=F,z.R=F.L,z.R&&(z.R.U=z),F.L=z}function Qn(ce,C){var z=C,F=C.L,q=z.U;q?q.L===z?q.L=F:q.R=F:ce._=F,F.U=q,z.U=F,z.L=F.R,z.L&&(z.L.U=z),F.R=z}function za(ce){for(;ce.L;)ce=ce.L;return ce}function vi(ce,C){var z,F,q,ie=ce.sort(Fi).pop();for(ua=[],tr=new Array(ce.length),yr=new Ma,lr=new Ma;;)if(q=Ct,ie&&(!q||ie.y<q.y||ie.y===q.y&&ie.x<q.x))ie.x===z&&ie.y===F||(tr[ie.i]=new Gr(ie),_r(ie),z=ie.x,F=ie.y),ie=ce.pop();else{if(!q)break;xr(q.arc)}C&&(function(ge){for(var we,Se,Ve,Je,at,bt=ua,Et=(Se=ge[0][0],Ve=ge[0][1],Je=ge[1][0],at=ge[1][1],function(At){var xt,zt=At.a,It=At.b,Bt=zt.x,nr=zt.y,gr=0,Lr=1,Sr=It.x-Bt,$r=It.y-nr;if(xt=Se-Bt,Sr||!(xt>0)){if(xt/=Sr,Sr<0){if(xt<gr)return;xt<Lr&&(Lr=xt)}else if(Sr>0){if(xt>Lr)return;xt>gr&&(gr=xt)}if(xt=Je-Bt,Sr||!(xt<0)){if(xt/=Sr,Sr<0){if(xt>Lr)return;xt>gr&&(gr=xt)}else if(Sr>0){if(xt<gr)return;xt<Lr&&(Lr=xt)}if(xt=Ve-nr,$r||!(xt>0)){if(xt/=$r,$r<0){if(xt<gr)return;xt<Lr&&(Lr=xt)}else if($r>0){if(xt>Lr)return;xt>gr&&(gr=xt)}if(xt=at-nr,$r||!(xt<0)){if(xt/=$r,$r<0){if(xt>Lr)return;xt>gr&&(gr=xt)}else if($r>0){if(xt<gr)return;xt<Lr&&(Lr=xt)}return gr>0&&(At.a={x:Bt+gr*Sr,y:nr+gr*$r}),Lr<1&&(At.b={x:Bt+Lr*Sr,y:nr+Lr*$r}),At}}}}}),kt=bt.length;kt--;)(!_n(we=bt[kt],ge)||!Et(we)||s(we.a.x-we.b.x)<vt&&s(we.a.y-we.b.y)<vt)&&(we.a=we.b=null,bt.splice(kt,1))}(C),function(ge){for(var we,Se,Ve,Je,at,bt,Et,kt,At,xt,zt=ge[0][0],It=ge[1][0],Bt=ge[0][1],nr=ge[1][1],gr=tr,Lr=gr.length;Lr--;)if((at=gr[Lr])&&at.prepare())for(kt=(Et=at.edges).length,bt=0;bt<kt;)Ve=(xt=Et[bt].end()).x,Je=xt.y,we=(At=Et[++bt%kt].start()).x,Se=At.y,(s(Ve-we)>vt||s(Je-Se)>vt)&&(Et.splice(bt,0,new Aa(zn(at.site,xt,s(Ve-zt)<vt&&nr-Je>vt?{x:zt,y:s(we-zt)<vt?Se:nr}:s(Je-nr)<vt&&It-Ve>vt?{x:s(Se-nr)<vt?we:It,y:nr}:s(Ve-It)<vt&&Je-Bt>vt?{x:It,y:s(we-It)<vt?Se:Bt}:s(Je-Bt)<vt&&Ve-zt>vt?{x:s(Se-Bt)<vt?we:zt,y:Bt}:null),at.site,null)),++kt)}(C));var ue={cells:tr,edges:ua};return yr=lr=ua=tr=null,ue}function Fi(ce,C){return C.y-ce.y||C.x-ce.x}Gr.prototype.prepare=function(){for(var ce,C=this.edges,z=C.length;z--;)(ce=C[z].edge).b&&ce.a||C.splice(z,1);return C.sort(qr),C.length},Aa.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Ma.prototype={insert:function(ce,C){var z,F,q;if(ce){if(C.P=ce,C.N=ce.N,ce.N&&(ce.N.P=C),ce.N=C,ce.R){for(ce=ce.R;ce.L;)ce=ce.L;ce.L=C}else ce.R=C;z=ce}else this._?(ce=za(this._),C.P=null,C.N=ce,ce.P=ce.L=C,z=ce):(C.P=C.N=null,this._=C,z=null);for(C.L=C.R=null,C.U=z,C.C=!0,ce=C;z&&z.C;)z===(F=z.U).L?(q=F.R)&&q.C?(z.C=q.C=!1,F.C=!0,ce=F):(ce===z.R&&(ea(this,z),z=(ce=z).U),z.C=!1,F.C=!0,Qn(this,F)):(q=F.L)&&q.C?(z.C=q.C=!1,F.C=!0,ce=F):(ce===z.L&&(Qn(this,z),z=(ce=z).U),z.C=!1,F.C=!0,ea(this,F)),z=ce.U;this._.C=!1},remove:function(ce){ce.N&&(ce.N.P=ce.P),ce.P&&(ce.P.N=ce.N),ce.N=ce.P=null;var C,z,F,q=ce.U,ie=ce.L,ue=ce.R;if(z=ie?ue?za(ue):ie:ue,q?q.L===ce?q.L=z:q.R=z:this._=z,ie&&ue?(F=z.C,z.C=ce.C,z.L=ie,ie.U=z,z!==ue?(q=z.U,z.U=ce.U,ce=z.R,q.L=ce,z.R=ue,ue.U=z):(z.U=q,q=z,ce=z.R)):(F=ce.C,ce=z),ce&&(ce.U=q),!F)if(ce&&ce.C)ce.C=!1;else{do{if(ce===this._)break;if(ce===q.L){if((C=q.R).C&&(C.C=!1,q.C=!0,ea(this,q),C=q.R),C.L&&C.L.C||C.R&&C.R.C){C.R&&C.R.C||(C.L.C=!1,C.C=!0,Qn(this,C),C=q.R),C.C=q.C,q.C=C.R.C=!1,ea(this,q),ce=this._;break}}else if((C=q.L).C&&(C.C=!1,q.C=!0,Qn(this,q),C=q.L),C.L&&C.L.C||C.R&&C.R.C){C.L&&C.L.C||(C.R.C=!1,C.C=!0,ea(this,C),C=q.L),C.C=q.C,q.C=C.L.C=!1,Qn(this,q),ce=this._;break}C.C=!0,ce=q,q=q.U}while(!ce.C);ce&&(ce.C=!1)}}},p.geom.voronoi=function(ce){var C=Br,z=pn,F=C,q=z,ie=po;if(ce)return ue(ce);function ue(we){var Se=new Array(we.length),Ve=ie[0][0],Je=ie[0][1],at=ie[1][0],bt=ie[1][1];return vi(ge(we),ie).cells.forEach(function(Et,kt){var At=Et.edges,xt=Et.site;(Se[kt]=At.length?At.map(function(zt){var It=zt.start();return[It.x,It.y]}):xt.x>=Ve&&xt.x<=at&&xt.y>=Je&&xt.y<=bt?[[Ve,bt],[at,bt],[at,Je],[Ve,Je]]:[]).point=we[kt]}),Se}function ge(we){return we.map(function(Se,Ve){return{x:Math.round(F(Se,Ve)/vt)*vt,y:Math.round(q(Se,Ve)/vt)*vt,i:Ve}})}return ue.links=function(we){return vi(ge(we)).edges.filter(function(Se){return Se.l&&Se.r}).map(function(Se){return{source:we[Se.l.i],target:we[Se.r.i]}})},ue.triangles=function(we){var Se=[];return vi(ge(we)).cells.forEach(function(Ve,Je){for(var at,bt,Et,kt,At=Ve.site,xt=Ve.edges.sort(qr),zt=-1,It=xt.length,Bt=xt[It-1].edge,nr=Bt.l===At?Bt.r:Bt.l;++zt<It;)at=nr,nr=(Bt=xt[zt].edge).l===At?Bt.r:Bt.l,Je<at.i&&Je<nr.i&&(Et=at,kt=nr,((bt=At).x-kt.x)*(Et.y-bt.y)-(bt.x-Et.x)*(kt.y-bt.y)<0)&&Se.push([we[Je],we[at.i],we[nr.i]])}),Se},ue.x=function(we){return arguments.length?(F=vr(C=we),ue):C},ue.y=function(we){return arguments.length?(q=vr(z=we),ue):z},ue.clipExtent=function(we){return arguments.length?(ie=we==null?po:we,ue):ie===po?null:ie},ue.size=function(we){return arguments.length?ue.clipExtent(we&&[[0,0],we]):ie===po?null:ie&&ie[1]},ue};var po=[[-1e6,-1e6],[1e6,1e6]];function Xa(ce){return ce.x}function Za(ce){return ce.y}function eo(ce,C,z,F,q,ie){if(!ce(C,z,F,q,ie)){var ue=.5*(z+q),ge=.5*(F+ie),we=C.nodes;we[0]&&eo(ce,we[0],z,F,ue,ge),we[1]&&eo(ce,we[1],ue,F,q,ge),we[2]&&eo(ce,we[2],z,ge,ue,ie),we[3]&&eo(ce,we[3],ue,ge,q,ie)}}function Na(ce,C,z,F,q,ie,ue){var ge,we=1/0;return function Se(Ve,Je,at,bt,Et){if(!(Je>ie||at>ue||bt<F||Et<q)){if(kt=Ve.point){var kt,At=C-Ve.x,xt=z-Ve.y,zt=At*At+xt*xt;if(zt<we){var It=Math.sqrt(we=zt);F=C-It,q=z-It,ie=C+It,ue=z+It,ge=kt}}for(var Bt=Ve.nodes,nr=.5*(Je+bt),gr=.5*(at+Et),Lr=(z>=gr)<<1|C>=nr,Sr=Lr+4;Lr<Sr;++Lr)if(Ve=Bt[3&Lr])switch(3&Lr){case 0:Se(Ve,Je,at,nr,gr);break;case 1:Se(Ve,nr,at,bt,gr);break;case 2:Se(Ve,Je,gr,nr,Et);break;case 3:Se(Ve,nr,gr,bt,Et)}}}(ce,F,q,ie,ue),ge}function mo(ce,C){ce=p.rgb(ce),C=p.rgb(C);var z=ce.r,F=ce.g,q=ce.b,ie=C.r-z,ue=C.g-F,ge=C.b-q;return function(we){return"#"+pr(Math.round(z+ie*we))+pr(Math.round(F+ue*we))+pr(Math.round(q+ge*we))}}function bo(ce,C){var z,F={},q={};for(z in ce)z in C?F[z]=Ui(ce[z],C[z]):q[z]=ce[z];for(z in C)z in ce||(q[z]=C[z]);return function(ie){for(z in F)q[z]=F[z](ie);return q}}function Mi(ce,C){return ce=+ce,C=+C,function(z){return ce*(1-z)+C*z}}function to(ce,C){var z,F,q,ie=_o.lastIndex=Co.lastIndex=0,ue=-1,ge=[],we=[];for(ce+="",C+="";(z=_o.exec(ce))&&(F=Co.exec(C));)(q=F.index)>ie&&(q=C.slice(ie,q),ge[ue]?ge[ue]+=q:ge[++ue]=q),(z=z[0])===(F=F[0])?ge[ue]?ge[ue]+=F:ge[++ue]=F:(ge[++ue]=null,we.push({i:ue,x:Mi(z,F)})),ie=Co.lastIndex;return ie<C.length&&(q=C.slice(ie),ge[ue]?ge[ue]+=q:ge[++ue]=q),ge.length<2?we[0]?(C=we[0].x,function(Se){return C(Se)+""}):function(){return C}:(C=we.length,function(Se){for(var Ve,Je=0;Je<C;++Je)ge[(Ve=we[Je]).i]=Ve.x(Se);return ge.join("")})}p.geom.delaunay=function(ce){return p.geom.voronoi().triangles(ce)},p.geom.quadtree=function(ce,C,z,F,q){var ie,ue=Br,ge=pn;if(ie=arguments.length)return ue=Xa,ge=Za,ie===3&&(q=z,F=C,z=C=0),we(ce);function we(Se){var Ve,Je,at,bt,Et,kt,At,xt,zt,It=vr(ue),Bt=vr(ge);if(C!=null)kt=C,At=z,xt=F,zt=q;else if(xt=zt=-(kt=At=1/0),Je=[],at=[],Et=Se.length,ie)for(bt=0;bt<Et;++bt)(Ve=Se[bt]).x<kt&&(kt=Ve.x),Ve.y<At&&(At=Ve.y),Ve.x>xt&&(xt=Ve.x),Ve.y>zt&&(zt=Ve.y),Je.push(Ve.x),at.push(Ve.y);else for(bt=0;bt<Et;++bt){var nr=+It(Ve=Se[bt],bt),gr=+Bt(Ve,bt);nr<kt&&(kt=nr),gr<At&&(At=gr),nr>xt&&(xt=nr),gr>zt&&(zt=gr),Je.push(nr),at.push(gr)}var Lr=xt-kt,Sr=zt-At;function $r(sn,Vn,Jn,ha,Wr,Mn,Kn,Yn){if(!isNaN(Jn)&&!isNaN(ha))if(sn.leaf){var ia=sn.x,da=sn.y;if(ia!=null)if(s(ia-Jn)+s(da-ha)<.01)Qr(sn,Vn,Jn,ha,Wr,Mn,Kn,Yn);else{var La=sn.point;sn.x=sn.y=sn.point=null,Qr(sn,La,ia,da,Wr,Mn,Kn,Yn),Qr(sn,Vn,Jn,ha,Wr,Mn,Kn,Yn)}else sn.x=Jn,sn.y=ha,sn.point=Vn}else Qr(sn,Vn,Jn,ha,Wr,Mn,Kn,Yn)}function Qr(sn,Vn,Jn,ha,Wr,Mn,Kn,Yn){var ia=.5*(Wr+Kn),da=.5*(Mn+Yn),La=Jn>=ia,ta=ha>=da,_a=ta<<1|La;sn.leaf=!1,La?Wr=ia:Kn=ia,ta?Mn=da:Yn=da,$r(sn=sn.nodes[_a]||(sn.nodes[_a]={leaf:!0,nodes:[],point:null,x:null,y:null}),Vn,Jn,ha,Wr,Mn,Kn,Yn)}Lr>Sr?zt=At+Lr:xt=kt+Sr;var fn={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(sn){$r(fn,sn,+It(sn,++bt),+Bt(sn,bt),kt,At,xt,zt)},visit:function(sn){eo(sn,fn,kt,At,xt,zt)},find:function(sn){return Na(fn,sn[0],sn[1],kt,At,xt,zt)}};if(bt=-1,C==null){for(;++bt<Et;)$r(fn,Se[bt],Je[bt],at[bt],kt,At,xt,zt);--bt}else Se.forEach(fn.add);return Je=at=Se=Ve=null,fn}return we.x=function(Se){return arguments.length?(ue=Se,we):ue},we.y=function(Se){return arguments.length?(ge=Se,we):ge},we.extent=function(Se){return arguments.length?(Se==null?C=z=F=q=null:(C=+Se[0][0],z=+Se[0][1],F=+Se[1][0],q=+Se[1][1]),we):C==null?null:[[C,z],[F,q]]},we.size=function(Se){return arguments.length?(Se==null?C=z=F=q=null:(C=z=0,F=+Se[0],q=+Se[1]),we):C==null?null:[F-C,q-z]},we},p.interpolateRgb=mo,p.interpolateObject=bo,p.interpolateNumber=Mi,p.interpolateString=to;var _o=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Co=new RegExp(_o.source,"g");function Ui(ce,C){for(var z,F=p.interpolators.length;--F>=0&&!(z=p.interpolators[F](ce,C)););return z}function yi(ce,C){var z,F=[],q=[],ie=ce.length,ue=C.length,ge=Math.min(ce.length,C.length);for(z=0;z<ge;++z)F.push(Ui(ce[z],C[z]));for(;z<ie;++z)q[z]=ce[z];for(;z<ue;++z)q[z]=C[z];return function(we){for(z=0;z<ge;++z)q[z]=F[z](we);return q}}p.interpolate=Ui,p.interpolators=[function(ce,C){var z=typeof C;return(z==="string"?hr.has(C.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(C)?mo:to:C instanceof Xe?mo:Array.isArray(C)?yi:z==="object"&&isNaN(C)?bo:Mi)(ce,C)}],p.interpolateArray=yi;var Ki=function(){return E},Ts=p.map({linear:Ki,poly:function(ce){return function(C){return Math.pow(C,ce)}},quad:function(){return Ls},cubic:function(){return Cs},sin:function(){return Ps},exp:function(){return Oo},circle:function(){return zo},elastic:function(ce,C){var z;return arguments.length<2&&(C=.45),arguments.length?z=C/qt*Math.asin(1/ce):(ce=1,z=C/4),function(F){return 1+ce*Math.pow(2,-10*F)*Math.sin((F-z)*qt/C)}},back:function(ce){return ce||(ce=1.70158),function(C){return C*C*((ce+1)*C-ce)}},bounce:function(){return Go}}),Es=p.map({in:E,out:vs,"in-out":rs,"out-in":function(ce){return rs(vs(ce))}});function Ja(ce){return function(C){return C<=0?0:C>=1?1:ce(C)}}function vs(ce){return function(C){return 1-ce(1-C)}}function rs(ce){return function(C){return .5*(C<.5?ce(2*C):2-ce(2-2*C))}}function Ls(ce){return ce*ce}function Cs(ce){return ce*ce*ce}function ks(ce){if(ce<=0)return 0;if(ce>=1)return 1;var C=ce*ce,z=C*ce;return 4*(ce<.5?z:3*(ce-C)+z-.75)}function Ps(ce){return 1-Math.cos(ce*Jt)}function Oo(ce){return Math.pow(2,10*(ce-1))}function zo(ce){return 1-Math.sqrt(1-ce*ce)}function Go(ce){return ce<1/2.75?7.5625*ce*ce:ce<2/2.75?7.5625*(ce-=1.5/2.75)*ce+.75:ce<2.5/2.75?7.5625*(ce-=2.25/2.75)*ce+.9375:7.5625*(ce-=2.625/2.75)*ce+.984375}function Yo(ce,C){return C-=ce,function(z){return Math.round(ce+C*z)}}function Wo(ce){var C,z,F,q=[ce.a,ce.b],ie=[ce.c,ce.d],ue=wo(q),ge=ns(q,ie),we=wo(((C=ie)[0]+=(F=-ge)*(z=q)[0],C[1]+=F*z[1],C))||0;q[0]*ie[1]<ie[0]*q[1]&&(q[0]*=-1,q[1]*=-1,ue*=-1,ge*=-1),this.rotate=(ue?Math.atan2(q[1],q[0]):Math.atan2(-ie[0],ie[1]))*Ht,this.translate=[ce.e,ce.f],this.scale=[ue,we],this.skew=we?Math.atan2(ge,we)*Ht:0}function ns(ce,C){return ce[0]*C[0]+ce[1]*C[1]}function wo(ce){var C=Math.sqrt(ns(ce,ce));return C&&(ce[0]/=C,ce[1]/=C),C}p.ease=function(ce){var C=ce.indexOf("-"),z=C>=0?ce.slice(0,C):ce,F=C>=0?ce.slice(C+1):"in";return z=Ts.get(z)||Ki,Ja((F=Es.get(F)||E)(z.apply(null,g.call(arguments,1))))},p.interpolateHcl=function(ce,C){ce=p.hcl(ce),C=p.hcl(C);var z=ce.h,F=ce.c,q=ce.l,ie=C.h-z,ue=C.c-F,ge=C.l-q;return isNaN(ue)&&(ue=0,F=isNaN(F)?C.c:F),isNaN(ie)?(ie=0,z=isNaN(z)?C.h:z):ie>180?ie-=360:ie<-180&&(ie+=360),function(we){return rt(z+ie*we,F+ue*we,q+ge*we)+""}},p.interpolateHsl=function(ce,C){ce=p.hsl(ce),C=p.hsl(C);var z=ce.h,F=ce.s,q=ce.l,ie=C.h-z,ue=C.s-F,ge=C.l-q;return isNaN(ue)&&(ue=0,F=isNaN(F)?C.s:F),isNaN(ie)?(ie=0,z=isNaN(z)?C.h:z):ie>180?ie-=360:ie<-180&&(ie+=360),function(we){return it(z+ie*we,F+ue*we,q+ge*we)+""}},p.interpolateLab=function(ce,C){ce=p.lab(ce),C=p.lab(C);var z=ce.l,F=ce.a,q=ce.b,ie=C.l-z,ue=C.a-F,ge=C.b-q;return function(we){return Lt(z+ie*we,F+ue*we,q+ge*we)+""}},p.interpolateRound=Yo,p.transform=function(ce){var C=y.createElementNS(p.ns.prefix.svg,"g");return(p.transform=function(z){if(z!=null){C.setAttribute("transform",z);var F=C.transform.baseVal.consolidate()}return new Wo(F?F.matrix:ys)})(ce)},Wo.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ys={a:1,b:0,c:0,d:1,e:0,f:0};function go(ce){return ce.length?ce.pop()+",":""}function Xo(ce,C){var z=[],F=[];return ce=p.transform(ce),C=p.transform(C),function(q,ie,ue,ge){if(q[0]!==ie[0]||q[1]!==ie[1]){var we=ue.push("translate(",null,",",null,")");ge.push({i:we-4,x:Mi(q[0],ie[0])},{i:we-2,x:Mi(q[1],ie[1])})}else(ie[0]||ie[1])&&ue.push("translate("+ie+")")}(ce.translate,C.translate,z,F),function(q,ie,ue,ge){q!==ie?(q-ie>180?ie+=360:ie-q>180&&(q+=360),ge.push({i:ue.push(go(ue)+"rotate(",null,")")-2,x:Mi(q,ie)})):ie&&ue.push(go(ue)+"rotate("+ie+")")}(ce.rotate,C.rotate,z,F),function(q,ie,ue,ge){q!==ie?ge.push({i:ue.push(go(ue)+"skewX(",null,")")-2,x:Mi(q,ie)}):ie&&ue.push(go(ue)+"skewX("+ie+")")}(ce.skew,C.skew,z,F),function(q,ie,ue,ge){if(q[0]!==ie[0]||q[1]!==ie[1]){var we=ue.push(go(ue)+"scale(",null,",",null,")");ge.push({i:we-4,x:Mi(q[0],ie[0])},{i:we-2,x:Mi(q[1],ie[1])})}else ie[0]===1&&ie[1]===1||ue.push(go(ue)+"scale("+ie+")")}(ce.scale,C.scale,z,F),ce=C=null,function(q){for(var ie,ue=-1,ge=F.length;++ue<ge;)z[(ie=F[ue]).i]=ie.x(q);return z.join("")}}function xs(ce,C){return C=(C-=ce=+ce)||1/C,function(z){return(z-ce)/C}}function Do(ce,C){return C=(C-=ce=+ce)||1/C,function(z){return Math.max(0,Math.min(1,(z-ce)/C))}}function Ya(ce){for(var C=ce.source,z=ce.target,F=function(ue,ge){if(ue===ge)return ue;for(var we=je(ue),Se=je(ge),Ve=we.pop(),Je=Se.pop(),at=null;Ve===Je;)at=Ve,Ve=we.pop(),Je=Se.pop();return at}(C,z),q=[C];C!==F;)C=C.parent,q.push(C);for(var ie=q.length;z!==F;)q.splice(ie,0,z),z=z.parent;return q}function je(ce){for(var C=[],z=ce.parent;z!=null;)C.push(ce),ce=z,z=z.parent;return C.push(ce),C}function Ge(ce){ce.fixed|=2}function et(ce){ce.fixed&=-7}function lt(ce){ce.fixed|=4,ce.px=ce.x,ce.py=ce.y}function gt(ce){ce.fixed&=-5}p.interpolateTransform=Xo,p.layout={},p.layout.bundle=function(){return function(ce){for(var C=[],z=-1,F=ce.length;++z<F;)C.push(Ya(ce[z]));return C}},p.layout.chord=function(){var ce,C,z,F,q,ie,ue,ge={},we=0;function Se(){var Je,at,bt,Et,kt,At={},xt=[],zt=p.range(F),It=[];for(ce=[],C=[],Je=0,Et=-1;++Et<F;){for(at=0,kt=-1;++kt<F;)at+=z[Et][kt];xt.push(at),It.push(p.range(F)),Je+=at}for(q&&zt.sort(function(fn,sn){return q(xt[fn],xt[sn])}),ie&&It.forEach(function(fn,sn){fn.sort(function(Vn,Jn){return ie(z[sn][Vn],z[sn][Jn])})}),Je=(qt-we*F)/Je,at=0,Et=-1;++Et<F;){for(bt=at,kt=-1;++kt<F;){var Bt=zt[Et],nr=It[Bt][kt],gr=z[Bt][nr],Lr=at,Sr=at+=gr*Je;At[Bt+"-"+nr]={index:Bt,subindex:nr,startAngle:Lr,endAngle:Sr,value:gr}}C[Bt]={index:Bt,startAngle:bt,endAngle:at,value:xt[Bt]},at+=we}for(Et=-1;++Et<F;)for(kt=Et-1;++kt<F;){var $r=At[Et+"-"+kt],Qr=At[kt+"-"+Et];($r.value||Qr.value)&&ce.push($r.value<Qr.value?{source:Qr,target:$r}:{source:$r,target:Qr})}ue&&Ve()}function Ve(){ce.sort(function(Je,at){return ue((Je.source.value+Je.target.value)/2,(at.source.value+at.target.value)/2)})}return ge.matrix=function(Je){return arguments.length?(F=(z=Je)&&z.length,ce=C=null,ge):z},ge.padding=function(Je){return arguments.length?(we=Je,ce=C=null,ge):we},ge.sortGroups=function(Je){return arguments.length?(q=Je,ce=C=null,ge):q},ge.sortSubgroups=function(Je){return arguments.length?(ie=Je,ce=null,ge):ie},ge.sortChords=function(Je){return arguments.length?(ue=Je,ce&&Ve(),ge):ue},ge.chords=function(){return ce||Se(),ce},ge.groups=function(){return C||Se(),C},ge},p.layout.force=function(){var ce,C,z,F,q,ie,ue={},ge=p.dispatch("start","tick","end"),we=[1,1],Se=.9,Ve=dt,Je=St,at=-30,bt=Xt,Et=.1,kt=.64,At=[],xt=[];function zt(Bt){return function(nr,gr,Lr,Sr){if(nr.point!==Bt){var $r=nr.cx-Bt.x,Qr=nr.cy-Bt.y,fn=Sr-gr,sn=$r*$r+Qr*Qr;if(fn*fn/kt<sn){if(sn<bt){var Vn=nr.charge/sn;Bt.px-=$r*Vn,Bt.py-=Qr*Vn}return!0}nr.point&&sn&&sn<bt&&(Vn=nr.pointCharge/sn,Bt.px-=$r*Vn,Bt.py-=Qr*Vn)}return!nr.charge}}function It(Bt){Bt.px=p.event.x,Bt.py=p.event.y,ue.resume()}return ue.tick=function(){if((z*=.99)<.005)return ce=null,ge.end({type:"end",alpha:z=0}),!0;var Bt,nr,gr,Lr,Sr,$r,Qr,fn,sn,Vn=At.length,Jn=xt.length;for(nr=0;nr<Jn;++nr)Lr=(gr=xt[nr]).source,($r=(fn=(Sr=gr.target).x-Lr.x)*fn+(sn=Sr.y-Lr.y)*sn)&&(fn*=$r=z*q[nr]*(($r=Math.sqrt($r))-F[nr])/$r,sn*=$r,Sr.x-=fn*(Qr=Lr.weight+Sr.weight?Lr.weight/(Lr.weight+Sr.weight):.5),Sr.y-=sn*Qr,Lr.x+=fn*(Qr=1-Qr),Lr.y+=sn*Qr);if((Qr=z*Et)&&(fn=we[0]/2,sn=we[1]/2,nr=-1,Qr))for(;++nr<Vn;)(gr=At[nr]).x+=(fn-gr.x)*Qr,gr.y+=(sn-gr.y)*Qr;if(at)for(function ha(Wr,Mn,Kn){var Yn=0,ia=0;if(Wr.charge=0,!Wr.leaf)for(var da,La=Wr.nodes,ta=La.length,_a=-1;++_a<ta;)(da=La[_a])!=null&&(ha(da,Mn,Kn),Wr.charge+=da.charge,Yn+=da.charge*da.cx,ia+=da.charge*da.cy);if(Wr.point){Wr.leaf||(Wr.point.x+=Math.random()-.5,Wr.point.y+=Math.random()-.5);var ya=Mn*Kn[Wr.point.index];Wr.charge+=Wr.pointCharge=ya,Yn+=ya*Wr.point.x,ia+=ya*Wr.point.y}Wr.cx=Yn/Wr.charge,Wr.cy=ia/Wr.charge}(Bt=p.geom.quadtree(At),z,ie),nr=-1;++nr<Vn;)(gr=At[nr]).fixed||Bt.visit(zt(gr));for(nr=-1;++nr<Vn;)(gr=At[nr]).fixed?(gr.x=gr.px,gr.y=gr.py):(gr.x-=(gr.px-(gr.px=gr.x))*Se,gr.y-=(gr.py-(gr.py=gr.y))*Se);ge.tick({type:"tick",alpha:z})},ue.nodes=function(Bt){return arguments.length?(At=Bt,ue):At},ue.links=function(Bt){return arguments.length?(xt=Bt,ue):xt},ue.size=function(Bt){return arguments.length?(we=Bt,ue):we},ue.linkDistance=function(Bt){return arguments.length?(Ve=typeof Bt=="function"?Bt:+Bt,ue):Ve},ue.distance=ue.linkDistance,ue.linkStrength=function(Bt){return arguments.length?(Je=typeof Bt=="function"?Bt:+Bt,ue):Je},ue.friction=function(Bt){return arguments.length?(Se=+Bt,ue):Se},ue.charge=function(Bt){return arguments.length?(at=typeof Bt=="function"?Bt:+Bt,ue):at},ue.chargeDistance=function(Bt){return arguments.length?(bt=Bt*Bt,ue):Math.sqrt(bt)},ue.gravity=function(Bt){return arguments.length?(Et=+Bt,ue):Et},ue.theta=function(Bt){return arguments.length?(kt=Bt*Bt,ue):Math.sqrt(kt)},ue.alpha=function(Bt){return arguments.length?(Bt=+Bt,z?Bt>0?z=Bt:(ce.c=null,ce.t=NaN,ce=null,ge.end({type:"end",alpha:z=0})):Bt>0&&(ge.start({type:"start",alpha:z=Bt}),ce=vn(ue.tick)),ue):z},ue.start=function(){var Bt,nr,gr,Lr=At.length,Sr=xt.length,$r=we[0],Qr=we[1];for(Bt=0;Bt<Lr;++Bt)(gr=At[Bt]).index=Bt,gr.weight=0;for(Bt=0;Bt<Sr;++Bt)typeof(gr=xt[Bt]).source=="number"&&(gr.source=At[gr.source]),typeof gr.target=="number"&&(gr.target=At[gr.target]),++gr.source.weight,++gr.target.weight;for(Bt=0;Bt<Lr;++Bt)gr=At[Bt],isNaN(gr.x)&&(gr.x=fn("x",$r)),isNaN(gr.y)&&(gr.y=fn("y",Qr)),isNaN(gr.px)&&(gr.px=gr.x),isNaN(gr.py)&&(gr.py=gr.y);if(F=[],typeof Ve=="function")for(Bt=0;Bt<Sr;++Bt)F[Bt]=+Ve.call(this,xt[Bt],Bt);else for(Bt=0;Bt<Sr;++Bt)F[Bt]=Ve;if(q=[],typeof Je=="function")for(Bt=0;Bt<Sr;++Bt)q[Bt]=+Je.call(this,xt[Bt],Bt);else for(Bt=0;Bt<Sr;++Bt)q[Bt]=Je;if(ie=[],typeof at=="function")for(Bt=0;Bt<Lr;++Bt)ie[Bt]=+at.call(this,At[Bt],Bt);else for(Bt=0;Bt<Lr;++Bt)ie[Bt]=at;function fn(sn,Vn){if(!nr){for(nr=new Array(Lr),Mn=0;Mn<Lr;++Mn)nr[Mn]=[];for(Mn=0;Mn<Sr;++Mn){var Jn=xt[Mn];nr[Jn.source.index].push(Jn.target),nr[Jn.target.index].push(Jn.source)}}for(var ha,Wr=nr[Bt],Mn=-1,Kn=Wr.length;++Mn<Kn;)if(!isNaN(ha=Wr[Mn][sn]))return ha;return Math.random()*Vn}return ue.resume()},ue.resume=function(){return ue.alpha(.1)},ue.stop=function(){return ue.alpha(0)},ue.drag=function(){if(C||(C=p.behavior.drag().origin(E).on("dragstart.force",Ge).on("drag.force",It).on("dragend.force",et)),!arguments.length)return C;this.on("mouseover.force",lt).on("mouseout.force",gt).call(C)},p.rebind(ue,ge,"on")};var dt=20,St=1,Xt=1/0;function Kt(ce,C){return p.rebind(ce,C,"sort","children","value"),ce.nodes=ce,ce.links=Dr,ce}function Yt(ce,C){for(var z=[ce];(ce=z.pop())!=null;)if(C(ce),(q=ce.children)&&(F=q.length))for(var F,q;--F>=0;)z.push(q[F])}function or(ce,C){for(var z=[ce],F=[];(ce=z.pop())!=null;)if(F.push(ce),(ie=ce.children)&&(q=ie.length))for(var q,ie,ue=-1;++ue<q;)z.push(ie[ue]);for(;(ce=F.pop())!=null;)C(ce)}function mr(ce){return ce.children}function wr(ce){return ce.value}function Tr(ce,C){return C.value-ce.value}function Dr(ce){return p.merge(ce.map(function(C){return(C.children||[]).map(function(z){return{source:C,target:z}})}))}p.layout.hierarchy=function(){var ce=Tr,C=mr,z=wr;function F(q){var ie,ue=[q],ge=[];for(q.depth=0;(ie=ue.pop())!=null;)if(ge.push(ie),(Se=C.call(F,ie,ie.depth))&&(we=Se.length)){for(var we,Se,Ve;--we>=0;)ue.push(Ve=Se[we]),Ve.parent=ie,Ve.depth=ie.depth+1;z&&(ie.value=0),ie.children=Se}else z&&(ie.value=+z.call(F,ie,ie.depth)||0),delete ie.children;return or(q,function(Je){var at,bt;ce&&(at=Je.children)&&at.sort(ce),z&&(bt=Je.parent)&&(bt.value+=Je.value)}),ge}return F.sort=function(q){return arguments.length?(ce=q,F):ce},F.children=function(q){return arguments.length?(C=q,F):C},F.value=function(q){return arguments.length?(z=q,F):z},F.revalue=function(q){return z&&(Yt(q,function(ie){ie.children&&(ie.value=0)}),or(q,function(ie){var ue;ie.children||(ie.value=+z.call(F,ie,ie.depth)||0),(ue=ie.parent)&&(ue.value+=ie.value)})),q},F},p.layout.partition=function(){var ce=p.layout.hierarchy(),C=[1,1];function z(F,q){var ie=ce.call(this,F,q);return function ue(ge,we,Se,Ve){var Je=ge.children;if(ge.x=we,ge.y=ge.depth*Ve,ge.dx=Se,ge.dy=Ve,Je&&(at=Je.length)){var at,bt,Et,kt=-1;for(Se=ge.value?Se/ge.value:0;++kt<at;)ue(bt=Je[kt],we,Et=bt.value*Se,Ve),we+=Et}}(ie[0],0,C[0],C[1]/function ue(ge){var we=ge.children,Se=0;if(we&&(Ve=we.length))for(var Ve,Je=-1;++Je<Ve;)Se=Math.max(Se,ue(we[Je]));return 1+Se}(ie[0])),ie}return z.size=function(F){return arguments.length?(C=F,z):C},Kt(z,ce)},p.layout.pie=function(){var ce=Number,C=nn,z=0,F=qt,q=0;function ie(ue){var ge,we=ue.length,Se=ue.map(function(zt,It){return+ce.call(ie,zt,It)}),Ve=+(typeof z=="function"?z.apply(this,arguments):z),Je=(typeof F=="function"?F.apply(this,arguments):F)-Ve,at=Math.min(Math.abs(Je)/we,+(typeof q=="function"?q.apply(this,arguments):q)),bt=at*(Je<0?-1:1),Et=p.sum(Se),kt=Et?(Je-we*bt)/Et:0,At=p.range(we),xt=[];return C!=null&&At.sort(C===nn?function(zt,It){return Se[It]-Se[zt]}:function(zt,It){return C(ue[zt],ue[It])}),At.forEach(function(zt){xt[zt]={data:ue[zt],value:ge=Se[zt],startAngle:Ve,endAngle:Ve+=ge*kt+bt,padAngle:at}}),xt}return ie.value=function(ue){return arguments.length?(ce=ue,ie):ce},ie.sort=function(ue){return arguments.length?(C=ue,ie):C},ie.startAngle=function(ue){return arguments.length?(z=ue,ie):z},ie.endAngle=function(ue){return arguments.length?(F=ue,ie):F},ie.padAngle=function(ue){return arguments.length?(q=ue,ie):q},ie};var nn={};function hn(ce){return ce.x}function Cn(ce){return ce.y}function Dn(ce,C,z){ce.y0=C,ce.y=z}p.layout.stack=function(){var ce=E,C=va,z=Sa,F=Dn,q=hn,ie=Cn;function ue(ge,we){if(!(at=ge.length))return ge;var Se=ge.map(function(zt,It){return ce.call(ue,zt,It)}),Ve=Se.map(function(zt){return zt.map(function(It,Bt){return[q.call(ue,It,Bt),ie.call(ue,It,Bt)]})}),Je=C.call(ue,Ve,we);Se=p.permute(Se,Je),Ve=p.permute(Ve,Je);var at,bt,Et,kt,At=z.call(ue,Ve,we),xt=Se[0].length;for(Et=0;Et<xt;++Et)for(F.call(ue,Se[0][Et],kt=At[Et],Ve[0][Et][1]),bt=1;bt<at;++bt)F.call(ue,Se[bt][Et],kt+=Ve[bt-1][Et][1],Ve[bt][Et][1]);return ge}return ue.values=function(ge){return arguments.length?(ce=ge,ue):ce},ue.order=function(ge){return arguments.length?(C=typeof ge=="function"?ge:Gn.get(ge)||va,ue):C},ue.offset=function(ge){return arguments.length?(z=typeof ge=="function"?ge:Rn.get(ge)||Sa,ue):z},ue.x=function(ge){return arguments.length?(q=ge,ue):q},ue.y=function(ge){return arguments.length?(ie=ge,ue):ie},ue.out=function(ge){return arguments.length?(F=ge,ue):F},ue};var Gn=p.map({"inside-out":function(ce){var C,z,F=ce.length,q=ce.map(Ua),ie=ce.map(ja),ue=p.range(F).sort(function(Je,at){return q[Je]-q[at]}),ge=0,we=0,Se=[],Ve=[];for(C=0;C<F;++C)z=ue[C],ge<we?(ge+=ie[z],Se.push(z)):(we+=ie[z],Ve.push(z));return Ve.reverse().concat(Se)},reverse:function(ce){return p.range(ce.length).reverse()},default:va}),Rn=p.map({silhouette:function(ce){var C,z,F,q=ce.length,ie=ce[0].length,ue=[],ge=0,we=[];for(z=0;z<ie;++z){for(C=0,F=0;C<q;C++)F+=ce[C][z][1];F>ge&&(ge=F),ue.push(F)}for(z=0;z<ie;++z)we[z]=(ge-ue[z])/2;return we},wiggle:function(ce){var C,z,F,q,ie,ue,ge,we,Se,Ve=ce.length,Je=ce[0],at=Je.length,bt=[];for(bt[0]=we=Se=0,z=1;z<at;++z){for(C=0,q=0;C<Ve;++C)q+=ce[C][z][1];for(C=0,ie=0,ge=Je[z][0]-Je[z-1][0];C<Ve;++C){for(F=0,ue=(ce[C][z][1]-ce[C][z-1][1])/(2*ge);F<C;++F)ue+=(ce[F][z][1]-ce[F][z-1][1])/ge;ie+=ue*ce[C][z][1]}bt[z]=we-=q?ie/q*ge:0,we<Se&&(Se=we)}for(z=0;z<at;++z)bt[z]-=Se;return bt},expand:function(ce){var C,z,F,q=ce.length,ie=ce[0].length,ue=1/q,ge=[];for(z=0;z<ie;++z){for(C=0,F=0;C<q;C++)F+=ce[C][z][1];if(F)for(C=0;C<q;C++)ce[C][z][1]/=F;else for(C=0;C<q;C++)ce[C][z][1]=ue}for(z=0;z<ie;++z)ge[z]=0;return ge},zero:Sa});function va(ce){return p.range(ce.length)}function Sa(ce){for(var C=-1,z=ce[0].length,F=[];++C<z;)F[C]=0;return F}function Ua(ce){for(var C,z=1,F=0,q=ce[0][1],ie=ce.length;z<ie;++z)(C=ce[z][1])>q&&(F=z,q=C);return F}function ja(ce){return ce.reduce(Va,0)}function Va(ce,C){return ce+C[1]}function Ai(ce,C){return Ti(ce,Math.ceil(Math.log(C.length)/Math.LN2+1))}function Ti(ce,C){for(var z=-1,F=+ce[0],q=(ce[1]-F)/C,ie=[];++z<=C;)ie[z]=q*z+F;return ie}function ci(ce){return[p.min(ce),p.max(ce)]}function ui(ce,C){return ce.value-C.value}function ki(ce,C){var z=ce._pack_next;ce._pack_next=C,C._pack_prev=ce,C._pack_next=z,z._pack_prev=C}function Vi(ce,C){ce._pack_next=C,C._pack_prev=ce}function ro(ce,C){var z=C.x-ce.x,F=C.y-ce.y,q=ce.r+C.r;return .999*q*q>z*z+F*F}function no(ce){if((C=ce.children)&&(we=C.length)){var C,z,F,q,ie,ue,ge,we,Se=1/0,Ve=-1/0,Je=1/0,at=-1/0;if(C.forEach(ao),(z=C[0]).x=-z.r,z.y=0,It(z),we>1&&((F=C[1]).x=F.r,F.y=0,It(F),we>2))for(Da(z,F,q=C[2]),It(q),ki(z,q),z._pack_prev=q,ki(q,F),F=z._pack_next,ie=3;ie<we;ie++){Da(z,F,q=C[ie]);var bt=0,Et=1,kt=1;for(ue=F._pack_next;ue!==F;ue=ue._pack_next,Et++)if(ro(ue,q)){bt=1;break}if(bt==1)for(ge=z._pack_prev;ge!==ue._pack_prev&&!ro(ge,q);ge=ge._pack_prev,kt++);bt?(Et<kt||Et==kt&&F.r<z.r?Vi(z,F=ue):Vi(z=ge,F),ie--):(ki(z,q),F=q,It(q))}var At=(Se+Ve)/2,xt=(Je+at)/2,zt=0;for(ie=0;ie<we;ie++)(q=C[ie]).x-=At,q.y-=xt,zt=Math.max(zt,q.r+Math.sqrt(q.x*q.x+q.y*q.y));ce.r=zt,C.forEach(io)}function It(Bt){Se=Math.min(Bt.x-Bt.r,Se),Ve=Math.max(Bt.x+Bt.r,Ve),Je=Math.min(Bt.y-Bt.r,Je),at=Math.max(Bt.y+Bt.r,at)}}function ao(ce){ce._pack_next=ce._pack_prev=ce}function io(ce){delete ce._pack_next,delete ce._pack_prev}function Da(ce,C,z){var F=ce.r+z.r,q=C.x-ce.x,ie=C.y-ce.y;if(F&&(q||ie)){var ue=C.r+z.r,ge=q*q+ie*ie,we=.5+((F*=F)-(ue*=ue))/(2*ge),Se=Math.sqrt(Math.max(0,2*ue*(F+ge)-(F-=ge)*F-ue*ue))/(2*ge);z.x=ce.x+we*q+Se*ie,z.y=ce.y+we*ie-Se*q}else z.x=ce.x+F,z.y=ce.y}function ht(ce,C){return ce.parent==C.parent?1:2}function Ot(ce){var C=ce.children;return C.length?C[0]:ce.t}function cr(ce){var C,z=ce.children;return(C=z.length)?z[C-1]:ce.t}function Ut(ce,C,z){var F=z/(C.i-ce.i);C.c-=F,C.s+=z,ce.c+=F,C.z+=z,C.m+=z}function ur(ce,C,z){return ce.a.parent===C.parent?ce.a:z}function Or(ce){return{x:ce.x,y:ce.y,dx:ce.dx,dy:ce.dy}}function jr(ce,C){var z=ce.x+C[3],F=ce.y+C[0],q=ce.dx-C[1]-C[3],ie=ce.dy-C[0]-C[2];return q<0&&(z+=q/2,q=0),ie<0&&(F+=ie/2,ie=0),{x:z,y:F,dx:q,dy:ie}}function Zr(ce){var C=ce[0],z=ce[ce.length-1];return C<z?[C,z]:[z,C]}function ln(ce){return ce.rangeExtent?ce.rangeExtent():Zr(ce.range())}function an(ce,C,z,F){var q=z(ce[0],ce[1]),ie=F(C[0],C[1]);return function(ue){return ie(q(ue))}}function dn(ce,C){var z,F=0,q=ce.length-1,ie=ce[F],ue=ce[q];return ue<ie&&(z=F,F=q,q=z,z=ie,ie=ue,ue=z),ce[F]=C.floor(ie),ce[q]=C.ceil(ue),ce}function Tn(ce){return ce?{floor:function(C){return Math.floor(C/ce)*ce},ceil:function(C){return Math.ceil(C/ce)*ce}}:cn}p.layout.histogram=function(){var ce=!0,C=Number,z=ci,F=Ai;function q(ie,ue){for(var ge,we,Se=[],Ve=ie.map(C,this),Je=z.call(this,Ve,ue),at=F.call(this,Je,Ve,ue),bt=(ue=-1,Ve.length),Et=at.length-1,kt=ce?1:1/bt;++ue<Et;)(ge=Se[ue]=[]).dx=at[ue+1]-(ge.x=at[ue]),ge.y=0;if(Et>0)for(ue=-1;++ue<bt;)(we=Ve[ue])>=Je[0]&&we<=Je[1]&&((ge=Se[p.bisect(at,we,1,Et)-1]).y+=kt,ge.push(ie[ue]));return Se}return q.value=function(ie){return arguments.length?(C=ie,q):C},q.range=function(ie){return arguments.length?(z=vr(ie),q):z},q.bins=function(ie){return arguments.length?(F=typeof ie=="number"?function(ue){return Ti(ue,ie)}:vr(ie),q):F},q.frequency=function(ie){return arguments.length?(ce=!!ie,q):ce},q},p.layout.pack=function(){var ce,C=p.layout.hierarchy().sort(ui),z=0,F=[1,1];function q(ie,ue){var ge=C.call(this,ie,ue),we=ge[0],Se=F[0],Ve=F[1],Je=ce==null?Math.sqrt:typeof ce=="function"?ce:function(){return ce};if(we.x=we.y=0,or(we,function(bt){bt.r=+Je(bt.value)}),or(we,no),z){var at=z*(ce?1:Math.max(2*we.r/Se,2*we.r/Ve))/2;or(we,function(bt){bt.r+=at}),or(we,no),or(we,function(bt){bt.r-=at})}return function bt(Et,kt,At,xt){var zt=Et.children;if(Et.x=kt+=xt*Et.x,Et.y=At+=xt*Et.y,Et.r*=xt,zt)for(var It=-1,Bt=zt.length;++It<Bt;)bt(zt[It],kt,At,xt)}(we,Se/2,Ve/2,ce?1:1/Math.max(2*we.r/Se,2*we.r/Ve)),ge}return q.size=function(ie){return arguments.length?(F=ie,q):F},q.radius=function(ie){return arguments.length?(ce=ie==null||typeof ie=="function"?ie:+ie,q):ce},q.padding=function(ie){return arguments.length?(z=+ie,q):z},Kt(q,C)},p.layout.tree=function(){var ce=p.layout.hierarchy().sort(null).value(null),C=ht,z=[1,1],F=null;function q(we,Se){var Ve=ce.call(this,we,Se),Je=Ve[0],at=function(It){for(var Bt,nr={A:null,children:[It]},gr=[nr];(Bt=gr.pop())!=null;)for(var Lr,Sr=Bt.children,$r=0,Qr=Sr.length;$r<Qr;++$r)gr.push((Sr[$r]=Lr={_:Sr[$r],parent:Bt,children:(Lr=Sr[$r].children)&&Lr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:$r}).a=Lr);return nr.children[0]}(Je);if(or(at,ie),at.parent.m=-at.z,Yt(at,ue),F)Yt(Je,ge);else{var bt=Je,Et=Je,kt=Je;Yt(Je,function(It){It.x<bt.x&&(bt=It),It.x>Et.x&&(Et=It),It.depth>kt.depth&&(kt=It)});var At=C(bt,Et)/2-bt.x,xt=z[0]/(Et.x+C(Et,bt)/2+At),zt=z[1]/(kt.depth||1);Yt(Je,function(It){It.x=(It.x+At)*xt,It.y=It.depth*zt})}return Ve}function ie(we){var Se=we.children,Ve=we.parent.children,Je=we.i?Ve[we.i-1]:null;if(Se.length){(function(bt){for(var Et,kt=0,At=0,xt=bt.children,zt=xt.length;--zt>=0;)(Et=xt[zt]).z+=kt,Et.m+=kt,kt+=Et.s+(At+=Et.c)})(we);var at=(Se[0].z+Se[Se.length-1].z)/2;Je?(we.z=Je.z+C(we._,Je._),we.m=we.z-at):we.z=at}else Je&&(we.z=Je.z+C(we._,Je._));we.parent.A=function(bt,Et,kt){if(Et){for(var At,xt=bt,zt=bt,It=Et,Bt=xt.parent.children[0],nr=xt.m,gr=zt.m,Lr=It.m,Sr=Bt.m;It=cr(It),xt=Ot(xt),It&&xt;)Bt=Ot(Bt),(zt=cr(zt)).a=bt,(At=It.z+Lr-xt.z-nr+C(It._,xt._))>0&&(Ut(ur(It,bt,kt),bt,At),nr+=At,gr+=At),Lr+=It.m,nr+=xt.m,Sr+=Bt.m,gr+=zt.m;It&&!cr(zt)&&(zt.t=It,zt.m+=Lr-gr),xt&&!Ot(Bt)&&(Bt.t=xt,Bt.m+=nr-Sr,kt=bt)}return kt}(we,Je,we.parent.A||Ve[0])}function ue(we){we._.x=we.z+we.parent.m,we.m+=we.parent.m}function ge(we){we.x*=z[0],we.y=we.depth*z[1]}return q.separation=function(we){return arguments.length?(C=we,q):C},q.size=function(we){return arguments.length?(F=(z=we)==null?ge:null,q):F?null:z},q.nodeSize=function(we){return arguments.length?(F=(z=we)==null?null:ge,q):F?z:null},Kt(q,ce)},p.layout.cluster=function(){var ce=p.layout.hierarchy().sort(null).value(null),C=ht,z=[1,1],F=!1;function q(ie,ue){var ge,we=ce.call(this,ie,ue),Se=we[0],Ve=0;or(Se,function(kt){var At=kt.children;At&&At.length?(kt.x=function(xt){return xt.reduce(function(zt,It){return zt+It.x},0)/xt.length}(At),kt.y=function(xt){return 1+p.max(xt,function(zt){return zt.y})}(At)):(kt.x=ge?Ve+=C(kt,ge):0,kt.y=0,ge=kt)});var Je=function kt(At){var xt=At.children;return xt&&xt.length?kt(xt[0]):At}(Se),at=function kt(At){var xt,zt=At.children;return zt&&(xt=zt.length)?kt(zt[xt-1]):At}(Se),bt=Je.x-C(Je,at)/2,Et=at.x+C(at,Je)/2;return or(Se,F?function(kt){kt.x=(kt.x-Se.x)*z[0],kt.y=(Se.y-kt.y)*z[1]}:function(kt){kt.x=(kt.x-bt)/(Et-bt)*z[0],kt.y=(1-(Se.y?kt.y/Se.y:1))*z[1]}),we}return q.separation=function(ie){return arguments.length?(C=ie,q):C},q.size=function(ie){return arguments.length?(F=(z=ie)==null,q):F?null:z},q.nodeSize=function(ie){return arguments.length?(F=(z=ie)!=null,q):F?z:null},Kt(q,ce)},p.layout.treemap=function(){var ce,C=p.layout.hierarchy(),z=Math.round,F=[1,1],q=null,ie=Or,ue=!1,ge="squarify",we=.5*(1+Math.sqrt(5));function Se(kt,At){for(var xt,zt,It=-1,Bt=kt.length;++It<Bt;)zt=(xt=kt[It]).value*(At<0?0:At),xt.area=isNaN(zt)||zt<=0?0:zt}function Ve(kt){var At=kt.children;if(At&&At.length){var xt,zt,It,Bt=ie(kt),nr=[],gr=At.slice(),Lr=1/0,Sr=ge==="slice"?Bt.dx:ge==="dice"?Bt.dy:ge==="slice-dice"?1&kt.depth?Bt.dy:Bt.dx:Math.min(Bt.dx,Bt.dy);for(Se(gr,Bt.dx*Bt.dy/kt.value),nr.area=0;(It=gr.length)>0;)nr.push(xt=gr[It-1]),nr.area+=xt.area,ge!=="squarify"||(zt=at(nr,Sr))<=Lr?(gr.pop(),Lr=zt):(nr.area-=nr.pop().area,bt(nr,Sr,Bt,!1),Sr=Math.min(Bt.dx,Bt.dy),nr.length=nr.area=0,Lr=1/0);nr.length&&(bt(nr,Sr,Bt,!0),nr.length=nr.area=0),At.forEach(Ve)}}function Je(kt){var At=kt.children;if(At&&At.length){var xt,zt=ie(kt),It=At.slice(),Bt=[];for(Se(It,zt.dx*zt.dy/kt.value),Bt.area=0;xt=It.pop();)Bt.push(xt),Bt.area+=xt.area,xt.z!=null&&(bt(Bt,xt.z?zt.dx:zt.dy,zt,!It.length),Bt.length=Bt.area=0);At.forEach(Je)}}function at(kt,At){for(var xt,zt=kt.area,It=0,Bt=1/0,nr=-1,gr=kt.length;++nr<gr;)(xt=kt[nr].area)&&(xt<Bt&&(Bt=xt),xt>It&&(It=xt));return At*=At,(zt*=zt)?Math.max(At*It*we/zt,zt/(At*Bt*we)):1/0}function bt(kt,At,xt,zt){var It,Bt=-1,nr=kt.length,gr=xt.x,Lr=xt.y,Sr=At?z(kt.area/At):0;if(At==xt.dx){for((zt||Sr>xt.dy)&&(Sr=xt.dy);++Bt<nr;)(It=kt[Bt]).x=gr,It.y=Lr,It.dy=Sr,gr+=It.dx=Math.min(xt.x+xt.dx-gr,Sr?z(It.area/Sr):0);It.z=!0,It.dx+=xt.x+xt.dx-gr,xt.y+=Sr,xt.dy-=Sr}else{for((zt||Sr>xt.dx)&&(Sr=xt.dx);++Bt<nr;)(It=kt[Bt]).x=gr,It.y=Lr,It.dx=Sr,Lr+=It.dy=Math.min(xt.y+xt.dy-Lr,Sr?z(It.area/Sr):0);It.z=!1,It.dy+=xt.y+xt.dy-Lr,xt.x+=Sr,xt.dx-=Sr}}function Et(kt){var At=ce||C(kt),xt=At[0];return xt.x=xt.y=0,xt.value?(xt.dx=F[0],xt.dy=F[1]):xt.dx=xt.dy=0,ce&&C.revalue(xt),Se([xt],xt.dx*xt.dy/xt.value),(ce?Je:Ve)(xt),ue&&(ce=At),At}return Et.size=function(kt){return arguments.length?(F=kt,Et):F},Et.padding=function(kt){if(!arguments.length)return q;function At(It){var Bt=kt.call(Et,It,It.depth);return Bt==null?Or(It):jr(It,typeof Bt=="number"?[Bt,Bt,Bt,Bt]:Bt)}function xt(It){return jr(It,kt)}var zt;return ie=(q=kt)==null?Or:(zt=typeof kt)=="function"?At:(zt==="number"&&(kt=[kt,kt,kt,kt]),xt),Et},Et.round=function(kt){return arguments.length?(z=kt?Math.round:Number,Et):z!=Number},Et.sticky=function(kt){return arguments.length?(ue=kt,ce=null,Et):ue},Et.ratio=function(kt){return arguments.length?(we=kt,Et):we},Et.mode=function(kt){return arguments.length?(ge=kt+"",Et):ge},Kt(Et,C)},p.random={normal:function(ce,C){var z=arguments.length;return z<2&&(C=1),z<1&&(ce=0),function(){var F,q,ie;do ie=(F=2*Math.random()-1)*F+(q=2*Math.random()-1)*q;while(!ie||ie>1);return ce+C*F*Math.sqrt(-2*Math.log(ie)/ie)}},logNormal:function(){var ce=p.random.normal.apply(p,arguments);return function(){return Math.exp(ce())}},bates:function(ce){var C=p.random.irwinHall(ce);return function(){return C()/ce}},irwinHall:function(ce){return function(){for(var C=0,z=0;z<ce;z++)C+=Math.random();return C}}},p.scale={};var cn={floor:E,ceil:E};function kn(ce,C,z,F){var q=[],ie=[],ue=0,ge=Math.min(ce.length,C.length)-1;for(ce[ge]<ce[0]&&(ce=ce.slice().reverse(),C=C.slice().reverse());++ue<=ge;)q.push(z(ce[ue-1],ce[ue])),ie.push(F(C[ue-1],C[ue]));return function(we){var Se=p.bisect(ce,we,1,ge)-1;return ie[Se](q[Se](we))}}function Fn(ce,C){return p.rebind(ce,C,"range","rangeRound","interpolate","clamp")}function qn(ce,C){return dn(ce,Tn(oa(ce,C)[2])),dn(ce,Tn(oa(ce,C)[2])),ce}function oa(ce,C){C==null&&(C=10);var z=Zr(ce),F=z[1]-z[0],q=Math.pow(10,Math.floor(Math.log(F/C)/Math.LN10)),ie=C/F*q;return ie<=.15?q*=10:ie<=.35?q*=5:ie<=.75&&(q*=2),z[0]=Math.ceil(z[0]/q)*q,z[1]=Math.floor(z[1]/q)*q+.5*q,z[2]=q,z}function Kr(ce,C){return p.range.apply(p,oa(ce,C))}p.scale.linear=function(){return function ce(C,z,F,q){var ie,ue;function ge(){var Se=Math.min(C.length,z.length)>2?kn:an,Ve=q?Do:xs;return ie=Se(C,z,Ve,F),ue=Se(z,C,Ve,Ui),we}function we(Se){return ie(Se)}return we.invert=function(Se){return ue(Se)},we.domain=function(Se){return arguments.length?(C=Se.map(Number),ge()):C},we.range=function(Se){return arguments.length?(z=Se,ge()):z},we.rangeRound=function(Se){return we.range(Se).interpolate(Yo)},we.clamp=function(Se){return arguments.length?(q=Se,ge()):q},we.interpolate=function(Se){return arguments.length?(F=Se,ge()):F},we.ticks=function(Se){return Kr(C,Se)},we.tickFormat=function(Se,Ve){return d3_scale_linearTickFormat(C,Se,Ve)},we.nice=function(Se){return qn(C,Se),ge()},we.copy=function(){return ce(C,z,F,q)},ge()}([0,1],[0,1],Ui,!1)},p.scale.log=function(){return function ce(C,z,F,q){function ie(we){return(F?Math.log(we<0?0:we):-Math.log(we>0?0:-we))/Math.log(z)}function ue(we){return F?Math.pow(z,we):-Math.pow(z,-we)}function ge(we){return C(ie(we))}return ge.invert=function(we){return ue(C.invert(we))},ge.domain=function(we){return arguments.length?(F=we[0]>=0,C.domain((q=we.map(Number)).map(ie)),ge):q},ge.base=function(we){return arguments.length?(z=+we,C.domain(q.map(ie)),ge):z},ge.nice=function(){var we=dn(q.map(ie),F?Math:na);return C.domain(we),q=we.map(ue),ge},ge.ticks=function(){var we=Zr(q),Se=[],Ve=we[0],Je=we[1],at=Math.floor(ie(Ve)),bt=Math.ceil(ie(Je)),Et=z%1?2:z;if(isFinite(bt-at)){if(F){for(;at<bt;at++)for(var kt=1;kt<Et;kt++)Se.push(ue(at)*kt);Se.push(ue(at))}else for(Se.push(ue(at));at++<bt;)for(kt=Et-1;kt>0;kt--)Se.push(ue(at)*kt);for(at=0;Se[at]<Ve;at++);for(bt=Se.length;Se[bt-1]>Je;bt--);Se=Se.slice(at,bt)}return Se},ge.copy=function(){return ce(C.copy(),z,F,q)},Fn(ge,C)}(p.scale.linear().domain([0,1]),10,!0,[1,10])};var na={floor:function(ce){return-Math.ceil(-ce)},ceil:function(ce){return-Math.floor(-ce)}};function Pn(ce){return function(C){return C<0?-Math.pow(-C,ce):Math.pow(C,ce)}}p.scale.pow=function(){return function ce(C,z,F){var q=Pn(z),ie=Pn(1/z);function ue(ge){return C(q(ge))}return ue.invert=function(ge){return ie(C.invert(ge))},ue.domain=function(ge){return arguments.length?(C.domain((F=ge.map(Number)).map(q)),ue):F},ue.ticks=function(ge){return Kr(F,ge)},ue.tickFormat=function(ge,we){return d3_scale_linearTickFormat(F,ge,we)},ue.nice=function(ge){return ue.domain(qn(F,ge))},ue.exponent=function(ge){return arguments.length?(q=Pn(z=ge),ie=Pn(1/z),C.domain(F.map(q)),ue):z},ue.copy=function(){return ce(C.copy(),z,F)},Fn(ue,C)}(p.scale.linear(),1,[0,1])},p.scale.sqrt=function(){return p.scale.pow().exponent(.5)},p.scale.ordinal=function(){return function ce(C,z){var F,q,ie;function ue(we){return q[((F.get(we)||(z.t==="range"?F.set(we,C.push(we)):NaN))-1)%q.length]}function ge(we,Se){return p.range(C.length).map(function(Ve){return we+Se*Ve})}return ue.domain=function(we){if(!arguments.length)return C;C=[],F=new T;for(var Se,Ve=-1,Je=we.length;++Ve<Je;)F.has(Se=we[Ve])||F.set(Se,C.push(Se));return ue[z.t].apply(ue,z.a)},ue.range=function(we){return arguments.length?(q=we,ie=0,z={t:"range",a:arguments},ue):q},ue.rangePoints=function(we,Se){arguments.length<2&&(Se=0);var Ve=we[0],Je=we[1],at=C.length<2?(Ve=(Ve+Je)/2,0):(Je-Ve)/(C.length-1+Se);return q=ge(Ve+at*Se/2,at),ie=0,z={t:"rangePoints",a:arguments},ue},ue.rangeRoundPoints=function(we,Se){arguments.length<2&&(Se=0);var Ve=we[0],Je=we[1],at=C.length<2?(Ve=Je=Math.round((Ve+Je)/2),0):(Je-Ve)/(C.length-1+Se)|0;return q=ge(Ve+Math.round(at*Se/2+(Je-Ve-(C.length-1+Se)*at)/2),at),ie=0,z={t:"rangeRoundPoints",a:arguments},ue},ue.rangeBands=function(we,Se,Ve){arguments.length<2&&(Se=0),arguments.length<3&&(Ve=Se);var Je=we[1]<we[0],at=we[Je-0],bt=we[1-Je],Et=(bt-at)/(C.length-Se+2*Ve);return q=ge(at+Et*Ve,Et),Je&&q.reverse(),ie=Et*(1-Se),z={t:"rangeBands",a:arguments},ue},ue.rangeRoundBands=function(we,Se,Ve){arguments.length<2&&(Se=0),arguments.length<3&&(Ve=Se);var Je=we[1]<we[0],at=we[Je-0],bt=we[1-Je],Et=Math.floor((bt-at)/(C.length-Se+2*Ve));return q=ge(at+Math.round((bt-at-(C.length-Se)*Et)/2),Et),Je&&q.reverse(),ie=Math.round(Et*(1-Se)),z={t:"rangeRoundBands",a:arguments},ue},ue.rangeBand=function(){return ie},ue.rangeExtent=function(){return Zr(z.a[0])},ue.copy=function(){return ce(C,z)},ue.domain(C)}([],{t:"range",a:[[]]})},p.scale.category10=function(){return p.scale.ordinal().range(Un)},p.scale.category20=function(){return p.scale.ordinal().range(ra)},p.scale.category20b=function(){return p.scale.ordinal().range(ka)},p.scale.category20c=function(){return p.scale.ordinal().range(Pa)};var Un=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Gt),ra=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Gt),ka=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Gt),Pa=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Gt);function En(){return 0}p.scale.quantile=function(){return function ce(C,z){var F;function q(){var ue=0,ge=z.length;for(F=[];++ue<ge;)F[ue-1]=p.quantile(C,ue/ge);return ie}function ie(ue){if(!isNaN(ue=+ue))return z[p.bisect(F,ue)]}return ie.domain=function(ue){return arguments.length?(C=ue.map(u).filter(f).sort(i),q()):C},ie.range=function(ue){return arguments.length?(z=ue,q()):z},ie.quantiles=function(){return F},ie.invertExtent=function(ue){return(ue=z.indexOf(ue))<0?[NaN,NaN]:[ue>0?F[ue-1]:C[0],ue<F.length?F[ue]:C[C.length-1]]},ie.copy=function(){return ce(C,z)},q()}([],[])},p.scale.quantize=function(){return function ce(C,z,F){var q,ie;function ue(we){return F[Math.max(0,Math.min(ie,Math.floor(q*(we-C))))]}function ge(){return q=F.length/(z-C),ie=F.length-1,ue}return ue.domain=function(we){return arguments.length?(C=+we[0],z=+we[we.length-1],ge()):[C,z]},ue.range=function(we){return arguments.length?(F=we,ge()):F},ue.invertExtent=function(we){return[we=(we=F.indexOf(we))<0?NaN:we/q+C,we+1/q]},ue.copy=function(){return ce(C,z,F)},ge()}(0,1,[0,1])},p.scale.threshold=function(){return function ce(C,z){function F(q){if(q<=q)return z[p.bisect(C,q)]}return F.domain=function(q){return arguments.length?(C=q,F):C},F.range=function(q){return arguments.length?(z=q,F):z},F.invertExtent=function(q){return q=z.indexOf(q),[C[q-1],C[q]]},F.copy=function(){return ce(C,z)},F}([.5],[0,1])},p.scale.identity=function(){return function ce(C){function z(F){return+F}return z.invert=z,z.domain=z.range=function(F){return arguments.length?(C=F.map(z),z):C},z.ticks=function(F){return Kr(C,F)},z.tickFormat=function(F,q){return d3_scale_linearTickFormat(C,F,q)},z.copy=function(){return ce(C)},z}([0,1])},p.svg={},p.svg.arc=function(){var ce=Ca,C=ga,z=En,F=Ra,q=Fa,ie=Ea,ue=ri;function ge(){var Se=Math.max(0,+ce.apply(this,arguments)),Ve=Math.max(0,+C.apply(this,arguments)),Je=q.apply(this,arguments)-Jt,at=ie.apply(this,arguments)-Jt,bt=Math.abs(at-Je),Et=Je>at?0:1;if(Ve<Se&&(kt=Ve,Ve=Se,Se=kt),bt>=er)return we(Ve,Et)+(Se?we(Se,1-Et):"")+"Z";var kt,At,xt,zt,It,Bt,nr,gr,Lr,Sr,$r,Qr,fn=0,sn=0,Vn=[];if((zt=(+ue.apply(this,arguments)||0)/2)&&(xt=F===Ra?Math.sqrt(Se*Se+Ve*Ve):+F.apply(this,arguments),Et||(sn*=-1),Ve&&(sn=Ue(xt/Ve*Math.sin(zt))),Se&&(fn=Ue(xt/Se*Math.sin(zt)))),Ve){It=Ve*Math.cos(Je+sn),Bt=Ve*Math.sin(Je+sn),nr=Ve*Math.cos(at-sn),gr=Ve*Math.sin(at-sn);var Jn=Math.abs(at-Je-2*sn)<=Nt?0:1;if(sn&&aa(It,Bt,nr,gr)===Et^Jn){var ha=(Je+at)/2;It=Ve*Math.cos(ha),Bt=Ve*Math.sin(ha),nr=gr=null}}else It=Bt=0;if(Se){Lr=Se*Math.cos(at-fn),Sr=Se*Math.sin(at-fn),$r=Se*Math.cos(Je+fn),Qr=Se*Math.sin(Je+fn);var Wr=Math.abs(Je-at+2*fn)<=Nt?0:1;if(fn&&aa(Lr,Sr,$r,Qr)===1-Et^Wr){var Mn=(Je+at)/2;Lr=Se*Math.cos(Mn),Sr=Se*Math.sin(Mn),$r=Qr=null}}else Lr=Sr=0;if(bt>vt&&(kt=Math.min(Math.abs(Ve-Se)/2,+z.apply(this,arguments)))>.001){At=Se<Ve^Et?0:1;var Kn=kt,Yn=kt;if(bt<Nt){var ia=$r==null?[Lr,Sr]:nr==null?[It,Bt]:xn([It,Bt],[$r,Qr],[nr,gr],[Lr,Sr]),da=It-ia[0],La=Bt-ia[1],ta=nr-ia[0],_a=gr-ia[1],ya=1/Math.sin(Math.acos((da*ta+La*_a)/(Math.sqrt(da*da+La*La)*Math.sqrt(ta*ta+_a*_a)))/2),Ia=Math.sqrt(ia[0]*ia[0]+ia[1]*ia[1]);Yn=Math.min(kt,(Se-Ia)/(ya-1)),Kn=Math.min(kt,(Ve-Ia)/(ya+1))}if(nr!=null){var wa=Ka($r==null?[Lr,Sr]:[$r,Qr],[It,Bt],Ve,Kn,Et),Oa=Ka([nr,gr],[Lr,Sr],Ve,Kn,Et);kt===Kn?Vn.push("M",wa[0],"A",Kn,",",Kn," 0 0,",At," ",wa[1],"A",Ve,",",Ve," 0 ",1-Et^aa(wa[1][0],wa[1][1],Oa[1][0],Oa[1][1]),",",Et," ",Oa[1],"A",Kn,",",Kn," 0 0,",At," ",Oa[0]):Vn.push("M",wa[0],"A",Kn,",",Kn," 0 1,",At," ",Oa[0])}else Vn.push("M",It,",",Bt);if($r!=null){var Ha=Ka([It,Bt],[$r,Qr],Se,-Yn,Et),di=Ka([Lr,Sr],nr==null?[It,Bt]:[nr,gr],Se,-Yn,Et);kt===Yn?Vn.push("L",di[0],"A",Yn,",",Yn," 0 0,",At," ",di[1],"A",Se,",",Se," 0 ",Et^aa(di[1][0],di[1][1],Ha[1][0],Ha[1][1]),",",1-Et," ",Ha[1],"A",Yn,",",Yn," 0 0,",At," ",Ha[0]):Vn.push("L",di[0],"A",Yn,",",Yn," 0 0,",At," ",Ha[0])}else Vn.push("L",Lr,",",Sr)}else Vn.push("M",It,",",Bt),nr!=null&&Vn.push("A",Ve,",",Ve," 0 ",Jn,",",Et," ",nr,",",gr),Vn.push("L",Lr,",",Sr),$r!=null&&Vn.push("A",Se,",",Se," 0 ",Wr,",",1-Et," ",$r,",",Qr);return Vn.push("Z"),Vn.join("")}function we(Se,Ve){return"M0,"+Se+"A"+Se+","+Se+" 0 1,"+Ve+" 0,"+-Se+"A"+Se+","+Se+" 0 1,"+Ve+" 0,"+Se}return ge.innerRadius=function(Se){return arguments.length?(ce=vr(Se),ge):ce},ge.outerRadius=function(Se){return arguments.length?(C=vr(Se),ge):C},ge.cornerRadius=function(Se){return arguments.length?(z=vr(Se),ge):z},ge.padRadius=function(Se){return arguments.length?(F=Se==Ra?Ra:vr(Se),ge):F},ge.startAngle=function(Se){return arguments.length?(q=vr(Se),ge):q},ge.endAngle=function(Se){return arguments.length?(ie=vr(Se),ge):ie},ge.padAngle=function(Se){return arguments.length?(ue=vr(Se),ge):ue},ge.centroid=function(){var Se=(+ce.apply(this,arguments)+ +C.apply(this,arguments))/2,Ve=(+q.apply(this,arguments)+ +ie.apply(this,arguments))/2-Jt;return[Math.cos(Ve)*Se,Math.sin(Ve)*Se]},ge};var Ra="auto";function Ca(ce){return ce.innerRadius}function ga(ce){return ce.outerRadius}function Fa(ce){return ce.startAngle}function Ea(ce){return ce.endAngle}function ri(ce){return ce&&ce.padAngle}function aa(ce,C,z,F){return(ce-z)*C-(C-F)*ce>0?0:1}function Ka(ce,C,z,F,q){var ie=ce[0]-C[0],ue=ce[1]-C[1],ge=(q?F:-F)/Math.sqrt(ie*ie+ue*ue),we=ge*ue,Se=-ge*ie,Ve=ce[0]+we,Je=ce[1]+Se,at=C[0]+we,bt=C[1]+Se,Et=(Ve+at)/2,kt=(Je+bt)/2,At=at-Ve,xt=bt-Je,zt=At*At+xt*xt,It=z-F,Bt=Ve*bt-at*Je,nr=(xt<0?-1:1)*Math.sqrt(Math.max(0,It*It*zt-Bt*Bt)),gr=(Bt*xt-At*nr)/zt,Lr=(-Bt*At-xt*nr)/zt,Sr=(Bt*xt+At*nr)/zt,$r=(-Bt*At+xt*nr)/zt,Qr=gr-Et,fn=Lr-kt,sn=Sr-Et,Vn=$r-kt;return Qr*Qr+fn*fn>sn*sn+Vn*Vn&&(gr=Sr,Lr=$r),[[gr-we,Lr-Se],[gr*z/It,Lr*z/It]]}function Hi(){return!0}function Qo(ce){var C=Br,z=pn,F=Hi,q=To,ie=q.key,ue=.7;function ge(we){var Se,Ve=[],Je=[],at=-1,bt=we.length,Et=vr(C),kt=vr(z);function At(){Ve.push("M",q(ce(Je),ue))}for(;++at<bt;)F.call(this,Se=we[at],at)?Je.push([+Et.call(this,Se,at),+kt.call(this,Se,at)]):Je.length&&(At(),Je=[]);return Je.length&&At(),Ve.length?Ve.join(""):null}return ge.x=function(we){return arguments.length?(C=we,ge):C},ge.y=function(we){return arguments.length?(z=we,ge):z},ge.defined=function(we){return arguments.length?(F=we,ge):F},ge.interpolate=function(we){return arguments.length?(ie=typeof we=="function"?q=we:(q=jo.get(we)||To).key,ge):ie},ge.tension=function(we){return arguments.length?(ue=we,ge):ue},ge}p.svg.line=function(){return Qo(E)};var jo=p.map({linear:To,"linear-closed":xa,step:function(ce){for(var C=0,z=ce.length,F=ce[0],q=[F[0],",",F[1]];++C<z;)q.push("H",(F[0]+(F=ce[C])[0])/2,"V",F[1]);return z>1&&q.push("H",F[0]),q.join("")},"step-before":xi,"step-after":ko,basis:Xi,"basis-open":function(ce){if(ce.length<4)return To(ce);for(var C,z=[],F=-1,q=ce.length,ie=[0],ue=[0];++F<3;)C=ce[F],ie.push(C[0]),ue.push(C[1]);for(z.push(ai(oo,ie)+","+ai(oo,ue)),--F;++F<q;)C=ce[F],ie.shift(),ie.push(C[0]),ue.shift(),ue.push(C[1]),fs(z,ie,ue);return z.join("")},"basis-closed":function(ce){for(var C,z,F=-1,q=ce.length,ie=q+4,ue=[],ge=[];++F<4;)z=ce[F%q],ue.push(z[0]),ge.push(z[1]);for(C=[ai(oo,ue),",",ai(oo,ge)],--F;++F<ie;)z=ce[F%q],ue.shift(),ue.push(z[0]),ge.shift(),ge.push(z[1]),fs(C,ue,ge);return C.join("")},bundle:function(ce,C){var z=ce.length-1;if(z)for(var F,q,ie=ce[0][0],ue=ce[0][1],ge=ce[z][0]-ie,we=ce[z][1]-ue,Se=-1;++Se<=z;)F=ce[Se],q=Se/z,F[0]=C*F[0]+(1-C)*(ie+q*ge),F[1]=C*F[1]+(1-C)*(ue+q*we);return Xi(ce)},cardinal:function(ce,C){return ce.length<3?To(ce):ce[0]+Qa(ce,Si(ce,C))},"cardinal-open":function(ce,C){return ce.length<4?To(ce):ce[1]+Qa(ce.slice(1,-1),Si(ce,C))},"cardinal-closed":function(ce,C){return ce.length<3?xa(ce):ce[0]+Qa((ce.push(ce[0]),ce),Si([ce[ce.length-2]].concat(ce,[ce[1]]),C))},monotone:function(ce){return ce.length<3?To(ce):ce[0]+Qa(ce,function(C){for(var z,F,q,ie,ue=[],ge=function(Ve){for(var Je=0,at=Ve.length-1,bt=[],Et=Ve[0],kt=Ve[1],At=bt[0]=as(Et,kt);++Je<at;)bt[Je]=(At+(At=as(Et=kt,kt=Ve[Je+1])))/2;return bt[Je]=At,bt}(C),we=-1,Se=C.length-1;++we<Se;)z=as(C[we],C[we+1]),s(z)<vt?ge[we]=ge[we+1]=0:(F=ge[we]/z,q=ge[we+1]/z,(ie=F*F+q*q)>9&&(ie=3*z/Math.sqrt(ie),ge[we]=ie*F,ge[we+1]=ie*q));for(we=-1;++we<=Se;)ie=(C[Math.min(Se,we+1)][0]-C[Math.max(0,we-1)][0])/(6*(1+ge[we]*ge[we])),ue.push([ie||0,ge[we]*ie||0]);return ue}(ce))}});function To(ce){return ce.length>1?ce.join("L"):ce+"Z"}function xa(ce){return ce.join("L")+"Z"}function xi(ce){for(var C=0,z=ce.length,F=ce[0],q=[F[0],",",F[1]];++C<z;)q.push("V",(F=ce[C])[1],"H",F[0]);return q.join("")}function ko(ce){for(var C=0,z=ce.length,F=ce[0],q=[F[0],",",F[1]];++C<z;)q.push("H",(F=ce[C])[0],"V",F[1]);return q.join("")}function Qa(ce,C){if(C.length<1||ce.length!=C.length&&ce.length!=C.length+2)return To(ce);var z=ce.length!=C.length,F="",q=ce[0],ie=ce[1],ue=C[0],ge=ue,we=1;if(z&&(F+="Q"+(ie[0]-2*ue[0]/3)+","+(ie[1]-2*ue[1]/3)+","+ie[0]+","+ie[1],q=ce[1],we=2),C.length>1){ge=C[1],ie=ce[we],we++,F+="C"+(q[0]+ue[0])+","+(q[1]+ue[1])+","+(ie[0]-ge[0])+","+(ie[1]-ge[1])+","+ie[0]+","+ie[1];for(var Se=2;Se<C.length;Se++,we++)ie=ce[we],ge=C[Se],F+="S"+(ie[0]-ge[0])+","+(ie[1]-ge[1])+","+ie[0]+","+ie[1]}if(z){var Ve=ce[we];F+="Q"+(ie[0]+2*ge[0]/3)+","+(ie[1]+2*ge[1]/3)+","+Ve[0]+","+Ve[1]}return F}function Si(ce,C){for(var z,F=[],q=(1-C)/2,ie=ce[0],ue=ce[1],ge=1,we=ce.length;++ge<we;)z=ie,ie=ue,ue=ce[ge],F.push([q*(ue[0]-z[0]),q*(ue[1]-z[1])]);return F}function Xi(ce){if(ce.length<3)return To(ce);var C=1,z=ce.length,F=ce[0],q=F[0],ie=F[1],ue=[q,q,q,(F=ce[1])[0]],ge=[ie,ie,ie,F[1]],we=[q,",",ie,"L",ai(oo,ue),",",ai(oo,ge)];for(ce.push(ce[z-1]);++C<=z;)F=ce[C],ue.shift(),ue.push(F[0]),ge.shift(),ge.push(F[1]),fs(we,ue,ge);return ce.pop(),we.push("L",F),we.join("")}function ai(ce,C){return ce[0]*C[0]+ce[1]*C[1]+ce[2]*C[2]+ce[3]*C[3]}jo.forEach(function(ce,C){C.key=ce,C.closed=/-closed$/.test(ce)});var vo=[0,2/3,1/3,0],ii=[0,1/3,2/3,0],oo=[0,1/6,2/3,1/6];function fs(ce,C,z){ce.push("C",ai(vo,C),",",ai(vo,z),",",ai(ii,C),",",ai(ii,z),",",ai(oo,C),",",ai(oo,z))}function as(ce,C){return(C[1]-ce[1])/(C[0]-ce[0])}function qs(ce){for(var C,z,F,q=-1,ie=ce.length;++q<ie;)z=(C=ce[q])[0],F=C[1]-Jt,C[0]=z*Math.cos(F),C[1]=z*Math.sin(F);return ce}function Bi(ce){var C=Br,z=Br,F=0,q=pn,ie=Hi,ue=To,ge=ue.key,we=ue,Se="L",Ve=.7;function Je(at){var bt,Et,kt,At=[],xt=[],zt=[],It=-1,Bt=at.length,nr=vr(C),gr=vr(F),Lr=C===z?function(){return Et}:vr(z),Sr=F===q?function(){return kt}:vr(q);function $r(){At.push("M",ue(ce(zt),Ve),Se,we(ce(xt.reverse()),Ve),"Z")}for(;++It<Bt;)ie.call(this,bt=at[It],It)?(xt.push([Et=+nr.call(this,bt,It),kt=+gr.call(this,bt,It)]),zt.push([+Lr.call(this,bt,It),+Sr.call(this,bt,It)])):xt.length&&($r(),xt=[],zt=[]);return xt.length&&$r(),At.length?At.join(""):null}return Je.x=function(at){return arguments.length?(C=z=at,Je):z},Je.x0=function(at){return arguments.length?(C=at,Je):C},Je.x1=function(at){return arguments.length?(z=at,Je):z},Je.y=function(at){return arguments.length?(F=q=at,Je):q},Je.y0=function(at){return arguments.length?(F=at,Je):F},Je.y1=function(at){return arguments.length?(q=at,Je):q},Je.defined=function(at){return arguments.length?(ie=at,Je):ie},Je.interpolate=function(at){return arguments.length?(ge=typeof at=="function"?ue=at:(ue=jo.get(at)||To).key,we=ue.reverse||ue,Se=ue.closed?"M":"L",Je):ge},Je.tension=function(at){return arguments.length?(Ve=at,Je):Ve},Je}function Gs(ce){return ce.source}function Ni(ce){return ce.target}function is(ce){return ce.radius}function fa(ce){return[ce.x,ce.y]}function ba(ce){return function(){var C=ce.apply(this,arguments),z=C[0],F=C[1]-Jt;return[z*Math.cos(F),z*Math.sin(F)]}}function Ys(){return 64}function Ws(){return"circle"}function os(ce){var C=Math.sqrt(ce/Nt);return"M0,"+C+"A"+C+","+C+" 0 1,1 0,"+-C+"A"+C+","+C+" 0 1,1 0,"+C+"Z"}p.svg.line.radial=function(){var ce=Qo(qs);return ce.radius=ce.x,delete ce.x,ce.angle=ce.y,delete ce.y,ce},xi.reverse=ko,ko.reverse=xi,p.svg.area=function(){return Bi(E)},p.svg.area.radial=function(){var ce=Bi(qs);return ce.radius=ce.x,delete ce.x,ce.innerRadius=ce.x0,delete ce.x0,ce.outerRadius=ce.x1,delete ce.x1,ce.angle=ce.y,delete ce.y,ce.startAngle=ce.y0,delete ce.y0,ce.endAngle=ce.y1,delete ce.y1,ce},p.svg.chord=function(){var ce=Gs,C=Ni,z=is,F=Fa,q=Ea;function ie(Se,Ve){var Je,at,bt=ue(this,ce,Se,Ve),Et=ue(this,C,Se,Ve);return"M"+bt.p0+ge(bt.r,bt.p1,bt.a1-bt.a0)+(at=Et,((Je=bt).a0==at.a0&&Je.a1==at.a1?we(bt.r,bt.p1,bt.r,bt.p0):we(bt.r,bt.p1,Et.r,Et.p0)+ge(Et.r,Et.p1,Et.a1-Et.a0)+we(Et.r,Et.p1,bt.r,bt.p0))+"Z")}function ue(Se,Ve,Je,at){var bt=Ve.call(Se,Je,at),Et=z.call(Se,bt,at),kt=F.call(Se,bt,at)-Jt,At=q.call(Se,bt,at)-Jt;return{r:Et,a0:kt,a1:At,p0:[Et*Math.cos(kt),Et*Math.sin(kt)],p1:[Et*Math.cos(At),Et*Math.sin(At)]}}function ge(Se,Ve,Je){return"A"+Se+","+Se+" 0 "+ +(Je>Nt)+",1 "+Ve}function we(Se,Ve,Je,at){return"Q 0,0 "+at}return ie.radius=function(Se){return arguments.length?(z=vr(Se),ie):z},ie.source=function(Se){return arguments.length?(ce=vr(Se),ie):ce},ie.target=function(Se){return arguments.length?(C=vr(Se),ie):C},ie.startAngle=function(Se){return arguments.length?(F=vr(Se),ie):F},ie.endAngle=function(Se){return arguments.length?(q=vr(Se),ie):q},ie},p.svg.diagonal=function(){var ce=Gs,C=Ni,z=fa;function F(q,ie){var ue=ce.call(this,q,ie),ge=C.call(this,q,ie),we=(ue.y+ge.y)/2,Se=[ue,{x:ue.x,y:we},{x:ge.x,y:we},ge];return"M"+(Se=Se.map(z))[0]+"C"+Se[1]+" "+Se[2]+" "+Se[3]}return F.source=function(q){return arguments.length?(ce=vr(q),F):ce},F.target=function(q){return arguments.length?(C=vr(q),F):C},F.projection=function(q){return arguments.length?(z=q,F):z},F},p.svg.diagonal.radial=function(){var ce=p.svg.diagonal(),C=fa,z=ce.projection;return ce.projection=function(F){return arguments.length?z(ba(C=F)):C},ce},p.svg.symbol=function(){var ce=Ws,C=Ys;function z(F,q){return(Ro.get(ce.call(this,F,q))||os)(C.call(this,F,q))}return z.type=function(F){return arguments.length?(ce=vr(F),z):ce},z.size=function(F){return arguments.length?(C=vr(F),z):C},z};var Ro=p.map({circle:os,cross:function(ce){var C=Math.sqrt(ce/5)/2;return"M"+-3*C+","+-C+"H"+-C+"V"+-3*C+"H"+C+"V"+-C+"H"+3*C+"V"+C+"H"+C+"V"+3*C+"H"+-C+"V"+C+"H"+-3*C+"Z"},diamond:function(ce){var C=Math.sqrt(ce/(2*ll)),z=C*ll;return"M0,"+-C+"L"+z+",0 0,"+C+" "+-z+",0Z"},square:function(ce){var C=Math.sqrt(ce)/2;return"M"+-C+","+-C+"L"+C+","+-C+" "+C+","+C+" "+-C+","+C+"Z"},"triangle-down":function(ce){var C=Math.sqrt(ce/Zo),z=C*Zo/2;return"M0,"+z+"L"+C+","+-z+" "+-C+","+-z+"Z"},"triangle-up":function(ce){var C=Math.sqrt(ce/Zo),z=C*Zo/2;return"M0,"+-z+"L"+C+","+z+" "+-C+","+z+"Z"}});p.svg.symbolTypes=Ro.keys();var Zo=Math.sqrt(3),ll=Math.tan(30*ir);K.transition=function(ce){for(var C,z,F=bs||++_s,q=zs(ce),ie=[],ue=hs||{time:Date.now(),ease:ks,delay:0,duration:250},ge=-1,we=this.length;++ge<we;){ie.push(C=[]);for(var Se=this[ge],Ve=-1,Je=Se.length;++Ve<Je;)(z=Se[Ve])&&ps(z,Ve,q,F,ue),C.push(z)}return oi(ie,q,F)},K.interrupt=function(ce){return this.each(ce==null?Is:$a(zs(ce)))};var Is=$a(zs());function $a(ce){return function(){var C,z,F;(C=this[ce])&&(F=C[z=C.active])&&(F.timer.c=null,F.timer.t=NaN,--C.count?delete C[z]:delete this[ce],C.active+=.5,F.event&&F.event.interrupt.call(this,this.__data__,F.index))}}function oi(ce,C,z){return B(ce,zi),ce.namespace=C,ce.id=z,ce}var bs,hs,zi=[],_s=0;function Os(ce,C,z,F){var q=ce.id,ie=ce.namespace;return Re(ce,typeof z=="function"?function(ue,ge,we){ue[ie][q].tween.set(C,F(z.call(ue,ue.__data__,ge,we)))}:(z=F(z),function(ue){ue[ie][q].tween.set(C,z)}))}function Ms(ce){return ce==null&&(ce=""),function(){this.textContent=ce}}function zs(ce){return ce==null?"__transition__":"__transition_"+ce+"__"}function ps(ce,C,z,F,q){var ie,ue,ge,we,Se,Ve=ce[z]||(ce[z]={active:0,count:0}),Je=Ve[F];function at(Et){var kt=Ve.active,At=Ve[kt];for(var xt in At&&(At.timer.c=null,At.timer.t=NaN,--Ve.count,delete Ve[kt],At.event&&At.event.interrupt.call(ce,ce.__data__,At.index)),Ve)if(+xt<F){var zt=Ve[xt];zt.timer.c=null,zt.timer.t=NaN,--Ve.count,delete Ve[xt]}ue.c=bt,vn(function(){return ue.c&&bt(Et||1)&&(ue.c=null,ue.t=NaN),1},0,ie),Ve.active=F,Je.event&&Je.event.start.call(ce,ce.__data__,C),Se=[],Je.tween.forEach(function(It,Bt){(Bt=Bt.call(ce,ce.__data__,C))&&Se.push(Bt)}),we=Je.ease,ge=Je.duration}function bt(Et){for(var kt=Et/ge,At=we(kt),xt=Se.length;xt>0;)Se[--xt].call(ce,At);if(kt>=1)return Je.event&&Je.event.end.call(ce,ce.__data__,C),--Ve.count?delete Ve[F]:delete ce[z],1}Je||(ie=q.time,ue=vn(function(Et){var kt=Je.delay;if(ue.t=kt+ie,kt<=Et)return at(Et-kt);ue.c=at},0,ie),Je=Ve[F]={tween:new T,time:ie,timer:ue,delay:q.delay,duration:q.duration,ease:q.ease,index:C},q=null,++Ve.count)}zi.call=K.call,zi.empty=K.empty,zi.node=K.node,zi.size=K.size,p.transition=function(ce,C){return ce&&ce.transition?bs?ce.transition(C):ce:p.selection().transition(ce)},p.transition.prototype=zi,zi.select=function(ce){var C,z,F,q=this.id,ie=this.namespace,ue=[];ce=re(ce);for(var ge=-1,we=this.length;++ge<we;){ue.push(C=[]);for(var Se=this[ge],Ve=-1,Je=Se.length;++Ve<Je;)(F=Se[Ve])&&(z=ce.call(F,F.__data__,Ve,ge))?("__data__"in F&&(z.__data__=F.__data__),ps(z,Ve,ie,q,F[ie][q]),C.push(z)):C.push(null)}return oi(ue,ie,q)},zi.selectAll=function(ce){var C,z,F,q,ie,ue=this.id,ge=this.namespace,we=[];ce=ne(ce);for(var Se=-1,Ve=this.length;++Se<Ve;)for(var Je=this[Se],at=-1,bt=Je.length;++at<bt;)if(F=Je[at]){ie=F[ge][ue],z=ce.call(F,F.__data__,at,Se),we.push(C=[]);for(var Et=-1,kt=z.length;++Et<kt;)(q=z[Et])&&ps(q,Et,ge,ue,ie),C.push(q)}return oi(we,ge,ue)},zi.filter=function(ce){var C,z,F=[];typeof ce!="function"&&(ce=Le(ce));for(var q=0,ie=this.length;q<ie;q++){F.push(C=[]);for(var ue,ge=0,we=(ue=this[q]).length;ge<we;ge++)(z=ue[ge])&&ce.call(z,z.__data__,ge,q)&&C.push(z)}return oi(F,this.namespace,this.id)},zi.tween=function(ce,C){var z=this.id,F=this.namespace;return arguments.length<2?this.node()[F][z].tween.get(ce):Re(this,C==null?function(q){q[F][z].tween.remove(ce)}:function(q){q[F][z].tween.set(ce,C)})},zi.attr=function(ce,C){if(arguments.length<2){for(C in ce)this.attr(C,ce[C]);return this}var z=ce=="transform"?Xo:Ui,F=p.ns.qualify(ce);function q(){this.removeAttribute(F)}function ie(){this.removeAttributeNS(F.space,F.local)}function ue(we){return we==null?q:(we+="",function(){var Se,Ve=this.getAttribute(F);return Ve!==we&&(Se=z(Ve,we),function(Je){this.setAttribute(F,Se(Je))})})}function ge(we){return we==null?ie:(we+="",function(){var Se,Ve=this.getAttributeNS(F.space,F.local);return Ve!==we&&(Se=z(Ve,we),function(Je){this.setAttributeNS(F.space,F.local,Se(Je))})})}return Os(this,"attr."+ce,C,F.local?ge:ue)},zi.attrTween=function(ce,C){var z=p.ns.qualify(ce);return this.tween("attr."+ce,z.local?function(F,q){var ie=C.call(this,F,q,this.getAttributeNS(z.space,z.local));return ie&&function(ue){this.setAttributeNS(z.space,z.local,ie(ue))}}:function(F,q){var ie=C.call(this,F,q,this.getAttribute(z));return ie&&function(ue){this.setAttribute(z,ie(ue))}})},zi.style=function(ce,C,z){var F=arguments.length;if(F<3){if(typeof ce!="string"){for(z in F<2&&(C=""),ce)this.style(z,ce[z],C);return this}z=""}function q(){this.style.removeProperty(ce)}function ie(ue){return ue==null?q:(ue+="",function(){var ge,we=n(this).getComputedStyle(this,null).getPropertyValue(ce);return we!==ue&&(ge=Ui(we,ue),function(Se){this.style.setProperty(ce,ge(Se),z)})})}return Os(this,"style."+ce,C,ie)},zi.styleTween=function(ce,C,z){function F(q,ie){var ue=C.call(this,q,ie,n(this).getComputedStyle(this,null).getPropertyValue(ce));return ue&&function(ge){this.style.setProperty(ce,ue(ge),z)}}return arguments.length<3&&(z=""),this.tween("style."+ce,F)},zi.text=function(ce){return Os(this,"text",ce,Ms)},zi.remove=function(){var ce=this.namespace;return this.each("end.transition",function(){var C;this[ce].count<2&&(C=this.parentNode)&&C.removeChild(this)})},zi.ease=function(ce){var C=this.id,z=this.namespace;return arguments.length<1?this.node()[z][C].ease:(typeof ce!="function"&&(ce=p.ease.apply(p,arguments)),Re(this,function(F){F[z][C].ease=ce}))},zi.delay=function(ce){var C=this.id,z=this.namespace;return arguments.length<1?this.node()[z][C].delay:Re(this,typeof ce=="function"?function(F,q,ie){F[z][C].delay=+ce.call(F,F.__data__,q,ie)}:(ce=+ce,function(F){F[z][C].delay=ce}))},zi.duration=function(ce){var C=this.id,z=this.namespace;return arguments.length<1?this.node()[z][C].duration:Re(this,typeof ce=="function"?function(F,q,ie){F[z][C].duration=Math.max(1,ce.call(F,F.__data__,q,ie))}:(ce=Math.max(1,ce),function(F){F[z][C].duration=ce}))},zi.each=function(ce,C){var z=this.id,F=this.namespace;if(arguments.length<2){var q=hs,ie=bs;try{bs=z,Re(this,function(ue,ge,we){hs=ue[F][z],ce.call(ue,ue.__data__,ge,we)})}finally{hs=q,bs=ie}}else Re(this,function(ue){var ge=ue[F][z];(ge.event||(ge.event=p.dispatch("start","end","interrupt"))).on(ce,C)});return this},zi.transition=function(){for(var ce,C,z,F=this.id,q=++_s,ie=this.namespace,ue=[],ge=0,we=this.length;ge<we;ge++){ue.push(ce=[]);for(var Se,Ve=0,Je=(Se=this[ge]).length;Ve<Je;Ve++)(C=Se[Ve])&&ps(C,Ve,ie,q,{time:(z=C[ie][F]).time,ease:z.ease,delay:z.delay+z.duration,duration:z.duration}),ce.push(C)}return oi(ue,ie,q)},p.svg.axis=function(){var ce,C=p.scale.linear(),z=cl,F=6,q=6,ie=3,ue=[10],ge=null;function we(Se){Se.each(function(){var Ve,Je=p.select(this),at=this.__chart__||C,bt=this.__chart__=C.copy(),Et=ge==null?bt.ticks?bt.ticks.apply(bt,ue):bt.domain():ge,kt=ce==null?bt.tickFormat?bt.tickFormat.apply(bt,ue):E:ce,At=Je.selectAll(".tick").data(Et,bt),xt=At.enter().insert("g",".domain").attr("class","tick").style("opacity",vt),zt=p.transition(At.exit()).style("opacity",vt).remove(),It=p.transition(At.order()).style("opacity",1),Bt=Math.max(F,0)+ie,nr=ln(bt),gr=Je.selectAll(".domain").data([0]),Lr=(gr.enter().append("path").attr("class","domain"),p.transition(gr));xt.append("line"),xt.append("text");var Sr,$r,Qr,fn,sn=xt.select("line"),Vn=It.select("line"),Jn=At.select("text").text(kt),ha=xt.select("text"),Wr=It.select("text"),Mn=z==="top"||z==="left"?-1:1;if(z==="bottom"||z==="top"?(Ve=ws,Sr="x",Qr="y",$r="x2",fn="y2",Jn.attr("dy",Mn<0?"0em":".71em").style("text-anchor","middle"),Lr.attr("d","M"+nr[0]+","+Mn*q+"V0H"+nr[1]+"V"+Mn*q)):(Ve=ul,Sr="y",Qr="x",$r="y2",fn="x2",Jn.attr("dy",".32em").style("text-anchor",Mn<0?"end":"start"),Lr.attr("d","M"+Mn*q+","+nr[0]+"H0V"+nr[1]+"H"+Mn*q)),sn.attr(fn,Mn*F),ha.attr(Qr,Mn*Bt),Vn.attr($r,0).attr(fn,Mn*F),Wr.attr(Sr,0).attr(Qr,Mn*Bt),bt.rangeBand){var Kn=bt,Yn=Kn.rangeBand()/2;at=bt=function(ia){return Kn(ia)+Yn}}else at.rangeBand?at=bt:zt.call(Ve,bt,at);xt.call(Ve,at,bt),It.call(Ve,bt,bt)})}return we.scale=function(Se){return arguments.length?(C=Se,we):C},we.orient=function(Se){return arguments.length?(z=Se in Tl?Se+"":cl,we):z},we.ticks=function(){return arguments.length?(ue=b(arguments),we):ue},we.tickValues=function(Se){return arguments.length?(ge=Se,we):ge},we.tickFormat=function(Se){return arguments.length?(ce=Se,we):ce},we.tickSize=function(Se){var Ve=arguments.length;return Ve?(F=+Se,q=+arguments[Ve-1],we):F},we.innerTickSize=function(Se){return arguments.length?(F=+Se,we):F},we.outerTickSize=function(Se){return arguments.length?(q=+Se,we):q},we.tickPadding=function(Se){return arguments.length?(ie=+Se,we):ie},we.tickSubdivide=function(){return arguments.length&&we},we};var cl="bottom",Tl={top:1,right:1,bottom:1,left:1};function ws(ce,C,z){ce.attr("transform",function(F){var q=C(F);return"translate("+(isFinite(q)?q:z(F))+",0)"})}function ul(ce,C,z){ce.attr("transform",function(F){var q=C(F);return"translate(0,"+(isFinite(q)?q:z(F))+")"})}p.svg.brush=function(){var ce,C,z=te(Ve,"brushstart","brush","brushend"),F=null,q=null,ie=[0,0],ue=[0,0],ge=!0,we=!0,Se=so[0];function Ve(kt){kt.each(function(){var At=p.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",Et).on("touchstart.brush",Et),xt=At.selectAll(".background").data([0]);xt.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),At.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var zt=At.selectAll(".resize").data(Se,E);zt.exit().remove(),zt.enter().append("g").attr("class",function(gr){return"resize "+gr}).style("cursor",function(gr){return Ds[gr]}).append("rect").attr("x",function(gr){return/[ew]$/.test(gr)?-3:null}).attr("y",function(gr){return/^[ns]/.test(gr)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),zt.style("display",Ve.empty()?"none":null);var It,Bt=p.transition(At),nr=p.transition(xt);F&&(It=ln(F),nr.attr("x",It[0]).attr("width",It[1]-It[0]),at(Bt)),q&&(It=ln(q),nr.attr("y",It[0]).attr("height",It[1]-It[0]),bt(Bt)),Je(Bt)})}function Je(kt){kt.selectAll(".resize").attr("transform",function(At){return"translate("+ie[+/e$/.test(At)]+","+ue[+/^s/.test(At)]+")"})}function at(kt){kt.select(".extent").attr("x",ie[0]),kt.selectAll(".extent,.n>rect,.s>rect").attr("width",ie[1]-ie[0])}function bt(kt){kt.select(".extent").attr("y",ue[0]),kt.selectAll(".extent,.e>rect,.w>rect").attr("height",ue[1]-ue[0])}function Et(){var kt,At,xt=this,zt=p.select(p.event.target),It=z.of(xt,arguments),Bt=p.select(xt),nr=zt.datum(),gr=!/^(n|s)$/.test(nr)&&F,Lr=!/^(e|w)$/.test(nr)&&q,Sr=zt.classed("extent"),$r=_t(xt),Qr=p.mouse(xt),fn=p.select(n(xt)).on("keydown.brush",Jn).on("keyup.brush",ha);if(p.event.changedTouches?fn.on("touchmove.brush",Wr).on("touchend.brush",Kn):fn.on("mousemove.brush",Wr).on("mouseup.brush",Kn),Bt.interrupt().selectAll("*").interrupt(),Sr)Qr[0]=ie[0]-Qr[0],Qr[1]=ue[0]-Qr[1];else if(nr){var sn=+/w$/.test(nr),Vn=+/^n/.test(nr);At=[ie[1-sn]-Qr[0],ue[1-Vn]-Qr[1]],Qr[0]=ie[sn],Qr[1]=ue[Vn]}else p.event.altKey&&(kt=Qr.slice());function Jn(){p.event.keyCode==32&&(Sr||(kt=null,Qr[0]-=ie[1],Qr[1]-=ue[1],Sr=2),G())}function ha(){p.event.keyCode==32&&Sr==2&&(Qr[0]+=ie[1],Qr[1]+=ue[1],Sr=0,G())}function Wr(){var Yn=p.mouse(xt),ia=!1;At&&(Yn[0]+=At[0],Yn[1]+=At[1]),Sr||(p.event.altKey?(kt||(kt=[(ie[0]+ie[1])/2,(ue[0]+ue[1])/2]),Qr[0]=ie[+(Yn[0]<kt[0])],Qr[1]=ue[+(Yn[1]<kt[1])]):kt=null),gr&&Mn(Yn,F,0)&&(at(Bt),ia=!0),Lr&&Mn(Yn,q,1)&&(bt(Bt),ia=!0),ia&&(Je(Bt),It({type:"brush",mode:Sr?"move":"resize"}))}function Mn(Yn,ia,da){var La,ta,_a=ln(ia),ya=_a[0],Ia=_a[1],wa=Qr[da],Oa=da?ue:ie,Ha=Oa[1]-Oa[0];if(Sr&&(ya-=wa,Ia-=Ha+wa),La=(da?we:ge)?Math.max(ya,Math.min(Ia,Yn[da])):Yn[da],Sr?ta=(La+=wa)+Ha:(kt&&(wa=Math.max(ya,Math.min(Ia,2*kt[da]-La))),wa<La?(ta=La,La=wa):ta=wa),Oa[0]!=La||Oa[1]!=ta)return da?C=null:ce=null,Oa[0]=La,Oa[1]=ta,!0}function Kn(){Wr(),Bt.style("pointer-events","all").selectAll(".resize").style("display",Ve.empty()?"none":null),p.select("body").style("cursor",null),fn.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),$r(),It({type:"brushend"})}Bt.style("pointer-events","none").selectAll(".resize").style("display",null),p.select("body").style("cursor",zt.style("cursor")),It({type:"brushstart"}),Wr()}return Ve.event=function(kt){kt.each(function(){var At=z.of(this,arguments),xt={x:ie,y:ue,i:ce,j:C},zt=this.__chart__||xt;this.__chart__=xt,bs?p.select(this).transition().each("start.brush",function(){ce=zt.i,C=zt.j,ie=zt.x,ue=zt.y,At({type:"brushstart"})}).tween("brush:brush",function(){var It=yi(ie,xt.x),Bt=yi(ue,xt.y);return ce=C=null,function(nr){ie=xt.x=It(nr),ue=xt.y=Bt(nr),At({type:"brush",mode:"resize"})}}).each("end.brush",function(){ce=xt.i,C=xt.j,At({type:"brush",mode:"resize"}),At({type:"brushend"})}):(At({type:"brushstart"}),At({type:"brush",mode:"resize"}),At({type:"brushend"}))})},Ve.x=function(kt){return arguments.length?(Se=so[!(F=kt)<<1|!q],Ve):F},Ve.y=function(kt){return arguments.length?(Se=so[!F<<1|!(q=kt)],Ve):q},Ve.clamp=function(kt){return arguments.length?(F&&q?(ge=!!kt[0],we=!!kt[1]):F?ge=!!kt:q&&(we=!!kt),Ve):F&&q?[ge,we]:F?ge:q?we:null},Ve.extent=function(kt){var At,xt,zt,It,Bt;return arguments.length?(F&&(At=kt[0],xt=kt[1],q&&(At=At[0],xt=xt[0]),ce=[At,xt],F.invert&&(At=F(At),xt=F(xt)),xt<At&&(Bt=At,At=xt,xt=Bt),At==ie[0]&&xt==ie[1]||(ie=[At,xt])),q&&(zt=kt[0],It=kt[1],F&&(zt=zt[1],It=It[1]),C=[zt,It],q.invert&&(zt=q(zt),It=q(It)),It<zt&&(Bt=zt,zt=It,It=Bt),zt==ue[0]&&It==ue[1]||(ue=[zt,It])),Ve):(F&&(ce?(At=ce[0],xt=ce[1]):(At=ie[0],xt=ie[1],F.invert&&(At=F.invert(At),xt=F.invert(xt)),xt<At&&(Bt=At,At=xt,xt=Bt))),q&&(C?(zt=C[0],It=C[1]):(zt=ue[0],It=ue[1],q.invert&&(zt=q.invert(zt),It=q.invert(It)),It<zt&&(Bt=zt,zt=It,It=Bt))),F&&q?[[At,zt],[xt,It]]:F?[At,xt]:q&&[zt,It])},Ve.clear=function(){return Ve.empty()||(ie=[0,0],ue=[0,0],ce=C=null),Ve},Ve.empty=function(){return!!F&&ie[0]==ie[1]||!!q&&ue[0]==ue[1]},p.rebind(Ve,z,"on")};var Ds={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},so=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function kl(ce){return JSON.parse(ce.responseText)}function Ml(ce){var C=y.createRange();return C.selectNode(y.body),C.createContextualFragment(ce.responseText)}p.text=Mr(function(ce){return ce.responseText}),p.json=function(ce,C){return Nr(ce,"application/json",kl,C)},p.html=function(ce,C){return Nr(ce,"text/html",Ml,C)},p.xml=Mr(function(ce){return ce.responseXML}),typeof J=="object"&&J.exports?J.exports=p:this.d3=p}).apply(self)},{}],59:[function(v,J,Z){J.exports=v("./quad")},{"./quad":60}],60:[function(v,J,Z){var p=v("binary-search-bounds"),g=v("clamp"),b=v("parse-rect"),y=v("array-bounds"),e=v("pick-by-alias"),n=v("defined"),t=v("flatten-vertex-data"),a=v("is-obj"),r=v("dtype"),m=v("math-log2");function o(i,u){for(var f=u[0],l=u[1],h=1/(u[2]-f),d=1/(u[3]-l),s=new Array(i.length),x=0,c=i.length/2;x<c;x++)s[2*x]=g((i[2*x]-f)*h,0,1),s[2*x+1]=g((i[2*x+1]-l)*d,0,1);return s}J.exports=function(i,u){u||(u={}),i=t(i,"float64"),u=e(u,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var f=n(u.maxDepth,255),l=n(u.bounds,y(i,2));l[0]===l[2]&&l[2]++,l[1]===l[3]&&l[3]++;var h,d=o(i,l),s=i.length>>>1;u.dtype||(u.dtype="array"),typeof u.dtype=="string"?h=new(r(u.dtype))(s):u.dtype&&(h=u.dtype,Array.isArray(h)&&(h.length=s));for(var x=0;x<s;++x)h[x]=x;var c=[],T=[],_=[],w=[];(function R(H,V,X,$,G,W){if(!$.length)return null;var te=c[G]||(c[G]=[]),N=_[G]||(_[G]=[]),B=T[G]||(T[G]=[]),U=te.length;if(++G>f||W>1073741824){for(var ee=0;ee<$.length;ee++)te.push($[ee]),N.push(W),B.push(null,null,null,null);return U}if(te.push($[0]),N.push(W),$.length<=1)return B.push(null,null,null,null),U;for(var j=.5*X,Q=H+j,K=V+j,re=[],ne=[],le=[],oe=[],de=1,se=$.length;de<se;de++){var me=$[de],Te=d[2*me],_e=d[2*me+1];Te<Q?_e<K?re.push(me):ne.push(me):_e<K?le.push(me):oe.push(me)}return W<<=2,B.push(R(H,V,j,re,G,W),R(H,K,j,ne,G,W+1),R(Q,V,j,le,G,W+2),R(Q,K,j,oe,G,W+3)),U})(0,0,1,h,0,1);for(var k=0,L=0;L<c.length;L++){var A=c[L];if(h.set)h.set(A,k);else for(var I=0,P=A.length;I<P;I++)h[I+k]=A[I];var S=k+c[L].length;w[L]=[k,S],k=S}return h.range=function(){for(var R,H=[],V=arguments.length;V--;)H[V]=arguments[V];if(a(H[H.length-1])){var X=H.pop();H.length||X.x==null&&X.l==null&&X.left==null||(H=[X],R={}),R=e(X,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else R={};H.length||(H=l);var $=b.apply(void 0,H),G=[Math.min($.x,$.x+$.width),Math.min($.y,$.y+$.height),Math.max($.x,$.x+$.width),Math.max($.y,$.y+$.height)],W=G[0],te=G[1],N=G[2],B=G[3],U=o([W,te,N,B],l),ee=U[0],j=U[1],Q=U[2],K=U[3],re=n(R.level,c.length);if(R.d!=null){var ne;typeof R.d=="number"?ne=[R.d,R.d]:R.d.length&&(ne=R.d),re=Math.min(Math.max(Math.ceil(-m(Math.abs(ne[0])/(l[2]-l[0]))),Math.ceil(-m(Math.abs(ne[1])/(l[3]-l[1])))),re)}if(re=Math.min(re,c.length),R.lod)return E(ee,j,Q,K,re);var le=[];function oe(se,me,Te,_e,be,Ce){if(be!==null&&Ce!==null&&!(ee>se+Te||j>me+Te||Q<se||K<me||_e>=re||be===Ce)){var fe=c[_e];Ce===void 0&&(Ce=fe.length);for(var ve=be;ve<Ce;ve++){var Me=fe[ve],ke=i[2*Me],Le=i[2*Me+1];ke>=W&&ke<=N&&Le>=te&&Le<=B&&le.push(Me)}var ze=T[_e],Re=ze[4*be+0],Oe=ze[4*be+1],Ze=ze[4*be+2],Pe=ze[4*be+3],Ie=de(ze,be+1),Be=.5*Te,Fe=_e+1;oe(se,me,Be,Fe,Re,Oe||Ze||Pe||Ie),oe(se,me+Be,Be,Fe,Oe,Ze||Pe||Ie),oe(se+Be,me,Be,Fe,Ze,Pe||Ie),oe(se+Be,me+Be,Be,Fe,Pe,Ie)}}function de(se,me){for(var Te=null,_e=0;Te===null;)if(Te=se[4*me+_e],++_e>se.length)return null;return Te}return oe(0,0,1,0,0,1),le},h;function E(R,H,V,X,$){for(var G=[],W=0;W<$;W++){var te=_[W],N=w[W][0],B=D(R,H,W),U=D(V,X,W),ee=p.ge(te,B),j=p.gt(te,U,ee,te.length-1);G[W]=[ee+N,j+N]}return G}function D(R,H,V){for(var X=1,$=.5,G=.5,W=.5,te=0;te<V;te++)X<<=2,X+=R<$?H<G?0:1:H<G?2:3,W*=.5,$+=R<$?-W:W,G+=H<G?-W:W;return X}}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(v,J,Z){Object.defineProperty(Z,"__esModule",{value:!0});var p=v("@turf/meta");function g(e){var n=0;if(e&&e.length>0){n+=Math.abs(b(e[0]));for(var t=1;t<e.length;t++)n-=Math.abs(b(e[t]))}return n}function b(e){var n,t,a,r,m,o,i=0,u=e.length;if(u>2){for(o=0;o<u;o++)o===u-2?(a=u-2,r=u-1,m=0):o===u-1?(a=u-1,r=0,m=1):(a=o,r=o+1,m=o+2),n=e[a],t=e[r],i+=(y(e[m][0])-y(n[0]))*Math.sin(y(t[1]));i=6378137*i*6378137/2}return i}function y(e){return e*Math.PI/180}Z.default=function(e){return p.geomReduce(e,function(n,t){return n+function(a){var r,m=0;switch(a.type){case"Polygon":return g(a.coordinates);case"MultiPolygon":for(r=0;r<a.coordinates.length;r++)m+=g(a.coordinates[r]);return m;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)},0)}},{"@turf/meta":63}],62:[function(v,J,Z){function p(u,f,l){l===void 0&&(l={});var h={type:"Feature"};return(l.id===0||l.id)&&(h.id=l.id),l.bbox&&(h.bbox=l.bbox),h.properties=f||{},h.geometry=u,h}function g(u,f,l){if(l===void 0&&(l={}),!u)throw new Error("coordinates is required");if(!Array.isArray(u))throw new Error("coordinates must be an Array");if(u.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!i(u[0])||!i(u[1]))throw new Error("coordinates must contain numbers");return p({type:"Point",coordinates:u},f,l)}function b(u,f,l){l===void 0&&(l={});for(var h=0,d=u;h<d.length;h++){var s=d[h];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var x=0;x<s[s.length-1].length;x++)if(s[s.length-1][x]!==s[0][x])throw new Error("First and last Position are not equivalent.")}return p({type:"Polygon",coordinates:u},f,l)}function y(u,f,l){if(l===void 0&&(l={}),u.length<2)throw new Error("coordinates must be an array of two or more positions");return p({type:"LineString",coordinates:u},f,l)}function e(u,f){f===void 0&&(f={});var l={type:"FeatureCollection"};return f.id&&(l.id=f.id),f.bbox&&(l.bbox=f.bbox),l.features=u,l}function n(u,f,l){return l===void 0&&(l={}),p({type:"MultiLineString",coordinates:u},f,l)}function t(u,f,l){return l===void 0&&(l={}),p({type:"MultiPoint",coordinates:u},f,l)}function a(u,f,l){return l===void 0&&(l={}),p({type:"MultiPolygon",coordinates:u},f,l)}function r(u,f){f===void 0&&(f="kilometers");var l=Z.factors[f];if(!l)throw new Error(f+" units is invalid");return u*l}function m(u,f){f===void 0&&(f="kilometers");var l=Z.factors[f];if(!l)throw new Error(f+" units is invalid");return u/l}function o(u){return 180*(u%(2*Math.PI))/Math.PI}function i(u){return!isNaN(u)&&u!==null&&!Array.isArray(u)}Object.defineProperty(Z,"__esModule",{value:!0}),Z.earthRadius=63710088e-1,Z.factors={centimeters:100*Z.earthRadius,centimetres:100*Z.earthRadius,degrees:Z.earthRadius/111325,feet:3.28084*Z.earthRadius,inches:39.37*Z.earthRadius,kilometers:Z.earthRadius/1e3,kilometres:Z.earthRadius/1e3,meters:Z.earthRadius,metres:Z.earthRadius,miles:Z.earthRadius/1609.344,millimeters:1e3*Z.earthRadius,millimetres:1e3*Z.earthRadius,nauticalmiles:Z.earthRadius/1852,radians:1,yards:1.0936*Z.earthRadius},Z.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Z.earthRadius,yards:1.0936133},Z.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},Z.feature=p,Z.geometry=function(u,f,l){switch(u){case"Point":return g(f).geometry;case"LineString":return y(f).geometry;case"Polygon":return b(f).geometry;case"MultiPoint":return t(f).geometry;case"MultiLineString":return n(f).geometry;case"MultiPolygon":return a(f).geometry;default:throw new Error(u+" is invalid")}},Z.point=g,Z.points=function(u,f,l){return l===void 0&&(l={}),e(u.map(function(h){return g(h,f)}),l)},Z.polygon=b,Z.polygons=function(u,f,l){return l===void 0&&(l={}),e(u.map(function(h){return b(h,f)}),l)},Z.lineString=y,Z.lineStrings=function(u,f,l){return l===void 0&&(l={}),e(u.map(function(h){return y(h,f)}),l)},Z.featureCollection=e,Z.multiLineString=n,Z.multiPoint=t,Z.multiPolygon=a,Z.geometryCollection=function(u,f,l){return l===void 0&&(l={}),p({type:"GeometryCollection",geometries:u},f,l)},Z.round=function(u,f){if(f===void 0&&(f=0),f&&!(f>=0))throw new Error("precision must be a positive number");var l=Math.pow(10,f||0);return Math.round(u*l)/l},Z.radiansToLength=r,Z.lengthToRadians=m,Z.lengthToDegrees=function(u,f){return o(m(u,f))},Z.bearingToAzimuth=function(u){var f=u%360;return f<0&&(f+=360),f},Z.radiansToDegrees=o,Z.degreesToRadians=function(u){return u%360*Math.PI/180},Z.convertLength=function(u,f,l){if(f===void 0&&(f="kilometers"),l===void 0&&(l="kilometers"),!(u>=0))throw new Error("length must be a positive number");return r(m(u,f),l)},Z.convertArea=function(u,f,l){if(f===void 0&&(f="meters"),l===void 0&&(l="kilometers"),!(u>=0))throw new Error("area must be a positive number");var h=Z.areaFactors[f];if(!h)throw new Error("invalid original units");var d=Z.areaFactors[l];if(!d)throw new Error("invalid final units");return u/h*d},Z.isNumber=i,Z.isObject=function(u){return!!u&&u.constructor===Object},Z.validateBBox=function(u){if(!u)throw new Error("bbox is required");if(!Array.isArray(u))throw new Error("bbox must be an Array");if(u.length!==4&&u.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");u.forEach(function(f){if(!i(f))throw new Error("bbox must only contain numbers")})},Z.validateId=function(u){if(!u)throw new Error("id is required");if(["string","number"].indexOf(typeof u)===-1)throw new Error("id must be a number or a string")}},{}],63:[function(v,J,Z){Object.defineProperty(Z,"__esModule",{value:!0});var p=v("@turf/helpers");function g(r,m,o){if(r!==null)for(var i,u,f,l,h,d,s,x,c=0,T=0,_=r.type,w=_==="FeatureCollection",k=_==="Feature",L=w?r.features.length:1,A=0;A<L;A++){h=(x=!!(s=w?r.features[A].geometry:k?r.geometry:r)&&s.type==="GeometryCollection")?s.geometries.length:1;for(var I=0;I<h;I++){var P=0,S=0;if((l=x?s.geometries[I]:s)!==null){d=l.coordinates;var E=l.type;switch(c=!o||E!=="Polygon"&&E!=="MultiPolygon"?0:1,E){case null:break;case"Point":if(m(d,T,A,P,S)===!1)return!1;T++,P++;break;case"LineString":case"MultiPoint":for(i=0;i<d.length;i++){if(m(d[i],T,A,P,S)===!1)return!1;T++,E==="MultiPoint"&&P++}E==="LineString"&&P++;break;case"Polygon":case"MultiLineString":for(i=0;i<d.length;i++){for(u=0;u<d[i].length-c;u++){if(m(d[i][u],T,A,P,S)===!1)return!1;T++}E==="MultiLineString"&&P++,E==="Polygon"&&S++}E==="Polygon"&&P++;break;case"MultiPolygon":for(i=0;i<d.length;i++){for(S=0,u=0;u<d[i].length;u++){for(f=0;f<d[i][u].length-c;f++){if(m(d[i][u][f],T,A,P,S)===!1)return!1;T++}S++}P++}break;case"GeometryCollection":for(i=0;i<l.geometries.length;i++)if(g(l.geometries[i],m,o)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function b(r,m){var o;switch(r.type){case"FeatureCollection":for(o=0;o<r.features.length&&m(r.features[o].properties,o)!==!1;o++);break;case"Feature":m(r.properties,0)}}function y(r,m){if(r.type==="Feature")m(r,0);else if(r.type==="FeatureCollection")for(var o=0;o<r.features.length&&m(r.features[o],o)!==!1;o++);}function e(r,m){var o,i,u,f,l,h,d,s,x,c,T=0,_=r.type==="FeatureCollection",w=r.type==="Feature",k=_?r.features.length:1;for(o=0;o<k;o++){for(h=_?r.features[o].geometry:w?r.geometry:r,s=_?r.features[o].properties:w?r.properties:{},x=_?r.features[o].bbox:w?r.bbox:void 0,c=_?r.features[o].id:w?r.id:void 0,l=(d=!!h&&h.type==="GeometryCollection")?h.geometries.length:1,u=0;u<l;u++)if((f=d?h.geometries[u]:h)!==null)switch(f.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(m(f,T,s,x,c)===!1)return!1;break;case"GeometryCollection":for(i=0;i<f.geometries.length;i++)if(m(f.geometries[i],T,s,x,c)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(m(null,T,s,x,c)===!1)return!1;T++}}function n(r,m){e(r,function(o,i,u,f,l){var h,d=o===null?null:o.type;switch(d){case null:case"Point":case"LineString":case"Polygon":return m(p.feature(o,u,{bbox:f,id:l}),i,0)!==!1&&void 0}switch(d){case"MultiPoint":h="Point";break;case"MultiLineString":h="LineString";break;case"MultiPolygon":h="Polygon"}for(var s=0;s<o.coordinates.length;s++){var x={type:h,coordinates:o.coordinates[s]};if(m(p.feature(x,u),i,s)===!1)return!1}})}function t(r,m){n(r,function(o,i,u){var f=0;if(o.geometry){var l=o.geometry.type;if(l!=="Point"&&l!=="MultiPoint"){var h,d=0,s=0,x=0;return g(o,function(c,T,_,w,k){if(h===void 0||i>d||w>s||k>x)return h=c,d=i,s=w,x=k,void(f=0);var L=p.lineString([h,c],o.properties);if(m(L,i,u,k,f)===!1)return!1;f++,h=c})!==!1&&void 0}}})}function a(r,m){if(!r)throw new Error("geojson is required");n(r,function(o,i,u){if(o.geometry!==null){var f=o.geometry.type,l=o.geometry.coordinates;switch(f){case"LineString":if(m(o,i,u,0,0)===!1)return!1;break;case"Polygon":for(var h=0;h<l.length;h++)if(m(p.lineString(l[h],o.properties),i,u,h)===!1)return!1}}})}Z.coordEach=g,Z.coordReduce=function(r,m,o,i){var u=o;return g(r,function(f,l,h,d,s){u=l===0&&o===void 0?f:m(u,f,l,h,d,s)},i),u},Z.propEach=b,Z.propReduce=function(r,m,o){var i=o;return b(r,function(u,f){i=f===0&&o===void 0?u:m(i,u,f)}),i},Z.featureEach=y,Z.featureReduce=function(r,m,o){var i=o;return y(r,function(u,f){i=f===0&&o===void 0?u:m(i,u,f)}),i},Z.coordAll=function(r){var m=[];return g(r,function(o){m.push(o)}),m},Z.geomEach=e,Z.geomReduce=function(r,m,o){var i=o;return e(r,function(u,f,l,h,d){i=f===0&&o===void 0?u:m(i,u,f,l,h,d)}),i},Z.flattenEach=n,Z.flattenReduce=function(r,m,o){var i=o;return n(r,function(u,f,l){i=f===0&&l===0&&o===void 0?u:m(i,u,f,l)}),i},Z.segmentEach=t,Z.segmentReduce=function(r,m,o){var i=o,u=!1;return t(r,function(f,l,h,d,s){i=u===!1&&o===void 0?f:m(i,f,l,h,d,s),u=!0}),i},Z.lineEach=a,Z.lineReduce=function(r,m,o){var i=o;return a(r,function(u,f,l,h){i=f===0&&o===void 0?u:m(i,u,f,l,h)}),i},Z.findSegment=function(r,m){if(m=m||{},!p.isObject(m))throw new Error("options is invalid");var o,i=m.featureIndex||0,u=m.multiFeatureIndex||0,f=m.geometryIndex||0,l=m.segmentIndex||0,h=m.properties;switch(r.type){case"FeatureCollection":i<0&&(i=r.features.length+i),h=h||r.features[i].properties,o=r.features[i].geometry;break;case"Feature":h=h||r.properties,o=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":o=r;break;default:throw new Error("geojson is invalid")}if(o===null)return null;var d=o.coordinates;switch(o.type){case"Point":case"MultiPoint":return null;case"LineString":return l<0&&(l=d.length+l-1),p.lineString([d[l],d[l+1]],h,m);case"Polygon":return f<0&&(f=d.length+f),l<0&&(l=d[f].length+l-1),p.lineString([d[f][l],d[f][l+1]],h,m);case"MultiLineString":return u<0&&(u=d.length+u),l<0&&(l=d[u].length+l-1),p.lineString([d[u][l],d[u][l+1]],h,m);case"MultiPolygon":return u<0&&(u=d.length+u),f<0&&(f=d[u].length+f),l<0&&(l=d[u][f].length-l-1),p.lineString([d[u][f][l],d[u][f][l+1]],h,m)}throw new Error("geojson is invalid")},Z.findPoint=function(r,m){if(m=m||{},!p.isObject(m))throw new Error("options is invalid");var o,i=m.featureIndex||0,u=m.multiFeatureIndex||0,f=m.geometryIndex||0,l=m.coordIndex||0,h=m.properties;switch(r.type){case"FeatureCollection":i<0&&(i=r.features.length+i),h=h||r.features[i].properties,o=r.features[i].geometry;break;case"Feature":h=h||r.properties,o=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":o=r;break;default:throw new Error("geojson is invalid")}if(o===null)return null;var d=o.coordinates;switch(o.type){case"Point":return p.point(d,h,m);case"MultiPoint":return u<0&&(u=d.length+u),p.point(d[u],h,m);case"LineString":return l<0&&(l=d.length+l),p.point(d[l],h,m);case"Polygon":return f<0&&(f=d.length+f),l<0&&(l=d[f].length+l),p.point(d[f][l],h,m);case"MultiLineString":return u<0&&(u=d.length+u),l<0&&(l=d[u].length+l),p.point(d[u][l],h,m);case"MultiPolygon":return u<0&&(u=d.length+u),f<0&&(f=d[u].length+f),l<0&&(l=d[u][f].length-l),p.point(d[u][f][l],h,m)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(v,J,Z){Object.defineProperty(Z,"__esModule",{value:!0});var p=v("@turf/meta");function g(b){var y=[1/0,1/0,-1/0,-1/0];return p.coordEach(b,function(e){y[0]>e[0]&&(y[0]=e[0]),y[1]>e[1]&&(y[1]=e[1]),y[2]<e[0]&&(y[2]=e[0]),y[3]<e[1]&&(y[3]=e[1])}),y}g.default=g,Z.default=g},{"@turf/meta":66}],65:[function(v,J,Z){arguments[4][62][0].apply(Z,arguments)},{dup:62}],66:[function(v,J,Z){arguments[4][63][0].apply(Z,arguments)},{"@turf/helpers":65,dup:63}],67:[function(v,J,Z){Object.defineProperty(Z,"__esModule",{value:!0});var p=v("@turf/meta"),g=v("@turf/helpers");Z.default=function(b,y){y===void 0&&(y={});var e=0,n=0,t=0;return p.coordEach(b,function(a){e+=a[0],n+=a[1],t++}),g.point([e/t,n/t],y.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(v,J,Z){function p(u,f,l){l===void 0&&(l={});var h={type:"Feature"};return(l.id===0||l.id)&&(h.id=l.id),l.bbox&&(h.bbox=l.bbox),h.properties=f||{},h.geometry=u,h}function g(u,f,l){return l===void 0&&(l={}),p({type:"Point",coordinates:u},f,l)}function b(u,f,l){l===void 0&&(l={});for(var h=0,d=u;h<d.length;h++){var s=d[h];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var x=0;x<s[s.length-1].length;x++)if(s[s.length-1][x]!==s[0][x])throw new Error("First and last Position are not equivalent.")}return p({type:"Polygon",coordinates:u},f,l)}function y(u,f,l){if(l===void 0&&(l={}),u.length<2)throw new Error("coordinates must be an array of two or more positions");return p({type:"LineString",coordinates:u},f,l)}function e(u,f){f===void 0&&(f={});var l={type:"FeatureCollection"};return f.id&&(l.id=f.id),f.bbox&&(l.bbox=f.bbox),l.features=u,l}function n(u,f,l){return l===void 0&&(l={}),p({type:"MultiLineString",coordinates:u},f,l)}function t(u,f,l){return l===void 0&&(l={}),p({type:"MultiPoint",coordinates:u},f,l)}function a(u,f,l){return l===void 0&&(l={}),p({type:"MultiPolygon",coordinates:u},f,l)}function r(u,f){f===void 0&&(f="kilometers");var l=Z.factors[f];if(!l)throw new Error(f+" units is invalid");return u*l}function m(u,f){f===void 0&&(f="kilometers");var l=Z.factors[f];if(!l)throw new Error(f+" units is invalid");return u/l}function o(u){return 180*(u%(2*Math.PI))/Math.PI}function i(u){return!isNaN(u)&&u!==null&&!Array.isArray(u)&&!/^\s*$/.test(u)}Object.defineProperty(Z,"__esModule",{value:!0}),Z.earthRadius=63710088e-1,Z.factors={centimeters:100*Z.earthRadius,centimetres:100*Z.earthRadius,degrees:Z.earthRadius/111325,feet:3.28084*Z.earthRadius,inches:39.37*Z.earthRadius,kilometers:Z.earthRadius/1e3,kilometres:Z.earthRadius/1e3,meters:Z.earthRadius,metres:Z.earthRadius,miles:Z.earthRadius/1609.344,millimeters:1e3*Z.earthRadius,millimetres:1e3*Z.earthRadius,nauticalmiles:Z.earthRadius/1852,radians:1,yards:Z.earthRadius/1.0936},Z.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Z.earthRadius,yards:1/1.0936},Z.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},Z.feature=p,Z.geometry=function(u,f,l){switch(u){case"Point":return g(f).geometry;case"LineString":return y(f).geometry;case"Polygon":return b(f).geometry;case"MultiPoint":return t(f).geometry;case"MultiLineString":return n(f).geometry;case"MultiPolygon":return a(f).geometry;default:throw new Error(u+" is invalid")}},Z.point=g,Z.points=function(u,f,l){return l===void 0&&(l={}),e(u.map(function(h){return g(h,f)}),l)},Z.polygon=b,Z.polygons=function(u,f,l){return l===void 0&&(l={}),e(u.map(function(h){return b(h,f)}),l)},Z.lineString=y,Z.lineStrings=function(u,f,l){return l===void 0&&(l={}),e(u.map(function(h){return y(h,f)}),l)},Z.featureCollection=e,Z.multiLineString=n,Z.multiPoint=t,Z.multiPolygon=a,Z.geometryCollection=function(u,f,l){return l===void 0&&(l={}),p({type:"GeometryCollection",geometries:u},f,l)},Z.round=function(u,f){if(f===void 0&&(f=0),f&&!(f>=0))throw new Error("precision must be a positive number");var l=Math.pow(10,f||0);return Math.round(u*l)/l},Z.radiansToLength=r,Z.lengthToRadians=m,Z.lengthToDegrees=function(u,f){return o(m(u,f))},Z.bearingToAzimuth=function(u){var f=u%360;return f<0&&(f+=360),f},Z.radiansToDegrees=o,Z.degreesToRadians=function(u){return u%360*Math.PI/180},Z.convertLength=function(u,f,l){if(f===void 0&&(f="kilometers"),l===void 0&&(l="kilometers"),!(u>=0))throw new Error("length must be a positive number");return r(m(u,f),l)},Z.convertArea=function(u,f,l){if(f===void 0&&(f="meters"),l===void 0&&(l="kilometers"),!(u>=0))throw new Error("area must be a positive number");var h=Z.areaFactors[f];if(!h)throw new Error("invalid original units");var d=Z.areaFactors[l];if(!d)throw new Error("invalid final units");return u/h*d},Z.isNumber=i,Z.isObject=function(u){return!!u&&u.constructor===Object},Z.validateBBox=function(u){if(!u)throw new Error("bbox is required");if(!Array.isArray(u))throw new Error("bbox must be an Array");if(u.length!==4&&u.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");u.forEach(function(f){if(!i(f))throw new Error("bbox must only contain numbers")})},Z.validateId=function(u){if(!u)throw new Error("id is required");if(["string","number"].indexOf(typeof u)===-1)throw new Error("id must be a number or a string")},Z.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},Z.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},Z.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},Z.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},Z.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},Z.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},Z.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],69:[function(v,J,Z){Object.defineProperty(Z,"__esModule",{value:!0});var p=v("@turf/helpers");function g(r,m,o){if(r!==null)for(var i,u,f,l,h,d,s,x,c=0,T=0,_=r.type,w=_==="FeatureCollection",k=_==="Feature",L=w?r.features.length:1,A=0;A<L;A++){h=(x=!!(s=w?r.features[A].geometry:k?r.geometry:r)&&s.type==="GeometryCollection")?s.geometries.length:1;for(var I=0;I<h;I++){var P=0,S=0;if((l=x?s.geometries[I]:s)!==null){d=l.coordinates;var E=l.type;switch(c=!o||E!=="Polygon"&&E!=="MultiPolygon"?0:1,E){case null:break;case"Point":if(m(d,T,A,P,S)===!1)return!1;T++,P++;break;case"LineString":case"MultiPoint":for(i=0;i<d.length;i++){if(m(d[i],T,A,P,S)===!1)return!1;T++,E==="MultiPoint"&&P++}E==="LineString"&&P++;break;case"Polygon":case"MultiLineString":for(i=0;i<d.length;i++){for(u=0;u<d[i].length-c;u++){if(m(d[i][u],T,A,P,S)===!1)return!1;T++}E==="MultiLineString"&&P++,E==="Polygon"&&S++}E==="Polygon"&&P++;break;case"MultiPolygon":for(i=0;i<d.length;i++){for(S=0,u=0;u<d[i].length;u++){for(f=0;f<d[i][u].length-c;f++){if(m(d[i][u][f],T,A,P,S)===!1)return!1;T++}S++}P++}break;case"GeometryCollection":for(i=0;i<l.geometries.length;i++)if(g(l.geometries[i],m,o)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function b(r,m){var o;switch(r.type){case"FeatureCollection":for(o=0;o<r.features.length&&m(r.features[o].properties,o)!==!1;o++);break;case"Feature":m(r.properties,0)}}function y(r,m){if(r.type==="Feature")m(r,0);else if(r.type==="FeatureCollection")for(var o=0;o<r.features.length&&m(r.features[o],o)!==!1;o++);}function e(r,m){var o,i,u,f,l,h,d,s,x,c,T=0,_=r.type==="FeatureCollection",w=r.type==="Feature",k=_?r.features.length:1;for(o=0;o<k;o++){for(h=_?r.features[o].geometry:w?r.geometry:r,s=_?r.features[o].properties:w?r.properties:{},x=_?r.features[o].bbox:w?r.bbox:void 0,c=_?r.features[o].id:w?r.id:void 0,l=(d=!!h&&h.type==="GeometryCollection")?h.geometries.length:1,u=0;u<l;u++)if((f=d?h.geometries[u]:h)!==null)switch(f.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(m(f,T,s,x,c)===!1)return!1;break;case"GeometryCollection":for(i=0;i<f.geometries.length;i++)if(m(f.geometries[i],T,s,x,c)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(m(null,T,s,x,c)===!1)return!1;T++}}function n(r,m){e(r,function(o,i,u,f,l){var h,d=o===null?null:o.type;switch(d){case null:case"Point":case"LineString":case"Polygon":return m(p.feature(o,u,{bbox:f,id:l}),i,0)!==!1&&void 0}switch(d){case"MultiPoint":h="Point";break;case"MultiLineString":h="LineString";break;case"MultiPolygon":h="Polygon"}for(var s=0;s<o.coordinates.length;s++){var x={type:h,coordinates:o.coordinates[s]};if(m(p.feature(x,u),i,s)===!1)return!1}})}function t(r,m){n(r,function(o,i,u){var f=0;if(o.geometry){var l=o.geometry.type;if(l!=="Point"&&l!=="MultiPoint"){var h,d=0,s=0,x=0;return g(o,function(c,T,_,w,k){if(h===void 0||i>d||w>s||k>x)return h=c,d=i,s=w,x=k,void(f=0);var L=p.lineString([h,c],o.properties);if(m(L,i,u,k,f)===!1)return!1;f++,h=c})!==!1&&void 0}}})}function a(r,m){if(!r)throw new Error("geojson is required");n(r,function(o,i,u){if(o.geometry!==null){var f=o.geometry.type,l=o.geometry.coordinates;switch(f){case"LineString":if(m(o,i,u,0,0)===!1)return!1;break;case"Polygon":for(var h=0;h<l.length;h++)if(m(p.lineString(l[h],o.properties),i,u,h)===!1)return!1}}})}Z.coordEach=g,Z.coordReduce=function(r,m,o,i){var u=o;return g(r,function(f,l,h,d,s){u=l===0&&o===void 0?f:m(u,f,l,h,d,s)},i),u},Z.propEach=b,Z.propReduce=function(r,m,o){var i=o;return b(r,function(u,f){i=f===0&&o===void 0?u:m(i,u,f)}),i},Z.featureEach=y,Z.featureReduce=function(r,m,o){var i=o;return y(r,function(u,f){i=f===0&&o===void 0?u:m(i,u,f)}),i},Z.coordAll=function(r){var m=[];return g(r,function(o){m.push(o)}),m},Z.geomEach=e,Z.geomReduce=function(r,m,o){var i=o;return e(r,function(u,f,l,h,d){i=f===0&&o===void 0?u:m(i,u,f,l,h,d)}),i},Z.flattenEach=n,Z.flattenReduce=function(r,m,o){var i=o;return n(r,function(u,f,l){i=f===0&&l===0&&o===void 0?u:m(i,u,f,l)}),i},Z.segmentEach=t,Z.segmentReduce=function(r,m,o){var i=o,u=!1;return t(r,function(f,l,h,d,s){i=u===!1&&o===void 0?f:m(i,f,l,h,d,s),u=!0}),i},Z.lineEach=a,Z.lineReduce=function(r,m,o){var i=o;return a(r,function(u,f,l,h){i=f===0&&o===void 0?u:m(i,u,f,l,h)}),i},Z.findSegment=function(r,m){if(m=m||{},!p.isObject(m))throw new Error("options is invalid");var o,i=m.featureIndex||0,u=m.multiFeatureIndex||0,f=m.geometryIndex||0,l=m.segmentIndex||0,h=m.properties;switch(r.type){case"FeatureCollection":i<0&&(i=r.features.length+i),h=h||r.features[i].properties,o=r.features[i].geometry;break;case"Feature":h=h||r.properties,o=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":o=r;break;default:throw new Error("geojson is invalid")}if(o===null)return null;var d=o.coordinates;switch(o.type){case"Point":case"MultiPoint":return null;case"LineString":return l<0&&(l=d.length+l-1),p.lineString([d[l],d[l+1]],h,m);case"Polygon":return f<0&&(f=d.length+f),l<0&&(l=d[f].length+l-1),p.lineString([d[f][l],d[f][l+1]],h,m);case"MultiLineString":return u<0&&(u=d.length+u),l<0&&(l=d[u].length+l-1),p.lineString([d[u][l],d[u][l+1]],h,m);case"MultiPolygon":return u<0&&(u=d.length+u),f<0&&(f=d[u].length+f),l<0&&(l=d[u][f].length-l-1),p.lineString([d[u][f][l],d[u][f][l+1]],h,m)}throw new Error("geojson is invalid")},Z.findPoint=function(r,m){if(m=m||{},!p.isObject(m))throw new Error("options is invalid");var o,i=m.featureIndex||0,u=m.multiFeatureIndex||0,f=m.geometryIndex||0,l=m.coordIndex||0,h=m.properties;switch(r.type){case"FeatureCollection":i<0&&(i=r.features.length+i),h=h||r.features[i].properties,o=r.features[i].geometry;break;case"Feature":h=h||r.properties,o=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":o=r;break;default:throw new Error("geojson is invalid")}if(o===null)return null;var d=o.coordinates;switch(o.type){case"Point":return p.point(d,h,m);case"MultiPoint":return u<0&&(u=d.length+u),p.point(d[u],h,m);case"LineString":return l<0&&(l=d.length+l),p.point(d[l],h,m);case"Polygon":return f<0&&(f=d.length+f),l<0&&(l=d[f].length+l),p.point(d[f][l],h,m);case"MultiLineString":return u<0&&(u=d.length+u),l<0&&(l=d[u].length+l),p.point(d[u][l],h,m);case"MultiPolygon":return u<0&&(u=d.length+u),f<0&&(f=d[u].length+f),l<0&&(l=d[u][f].length-l),p.point(d[u][f][l],h,m)}throw new Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(v,J,Z){J.exports=function(p){var g=0,b=0,y=0,e=0;return p.map(function(n){var t=(n=n.slice())[0],a=t.toUpperCase();if(t!=a)switch(n[0]=a,t){case"a":n[6]+=y,n[7]+=e;break;case"v":n[1]+=e;break;case"h":n[1]+=y;break;default:for(var r=1;r<n.length;)n[r++]+=y,n[r++]+=e}switch(a){case"Z":y=g,e=b;break;case"H":y=n[1];break;case"V":e=n[1];break;case"M":y=g=n[1],e=b=n[2];break;default:y=n[n.length-2],e=n[n.length-1]}return n})}},{}],71:[function(v,J,Z){J.exports=function(p,g){if(!p||p.length==null)throw Error("Argument should be an array");g=g==null?1:Math.floor(g);for(var b=Array(2*g),y=0;y<g;y++){for(var e=-1/0,n=1/0,t=y,a=p.length;t<a;t+=g)p[t]>e&&(e=p[t]),p[t]<n&&(n=p[t]);b[y]=n,b[g+y]=e}return b}},{}],72:[function(v,J,Z){J.exports=function(p,g,b){if(typeof Array.prototype.findIndex=="function")return p.findIndex(g,b);if(typeof g!="function")throw new TypeError("predicate must be a function");var y=Object(p),e=y.length;if(e===0)return-1;for(var n=0;n<e;n++)if(g.call(b,y[n],n,y))return n;return-1}},{}],73:[function(v,J,Z){var p=v("array-bounds");J.exports=function(g,b,y){if(!g||g.length==null)throw Error("Argument should be an array");b==null&&(b=1),y==null&&(y=p(g,b));for(var e=0;e<b;e++){var n=y[b+e],t=y[e],a=e,r=g.length;if(n===1/0&&t===-1/0)for(a=e;a<r;a+=b)g[a]=g[a]===n?1:g[a]===t?0:.5;else if(n===1/0)for(a=e;a<r;a+=b)g[a]=g[a]===n?1:0;else if(t===-1/0)for(a=e;a<r;a+=b)g[a]=g[a]===t?0:1;else{var m=n-t;for(a=e;a<r;a+=b)isNaN(g[a])||(g[a]=m===0?.5:(g[a]-t)/m)}}return g}},{"array-bounds":71}],74:[function(v,J,Z){J.exports=function(p,g){var b=typeof p=="number",y=typeof g=="number";b&&!y?(g=p,p=0):b||y||(p=0,g=0);var e=(g|=0)-(p|=0);if(e<0)throw new Error("array length must be positive");for(var n=new Array(e),t=0,a=p;t<e;t++,a++)n[t]=a;return n}},{}],75:[function(v,J,Z){(function(p){(function(){var g=v("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function b(w,k){if(w===k)return 0;for(var L=w.length,A=k.length,I=0,P=Math.min(L,A);I<P;++I)if(w[I]!==k[I]){L=w[I],A=k[I];break}return L<A?-1:A<L?1:0}function y(w){return p.Buffer&&typeof p.Buffer.isBuffer=="function"?p.Buffer.isBuffer(w):!(w==null||!w._isBuffer)}var e=v("util/"),n=Object.prototype.hasOwnProperty,t=Array.prototype.slice,a=function(){}.name==="foo";function r(w){return Object.prototype.toString.call(w)}function m(w){return!y(w)&&typeof p.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(w):!!w&&(w instanceof DataView||!!(w.buffer&&w.buffer instanceof ArrayBuffer)))}var o=J.exports=d,i=/\s*function\s+([^\(\s]*)\s*/;function u(w){if(e.isFunction(w)){if(a)return w.name;var k=w.toString().match(i);return k&&k[1]}}function f(w,k){return typeof w=="string"?w.length<k?w:w.slice(0,k):w}function l(w){if(a||!e.isFunction(w))return e.inspect(w);var k=u(w);return"[Function"+(k?": "+k:"")+"]"}function h(w,k,L,A,I){throw new o.AssertionError({message:L,actual:w,expected:k,operator:A,stackStartFunction:I})}function d(w,k){w||h(w,!0,k,"==",o.ok)}function s(w,k,L,A){if(w===k)return!0;if(y(w)&&y(k))return b(w,k)===0;if(e.isDate(w)&&e.isDate(k))return w.getTime()===k.getTime();if(e.isRegExp(w)&&e.isRegExp(k))return w.source===k.source&&w.global===k.global&&w.multiline===k.multiline&&w.lastIndex===k.lastIndex&&w.ignoreCase===k.ignoreCase;if(w!==null&&typeof w=="object"||k!==null&&typeof k=="object"){if(m(w)&&m(k)&&r(w)===r(k)&&!(w instanceof Float32Array||w instanceof Float64Array))return b(new Uint8Array(w.buffer),new Uint8Array(k.buffer))===0;if(y(w)!==y(k))return!1;var I=(A=A||{actual:[],expected:[]}).actual.indexOf(w);return I!==-1&&I===A.expected.indexOf(k)||(A.actual.push(w),A.expected.push(k),function(P,S,E,D){if(P==null||S==null)return!1;if(e.isPrimitive(P)||e.isPrimitive(S))return P===S;if(E&&Object.getPrototypeOf(P)!==Object.getPrototypeOf(S))return!1;var R=x(P),H=x(S);if(R&&!H||!R&&H)return!1;if(R)return P=t.call(P),S=t.call(S),s(P,S,E);var V,X,$=_(P),G=_(S);if($.length!==G.length)return!1;for($.sort(),G.sort(),X=$.length-1;X>=0;X--)if($[X]!==G[X])return!1;for(X=$.length-1;X>=0;X--)if(V=$[X],!s(P[V],S[V],E,D))return!1;return!0}(w,k,L,A))}return L?w===k:w==k}function x(w){return Object.prototype.toString.call(w)=="[object Arguments]"}function c(w,k){if(!w||!k)return!1;if(Object.prototype.toString.call(k)=="[object RegExp]")return k.test(w);try{if(w instanceof k)return!0}catch{}return!Error.isPrototypeOf(k)&&k.call({},w)===!0}function T(w,k,L,A){var I;if(typeof k!="function")throw new TypeError('"block" argument must be a function');typeof L=="string"&&(A=L,L=null),I=function(E){var D;try{E()}catch(R){D=R}return D}(k),A=(L&&L.name?" ("+L.name+").":".")+(A?" "+A:"."),w&&!I&&h(I,L,"Missing expected exception"+A);var P=typeof A=="string",S=!w&&I&&!L;if((!w&&e.isError(I)&&P&&c(I,L)||S)&&h(I,L,"Got unwanted exception"+A),w&&I&&L&&!c(I,L)||!w&&I)throw I}o.AssertionError=function(w){this.name="AssertionError",this.actual=w.actual,this.expected=w.expected,this.operator=w.operator,w.message?(this.message=w.message,this.generatedMessage=!1):(this.message=function(E){return f(l(E.actual),128)+" "+E.operator+" "+f(l(E.expected),128)}(this),this.generatedMessage=!0);var k=w.stackStartFunction||h;if(Error.captureStackTrace)Error.captureStackTrace(this,k);else{var L=new Error;if(L.stack){var A=L.stack,I=u(k),P=A.indexOf(`
`+I);if(P>=0){var S=A.indexOf(`
`,P+1);A=A.substring(S+1)}this.stack=A}}},e.inherits(o.AssertionError,Error),o.fail=h,o.ok=d,o.equal=function(w,k,L){w!=k&&h(w,k,L,"==",o.equal)},o.notEqual=function(w,k,L){w==k&&h(w,k,L,"!=",o.notEqual)},o.deepEqual=function(w,k,L){s(w,k,!1)||h(w,k,L,"deepEqual",o.deepEqual)},o.deepStrictEqual=function(w,k,L){s(w,k,!0)||h(w,k,L,"deepStrictEqual",o.deepStrictEqual)},o.notDeepEqual=function(w,k,L){s(w,k,!1)&&h(w,k,L,"notDeepEqual",o.notDeepEqual)},o.notDeepStrictEqual=function w(k,L,A){s(k,L,!0)&&h(k,L,A,"notDeepStrictEqual",w)},o.strictEqual=function(w,k,L){w!==k&&h(w,k,L,"===",o.strictEqual)},o.notStrictEqual=function(w,k,L){w===k&&h(w,k,L,"!==",o.notStrictEqual)},o.throws=function(w,k,L){T(!0,w,k,L)},o.doesNotThrow=function(w,k,L){T(!1,w,k,L)},o.ifError=function(w){if(w)throw w},o.strict=g(function w(k,L){k||h(k,!0,L,"==",w)},o,{equal:o.strictEqual,deepEqual:o.deepStrictEqual,notEqual:o.notStrictEqual,notDeepEqual:o.notDeepStrictEqual}),o.strict.strict=o.strict;var _=Object.keys||function(w){var k=[];for(var L in w)n.call(w,L)&&k.push(L);return k}}).call(this)}).call(this,typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":247,"util/":78}],76:[function(v,J,Z){typeof Object.create=="function"?J.exports=function(p,g){p.super_=g,p.prototype=Object.create(g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}})}:J.exports=function(p,g){p.super_=g;var b=function(){};b.prototype=g.prototype,p.prototype=new b,p.prototype.constructor=p}},{}],77:[function(v,J,Z){J.exports=function(p){return p&&typeof p=="object"&&typeof p.copy=="function"&&typeof p.fill=="function"&&typeof p.readUInt8=="function"}},{}],78:[function(v,J,Z){(function(p,g){(function(){var b=/%[sdj%]/g;Z.format=function(P){if(!h(P)){for(var S=[],E=0;E<arguments.length;E++)S.push(n(arguments[E]));return S.join(" ")}E=1;for(var D=arguments,R=D.length,H=String(P).replace(b,function(X){if(X==="%%")return"%";if(E>=R)return X;switch(X){case"%s":return String(D[E++]);case"%d":return Number(D[E++]);case"%j":try{return JSON.stringify(D[E++])}catch{return"[Circular]"}default:return X}}),V=D[E];E<R;V=D[++E])f(V)||!x(V)?H+=" "+V:H+=" "+n(V);return H},Z.deprecate=function(P,S){if(d(g.process))return function(){return Z.deprecate(P,S).apply(this,arguments)};if(p.noDeprecation===!0)return P;var E=!1;return function(){if(!E){if(p.throwDeprecation)throw new Error(S);p.traceDeprecation?console.trace(S):console.error(S),E=!0}return P.apply(this,arguments)}};var y,e={};function n(P,S){var E={seen:[],stylize:a};return arguments.length>=3&&(E.depth=arguments[2]),arguments.length>=4&&(E.colors=arguments[3]),u(S)?E.showHidden=S:S&&Z._extend(E,S),d(E.showHidden)&&(E.showHidden=!1),d(E.depth)&&(E.depth=2),d(E.colors)&&(E.colors=!1),d(E.customInspect)&&(E.customInspect=!0),E.colors&&(E.stylize=t),r(E,P,E.depth)}function t(P,S){var E=n.styles[S];return E?"\x1B["+n.colors[E][0]+"m"+P+"\x1B["+n.colors[E][1]+"m":P}function a(P,S){return P}function r(P,S,E){if(P.customInspect&&S&&_(S.inspect)&&S.inspect!==Z.inspect&&(!S.constructor||S.constructor.prototype!==S)){var D=S.inspect(E,P);return h(D)||(D=r(P,D,E)),D}var R=function(N,B){if(d(B))return N.stylize("undefined","undefined");if(h(B)){var U="'"+JSON.stringify(B).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return N.stylize(U,"string")}if(l(B))return N.stylize(""+B,"number");if(u(B))return N.stylize(""+B,"boolean");if(f(B))return N.stylize("null","null")}(P,S);if(R)return R;var H=Object.keys(S),V=function(N){var B={};return N.forEach(function(U,ee){B[U]=!0}),B}(H);if(P.showHidden&&(H=Object.getOwnPropertyNames(S)),T(S)&&(H.indexOf("message")>=0||H.indexOf("description")>=0))return m(S);if(H.length===0){if(_(S)){var X=S.name?": "+S.name:"";return P.stylize("[Function"+X+"]","special")}if(s(S))return P.stylize(RegExp.prototype.toString.call(S),"regexp");if(c(S))return P.stylize(Date.prototype.toString.call(S),"date");if(T(S))return m(S)}var $,G="",W=!1,te=["{","}"];return i(S)&&(W=!0,te=["[","]"]),_(S)&&(G=" [Function"+(S.name?": "+S.name:"")+"]"),s(S)&&(G=" "+RegExp.prototype.toString.call(S)),c(S)&&(G=" "+Date.prototype.toUTCString.call(S)),T(S)&&(G=" "+m(S)),H.length!==0||W&&S.length!=0?E<0?s(S)?P.stylize(RegExp.prototype.toString.call(S),"regexp"):P.stylize("[Object]","special"):(P.seen.push(S),$=W?function(N,B,U,ee,j){for(var Q=[],K=0,re=B.length;K<re;++K)I(B,String(K))?Q.push(o(N,B,U,ee,String(K),!0)):Q.push("");return j.forEach(function(ne){ne.match(/^\d+$/)||Q.push(o(N,B,U,ee,ne,!0))}),Q}(P,S,E,V,H):H.map(function(N){return o(P,S,E,V,N,W)}),P.seen.pop(),function(N,B,U){return N.reduce(function(ee,j){return j.indexOf(`
`)>=0,ee+j.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?U[0]+(B===""?"":B+`
 `)+" "+N.join(`,
  `)+" "+U[1]:U[0]+B+" "+N.join(", ")+" "+U[1]}($,G,te)):te[0]+G+te[1]}function m(P){return"["+Error.prototype.toString.call(P)+"]"}function o(P,S,E,D,R,H){var V,X,$;if(($=Object.getOwnPropertyDescriptor(S,R)||{value:S[R]}).get?X=$.set?P.stylize("[Getter/Setter]","special"):P.stylize("[Getter]","special"):$.set&&(X=P.stylize("[Setter]","special")),I(D,R)||(V="["+R+"]"),X||(P.seen.indexOf($.value)<0?(X=f(E)?r(P,$.value,null):r(P,$.value,E-1)).indexOf(`
`)>-1&&(X=H?X.split(`
`).map(function(G){return"  "+G}).join(`
`).substr(2):`
`+X.split(`
`).map(function(G){return"   "+G}).join(`
`)):X=P.stylize("[Circular]","special")),d(V)){if(H&&R.match(/^\d+$/))return X;(V=JSON.stringify(""+R)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(V=V.substr(1,V.length-2),V=P.stylize(V,"name")):(V=V.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),V=P.stylize(V,"string"))}return V+": "+X}function i(P){return Array.isArray(P)}function u(P){return typeof P=="boolean"}function f(P){return P===null}function l(P){return typeof P=="number"}function h(P){return typeof P=="string"}function d(P){return P===void 0}function s(P){return x(P)&&w(P)==="[object RegExp]"}function x(P){return typeof P=="object"&&P!==null}function c(P){return x(P)&&w(P)==="[object Date]"}function T(P){return x(P)&&(w(P)==="[object Error]"||P instanceof Error)}function _(P){return typeof P=="function"}function w(P){return Object.prototype.toString.call(P)}function k(P){return P<10?"0"+P.toString(10):P.toString(10)}Z.debuglog=function(P){if(d(y)&&(y=p.env.NODE_DEBUG||""),P=P.toUpperCase(),!e[P])if(new RegExp("\\b"+P+"\\b","i").test(y)){var S=p.pid;e[P]=function(){var E=Z.format.apply(Z,arguments);console.error("%s %d: %s",P,S,E)}}else e[P]=function(){};return e[P]},Z.inspect=n,n.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},n.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},Z.isArray=i,Z.isBoolean=u,Z.isNull=f,Z.isNullOrUndefined=function(P){return P==null},Z.isNumber=l,Z.isString=h,Z.isSymbol=function(P){return typeof P=="symbol"},Z.isUndefined=d,Z.isRegExp=s,Z.isObject=x,Z.isDate=c,Z.isError=T,Z.isFunction=_,Z.isPrimitive=function(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"||typeof P=="symbol"||P===void 0},Z.isBuffer=v("./support/isBuffer");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var P=new Date,S=[k(P.getHours()),k(P.getMinutes()),k(P.getSeconds())].join(":");return[P.getDate(),L[P.getMonth()],S].join(" ")}function I(P,S){return Object.prototype.hasOwnProperty.call(P,S)}Z.log=function(){console.log("%s - %s",A(),Z.format.apply(Z,arguments))},Z.inherits=v("inherits"),Z._extend=function(P,S){if(!S||!x(S))return P;for(var E=Object.keys(S),D=E.length;D--;)P[E[D]]=S[E[D]];return P}}).call(this)}).call(this,v("_process"),typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":77,_process:278,inherits:76}],79:[function(v,J,Z){Z.byteLength=function(r){var m=t(r),o=m[0],i=m[1];return 3*(o+i)/4-i},Z.toByteArray=function(r){var m,o,i=t(r),u=i[0],f=i[1],l=new b(function(s,x,c){return 3*(x+c)/4-c}(0,u,f)),h=0,d=f>0?u-4:u;for(o=0;o<d;o+=4)m=g[r.charCodeAt(o)]<<18|g[r.charCodeAt(o+1)]<<12|g[r.charCodeAt(o+2)]<<6|g[r.charCodeAt(o+3)],l[h++]=m>>16&255,l[h++]=m>>8&255,l[h++]=255&m;return f===2&&(m=g[r.charCodeAt(o)]<<2|g[r.charCodeAt(o+1)]>>4,l[h++]=255&m),f===1&&(m=g[r.charCodeAt(o)]<<10|g[r.charCodeAt(o+1)]<<4|g[r.charCodeAt(o+2)]>>2,l[h++]=m>>8&255,l[h++]=255&m),l},Z.fromByteArray=function(r){for(var m,o=r.length,i=o%3,u=[],f=0,l=o-i;f<l;f+=16383)u.push(a(r,f,f+16383>l?l:f+16383));return i===1?(m=r[o-1],u.push(p[m>>2]+p[m<<4&63]+"==")):i===2&&(m=(r[o-2]<<8)+r[o-1],u.push(p[m>>10]+p[m>>4&63]+p[m<<2&63]+"=")),u.join("")};for(var p=[],g=[],b=typeof Uint8Array<"u"?Uint8Array:Array,y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,n=y.length;e<n;++e)p[e]=y[e],g[y.charCodeAt(e)]=e;function t(r){var m=r.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var o=r.indexOf("=");return o===-1&&(o=m),[o,o===m?0:4-o%4]}function a(r,m,o){for(var i,u,f=[],l=m;l<o;l+=3)i=(r[l]<<16&16711680)+(r[l+1]<<8&65280)+(255&r[l+2]),f.push(p[(u=i)>>18&63]+p[u>>12&63]+p[u>>6&63]+p[63&u]);return f.join("")}g["-".charCodeAt(0)]=62,g["_".charCodeAt(0)]=63},{}],80:[function(v,J,Z){function p(t,a,r,m,o){for(var i=o+1;m<=o;){var u=m+o>>>1,f=t[u];(r!==void 0?r(f,a):f-a)>=0?(i=u,o=u-1):m=u+1}return i}function g(t,a,r,m,o){for(var i=o+1;m<=o;){var u=m+o>>>1,f=t[u];(r!==void 0?r(f,a):f-a)>0?(i=u,o=u-1):m=u+1}return i}function b(t,a,r,m,o){for(var i=m-1;m<=o;){var u=m+o>>>1,f=t[u];(r!==void 0?r(f,a):f-a)<0?(i=u,m=u+1):o=u-1}return i}function y(t,a,r,m,o){for(var i=m-1;m<=o;){var u=m+o>>>1,f=t[u];(r!==void 0?r(f,a):f-a)<=0?(i=u,m=u+1):o=u-1}return i}function e(t,a,r,m,o){for(;m<=o;){var i=m+o>>>1,u=t[i],f=r!==void 0?r(u,a):u-a;if(f===0)return i;f<=0?m=i+1:o=i-1}return-1}function n(t,a,r,m,o,i){return typeof r=="function"?i(t,a,r,m===void 0?0:0|m,o===void 0?t.length-1:0|o):i(t,a,void 0,r===void 0?0:0|r,m===void 0?t.length-1:0|m)}J.exports={ge:function(t,a,r,m,o){return n(t,a,r,m,o,p)},gt:function(t,a,r,m,o){return n(t,a,r,m,o,g)},lt:function(t,a,r,m,o){return n(t,a,r,m,o,b)},le:function(t,a,r,m,o){return n(t,a,r,m,o,y)},eq:function(t,a,r,m,o){return n(t,a,r,m,o,e)}}},{}],81:[function(v,J,Z){function p(b){var y=32;return(b&=-b)&&y--,65535&b&&(y-=16),16711935&b&&(y-=8),252645135&b&&(y-=4),858993459&b&&(y-=2),1431655765&b&&(y-=1),y}Z.INT_BITS=32,Z.INT_MAX=2147483647,Z.INT_MIN=-1<<31,Z.sign=function(b){return(b>0)-(b<0)},Z.abs=function(b){var y=b>>31;return(b^y)-y},Z.min=function(b,y){return y^(b^y)&-(b<y)},Z.max=function(b,y){return b^(b^y)&-(b<y)},Z.isPow2=function(b){return!(b&b-1||!b)},Z.log2=function(b){var y,e;return y=(b>65535)<<4,y|=e=((b>>>=y)>255)<<3,y|=e=((b>>>=e)>15)<<2,(y|=e=((b>>>=e)>3)<<1)|(b>>>=e)>>1},Z.log10=function(b){return b>=1e9?9:b>=1e8?8:b>=1e7?7:b>=1e6?6:b>=1e5?5:b>=1e4?4:b>=1e3?3:b>=100?2:b>=10?1:0},Z.popCount=function(b){return 16843009*((b=(858993459&(b-=b>>>1&1431655765))+(b>>>2&858993459))+(b>>>4)&252645135)>>>24},Z.countTrailingZeros=p,Z.nextPow2=function(b){return b+=b===0,--b,b|=b>>>1,b|=b>>>2,b|=b>>>4,b|=b>>>8,(b|=b>>>16)+1},Z.prevPow2=function(b){return b|=b>>>1,b|=b>>>2,b|=b>>>4,b|=b>>>8,(b|=b>>>16)-(b>>>1)},Z.parity=function(b){return b^=b>>>16,b^=b>>>8,b^=b>>>4,27030>>>(b&=15)&1};var g=new Array(256);(function(b){for(var y=0;y<256;++y){var e=y,n=y,t=7;for(e>>>=1;e;e>>>=1)n<<=1,n|=1&e,--t;b[y]=n<<t&255}})(g),Z.reverse=function(b){return g[255&b]<<24|g[b>>>8&255]<<16|g[b>>>16&255]<<8|g[b>>>24&255]},Z.interleave2=function(b,y){return(b=1431655765&((b=858993459&((b=252645135&((b=16711935&((b&=65535)|b<<8))|b<<4))|b<<2))|b<<1))|(y=1431655765&((y=858993459&((y=252645135&((y=16711935&((y&=65535)|y<<8))|y<<4))|y<<2))|y<<1))<<1},Z.deinterleave2=function(b,y){return(b=65535&((b=16711935&((b=252645135&((b=858993459&((b=b>>>y&1431655765)|b>>>1))|b>>>2))|b>>>4))|b>>>16))<<16>>16},Z.interleave3=function(b,y,e){return b=1227133513&((b=3272356035&((b=251719695&((b=4278190335&((b&=1023)|b<<16))|b<<8))|b<<4))|b<<2),(b|=(y=1227133513&((y=3272356035&((y=251719695&((y=4278190335&((y&=1023)|y<<16))|y<<8))|y<<4))|y<<2))<<1)|(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<2},Z.deinterleave3=function(b,y){return(b=1023&((b=4278190335&((b=251719695&((b=3272356035&((b=b>>>y&1227133513)|b>>>2))|b>>>4))|b>>>8))|b>>>16))<<22>>22},Z.nextCombination=function(b){var y=b|b-1;return y+1|(~y&-~y)-1>>>p(b)+1}},{}],82:[function(v,J,Z){var p=v("clamp");J.exports=function(e,n){n||(n={});var t,a,r,m,o,i,u,f,l,h,d,s=n.cutoff==null?.25:n.cutoff,x=n.radius==null?8:n.radius,c=n.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!n.width||!n.height)throw Error("For raw data width and height should be provided by options");t=n.width,a=n.height,m=e,i=n.stride?n.stride:Math.floor(e.length/t/a)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(u=(f=e).getContext("2d"),t=f.width,a=f.height,l=u.getImageData(0,0,t,a),m=l.data,i=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(f=e.canvas,u=e,t=f.width,a=f.height,l=u.getImageData(0,0,t,a),m=l.data,i=4):window.ImageData&&e instanceof window.ImageData&&(l=e,t=e.width,a=e.height,m=l.data,i=4);if(r=Math.max(t,a),window.Uint8ClampedArray&&m instanceof window.Uint8ClampedArray||window.Uint8Array&&m instanceof window.Uint8Array)for(o=m,m=Array(t*a),h=0,d=o.length;h<d;h++)m[h]=o[h*i+c]/255;else if(i!==1)throw Error("Raw data can have only 1 value per pixel");var T=Array(t*a),_=Array(t*a),w=Array(r),k=Array(r),L=Array(r+1),A=Array(r);for(h=0,d=t*a;h<d;h++){var I=m[h];T[h]=I===1?0:I===0?g:Math.pow(Math.max(0,.5-I),2),_[h]=I===1?g:I===0?0:Math.pow(Math.max(0,I-.5),2)}b(T,t,a,w,k,A,L),b(_,t,a,w,k,A,L);var P=window.Float32Array?new Float32Array(t*a):new Array(t*a);for(h=0,d=t*a;h<d;h++)P[h]=p(1-((T[h]-_[h])/x+s),0,1);return P};var g=1e20;function b(e,n,t,a,r,m,o){for(var i=0;i<n;i++){for(var u=0;u<t;u++)a[u]=e[u*n+i];for(y(a,r,m,o,t),u=0;u<t;u++)e[u*n+i]=r[u]}for(u=0;u<t;u++){for(i=0;i<n;i++)a[i]=e[u*n+i];for(y(a,r,m,o,n),i=0;i<n;i++)e[u*n+i]=Math.sqrt(r[i])}}function y(e,n,t,a,r){t[0]=0,a[0]=-g,a[1]=+g;for(var m=1,o=0;m<r;m++){for(var i=(e[m]+m*m-(e[t[o]]+t[o]*t[o]))/(2*m-2*t[o]);i<=a[o];)o--,i=(e[m]+m*m-(e[t[o]]+t[o]*t[o]))/(2*m-2*t[o]);t[++o]=m,a[o]=i,a[o+1]=+g}for(m=0,o=0;m<r;m++){for(;a[o+1]<m;)o++;n[m]=(m-t[o])*(m-t[o])+e[t[o]]}}},{clamp:86}],83:[function(v,J,Z){},{}],84:[function(v,J,Z){var p,g=typeof Reflect=="object"?Reflect:null,b=g&&typeof g.apply=="function"?g.apply:function(l,h,d){return Function.prototype.apply.call(l,h,d)};p=g&&typeof g.ownKeys=="function"?g.ownKeys:Object.getOwnPropertySymbols?function(l){return Object.getOwnPropertyNames(l).concat(Object.getOwnPropertySymbols(l))}:function(l){return Object.getOwnPropertyNames(l)};var y=Number.isNaN||function(l){return l!=l};function e(){e.init.call(this)}J.exports=e,J.exports.once=function(l,h){return new Promise(function(d,s){function x(){c!==void 0&&l.removeListener("error",c),d([].slice.call(arguments))}var c;h!=="error"&&(c=function(T){l.removeListener(h,x),s(T)},l.once("error",c)),l.once(h,x)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var n=10;function t(l){if(typeof l!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof l)}function a(l){return l._maxListeners===void 0?e.defaultMaxListeners:l._maxListeners}function r(l,h,d,s){var x,c,T,_;if(t(d),(c=l._events)===void 0?(c=l._events=Object.create(null),l._eventsCount=0):(c.newListener!==void 0&&(l.emit("newListener",h,d.listener?d.listener:d),c=l._events),T=c[h]),T===void 0)T=c[h]=d,++l._eventsCount;else if(typeof T=="function"?T=c[h]=s?[d,T]:[T,d]:s?T.unshift(d):T.push(d),(x=a(l))>0&&T.length>x&&!T.warned){T.warned=!0;var w=new Error("Possible EventEmitter memory leak detected. "+T.length+" "+String(h)+" listeners added. Use emitter.setMaxListeners() to increase limit");w.name="MaxListenersExceededWarning",w.emitter=l,w.type=h,w.count=T.length,_=w,console&&console.warn&&console.warn(_)}return l}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function o(l,h,d){var s={fired:!1,wrapFn:void 0,target:l,type:h,listener:d},x=m.bind(s);return x.listener=d,s.wrapFn=x,x}function i(l,h,d){var s=l._events;if(s===void 0)return[];var x=s[h];return x===void 0?[]:typeof x=="function"?d?[x.listener||x]:[x]:d?function(c){for(var T=new Array(c.length),_=0;_<T.length;++_)T[_]=c[_].listener||c[_];return T}(x):f(x,x.length)}function u(l){var h=this._events;if(h!==void 0){var d=h[l];if(typeof d=="function")return 1;if(d!==void 0)return d.length}return 0}function f(l,h){for(var d=new Array(h),s=0;s<h;++s)d[s]=l[s];return d}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(l){if(typeof l!="number"||l<0||y(l))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+l+".");n=l}}),e.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(l){if(typeof l!="number"||l<0||y(l))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+l+".");return this._maxListeners=l,this},e.prototype.getMaxListeners=function(){return a(this)},e.prototype.emit=function(l){for(var h=[],d=1;d<arguments.length;d++)h.push(arguments[d]);var s=l==="error",x=this._events;if(x!==void 0)s=s&&x.error===void 0;else if(!s)return!1;if(s){var c;if(h.length>0&&(c=h[0]),c instanceof Error)throw c;var T=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw T.context=c,T}var _=x[l];if(_===void 0)return!1;if(typeof _=="function")b(_,this,h);else{var w=_.length,k=f(_,w);for(d=0;d<w;++d)b(k[d],this,h)}return!0},e.prototype.addListener=function(l,h){return r(this,l,h,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(l,h){return r(this,l,h,!0)},e.prototype.once=function(l,h){return t(h),this.on(l,o(this,l,h)),this},e.prototype.prependOnceListener=function(l,h){return t(h),this.prependListener(l,o(this,l,h)),this},e.prototype.removeListener=function(l,h){var d,s,x,c,T;if(t(h),(s=this._events)===void 0)return this;if((d=s[l])===void 0)return this;if(d===h||d.listener===h)--this._eventsCount==0?this._events=Object.create(null):(delete s[l],s.removeListener&&this.emit("removeListener",l,d.listener||h));else if(typeof d!="function"){for(x=-1,c=d.length-1;c>=0;c--)if(d[c]===h||d[c].listener===h){T=d[c].listener,x=c;break}if(x<0)return this;x===0?d.shift():function(_,w){for(;w+1<_.length;w++)_[w]=_[w+1];_.pop()}(d,x),d.length===1&&(s[l]=d[0]),s.removeListener!==void 0&&this.emit("removeListener",l,T||h)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(l){var h,d,s;if((d=this._events)===void 0)return this;if(d.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):d[l]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete d[l]),this;if(arguments.length===0){var x,c=Object.keys(d);for(s=0;s<c.length;++s)(x=c[s])!=="removeListener"&&this.removeAllListeners(x);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(h=d[l])=="function")this.removeListener(l,h);else if(h!==void 0)for(s=h.length-1;s>=0;s--)this.removeListener(l,h[s]);return this},e.prototype.listeners=function(l){return i(this,l,!0)},e.prototype.rawListeners=function(l){return i(this,l,!1)},e.listenerCount=function(l,h){return typeof l.listenerCount=="function"?l.listenerCount(h):u.call(l,h)},e.prototype.listenerCount=u,e.prototype.eventNames=function(){return this._eventsCount>0?p(this._events):[]}},{}],85:[function(v,J,Z){(function(p){(function(){var g=v("base64-js"),b=v("ieee754");Z.Buffer=e,Z.SlowBuffer=function(N){return+N!=N&&(N=0),e.alloc(+N)},Z.INSPECT_MAX_BYTES=50;function y(N){if(N>2147483647)throw new RangeError('The value "'+N+'" is invalid for option "size"');var B=new Uint8Array(N);return B.__proto__=e.prototype,B}function e(N,B,U){if(typeof N=="number"){if(typeof B=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return a(N)}return n(N,B,U)}function n(N,B,U){if(typeof N=="string")return function(Q,K){if(typeof K=="string"&&K!==""||(K="utf8"),!e.isEncoding(K))throw new TypeError("Unknown encoding: "+K);var re=0|o(Q,K),ne=y(re),le=ne.write(Q,K);return le!==re&&(ne=ne.slice(0,le)),ne}(N,B);if(ArrayBuffer.isView(N))return r(N);if(N==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N);if(W(N,ArrayBuffer)||N&&W(N.buffer,ArrayBuffer))return function(Q,K,re){if(K<0||Q.byteLength<K)throw new RangeError('"offset" is outside of buffer bounds');if(Q.byteLength<K+(re||0))throw new RangeError('"length" is outside of buffer bounds');var ne;return ne=K===void 0&&re===void 0?new Uint8Array(Q):re===void 0?new Uint8Array(Q,K):new Uint8Array(Q,K,re),ne.__proto__=e.prototype,ne}(N,B,U);if(typeof N=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ee=N.valueOf&&N.valueOf();if(ee!=null&&ee!==N)return e.from(ee,B,U);var j=function(Q){if(e.isBuffer(Q)){var K=0|m(Q.length),re=y(K);return re.length===0||Q.copy(re,0,0,K),re}if(Q.length!==void 0)return typeof Q.length!="number"||te(Q.length)?y(0):r(Q);if(Q.type==="Buffer"&&Array.isArray(Q.data))return r(Q.data)}(N);if(j)return j;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof N[Symbol.toPrimitive]=="function")return e.from(N[Symbol.toPrimitive]("string"),B,U);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N)}function t(N){if(typeof N!="number")throw new TypeError('"size" argument must be of type number');if(N<0)throw new RangeError('The value "'+N+'" is invalid for option "size"')}function a(N){return t(N),y(N<0?0:0|m(N))}function r(N){for(var B=N.length<0?0:0|m(N.length),U=y(B),ee=0;ee<B;ee+=1)U[ee]=255&N[ee];return U}function m(N){if(N>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|N}function o(N,B){if(e.isBuffer(N))return N.length;if(ArrayBuffer.isView(N)||W(N,ArrayBuffer))return N.byteLength;if(typeof N!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof N);var U=N.length,ee=arguments.length>2&&arguments[2]===!0;if(!ee&&U===0)return 0;for(var j=!1;;)switch(B){case"ascii":case"latin1":case"binary":return U;case"utf8":case"utf-8":return X(N).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*U;case"hex":return U>>>1;case"base64":return $(N).length;default:if(j)return ee?-1:X(N).length;B=(""+B).toLowerCase(),j=!0}}function i(N,B,U){var ee=!1;if((B===void 0||B<0)&&(B=0),B>this.length||((U===void 0||U>this.length)&&(U=this.length),U<=0)||(U>>>=0)<=(B>>>=0))return"";for(N||(N="utf8");;)switch(N){case"hex":return A(this,B,U);case"utf8":case"utf-8":return w(this,B,U);case"ascii":return k(this,B,U);case"latin1":case"binary":return L(this,B,U);case"base64":return _(this,B,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,B,U);default:if(ee)throw new TypeError("Unknown encoding: "+N);N=(N+"").toLowerCase(),ee=!0}}function u(N,B,U){var ee=N[B];N[B]=N[U],N[U]=ee}function f(N,B,U,ee,j){if(N.length===0)return-1;if(typeof U=="string"?(ee=U,U=0):U>2147483647?U=2147483647:U<-2147483648&&(U=-2147483648),te(U=+U)&&(U=j?0:N.length-1),U<0&&(U=N.length+U),U>=N.length){if(j)return-1;U=N.length-1}else if(U<0){if(!j)return-1;U=0}if(typeof B=="string"&&(B=e.from(B,ee)),e.isBuffer(B))return B.length===0?-1:l(N,B,U,ee,j);if(typeof B=="number")return B&=255,typeof Uint8Array.prototype.indexOf=="function"?j?Uint8Array.prototype.indexOf.call(N,B,U):Uint8Array.prototype.lastIndexOf.call(N,B,U):l(N,[B],U,ee,j);throw new TypeError("val must be string, number or Buffer")}function l(N,B,U,ee,j){var Q,K=1,re=N.length,ne=B.length;if(ee!==void 0&&((ee=String(ee).toLowerCase())==="ucs2"||ee==="ucs-2"||ee==="utf16le"||ee==="utf-16le")){if(N.length<2||B.length<2)return-1;K=2,re/=2,ne/=2,U/=2}function le(me,Te){return K===1?me[Te]:me.readUInt16BE(Te*K)}if(j){var oe=-1;for(Q=U;Q<re;Q++)if(le(N,Q)===le(B,oe===-1?0:Q-oe)){if(oe===-1&&(oe=Q),Q-oe+1===ne)return oe*K}else oe!==-1&&(Q-=Q-oe),oe=-1}else for(U+ne>re&&(U=re-ne),Q=U;Q>=0;Q--){for(var de=!0,se=0;se<ne;se++)if(le(N,Q+se)!==le(B,se)){de=!1;break}if(de)return Q}return-1}function h(N,B,U,ee){U=Number(U)||0;var j=N.length-U;ee?(ee=Number(ee))>j&&(ee=j):ee=j;var Q=B.length;ee>Q/2&&(ee=Q/2);for(var K=0;K<ee;++K){var re=parseInt(B.substr(2*K,2),16);if(te(re))return K;N[U+K]=re}return K}function d(N,B,U,ee){return G(X(B,N.length-U),N,U,ee)}function s(N,B,U,ee){return G(function(j){for(var Q=[],K=0;K<j.length;++K)Q.push(255&j.charCodeAt(K));return Q}(B),N,U,ee)}function x(N,B,U,ee){return s(N,B,U,ee)}function c(N,B,U,ee){return G($(B),N,U,ee)}function T(N,B,U,ee){return G(function(j,Q){for(var K,re,ne,le=[],oe=0;oe<j.length&&!((Q-=2)<0);++oe)K=j.charCodeAt(oe),re=K>>8,ne=K%256,le.push(ne),le.push(re);return le}(B,N.length-U),N,U,ee)}function _(N,B,U){return B===0&&U===N.length?g.fromByteArray(N):g.fromByteArray(N.slice(B,U))}function w(N,B,U){U=Math.min(N.length,U);for(var ee=[],j=B;j<U;){var Q,K,re,ne,le=N[j],oe=null,de=le>239?4:le>223?3:le>191?2:1;if(j+de<=U)switch(de){case 1:le<128&&(oe=le);break;case 2:(192&(Q=N[j+1]))==128&&(ne=(31&le)<<6|63&Q)>127&&(oe=ne);break;case 3:Q=N[j+1],K=N[j+2],(192&Q)==128&&(192&K)==128&&(ne=(15&le)<<12|(63&Q)<<6|63&K)>2047&&(ne<55296||ne>57343)&&(oe=ne);break;case 4:Q=N[j+1],K=N[j+2],re=N[j+3],(192&Q)==128&&(192&K)==128&&(192&re)==128&&(ne=(15&le)<<18|(63&Q)<<12|(63&K)<<6|63&re)>65535&&ne<1114112&&(oe=ne)}oe===null?(oe=65533,de=1):oe>65535&&(oe-=65536,ee.push(oe>>>10&1023|55296),oe=56320|1023&oe),ee.push(oe),j+=de}return function(se){var me=se.length;if(me<=4096)return String.fromCharCode.apply(String,se);for(var Te="",_e=0;_e<me;)Te+=String.fromCharCode.apply(String,se.slice(_e,_e+=4096));return Te}(ee)}Z.kMaxLength=2147483647,e.TYPED_ARRAY_SUPPORT=function(){try{var N=new Uint8Array(1);return N.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},N.foo()===42}catch{return!1}}(),e.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(N,B,U){return n(N,B,U)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(N,B,U){return function(ee,j,Q){return t(ee),ee<=0?y(ee):j!==void 0?typeof Q=="string"?y(ee).fill(j,Q):y(ee).fill(j):y(ee)}(N,B,U)},e.allocUnsafe=function(N){return a(N)},e.allocUnsafeSlow=function(N){return a(N)},e.isBuffer=function(N){return N!=null&&N._isBuffer===!0&&N!==e.prototype},e.compare=function(N,B){if(W(N,Uint8Array)&&(N=e.from(N,N.offset,N.byteLength)),W(B,Uint8Array)&&(B=e.from(B,B.offset,B.byteLength)),!e.isBuffer(N)||!e.isBuffer(B))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(N===B)return 0;for(var U=N.length,ee=B.length,j=0,Q=Math.min(U,ee);j<Q;++j)if(N[j]!==B[j]){U=N[j],ee=B[j];break}return U<ee?-1:ee<U?1:0},e.isEncoding=function(N){switch(String(N).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(N,B){if(!Array.isArray(N))throw new TypeError('"list" argument must be an Array of Buffers');if(N.length===0)return e.alloc(0);var U;if(B===void 0)for(B=0,U=0;U<N.length;++U)B+=N[U].length;var ee=e.allocUnsafe(B),j=0;for(U=0;U<N.length;++U){var Q=N[U];if(W(Q,Uint8Array)&&(Q=e.from(Q)),!e.isBuffer(Q))throw new TypeError('"list" argument must be an Array of Buffers');Q.copy(ee,j),j+=Q.length}return ee},e.byteLength=o,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var N=this.length;if(N%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var B=0;B<N;B+=2)u(this,B,B+1);return this},e.prototype.swap32=function(){var N=this.length;if(N%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var B=0;B<N;B+=4)u(this,B,B+3),u(this,B+1,B+2);return this},e.prototype.swap64=function(){var N=this.length;if(N%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var B=0;B<N;B+=8)u(this,B,B+7),u(this,B+1,B+6),u(this,B+2,B+5),u(this,B+3,B+4);return this},e.prototype.toString=function(){var N=this.length;return N===0?"":arguments.length===0?w(this,0,N):i.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(N){if(!e.isBuffer(N))throw new TypeError("Argument must be a Buffer");return this===N||e.compare(this,N)===0},e.prototype.inspect=function(){var N="",B=Z.INSPECT_MAX_BYTES;return N=this.toString("hex",0,B).replace(/(.{2})/g,"$1 ").trim(),this.length>B&&(N+=" ... "),"<Buffer "+N+">"},e.prototype.compare=function(N,B,U,ee,j){if(W(N,Uint8Array)&&(N=e.from(N,N.offset,N.byteLength)),!e.isBuffer(N))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof N);if(B===void 0&&(B=0),U===void 0&&(U=N?N.length:0),ee===void 0&&(ee=0),j===void 0&&(j=this.length),B<0||U>N.length||ee<0||j>this.length)throw new RangeError("out of range index");if(ee>=j&&B>=U)return 0;if(ee>=j)return-1;if(B>=U)return 1;if(this===N)return 0;for(var Q=(j>>>=0)-(ee>>>=0),K=(U>>>=0)-(B>>>=0),re=Math.min(Q,K),ne=this.slice(ee,j),le=N.slice(B,U),oe=0;oe<re;++oe)if(ne[oe]!==le[oe]){Q=ne[oe],K=le[oe];break}return Q<K?-1:K<Q?1:0},e.prototype.includes=function(N,B,U){return this.indexOf(N,B,U)!==-1},e.prototype.indexOf=function(N,B,U){return f(this,N,B,U,!0)},e.prototype.lastIndexOf=function(N,B,U){return f(this,N,B,U,!1)},e.prototype.write=function(N,B,U,ee){if(B===void 0)ee="utf8",U=this.length,B=0;else if(U===void 0&&typeof B=="string")ee=B,U=this.length,B=0;else{if(!isFinite(B))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");B>>>=0,isFinite(U)?(U>>>=0,ee===void 0&&(ee="utf8")):(ee=U,U=void 0)}var j=this.length-B;if((U===void 0||U>j)&&(U=j),N.length>0&&(U<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");ee||(ee="utf8");for(var Q=!1;;)switch(ee){case"hex":return h(this,N,B,U);case"utf8":case"utf-8":return d(this,N,B,U);case"ascii":return s(this,N,B,U);case"latin1":case"binary":return x(this,N,B,U);case"base64":return c(this,N,B,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,N,B,U);default:if(Q)throw new TypeError("Unknown encoding: "+ee);ee=(""+ee).toLowerCase(),Q=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function k(N,B,U){var ee="";U=Math.min(N.length,U);for(var j=B;j<U;++j)ee+=String.fromCharCode(127&N[j]);return ee}function L(N,B,U){var ee="";U=Math.min(N.length,U);for(var j=B;j<U;++j)ee+=String.fromCharCode(N[j]);return ee}function A(N,B,U){var ee=N.length;(!B||B<0)&&(B=0),(!U||U<0||U>ee)&&(U=ee);for(var j="",Q=B;Q<U;++Q)j+=V(N[Q]);return j}function I(N,B,U){for(var ee=N.slice(B,U),j="",Q=0;Q<ee.length;Q+=2)j+=String.fromCharCode(ee[Q]+256*ee[Q+1]);return j}function P(N,B,U){if(N%1!=0||N<0)throw new RangeError("offset is not uint");if(N+B>U)throw new RangeError("Trying to access beyond buffer length")}function S(N,B,U,ee,j,Q){if(!e.isBuffer(N))throw new TypeError('"buffer" argument must be a Buffer instance');if(B>j||B<Q)throw new RangeError('"value" argument is out of bounds');if(U+ee>N.length)throw new RangeError("Index out of range")}function E(N,B,U,ee,j,Q){if(U+ee>N.length)throw new RangeError("Index out of range");if(U<0)throw new RangeError("Index out of range")}function D(N,B,U,ee,j){return B=+B,U>>>=0,j||E(N,0,U,4),b.write(N,B,U,ee,23,4),U+4}function R(N,B,U,ee,j){return B=+B,U>>>=0,j||E(N,0,U,8),b.write(N,B,U,ee,52,8),U+8}e.prototype.slice=function(N,B){var U=this.length;(N=~~N)<0?(N+=U)<0&&(N=0):N>U&&(N=U),(B=B===void 0?U:~~B)<0?(B+=U)<0&&(B=0):B>U&&(B=U),B<N&&(B=N);var ee=this.subarray(N,B);return ee.__proto__=e.prototype,ee},e.prototype.readUIntLE=function(N,B,U){N>>>=0,B>>>=0,U||P(N,B,this.length);for(var ee=this[N],j=1,Q=0;++Q<B&&(j*=256);)ee+=this[N+Q]*j;return ee},e.prototype.readUIntBE=function(N,B,U){N>>>=0,B>>>=0,U||P(N,B,this.length);for(var ee=this[N+--B],j=1;B>0&&(j*=256);)ee+=this[N+--B]*j;return ee},e.prototype.readUInt8=function(N,B){return N>>>=0,B||P(N,1,this.length),this[N]},e.prototype.readUInt16LE=function(N,B){return N>>>=0,B||P(N,2,this.length),this[N]|this[N+1]<<8},e.prototype.readUInt16BE=function(N,B){return N>>>=0,B||P(N,2,this.length),this[N]<<8|this[N+1]},e.prototype.readUInt32LE=function(N,B){return N>>>=0,B||P(N,4,this.length),(this[N]|this[N+1]<<8|this[N+2]<<16)+16777216*this[N+3]},e.prototype.readUInt32BE=function(N,B){return N>>>=0,B||P(N,4,this.length),16777216*this[N]+(this[N+1]<<16|this[N+2]<<8|this[N+3])},e.prototype.readIntLE=function(N,B,U){N>>>=0,B>>>=0,U||P(N,B,this.length);for(var ee=this[N],j=1,Q=0;++Q<B&&(j*=256);)ee+=this[N+Q]*j;return ee>=(j*=128)&&(ee-=Math.pow(2,8*B)),ee},e.prototype.readIntBE=function(N,B,U){N>>>=0,B>>>=0,U||P(N,B,this.length);for(var ee=B,j=1,Q=this[N+--ee];ee>0&&(j*=256);)Q+=this[N+--ee]*j;return Q>=(j*=128)&&(Q-=Math.pow(2,8*B)),Q},e.prototype.readInt8=function(N,B){return N>>>=0,B||P(N,1,this.length),128&this[N]?-1*(255-this[N]+1):this[N]},e.prototype.readInt16LE=function(N,B){N>>>=0,B||P(N,2,this.length);var U=this[N]|this[N+1]<<8;return 32768&U?4294901760|U:U},e.prototype.readInt16BE=function(N,B){N>>>=0,B||P(N,2,this.length);var U=this[N+1]|this[N]<<8;return 32768&U?4294901760|U:U},e.prototype.readInt32LE=function(N,B){return N>>>=0,B||P(N,4,this.length),this[N]|this[N+1]<<8|this[N+2]<<16|this[N+3]<<24},e.prototype.readInt32BE=function(N,B){return N>>>=0,B||P(N,4,this.length),this[N]<<24|this[N+1]<<16|this[N+2]<<8|this[N+3]},e.prototype.readFloatLE=function(N,B){return N>>>=0,B||P(N,4,this.length),b.read(this,N,!0,23,4)},e.prototype.readFloatBE=function(N,B){return N>>>=0,B||P(N,4,this.length),b.read(this,N,!1,23,4)},e.prototype.readDoubleLE=function(N,B){return N>>>=0,B||P(N,8,this.length),b.read(this,N,!0,52,8)},e.prototype.readDoubleBE=function(N,B){return N>>>=0,B||P(N,8,this.length),b.read(this,N,!1,52,8)},e.prototype.writeUIntLE=function(N,B,U,ee){N=+N,B>>>=0,U>>>=0,ee||S(this,N,B,U,Math.pow(2,8*U)-1,0);var j=1,Q=0;for(this[B]=255&N;++Q<U&&(j*=256);)this[B+Q]=N/j&255;return B+U},e.prototype.writeUIntBE=function(N,B,U,ee){N=+N,B>>>=0,U>>>=0,ee||S(this,N,B,U,Math.pow(2,8*U)-1,0);var j=U-1,Q=1;for(this[B+j]=255&N;--j>=0&&(Q*=256);)this[B+j]=N/Q&255;return B+U},e.prototype.writeUInt8=function(N,B,U){return N=+N,B>>>=0,U||S(this,N,B,1,255,0),this[B]=255&N,B+1},e.prototype.writeUInt16LE=function(N,B,U){return N=+N,B>>>=0,U||S(this,N,B,2,65535,0),this[B]=255&N,this[B+1]=N>>>8,B+2},e.prototype.writeUInt16BE=function(N,B,U){return N=+N,B>>>=0,U||S(this,N,B,2,65535,0),this[B]=N>>>8,this[B+1]=255&N,B+2},e.prototype.writeUInt32LE=function(N,B,U){return N=+N,B>>>=0,U||S(this,N,B,4,4294967295,0),this[B+3]=N>>>24,this[B+2]=N>>>16,this[B+1]=N>>>8,this[B]=255&N,B+4},e.prototype.writeUInt32BE=function(N,B,U){return N=+N,B>>>=0,U||S(this,N,B,4,4294967295,0),this[B]=N>>>24,this[B+1]=N>>>16,this[B+2]=N>>>8,this[B+3]=255&N,B+4},e.prototype.writeIntLE=function(N,B,U,ee){if(N=+N,B>>>=0,!ee){var j=Math.pow(2,8*U-1);S(this,N,B,U,j-1,-j)}var Q=0,K=1,re=0;for(this[B]=255&N;++Q<U&&(K*=256);)N<0&&re===0&&this[B+Q-1]!==0&&(re=1),this[B+Q]=(N/K>>0)-re&255;return B+U},e.prototype.writeIntBE=function(N,B,U,ee){if(N=+N,B>>>=0,!ee){var j=Math.pow(2,8*U-1);S(this,N,B,U,j-1,-j)}var Q=U-1,K=1,re=0;for(this[B+Q]=255&N;--Q>=0&&(K*=256);)N<0&&re===0&&this[B+Q+1]!==0&&(re=1),this[B+Q]=(N/K>>0)-re&255;return B+U},e.prototype.writeInt8=function(N,B,U){return N=+N,B>>>=0,U||S(this,N,B,1,127,-128),N<0&&(N=255+N+1),this[B]=255&N,B+1},e.prototype.writeInt16LE=function(N,B,U){return N=+N,B>>>=0,U||S(this,N,B,2,32767,-32768),this[B]=255&N,this[B+1]=N>>>8,B+2},e.prototype.writeInt16BE=function(N,B,U){return N=+N,B>>>=0,U||S(this,N,B,2,32767,-32768),this[B]=N>>>8,this[B+1]=255&N,B+2},e.prototype.writeInt32LE=function(N,B,U){return N=+N,B>>>=0,U||S(this,N,B,4,2147483647,-2147483648),this[B]=255&N,this[B+1]=N>>>8,this[B+2]=N>>>16,this[B+3]=N>>>24,B+4},e.prototype.writeInt32BE=function(N,B,U){return N=+N,B>>>=0,U||S(this,N,B,4,2147483647,-2147483648),N<0&&(N=4294967295+N+1),this[B]=N>>>24,this[B+1]=N>>>16,this[B+2]=N>>>8,this[B+3]=255&N,B+4},e.prototype.writeFloatLE=function(N,B,U){return D(this,N,B,!0,U)},e.prototype.writeFloatBE=function(N,B,U){return D(this,N,B,!1,U)},e.prototype.writeDoubleLE=function(N,B,U){return R(this,N,B,!0,U)},e.prototype.writeDoubleBE=function(N,B,U){return R(this,N,B,!1,U)},e.prototype.copy=function(N,B,U,ee){if(!e.isBuffer(N))throw new TypeError("argument should be a Buffer");if(U||(U=0),ee||ee===0||(ee=this.length),B>=N.length&&(B=N.length),B||(B=0),ee>0&&ee<U&&(ee=U),ee===U||N.length===0||this.length===0)return 0;if(B<0)throw new RangeError("targetStart out of bounds");if(U<0||U>=this.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("sourceEnd out of bounds");ee>this.length&&(ee=this.length),N.length-B<ee-U&&(ee=N.length-B+U);var j=ee-U;if(this===N&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(B,U,ee);else if(this===N&&U<B&&B<ee)for(var Q=j-1;Q>=0;--Q)N[Q+B]=this[Q+U];else Uint8Array.prototype.set.call(N,this.subarray(U,ee),B);return j},e.prototype.fill=function(N,B,U,ee){if(typeof N=="string"){if(typeof B=="string"?(ee=B,B=0,U=this.length):typeof U=="string"&&(ee=U,U=this.length),ee!==void 0&&typeof ee!="string")throw new TypeError("encoding must be a string");if(typeof ee=="string"&&!e.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee);if(N.length===1){var j=N.charCodeAt(0);(ee==="utf8"&&j<128||ee==="latin1")&&(N=j)}}else typeof N=="number"&&(N&=255);if(B<0||this.length<B||this.length<U)throw new RangeError("Out of range index");if(U<=B)return this;var Q;if(B>>>=0,U=U===void 0?this.length:U>>>0,N||(N=0),typeof N=="number")for(Q=B;Q<U;++Q)this[Q]=N;else{var K=e.isBuffer(N)?N:e.from(N,ee),re=K.length;if(re===0)throw new TypeError('The value "'+N+'" is invalid for argument "value"');for(Q=0;Q<U-B;++Q)this[Q+B]=K[Q%re]}return this};var H=/[^+/0-9A-Za-z-_]/g;function V(N){return N<16?"0"+N.toString(16):N.toString(16)}function X(N,B){var U;B=B||1/0;for(var ee=N.length,j=null,Q=[],K=0;K<ee;++K){if((U=N.charCodeAt(K))>55295&&U<57344){if(!j){if(U>56319){(B-=3)>-1&&Q.push(239,191,189);continue}if(K+1===ee){(B-=3)>-1&&Q.push(239,191,189);continue}j=U;continue}if(U<56320){(B-=3)>-1&&Q.push(239,191,189),j=U;continue}U=65536+(j-55296<<10|U-56320)}else j&&(B-=3)>-1&&Q.push(239,191,189);if(j=null,U<128){if((B-=1)<0)break;Q.push(U)}else if(U<2048){if((B-=2)<0)break;Q.push(U>>6|192,63&U|128)}else if(U<65536){if((B-=3)<0)break;Q.push(U>>12|224,U>>6&63|128,63&U|128)}else{if(!(U<1114112))throw new Error("Invalid code point");if((B-=4)<0)break;Q.push(U>>18|240,U>>12&63|128,U>>6&63|128,63&U|128)}}return Q}function $(N){return g.toByteArray(function(B){if((B=(B=B.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;B.length%4!=0;)B+="=";return B}(N))}function G(N,B,U,ee){for(var j=0;j<ee&&!(j+U>=B.length||j>=N.length);++j)B[j+U]=N[j];return j}function W(N,B){return N instanceof B||N!=null&&N.constructor!=null&&N.constructor.name!=null&&N.constructor.name===B.name}function te(N){return N!=N}}).call(this)}).call(this,v("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(v,J,Z){J.exports=function(p,g,b){return g<b?p<g?g:p>b?b:p:p<b?b:p>g?g:p}},{}],87:[function(v,J,Z){var p=v("clamp");function g(b,y){y==null&&(y=!0);var e=b[0],n=b[1],t=b[2],a=b[3];return a==null&&(a=y?1:255),y&&(e*=255,n*=255,t*=255,a*=255),16777216*(e=255&p(e,0,255))+((n=255&p(n,0,255))<<16)+((t=255&p(t,0,255))<<8)+(a=255&p(a,0,255))}J.exports=g,J.exports.to=g,J.exports.from=function(b,y){var e=(b=+b)>>>24,n=(16711680&b)>>>16,t=(65280&b)>>>8,a=255&b;return y===!1?[e,n,t,a]:[e/255,n/255,t/255,a/255]}},{clamp:86}],88:[function(v,J,Z){J.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(v,J,Z){var p=v("color-rgba"),g=v("clamp"),b=v("dtype");J.exports=function(y,e){e!=="float"&&e||(e="array"),e==="uint"&&(e="uint8"),e==="uint_clamped"&&(e="uint8_clamped");var n=new(b(e))(4),t=e!=="uint8"&&e!=="uint8_clamped";return y.length&&typeof y!="string"||((y=p(y))[0]/=255,y[1]/=255,y[2]/=255),function(a){return a instanceof Uint8Array||a instanceof Uint8ClampedArray||!!(Array.isArray(a)&&(a[0]>1||a[0]===0)&&(a[1]>1||a[1]===0)&&(a[2]>1||a[2]===0)&&(!a[3]||a[3]>1))}(y)?(n[0]=y[0],n[1]=y[1],n[2]=y[2],n[3]=y[3]!=null?y[3]:255,t&&(n[0]/=255,n[1]/=255,n[2]/=255,n[3]/=255),n):(t?(n[0]=y[0],n[1]=y[1],n[2]=y[2],n[3]=y[3]!=null?y[3]:1):(n[0]=g(Math.floor(255*y[0]),0,255),n[1]=g(Math.floor(255*y[1]),0,255),n[2]=g(Math.floor(255*y[2]),0,255),n[3]=y[3]==null?255:g(Math.floor(255*y[3]),0,255)),n)}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(v,J,Z){(function(p){(function(){var g=v("color-name"),b=v("is-plain-obj"),y=v("defined");J.exports=function(n){var t,a,r=[],m=1;if(typeof n=="string")if(g[n])r=g[n].slice(),a="rgb";else if(n==="transparent")m=0,a="rgb",r=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(n)){var o=(f=n.slice(1)).length;m=1,o<=4?(r=[parseInt(f[0]+f[0],16),parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16)],o===4&&(m=parseInt(f[3]+f[3],16)/255)):(r=[parseInt(f[0]+f[1],16),parseInt(f[2]+f[3],16),parseInt(f[4]+f[5],16)],o===8&&(m=parseInt(f[6]+f[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),a="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(n)){var i=t[1],u=i==="rgb",f=i.replace(/a$/,"");a=f,o=f==="cmyk"?4:f==="gray"?1:3,r=t[2].trim().split(/\s*,\s*/).map(function(h,d){if(/%$/.test(h))return d===o?parseFloat(h)/100:f==="rgb"?255*parseFloat(h)/100:parseFloat(h);if(f[d]==="h"){if(/deg$/.test(h))return parseFloat(h);if(e[h]!==void 0)return e[h]}return parseFloat(h)}),i===f&&r.push(1),m=u||r[o]===void 0?1:r[o],r=r.slice(0,o)}else n.length>10&&/[0-9](?:\s|\/)/.test(n)&&(r=n.match(/([0-9]+)/g).map(function(h){return parseFloat(h)}),a=n.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(n))if(b(n)){var l=y(n.r,n.red,n.R,null);l!==null?(a="rgb",r=[l,y(n.g,n.green,n.G),y(n.b,n.blue,n.B)]):(a="hsl",r=[y(n.h,n.hue,n.H),y(n.s,n.saturation,n.S),y(n.l,n.lightness,n.L,n.b,n.brightness)]),m=y(n.a,n.alpha,n.opacity,1),n.opacity!=null&&(m/=100)}else(Array.isArray(n)||p.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(n))&&(r=[n[0],n[1],n[2]],a="rgb",m=n.length===4?n[3]:1);else a="rgb",r=[n>>>16,(65280&n)>>>8,255&n];return{space:a,values:r,alpha:m}};var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(v,J,Z){var p=v("color-parse"),g=v("color-space/hsl"),b=v("clamp");J.exports=function(y){var e,n=p(y);return n.space?((e=Array(3))[0]=b(n.values[0],0,255),e[1]=b(n.values[1],0,255),e[2]=b(n.values[2],0,255),n.space[0]==="h"&&(e=g.rgb(e)),e.push(b(n.alpha,0,1)),e):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(v,J,Z){var p=v("./rgb");J.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(g){var b,y,e,n,t,a=g[0]/360,r=g[1]/100,m=g[2]/100;if(r===0)return[t=255*m,t,t];b=2*m-(y=m<.5?m*(1+r):m+r-m*r),n=[0,0,0];for(var o=0;o<3;o++)(e=a+1/3*-(o-1))<0?e++:e>1&&e--,t=6*e<1?b+6*(y-b)*e:2*e<1?y:3*e<2?b+(y-b)*(2/3-e)*6:b,n[o]=255*t;return n}},p.hsl=function(g){var b,y,e=g[0]/255,n=g[1]/255,t=g[2]/255,a=Math.min(e,n,t),r=Math.max(e,n,t),m=r-a;return r===a?b=0:e===r?b=(n-t)/m:n===r?b=2+(t-e)/m:t===r&&(b=4+(e-n)/m),(b=Math.min(60*b,360))<0&&(b+=360),y=(a+r)/2,[b,100*(r===a?0:y<=.5?m/(r+a):m/(2-r-a)),100*y]}},{"./rgb":93}],93:[function(v,J,Z){J.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(v,J,Z){J.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(v,J,Z){J.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(v,J,Z){J.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(v,J,Z){J.exports=["normal","italic","oblique"]},{}],98:[function(v,J,Z){J.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(v,J,Z){J.exports={parse:v("./parse"),stringify:v("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(v,J,Z){var p=v("css-font-size-keywords");J.exports={isSize:function(g){return/^[\d\.]/.test(g)||g.indexOf("/")!==-1||p.indexOf(g)!==-1}}},{"css-font-size-keywords":95}],101:[function(v,J,Z){var p=v("unquote"),g=v("css-global-keywords"),b=v("css-system-font-keywords"),y=v("css-font-weight-keywords"),e=v("css-font-style-keywords"),n=v("css-font-stretch-keywords"),t=v("string-split-by"),a=v("./lib/util").isSize;J.exports=m;var r=m.cache={};function m(i){if(typeof i!="string")throw new Error("Font argument must be a string.");if(r[i])return r[i];if(i==="")throw new Error("Cannot parse an empty string.");if(b.indexOf(i)!==-1)return r[i]={system:i};for(var u,f={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},l=t(i,/\s+/);u=l.shift();){if(g.indexOf(u)!==-1)return["style","variant","weight","stretch"].forEach(function(d){f[d]=u}),r[i]=f;if(e.indexOf(u)===-1)if(u!=="normal"&&u!=="small-caps")if(n.indexOf(u)===-1){if(y.indexOf(u)===-1){if(a(u)){var h=t(u,"/");if(f.size=h[0],h[1]!=null?f.lineHeight=o(h[1]):l[0]==="/"&&(l.shift(),f.lineHeight=o(l.shift())),!l.length)throw new Error("Missing required font-family.");return f.family=t(l.join(" "),/\s*,\s*/).map(p),r[i]=f}throw new Error("Unknown or unsupported font token: "+u)}f.weight=u}else f.stretch=u;else f.variant=u;else f.style=u}throw new Error("Missing required font-size.")}function o(i){var u=parseFloat(i);return u.toString()===i?u:i}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":306,unquote:329}],102:[function(v,J,Z){var p=v("pick-by-alias"),g=v("./lib/util").isSize,b=u(v("css-global-keywords")),y=u(v("css-system-font-keywords")),e=u(v("css-font-weight-keywords")),n=u(v("css-font-style-keywords")),t=u(v("css-font-stretch-keywords")),a={normal:1,"small-caps":1},r={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},m="1rem",o="serif";function i(f,l){if(f&&!l[f]&&!b[f])throw Error("Unknown keyword `"+f+"`");return f}function u(f){for(var l={},h=0;h<f.length;h++)l[f[h]]=1;return l}J.exports=function(f){if((f=p(f,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return f.system&&i(f.system,y),f.system;if(i(f.style,n),i(f.variant,a),i(f.weight,e),i(f.stretch,t),f.size==null&&(f.size=m),typeof f.size=="number"&&(f.size+="px"),!g)throw Error("Bad size value `"+f.size+"`");f.family||(f.family=o),Array.isArray(f.family)&&(f.family.length||(f.family=[o]),f.family=f.family.map(function(h){return r[h]?h:'"'+h+'"'}).join(", "));var l=[];return l.push(f.style),f.variant!==f.style&&l.push(f.variant),f.weight!==f.variant&&f.weight!==f.style&&l.push(f.weight),f.stretch!==f.weight&&f.stretch!==f.variant&&f.stretch!==f.style&&l.push(f.stretch),l.push(f.size+(f.lineHeight==null||f.lineHeight==="normal"||f.lineHeight+""=="1"?"":"/"+f.lineHeight)),l.push(f.family),l.filter(Boolean).join(" ")}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(v,J,Z){J.exports=["inherit","initial","unset"]},{}],104:[function(v,J,Z){J.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(v,J,Z){var p,g=v("type/value/is"),b=v("type/value/ensure"),y=v("type/plain-function/ensure"),e=v("es5-ext/object/copy"),n=v("es5-ext/object/normalize-options"),t=v("es5-ext/object/map"),a=Function.prototype.bind,r=Object.defineProperty,m=Object.prototype.hasOwnProperty;p=function(o,i,u){var f,l=b(i)&&y(i.value);return delete(f=e(i)).writable,delete f.value,f.get=function(){return!u.overwriteDefinition&&m.call(this,o)?l:(i.value=a.call(l,u.resolveContext?u.resolveContext(this):this),r(this,o,i),this[o])},f},J.exports=function(o){var i=n(arguments[1]);return g(i.resolveContext)&&y(i.resolveContext),t(o,function(u,f){return p(f,u,i)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":322,"type/value/ensure":326,"type/value/is":327}],106:[function(v,J,Z){var p=v("type/value/is"),g=v("type/plain-function/is"),b=v("es5-ext/object/assign"),y=v("es5-ext/object/normalize-options"),e=v("es5-ext/string/#/contains");(J.exports=function(n,t){var a,r,m,o,i;return arguments.length<2||typeof n!="string"?(o=t,t=n,n=null):o=arguments[2],p(n)?(a=e.call(n,"c"),r=e.call(n,"e"),m=e.call(n,"w")):(a=m=!0,r=!1),i={value:t,configurable:a,enumerable:r,writable:m},o?b(y(o),i):i}).gs=function(n,t,a){var r,m,o,i;return typeof n!="string"?(o=a,a=t,t=n,n=null):o=arguments[3],p(t)?g(t)?p(a)?g(a)||(o=a,a=void 0):a=void 0:(o=t,t=a=void 0):t=void 0,p(n)?(r=e.call(n,"c"),m=e.call(n,"e")):(r=!0,m=!1),i={get:t,set:a,configurable:r,enumerable:m},o?b(y(o),i):i}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":323,"type/value/is":327}],107:[function(v,J,Z){(function(p,g){g(typeof Z=="object"&&J!==void 0?Z:p.d3=p.d3||{})})(this,function(p){function g(P,S){return P<S?-1:P>S?1:P>=S?0:NaN}function b(P){var S;return P.length===1&&(S=P,P=function(E,D){return g(S(E),D)}),{left:function(E,D,R,H){for(R==null&&(R=0),H==null&&(H=E.length);R<H;){var V=R+H>>>1;P(E[V],D)<0?R=V+1:H=V}return R},right:function(E,D,R,H){for(R==null&&(R=0),H==null&&(H=E.length);R<H;){var V=R+H>>>1;P(E[V],D)>0?H=V:R=V+1}return R}}}var y=b(g),e=y.right,n=y.left;function t(P,S){return[P,S]}function a(P){return P===null?NaN:+P}function r(P,S){var E,D,R=P.length,H=0,V=-1,X=0,$=0;if(S==null)for(;++V<R;)isNaN(E=a(P[V]))||($+=(D=E-X)*(E-(X+=D/++H)));else for(;++V<R;)isNaN(E=a(S(P[V],V,P)))||($+=(D=E-X)*(E-(X+=D/++H)));if(H>1)return $/(H-1)}function m(P,S){var E=r(P,S);return E&&Math.sqrt(E)}function o(P,S){var E,D,R,H=P.length,V=-1;if(S==null){for(;++V<H;)if((E=P[V])!=null&&E>=E)for(D=R=E;++V<H;)(E=P[V])!=null&&(D>E&&(D=E),R<E&&(R=E))}else for(;++V<H;)if((E=S(P[V],V,P))!=null&&E>=E)for(D=R=E;++V<H;)(E=S(P[V],V,P))!=null&&(D>E&&(D=E),R<E&&(R=E));return[D,R]}var i=Array.prototype,u=i.slice,f=i.map;function l(P){return function(){return P}}function h(P){return P}function d(P,S,E){P=+P,S=+S,E=(R=arguments.length)<2?(S=P,P=0,1):R<3?1:+E;for(var D=-1,R=0|Math.max(0,Math.ceil((S-P)/E)),H=new Array(R);++D<R;)H[D]=P+D*E;return H}var s=Math.sqrt(50),x=Math.sqrt(10),c=Math.sqrt(2);function T(P,S,E){var D=(S-P)/Math.max(0,E),R=Math.floor(Math.log(D)/Math.LN10),H=D/Math.pow(10,R);return R>=0?(H>=s?10:H>=x?5:H>=c?2:1)*Math.pow(10,R):-Math.pow(10,-R)/(H>=s?10:H>=x?5:H>=c?2:1)}function _(P,S,E){var D=Math.abs(S-P)/Math.max(0,E),R=Math.pow(10,Math.floor(Math.log(D)/Math.LN10)),H=D/R;return H>=s?R*=10:H>=x?R*=5:H>=c&&(R*=2),S<P?-R:R}function w(P){return Math.ceil(Math.log(P.length)/Math.LN2)+1}function k(P,S,E){if(E==null&&(E=a),D=P.length){if((S=+S)<=0||D<2)return+E(P[0],0,P);if(S>=1)return+E(P[D-1],D-1,P);var D,R=(D-1)*S,H=Math.floor(R),V=+E(P[H],H,P);return V+(+E(P[H+1],H+1,P)-V)*(R-H)}}function L(P,S){var E,D,R=P.length,H=-1;if(S==null){for(;++H<R;)if((E=P[H])!=null&&E>=E)for(D=E;++H<R;)(E=P[H])!=null&&D>E&&(D=E)}else for(;++H<R;)if((E=S(P[H],H,P))!=null&&E>=E)for(D=E;++H<R;)(E=S(P[H],H,P))!=null&&D>E&&(D=E);return D}function A(P){if(!(R=P.length))return[];for(var S=-1,E=L(P,I),D=new Array(E);++S<E;)for(var R,H=-1,V=D[S]=new Array(R);++H<R;)V[H]=P[H][S];return D}function I(P){return P.length}p.bisect=e,p.bisectRight=e,p.bisectLeft=n,p.ascending=g,p.bisector=b,p.cross=function(P,S,E){var D,R,H,V,X=P.length,$=S.length,G=new Array(X*$);for(E==null&&(E=t),D=H=0;D<X;++D)for(V=P[D],R=0;R<$;++R,++H)G[H]=E(V,S[R]);return G},p.descending=function(P,S){return S<P?-1:S>P?1:S>=P?0:NaN},p.deviation=m,p.extent=o,p.histogram=function(){var P=h,S=o,E=w;function D(R){var H,V,X=R.length,$=new Array(X);for(H=0;H<X;++H)$[H]=P(R[H],H,R);var G=S($),W=G[0],te=G[1],N=E($,W,te);Array.isArray(N)||(N=_(W,te,N),N=d(Math.ceil(W/N)*N,te,N));for(var B=N.length;N[0]<=W;)N.shift(),--B;for(;N[B-1]>te;)N.pop(),--B;var U,ee=new Array(B+1);for(H=0;H<=B;++H)(U=ee[H]=[]).x0=H>0?N[H-1]:W,U.x1=H<B?N[H]:te;for(H=0;H<X;++H)W<=(V=$[H])&&V<=te&&ee[e(N,V,0,B)].push(R[H]);return ee}return D.value=function(R){return arguments.length?(P=typeof R=="function"?R:l(R),D):P},D.domain=function(R){return arguments.length?(S=typeof R=="function"?R:l([R[0],R[1]]),D):S},D.thresholds=function(R){return arguments.length?(E=typeof R=="function"?R:Array.isArray(R)?l(u.call(R)):l(R),D):E},D},p.thresholdFreedmanDiaconis=function(P,S,E){return P=f.call(P,a).sort(g),Math.ceil((E-S)/(2*(k(P,.75)-k(P,.25))*Math.pow(P.length,-1/3)))},p.thresholdScott=function(P,S,E){return Math.ceil((E-S)/(3.5*m(P)*Math.pow(P.length,-1/3)))},p.thresholdSturges=w,p.max=function(P,S){var E,D,R=P.length,H=-1;if(S==null){for(;++H<R;)if((E=P[H])!=null&&E>=E)for(D=E;++H<R;)(E=P[H])!=null&&E>D&&(D=E)}else for(;++H<R;)if((E=S(P[H],H,P))!=null&&E>=E)for(D=E;++H<R;)(E=S(P[H],H,P))!=null&&E>D&&(D=E);return D},p.mean=function(P,S){var E,D=P.length,R=D,H=-1,V=0;if(S==null)for(;++H<D;)isNaN(E=a(P[H]))?--R:V+=E;else for(;++H<D;)isNaN(E=a(S(P[H],H,P)))?--R:V+=E;if(R)return V/R},p.median=function(P,S){var E,D=P.length,R=-1,H=[];if(S==null)for(;++R<D;)isNaN(E=a(P[R]))||H.push(E);else for(;++R<D;)isNaN(E=a(S(P[R],R,P)))||H.push(E);return k(H.sort(g),.5)},p.merge=function(P){for(var S,E,D,R=P.length,H=-1,V=0;++H<R;)V+=P[H].length;for(E=new Array(V);--R>=0;)for(S=(D=P[R]).length;--S>=0;)E[--V]=D[S];return E},p.min=L,p.pairs=function(P,S){S==null&&(S=t);for(var E=0,D=P.length-1,R=P[0],H=new Array(D<0?0:D);E<D;)H[E]=S(R,R=P[++E]);return H},p.permute=function(P,S){for(var E=S.length,D=new Array(E);E--;)D[E]=P[S[E]];return D},p.quantile=k,p.range=d,p.scan=function(P,S){if(E=P.length){var E,D,R=0,H=0,V=P[H];for(S==null&&(S=g);++R<E;)(S(D=P[R],V)<0||S(V,V)!==0)&&(V=D,H=R);return S(V,V)===0?H:void 0}},p.shuffle=function(P,S,E){for(var D,R,H=(E==null?P.length:E)-(S=S==null?0:+S);H;)R=Math.random()*H--|0,D=P[H+S],P[H+S]=P[R+S],P[R+S]=D;return P},p.sum=function(P,S){var E,D=P.length,R=-1,H=0;if(S==null)for(;++R<D;)(E=+P[R])&&(H+=E);else for(;++R<D;)(E=+S(P[R],R,P))&&(H+=E);return H},p.ticks=function(P,S,E){var D,R,H,V,X=-1;if(E=+E,(P=+P)==(S=+S)&&E>0)return[P];if((D=S<P)&&(R=P,P=S,S=R),(V=T(P,S,E))===0||!isFinite(V))return[];if(V>0)for(P=Math.ceil(P/V),S=Math.floor(S/V),H=new Array(R=Math.ceil(S-P+1));++X<R;)H[X]=(P+X)*V;else for(P=Math.floor(P*V),S=Math.ceil(S*V),H=new Array(R=Math.ceil(P-S+1));++X<R;)H[X]=(P-X)/V;return D&&H.reverse(),H},p.tickIncrement=T,p.tickStep=_,p.transpose=A,p.variance=r,p.zip=function(){return A(arguments)},Object.defineProperty(p,"__esModule",{value:!0})})},{}],108:[function(v,J,Z){(function(p,g){g(typeof Z=="object"&&J!==void 0?Z:p.d3=p.d3||{})})(this,function(p){function g(){}function b(o,i){var u=new g;if(o instanceof g)o.each(function(s,x){u.set(x,s)});else if(Array.isArray(o)){var f,l=-1,h=o.length;if(i==null)for(;++l<h;)u.set(l,o[l]);else for(;++l<h;)u.set(i(f=o[l],l,o),f)}else if(o)for(var d in o)u.set(d,o[d]);return u}function y(){return{}}function e(o,i,u){o[i]=u}function n(){return b()}function t(o,i,u){o.set(i,u)}function a(){}g.prototype=b.prototype={constructor:g,has:function(o){return"$"+o in this},get:function(o){return this["$"+o]},set:function(o,i){return this["$"+o]=i,this},remove:function(o){var i="$"+o;return i in this&&delete this[i]},clear:function(){for(var o in this)o[0]==="$"&&delete this[o]},keys:function(){var o=[];for(var i in this)i[0]==="$"&&o.push(i.slice(1));return o},values:function(){var o=[];for(var i in this)i[0]==="$"&&o.push(this[i]);return o},entries:function(){var o=[];for(var i in this)i[0]==="$"&&o.push({key:i.slice(1),value:this[i]});return o},size:function(){var o=0;for(var i in this)i[0]==="$"&&++o;return o},empty:function(){for(var o in this)if(o[0]==="$")return!1;return!0},each:function(o){for(var i in this)i[0]==="$"&&o(this[i],i.slice(1),this)}};var r=b.prototype;function m(o,i){var u=new a;if(o instanceof a)o.each(function(h){u.add(h)});else if(o){var f=-1,l=o.length;if(i==null)for(;++f<l;)u.add(o[f]);else for(;++f<l;)u.add(i(o[f],f,o))}return u}a.prototype=m.prototype={constructor:a,has:r.has,add:function(o){return this["$"+(o+="")]=o,this},remove:r.remove,clear:r.clear,values:r.keys,size:r.size,empty:r.empty,each:r.each},p.nest=function(){var o,i,u,f=[],l=[];function h(d,s,x,c){if(s>=f.length)return o!=null&&d.sort(o),i!=null?i(d):d;for(var T,_,w,k=-1,L=d.length,A=f[s++],I=b(),P=x();++k<L;)(w=I.get(T=A(_=d[k])+""))?w.push(_):I.set(T,[_]);return I.each(function(S,E){c(P,E,h(S,s,x,c))}),P}return u={object:function(d){return h(d,0,y,e)},map:function(d){return h(d,0,n,t)},entries:function(d){return function s(x,c){if(++c>f.length)return x;var T,_=l[c-1];return i!=null&&c>=f.length?T=x.entries():(T=[],x.each(function(w,k){T.push({key:k,values:s(w,c)})})),_!=null?T.sort(function(w,k){return _(w.key,k.key)}):T}(h(d,0,n,t),0)},key:function(d){return f.push(d),u},sortKeys:function(d){return l[f.length-1]=d,u},sortValues:function(d){return o=d,u},rollup:function(d){return i=d,u}}},p.set=m,p.map=b,p.keys=function(o){var i=[];for(var u in o)i.push(u);return i},p.values=function(o){var i=[];for(var u in o)i.push(o[u]);return i},p.entries=function(o){var i=[];for(var u in o)i.push({key:u,value:o[u]});return i},Object.defineProperty(p,"__esModule",{value:!0})})},{}],109:[function(v,J,Z){(function(p,g){g(typeof Z=="object"&&J!==void 0?Z:(p=p||self).d3=p.d3||{})})(this,function(p){function g(fe,ve,Me){fe.prototype=ve.prototype=Me,Me.constructor=fe}function b(fe,ve){var Me=Object.create(fe.prototype);for(var ke in ve)Me[ke]=ve[ke];return Me}function y(){}var e="\\s*([+-]?\\d+)\\s*",n="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",a=/^#([0-9a-f]{3,8})$/,r=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),m=new RegExp("^rgb\\("+[t,t,t]+"\\)$"),o=new RegExp("^rgba\\("+[e,e,e,n]+"\\)$"),i=new RegExp("^rgba\\("+[t,t,t,n]+"\\)$"),u=new RegExp("^hsl\\("+[n,t,t]+"\\)$"),f=new RegExp("^hsla\\("+[n,t,t,n]+"\\)$"),l={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function h(){return this.rgb().formatHex()}function d(){return this.rgb().formatRgb()}function s(fe){var ve,Me;return fe=(fe+"").trim().toLowerCase(),(ve=a.exec(fe))?(Me=ve[1].length,ve=parseInt(ve[1],16),Me===6?x(ve):Me===3?new w(ve>>8&15|ve>>4&240,ve>>4&15|240&ve,(15&ve)<<4|15&ve,1):Me===8?c(ve>>24&255,ve>>16&255,ve>>8&255,(255&ve)/255):Me===4?c(ve>>12&15|ve>>8&240,ve>>8&15|ve>>4&240,ve>>4&15|240&ve,((15&ve)<<4|15&ve)/255):null):(ve=r.exec(fe))?new w(ve[1],ve[2],ve[3],1):(ve=m.exec(fe))?new w(255*ve[1]/100,255*ve[2]/100,255*ve[3]/100,1):(ve=o.exec(fe))?c(ve[1],ve[2],ve[3],ve[4]):(ve=i.exec(fe))?c(255*ve[1]/100,255*ve[2]/100,255*ve[3]/100,ve[4]):(ve=u.exec(fe))?I(ve[1],ve[2]/100,ve[3]/100,1):(ve=f.exec(fe))?I(ve[1],ve[2]/100,ve[3]/100,ve[4]):l.hasOwnProperty(fe)?x(l[fe]):fe==="transparent"?new w(NaN,NaN,NaN,0):null}function x(fe){return new w(fe>>16&255,fe>>8&255,255&fe,1)}function c(fe,ve,Me,ke){return ke<=0&&(fe=ve=Me=NaN),new w(fe,ve,Me,ke)}function T(fe){return fe instanceof y||(fe=s(fe)),fe?new w((fe=fe.rgb()).r,fe.g,fe.b,fe.opacity):new w}function _(fe,ve,Me,ke){return arguments.length===1?T(fe):new w(fe,ve,Me,ke==null?1:ke)}function w(fe,ve,Me,ke){this.r=+fe,this.g=+ve,this.b=+Me,this.opacity=+ke}function k(){return"#"+A(this.r)+A(this.g)+A(this.b)}function L(){var fe=this.opacity;return((fe=isNaN(fe)?1:Math.max(0,Math.min(1,fe)))===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(fe===1?")":", "+fe+")")}function A(fe){return((fe=Math.max(0,Math.min(255,Math.round(fe)||0)))<16?"0":"")+fe.toString(16)}function I(fe,ve,Me,ke){return ke<=0?fe=ve=Me=NaN:Me<=0||Me>=1?fe=ve=NaN:ve<=0&&(fe=NaN),new E(fe,ve,Me,ke)}function P(fe){if(fe instanceof E)return new E(fe.h,fe.s,fe.l,fe.opacity);if(fe instanceof y||(fe=s(fe)),!fe)return new E;if(fe instanceof E)return fe;var ve=(fe=fe.rgb()).r/255,Me=fe.g/255,ke=fe.b/255,Le=Math.min(ve,Me,ke),ze=Math.max(ve,Me,ke),Re=NaN,Oe=ze-Le,Ze=(ze+Le)/2;return Oe?(Re=ve===ze?(Me-ke)/Oe+6*(Me<ke):Me===ze?(ke-ve)/Oe+2:(ve-Me)/Oe+4,Oe/=Ze<.5?ze+Le:2-ze-Le,Re*=60):Oe=Ze>0&&Ze<1?0:Re,new E(Re,Oe,Ze,fe.opacity)}function S(fe,ve,Me,ke){return arguments.length===1?P(fe):new E(fe,ve,Me,ke==null?1:ke)}function E(fe,ve,Me,ke){this.h=+fe,this.s=+ve,this.l=+Me,this.opacity=+ke}function D(fe,ve,Me){return 255*(fe<60?ve+(Me-ve)*fe/60:fe<180?Me:fe<240?ve+(Me-ve)*(240-fe)/60:ve)}g(y,s,{copy:function(fe){return Object.assign(new this.constructor,this,fe)},displayable:function(){return this.rgb().displayable()},hex:h,formatHex:h,formatHsl:function(){return P(this).formatHsl()},formatRgb:d,toString:d}),g(w,_,b(y,{brighter:function(fe){return fe=fe==null?1/.7:Math.pow(1/.7,fe),new w(this.r*fe,this.g*fe,this.b*fe,this.opacity)},darker:function(fe){return fe=fe==null?.7:Math.pow(.7,fe),new w(this.r*fe,this.g*fe,this.b*fe,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:k,formatHex:k,formatRgb:L,toString:L})),g(E,S,b(y,{brighter:function(fe){return fe=fe==null?1/.7:Math.pow(1/.7,fe),new E(this.h,this.s,this.l*fe,this.opacity)},darker:function(fe){return fe=fe==null?.7:Math.pow(.7,fe),new E(this.h,this.s,this.l*fe,this.opacity)},rgb:function(){var fe=this.h%360+360*(this.h<0),ve=isNaN(fe)||isNaN(this.s)?0:this.s,Me=this.l,ke=Me+(Me<.5?Me:1-Me)*ve,Le=2*Me-ke;return new w(D(fe>=240?fe-240:fe+120,Le,ke),D(fe,Le,ke),D(fe<120?fe+240:fe-120,Le,ke),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var fe=this.opacity;return((fe=isNaN(fe)?1:Math.max(0,Math.min(1,fe)))===1?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(fe===1?")":", "+fe+")")}}));var R=Math.PI/180,H=180/Math.PI,V=6/29,X=3*V*V;function $(fe){if(fe instanceof W)return new W(fe.l,fe.a,fe.b,fe.opacity);if(fe instanceof Q)return K(fe);fe instanceof w||(fe=T(fe));var ve,Me,ke=U(fe.r),Le=U(fe.g),ze=U(fe.b),Re=te((.2225045*ke+.7168786*Le+.0606169*ze)/1);return ke===Le&&Le===ze?ve=Me=Re:(ve=te((.4360747*ke+.3850649*Le+.1430804*ze)/.96422),Me=te((.0139322*ke+.0971045*Le+.7141733*ze)/.82521)),new W(116*Re-16,500*(ve-Re),200*(Re-Me),fe.opacity)}function G(fe,ve,Me,ke){return arguments.length===1?$(fe):new W(fe,ve,Me,ke==null?1:ke)}function W(fe,ve,Me,ke){this.l=+fe,this.a=+ve,this.b=+Me,this.opacity=+ke}function te(fe){return fe>.008856451679035631?Math.pow(fe,1/3):fe/X+4/29}function N(fe){return fe>V?fe*fe*fe:X*(fe-4/29)}function B(fe){return 255*(fe<=.0031308?12.92*fe:1.055*Math.pow(fe,1/2.4)-.055)}function U(fe){return(fe/=255)<=.04045?fe/12.92:Math.pow((fe+.055)/1.055,2.4)}function ee(fe){if(fe instanceof Q)return new Q(fe.h,fe.c,fe.l,fe.opacity);if(fe instanceof W||(fe=$(fe)),fe.a===0&&fe.b===0)return new Q(NaN,0<fe.l&&fe.l<100?0:NaN,fe.l,fe.opacity);var ve=Math.atan2(fe.b,fe.a)*H;return new Q(ve<0?ve+360:ve,Math.sqrt(fe.a*fe.a+fe.b*fe.b),fe.l,fe.opacity)}function j(fe,ve,Me,ke){return arguments.length===1?ee(fe):new Q(fe,ve,Me,ke==null?1:ke)}function Q(fe,ve,Me,ke){this.h=+fe,this.c=+ve,this.l=+Me,this.opacity=+ke}function K(fe){if(isNaN(fe.h))return new W(fe.l,0,0,fe.opacity);var ve=fe.h*R;return new W(fe.l,Math.cos(ve)*fe.c,Math.sin(ve)*fe.c,fe.opacity)}g(W,G,b(y,{brighter:function(fe){return new W(this.l+18*(fe==null?1:fe),this.a,this.b,this.opacity)},darker:function(fe){return new W(this.l-18*(fe==null?1:fe),this.a,this.b,this.opacity)},rgb:function(){var fe=(this.l+16)/116,ve=isNaN(this.a)?fe:fe+this.a/500,Me=isNaN(this.b)?fe:fe-this.b/200;return new w(B(3.1338561*(ve=.96422*N(ve))-1.6168667*(fe=1*N(fe))-.4906146*(Me=.82521*N(Me))),B(-.9787684*ve+1.9161415*fe+.033454*Me),B(.0719453*ve-.2289914*fe+1.4052427*Me),this.opacity)}})),g(Q,j,b(y,{brighter:function(fe){return new Q(this.h,this.c,this.l+18*(fe==null?1:fe),this.opacity)},darker:function(fe){return new Q(this.h,this.c,this.l-18*(fe==null?1:fe),this.opacity)},rgb:function(){return K(this).rgb()}}));var re=-.14861,ne=1.78277,le=-.29227,oe=-.90649,de=1.97294,se=de*oe,me=de*ne,Te=ne*le-oe*re;function _e(fe){if(fe instanceof Ce)return new Ce(fe.h,fe.s,fe.l,fe.opacity);fe instanceof w||(fe=T(fe));var ve=fe.r/255,Me=fe.g/255,ke=fe.b/255,Le=(Te*ke+se*ve-me*Me)/(Te+se-me),ze=ke-Le,Re=(de*(Me-Le)-le*ze)/oe,Oe=Math.sqrt(Re*Re+ze*ze)/(de*Le*(1-Le)),Ze=Oe?Math.atan2(Re,ze)*H-120:NaN;return new Ce(Ze<0?Ze+360:Ze,Oe,Le,fe.opacity)}function be(fe,ve,Me,ke){return arguments.length===1?_e(fe):new Ce(fe,ve,Me,ke==null?1:ke)}function Ce(fe,ve,Me,ke){this.h=+fe,this.s=+ve,this.l=+Me,this.opacity=+ke}g(Ce,be,b(y,{brighter:function(fe){return fe=fe==null?1/.7:Math.pow(1/.7,fe),new Ce(this.h,this.s,this.l*fe,this.opacity)},darker:function(fe){return fe=fe==null?.7:Math.pow(.7,fe),new Ce(this.h,this.s,this.l*fe,this.opacity)},rgb:function(){var fe=isNaN(this.h)?0:(this.h+120)*R,ve=+this.l,Me=isNaN(this.s)?0:this.s*ve*(1-ve),ke=Math.cos(fe),Le=Math.sin(fe);return new w(255*(ve+Me*(re*ke+ne*Le)),255*(ve+Me*(le*ke+oe*Le)),255*(ve+Me*(de*ke)),this.opacity)}})),p.color=s,p.cubehelix=be,p.gray=function(fe,ve){return new W(fe,0,0,ve==null?1:ve)},p.hcl=j,p.hsl=S,p.lab=G,p.lch=function(fe,ve,Me,ke){return arguments.length===1?ee(fe):new Q(Me,ve,fe,ke==null?1:ke)},p.rgb=_,Object.defineProperty(p,"__esModule",{value:!0})})},{}],110:[function(v,J,Z){(function(p,g){g(typeof Z=="object"&&J!==void 0?Z:(p=p||self).d3=p.d3||{})})(this,function(p){var g={value:function(){}};function b(){for(var a,r=0,m=arguments.length,o={};r<m;++r){if(!(a=arguments[r]+"")||a in o||/[\s.]/.test(a))throw new Error("illegal type: "+a);o[a]=[]}return new y(o)}function y(a){this._=a}function e(a,r){return a.trim().split(/^|\s+/).map(function(m){var o="",i=m.indexOf(".");if(i>=0&&(o=m.slice(i+1),m=m.slice(0,i)),m&&!r.hasOwnProperty(m))throw new Error("unknown type: "+m);return{type:m,name:o}})}function n(a,r){for(var m,o=0,i=a.length;o<i;++o)if((m=a[o]).name===r)return m.value}function t(a,r,m){for(var o=0,i=a.length;o<i;++o)if(a[o].name===r){a[o]=g,a=a.slice(0,o).concat(a.slice(o+1));break}return m!=null&&a.push({name:r,value:m}),a}y.prototype=b.prototype={constructor:y,on:function(a,r){var m,o=this._,i=e(a+"",o),u=-1,f=i.length;if(!(arguments.length<2)){if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++u<f;)if(m=(a=i[u]).type)o[m]=t(o[m],a.name,r);else if(r==null)for(m in o)o[m]=t(o[m],a.name,null);return this}for(;++u<f;)if((m=(a=i[u]).type)&&(m=n(o[m],a.name)))return m},copy:function(){var a={},r=this._;for(var m in r)a[m]=r[m].slice();return new y(a)},call:function(a,r){if((m=arguments.length-2)>0)for(var m,o,i=new Array(m),u=0;u<m;++u)i[u]=arguments[u+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(u=0,m=(o=this._[a]).length;u<m;++u)o[u].value.apply(r,i)},apply:function(a,r,m){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var o=this._[a],i=0,u=o.length;i<u;++i)o[i].value.apply(r,m)}},p.dispatch=b,Object.defineProperty(p,"__esModule",{value:!0})})},{}],111:[function(v,J,Z){(function(p,g){typeof Z=="object"&&J!==void 0?g(Z,v("d3-quadtree"),v("d3-collection"),v("d3-dispatch"),v("d3-timer")):g(p.d3=p.d3||{},p.d3,p.d3,p.d3,p.d3)})(this,function(p,g,b,y,e){function n(l){return function(){return l}}function t(){return 1e-6*(Math.random()-.5)}function a(l){return l.x+l.vx}function r(l){return l.y+l.vy}function m(l){return l.index}function o(l,h){var d=l.get(h);if(!d)throw new Error("missing: "+h);return d}function i(l){return l.x}function u(l){return l.y}var f=Math.PI*(3-Math.sqrt(5));p.forceCenter=function(l,h){var d;function s(){var x,c,T=d.length,_=0,w=0;for(x=0;x<T;++x)_+=(c=d[x]).x,w+=c.y;for(_=_/T-l,w=w/T-h,x=0;x<T;++x)(c=d[x]).x-=_,c.y-=w}return l==null&&(l=0),h==null&&(h=0),s.initialize=function(x){d=x},s.x=function(x){return arguments.length?(l=+x,s):l},s.y=function(x){return arguments.length?(h=+x,s):h},s},p.forceCollide=function(l){var h,d,s=1,x=1;function c(){for(var w,k,L,A,I,P,S,E=h.length,D=0;D<x;++D)for(k=g.quadtree(h,a,r).visitAfter(T),w=0;w<E;++w)L=h[w],P=d[L.index],S=P*P,A=L.x+L.vx,I=L.y+L.vy,k.visit(R);function R(H,V,X,$,G){var W=H.data,te=H.r,N=P+te;if(!W)return V>A+N||$<A-N||X>I+N||G<I-N;if(W.index>L.index){var B=A-W.x-W.vx,U=I-W.y-W.vy,ee=B*B+U*U;ee<N*N&&(B===0&&(ee+=(B=t())*B),U===0&&(ee+=(U=t())*U),ee=(N-(ee=Math.sqrt(ee)))/ee*s,L.vx+=(B*=ee)*(N=(te*=te)/(S+te)),L.vy+=(U*=ee)*N,W.vx-=B*(N=1-N),W.vy-=U*N)}}}function T(w){if(w.data)return w.r=d[w.data.index];for(var k=w.r=0;k<4;++k)w[k]&&w[k].r>w.r&&(w.r=w[k].r)}function _(){if(h){var w,k,L=h.length;for(d=new Array(L),w=0;w<L;++w)k=h[w],d[k.index]=+l(k,w,h)}}return typeof l!="function"&&(l=n(l==null?1:+l)),c.initialize=function(w){h=w,_()},c.iterations=function(w){return arguments.length?(x=+w,c):x},c.strength=function(w){return arguments.length?(s=+w,c):s},c.radius=function(w){return arguments.length?(l=typeof w=="function"?w:n(+w),_(),c):l},c},p.forceLink=function(l){var h,d,s,x,c,T=m,_=function(S){return 1/Math.min(x[S.source.index],x[S.target.index])},w=n(30),k=1;function L(S){for(var E=0,D=l.length;E<k;++E)for(var R,H,V,X,$,G,W,te=0;te<D;++te)H=(R=l[te]).source,X=(V=R.target).x+V.vx-H.x-H.vx||t(),$=V.y+V.vy-H.y-H.vy||t(),X*=G=((G=Math.sqrt(X*X+$*$))-d[te])/G*S*h[te],$*=G,V.vx-=X*(W=c[te]),V.vy-=$*W,H.vx+=X*(W=1-W),H.vy+=$*W}function A(){if(s){var S,E,D=s.length,R=l.length,H=b.map(s,T);for(S=0,x=new Array(D);S<R;++S)(E=l[S]).index=S,typeof E.source!="object"&&(E.source=o(H,E.source)),typeof E.target!="object"&&(E.target=o(H,E.target)),x[E.source.index]=(x[E.source.index]||0)+1,x[E.target.index]=(x[E.target.index]||0)+1;for(S=0,c=new Array(R);S<R;++S)E=l[S],c[S]=x[E.source.index]/(x[E.source.index]+x[E.target.index]);h=new Array(R),I(),d=new Array(R),P()}}function I(){if(s)for(var S=0,E=l.length;S<E;++S)h[S]=+_(l[S],S,l)}function P(){if(s)for(var S=0,E=l.length;S<E;++S)d[S]=+w(l[S],S,l)}return l==null&&(l=[]),L.initialize=function(S){s=S,A()},L.links=function(S){return arguments.length?(l=S,A(),L):l},L.id=function(S){return arguments.length?(T=S,L):T},L.iterations=function(S){return arguments.length?(k=+S,L):k},L.strength=function(S){return arguments.length?(_=typeof S=="function"?S:n(+S),I(),L):_},L.distance=function(S){return arguments.length?(w=typeof S=="function"?S:n(+S),P(),L):w},L},p.forceManyBody=function(){var l,h,d,s,x=n(-30),c=1,T=1/0,_=.81;function w(I){var P,S=l.length,E=g.quadtree(l,i,u).visitAfter(L);for(d=I,P=0;P<S;++P)h=l[P],E.visit(A)}function k(){if(l){var I,P,S=l.length;for(s=new Array(S),I=0;I<S;++I)P=l[I],s[P.index]=+x(P,I,l)}}function L(I){var P,S,E,D,R,H=0,V=0;if(I.length){for(E=D=R=0;R<4;++R)(P=I[R])&&(S=Math.abs(P.value))&&(H+=P.value,V+=S,E+=S*P.x,D+=S*P.y);I.x=E/V,I.y=D/V}else{(P=I).x=P.data.x,P.y=P.data.y;do H+=s[P.data.index];while(P=P.next)}I.value=H}function A(I,P,S,E){if(!I.value)return!0;var D=I.x-h.x,R=I.y-h.y,H=E-P,V=D*D+R*R;if(H*H/_<V)return V<T&&(D===0&&(V+=(D=t())*D),R===0&&(V+=(R=t())*R),V<c&&(V=Math.sqrt(c*V)),h.vx+=D*I.value*d/V,h.vy+=R*I.value*d/V),!0;if(!(I.length||V>=T)){(I.data!==h||I.next)&&(D===0&&(V+=(D=t())*D),R===0&&(V+=(R=t())*R),V<c&&(V=Math.sqrt(c*V)));do I.data!==h&&(H=s[I.data.index]*d/V,h.vx+=D*H,h.vy+=R*H);while(I=I.next)}}return w.initialize=function(I){l=I,k()},w.strength=function(I){return arguments.length?(x=typeof I=="function"?I:n(+I),k(),w):x},w.distanceMin=function(I){return arguments.length?(c=I*I,w):Math.sqrt(c)},w.distanceMax=function(I){return arguments.length?(T=I*I,w):Math.sqrt(T)},w.theta=function(I){return arguments.length?(_=I*I,w):Math.sqrt(_)},w},p.forceRadial=function(l,h,d){var s,x,c,T=n(.1);function _(k){for(var L=0,A=s.length;L<A;++L){var I=s[L],P=I.x-h||1e-6,S=I.y-d||1e-6,E=Math.sqrt(P*P+S*S),D=(c[L]-E)*x[L]*k/E;I.vx+=P*D,I.vy+=S*D}}function w(){if(s){var k,L=s.length;for(x=new Array(L),c=new Array(L),k=0;k<L;++k)c[k]=+l(s[k],k,s),x[k]=isNaN(c[k])?0:+T(s[k],k,s)}}return typeof l!="function"&&(l=n(+l)),h==null&&(h=0),d==null&&(d=0),_.initialize=function(k){s=k,w()},_.strength=function(k){return arguments.length?(T=typeof k=="function"?k:n(+k),w(),_):T},_.radius=function(k){return arguments.length?(l=typeof k=="function"?k:n(+k),w(),_):l},_.x=function(k){return arguments.length?(h=+k,_):h},_.y=function(k){return arguments.length?(d=+k,_):d},_},p.forceSimulation=function(l){var h,d=1,s=.001,x=1-Math.pow(s,1/300),c=0,T=.6,_=b.map(),w=e.timer(L),k=y.dispatch("tick","end");function L(){A(),k.call("tick",h),d<s&&(w.stop(),k.call("end",h))}function A(S){var E,D,R=l.length;S===void 0&&(S=1);for(var H=0;H<S;++H)for(d+=(c-d)*x,_.each(function(V){V(d)}),E=0;E<R;++E)(D=l[E]).fx==null?D.x+=D.vx*=T:(D.x=D.fx,D.vx=0),D.fy==null?D.y+=D.vy*=T:(D.y=D.fy,D.vy=0);return h}function I(){for(var S,E=0,D=l.length;E<D;++E){if((S=l[E]).index=E,S.fx!=null&&(S.x=S.fx),S.fy!=null&&(S.y=S.fy),isNaN(S.x)||isNaN(S.y)){var R=10*Math.sqrt(E),H=E*f;S.x=R*Math.cos(H),S.y=R*Math.sin(H)}(isNaN(S.vx)||isNaN(S.vy))&&(S.vx=S.vy=0)}}function P(S){return S.initialize&&S.initialize(l),S}return l==null&&(l=[]),I(),h={tick:A,restart:function(){return w.restart(L),h},stop:function(){return w.stop(),h},nodes:function(S){return arguments.length?(l=S,I(),_.each(P),h):l},alpha:function(S){return arguments.length?(d=+S,h):d},alphaMin:function(S){return arguments.length?(s=+S,h):s},alphaDecay:function(S){return arguments.length?(x=+S,h):+x},alphaTarget:function(S){return arguments.length?(c=+S,h):c},velocityDecay:function(S){return arguments.length?(T=1-S,h):1-T},force:function(S,E){return arguments.length>1?(E==null?_.remove(S):_.set(S,P(E)),h):_.get(S)},find:function(S,E,D){var R,H,V,X,$,G=0,W=l.length;for(D==null?D=1/0:D*=D,G=0;G<W;++G)(V=(R=S-(X=l[G]).x)*R+(H=E-X.y)*H)<D&&($=X,D=V);return $},on:function(S,E){return arguments.length>1?(k.on(S,E),h):k.on(S)}}},p.forceX=function(l){var h,d,s,x=n(.1);function c(_){for(var w,k=0,L=h.length;k<L;++k)(w=h[k]).vx+=(s[k]-w.x)*d[k]*_}function T(){if(h){var _,w=h.length;for(d=new Array(w),s=new Array(w),_=0;_<w;++_)d[_]=isNaN(s[_]=+l(h[_],_,h))?0:+x(h[_],_,h)}}return typeof l!="function"&&(l=n(l==null?0:+l)),c.initialize=function(_){h=_,T()},c.strength=function(_){return arguments.length?(x=typeof _=="function"?_:n(+_),T(),c):x},c.x=function(_){return arguments.length?(l=typeof _=="function"?_:n(+_),T(),c):l},c},p.forceY=function(l){var h,d,s,x=n(.1);function c(_){for(var w,k=0,L=h.length;k<L;++k)(w=h[k]).vy+=(s[k]-w.y)*d[k]*_}function T(){if(h){var _,w=h.length;for(d=new Array(w),s=new Array(w),_=0;_<w;++_)d[_]=isNaN(s[_]=+l(h[_],_,h))?0:+x(h[_],_,h)}}return typeof l!="function"&&(l=n(l==null?0:+l)),c.initialize=function(_){h=_,T()},c.strength=function(_){return arguments.length?(x=typeof _=="function"?_:n(+_),T(),c):x},c.y=function(_){return arguments.length?(l=typeof _=="function"?_:n(+_),T(),c):l},c},Object.defineProperty(p,"__esModule",{value:!0})})},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(v,J,Z){(function(p,g){g(typeof Z=="object"&&J!==void 0?Z:(p=typeof globalThis<"u"?globalThis:p||self).d3=p.d3||{})})(this,function(p){function g(h,d){if((s=(h=d?h.toExponential(d-1):h.toExponential()).indexOf("e"))<0)return null;var s,x=h.slice(0,s);return[x.length>1?x[0]+x.slice(2):x,+h.slice(s+1)]}function b(h){return(h=g(Math.abs(h)))?h[1]:NaN}var y,e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function n(h){if(!(d=e.exec(h)))throw new Error("invalid format: "+h);var d;return new t({fill:d[1],align:d[2],sign:d[3],symbol:d[4],zero:d[5],width:d[6],comma:d[7],precision:d[8]&&d[8].slice(1),trim:d[9],type:d[10]})}function t(h){this.fill=h.fill===void 0?" ":h.fill+"",this.align=h.align===void 0?">":h.align+"",this.sign=h.sign===void 0?"-":h.sign+"",this.symbol=h.symbol===void 0?"":h.symbol+"",this.zero=!!h.zero,this.width=h.width===void 0?void 0:+h.width,this.comma=!!h.comma,this.precision=h.precision===void 0?void 0:+h.precision,this.trim=!!h.trim,this.type=h.type===void 0?"":h.type+""}function a(h,d){var s=g(h,d);if(!s)return h+"";var x=s[0],c=s[1];return c<0?"0."+new Array(-c).join("0")+x:x.length>c+1?x.slice(0,c+1)+"."+x.slice(c+1):x+new Array(c-x.length+2).join("0")}n.prototype=t.prototype,t.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var r={"%":function(h,d){return(100*h).toFixed(d)},b:function(h){return Math.round(h).toString(2)},c:function(h){return h+""},d:function(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)},e:function(h,d){return h.toExponential(d)},f:function(h,d){return h.toFixed(d)},g:function(h,d){return h.toPrecision(d)},o:function(h){return Math.round(h).toString(8)},p:function(h,d){return a(100*h,d)},r:a,s:function(h,d){var s=g(h,d);if(!s)return h+"";var x=s[0],c=s[1],T=c-(y=3*Math.max(-8,Math.min(8,Math.floor(c/3))))+1,_=x.length;return T===_?x:T>_?x+new Array(T-_+1).join("0"):T>0?x.slice(0,T)+"."+x.slice(T):"0."+new Array(1-T).join("0")+g(h,Math.max(0,d+T-1))[0]},X:function(h){return Math.round(h).toString(16).toUpperCase()},x:function(h){return Math.round(h).toString(16)}};function m(h){return h}var o,i=Array.prototype.map,u=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function f(h){var d,s,x=h.grouping===void 0||h.thousands===void 0?m:(d=i.call(h.grouping,Number),s=h.thousands+"",function(P,S){for(var E=P.length,D=[],R=0,H=d[0],V=0;E>0&&H>0&&(V+H+1>S&&(H=Math.max(1,S-V)),D.push(P.substring(E-=H,E+H)),!((V+=H+1)>S));)H=d[R=(R+1)%d.length];return D.reverse().join(s)}),c=h.currency===void 0?"":h.currency[0]+"",T=h.currency===void 0?"":h.currency[1]+"",_=h.decimal===void 0?".":h.decimal+"",w=h.numerals===void 0?m:function(P){return function(S){return S.replace(/[0-9]/g,function(E){return P[+E]})}}(i.call(h.numerals,String)),k=h.percent===void 0?"%":h.percent+"",L=h.minus===void 0?"-":h.minus+"",A=h.nan===void 0?"NaN":h.nan+"";function I(P){var S=(P=n(P)).fill,E=P.align,D=P.sign,R=P.symbol,H=P.zero,V=P.width,X=P.comma,$=P.precision,G=P.trim,W=P.type;W==="n"?(X=!0,W="g"):r[W]||($===void 0&&($=12),G=!0,W="g"),(H||S==="0"&&E==="=")&&(H=!0,S="0",E="=");var te=R==="$"?c:R==="#"&&/[boxX]/.test(W)?"0"+W.toLowerCase():"",N=R==="$"?T:/[%p]/.test(W)?k:"",B=r[W],U=/[defgprs%]/.test(W);function ee(j){var Q,K,re,ne=te,le=N;if(W==="c")le=B(j)+le,j="";else{var oe=(j=+j)<0||1/j<0;if(j=isNaN(j)?A:B(Math.abs(j),$),G&&(j=function(me){e:for(var Te,_e=me.length,be=1,Ce=-1;be<_e;++be)switch(me[be]){case".":Ce=Te=be;break;case"0":Ce===0&&(Ce=be),Te=be;break;default:if(!+me[be])break e;Ce>0&&(Ce=0)}return Ce>0?me.slice(0,Ce)+me.slice(Te+1):me}(j)),oe&&+j==0&&D!=="+"&&(oe=!1),ne=(oe?D==="("?D:L:D==="-"||D==="("?"":D)+ne,le=(W==="s"?u[8+y/3]:"")+le+(oe&&D==="("?")":""),U){for(Q=-1,K=j.length;++Q<K;)if(48>(re=j.charCodeAt(Q))||re>57){le=(re===46?_+j.slice(Q+1):j.slice(Q))+le,j=j.slice(0,Q);break}}}X&&!H&&(j=x(j,1/0));var de=ne.length+j.length+le.length,se=de<V?new Array(V-de+1).join(S):"";switch(X&&H&&(j=x(se+j,se.length?V-le.length:1/0),se=""),E){case"<":j=ne+j+le+se;break;case"=":j=ne+se+j+le;break;case"^":j=se.slice(0,de=se.length>>1)+ne+j+le+se.slice(de);break;default:j=se+ne+j+le}return w(j)}return $=$===void 0?6:/[gprs]/.test(W)?Math.max(1,Math.min(21,$)):Math.max(0,Math.min(20,$)),ee.toString=function(){return P+""},ee}return{format:I,formatPrefix:function(P,S){var E=I(((P=n(P)).type="f",P)),D=3*Math.max(-8,Math.min(8,Math.floor(b(S)/3))),R=Math.pow(10,-D),H=u[8+D/3];return function(V){return E(R*V)+H}}}}function l(h){return o=f(h),p.format=o.format,p.formatPrefix=o.formatPrefix,o}l({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),p.FormatSpecifier=t,p.formatDefaultLocale=l,p.formatLocale=f,p.formatSpecifier=n,p.precisionFixed=function(h){return Math.max(0,-b(Math.abs(h)))},p.precisionPrefix=function(h,d){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(b(d)/3)))-b(Math.abs(h)))},p.precisionRound=function(h,d){return h=Math.abs(h),d=Math.abs(d)-h,Math.max(0,b(d)-b(h))+1},Object.defineProperty(p,"__esModule",{value:!0})})},{}],113:[function(v,J,Z){(function(p,g){typeof Z=="object"&&J!==void 0?g(Z,v("d3-geo"),v("d3-array")):g(p.d3=p.d3||{},p.d3,p.d3)})(this,function(p,g,b){var y=Math.abs,e=Math.atan,n=Math.atan2,t=Math.cos,a=Math.exp,r=Math.floor,m=Math.log,o=Math.max,i=Math.min,u=Math.pow,f=Math.round,l=Math.sign||function(je){return je>0?1:je<0?-1:0},h=Math.sin,d=Math.tan,s=1e-6,x=Math.PI,c=x/2,T=x/4,_=Math.SQRT1_2,w=E(2),k=E(x),L=2*x,A=180/x,I=x/180;function P(je){return je>1?c:je<-1?-c:Math.asin(je)}function S(je){return je>1?0:je<-1?x:Math.acos(je)}function E(je){return je>0?Math.sqrt(je):0}function D(je){return(a(je)-a(-je))/2}function R(je){return(a(je)+a(-je))/2}function H(je){var Ge=d(je/2),et=2*m(t(je/2))/(Ge*Ge);function lt(gt,dt){var St=t(gt),Xt=t(dt),Kt=h(dt),Yt=Xt*St,or=-((1-Yt?m((1+Yt)/2)/(1-Yt):-.5)+et/(1+Yt));return[or*Xt*h(gt),or*Kt]}return lt.invert=function(gt,dt){var St,Xt=E(gt*gt+dt*dt),Kt=-je/2,Yt=50;if(!Xt)return[0,0];do{var or=Kt/2,mr=t(or),wr=h(or),Tr=wr/mr,Dr=-m(y(mr));Kt-=St=(2/Tr*Dr-et*Tr-Xt)/(-Dr/(wr*wr)+1-et/(2*mr*mr))*(mr<0?.7:1)}while(y(St)>s&&--Yt>0);var nn=h(Kt);return[n(gt*nn,Xt*t(Kt)),P(dt*nn/Xt)]},lt}function V(je,Ge){var et=t(Ge),lt=function(gt){return gt?gt/Math.sin(gt):1}(S(et*t(je/=2)));return[2*et*h(je)*lt,h(Ge)*lt]}function X(je){var Ge=h(je),et=t(je),lt=je>=0?1:-1,gt=d(lt*je),dt=(1+Ge-et)/2;function St(Xt,Kt){var Yt=t(Kt),or=t(Xt/=2);return[(1+Yt)*h(Xt),(lt*Kt>-n(or,gt)-.001?0:10*-lt)+dt+h(Kt)*et-(1+Yt)*Ge*or]}return St.invert=function(Xt,Kt){var Yt=0,or=0,mr=50;do{var wr=t(Yt),Tr=h(Yt),Dr=t(or),nn=h(or),hn=1+Dr,Cn=hn*Tr-Xt,Dn=dt+nn*et-hn*Ge*wr-Kt,Gn=hn*wr/2,Rn=-Tr*nn,va=Ge*hn*Tr/2,Sa=et*Dr+Ge*wr*nn,Ua=Rn*va-Sa*Gn,ja=(Dn*Rn-Cn*Sa)/Ua/2,Va=(Cn*va-Dn*Gn)/Ua;y(Va)>2&&(Va/=2),Yt-=ja,or-=Va}while((y(ja)>s||y(Va)>s)&&--mr>0);return lt*or>-n(t(Yt),gt)-.001?[2*Yt,or]:null},St}function $(je,Ge){var et=d(Ge/2),lt=E(1-et*et),gt=1+lt*t(je/=2),dt=h(je)*lt/gt,St=et/gt,Xt=dt*dt,Kt=St*St;return[4/3*dt*(3+Xt-3*Kt),4/3*St*(3+3*Xt-Kt)]}V.invert=function(je,Ge){if(!(je*je+4*Ge*Ge>x*x+s)){var et=je,lt=Ge,gt=25;do{var dt,St=h(et),Xt=h(et/2),Kt=t(et/2),Yt=h(lt),or=t(lt),mr=h(2*lt),wr=Yt*Yt,Tr=or*or,Dr=Xt*Xt,nn=1-Tr*Kt*Kt,hn=nn?S(or*Kt)*E(dt=1/nn):dt=0,Cn=2*hn*or*Xt-je,Dn=hn*Yt-Ge,Gn=dt*(Tr*Dr+hn*or*Kt*wr),Rn=dt*(.5*St*mr-2*hn*Yt*Xt),va=.25*dt*(mr*Xt-hn*Yt*Tr*St),Sa=dt*(wr*Kt+hn*Dr*or),Ua=Rn*va-Sa*Gn;if(!Ua)break;var ja=(Dn*Rn-Cn*Sa)/Ua,Va=(Cn*va-Dn*Gn)/Ua;et-=ja,lt-=Va}while((y(ja)>s||y(Va)>s)&&--gt>0);return[et,lt]}},$.invert=function(je,Ge){if(Ge*=3/8,!(je*=3/8)&&y(Ge)>1)return null;var et=1+je*je+Ge*Ge,lt=E((et-E(et*et-4*Ge*Ge))/2),gt=P(lt)/3,dt=lt?function(Yt){return m(Yt+E(Yt*Yt-1))}(y(Ge/lt))/3:function(Yt){return m(Yt+E(Yt*Yt+1))}(y(je))/3,St=t(gt),Xt=R(dt),Kt=Xt*Xt-St*St;return[2*l(je)*n(D(dt)*St,.25-Kt),2*l(Ge)*n(Xt*h(gt),.25+Kt)]};var G=E(8),W=m(1+w);function te(je,Ge){var et=y(Ge);return et<T?[je,m(d(T+Ge/2))]:[je*t(et)*(2*w-1/h(et)),l(Ge)*(2*w*(et-T)-m(d(et/2)))]}function N(je){var Ge=2*x/je;function et(lt,gt){var dt=g.geoAzimuthalEquidistantRaw(lt,gt);if(y(lt)>c){var St=n(dt[1],dt[0]),Xt=E(dt[0]*dt[0]+dt[1]*dt[1]),Kt=Ge*f((St-c)/Ge)+c,Yt=n(h(St-=Kt),2-t(St));St=Kt+P(x/Xt*h(Yt))-Yt,dt[0]=Xt*t(St),dt[1]=Xt*h(St)}return dt}return et.invert=function(lt,gt){var dt=E(lt*lt+gt*gt);if(dt>c){var St=n(gt,lt),Xt=Ge*f((St-c)/Ge)+c,Kt=St>Xt?-1:1,Yt=dt*t(Xt-St),or=1/d(Kt*S((Yt-x)/E(x*(x-2*Yt)+dt*dt)));St=Xt+2*e((or+Kt*E(or*or-3))/3),lt=dt*t(St),gt=dt*h(St)}return g.geoAzimuthalEquidistantRaw.invert(lt,gt)},et}function B(je,Ge){if(arguments.length<2&&(Ge=je),Ge===1)return g.geoAzimuthalEqualAreaRaw;if(Ge===1/0)return U;function et(lt,gt){var dt=g.geoAzimuthalEqualAreaRaw(lt/Ge,gt);return dt[0]*=je,dt}return et.invert=function(lt,gt){var dt=g.geoAzimuthalEqualAreaRaw.invert(lt/je,gt);return dt[0]*=Ge,dt},et}function U(je,Ge){return[je*t(Ge)/t(Ge/=2),2*h(Ge)]}function ee(je,Ge,et){var lt,gt,dt,St=100;et=et===void 0?0:+et,Ge=+Ge;do(gt=je(et))===(dt=je(et+s))&&(dt=gt+s),et-=lt=-1*s*(gt-Ge)/(gt-dt);while(St-- >0&&y(lt)>s);return St<0?NaN:et}function j(je,Ge,et){return Ge===void 0&&(Ge=40),et===void 0&&(et=1e-12),function(lt,gt,dt,St){var Xt,Kt,Yt;dt=dt===void 0?0:+dt,St=St===void 0?0:+St;for(var or=0;or<Ge;or++){var mr=je(dt,St),wr=mr[0]-lt,Tr=mr[1]-gt;if(y(wr)<et&&y(Tr)<et)break;var Dr=wr*wr+Tr*Tr;if(Dr>Xt)dt-=Kt/=2,St-=Yt/=2;else{Xt=Dr;var nn=(dt>0?-1:1)*et,hn=(St>0?-1:1)*et,Cn=je(dt+nn,St),Dn=je(dt,St+hn),Gn=(Cn[0]-mr[0])/nn,Rn=(Cn[1]-mr[1])/nn,va=(Dn[0]-mr[0])/hn,Sa=(Dn[1]-mr[1])/hn,Ua=Sa*Gn-Rn*va,ja=(y(Ua)<.5?.5:1)/Ua;if(dt+=Kt=(Tr*va-wr*Sa)*ja,St+=Yt=(wr*Rn-Tr*Gn)*ja,y(Kt)<et&&y(Yt)<et)break}}return[dt,St]}}function Q(){var je=B(1.68,2);function Ge(et,lt){if(et+lt<-1.4){var gt=(et-lt+1.6)*(et+lt+1.4)/8;et+=gt,lt-=.8*gt*h(lt+x/2)}var dt=je(et,lt),St=(1-t(et*lt))/12;return dt[1]<0&&(dt[0]*=1+St),dt[1]>0&&(dt[1]*=1+St/1.5*dt[0]*dt[0]),dt}return Ge.invert=j(Ge),Ge}function K(je,Ge){var et,lt=je*h(Ge),gt=30;do Ge-=et=(Ge+h(Ge)-lt)/(1+t(Ge));while(y(et)>s&&--gt>0);return Ge/2}function re(je,Ge,et){function lt(gt,dt){return[je*gt*t(dt=K(et,dt)),Ge*h(dt)]}return lt.invert=function(gt,dt){return dt=P(dt/Ge),[gt/(je*t(dt)),P((2*dt+h(2*dt))/et)]},lt}te.invert=function(je,Ge){if((lt=y(Ge))<W)return[je,2*e(a(Ge))-c];var et,lt,gt=T,dt=25;do{var St=t(gt/2),Xt=d(gt/2);gt-=et=(G*(gt-T)-m(Xt)-lt)/(G-St*St/(2*Xt))}while(y(et)>1e-12&&--dt>0);return[je/(t(gt)*(G-1/h(gt))),l(Ge)*gt]},U.invert=function(je,Ge){var et=2*P(Ge/2);return[je*t(et/2)/t(et),et]};var ne=re(w/c,w,x),le=2.00276,oe=1.11072;function de(je,Ge){var et=K(x,Ge);return[le*je/(1/t(Ge)+oe/t(et)),(Ge+w*h(et))/le]}function se(je){var Ge=0,et=g.geoProjectionMutator(je),lt=et(Ge);return lt.parallel=function(gt){return arguments.length?et(Ge=gt*I):Ge*A},lt}function me(je,Ge){return[je*t(Ge),Ge]}function Te(je){if(!je)return me;var Ge=1/d(je);function et(lt,gt){var dt=Ge+je-gt,St=dt&&lt*t(gt)/dt;return[dt*h(St),Ge-dt*t(St)]}return et.invert=function(lt,gt){var dt=E(lt*lt+(gt=Ge-gt)*gt),St=Ge+je-dt;return[dt/t(St)*n(lt,gt),St]},et}function _e(je){function Ge(et,lt){var gt=c-lt,dt=gt&&et*je*h(gt)/gt;return[gt*h(dt)/je,c-gt*t(dt)]}return Ge.invert=function(et,lt){var gt=et*je,dt=c-lt,St=E(gt*gt+dt*dt),Xt=n(gt,dt);return[(St?St/h(St):1)*Xt/je,c-St]},Ge}de.invert=function(je,Ge){var et,lt,gt=le*Ge,dt=Ge<0?-T:T,St=25;do lt=gt-w*h(dt),dt-=et=(h(2*dt)+2*dt-x*h(lt))/(2*t(2*dt)+2+x*t(lt)*w*t(dt));while(y(et)>s&&--St>0);return lt=gt-w*h(dt),[je*(1/t(lt)+oe/t(dt))/le,lt]},me.invert=function(je,Ge){return[je/t(Ge),Ge]};var be=re(1,4/x,x);function Ce(je,Ge,et,lt,gt,dt){var St,Xt=t(dt);if(y(je)>1||y(dt)>1)St=S(et*gt+Ge*lt*Xt);else{var Kt=h(je/2),Yt=h(dt/2);St=2*P(E(Kt*Kt+Ge*lt*Yt*Yt))}return y(St)>s?[St,n(lt*h(dt),Ge*gt-et*lt*Xt)]:[0,0]}function fe(je,Ge,et){return S((je*je+Ge*Ge-et*et)/(2*je*Ge))}function ve(je){return je-2*x*r((je+x)/(2*x))}function Me(je,Ge,et){for(var lt,gt=[[je[0],je[1],h(je[1]),t(je[1])],[Ge[0],Ge[1],h(Ge[1]),t(Ge[1])],[et[0],et[1],h(et[1]),t(et[1])]],dt=gt[2],St=0;St<3;++St,dt=lt)lt=gt[St],dt.v=Ce(lt[1]-dt[1],dt[3],dt[2],lt[3],lt[2],lt[0]-dt[0]),dt.point=[0,0];var Xt=fe(gt[0].v[0],gt[2].v[0],gt[1].v[0]),Kt=fe(gt[0].v[0],gt[1].v[0],gt[2].v[0]),Yt=x-Xt;gt[2].point[1]=0,gt[0].point[0]=-(gt[1].point[0]=gt[0].v[0]/2);var or=[gt[2].point[0]=gt[0].point[0]+gt[2].v[0]*t(Xt),2*(gt[0].point[1]=gt[1].point[1]=gt[2].v[0]*h(Xt))];return function(mr,wr){var Tr,Dr=h(wr),nn=t(wr),hn=new Array(3);for(Tr=0;Tr<3;++Tr){var Cn=gt[Tr];if(hn[Tr]=Ce(wr-Cn[1],Cn[3],Cn[2],nn,Dr,mr-Cn[0]),!hn[Tr][0])return Cn.point;hn[Tr][1]=ve(hn[Tr][1]-Cn.v[1])}var Dn=or.slice();for(Tr=0;Tr<3;++Tr){var Gn=Tr==2?0:Tr+1,Rn=fe(gt[Tr].v[0],hn[Tr][0],hn[Gn][0]);hn[Tr][1]<0&&(Rn=-Rn),Tr?Tr==1?(Rn=Kt-Rn,Dn[0]-=hn[Tr][0]*t(Rn),Dn[1]-=hn[Tr][0]*h(Rn)):(Rn=Yt-Rn,Dn[0]+=hn[Tr][0]*t(Rn),Dn[1]+=hn[Tr][0]*h(Rn)):(Dn[0]+=hn[Tr][0]*t(Rn),Dn[1]-=hn[Tr][0]*h(Rn))}return Dn[0]/=3,Dn[1]/=3,Dn}}function ke(je){return je[0]*=I,je[1]*=I,je}function Le(je,Ge,et){var lt=g.geoCentroid({type:"MultiPoint",coordinates:[je,Ge,et]}),gt=[-lt[0],-lt[1]],dt=g.geoRotation(gt),St=Me(ke(dt(je)),ke(dt(Ge)),ke(dt(et)));St.invert=j(St);var Xt=g.geoProjection(St).rotate(gt),Kt=Xt.center;return delete Xt.rotate,Xt.center=function(Yt){return arguments.length?Kt(dt(Yt)):dt.invert(Kt())},Xt.clipAngle(90)}function ze(je,Ge){var et=E(1-h(Ge));return[2/k*je*et,k*(1-et)]}function Re(je){var Ge=d(je);function et(lt,gt){return[lt,(lt?lt/h(lt):1)*(h(gt)*t(lt)-Ge*t(gt))]}return et.invert=Ge?function(lt,gt){lt&&(gt*=h(lt)/lt);var dt=t(lt);return[lt,2*n(E(dt*dt+Ge*Ge-gt*gt)-dt,Ge-gt)]}:function(lt,gt){return[lt,P(lt?gt*d(lt)/lt:gt)]},et}ze.invert=function(je,Ge){var et=(et=Ge/k-1)*et;return[et>0?je*E(x/et)/2:0,P(1-et)]};var Oe=E(3);function Ze(je,Ge){return[Oe*je*(2*t(2*Ge/3)-1)/k,Oe*k*h(Ge/3)]}function Pe(je){var Ge=t(je);function et(lt,gt){return[lt*Ge,h(gt)/Ge]}return et.invert=function(lt,gt){return[lt/Ge,P(gt*Ge)]},et}function Ie(je){var Ge=t(je);function et(lt,gt){return[lt*Ge,(1+Ge)*d(gt/2)]}return et.invert=function(lt,gt){return[lt/Ge,2*e(gt/(1+Ge))]},et}function Be(je,Ge){var et=E(8/(3*x));return[et*je*(1-y(Ge)/x),et*Ge]}function Fe(je,Ge){var et=E(4-3*h(y(Ge)));return[2/E(6*x)*je*et,l(Ge)*E(2*x/3)*(2-et)]}function $e(je,Ge){var et=E(x*(4+x));return[2/et*je*(1+E(1-4*Ge*Ge/(x*x))),4/et*Ge]}function ot(je,Ge){var et=(2+c)*h(Ge);Ge/=2;for(var lt=0,gt=1/0;lt<10&&y(gt)>s;lt++){var dt=t(Ge);Ge-=gt=(Ge+h(Ge)*(dt+2)-et)/(2*dt*(1+dt))}return[2/E(x*(4+x))*je*(1+t(Ge)),2*E(x/(4+x))*h(Ge)]}function pt(je,Ge){return[je*(1+t(Ge))/E(2+x),2*Ge/E(2+x)]}function _t(je,Ge){for(var et=(1+c)*h(Ge),lt=0,gt=1/0;lt<10&&y(gt)>s;lt++)Ge-=gt=(Ge+h(Ge)-et)/(1+t(Ge));return et=E(2+x),[je*(1+t(Ge))/et,2*Ge/et]}Ze.invert=function(je,Ge){var et=3*P(Ge/(Oe*k));return[k*je/(Oe*(2*t(2*et/3)-1)),et]},Be.invert=function(je,Ge){var et=E(8/(3*x)),lt=Ge/et;return[je/(et*(1-y(lt)/x)),lt]},Fe.invert=function(je,Ge){var et=2-y(Ge)/E(2*x/3);return[je*E(6*x)/(2*et),l(Ge)*P((4-et*et)/3)]},$e.invert=function(je,Ge){var et=E(x*(4+x))/2;return[je*et/(1+E(1-Ge*Ge*(4+x)/(4*x))),Ge*et/2]},ot.invert=function(je,Ge){var et=Ge*E((4+x)/x)/2,lt=P(et),gt=t(lt);return[je/(2/E(x*(4+x))*(1+gt)),P((lt+et*(gt+2))/(2+c))]},pt.invert=function(je,Ge){var et=E(2+x),lt=Ge*et/2;return[et*je/(1+t(lt)),lt]},_t.invert=function(je,Ge){var et=1+c,lt=E(et/2);return[2*je*lt/(1+t(Ge*=lt)),P((Ge+h(Ge))/et)]};var yt=3+2*w;function tt(je,Ge){var et=h(je/=2),lt=t(je),gt=E(t(Ge)),dt=t(Ge/=2),St=h(Ge)/(dt+w*lt*gt),Xt=E(2/(1+St*St)),Kt=E((w*dt+(lt+et)*gt)/(w*dt+(lt-et)*gt));return[yt*(Xt*(Kt-1/Kt)-2*m(Kt)),yt*(Xt*St*(Kt+1/Kt)-2*e(St))]}tt.invert=function(je,Ge){if(!(et=$.invert(je/1.2,1.065*Ge)))return null;var et,lt=et[0],gt=et[1],dt=20;je/=yt,Ge/=yt;do{var St=lt/2,Xt=gt/2,Kt=h(St),Yt=t(St),or=h(Xt),mr=t(Xt),wr=t(gt),Tr=E(wr),Dr=or/(mr+w*Yt*Tr),nn=Dr*Dr,hn=E(2/(1+nn)),Cn=(w*mr+(Yt+Kt)*Tr)/(w*mr+(Yt-Kt)*Tr),Dn=E(Cn),Gn=Dn-1/Dn,Rn=Dn+1/Dn,va=hn*Gn-2*m(Dn)-je,Sa=hn*Dr*Rn-2*e(Dr)-Ge,Ua=or&&_*Tr*Kt*nn/or,ja=(w*Yt*mr+Tr)/(2*(mr+w*Yt*Tr)*(mr+w*Yt*Tr)*Tr),Va=-.5*Dr*hn*hn*hn,Ai=Va*Ua,Ti=Va*ja,ci=(ci=2*mr+w*Tr*(Yt-Kt))*ci*Dn,ui=(w*Yt*mr*Tr+wr)/ci,ki=-w*Kt*or/(Tr*ci),Vi=Gn*Ai-2*ui/Dn+hn*(ui+ui/Cn),ro=Gn*Ti-2*ki/Dn+hn*(ki+ki/Cn),no=Dr*Rn*Ai-2*Ua/(1+nn)+hn*Rn*Ua+hn*Dr*(ui-ui/Cn),ao=Dr*Rn*Ti-2*ja/(1+nn)+hn*Rn*ja+hn*Dr*(ki-ki/Cn),io=ro*no-ao*Vi;if(!io)break;var Da=(Sa*ro-va*ao)/io,ht=(va*no-Sa*Vi)/io;lt-=Da,gt=o(-c,i(c,gt-ht))}while((y(Da)>s||y(ht)>s)&&--dt>0);return y(y(gt)-c)<s?[0,gt]:dt&&[lt,gt]};var Ke=t(35*I);function vt(je,Ge){var et=d(Ge/2);return[je*Ke*E(1-et*et),(1+Ke)*et]}function Nt(je,Ge){var et=Ge/2,lt=t(et);return[2*je/k*t(Ge)*lt*lt,k*d(et)]}function qt(je){var Ge=1-je,et=gt(x,0)[0]-gt(-x,0)[0],lt=E(2*(gt(0,c)[1]-gt(0,-c)[1])/et);function gt(Xt,Kt){var Yt=t(Kt),or=h(Kt);return[Yt/(Ge+je*Yt)*Xt,Ge*Kt+je*or]}function dt(Xt,Kt){var Yt=gt(Xt,Kt);return[Yt[0]*lt,Yt[1]/lt]}function St(Xt){return dt(0,Xt)[1]}return dt.invert=function(Xt,Kt){var Yt=ee(St,Kt);return[Xt/lt*(je+Ge/t(Yt)),Yt]},dt}function er(je){return[je[0]/2,P(d(je[1]/2*I))*A]}function Jt(je){return[2*je[0],2*e(h(je[1]*I))*A]}function ir(je,Ge){var et=2*x/Ge,lt=je*je;function gt(dt,St){var Xt=g.geoAzimuthalEquidistantRaw(dt,St),Kt=Xt[0],Yt=Xt[1],or=Kt*Kt+Yt*Yt;if(or>lt){var mr=E(or),wr=n(Yt,Kt),Tr=et*f(wr/et),Dr=wr-Tr,nn=je*t(Dr),hn=(je*h(Dr)-Dr*h(nn))/(c-nn),Cn=Ht(Dr,hn),Dn=(x-je)/Ue(Cn,nn,x);Kt=mr;var Gn,Rn=50;do Kt-=Gn=(je+Ue(Cn,nn,Kt)*Dn-mr)/(Cn(Kt)*Dn);while(y(Gn)>s&&--Rn>0);Yt=Dr*h(Kt),Kt<c&&(Yt-=hn*(Kt-c));var va=h(Tr),Sa=t(Tr);Xt[0]=Kt*Sa-Yt*va,Xt[1]=Kt*va+Yt*Sa}return Xt}return gt.invert=function(dt,St){var Xt=dt*dt+St*St;if(Xt>lt){var Kt=E(Xt),Yt=n(St,dt),or=et*f(Yt/et),mr=Yt-or;dt=Kt*t(mr),St=Kt*h(mr);for(var wr=dt-c,Tr=h(dt),Dr=St/Tr,nn=dt<c?1/0:0,hn=10;;){var Cn=je*h(Dr),Dn=je*t(Dr),Gn=h(Dn),Rn=c-Dn,va=(Cn-Dr*Gn)/Rn,Sa=Ht(Dr,va);if(y(nn)<1e-12||!--hn)break;Dr-=nn=(Dr*Tr-va*wr-St)/(Tr-2*wr*(Rn*(Dn+Dr*Cn*t(Dn)-Gn)-Cn*(Cn-Dr*Gn))/(Rn*Rn))}dt=(Kt=je+Ue(Sa,Dn,dt)*(x-je)/Ue(Sa,Dn,x))*t(Yt=or+Dr),St=Kt*h(Yt)}return g.geoAzimuthalEquidistantRaw.invert(dt,St)},gt}function Ht(je,Ge){return function(et){var lt=je*t(et);return et<c&&(lt-=Ge),E(1+lt*lt)}}function Ue(je,Ge,et){for(var lt=(et-Ge)/50,gt=je(Ge)+je(et),dt=1,St=Ge;dt<50;++dt)gt+=2*je(St+=lt);return .5*gt*lt}function We(je,Ge,et,lt,gt,dt,St,Xt){function Kt(Yt,or){if(!or)return[je*Yt/x,0];var mr=or*or,wr=je+mr*(Ge+mr*(et+mr*lt)),Tr=or*(gt-1+mr*(dt-Xt+mr*St)),Dr=(wr*wr+Tr*Tr)/(2*Tr),nn=Yt*P(wr/Dr)/x;return[Dr*h(nn),or*(1+mr*Xt)+Dr*(1-t(nn))]}return arguments.length<8&&(Xt=0),Kt.invert=function(Yt,or){var mr,wr,Tr=x*Yt/je,Dr=or,nn=50;do{var hn=Dr*Dr,Cn=je+hn*(Ge+hn*(et+hn*lt)),Dn=Dr*(gt-1+hn*(dt-Xt+hn*St)),Gn=Cn*Cn+Dn*Dn,Rn=2*Dn,va=Gn/Rn,Sa=va*va,Ua=P(Cn/va)/x,ja=Tr*Ua,Va=Cn*Cn,Ai=(2*Ge+hn*(4*et+6*hn*lt))*Dr,Ti=gt+hn*(3*dt+5*hn*St),ci=(2*(Cn*Ai+Dn*(Ti-1))*Rn-Gn*(2*(Ti-1)))/(Rn*Rn),ui=t(ja),ki=h(ja),Vi=va*ui,ro=va*ki,no=Tr/x*(1/E(1-Va/Sa))*(Ai*va-Cn*ci)/Sa,ao=ro-Yt,io=Dr*(1+hn*Xt)+va-Vi-or,Da=ci*ki+Vi*no,ht=Vi*Ua,Ot=1+ci-(ci*ui-ro*no),cr=ro*Ua,Ut=Da*cr-Ot*ht;if(!Ut)break;Tr-=mr=(io*Da-ao*Ot)/Ut,Dr-=wr=(ao*cr-io*ht)/Ut}while((y(mr)>s||y(wr)>s)&&--nn>0);return[Tr,Dr]},Kt}vt.invert=function(je,Ge){var et=Ge/(1+Ke);return[je&&je/(Ke*E(1-et*et)),2*e(et)]},Nt.invert=function(je,Ge){var et=e(Ge/k),lt=t(et),gt=2*et;return[je*k/2/(t(gt)*lt*lt),gt]};var he=We(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),xe=We(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),De=We(5/6*x,-.62636,-.0344,0,1.3493,-.05524,0,.045);function qe(je,Ge){var et=je*je,lt=Ge*Ge;return[je*(1-.162388*lt)*(.87-952426e-9*et*et),Ge*(1+lt/12)]}qe.invert=function(je,Ge){var et,lt=je,gt=Ge,dt=50;do{var St=gt*gt;gt-=et=(gt*(1+St/12)-Ge)/(1+St/4)}while(y(et)>s&&--dt>0);dt=50,je/=1-.162388*St;do{var Xt=(Xt=lt*lt)*Xt;lt-=et=(lt*(.87-952426e-9*Xt)-je)/(.87-.00476213*Xt)}while(y(et)>s&&--dt>0);return[lt,gt]};var Xe=We(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function He(je){var Ge=je(c,0)[0]-je(-c,0)[0];function et(lt,gt){var dt=lt>0?-.5:.5,St=je(lt+dt*x,gt);return St[0]-=dt*Ge,St}return je.invert&&(et.invert=function(lt,gt){var dt=lt>0?-.5:.5,St=je.invert(lt+dt*Ge,gt),Xt=St[0]-dt*x;return Xt<-x?Xt+=2*x:Xt>x&&(Xt-=2*x),St[0]=Xt,St}),et}function st(je,Ge){var et=l(je),lt=l(Ge),gt=t(Ge),dt=t(je)*gt,St=h(je)*gt,Xt=h(lt*Ge);je=y(n(St,Xt)),Ge=P(dt),y(je-c)>s&&(je%=c);var Kt=function(Yt,or){if(or===c)return[0,0];var mr,wr,Tr=h(or),Dr=Tr*Tr,nn=Dr*Dr,hn=1+nn,Cn=1+3*nn,Dn=1-nn,Gn=P(1/E(hn)),Rn=Dn+Dr*hn*Gn,va=(1-Tr)/Rn,Sa=E(va),Ua=va*hn,ja=E(Ua),Va=Sa*Dn;if(Yt===0)return[0,-(Va+Dr*ja)];var Ai,Ti=t(or),ci=1/Ti,ui=2*Tr*Ti,ki=(-Rn*Ti-(-3*Dr+Gn*Cn)*ui*(1-Tr))/(Rn*Rn),Vi=-ci*ui,ro=-ci*(Dr*hn*ki+va*Cn*ui),no=-2*ci*(Dn*(.5*ki/Sa)-2*Dr*Sa*ui),ao=4*Yt/x;if(Yt>.222*x||or<x/4&&Yt>.175*x){if(mr=(Va+Dr*E(Ua*(1+nn)-Va*Va))/(1+nn),Yt>x/4)return[mr,mr];var io=mr,Da=.5*mr;mr=.5*(Da+io),wr=50;do{var ht=E(Ua-mr*mr),Ot=mr*(no+Vi*ht)+ro*P(mr/ja)-ao;if(!Ot)break;Ot<0?Da=mr:io=mr,mr=.5*(Da+io)}while(y(io-Da)>s&&--wr>0)}else{mr=s,wr=25;do{var cr=mr*mr,Ut=E(Ua-cr),ur=no+Vi*Ut,Or=mr*ur+ro*P(mr/ja)-ao,jr=ur+(ro-Vi*cr)/Ut;mr-=Ai=Ut?Or/jr:0}while(y(Ai)>s&&--wr>0)}return[mr,-Va-Dr*E(Ua-mr*mr)]}(je>x/4?c-je:je,Ge);return je>x/4&&(Xt=Kt[0],Kt[0]=-Kt[1],Kt[1]=-Xt),Kt[0]*=et,Kt[1]*=-lt,Kt}function it(je,Ge){var et,lt,gt,dt,St,Xt;if(Ge<s)return[(dt=h(je))-(et=Ge*(je-dt*(lt=t(je)))/4)*lt,lt+et*dt,1-Ge*dt*dt/2,je-et];if(Ge>=1-s)return et=(1-Ge)/4,gt=1/(lt=R(je)),[(dt=((Xt=a(2*(Xt=je)))-1)/(Xt+1))+et*((St=lt*D(je))-je)/(lt*lt),gt-et*dt*gt*(St-je),gt+et*dt*gt*(St+je),2*e(a(je))-c+et*(St-je)/lt];var Kt=[1,0,0,0,0,0,0,0,0],Yt=[E(Ge),0,0,0,0,0,0,0,0],or=0;for(lt=E(1-Ge),St=1;y(Yt[or]/Kt[or])>s&&or<8;)et=Kt[or++],Yt[or]=(et-lt)/2,Kt[or]=(et+lt)/2,lt=E(et*lt),St*=2;gt=St*Kt[or]*je;do gt=(P(dt=Yt[or]*h(lt=gt)/Kt[or])+gt)/2;while(--or);return[h(gt),dt=t(gt),dt/t(gt-lt),gt]}function Tt(je,Ge){if(!Ge)return je;if(Ge===1)return m(d(je/2+T));for(var et=1,lt=E(1-Ge),gt=E(Ge),dt=0;y(gt)>s;dt++){if(je%x){var St=e(lt*d(je)/et);St<0&&(St+=x),je+=St+~~(je/x)*x}else je+=je;gt=(et+lt)/2,lt=E(et*lt),gt=((et=gt)-lt)/2}return je/(u(2,dt)*et)}function Pt(je,Ge){var et=(w-1)/(w+1),lt=E(1-et*et),gt=Tt(c,lt*lt),dt=m(d(x/4+y(Ge)/2)),St=a(-1*dt)/E(et),Xt=function(Yt,or){var mr=Yt*Yt,wr=or+1,Tr=1-mr-or*or;return[.5*((Yt>=0?c:-c)-n(Tr,2*Yt)),-.25*m(Tr*Tr+4*mr)+.5*m(wr*wr+mr)]}(St*t(-1*je),St*h(-1*je)),Kt=function(Yt,or,mr){var wr=y(Yt),Tr=D(y(or));if(wr){var Dr=1/h(wr),nn=1/(d(wr)*d(wr)),hn=-(nn+mr*(Tr*Tr*Dr*Dr)-1+mr),Cn=(-hn+E(hn*hn-4*((mr-1)*nn)))/2;return[Tt(e(1/E(Cn)),mr)*l(Yt),Tt(e(E((Cn/nn-1)/mr)),1-mr)*l(or)]}return[0,Tt(e(Tr),1-mr)*l(or)]}(Xt[0],Xt[1],lt*lt);return[-Kt[1],(Ge>=0?1:-1)*(.5*gt-Kt[0])]}function rt(je){var Ge=h(je),et=t(je),lt=ut(je);function gt(dt,St){var Xt=lt(dt,St);dt=Xt[0],St=Xt[1];var Kt=h(St),Yt=t(St),or=t(dt),mr=S(Ge*Kt+et*Yt*or),wr=h(mr),Tr=y(wr)>s?mr/wr:1;return[Tr*et*h(dt),(y(dt)>c?Tr:-Tr)*(Ge*Yt-et*Kt*or)]}return lt.invert=ut(-je),gt.invert=function(dt,St){var Xt=E(dt*dt+St*St),Kt=-h(Xt),Yt=t(Xt),or=Xt*Yt,mr=-St*Kt,wr=Xt*Ge,Tr=E(or*or+mr*mr-wr*wr),Dr=n(or*wr+mr*Tr,mr*wr-or*Tr),nn=(Xt>c?-1:1)*n(dt*Kt,Xt*t(Dr)*Yt+St*h(Dr)*Kt);return lt.invert(nn,Dr)},gt}function ut(je){var Ge=h(je),et=t(je);return function(lt,gt){var dt=t(gt),St=t(lt)*dt,Xt=h(lt)*dt,Kt=h(gt);return[n(Xt,St*et-Kt*Ge),P(Kt*et+St*Ge)]}}st.invert=function(je,Ge){y(je)>1&&(je=2*l(je)-je),y(Ge)>1&&(Ge=2*l(Ge)-Ge);var et=l(je),lt=l(Ge),gt=-et*je,dt=-lt*Ge,St=dt/gt<1,Xt=function(mr,wr){for(var Tr=0,Dr=1,nn=.5,hn=50;;){var Cn=nn*nn,Dn=E(nn),Gn=P(1/E(1+Cn)),Rn=1-Cn+nn*(1+Cn)*Gn,va=(1-Dn)/Rn,Sa=E(va),Ua=va*(1+Cn),ja=Sa*(1-Cn),Va=E(Ua-mr*mr),Ai=wr+ja+nn*Va;if(y(Dr-Tr)<1e-12||--hn==0||Ai===0)break;Ai>0?Tr=nn:Dr=nn,nn=.5*(Tr+Dr)}if(!hn)return null;var Ti=P(Dn),ci=t(Ti),ui=1/ci,ki=2*Dn*ci,Vi=(-Rn*ci-(-3*nn+Gn*(1+3*Cn))*ki*(1-Dn))/(Rn*Rn);return[x/4*(mr*(-2*ui*(.5*Vi/Sa*(1-Cn)-2*nn*Sa*ki)+-ui*ki*Va)+-ui*(nn*(1+Cn)*Vi+va*(1+3*Cn)*ki)*P(mr/E(Ua))),Ti]}(St?dt:gt,St?gt:dt),Kt=Xt[0],Yt=Xt[1],or=t(Yt);return St&&(Kt=-c-Kt),[et*(n(h(Kt)*or,-h(Yt))+x),lt*P(t(Kt)*or)]},Pt.invert=function(je,Ge){var et,lt,gt,dt,St,Xt,Kt=(w-1)/(w+1),Yt=E(1-Kt*Kt),or=Tt(c,Yt*Yt),mr=(lt=-je,gt=Yt*Yt,(et=.5*or-Ge)?(dt=it(et,gt),lt?(Xt=(St=it(lt,1-gt))[1]*St[1]+gt*dt[0]*dt[0]*St[0]*St[0],[[dt[0]*St[2]/Xt,dt[1]*dt[2]*St[0]*St[1]/Xt],[dt[1]*St[1]/Xt,-dt[0]*dt[2]*St[0]*St[2]/Xt],[dt[2]*St[1]*St[2]/Xt,-gt*dt[0]*dt[1]*St[0]/Xt]]):[[dt[0],0],[dt[1],0],[dt[2],0]]):[[0,(St=it(lt,1-gt))[0]/St[1]],[1/St[1],0],[St[2]/St[1],0]]),wr=function(Tr,Dr){var nn=Dr[0]*Dr[0]+Dr[1]*Dr[1];return[(Tr[0]*Dr[0]+Tr[1]*Dr[1])/nn,(Tr[1]*Dr[0]-Tr[0]*Dr[1])/nn]}(mr[0],mr[1]);return[n(wr[1],wr[0])/-1,2*e(a(-.5*m(Kt*wr[0]*wr[0]+Kt*wr[1]*wr[1])))-c]};var Ft=P(1-1/3)*A,wt=Pe(0);function Lt(je){var Ge=Ft*I,et=ze(x,Ge)[0]-ze(-x,Ge)[0],lt=wt(0,Ge)[1],gt=ze(0,Ge)[1],dt=k-gt,St=L/je,Xt=4/L,Kt=lt+dt*dt*4/L;function Yt(or,mr){var wr,Tr=y(mr);if(Tr>Ge){var Dr=i(je-1,o(0,r((or+x)/St)));(wr=ze(or+=x*(je-1)/je-Dr*St,Tr))[0]=wr[0]*L/et-L*(je-1)/(2*je)+Dr*L/je,wr[1]=lt+4*(wr[1]-gt)*dt/L,mr<0&&(wr[1]=-wr[1])}else wr=wt(or,mr);return wr[0]*=Xt,wr[1]/=Kt,wr}return Yt.invert=function(or,mr){or/=Xt;var wr=y(mr*=Kt);if(wr>lt){var Tr=i(je-1,o(0,r((or+x)/St)));or=(or+x*(je-1)/je-Tr*St)*et/L;var Dr=ze.invert(or,.25*(wr-lt)*L/dt+gt);return Dr[0]-=x*(je-1)/je-Tr*St,mr<0&&(Dr[1]=-Dr[1]),Dr}return wt.invert(or,mr)},Yt}function Ae(je,Ge){return[je,1&Ge?90-s:Ft]}function Ye(je,Ge){return[je,1&Ge?-90+s:-Ft]}function nt(je){return[je[0]*(1-s),je[1]]}function ft(je){var Ge,et=1+je,lt=P(h(1/et)),gt=2*E(x/(Ge=x+4*lt*et)),dt=.5*gt*(et+E(je*(2+je))),St=je*je,Xt=et*et;function Kt(Yt,or){var mr,wr,Tr=1-h(or);if(Tr&&Tr<2){var Dr,nn=c-or,hn=25;do{var Cn=h(nn),Dn=t(nn),Gn=lt+n(Cn,et-Dn),Rn=1+Xt-2*et*Dn;nn-=Dr=(nn-St*lt-et*Cn+Rn*Gn-.5*Tr*Ge)/(2*et*Cn*Gn)}while(y(Dr)>1e-12&&--hn>0);mr=gt*E(Rn),wr=Yt*Gn/x}else mr=gt*(je+Tr),wr=Yt*lt/x;return[mr*h(wr),dt-mr*t(wr)]}return Kt.invert=function(Yt,or){var mr=Yt*Yt+(or-=dt)*or,wr=(1+Xt-mr/(gt*gt))/(2*et),Tr=S(wr),Dr=h(Tr),nn=lt+n(Dr,et-wr);return[P(Yt/E(mr))*x/nn,P(1-2*(Tr-St*lt-et*Dr+(1+Xt-2*et*wr)*nn)/Ge)]},Kt}function Mt(je,Ge){return Ge>-.7109889596207567?((je=ne(je,Ge))[1]+=.0528035274542,je):me(je,Ge)}function Rt(je,Ge){return y(Ge)>.7109889596207567?((je=ne(je,Ge))[1]-=Ge>0?.0528035274542:-.0528035274542,je):me(je,Ge)}function Gt(je,Ge,et,lt){var gt=E(4*x/(2*et+(1+je-Ge/2)*h(2*et)+(je+Ge)/2*h(4*et)+Ge/2*h(6*et))),dt=E(lt*h(et)*E((1+je*t(2*et)+Ge*t(4*et))/(1+je+Ge))),St=et*Kt(1);function Xt(mr){return E(1+je*t(2*mr)+Ge*t(4*mr))}function Kt(mr){var wr=mr*et;return(2*wr+(1+je-Ge/2)*h(2*wr)+(je+Ge)/2*h(4*wr)+Ge/2*h(6*wr))/et}function Yt(mr){return Xt(mr)*h(mr)}var or=function(mr,wr){var Tr=et*ee(Kt,St*h(wr)/et,wr/x);isNaN(Tr)&&(Tr=et*l(wr));var Dr=gt*Xt(Tr);return[Dr*dt*mr/x*t(Tr),Dr/dt*h(Tr)]};return or.invert=function(mr,wr){var Tr=ee(Yt,wr*dt/gt);return[mr*x/(t(Tr)*gt*dt*Xt(Tr)),P(et*Kt(Tr/et)/St)]},et===0&&(gt=E(lt/x),(or=function(mr,wr){return[mr*gt,h(wr)/gt]}).invert=function(mr,wr){return[mr/gt,P(wr*gt)]}),or}function jt(je,Ge,et,lt,gt){lt===void 0&&(lt=1e-8),gt===void 0&&(gt=20);var dt=je(Ge),St=je(.5*(Ge+et)),Xt=je(et);return function Kt(Yt,or,mr,wr,Tr,Dr,nn,hn,Cn,Dn,Gn){if(Gn.nanEncountered)return NaN;var Rn,va,Sa,Ua,ja,Va,Ai,Ti,ci,ui;if(va=Yt(or+.25*(Rn=mr-or)),Sa=Yt(mr-.25*Rn),isNaN(va))Gn.nanEncountered=!0;else{if(!isNaN(Sa))return ui=((Va=(Ua=Rn*(wr+4*va+Tr)/12)+(ja=Rn*(Tr+4*Sa+Dr)/12))-nn)/15,Dn>Cn?(Gn.maxDepthCount++,Va+ui):Math.abs(ui)<hn?Va+ui:(Ti=Kt(Yt,or,Ai=or+.5*Rn,wr,va,Tr,Ua,.5*hn,Cn,Dn+1,Gn),isNaN(Ti)?(Gn.nanEncountered=!0,NaN):(ci=Kt(Yt,Ai,mr,Tr,Sa,Dr,ja,.5*hn,Cn,Dn+1,Gn),isNaN(ci)?(Gn.nanEncountered=!0,NaN):Ti+ci));Gn.nanEncountered=!0}}(je,Ge,et,dt,St,Xt,(dt+4*St+Xt)*(et-Ge)/6,lt,gt,1,{maxDepthCount:0,nanEncountered:!1})}function pr(je,Ge,et){function lt(Tr){return je+(1-je)*u(1-u(Tr,Ge),1/Ge)}function gt(Tr){return jt(lt,0,Tr,1e-4)}for(var dt=1/gt(1),St=1e3,Xt=(1+1e-8)*dt,Kt=[],Yt=0;Yt<=St;Yt++)Kt.push(gt(Yt/St)*Xt);function or(Tr){var Dr=0,nn=St,hn=500;do Kt[hn]>Tr?nn=hn:Dr=hn,hn=Dr+nn>>1;while(hn>Dr);var Cn=Kt[hn+1]-Kt[hn];return Cn&&(Cn=(Tr-Kt[hn+1])/Cn),(hn+1+Cn)/St}var mr=2*or(1)/x*dt/et,wr=function(Tr,Dr){var nn=or(y(h(Dr))),hn=lt(nn)*Tr;return nn/=mr,[hn,Dr>=0?nn:-nn]};return wr.invert=function(Tr,Dr){var nn;return y(Dr*=mr)<1&&(nn=l(Dr)*P(gt(y(Dr))*dt)),[Tr/lt(y(Dr)),nn]},wr}function Ar(je,Ge){return y(je[0]-Ge[0])<s&&y(je[1]-Ge[1])<s}function fr(je,Ge){for(var et,lt,gt,dt=-1,St=je.length,Xt=je[0],Kt=[];++dt<St;){lt=((et=je[dt])[0]-Xt[0])/Ge,gt=(et[1]-Xt[1])/Ge;for(var Yt=0;Yt<Ge;++Yt)Kt.push([Xt[0]+Yt*lt,Xt[1]+Yt*gt]);Xt=et}return Kt.push(et),Kt}function Zt(je){var Ge,et,lt,gt,dt,St,Xt,Kt=[],Yt=je[0].length;for(Xt=0;Xt<Yt;++Xt)et=(Ge=je[0][Xt])[0][0],lt=Ge[0][1],gt=Ge[1][1],dt=Ge[2][0],St=Ge[2][1],Kt.push(fr([[et+s,lt+s],[et+s,gt-s],[dt-s,gt-s],[dt-s,St+s]],30));for(Xt=je[1].length-1;Xt>=0;--Xt)et=(Ge=je[1][Xt])[0][0],lt=Ge[0][1],gt=Ge[1][1],dt=Ge[2][0],St=Ge[2][1],Kt.push(fr([[dt-s,St-s],[dt-s,gt+s],[et+s,gt+s],[et+s,lt-s]],30));return{type:"Polygon",coordinates:[b.merge(Kt)]}}function Qt(je,Ge,et){var lt,gt;function dt(Kt,Yt){for(var or=Yt<0?-1:1,mr=Ge[+(Yt<0)],wr=0,Tr=mr.length-1;wr<Tr&&Kt>mr[wr][2][0];++wr);var Dr=je(Kt-mr[wr][1][0],Yt);return Dr[0]+=je(mr[wr][1][0],or*Yt>or*mr[wr][0][1]?mr[wr][0][1]:Yt)[0],Dr}et?dt.invert=et(dt):je.invert&&(dt.invert=function(Kt,Yt){for(var or=gt[+(Yt<0)],mr=Ge[+(Yt<0)],wr=0,Tr=or.length;wr<Tr;++wr){var Dr=or[wr];if(Dr[0][0]<=Kt&&Kt<Dr[1][0]&&Dr[0][1]<=Yt&&Yt<Dr[1][1]){var nn=je.invert(Kt-je(mr[wr][1][0],0)[0],Yt);return nn[0]+=mr[wr][1][0],Ar(dt(nn[0],nn[1]),[Kt,Yt])?nn:null}}});var St=g.geoProjection(dt),Xt=St.stream;return St.stream=function(Kt){var Yt=St.rotate(),or=Xt(Kt),mr=(St.rotate([0,0]),Xt(Kt));return St.rotate(Yt),or.sphere=function(){g.geoStream(lt,mr)},or},St.lobes=function(Kt){return arguments.length?(lt=Zt(Kt),Ge=Kt.map(function(Yt){return Yt.map(function(or){return[[or[0][0]*I,or[0][1]*I],[or[1][0]*I,or[1][1]*I],[or[2][0]*I,or[2][1]*I]]})}),gt=Ge.map(function(Yt){return Yt.map(function(or){var mr,wr=je(or[0][0],or[0][1])[0],Tr=je(or[2][0],or[2][1])[0],Dr=je(or[1][0],or[0][1])[1],nn=je(or[1][0],or[1][1])[1];return Dr>nn&&(mr=Dr,Dr=nn,nn=mr),[[wr,Dr],[Tr,nn]]})}),St):Ge.map(function(Yt){return Yt.map(function(or){return[[or[0][0]*A,or[0][1]*A],[or[1][0]*A,or[1][1]*A],[or[2][0]*A,or[2][1]*A]]})})},Ge!=null&&St.lobes(Ge),St}Mt.invert=function(je,Ge){return Ge>-.7109889596207567?ne.invert(je,Ge-.0528035274542):me.invert(je,Ge)},Rt.invert=function(je,Ge){return y(Ge)>.7109889596207567?ne.invert(je,Ge+(Ge>0?.0528035274542:-.0528035274542)):me.invert(je,Ge)};var $t=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],hr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],vr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],Mr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],Nr=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],Ur=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Jr(je,Ge){return[3/L*je*E(x*x/3-Ge*Ge),Ge]}function mn(je){function Ge(et,lt){if(y(y(lt)-c)<s)return[0,lt<0?-2:2];var gt=h(lt),dt=u((1+gt)/(1-gt),je/2),St=.5*(dt+1/dt)+t(et*=je);return[2*h(et)/St,(dt-1/dt)/St]}return Ge.invert=function(et,lt){var gt=y(lt);if(y(gt-2)<s)return et?null:[0,l(lt)*c];if(gt>2)return null;var dt=(et/=2)*et,St=(lt/=2)*lt,Xt=2*lt/(1+dt+St);return Xt=u((1+Xt)/(1-Xt),1/je),[n(2*et,1-dt-St)/je,P((Xt-1)/(Xt+1))]},Ge}Jr.invert=function(je,Ge){return[L/3*je/E(x*x/3-Ge*Ge),Ge]};var en=x/w;function In(je,Ge){return[je*(1+E(t(Ge)))/2,Ge/(t(Ge/2)*t(je/6))]}function vn(je,Ge){var et=je*je,lt=Ge*Ge;return[je*(.975534+lt*(-.0143059*et-.119161+-.0547009*lt)),Ge*(1.00384+et*(.0802894+-.02855*lt+199025e-9*et)+lt*(.0998909+-.0491032*lt))]}function gn(je,Ge){return[h(je)/t(Ge),d(Ge)*t(je)]}function Sn(je){var Ge=t(je),et=d(T+je/2);function lt(gt,dt){var St=dt-je,Xt=y(St)<s?gt*Ge:y(Xt=T+dt/2)<s||y(y(Xt)-c)<s?0:gt*St/m(d(Xt)/et);return[Xt,St]}return lt.invert=function(gt,dt){var St,Xt=dt+je;return[y(dt)<s?gt/Ge:y(St=T+Xt/2)<s||y(y(St)-c)<s?0:gt*m(d(St)/et)/dt,Xt]},lt}function Xn(je,Ge){return[je,1.25*m(d(T+.4*Ge))]}function Br(je){var Ge=je.length-1;function et(lt,gt){for(var dt,St=t(gt),Xt=2/(1+St*t(lt)),Kt=Xt*St*h(lt),Yt=Xt*h(gt),or=Ge,mr=je[or],wr=mr[0],Tr=mr[1];--or>=0;)wr=(mr=je[or])[0]+Kt*(dt=wr)-Yt*Tr,Tr=mr[1]+Kt*Tr+Yt*dt;return[wr=Kt*(dt=wr)-Yt*Tr,Tr=Kt*Tr+Yt*dt]}return et.invert=function(lt,gt){var dt=20,St=lt,Xt=gt;do{for(var Kt,Yt=Ge,or=je[Yt],mr=or[0],wr=or[1],Tr=0,Dr=0;--Yt>=0;)Tr=mr+St*(Kt=Tr)-Xt*Dr,Dr=wr+St*Dr+Xt*Kt,mr=(or=je[Yt])[0]+St*(Kt=mr)-Xt*wr,wr=or[1]+St*wr+Xt*Kt;var nn,hn,Cn=(Tr=mr+St*(Kt=Tr)-Xt*Dr)*Tr+(Dr=wr+St*Dr+Xt*Kt)*Dr;St-=nn=((mr=St*(Kt=mr)-Xt*wr-lt)*Tr+(wr=St*wr+Xt*Kt-gt)*Dr)/Cn,Xt-=hn=(wr*Tr-mr*Dr)/Cn}while(y(nn)+y(hn)>1e-12&&--dt>0);if(dt){var Dn=E(St*St+Xt*Xt),Gn=2*e(.5*Dn),Rn=h(Gn);return[n(St*Rn,Dn*t(Gn)),Dn?P(Xt*Rn/Dn):0]}},et}In.invert=function(je,Ge){var et=y(je),lt=y(Ge),gt=s,dt=c;lt<en?dt*=lt/en:gt+=6*S(en/lt);for(var St=0;St<25;St++){var Xt=h(dt),Kt=E(t(dt)),Yt=h(dt/2),or=t(dt/2),mr=h(gt/6),wr=t(gt/6),Tr=.5*gt*(1+Kt)-et,Dr=dt/(or*wr)-lt,nn=Kt?-.25*gt*Xt/Kt:0,hn=.5*(1+Kt),Cn=(1+.5*dt*Yt/or)/(or*wr),Dn=dt/or*(mr/6)/(wr*wr),Gn=nn*Dn-Cn*hn,Rn=(Tr*Dn-Dr*hn)/Gn,va=(Dr*nn-Tr*Cn)/Gn;if(dt-=Rn,gt-=va,y(Rn)<s&&y(va)<s)break}return[je<0?-gt:gt,Ge<0?-dt:dt]},vn.invert=function(je,Ge){var et=l(je)*x,lt=Ge/2,gt=50;do{var dt=et*et,St=lt*lt,Xt=et*lt,Kt=et*(.975534+St*(-.0143059*dt-.119161+-.0547009*St))-je,Yt=lt*(1.00384+dt*(.0802894+-.02855*St+199025e-9*dt)+St*(.0998909+-.0491032*St))-Ge,or=.975534-St*(.119161+3*dt*.0143059+.0547009*St),mr=-Xt*(.238322+.2188036*St+.0286118*dt),wr=Xt*(.1605788+7961e-7*dt+-.0571*St),Tr=1.00384+dt*(.0802894+199025e-9*dt)+St*(3*(.0998909-.02855*dt)-.245516*St),Dr=mr*wr-Tr*or,nn=(Yt*mr-Kt*Tr)/Dr,hn=(Kt*wr-Yt*or)/Dr;et-=nn,lt-=hn}while((y(nn)>s||y(hn)>s)&&--gt>0);return gt&&[et,lt]},gn.invert=function(je,Ge){var et=je*je,lt=Ge*Ge+1,gt=et+lt,dt=je?_*E((gt-E(gt*gt-4*et))/et):1/E(lt);return[P(je*dt),l(Ge)*S(dt)]},Xn.invert=function(je,Ge){return[je,2.5*e(a(.8*Ge))-.625*x]};var pn=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],on=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],Yr=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Nn=[[.9245,0],[0,0],[.01943,0]],Hn=[[.721316,0],[0,0],[-.00881625,-.00617325]];function xn(je,Ge){var et=g.geoProjection(Br(je)).rotate(Ge).clipAngle(90),lt=g.geoRotation(Ge),gt=et.center;return delete et.rotate,et.center=function(dt){return arguments.length?gt(lt(dt)):lt.invert(gt())},et}var On=E(6),ua=E(7);function tr(je,Ge){var et=P(7*h(Ge)/(3*On));return[On*je*(2*t(2*et/3)-1)/ua,9*h(et/3)/ua]}function yr(je,Ge){for(var et,lt=(1+_)*h(Ge),gt=Ge,dt=0;dt<25&&(gt-=et=(h(gt/2)+h(gt)-lt)/(.5*t(gt/2)+t(gt)),!(y(et)<s));dt++);return[je*(1+2*t(gt)/t(gt/2))/(3*w),2*E(3)*h(gt/2)/E(2+w)]}function Ct(je,Ge){for(var et,lt=E(6/(4+x)),gt=(1+x/4)*h(Ge),dt=Ge/2,St=0;St<25&&(dt-=et=(dt/2+h(dt)-gt)/(.5+t(dt)),!(y(et)<s));St++);return[lt*(.5+t(dt))*je/1.5,lt*dt]}function lr(je,Ge){var et=Ge*Ge,lt=et*et,gt=et*lt;return[je*(.84719-.13063*et+gt*gt*(.05494*et-.04515-.02326*lt+.00331*gt)),Ge*(1.01183+lt*lt*(.01926*et-.02625-.00396*lt))]}function dr(je,Ge){return[je*(1+t(Ge))/2,2*(Ge-d(Ge/2))]}tr.invert=function(je,Ge){var et=3*P(Ge*ua/9);return[je*ua/(On*(2*t(2*et/3)-1)),P(3*h(et)*On/7)]},yr.invert=function(je,Ge){var et=Ge*E(2+w)/(2*E(3)),lt=2*P(et);return[3*w*je/(1+2*t(lt)/t(lt/2)),P((et+h(lt))/(1+_))]},Ct.invert=function(je,Ge){var et=E(6/(4+x)),lt=Ge/et;return y(y(lt)-c)<s&&(lt=lt<0?-c:c),[1.5*je/(et*(.5+t(lt))),P((lt/2+h(lt))/(1+x/4))]},lr.invert=function(je,Ge){var et,lt,gt,dt,St=Ge,Xt=25;do St-=et=(St*(1.01183+(gt=(lt=St*St)*lt)*gt*(.01926*lt-.02625-.00396*gt))-Ge)/(1.01183+gt*gt*(.21186*lt-.23625+-.05148*gt));while(y(et)>1e-12&&--Xt>0);return[je/(.84719-.13063*(lt=St*St)+(dt=lt*(gt=lt*lt))*dt*(.05494*lt-.04515-.02326*gt+.00331*dt)),St]},dr.invert=function(je,Ge){for(var et=Ge/2,lt=0,gt=1/0;lt<10&&y(gt)>s;++lt){var dt=t(Ge/2);Ge-=gt=(Ge-d(Ge/2)-et)/(1-.5/(dt*dt))}return[2*je/(1+t(Ge)),Ge]};var Fr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function Rr(je,Ge){var et=h(Ge),lt=t(Ge),gt=l(je);if(je===0||y(Ge)===c)return[0,Ge];if(Ge===0)return[je,0];if(y(je)===c)return[je*lt,c*et];var dt=x/(2*je)-2*je/x,St=2*Ge/x,Xt=(1-St*St)/(et-St),Kt=dt*dt,Yt=Xt*Xt,or=1+Kt/Yt,mr=1+Yt/Kt,wr=(dt*et/Xt-dt/2)/or,Tr=(Yt*et/Kt+Xt/2)/mr,Dr=Tr*Tr-(Yt*et*et/Kt+Xt*et-1)/mr;return[c*(wr+E(wr*wr+lt*lt/or)*gt),c*(Tr+E(Dr<0?0:Dr)*l(-Ge*dt)*gt)]}Rr.invert=function(je,Ge){var et=(je/=c)*je,lt=et+(Ge/=c)*Ge,gt=x*x;return[je?(lt-1+E((1-lt)*(1-lt)+4*et))/(2*je)*c:0,ee(function(dt){return lt*(x*h(dt)-2*dt)*x+4*dt*dt*(Ge-h(dt))+2*x*dt-gt*Ge},0)]};function zr(je,Ge){var et=Ge*Ge;return[je,Ge*(1.0148+et*et*(.23185+et*(.02406*et-.14499)))]}function Er(je,Ge){if(y(Ge)<s)return[je,0];var et=d(Ge),lt=je*h(Ge);return[h(lt)/et,Ge+(1-t(lt))/et]}function xr(je,Ge){var et=kr(je[1],je[0]),lt=kr(Ge[1],Ge[0]),gt=function(St,Xt){return n(St[0]*Xt[1]-St[1]*Xt[0],St[0]*Xt[0]+St[1]*Xt[1])}(et,lt),dt=Cr(et)/Cr(lt);return _r([1,0,je[0][0],0,1,je[0][1]],_r([dt,0,0,0,dt,0],_r([t(gt),h(gt),0,-h(gt),t(gt),0],[1,0,-Ge[0][0],0,1,-Ge[0][1]])))}function _r(je,Ge){return[je[0]*Ge[0]+je[1]*Ge[3],je[0]*Ge[1]+je[1]*Ge[4],je[0]*Ge[2]+je[1]*Ge[5]+je[2],je[3]*Ge[0]+je[4]*Ge[3],je[3]*Ge[1]+je[4]*Ge[4],je[3]*Ge[2]+je[4]*Ge[5]+je[5]]}function kr(je,Ge){return[je[0]-Ge[0],je[1]-Ge[1]]}function Cr(je){return E(je[0]*je[0]+je[1]*je[1])}function Gr(je,Ge,et){function lt(St,Xt){var Kt,Yt=Ge(St,Xt),or=Yt.project([St*A,Xt*A]);return(Kt=Yt.transform)?[Kt[0]*or[0]+Kt[1]*or[1]+Kt[2],-(Kt[3]*or[0]+Kt[4]*or[1]+Kt[5])]:(or[1]=-or[1],or)}(function St(Xt,Kt){if(Xt.edges=function(Dr){for(var nn=Dr.length,hn=[],Cn=Dr[nn-1],Dn=0;Dn<nn;++Dn)hn.push([Cn,Cn=Dr[Dn]]);return hn}(Xt.face),Kt.face){var Yt=Xt.shared=function(Dr,nn){for(var hn,Cn,Dn=Dr.length,Gn=null,Rn=0;Rn<Dn;++Rn){hn=Dr[Rn];for(var va=nn.length;--va>=0;)if(Cn=nn[va],hn[0]===Cn[0]&&hn[1]===Cn[1]){if(Gn)return[Gn,hn];Gn=hn}}}(Xt.face,Kt.face),or=xr(Yt.map(Kt.project),Yt.map(Xt.project));Xt.transform=Kt.transform?_r(Kt.transform,or):or;for(var mr=Kt.edges,wr=0,Tr=mr.length;wr<Tr;++wr)qr(Yt[0],mr[wr][1])&&qr(Yt[1],mr[wr][0])&&(mr[wr]=Xt),qr(Yt[0],mr[wr][0])&&qr(Yt[1],mr[wr][1])&&(mr[wr]=Xt);for(mr=Xt.edges,wr=0,Tr=mr.length;wr<Tr;++wr)qr(Yt[0],mr[wr][0])&&qr(Yt[1],mr[wr][1])&&(mr[wr]=Kt),qr(Yt[0],mr[wr][1])&&qr(Yt[1],mr[wr][0])&&(mr[wr]=Kt)}else Xt.transform=Kt.transform;return Xt.children&&Xt.children.forEach(function(Dr){St(Dr,Xt)}),Xt})(je,{transform:null}),tn(je)&&(lt.invert=function(St,Xt){var Kt=function Yt(or,mr){var wr=or.project.invert,Tr=or.transform,Dr=mr;if(Tr&&(Tr=function(Gn){var Rn=1/(Gn[0]*Gn[4]-Gn[1]*Gn[3]);return[Rn*Gn[4],-Rn*Gn[1],Rn*(Gn[1]*Gn[5]-Gn[2]*Gn[4]),-Rn*Gn[3],Rn*Gn[0],Rn*(Gn[2]*Gn[3]-Gn[0]*Gn[5])]}(Tr),Dr=[Tr[0]*Dr[0]+Tr[1]*Dr[1]+Tr[2],Tr[3]*Dr[0]+Tr[4]*Dr[1]+Tr[5]]),wr&&or===function(Gn){return Ge(Gn[0]*I,Gn[1]*I)}(nn=wr(Dr)))return nn;for(var nn,hn=or.children,Cn=0,Dn=hn&&hn.length;Cn<Dn;++Cn)if(nn=Yt(hn[Cn],mr))return nn}(je,[St,-Xt]);return Kt&&(Kt[0]*=I,Kt[1]*=I,Kt)});var gt=g.geoProjection(lt),dt=gt.stream;return gt.stream=function(St){var Xt=gt.rotate(),Kt=dt(St),Yt=(gt.rotate([0,0]),dt(St));return gt.rotate(Xt),Kt.sphere=function(){Yt.polygonStart(),Yt.lineStart(),function or(mr,wr,Tr){var Dr,nn,hn=wr.edges,Cn=hn.length,Dn={type:"MultiPoint",coordinates:wr.face},Gn=wr.face.filter(function(Ai){return y(Ai[1])!==90}),Rn=g.geoBounds({type:"MultiPoint",coordinates:Gn}),va=!1,Sa=-1,Ua=Rn[1][0]-Rn[0][0],ja=Ua===180||Ua===360?[(Rn[0][0]+Rn[1][0])/2,(Rn[0][1]+Rn[1][1])/2]:g.geoCentroid(Dn);if(Tr)for(;++Sa<Cn&&hn[Sa]!==Tr;);++Sa;for(var Va=0;Va<Cn;++Va)nn=hn[(Va+Sa)%Cn],Array.isArray(nn)?(va||(mr.point((Dr=g.geoInterpolate(nn[0],ja)(s))[0],Dr[1]),va=!0),mr.point((Dr=g.geoInterpolate(nn[1],ja)(s))[0],Dr[1])):(va=!1,nn!==Tr&&or(mr,nn,wr))}(Yt,je),Yt.lineEnd(),Yt.polygonEnd()},Kt},gt.angle(et==null?-30:et*A)}function qr(je,Ge){return je&&Ge&&je[0]===Ge[0]&&je[1]===Ge[1]}function tn(je){return je.project.invert||je.children&&je.children.some(tn)}zr.invert=function(je,Ge){Ge>1.790857183?Ge=1.790857183:Ge<-1.790857183&&(Ge=-1.790857183);var et,lt=Ge;do{var gt=lt*lt;lt-=et=(lt*(1.0148+gt*gt*(.23185+gt*(.02406*gt-.14499)))-Ge)/(1.0148+gt*gt*(5*.23185+gt*(.21654*gt-1.01493)))}while(y(et)>s);return[je,lt]},Er.invert=function(je,Ge){if(y(Ge)<s)return[je,0];var et,lt=je*je+Ge*Ge,gt=.5*Ge,dt=10;do{var St=d(gt),Xt=1/t(gt),Kt=lt-2*Ge*gt+gt*gt;gt-=et=(St*Kt+2*(gt-Ge))/(2+Kt*Xt*Xt+2*(gt-Ge)*St)}while(y(et)>s&&--dt>0);return St=d(gt),[(y(Ge)<y(gt+1/St)?P(je*St):l(Ge)*l(je)*(S(y(je*St))+c))/h(gt),gt]};var rn=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],yn=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(je){return je.map(function(Ge){return rn[Ge]})}),_n=2/E(3);function wn(je,Ge){var et=ze(je,Ge);return[et[0]*_n,et[1]]}function Ln(je,Ge){for(var et=0,lt=je.length,gt=0;et<lt;++et)gt+=je[et]*Ge[et];return gt}function zn(je){return[n(je[1],je[0])*A,P(o(-1,i(1,je[2])))*A]}function Zn(je){var Ge=je[0]*I,et=je[1]*I,lt=t(et);return[lt*t(Ge),lt*h(Ge),h(et)]}function Aa(){}function Ma(je,Ge){return{type:"FeatureCollection",features:je.features.map(function(et){return An(et,Ge)})}}function An(je,Ge){return{type:"Feature",id:je.id,properties:je.properties,geometry:ea(je.geometry,Ge)}}function ea(je,Ge){if(!je)return null;if(je.type==="GeometryCollection")return function(lt,gt){return{type:"GeometryCollection",geometries:lt.geometries.map(function(dt){return ea(dt,gt)})}}(je,Ge);var et;switch(je.type){case"Point":case"MultiPoint":et=vi;break;case"LineString":case"MultiLineString":et=Fi;break;case"Polygon":case"MultiPolygon":case"Sphere":et=po;break;default:return null}return g.geoStream(je,Ge(et)),et.result()}wn.invert=function(je,Ge){return ze.invert(je/_n,Ge)};var Qn=[],za=[],vi={point:function(je,Ge){Qn.push([je,Ge])},result:function(){var je=Qn.length?Qn.length<2?{type:"Point",coordinates:Qn[0]}:{type:"MultiPoint",coordinates:Qn}:null;return Qn=[],je}},Fi={lineStart:Aa,point:function(je,Ge){Qn.push([je,Ge])},lineEnd:function(){Qn.length&&(za.push(Qn),Qn=[])},result:function(){var je=za.length?za.length<2?{type:"LineString",coordinates:za[0]}:{type:"MultiLineString",coordinates:za}:null;return za=[],je}},po={polygonStart:Aa,lineStart:Aa,point:function(je,Ge){Qn.push([je,Ge])},lineEnd:function(){var je=Qn.length;if(je){do Qn.push(Qn[0].slice());while(++je<4);za.push(Qn),Qn=[]}},polygonEnd:Aa,result:function(){if(!za.length)return null;var je=[],Ge=[];return za.forEach(function(et){(function(lt){if((gt=lt.length)<4)return!1;for(var gt,dt=0,St=lt[gt-1][1]*lt[0][0]-lt[gt-1][0]*lt[0][1];++dt<gt;)St+=lt[dt-1][1]*lt[dt][0]-lt[dt-1][0]*lt[dt][1];return St<=0})(et)?je.push([et]):Ge.push(et)}),Ge.forEach(function(et){var lt=et[0];je.some(function(gt){if(function(dt,St){for(var Xt=St[0],Kt=St[1],Yt=!1,or=0,mr=dt.length,wr=mr-1;or<mr;wr=or++){var Tr=dt[or],Dr=Tr[0],nn=Tr[1],hn=dt[wr],Cn=hn[0],Dn=hn[1];nn>Kt^Dn>Kt&&Xt<(Cn-Dr)*(Kt-nn)/(Dn-nn)+Dr&&(Yt=!Yt)}return Yt}(gt[0],lt))return gt.push(et),!0})||je.push([et])}),za=[],je.length?je.length>1?{type:"MultiPolygon",coordinates:je}:{type:"Polygon",coordinates:je[0]}:null}};function Xa(je){var Ge=je(c,0)[0]-je(-c,0)[0];function et(lt,gt){var dt=y(lt)<c,St=je(dt?lt:lt>0?lt-x:lt+x,gt),Xt=(St[0]-St[1])*_,Kt=(St[0]+St[1])*_;if(dt)return[Xt,Kt];var Yt=Ge*_,or=Xt>0^Kt>0?-1:1;return[or*Xt-l(Kt)*Yt,or*Kt-l(Xt)*Yt]}return je.invert&&(et.invert=function(lt,gt){var dt=(lt+gt)*_,St=(gt-lt)*_,Xt=y(dt)<.5*Ge&&y(St)<.5*Ge;if(!Xt){var Kt=Ge*_,Yt=dt>0^St>0?-1:1,or=-Yt*lt+(St>0?1:-1)*Kt,mr=-Yt*gt+(dt>0?1:-1)*Kt;dt=(-or-mr)*_,St=(or-mr)*_}var wr=je.invert(dt,St);return Xt||(wr[0]+=dt>0?x:-x),wr}),g.geoProjection(et).rotate([-90,-90,45]).clipAngle(179.999)}function Za(){return Xa(Pt).scale(111.48)}function eo(je){var Ge=h(je);function et(lt,gt){var dt=Ge?d(lt*Ge/2)/Ge:lt/2;if(!gt)return[2*dt,-je];var St=2*e(dt*h(gt)),Xt=1/d(gt);return[h(St)*Xt,gt+(1-t(St))*Xt-je]}return et.invert=function(lt,gt){if(y(gt+=je)<s)return[Ge?2*e(Ge*lt/2)/Ge:lt,0];var dt,St=lt*lt+gt*gt,Xt=0,Kt=10;do{var Yt=d(Xt),or=1/t(Xt),mr=St-2*gt*Xt+Xt*Xt;Xt-=dt=(Yt*mr+2*(Xt-gt))/(2+mr*or*or+2*(Xt-gt)*Yt)}while(y(dt)>s&&--Kt>0);var wr=lt*(Yt=d(Xt)),Tr=d(y(gt)<y(Xt+1/Yt)?.5*P(wr):.5*S(wr)+x/4)/h(Xt);return[Ge?2*e(Ge*Tr)/Ge:2*Tr,Xt]},et}var Na=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function mo(je,Ge){var et,lt=i(18,36*y(Ge)/x),gt=r(lt),dt=lt-gt,St=(et=Na[gt])[0],Xt=et[1],Kt=(et=Na[++gt])[0],Yt=et[1],or=(et=Na[i(19,++gt)])[0],mr=et[1];return[je*(Kt+dt*(or-St)/2+dt*dt*(or-2*Kt+St)/2),(Ge>0?c:-c)*(Yt+dt*(mr-Xt)/2+dt*dt*(mr-2*Yt+Xt)/2)]}function bo(je,Ge){var et=function(St){function Xt(Kt,Yt){var or=t(Yt),mr=(St-1)/(St-or*t(Kt));return[mr*or*h(Kt),mr*h(Yt)]}return Xt.invert=function(Kt,Yt){var or=Kt*Kt+Yt*Yt,mr=E(or),wr=(St-E(1-or*(St+1)/(St-1)))/((St-1)/mr+mr/(St-1));return[n(Kt*wr,mr*E(1-wr*wr)),mr?P(Yt*wr/mr):0]},Xt}(je);if(!Ge)return et;var lt=t(Ge),gt=h(Ge);function dt(St,Xt){var Kt=et(St,Xt),Yt=Kt[1],or=Yt*gt/(je-1)+lt;return[Kt[0]*lt/or,Yt/or]}return dt.invert=function(St,Xt){var Kt=(je-1)/(je-1-Xt*gt);return et.invert(Kt*St,Kt*Xt*lt)},dt}Na.forEach(function(je){je[1]*=1.0144}),mo.invert=function(je,Ge){var et=Ge/c,lt=90*et,gt=i(18,y(lt/5)),dt=o(0,r(gt));do{var St=Na[dt][1],Xt=Na[dt+1][1],Kt=Na[i(19,dt+2)][1],Yt=Kt-St,or=Kt-2*Xt+St,mr=2*(y(et)-Xt)/Yt,wr=or/Yt,Tr=mr*(1-wr*mr*(1-2*wr*mr));if(Tr>=0||dt===1){lt=(Ge>=0?5:-5)*(Tr+gt);var Dr,nn=50;do Tr=(gt=i(18,y(lt)/5))-(dt=r(gt)),St=Na[dt][1],Xt=Na[dt+1][1],Kt=Na[i(19,dt+2)][1],lt-=(Dr=(Ge>=0?c:-c)*(Xt+Tr*(Kt-St)/2+Tr*Tr*(Kt-2*Xt+St)/2)-Ge)*A;while(y(Dr)>1e-12&&--nn>0);break}}while(--dt>=0);var hn=Na[dt][0],Cn=Na[dt+1][0],Dn=Na[i(19,dt+2)][0];return[je/(Cn+Tr*(Dn-hn)/2+Tr*Tr*(Dn-2*Cn+hn)/2),lt*I]};var Mi=-179.9999,to=179.9999,_o=-89.9999;function Co(je){return je.length>0}function Ui(je){return je===-90||je===90?[0,je]:[-180,(Ge=je,Math.floor(1e4*Ge)/1e4)];var Ge}function yi(je){var Ge=je[0],et=je[1],lt=!1;return Ge<=Mi?(Ge=-180,lt=!0):Ge>=to&&(Ge=180,lt=!0),et<=_o?(et=-90,lt=!0):et>=89.9999&&(et=90,lt=!0),lt?[Ge,et]:je}function Ki(je){return je.map(yi)}function Ts(je,Ge,et){for(var lt=0,gt=je.length;lt<gt;++lt){var dt=je[lt].slice();et.push({index:-1,polygon:Ge,ring:dt});for(var St=0,Xt=dt.length;St<Xt;++St){var Kt=dt[St],Yt=Kt[0],or=Kt[1];if(Yt<=Mi||Yt>=to||or<=_o||or>=89.9999){dt[St]=yi(Kt);for(var mr=St+1;mr<Xt;++mr){var wr=dt[mr],Tr=wr[0],Dr=wr[1];if(Tr>Mi&&Tr<to&&Dr>_o&&Dr<89.9999)break}if(mr===St+1)continue;if(St){var nn={index:-1,polygon:Ge,ring:dt.slice(0,St+1)};nn.ring[nn.ring.length-1]=Ui(or),et[et.length-1]=nn}else et.pop();if(mr>=Xt)break;et.push({index:-1,polygon:Ge,ring:dt=dt.slice(mr-1)}),dt[0]=Ui(dt[0][1]),St=-1,Xt=dt.length}}}}function Es(je){var Ge,et,lt,gt,dt,St,Xt=je.length,Kt={},Yt={};for(Ge=0;Ge<Xt;++Ge)lt=(et=je[Ge]).ring[0],dt=et.ring[et.ring.length-1],lt[0]!==dt[0]||lt[1]!==dt[1]?(et.index=Ge,Kt[lt]=Yt[dt]=et):(et.polygon.push(et.ring),je[Ge]=null);for(Ge=0;Ge<Xt;++Ge)if(et=je[Ge]){if(lt=et.ring[0],dt=et.ring[et.ring.length-1],gt=Yt[lt],St=Kt[dt],delete Kt[lt],delete Yt[dt],lt[0]===dt[0]&&lt[1]===dt[1]){et.polygon.push(et.ring);continue}gt?(delete Yt[lt],delete Kt[gt.ring[0]],gt.ring.pop(),je[gt.index]=null,et={index:-1,polygon:gt.polygon,ring:gt.ring.concat(et.ring)},gt===St?et.polygon.push(et.ring):(et.index=Xt++,je.push(Kt[et.ring[0]]=Yt[et.ring[et.ring.length-1]]=et))):St?(delete Kt[dt],delete Yt[St.ring[St.ring.length-1]],et.ring.pop(),et={index:Xt++,polygon:St.polygon,ring:et.ring.concat(St.ring)},je[St.index]=null,je.push(Kt[et.ring[0]]=Yt[et.ring[et.ring.length-1]]=et)):(et.ring.push(et.ring[0]),et.polygon.push(et.ring))}}function Ja(je){var Ge={type:"Feature",geometry:vs(je.geometry)};return je.id!=null&&(Ge.id=je.id),je.bbox!=null&&(Ge.bbox=je.bbox),je.properties!=null&&(Ge.properties=je.properties),Ge}function vs(je){if(je==null)return je;var Ge,et,lt,gt;switch(je.type){case"GeometryCollection":Ge={type:"GeometryCollection",geometries:je.geometries.map(vs)};break;case"Point":Ge={type:"Point",coordinates:yi(je.coordinates)};break;case"MultiPoint":case"LineString":Ge={type:je.type,coordinates:Ki(je.coordinates)};break;case"MultiLineString":Ge={type:"MultiLineString",coordinates:je.coordinates.map(Ki)};break;case"Polygon":var dt=[];Ts(je.coordinates,dt,et=[]),Es(et),Ge={type:"Polygon",coordinates:dt};break;case"MultiPolygon":et=[],lt=-1,gt=je.coordinates.length;for(var St=new Array(gt);++lt<gt;)Ts(je.coordinates[lt],St[lt]=[],et);Es(et),Ge={type:"MultiPolygon",coordinates:St.filter(Co)};break;default:return je}return je.bbox!=null&&(Ge.bbox=je.bbox),Ge}function rs(je,Ge){var et=d(Ge/2),lt=h(T*et);return[je*(.74482-.34588*lt*lt),1.70711*et]}function Ls(je,Ge,et){var lt=g.geoInterpolate(Ge,et),gt=lt(.5),dt=g.geoRotation([-gt[0],-gt[1]])(Ge),St=lt.distance/2,Xt=-P(h(dt[1]*I)/h(St)),Kt=[-gt[0],-gt[1],-(dt[0]>0?x-Xt:Xt)*A],Yt=g.geoProjection(je(St)).rotate(Kt),or=g.geoRotation(Kt),mr=Yt.center;return delete Yt.rotate,Yt.center=function(wr){return arguments.length?mr(or(wr)):or.invert(mr())},Yt.clipAngle(90)}function Cs(je){var Ge=t(je);function et(lt,gt){var dt=g.geoGnomonicRaw(lt,gt);return dt[0]*=Ge,dt}return et.invert=function(lt,gt){return g.geoGnomonicRaw.invert(lt/Ge,gt)},et}function ks(je,Ge){return Ls(Cs,je,Ge)}function Ps(je){if(!(je*=2))return g.geoAzimuthalEquidistantRaw;var Ge=-je/2,et=-Ge,lt=je*je,gt=d(et),dt=.5/h(et);function St(Xt,Kt){var Yt=S(t(Kt)*t(Xt-Ge)),or=S(t(Kt)*t(Xt-et));return[((Yt*=Yt)-(or*=or))/(2*je),(Kt<0?-1:1)*E(4*lt*or-(lt-Yt+or)*(lt-Yt+or))/(2*je)]}return St.invert=function(Xt,Kt){var Yt,or,mr=Kt*Kt,wr=t(E(mr+(Yt=Xt+Ge)*Yt)),Tr=t(E(mr+(Yt=Xt+et)*Yt));return[n(or=wr-Tr,Yt=(wr+Tr)*gt),(Kt<0?-1:1)*S(E(Yt*Yt+or*or)*dt)]},St}function Oo(je,Ge){return Ls(Ps,je,Ge)}function zo(je,Ge){if(y(Ge)<s)return[je,0];var et=y(Ge/c),lt=P(et);if(y(je)<s||y(y(Ge)-c)<s)return[0,l(Ge)*x*d(lt/2)];var gt=t(lt),dt=y(x/je-je/x)/2,St=dt*dt,Xt=gt/(et+gt-1),Kt=Xt*(2/et-1),Yt=Kt*Kt,or=Yt+St,mr=Xt-Yt,wr=St+Xt;return[l(je)*x*(dt*mr+E(St*mr*mr-or*(Xt*Xt-Yt)))/or,l(Ge)*x*(Kt*wr-dt*E((St+1)*or-wr*wr))/or]}function Go(je,Ge){if(y(Ge)<s)return[je,0];var et=y(Ge/c),lt=P(et);if(y(je)<s||y(y(Ge)-c)<s)return[0,l(Ge)*x*d(lt/2)];var gt=t(lt),dt=y(x/je-je/x)/2,St=dt*dt,Xt=gt*(E(1+St)-dt*gt)/(1+St*et*et);return[l(je)*x*Xt,l(Ge)*x*E(1-Xt*(2*dt+Xt))]}function Yo(je,Ge){if(y(Ge)<s)return[je,0];var et=Ge/c,lt=P(et);if(y(je)<s||y(y(Ge)-c)<s)return[0,x*d(lt/2)];var gt=(x/je-je/x)/2,dt=et/(1+t(lt));return[x*(l(je)*E(gt*gt+1-dt*dt)-gt),x*dt]}function Wo(je,Ge){if(!Ge)return[je,0];var et=y(Ge);if(!je||et===c)return[0,Ge];var lt=et/c,gt=lt*lt,dt=(8*lt-gt*(gt+2)-5)/(2*gt*(lt-1)),St=dt*dt,Xt=lt*dt,Kt=gt+St+2*Xt,Yt=lt+3*dt,or=je/c,mr=or+1/or,wr=l(y(je)-c)*E(mr*mr-4),Tr=wr*wr,Dr=(wr*(Kt+St-1)+2*E(Kt*(gt+St*Tr-1)+(1-gt)*(gt*(Yt*Yt+4*St)+12*Xt*St+4*St*St)))/(4*Kt+Tr);return[l(je)*c*Dr,l(Ge)*c*E(1+wr*y(Dr)-Dr*Dr)]}function ns(je,Ge,et,lt){var gt=x/3;je=o(je,s),Ge=o(Ge,s),je=i(je,c),Ge=i(Ge,x-s),et=o(et,0),et=i(et,100-s);var dt=(lt=o(lt,s))/100,St=S((et/100+1)*t(gt))/gt,Xt=h(je)/h(St*c),Kt=Ge/x,Yt=E(dt*h(je/2)/h(Ge/2));return function(or,mr,wr,Tr,Dr){function nn(hn,Cn){var Dn=wr*h(Tr*Cn),Gn=E(1-Dn*Dn),Rn=E(2/(1+Gn*t(hn*=Dr)));return[or*Gn*Rn*h(hn),mr*Dn*Rn]}return nn.invert=function(hn,Cn){var Dn=hn/or,Gn=Cn/mr,Rn=E(Dn*Dn+Gn*Gn),va=2*P(Rn/2);return[n(hn*d(va),or*Rn)/Dr,Rn&&P(Cn*h(va)/(mr*wr*Rn))/Tr]},nn}(Yt/E(Kt*Xt*St),1/(Yt*E(Kt*Xt*St)),Xt,St,Kt)}function wo(){var je=65*I,Ge=60*I,et=20,lt=200,gt=g.geoProjectionMutator(ns),dt=gt(je,Ge,et,lt);return dt.poleline=function(St){return arguments.length?gt(je=+St*I,Ge,et,lt):je*A},dt.parallels=function(St){return arguments.length?gt(je,Ge=+St*I,et,lt):Ge*A},dt.inflation=function(St){return arguments.length?gt(je,Ge,et=+St,lt):et},dt.ratio=function(St){return arguments.length?gt(je,Ge,et,lt=+St):lt},dt.scale(163.775)}rs.invert=function(je,Ge){var et=Ge/1.70711,lt=h(T*et);return[je/(.74482-.34588*lt*lt),2*e(et)]},zo.invert=function(je,Ge){if(y(Ge)<s)return[je,0];if(y(je)<s)return[0,c*h(2*e(Ge/x))];var et=(je/=x)*je,lt=(Ge/=x)*Ge,gt=et+lt,dt=gt*gt,St=-y(Ge)*(1+gt),Xt=St-2*lt+et,Kt=-2*St+1+2*lt+dt,Yt=lt/Kt+(2*Xt*Xt*Xt/(Kt*Kt*Kt)-9*St*Xt/(Kt*Kt))/27,or=(St-Xt*Xt/(3*Kt))/Kt,mr=2*E(-or/3),wr=S(3*Yt/(or*mr))/3;return[x*(gt-1+E(1+2*(et-lt)+dt))/(2*je),l(Ge)*x*(-mr*t(wr+x/3)-Xt/(3*Kt))]},Go.invert=function(je,Ge){if(!je)return[0,c*h(2*e(Ge/x))];var et=y(je/x),lt=(1-et*et-(Ge/=x)*Ge)/(2*et),gt=E(lt*lt+1);return[l(je)*x*(gt-lt),l(Ge)*c*h(2*n(E((1-2*lt*et)*(lt+gt)-et),E(gt+lt+et)))]},Yo.invert=function(je,Ge){if(!Ge)return[je,0];var et=Ge/x,lt=(x*x*(1-et*et)-je*je)/(2*x*je);return[je?x*(l(je)*E(lt*lt+1)-lt):0,c*h(2*e(et))]},Wo.invert=function(je,Ge){var et;if(!je||!Ge)return[je,Ge];Ge/=x;var lt=l(je)*je/c,gt=(lt*lt-1+4*Ge*Ge)/y(lt),dt=gt*gt,St=2*Ge,Xt=50;do{var Kt=St*St,Yt=(8*St-Kt*(Kt+2)-5)/(2*Kt*(St-1)),or=(3*St-Kt*St-10)/(2*Kt*St),mr=Yt*Yt,wr=St*Yt,Tr=St+Yt,Dr=Tr*Tr,nn=St+3*Yt,hn=-2*Tr*(4*wr*mr+(1-4*Kt+3*Kt*Kt)*(1+or)+mr*(14*Kt-6-dt+(8*Kt-8-2*dt)*or)+wr*(12*Kt-8+(10*Kt-10-dt)*or)),Cn=E(Dr*(Kt+mr*dt-1)+(1-Kt)*(Kt*(nn*nn+4*mr)+mr*(12*wr+4*mr)));St-=et=(gt*(Dr+mr-1)+2*Cn-lt*(4*Dr+dt))/(gt*(2*Yt*or+2*Tr*(1+or))+hn/Cn-8*Tr*(gt*(-1+mr+Dr)+2*Cn)*(1+or)/(dt+4*Dr))}while(et>s&&--Xt>0);return[l(je)*(E(gt*gt+4)+gt)*x/4,c*St]};var ys=4*x+3*E(3),go=2*E(2*x*E(3)/ys),Xo=re(go*E(3)/x,go,ys/6);function xs(je,Ge){return[je*E(1-3*Ge*Ge/(x*x)),Ge]}function Do(je,Ge){var et=t(Ge),lt=t(je)*et,gt=1-lt,dt=t(je=n(h(je)*et,-h(Ge))),St=h(je);return[St*(et=E(1-lt*lt))-dt*gt,-dt*et-St*gt]}function Ya(je,Ge){var et=V(je,Ge);return[(et[0]+je/c)/2,(et[1]+Ge)/2]}xs.invert=function(je,Ge){return[je/E(1-3*Ge*Ge/(x*x)),Ge]},Do.invert=function(je,Ge){var et=(je*je+Ge*Ge)/-2,lt=E(-et*(2+et)),gt=Ge*et+je*lt,dt=je*et-Ge*lt,St=E(dt*dt+gt*gt);return[n(lt*gt,St*(1+et)),St?-P(lt*dt/St):0]},Ya.invert=function(je,Ge){var et=je,lt=Ge,gt=25;do{var dt,St=t(lt),Xt=h(lt),Kt=h(2*lt),Yt=Xt*Xt,or=St*St,mr=h(et),wr=t(et/2),Tr=h(et/2),Dr=Tr*Tr,nn=1-or*wr*wr,hn=nn?S(St*wr)*E(dt=1/nn):dt=0,Cn=.5*(2*hn*St*Tr+et/c)-je,Dn=.5*(hn*Xt+lt)-Ge,Gn=.5*dt*(or*Dr+hn*St*wr*Yt)+.5/c,Rn=dt*(mr*Kt/4-hn*Xt*Tr),va=.125*dt*(Kt*Tr-hn*Xt*or*mr),Sa=.5*dt*(Yt*wr+hn*Dr*St)+.5,Ua=Rn*va-Sa*Gn,ja=(Dn*Rn-Cn*Sa)/Ua,Va=(Cn*va-Dn*Gn)/Ua;et-=ja,lt-=Va}while((y(ja)>s||y(Va)>s)&&--gt>0);return[et,lt]},p.geoNaturalEarth=g.geoNaturalEarth1,p.geoNaturalEarthRaw=g.geoNaturalEarth1Raw,p.geoAiry=function(){var je=c,Ge=g.geoProjectionMutator(H),et=Ge(je);return et.radius=function(lt){return arguments.length?Ge(je=lt*I):je*A},et.scale(179.976).clipAngle(147)},p.geoAiryRaw=H,p.geoAitoff=function(){return g.geoProjection(V).scale(152.63)},p.geoAitoffRaw=V,p.geoArmadillo=function(){var je=20*I,Ge=je>=0?1:-1,et=d(Ge*je),lt=g.geoProjectionMutator(X),gt=lt(je),dt=gt.stream;return gt.parallel=function(St){return arguments.length?(et=d((Ge=(je=St*I)>=0?1:-1)*je),lt(je)):je*A},gt.stream=function(St){var Xt=gt.rotate(),Kt=dt(St),Yt=(gt.rotate([0,0]),dt(St)),or=gt.precision();return gt.rotate(Xt),Kt.sphere=function(){Yt.polygonStart(),Yt.lineStart();for(var mr=-180*Ge;Ge*mr<180;mr+=90*Ge)Yt.point(mr,90*Ge);if(je)for(;Ge*(mr-=3*Ge*or)>=-180;)Yt.point(mr,Ge*-n(t(mr*I/2),et)*A);Yt.lineEnd(),Yt.polygonEnd()},Kt},gt.scale(218.695).center([0,28.0974])},p.geoArmadilloRaw=X,p.geoAugust=function(){return g.geoProjection($).scale(66.1603)},p.geoAugustRaw=$,p.geoBaker=function(){return g.geoProjection(te).scale(112.314)},p.geoBakerRaw=te,p.geoBerghaus=function(){var je=5,Ge=g.geoProjectionMutator(N),et=Ge(je),lt=et.stream,gt=-t(.01*I),dt=h(.01*I);return et.lobes=function(St){return arguments.length?Ge(je=+St):je},et.stream=function(St){var Xt=et.rotate(),Kt=lt(St),Yt=(et.rotate([0,0]),lt(St));return et.rotate(Xt),Kt.sphere=function(){Yt.polygonStart(),Yt.lineStart();for(var or=0,mr=360/je,wr=2*x/je,Tr=90-180/je,Dr=c;or<je;++or,Tr-=mr,Dr-=wr)Yt.point(n(dt*t(Dr),gt)*A,P(dt*h(Dr))*A),Tr<-90?(Yt.point(-90,-180-Tr-.01),Yt.point(-90,-180-Tr+.01)):(Yt.point(90,Tr+.01),Yt.point(90,Tr-.01));Yt.lineEnd(),Yt.polygonEnd()},Kt},et.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},p.geoBerghausRaw=N,p.geoBertin1953=function(){return g.geoProjection(Q()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},p.geoBertin1953Raw=Q,p.geoBoggs=function(){return g.geoProjection(de).scale(160.857)},p.geoBoggsRaw=de,p.geoBonne=function(){return se(Te).scale(123.082).center([0,26.1441]).parallel(45)},p.geoBonneRaw=Te,p.geoBottomley=function(){var je=.5,Ge=g.geoProjectionMutator(_e),et=Ge(je);return et.fraction=function(lt){return arguments.length?Ge(je=+lt):je},et.scale(158.837)},p.geoBottomleyRaw=_e,p.geoBromley=function(){return g.geoProjection(be).scale(152.63)},p.geoBromleyRaw=be,p.geoChamberlin=Le,p.geoChamberlinRaw=Me,p.geoChamberlinAfrica=function(){return Le([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},p.geoCollignon=function(){return g.geoProjection(ze).scale(95.6464).center([0,30])},p.geoCollignonRaw=ze,p.geoCraig=function(){return se(Re).scale(249.828).clipAngle(90)},p.geoCraigRaw=Re,p.geoCraster=function(){return g.geoProjection(Ze).scale(156.19)},p.geoCrasterRaw=Ze,p.geoCylindricalEqualArea=function(){return se(Pe).parallel(38.58).scale(195.044)},p.geoCylindricalEqualAreaRaw=Pe,p.geoCylindricalStereographic=function(){return se(Ie).scale(124.75)},p.geoCylindricalStereographicRaw=Ie,p.geoEckert1=function(){return g.geoProjection(Be).scale(165.664)},p.geoEckert1Raw=Be,p.geoEckert2=function(){return g.geoProjection(Fe).scale(165.664)},p.geoEckert2Raw=Fe,p.geoEckert3=function(){return g.geoProjection($e).scale(180.739)},p.geoEckert3Raw=$e,p.geoEckert4=function(){return g.geoProjection(ot).scale(180.739)},p.geoEckert4Raw=ot,p.geoEckert5=function(){return g.geoProjection(pt).scale(173.044)},p.geoEckert5Raw=pt,p.geoEckert6=function(){return g.geoProjection(_t).scale(173.044)},p.geoEckert6Raw=_t,p.geoEisenlohr=function(){return g.geoProjection(tt).scale(62.5271)},p.geoEisenlohrRaw=tt,p.geoFahey=function(){return g.geoProjection(vt).scale(137.152)},p.geoFaheyRaw=vt,p.geoFoucaut=function(){return g.geoProjection(Nt).scale(135.264)},p.geoFoucautRaw=Nt,p.geoFoucautSinusoidal=function(){var je=.5,Ge=g.geoProjectionMutator(qt),et=Ge(je);return et.alpha=function(lt){return arguments.length?Ge(je=+lt):je},et.scale(168.725)},p.geoFoucautSinusoidalRaw=qt,p.geoGilbert=function(je){je==null&&(je=g.geoOrthographic);var Ge=je(),et=g.geoEquirectangular().scale(A).precision(0).clipAngle(null).translate([0,0]);function lt(dt){return Ge(er(dt))}function gt(dt){lt[dt]=function(){return arguments.length?(Ge[dt].apply(Ge,arguments),lt):Ge[dt]()}}return Ge.invert&&(lt.invert=function(dt){return Jt(Ge.invert(dt))}),lt.stream=function(dt){var St=Ge.stream(dt),Xt=et.stream({point:function(Kt,Yt){St.point(Kt/2,P(d(-Yt/2*I))*A)},lineStart:function(){St.lineStart()},lineEnd:function(){St.lineEnd()},polygonStart:function(){St.polygonStart()},polygonEnd:function(){St.polygonEnd()}});return Xt.sphere=St.sphere,Xt},lt.rotate=function(dt){return arguments.length?(et.rotate(dt),lt):et.rotate()},lt.center=function(dt){return arguments.length?(Ge.center(er(dt)),lt):Jt(Ge.center())},gt("angle"),gt("clipAngle"),gt("clipExtent"),gt("fitExtent"),gt("fitHeight"),gt("fitSize"),gt("fitWidth"),gt("scale"),gt("translate"),gt("precision"),lt.scale(249.5)},p.geoGingery=function(){var je=6,Ge=30*I,et=t(Ge),lt=h(Ge),gt=g.geoProjectionMutator(ir),dt=gt(Ge,je),St=dt.stream,Xt=-t(.01*I),Kt=h(.01*I);return dt.radius=function(Yt){return arguments.length?(et=t(Ge=Yt*I),lt=h(Ge),gt(Ge,je)):Ge*A},dt.lobes=function(Yt){return arguments.length?gt(Ge,je=+Yt):je},dt.stream=function(Yt){var or=dt.rotate(),mr=St(Yt),wr=(dt.rotate([0,0]),St(Yt));return dt.rotate(or),mr.sphere=function(){wr.polygonStart(),wr.lineStart();for(var Tr=0,Dr=2*x/je,nn=0;Tr<je;++Tr,nn-=Dr)wr.point(n(Kt*t(nn),Xt)*A,P(Kt*h(nn))*A),wr.point(n(lt*t(nn-Dr/2),et)*A,P(lt*h(nn-Dr/2))*A);wr.lineEnd(),wr.polygonEnd()},mr},dt.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},p.geoGingeryRaw=ir,p.geoGinzburg4=function(){return g.geoProjection(he).scale(149.995)},p.geoGinzburg4Raw=he,p.geoGinzburg5=function(){return g.geoProjection(xe).scale(153.93)},p.geoGinzburg5Raw=xe,p.geoGinzburg6=function(){return g.geoProjection(De).scale(130.945)},p.geoGinzburg6Raw=De,p.geoGinzburg8=function(){return g.geoProjection(qe).scale(131.747)},p.geoGinzburg8Raw=qe,p.geoGinzburg9=function(){return g.geoProjection(Xe).scale(131.087)},p.geoGinzburg9Raw=Xe,p.geoGringorten=function(){return g.geoProjection(He(st)).scale(239.75)},p.geoGringortenRaw=st,p.geoGuyou=function(){return g.geoProjection(He(Pt)).scale(151.496)},p.geoGuyouRaw=Pt,p.geoHammer=function(){var je=2,Ge=g.geoProjectionMutator(B),et=Ge(je);return et.coefficient=function(lt){return arguments.length?Ge(je=+lt):je},et.scale(169.529)},p.geoHammerRaw=B,p.geoHammerRetroazimuthal=function(){var je=0,Ge=g.geoProjectionMutator(rt),et=Ge(je),lt=et.rotate,gt=et.stream,dt=g.geoCircle();return et.parallel=function(St){if(!arguments.length)return je*A;var Xt=et.rotate();return Ge(je=St*I).rotate(Xt)},et.rotate=function(St){return arguments.length?(lt.call(et,[St[0],St[1]-je*A]),dt.center([-St[0],-St[1]]),et):((St=lt.call(et))[1]+=je*A,St)},et.stream=function(St){return(St=gt(St)).sphere=function(){St.polygonStart();var Xt,Kt=dt.radius(89.99)().coordinates[0],Yt=Kt.length-1,or=-1;for(St.lineStart();++or<Yt;)St.point((Xt=Kt[or])[0],Xt[1]);for(St.lineEnd(),Yt=(Kt=dt.radius(90.01)().coordinates[0]).length-1,St.lineStart();--or>=0;)St.point((Xt=Kt[or])[0],Xt[1]);St.lineEnd(),St.polygonEnd()},St},et.scale(79.4187).parallel(45).clipAngle(179.999)},p.geoHammerRetroazimuthalRaw=rt,p.geoHealpix=function(){var je=4,Ge=g.geoProjectionMutator(Lt),et=Ge(je),lt=et.stream;return et.lobes=function(gt){return arguments.length?Ge(je=+gt):je},et.stream=function(gt){var dt=et.rotate(),St=lt(gt),Xt=(et.rotate([0,0]),lt(gt));return et.rotate(dt),St.sphere=function(){var Kt,Yt;g.geoStream((Kt=180/je,Yt=[].concat(b.range(-180,180+Kt/2,Kt).map(Ae),b.range(180,-180-Kt/2,-Kt).map(Ye)),{type:"Polygon",coordinates:[Kt===180?Yt.map(nt):Yt]}),Xt)},St},et.scale(239.75)},p.geoHealpixRaw=Lt,p.geoHill=function(){var je=1,Ge=g.geoProjectionMutator(ft),et=Ge(je);return et.ratio=function(lt){return arguments.length?Ge(je=+lt):je},et.scale(167.774).center([0,18.67])},p.geoHillRaw=ft,p.geoHomolosine=function(){return g.geoProjection(Rt).scale(152.63)},p.geoHomolosineRaw=Rt,p.geoHufnagel=function(){var je=1,Ge=0,et=45*I,lt=2,gt=g.geoProjectionMutator(Gt),dt=gt(je,Ge,et,lt);return dt.a=function(St){return arguments.length?gt(je=+St,Ge,et,lt):je},dt.b=function(St){return arguments.length?gt(je,Ge=+St,et,lt):Ge},dt.psiMax=function(St){return arguments.length?gt(je,Ge,et=+St*I,lt):et*A},dt.ratio=function(St){return arguments.length?gt(je,Ge,et,lt=+St):lt},dt.scale(180.739)},p.geoHufnagelRaw=Gt,p.geoHyperelliptical=function(){var je=0,Ge=2.5,et=1.183136,lt=g.geoProjectionMutator(pr),gt=lt(je,Ge,et);return gt.alpha=function(dt){return arguments.length?lt(je=+dt,Ge,et):je},gt.k=function(dt){return arguments.length?lt(je,Ge=+dt,et):Ge},gt.gamma=function(dt){return arguments.length?lt(je,Ge,et=+dt):et},gt.scale(152.63)},p.geoHyperellipticalRaw=pr,p.geoInterrupt=Qt,p.geoInterruptedBoggs=function(){return Qt(de,$t).scale(160.857)},p.geoInterruptedHomolosine=function(){return Qt(Rt,hr).scale(152.63)},p.geoInterruptedMollweide=function(){return Qt(ne,vr).scale(169.529)},p.geoInterruptedMollweideHemispheres=function(){return Qt(ne,Mr).scale(169.529).rotate([20,0])},p.geoInterruptedSinuMollweide=function(){return Qt(Mt,Nr,j).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},p.geoInterruptedSinusoidal=function(){return Qt(me,Ur).scale(152.63).rotate([-20,0])},p.geoKavrayskiy7=function(){return g.geoProjection(Jr).scale(158.837)},p.geoKavrayskiy7Raw=Jr,p.geoLagrange=function(){var je=.5,Ge=g.geoProjectionMutator(mn),et=Ge(je);return et.spacing=function(lt){return arguments.length?Ge(je=+lt):je},et.scale(124.75)},p.geoLagrangeRaw=mn,p.geoLarrivee=function(){return g.geoProjection(In).scale(97.2672)},p.geoLarriveeRaw=In,p.geoLaskowski=function(){return g.geoProjection(vn).scale(139.98)},p.geoLaskowskiRaw=vn,p.geoLittrow=function(){return g.geoProjection(gn).scale(144.049).clipAngle(89.999)},p.geoLittrowRaw=gn,p.geoLoximuthal=function(){return se(Sn).parallel(40).scale(158.837)},p.geoLoximuthalRaw=Sn,p.geoMiller=function(){return g.geoProjection(Xn).scale(108.318)},p.geoMillerRaw=Xn,p.geoModifiedStereographic=xn,p.geoModifiedStereographicRaw=Br,p.geoModifiedStereographicAlaska=function(){return xn(pn,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},p.geoModifiedStereographicGs48=function(){return xn(on,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},p.geoModifiedStereographicGs50=function(){return xn(Yr,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},p.geoModifiedStereographicMiller=function(){return xn(Nn,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},p.geoModifiedStereographicLee=function(){return xn(Hn,[165,10]).scale(250).clipAngle(130).center([-165,-10])},p.geoMollweide=function(){return g.geoProjection(ne).scale(169.529)},p.geoMollweideRaw=ne,p.geoMtFlatPolarParabolic=function(){return g.geoProjection(tr).scale(164.859)},p.geoMtFlatPolarParabolicRaw=tr,p.geoMtFlatPolarQuartic=function(){return g.geoProjection(yr).scale(188.209)},p.geoMtFlatPolarQuarticRaw=yr,p.geoMtFlatPolarSinusoidal=function(){return g.geoProjection(Ct).scale(166.518)},p.geoMtFlatPolarSinusoidalRaw=Ct,p.geoNaturalEarth2=function(){return g.geoProjection(lr).scale(175.295)},p.geoNaturalEarth2Raw=lr,p.geoNellHammer=function(){return g.geoProjection(dr).scale(152.63)},p.geoNellHammerRaw=dr,p.geoInterruptedQuarticAuthalic=function(){return Qt(B(1/0),Fr).rotate([20,0]).scale(152.63)},p.geoNicolosi=function(){return g.geoProjection(Rr).scale(127.267)},p.geoNicolosiRaw=Rr,p.geoPatterson=function(){return g.geoProjection(zr).scale(139.319)},p.geoPattersonRaw=zr,p.geoPolyconic=function(){return g.geoProjection(Er).scale(103.74)},p.geoPolyconicRaw=Er,p.geoPolyhedral=Gr,p.geoPolyhedralButterfly=function(je){je=je||function(et){var lt=g.geoCentroid({type:"MultiPoint",coordinates:et});return g.geoGnomonic().scale(1).translate([0,0]).rotate([-lt[0],-lt[1]])};var Ge=yn.map(function(et){return{face:et,project:je(et)}});return[-1,0,0,1,0,1,4,5].forEach(function(et,lt){var gt=Ge[et];gt&&(gt.children||(gt.children=[])).push(Ge[lt])}),Gr(Ge[0],function(et,lt){return Ge[et<-x/2?lt<0?6:4:et<0?lt<0?2:0:et<x/2?lt<0?3:1:lt<0?7:5]}).angle(-30).scale(101.858).center([0,45])},p.geoPolyhedralCollignon=function(je){je=je||function(et){var lt=g.geoCentroid({type:"MultiPoint",coordinates:et});return g.geoProjection(wn).translate([0,0]).scale(1).rotate(lt[1]>0?[-lt[0],0]:[180-lt[0],180])};var Ge=yn.map(function(et){return{face:et,project:je(et)}});return[-1,0,0,1,0,1,4,5].forEach(function(et,lt){var gt=Ge[et];gt&&(gt.children||(gt.children=[])).push(Ge[lt])}),Gr(Ge[0],function(et,lt){return Ge[et<-x/2?lt<0?6:4:et<0?lt<0?2:0:et<x/2?lt<0?3:1:lt<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},p.geoPolyhedralWaterman=function(je){je=je||function(dt){var St=dt.length===6?g.geoCentroid({type:"MultiPoint",coordinates:dt}):dt[0];return g.geoGnomonic().scale(1).translate([0,0]).rotate([-St[0],-St[1]])};var Ge=yn.map(function(dt){for(var St,Xt=dt.map(Zn),Kt=Xt.length,Yt=Xt[Kt-1],or=[],mr=0;mr<Kt;++mr)St=Xt[mr],or.push(zn([.9486832980505138*Yt[0]+.31622776601683794*St[0],.9486832980505138*Yt[1]+.31622776601683794*St[1],.9486832980505138*Yt[2]+.31622776601683794*St[2]]),zn([.9486832980505138*St[0]+.31622776601683794*Yt[0],.9486832980505138*St[1]+.31622776601683794*Yt[1],.9486832980505138*St[2]+.31622776601683794*Yt[2]])),Yt=St;return or}),et=[],lt=[-1,0,0,1,0,1,4,5];Ge.forEach(function(dt,St){for(var Xt,Kt,Yt=yn[St],or=Yt.length,mr=et[St]=[],wr=0;wr<or;++wr)Ge.push([Yt[wr],dt[(2*wr+2)%(2*or)],dt[(2*wr+1)%(2*or)]]),lt.push(St),mr.push((Xt=Zn(dt[(2*wr+2)%(2*or)]),Kt=Zn(dt[(2*wr+1)%(2*or)]),[Xt[1]*Kt[2]-Xt[2]*Kt[1],Xt[2]*Kt[0]-Xt[0]*Kt[2],Xt[0]*Kt[1]-Xt[1]*Kt[0]]))});var gt=Ge.map(function(dt){return{project:je(dt),face:dt}});return lt.forEach(function(dt,St){var Xt=gt[dt];Xt&&(Xt.children||(Xt.children=[])).push(gt[St])}),Gr(gt[0],function(dt,St){var Xt=t(St),Kt=[Xt*t(dt),Xt*h(dt),h(St)],Yt=dt<-x/2?St<0?6:4:dt<0?St<0?2:0:dt<x/2?St<0?3:1:St<0?7:5,or=et[Yt];return gt[Ln(or[0],Kt)<0?8+3*Yt:Ln(or[1],Kt)<0?8+3*Yt+1:Ln(or[2],Kt)<0?8+3*Yt+2:Yt]}).angle(-30).scale(110.625).center([0,45])},p.geoProject=function(je,Ge){var et,lt=Ge.stream;if(!lt)throw new Error("invalid projection");switch(je&&je.type){case"Feature":et=An;break;case"FeatureCollection":et=Ma;break;default:et=ea}return et(je,lt)},p.geoGringortenQuincuncial=function(){return Xa(st).scale(176.423)},p.geoPeirceQuincuncial=Za,p.geoPierceQuincuncial=Za,p.geoQuantize=function(je,Ge){if(!(0<=(Ge=+Ge)&&Ge<=20))throw new Error("invalid digits");function et(Yt){var or=Yt.length,mr=2,wr=new Array(or);for(wr[0]=+Yt[0].toFixed(Ge),wr[1]=+Yt[1].toFixed(Ge);mr<or;)wr[mr]=Yt[mr],++mr;return wr}function lt(Yt){return Yt.map(et)}function gt(Yt){for(var or=et(Yt[0]),mr=[or],wr=1;wr<Yt.length;wr++){var Tr=et(Yt[wr]);(Tr.length>2||Tr[0]!=or[0]||Tr[1]!=or[1])&&(mr.push(Tr),or=Tr)}return mr.length===1&&Yt.length>1&&mr.push(et(Yt[Yt.length-1])),mr}function dt(Yt){return Yt.map(gt)}function St(Yt){if(Yt==null)return Yt;var or;switch(Yt.type){case"GeometryCollection":or={type:"GeometryCollection",geometries:Yt.geometries.map(St)};break;case"Point":or={type:"Point",coordinates:et(Yt.coordinates)};break;case"MultiPoint":or={type:Yt.type,coordinates:lt(Yt.coordinates)};break;case"LineString":or={type:Yt.type,coordinates:gt(Yt.coordinates)};break;case"MultiLineString":case"Polygon":or={type:Yt.type,coordinates:dt(Yt.coordinates)};break;case"MultiPolygon":or={type:"MultiPolygon",coordinates:Yt.coordinates.map(dt)};break;default:return Yt}return Yt.bbox!=null&&(or.bbox=Yt.bbox),or}function Xt(Yt){var or={type:"Feature",properties:Yt.properties,geometry:St(Yt.geometry)};return Yt.id!=null&&(or.id=Yt.id),Yt.bbox!=null&&(or.bbox=Yt.bbox),or}if(je!=null)switch(je.type){case"Feature":return Xt(je);case"FeatureCollection":var Kt={type:"FeatureCollection",features:je.features.map(Xt)};return je.bbox!=null&&(Kt.bbox=je.bbox),Kt;default:return St(je)}return je},p.geoQuincuncial=Xa,p.geoRectangularPolyconic=function(){return se(eo).scale(131.215)},p.geoRectangularPolyconicRaw=eo,p.geoRobinson=function(){return g.geoProjection(mo).scale(152.63)},p.geoRobinsonRaw=mo,p.geoSatellite=function(){var je=2,Ge=0,et=g.geoProjectionMutator(bo),lt=et(je,Ge);return lt.distance=function(gt){return arguments.length?et(je=+gt,Ge):je},lt.tilt=function(gt){return arguments.length?et(je,Ge=gt*I):Ge*A},lt.scale(432.147).clipAngle(S(1/je)*A-1e-6)},p.geoSatelliteRaw=bo,p.geoSinuMollweide=function(){return g.geoProjection(Mt).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},p.geoSinuMollweideRaw=Mt,p.geoSinusoidal=function(){return g.geoProjection(me).scale(152.63)},p.geoSinusoidalRaw=me,p.geoStitch=function(je){if(je==null)return je;switch(je.type){case"Feature":return Ja(je);case"FeatureCollection":var Ge={type:"FeatureCollection",features:je.features.map(Ja)};return je.bbox!=null&&(Ge.bbox=je.bbox),Ge;default:return vs(je)}},p.geoTimes=function(){return g.geoProjection(rs).scale(146.153)},p.geoTimesRaw=rs,p.geoTwoPointAzimuthal=ks,p.geoTwoPointAzimuthalRaw=Cs,p.geoTwoPointAzimuthalUsa=function(){return ks([-158,21.5],[-77,39]).clipAngle(60).scale(400)},p.geoTwoPointEquidistant=Oo,p.geoTwoPointEquidistantRaw=Ps,p.geoTwoPointEquidistantUsa=function(){return Oo([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},p.geoVanDerGrinten=function(){return g.geoProjection(zo).scale(79.4183)},p.geoVanDerGrintenRaw=zo,p.geoVanDerGrinten2=function(){return g.geoProjection(Go).scale(79.4183)},p.geoVanDerGrinten2Raw=Go,p.geoVanDerGrinten3=function(){return g.geoProjection(Yo).scale(79.4183)},p.geoVanDerGrinten3Raw=Yo,p.geoVanDerGrinten4=function(){return g.geoProjection(Wo).scale(127.16)},p.geoVanDerGrinten4Raw=Wo,p.geoWagner=wo,p.geoWagner7=function(){return wo().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},p.geoWagnerRaw=ns,p.geoWagner4=function(){return g.geoProjection(Xo).scale(176.84)},p.geoWagner4Raw=Xo,p.geoWagner6=function(){return g.geoProjection(xs).scale(152.63)},p.geoWagner6Raw=xs,p.geoWiechel=function(){return g.geoProjection(Do).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},p.geoWiechelRaw=Do,p.geoWinkel3=function(){return g.geoProjection(Ya).scale(158.837)},p.geoWinkel3Raw=Ya,Object.defineProperty(p,"__esModule",{value:!0})})},{"d3-array":107,"d3-geo":114}],114:[function(v,J,Z){(function(p,g){typeof Z=="object"&&J!==void 0?g(Z,v("d3-array")):g((p=p||self).d3=p.d3||{},p.d3)})(this,function(p,g){function b(){return new y}function y(){this.reset()}y.prototype={constructor:y,reset:function(){this.s=this.t=0},add:function(ht){n(e,ht,this.t),n(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new y;function n(ht,Ot,cr){var Ut=ht.s=Ot+cr,ur=Ut-Ot,Or=Ut-ur;ht.t=Ot-Or+(cr-ur)}var t=1e-6,a=Math.PI,r=a/2,m=a/4,o=2*a,i=180/a,u=a/180,f=Math.abs,l=Math.atan,h=Math.atan2,d=Math.cos,s=Math.ceil,x=Math.exp,c=Math.log,T=Math.pow,_=Math.sin,w=Math.sign||function(ht){return ht>0?1:ht<0?-1:0},k=Math.sqrt,L=Math.tan;function A(ht){return ht>1?0:ht<-1?a:Math.acos(ht)}function I(ht){return ht>1?r:ht<-1?-r:Math.asin(ht)}function P(ht){return(ht=_(ht/2))*ht}function S(){}function E(ht,Ot){ht&&R.hasOwnProperty(ht.type)&&R[ht.type](ht,Ot)}var D={Feature:function(ht,Ot){E(ht.geometry,Ot)},FeatureCollection:function(ht,Ot){for(var cr=ht.features,Ut=-1,ur=cr.length;++Ut<ur;)E(cr[Ut].geometry,Ot)}},R={Sphere:function(ht,Ot){Ot.sphere()},Point:function(ht,Ot){ht=ht.coordinates,Ot.point(ht[0],ht[1],ht[2])},MultiPoint:function(ht,Ot){for(var cr=ht.coordinates,Ut=-1,ur=cr.length;++Ut<ur;)ht=cr[Ut],Ot.point(ht[0],ht[1],ht[2])},LineString:function(ht,Ot){H(ht.coordinates,Ot,0)},MultiLineString:function(ht,Ot){for(var cr=ht.coordinates,Ut=-1,ur=cr.length;++Ut<ur;)H(cr[Ut],Ot,0)},Polygon:function(ht,Ot){V(ht.coordinates,Ot)},MultiPolygon:function(ht,Ot){for(var cr=ht.coordinates,Ut=-1,ur=cr.length;++Ut<ur;)V(cr[Ut],Ot)},GeometryCollection:function(ht,Ot){for(var cr=ht.geometries,Ut=-1,ur=cr.length;++Ut<ur;)E(cr[Ut],Ot)}};function H(ht,Ot,cr){var Ut,ur=-1,Or=ht.length-cr;for(Ot.lineStart();++ur<Or;)Ut=ht[ur],Ot.point(Ut[0],Ut[1],Ut[2]);Ot.lineEnd()}function V(ht,Ot){var cr=-1,Ut=ht.length;for(Ot.polygonStart();++cr<Ut;)H(ht[cr],Ot,1);Ot.polygonEnd()}function X(ht,Ot){ht&&D.hasOwnProperty(ht.type)?D[ht.type](ht,Ot):E(ht,Ot)}var $,G,W,te,N,B=b(),U=b(),ee={point:S,lineStart:S,lineEnd:S,polygonStart:function(){B.reset(),ee.lineStart=j,ee.lineEnd=Q},polygonEnd:function(){var ht=+B;U.add(ht<0?o+ht:ht),this.lineStart=this.lineEnd=this.point=S},sphere:function(){U.add(o)}};function j(){ee.point=K}function Q(){re($,G)}function K(ht,Ot){ee.point=re,$=ht,G=Ot,W=ht*=u,te=d(Ot=(Ot*=u)/2+m),N=_(Ot)}function re(ht,Ot){var cr=(ht*=u)-W,Ut=cr>=0?1:-1,ur=Ut*cr,Or=d(Ot=(Ot*=u)/2+m),jr=_(Ot),Zr=N*jr,ln=te*Or+Zr*d(ur),an=Zr*Ut*_(ur);B.add(h(an,ln)),W=ht,te=Or,N=jr}function ne(ht){return[h(ht[1],ht[0]),I(ht[2])]}function le(ht){var Ot=ht[0],cr=ht[1],Ut=d(cr);return[Ut*d(Ot),Ut*_(Ot),_(cr)]}function oe(ht,Ot){return ht[0]*Ot[0]+ht[1]*Ot[1]+ht[2]*Ot[2]}function de(ht,Ot){return[ht[1]*Ot[2]-ht[2]*Ot[1],ht[2]*Ot[0]-ht[0]*Ot[2],ht[0]*Ot[1]-ht[1]*Ot[0]]}function se(ht,Ot){ht[0]+=Ot[0],ht[1]+=Ot[1],ht[2]+=Ot[2]}function me(ht,Ot){return[ht[0]*Ot,ht[1]*Ot,ht[2]*Ot]}function Te(ht){var Ot=k(ht[0]*ht[0]+ht[1]*ht[1]+ht[2]*ht[2]);ht[0]/=Ot,ht[1]/=Ot,ht[2]/=Ot}var _e,be,Ce,fe,ve,Me,ke,Le,ze,Re,Oe,Ze,Pe,Ie,Be,Fe,$e,ot,pt,_t,yt,tt,Ke,vt,Nt,qt,er=b(),Jt={point:ir,lineStart:Ue,lineEnd:We,polygonStart:function(){Jt.point=he,Jt.lineStart=xe,Jt.lineEnd=De,er.reset(),ee.polygonStart()},polygonEnd:function(){ee.polygonEnd(),Jt.point=ir,Jt.lineStart=Ue,Jt.lineEnd=We,B<0?(_e=-(Ce=180),be=-(fe=90)):er>t?fe=90:er<-t&&(be=-90),Re[0]=_e,Re[1]=Ce},sphere:function(){_e=-(Ce=180),be=-(fe=90)}};function ir(ht,Ot){ze.push(Re=[_e=ht,Ce=ht]),Ot<be&&(be=Ot),Ot>fe&&(fe=Ot)}function Ht(ht,Ot){var cr=le([ht*u,Ot*u]);if(Le){var Ut=de(Le,cr),ur=de([Ut[1],-Ut[0],0],Ut);Te(ur),ur=ne(ur);var Or,jr=ht-ve,Zr=jr>0?1:-1,ln=ur[0]*i*Zr,an=f(jr)>180;an^(Zr*ve<ln&&ln<Zr*ht)?(Or=ur[1]*i)>fe&&(fe=Or):an^(Zr*ve<(ln=(ln+360)%360-180)&&ln<Zr*ht)?(Or=-ur[1]*i)<be&&(be=Or):(Ot<be&&(be=Ot),Ot>fe&&(fe=Ot)),an?ht<ve?qe(_e,ht)>qe(_e,Ce)&&(Ce=ht):qe(ht,Ce)>qe(_e,Ce)&&(_e=ht):Ce>=_e?(ht<_e&&(_e=ht),ht>Ce&&(Ce=ht)):ht>ve?qe(_e,ht)>qe(_e,Ce)&&(Ce=ht):qe(ht,Ce)>qe(_e,Ce)&&(_e=ht)}else ze.push(Re=[_e=ht,Ce=ht]);Ot<be&&(be=Ot),Ot>fe&&(fe=Ot),Le=cr,ve=ht}function Ue(){Jt.point=Ht}function We(){Re[0]=_e,Re[1]=Ce,Jt.point=ir,Le=null}function he(ht,Ot){if(Le){var cr=ht-ve;er.add(f(cr)>180?cr+(cr>0?360:-360):cr)}else Me=ht,ke=Ot;ee.point(ht,Ot),Ht(ht,Ot)}function xe(){ee.lineStart()}function De(){he(Me,ke),ee.lineEnd(),f(er)>t&&(_e=-(Ce=180)),Re[0]=_e,Re[1]=Ce,Le=null}function qe(ht,Ot){return(Ot-=ht)<0?Ot+360:Ot}function Xe(ht,Ot){return ht[0]-Ot[0]}function He(ht,Ot){return ht[0]<=ht[1]?ht[0]<=Ot&&Ot<=ht[1]:Ot<ht[0]||ht[1]<Ot}var st={sphere:S,point:it,lineStart:Pt,lineEnd:Ft,polygonStart:function(){st.lineStart=wt,st.lineEnd=Lt},polygonEnd:function(){st.lineStart=Pt,st.lineEnd=Ft}};function it(ht,Ot){ht*=u;var cr=d(Ot*=u);Tt(cr*d(ht),cr*_(ht),_(Ot))}function Tt(ht,Ot,cr){++Oe,Pe+=(ht-Pe)/Oe,Ie+=(Ot-Ie)/Oe,Be+=(cr-Be)/Oe}function Pt(){st.point=rt}function rt(ht,Ot){ht*=u;var cr=d(Ot*=u);vt=cr*d(ht),Nt=cr*_(ht),qt=_(Ot),st.point=ut,Tt(vt,Nt,qt)}function ut(ht,Ot){ht*=u;var cr=d(Ot*=u),Ut=cr*d(ht),ur=cr*_(ht),Or=_(Ot),jr=h(k((jr=Nt*Or-qt*ur)*jr+(jr=qt*Ut-vt*Or)*jr+(jr=vt*ur-Nt*Ut)*jr),vt*Ut+Nt*ur+qt*Or);Ze+=jr,Fe+=jr*(vt+(vt=Ut)),$e+=jr*(Nt+(Nt=ur)),ot+=jr*(qt+(qt=Or)),Tt(vt,Nt,qt)}function Ft(){st.point=it}function wt(){st.point=Ae}function Lt(){Ye(tt,Ke),st.point=it}function Ae(ht,Ot){tt=ht,Ke=Ot,ht*=u,Ot*=u,st.point=Ye;var cr=d(Ot);vt=cr*d(ht),Nt=cr*_(ht),qt=_(Ot),Tt(vt,Nt,qt)}function Ye(ht,Ot){ht*=u;var cr=d(Ot*=u),Ut=cr*d(ht),ur=cr*_(ht),Or=_(Ot),jr=Nt*Or-qt*ur,Zr=qt*Ut-vt*Or,ln=vt*ur-Nt*Ut,an=k(jr*jr+Zr*Zr+ln*ln),dn=I(an),Tn=an&&-dn/an;pt+=Tn*jr,_t+=Tn*Zr,yt+=Tn*ln,Ze+=dn,Fe+=dn*(vt+(vt=Ut)),$e+=dn*(Nt+(Nt=ur)),ot+=dn*(qt+(qt=Or)),Tt(vt,Nt,qt)}function nt(ht){return function(){return ht}}function ft(ht,Ot){function cr(Ut,ur){return Ut=ht(Ut,ur),Ot(Ut[0],Ut[1])}return ht.invert&&Ot.invert&&(cr.invert=function(Ut,ur){return(Ut=Ot.invert(Ut,ur))&&ht.invert(Ut[0],Ut[1])}),cr}function Mt(ht,Ot){return[f(ht)>a?ht+Math.round(-ht/o)*o:ht,Ot]}function Rt(ht,Ot,cr){return(ht%=o)?Ot||cr?ft(jt(ht),pr(Ot,cr)):jt(ht):Ot||cr?pr(Ot,cr):Mt}function Gt(ht){return function(Ot,cr){return[(Ot+=ht)>a?Ot-o:Ot<-a?Ot+o:Ot,cr]}}function jt(ht){var Ot=Gt(ht);return Ot.invert=Gt(-ht),Ot}function pr(ht,Ot){var cr=d(ht),Ut=_(ht),ur=d(Ot),Or=_(Ot);function jr(Zr,ln){var an=d(ln),dn=d(Zr)*an,Tn=_(Zr)*an,cn=_(ln),kn=cn*cr+dn*Ut;return[h(Tn*ur-kn*Or,dn*cr-cn*Ut),I(kn*ur+Tn*Or)]}return jr.invert=function(Zr,ln){var an=d(ln),dn=d(Zr)*an,Tn=_(Zr)*an,cn=_(ln),kn=cn*ur-Tn*Or;return[h(Tn*ur+cn*Or,dn*cr+kn*Ut),I(kn*cr-dn*Ut)]},jr}function Ar(ht){function Ot(cr){return(cr=ht(cr[0]*u,cr[1]*u))[0]*=i,cr[1]*=i,cr}return ht=Rt(ht[0]*u,ht[1]*u,ht.length>2?ht[2]*u:0),Ot.invert=function(cr){return(cr=ht.invert(cr[0]*u,cr[1]*u))[0]*=i,cr[1]*=i,cr},Ot}function fr(ht,Ot,cr,Ut,ur,Or){if(cr){var jr=d(Ot),Zr=_(Ot),ln=Ut*cr;ur==null?(ur=Ot+Ut*o,Or=Ot-ln/2):(ur=Zt(jr,ur),Or=Zt(jr,Or),(Ut>0?ur<Or:ur>Or)&&(ur+=Ut*o));for(var an,dn=ur;Ut>0?dn>Or:dn<Or;dn-=ln)an=ne([jr,-Zr*d(dn),-Zr*_(dn)]),ht.point(an[0],an[1])}}function Zt(ht,Ot){(Ot=le(Ot))[0]-=ht,Te(Ot);var cr=A(-Ot[1]);return((-Ot[2]<0?-cr:cr)+o-t)%o}function Qt(){var ht,Ot=[];return{point:function(cr,Ut,ur){ht.push([cr,Ut,ur])},lineStart:function(){Ot.push(ht=[])},lineEnd:S,rejoin:function(){Ot.length>1&&Ot.push(Ot.pop().concat(Ot.shift()))},result:function(){var cr=Ot;return Ot=[],ht=null,cr}}}function $t(ht,Ot){return f(ht[0]-Ot[0])<t&&f(ht[1]-Ot[1])<t}function hr(ht,Ot,cr,Ut){this.x=ht,this.z=Ot,this.o=cr,this.e=Ut,this.v=!1,this.n=this.p=null}function vr(ht,Ot,cr,Ut,ur){var Or,jr,Zr=[],ln=[];if(ht.forEach(function(Fn){if(!((qn=Fn.length-1)<=0)){var qn,oa,Kr=Fn[0],na=Fn[qn];if($t(Kr,na)){if(!Kr[2]&&!na[2]){for(ur.lineStart(),Or=0;Or<qn;++Or)ur.point((Kr=Fn[Or])[0],Kr[1]);return void ur.lineEnd()}na[0]+=2*t}Zr.push(oa=new hr(Kr,Fn,null,!0)),ln.push(oa.o=new hr(Kr,null,oa,!1)),Zr.push(oa=new hr(na,Fn,null,!1)),ln.push(oa.o=new hr(na,null,oa,!0))}}),Zr.length){for(ln.sort(Ot),Mr(Zr),Mr(ln),Or=0,jr=ln.length;Or<jr;++Or)ln[Or].e=cr=!cr;for(var an,dn,Tn=Zr[0];;){for(var cn=Tn,kn=!0;cn.v;)if((cn=cn.n)===Tn)return;an=cn.z,ur.lineStart();do{if(cn.v=cn.o.v=!0,cn.e){if(kn)for(Or=0,jr=an.length;Or<jr;++Or)ur.point((dn=an[Or])[0],dn[1]);else Ut(cn.x,cn.n.x,1,ur);cn=cn.n}else{if(kn)for(an=cn.p.z,Or=an.length-1;Or>=0;--Or)ur.point((dn=an[Or])[0],dn[1]);else Ut(cn.x,cn.p.x,-1,ur);cn=cn.p}an=(cn=cn.o).z,kn=!kn}while(!cn.v);ur.lineEnd()}}}function Mr(ht){if(Ot=ht.length){for(var Ot,cr,Ut=0,ur=ht[0];++Ut<Ot;)ur.n=cr=ht[Ut],cr.p=ur,ur=cr;ur.n=cr=ht[0],cr.p=ur}}Mt.invert=Mt;var Nr=b();function Ur(ht){return f(ht[0])<=a?ht[0]:w(ht[0])*((f(ht[0])+a)%o-a)}function Jr(ht,Ot){var cr=Ur(Ot),Ut=Ot[1],ur=_(Ut),Or=[_(cr),-d(cr),0],jr=0,Zr=0;Nr.reset(),ur===1?Ut=r+t:ur===-1&&(Ut=-r-t);for(var ln=0,an=ht.length;ln<an;++ln)if(Tn=(dn=ht[ln]).length)for(var dn,Tn,cn=dn[Tn-1],kn=Ur(cn),Fn=cn[1]/2+m,qn=_(Fn),oa=d(Fn),Kr=0;Kr<Tn;++Kr,kn=Pn,qn=ra,oa=ka,cn=na){var na=dn[Kr],Pn=Ur(na),Un=na[1]/2+m,ra=_(Un),ka=d(Un),Pa=Pn-kn,En=Pa>=0?1:-1,Ra=En*Pa,Ca=Ra>a,ga=qn*ra;if(Nr.add(h(ga*En*_(Ra),oa*ka+ga*d(Ra))),jr+=Ca?Pa+En*o:Pa,Ca^kn>=cr^Pn>=cr){var Fa=de(le(cn),le(na));Te(Fa);var Ea=de(Or,Fa);Te(Ea);var ri=(Ca^Pa>=0?-1:1)*I(Ea[2]);(Ut>ri||Ut===ri&&(Fa[0]||Fa[1]))&&(Zr+=Ca^Pa>=0?1:-1)}}return(jr<-t||jr<t&&Nr<-t)^1&Zr}function mn(ht,Ot,cr,Ut){return function(ur){var Or,jr,Zr,ln=Ot(ur),an=Qt(),dn=Ot(an),Tn=!1,cn={point:kn,lineStart:qn,lineEnd:oa,polygonStart:function(){cn.point=Kr,cn.lineStart=na,cn.lineEnd=Pn,jr=[],Or=[]},polygonEnd:function(){cn.point=kn,cn.lineStart=qn,cn.lineEnd=oa,jr=g.merge(jr);var Un=Jr(Or,Ut);jr.length?(Tn||(ur.polygonStart(),Tn=!0),vr(jr,In,Un,cr,ur)):Un&&(Tn||(ur.polygonStart(),Tn=!0),ur.lineStart(),cr(null,null,1,ur),ur.lineEnd()),Tn&&(ur.polygonEnd(),Tn=!1),jr=Or=null},sphere:function(){ur.polygonStart(),ur.lineStart(),cr(null,null,1,ur),ur.lineEnd(),ur.polygonEnd()}};function kn(Un,ra){ht(Un,ra)&&ur.point(Un,ra)}function Fn(Un,ra){ln.point(Un,ra)}function qn(){cn.point=Fn,ln.lineStart()}function oa(){cn.point=kn,ln.lineEnd()}function Kr(Un,ra){Zr.push([Un,ra]),dn.point(Un,ra)}function na(){dn.lineStart(),Zr=[]}function Pn(){Kr(Zr[0][0],Zr[0][1]),dn.lineEnd();var Un,ra,ka,Pa,En=dn.clean(),Ra=an.result(),Ca=Ra.length;if(Zr.pop(),Or.push(Zr),Zr=null,Ca)if(1&En){if((ra=(ka=Ra[0]).length-1)>0){for(Tn||(ur.polygonStart(),Tn=!0),ur.lineStart(),Un=0;Un<ra;++Un)ur.point((Pa=ka[Un])[0],Pa[1]);ur.lineEnd()}}else Ca>1&&2&En&&Ra.push(Ra.pop().concat(Ra.shift())),jr.push(Ra.filter(en))}return cn}}function en(ht){return ht.length>1}function In(ht,Ot){return((ht=ht.x)[0]<0?ht[1]-r-t:r-ht[1])-((Ot=Ot.x)[0]<0?Ot[1]-r-t:r-Ot[1])}var vn=mn(function(){return!0},function(ht){var Ot,cr=NaN,Ut=NaN,ur=NaN;return{lineStart:function(){ht.lineStart(),Ot=1},point:function(Or,jr){var Zr=Or>0?a:-a,ln=f(Or-cr);f(ln-a)<t?(ht.point(cr,Ut=(Ut+jr)/2>0?r:-r),ht.point(ur,Ut),ht.lineEnd(),ht.lineStart(),ht.point(Zr,Ut),ht.point(Or,Ut),Ot=0):ur!==Zr&&ln>=a&&(f(cr-ur)<t&&(cr-=ur*t),f(Or-Zr)<t&&(Or-=Zr*t),Ut=function(an,dn,Tn,cn){var kn,Fn,qn=_(an-Tn);return f(qn)>t?l((_(dn)*(Fn=d(cn))*_(Tn)-_(cn)*(kn=d(dn))*_(an))/(kn*Fn*qn)):(dn+cn)/2}(cr,Ut,Or,jr),ht.point(ur,Ut),ht.lineEnd(),ht.lineStart(),ht.point(Zr,Ut),Ot=0),ht.point(cr=Or,Ut=jr),ur=Zr},lineEnd:function(){ht.lineEnd(),cr=Ut=NaN},clean:function(){return 2-Ot}}},function(ht,Ot,cr,Ut){var ur;if(ht==null)ur=cr*r,Ut.point(-a,ur),Ut.point(0,ur),Ut.point(a,ur),Ut.point(a,0),Ut.point(a,-ur),Ut.point(0,-ur),Ut.point(-a,-ur),Ut.point(-a,0),Ut.point(-a,ur);else if(f(ht[0]-Ot[0])>t){var Or=ht[0]<Ot[0]?a:-a;ur=cr*Or/2,Ut.point(-Or,ur),Ut.point(0,ur),Ut.point(Or,ur)}else Ut.point(Ot[0],Ot[1])},[-a,-r]);function gn(ht){var Ot=d(ht),cr=6*u,Ut=Ot>0,ur=f(Ot)>t;function Or(ln,an){return d(ln)*d(an)>Ot}function jr(ln,an,dn){var Tn=[1,0,0],cn=de(le(ln),le(an)),kn=oe(cn,cn),Fn=cn[0],qn=kn-Fn*Fn;if(!qn)return!dn&&ln;var oa=Ot*kn/qn,Kr=-Ot*Fn/qn,na=de(Tn,cn),Pn=me(Tn,oa);se(Pn,me(cn,Kr));var Un=na,ra=oe(Pn,Un),ka=oe(Un,Un),Pa=ra*ra-ka*(oe(Pn,Pn)-1);if(!(Pa<0)){var En=k(Pa),Ra=me(Un,(-ra-En)/ka);if(se(Ra,Pn),Ra=ne(Ra),!dn)return Ra;var Ca,ga=ln[0],Fa=an[0],Ea=ln[1],ri=an[1];Fa<ga&&(Ca=ga,ga=Fa,Fa=Ca);var aa=Fa-ga,Ka=f(aa-a)<t;if(!Ka&&ri<Ea&&(Ca=Ea,Ea=ri,ri=Ca),Ka||aa<t?Ka?Ea+ri>0^Ra[1]<(f(Ra[0]-ga)<t?Ea:ri):Ea<=Ra[1]&&Ra[1]<=ri:aa>a^(ga<=Ra[0]&&Ra[0]<=Fa)){var Hi=me(Un,(-ra+En)/ka);return se(Hi,Pn),[Ra,ne(Hi)]}}}function Zr(ln,an){var dn=Ut?ht:a-ht,Tn=0;return ln<-dn?Tn|=1:ln>dn&&(Tn|=2),an<-dn?Tn|=4:an>dn&&(Tn|=8),Tn}return mn(Or,function(ln){var an,dn,Tn,cn,kn;return{lineStart:function(){cn=Tn=!1,kn=1},point:function(Fn,qn){var oa,Kr=[Fn,qn],na=Or(Fn,qn),Pn=Ut?na?0:Zr(Fn,qn):na?Zr(Fn+(Fn<0?a:-a),qn):0;if(!an&&(cn=Tn=na)&&ln.lineStart(),na!==Tn&&(!(oa=jr(an,Kr))||$t(an,oa)||$t(Kr,oa))&&(Kr[2]=1),na!==Tn)kn=0,na?(ln.lineStart(),oa=jr(Kr,an),ln.point(oa[0],oa[1])):(oa=jr(an,Kr),ln.point(oa[0],oa[1],2),ln.lineEnd()),an=oa;else if(ur&&an&&Ut^na){var Un;Pn&dn||!(Un=jr(Kr,an,!0))||(kn=0,Ut?(ln.lineStart(),ln.point(Un[0][0],Un[0][1]),ln.point(Un[1][0],Un[1][1]),ln.lineEnd()):(ln.point(Un[1][0],Un[1][1]),ln.lineEnd(),ln.lineStart(),ln.point(Un[0][0],Un[0][1],3)))}!na||an&&$t(an,Kr)||ln.point(Kr[0],Kr[1]),an=Kr,Tn=na,dn=Pn},lineEnd:function(){Tn&&ln.lineEnd(),an=null},clean:function(){return kn|(cn&&Tn)<<1}}},function(ln,an,dn,Tn){fr(Tn,ht,cr,dn,ln,an)},Ut?[0,-ht]:[-a,ht-a])}function Sn(ht,Ot,cr,Ut){function ur(an,dn){return ht<=an&&an<=cr&&Ot<=dn&&dn<=Ut}function Or(an,dn,Tn,cn){var kn=0,Fn=0;if(an==null||(kn=jr(an,Tn))!==(Fn=jr(dn,Tn))||ln(an,dn)<0^Tn>0)do cn.point(kn===0||kn===3?ht:cr,kn>1?Ut:Ot);while((kn=(kn+Tn+4)%4)!==Fn);else cn.point(dn[0],dn[1])}function jr(an,dn){return f(an[0]-ht)<t?dn>0?0:3:f(an[0]-cr)<t?dn>0?2:1:f(an[1]-Ot)<t?dn>0?1:0:dn>0?3:2}function Zr(an,dn){return ln(an.x,dn.x)}function ln(an,dn){var Tn=jr(an,1),cn=jr(dn,1);return Tn!==cn?Tn-cn:Tn===0?dn[1]-an[1]:Tn===1?an[0]-dn[0]:Tn===2?an[1]-dn[1]:dn[0]-an[0]}return function(an){var dn,Tn,cn,kn,Fn,qn,oa,Kr,na,Pn,Un,ra=an,ka=Qt(),Pa={point:En,lineStart:function(){Pa.point=Ra,Tn&&Tn.push(cn=[]),Pn=!0,na=!1,oa=Kr=NaN},lineEnd:function(){dn&&(Ra(kn,Fn),qn&&na&&ka.rejoin(),dn.push(ka.result())),Pa.point=En,na&&ra.lineEnd()},polygonStart:function(){ra=ka,dn=[],Tn=[],Un=!0},polygonEnd:function(){var Ca=function(){for(var Ea=0,ri=0,aa=Tn.length;ri<aa;++ri)for(var Ka,Hi,Qo=Tn[ri],jo=1,To=Qo.length,xa=Qo[0],xi=xa[0],ko=xa[1];jo<To;++jo)Ka=xi,Hi=ko,xa=Qo[jo],xi=xa[0],ko=xa[1],Hi<=Ut?ko>Ut&&(xi-Ka)*(Ut-Hi)>(ko-Hi)*(ht-Ka)&&++Ea:ko<=Ut&&(xi-Ka)*(Ut-Hi)<(ko-Hi)*(ht-Ka)&&--Ea;return Ea}(),ga=Un&&Ca,Fa=(dn=g.merge(dn)).length;(ga||Fa)&&(an.polygonStart(),ga&&(an.lineStart(),Or(null,null,1,an),an.lineEnd()),Fa&&vr(dn,Zr,Ca,Or,an),an.polygonEnd()),ra=an,dn=Tn=cn=null}};function En(Ca,ga){ur(Ca,ga)&&ra.point(Ca,ga)}function Ra(Ca,ga){var Fa=ur(Ca,ga);if(Tn&&cn.push([Ca,ga]),Pn)kn=Ca,Fn=ga,qn=Fa,Pn=!1,Fa&&(ra.lineStart(),ra.point(Ca,ga));else if(Fa&&na)ra.point(Ca,ga);else{var Ea=[oa=Math.max(-1e9,Math.min(1e9,oa)),Kr=Math.max(-1e9,Math.min(1e9,Kr))],ri=[Ca=Math.max(-1e9,Math.min(1e9,Ca)),ga=Math.max(-1e9,Math.min(1e9,ga))];(function(aa,Ka,Hi,Qo,jo,To){var xa,xi=aa[0],ko=aa[1],Qa=0,Si=1,Xi=Ka[0]-xi,ai=Ka[1]-ko;if(xa=Hi-xi,Xi||!(xa>0)){if(xa/=Xi,Xi<0){if(xa<Qa)return;xa<Si&&(Si=xa)}else if(Xi>0){if(xa>Si)return;xa>Qa&&(Qa=xa)}if(xa=jo-xi,Xi||!(xa<0)){if(xa/=Xi,Xi<0){if(xa>Si)return;xa>Qa&&(Qa=xa)}else if(Xi>0){if(xa<Qa)return;xa<Si&&(Si=xa)}if(xa=Qo-ko,ai||!(xa>0)){if(xa/=ai,ai<0){if(xa<Qa)return;xa<Si&&(Si=xa)}else if(ai>0){if(xa>Si)return;xa>Qa&&(Qa=xa)}if(xa=To-ko,ai||!(xa<0)){if(xa/=ai,ai<0){if(xa>Si)return;xa>Qa&&(Qa=xa)}else if(ai>0){if(xa<Qa)return;xa<Si&&(Si=xa)}return Qa>0&&(aa[0]=xi+Qa*Xi,aa[1]=ko+Qa*ai),Si<1&&(Ka[0]=xi+Si*Xi,Ka[1]=ko+Si*ai),!0}}}}})(Ea,ri,ht,Ot,cr,Ut)?(na||(ra.lineStart(),ra.point(Ea[0],Ea[1])),ra.point(ri[0],ri[1]),Fa||ra.lineEnd(),Un=!1):Fa&&(ra.lineStart(),ra.point(Ca,ga),Un=!1)}oa=Ca,Kr=ga,na=Fa}return Pa}}var Xn,Br,pn,on=b(),Yr={sphere:S,point:S,lineStart:function(){Yr.point=Hn,Yr.lineEnd=Nn},lineEnd:S,polygonStart:S,polygonEnd:S};function Nn(){Yr.point=Yr.lineEnd=S}function Hn(ht,Ot){Xn=ht*=u,Br=_(Ot*=u),pn=d(Ot),Yr.point=xn}function xn(ht,Ot){ht*=u;var cr=_(Ot*=u),Ut=d(Ot),ur=f(ht-Xn),Or=d(ur),jr=Ut*_(ur),Zr=pn*cr-Br*Ut*Or,ln=Br*cr+pn*Ut*Or;on.add(h(k(jr*jr+Zr*Zr),ln)),Xn=ht,Br=cr,pn=Ut}function On(ht){return on.reset(),X(ht,Yr),+on}var ua=[null,null],tr={type:"LineString",coordinates:ua};function yr(ht,Ot){return ua[0]=ht,ua[1]=Ot,On(tr)}var Ct={Feature:function(ht,Ot){return dr(ht.geometry,Ot)},FeatureCollection:function(ht,Ot){for(var cr=ht.features,Ut=-1,ur=cr.length;++Ut<ur;)if(dr(cr[Ut].geometry,Ot))return!0;return!1}},lr={Sphere:function(){return!0},Point:function(ht,Ot){return Fr(ht.coordinates,Ot)},MultiPoint:function(ht,Ot){for(var cr=ht.coordinates,Ut=-1,ur=cr.length;++Ut<ur;)if(Fr(cr[Ut],Ot))return!0;return!1},LineString:function(ht,Ot){return Rr(ht.coordinates,Ot)},MultiLineString:function(ht,Ot){for(var cr=ht.coordinates,Ut=-1,ur=cr.length;++Ut<ur;)if(Rr(cr[Ut],Ot))return!0;return!1},Polygon:function(ht,Ot){return zr(ht.coordinates,Ot)},MultiPolygon:function(ht,Ot){for(var cr=ht.coordinates,Ut=-1,ur=cr.length;++Ut<ur;)if(zr(cr[Ut],Ot))return!0;return!1},GeometryCollection:function(ht,Ot){for(var cr=ht.geometries,Ut=-1,ur=cr.length;++Ut<ur;)if(dr(cr[Ut],Ot))return!0;return!1}};function dr(ht,Ot){return!(!ht||!lr.hasOwnProperty(ht.type))&&lr[ht.type](ht,Ot)}function Fr(ht,Ot){return yr(ht,Ot)===0}function Rr(ht,Ot){for(var cr,Ut,ur,Or=0,jr=ht.length;Or<jr;Or++){if((Ut=yr(ht[Or],Ot))===0||Or>0&&(ur=yr(ht[Or],ht[Or-1]))>0&&cr<=ur&&Ut<=ur&&(cr+Ut-ur)*(1-Math.pow((cr-Ut)/ur,2))<1e-12*ur)return!0;cr=Ut}return!1}function zr(ht,Ot){return!!Jr(ht.map(Er),xr(Ot))}function Er(ht){return(ht=ht.map(xr)).pop(),ht}function xr(ht){return[ht[0]*u,ht[1]*u]}function _r(ht,Ot,cr){var Ut=g.range(ht,Ot-t,cr).concat(Ot);return function(ur){return Ut.map(function(Or){return[ur,Or]})}}function kr(ht,Ot,cr){var Ut=g.range(ht,Ot-t,cr).concat(Ot);return function(ur){return Ut.map(function(Or){return[Or,ur]})}}function Cr(){var ht,Ot,cr,Ut,ur,Or,jr,Zr,ln,an,dn,Tn,cn=10,kn=cn,Fn=90,qn=360,oa=2.5;function Kr(){return{type:"MultiLineString",coordinates:na()}}function na(){return g.range(s(Ut/Fn)*Fn,cr,Fn).map(dn).concat(g.range(s(Zr/qn)*qn,jr,qn).map(Tn)).concat(g.range(s(Ot/cn)*cn,ht,cn).filter(function(Pn){return f(Pn%Fn)>t}).map(ln)).concat(g.range(s(Or/kn)*kn,ur,kn).filter(function(Pn){return f(Pn%qn)>t}).map(an))}return Kr.lines=function(){return na().map(function(Pn){return{type:"LineString",coordinates:Pn}})},Kr.outline=function(){return{type:"Polygon",coordinates:[dn(Ut).concat(Tn(jr).slice(1),dn(cr).reverse().slice(1),Tn(Zr).reverse().slice(1))]}},Kr.extent=function(Pn){return arguments.length?Kr.extentMajor(Pn).extentMinor(Pn):Kr.extentMinor()},Kr.extentMajor=function(Pn){return arguments.length?(Ut=+Pn[0][0],cr=+Pn[1][0],Zr=+Pn[0][1],jr=+Pn[1][1],Ut>cr&&(Pn=Ut,Ut=cr,cr=Pn),Zr>jr&&(Pn=Zr,Zr=jr,jr=Pn),Kr.precision(oa)):[[Ut,Zr],[cr,jr]]},Kr.extentMinor=function(Pn){return arguments.length?(Ot=+Pn[0][0],ht=+Pn[1][0],Or=+Pn[0][1],ur=+Pn[1][1],Ot>ht&&(Pn=Ot,Ot=ht,ht=Pn),Or>ur&&(Pn=Or,Or=ur,ur=Pn),Kr.precision(oa)):[[Ot,Or],[ht,ur]]},Kr.step=function(Pn){return arguments.length?Kr.stepMajor(Pn).stepMinor(Pn):Kr.stepMinor()},Kr.stepMajor=function(Pn){return arguments.length?(Fn=+Pn[0],qn=+Pn[1],Kr):[Fn,qn]},Kr.stepMinor=function(Pn){return arguments.length?(cn=+Pn[0],kn=+Pn[1],Kr):[cn,kn]},Kr.precision=function(Pn){return arguments.length?(oa=+Pn,ln=_r(Or,ur,90),an=kr(Ot,ht,oa),dn=_r(Zr,jr,90),Tn=kr(Ut,cr,oa),Kr):oa},Kr.extentMajor([[-180,-90+t],[180,90-t]]).extentMinor([[-180,-80-t],[180,80+t]])}function Gr(ht){return ht}var qr,tn,rn,yn,_n=b(),wn=b(),Ln={point:S,lineStart:S,lineEnd:S,polygonStart:function(){Ln.lineStart=zn,Ln.lineEnd=Ma},polygonEnd:function(){Ln.lineStart=Ln.lineEnd=Ln.point=S,_n.add(f(wn)),wn.reset()},result:function(){var ht=_n/2;return _n.reset(),ht}};function zn(){Ln.point=Zn}function Zn(ht,Ot){Ln.point=Aa,qr=rn=ht,tn=yn=Ot}function Aa(ht,Ot){wn.add(yn*ht-rn*Ot),rn=ht,yn=Ot}function Ma(){Aa(qr,tn)}var An=1/0,ea=An,Qn=-An,za=Qn,vi={point:function(ht,Ot){ht<An&&(An=ht),ht>Qn&&(Qn=ht),Ot<ea&&(ea=Ot),Ot>za&&(za=Ot)},lineStart:S,lineEnd:S,polygonStart:S,polygonEnd:S,result:function(){var ht=[[An,ea],[Qn,za]];return Qn=za=-(ea=An=1/0),ht}},Fi,po,Xa,Za,eo=0,Na=0,mo=0,bo=0,Mi=0,to=0,_o=0,Co=0,Ui=0,yi={point:Ki,lineStart:Ts,lineEnd:vs,polygonStart:function(){yi.lineStart=rs,yi.lineEnd=Ls},polygonEnd:function(){yi.point=Ki,yi.lineStart=Ts,yi.lineEnd=vs},result:function(){var ht=Ui?[_o/Ui,Co/Ui]:to?[bo/to,Mi/to]:mo?[eo/mo,Na/mo]:[NaN,NaN];return eo=Na=mo=bo=Mi=to=_o=Co=Ui=0,ht}};function Ki(ht,Ot){eo+=ht,Na+=Ot,++mo}function Ts(){yi.point=Es}function Es(ht,Ot){yi.point=Ja,Ki(Xa=ht,Za=Ot)}function Ja(ht,Ot){var cr=ht-Xa,Ut=Ot-Za,ur=k(cr*cr+Ut*Ut);bo+=ur*(Xa+ht)/2,Mi+=ur*(Za+Ot)/2,to+=ur,Ki(Xa=ht,Za=Ot)}function vs(){yi.point=Ki}function rs(){yi.point=Cs}function Ls(){ks(Fi,po)}function Cs(ht,Ot){yi.point=ks,Ki(Fi=Xa=ht,po=Za=Ot)}function ks(ht,Ot){var cr=ht-Xa,Ut=Ot-Za,ur=k(cr*cr+Ut*Ut);bo+=ur*(Xa+ht)/2,Mi+=ur*(Za+Ot)/2,to+=ur,_o+=(ur=Za*ht-Xa*Ot)*(Xa+ht),Co+=ur*(Za+Ot),Ui+=3*ur,Ki(Xa=ht,Za=Ot)}function Ps(ht){this._context=ht}Ps.prototype={_radius:4.5,pointRadius:function(ht){return this._radius=ht,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(ht,Ot){switch(this._point){case 0:this._context.moveTo(ht,Ot),this._point=1;break;case 1:this._context.lineTo(ht,Ot);break;default:this._context.moveTo(ht+this._radius,Ot),this._context.arc(ht,Ot,this._radius,0,o)}},result:S};var Oo,zo,Go,Yo,Wo,ns=b(),wo={point:S,lineStart:function(){wo.point=ys},lineEnd:function(){Oo&&go(zo,Go),wo.point=S},polygonStart:function(){Oo=!0},polygonEnd:function(){Oo=null},result:function(){var ht=+ns;return ns.reset(),ht}};function ys(ht,Ot){wo.point=go,zo=Yo=ht,Go=Wo=Ot}function go(ht,Ot){Yo-=ht,Wo-=Ot,ns.add(k(Yo*Yo+Wo*Wo)),Yo=ht,Wo=Ot}function Xo(){this._string=[]}function xs(ht){return"m0,"+ht+"a"+ht+","+ht+" 0 1,1 0,"+-2*ht+"a"+ht+","+ht+" 0 1,1 0,"+2*ht+"z"}function Do(ht){return function(Ot){var cr=new Ya;for(var Ut in ht)cr[Ut]=ht[Ut];return cr.stream=Ot,cr}}function Ya(){}function je(ht,Ot,cr){var Ut=ht.clipExtent&&ht.clipExtent();return ht.scale(150).translate([0,0]),Ut!=null&&ht.clipExtent(null),X(cr,ht.stream(vi)),Ot(vi.result()),Ut!=null&&ht.clipExtent(Ut),ht}function Ge(ht,Ot,cr){return je(ht,function(Ut){var ur=Ot[1][0]-Ot[0][0],Or=Ot[1][1]-Ot[0][1],jr=Math.min(ur/(Ut[1][0]-Ut[0][0]),Or/(Ut[1][1]-Ut[0][1])),Zr=+Ot[0][0]+(ur-jr*(Ut[1][0]+Ut[0][0]))/2,ln=+Ot[0][1]+(Or-jr*(Ut[1][1]+Ut[0][1]))/2;ht.scale(150*jr).translate([Zr,ln])},cr)}function et(ht,Ot,cr){return Ge(ht,[[0,0],Ot],cr)}function lt(ht,Ot,cr){return je(ht,function(Ut){var ur=+Ot,Or=ur/(Ut[1][0]-Ut[0][0]),jr=(ur-Or*(Ut[1][0]+Ut[0][0]))/2,Zr=-Or*Ut[0][1];ht.scale(150*Or).translate([jr,Zr])},cr)}function gt(ht,Ot,cr){return je(ht,function(Ut){var ur=+Ot,Or=ur/(Ut[1][1]-Ut[0][1]),jr=-Or*Ut[0][0],Zr=(ur-Or*(Ut[1][1]+Ut[0][1]))/2;ht.scale(150*Or).translate([jr,Zr])},cr)}Xo.prototype={_radius:4.5,_circle:xs(4.5),pointRadius:function(ht){return(ht=+ht)!==this._radius&&(this._radius=ht,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(ht,Ot){switch(this._point){case 0:this._string.push("M",ht,",",Ot),this._point=1;break;case 1:this._string.push("L",ht,",",Ot);break;default:this._circle==null&&(this._circle=xs(this._radius)),this._string.push("M",ht,",",Ot,this._circle)}},result:function(){if(this._string.length){var ht=this._string.join("");return this._string=[],ht}return null}},Ya.prototype={constructor:Ya,point:function(ht,Ot){this.stream.point(ht,Ot)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var dt=d(30*u);function St(ht,Ot){return+Ot?function(cr,Ut){function ur(Or,jr,Zr,ln,an,dn,Tn,cn,kn,Fn,qn,oa,Kr,na){var Pn=Tn-Or,Un=cn-jr,ra=Pn*Pn+Un*Un;if(ra>4*Ut&&Kr--){var ka=ln+Fn,Pa=an+qn,En=dn+oa,Ra=k(ka*ka+Pa*Pa+En*En),Ca=I(En/=Ra),ga=f(f(En)-1)<t||f(Zr-kn)<t?(Zr+kn)/2:h(Pa,ka),Fa=cr(ga,Ca),Ea=Fa[0],ri=Fa[1],aa=Ea-Or,Ka=ri-jr,Hi=Un*aa-Pn*Ka;(Hi*Hi/ra>Ut||f((Pn*aa+Un*Ka)/ra-.5)>.3||ln*Fn+an*qn+dn*oa<dt)&&(ur(Or,jr,Zr,ln,an,dn,Ea,ri,ga,ka/=Ra,Pa/=Ra,En,Kr,na),na.point(Ea,ri),ur(Ea,ri,ga,ka,Pa,En,Tn,cn,kn,Fn,qn,oa,Kr,na))}}return function(Or){var jr,Zr,ln,an,dn,Tn,cn,kn,Fn,qn,oa,Kr,na={point:Pn,lineStart:Un,lineEnd:ka,polygonStart:function(){Or.polygonStart(),na.lineStart=Pa},polygonEnd:function(){Or.polygonEnd(),na.lineStart=Un}};function Pn(Ca,ga){Ca=cr(Ca,ga),Or.point(Ca[0],Ca[1])}function Un(){kn=NaN,na.point=ra,Or.lineStart()}function ra(Ca,ga){var Fa=le([Ca,ga]),Ea=cr(Ca,ga);ur(kn,Fn,cn,qn,oa,Kr,kn=Ea[0],Fn=Ea[1],cn=Ca,qn=Fa[0],oa=Fa[1],Kr=Fa[2],16,Or),Or.point(kn,Fn)}function ka(){na.point=Pn,Or.lineEnd()}function Pa(){Un(),na.point=En,na.lineEnd=Ra}function En(Ca,ga){ra(jr=Ca,ga),Zr=kn,ln=Fn,an=qn,dn=oa,Tn=Kr,na.point=ra}function Ra(){ur(kn,Fn,cn,qn,oa,Kr,Zr,ln,jr,an,dn,Tn,16,Or),na.lineEnd=ka,ka()}return na}}(ht,Ot):function(cr){return Do({point:function(Ut,ur){Ut=cr(Ut,ur),this.stream.point(Ut[0],Ut[1])}})}(ht)}var Xt=Do({point:function(ht,Ot){this.stream.point(ht*u,Ot*u)}});function Kt(ht,Ot,cr,Ut,ur){function Or(jr,Zr){return[Ot+ht*(jr*=Ut),cr-ht*(Zr*=ur)]}return Or.invert=function(jr,Zr){return[(jr-Ot)/ht*Ut,(cr-Zr)/ht*ur]},Or}function Yt(ht,Ot,cr,Ut,ur,Or){var jr=d(Or),Zr=_(Or),ln=jr*ht,an=Zr*ht,dn=jr/ht,Tn=Zr/ht,cn=(Zr*cr-jr*Ot)/ht,kn=(Zr*Ot+jr*cr)/ht;function Fn(qn,oa){return[ln*(qn*=Ut)-an*(oa*=ur)+Ot,cr-an*qn-ln*oa]}return Fn.invert=function(qn,oa){return[Ut*(dn*qn-Tn*oa+cn),ur*(kn-Tn*qn-dn*oa)]},Fn}function or(ht){return mr(function(){return ht})()}function mr(ht){var Ot,cr,Ut,ur,Or,jr,Zr,ln,an,dn,Tn=150,cn=480,kn=250,Fn=0,qn=0,oa=0,Kr=0,na=0,Pn=0,Un=1,ra=1,ka=null,Pa=vn,En=null,Ra=Gr,Ca=.5;function ga(aa){return ln(aa[0]*u,aa[1]*u)}function Fa(aa){return(aa=ln.invert(aa[0],aa[1]))&&[aa[0]*i,aa[1]*i]}function Ea(){var aa=Yt(Tn,0,0,Un,ra,Pn).apply(null,Ot(Fn,qn)),Ka=(Pn?Yt:Kt)(Tn,cn-aa[0],kn-aa[1],Un,ra,Pn);return cr=Rt(oa,Kr,na),Zr=ft(Ot,Ka),ln=ft(cr,Zr),jr=St(Zr,Ca),ri()}function ri(){return an=dn=null,ga}return ga.stream=function(aa){return an&&dn===aa?an:an=Xt(function(Ka){return Do({point:function(Hi,Qo){var jo=Ka(Hi,Qo);return this.stream.point(jo[0],jo[1])}})}(cr)(Pa(jr(Ra(dn=aa)))))},ga.preclip=function(aa){return arguments.length?(Pa=aa,ka=void 0,ri()):Pa},ga.postclip=function(aa){return arguments.length?(Ra=aa,En=Ut=ur=Or=null,ri()):Ra},ga.clipAngle=function(aa){return arguments.length?(Pa=+aa?gn(ka=aa*u):(ka=null,vn),ri()):ka*i},ga.clipExtent=function(aa){return arguments.length?(Ra=aa==null?(En=Ut=ur=Or=null,Gr):Sn(En=+aa[0][0],Ut=+aa[0][1],ur=+aa[1][0],Or=+aa[1][1]),ri()):En==null?null:[[En,Ut],[ur,Or]]},ga.scale=function(aa){return arguments.length?(Tn=+aa,Ea()):Tn},ga.translate=function(aa){return arguments.length?(cn=+aa[0],kn=+aa[1],Ea()):[cn,kn]},ga.center=function(aa){return arguments.length?(Fn=aa[0]%360*u,qn=aa[1]%360*u,Ea()):[Fn*i,qn*i]},ga.rotate=function(aa){return arguments.length?(oa=aa[0]%360*u,Kr=aa[1]%360*u,na=aa.length>2?aa[2]%360*u:0,Ea()):[oa*i,Kr*i,na*i]},ga.angle=function(aa){return arguments.length?(Pn=aa%360*u,Ea()):Pn*i},ga.reflectX=function(aa){return arguments.length?(Un=aa?-1:1,Ea()):Un<0},ga.reflectY=function(aa){return arguments.length?(ra=aa?-1:1,Ea()):ra<0},ga.precision=function(aa){return arguments.length?(jr=St(Zr,Ca=aa*aa),ri()):k(Ca)},ga.fitExtent=function(aa,Ka){return Ge(ga,aa,Ka)},ga.fitSize=function(aa,Ka){return et(ga,aa,Ka)},ga.fitWidth=function(aa,Ka){return lt(ga,aa,Ka)},ga.fitHeight=function(aa,Ka){return gt(ga,aa,Ka)},function(){return Ot=ht.apply(this,arguments),ga.invert=Ot.invert&&Fa,Ea()}}function wr(ht){var Ot=0,cr=a/3,Ut=mr(ht),ur=Ut(Ot,cr);return ur.parallels=function(Or){return arguments.length?Ut(Ot=Or[0]*u,cr=Or[1]*u):[Ot*i,cr*i]},ur}function Tr(ht,Ot){var cr=_(ht),Ut=(cr+_(Ot))/2;if(f(Ut)<t)return function(Zr){var ln=d(Zr);function an(dn,Tn){return[dn*ln,_(Tn)/ln]}return an.invert=function(dn,Tn){return[dn/ln,I(Tn*ln)]},an}(ht);var ur=1+cr*(2*Ut-cr),Or=k(ur)/Ut;function jr(Zr,ln){var an=k(ur-2*Ut*_(ln))/Ut;return[an*_(Zr*=Ut),Or-an*d(Zr)]}return jr.invert=function(Zr,ln){var an=Or-ln,dn=h(Zr,f(an))*w(an);return an*Ut<0&&(dn-=a*w(Zr)*w(an)),[dn/Ut,I((ur-(Zr*Zr+an*an)*Ut*Ut)/(2*Ut))]},jr}function Dr(){return wr(Tr).scale(155.424).center([0,33.6442])}function nn(){return Dr().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function hn(ht){return function(Ot,cr){var Ut=d(Ot),ur=d(cr),Or=ht(Ut*ur);return[Or*ur*_(Ot),Or*_(cr)]}}function Cn(ht){return function(Ot,cr){var Ut=k(Ot*Ot+cr*cr),ur=ht(Ut),Or=_(ur),jr=d(ur);return[h(Ot*Or,Ut*jr),I(Ut&&cr*Or/Ut)]}}var Dn=hn(function(ht){return k(2/(1+ht))});Dn.invert=Cn(function(ht){return 2*I(ht/2)});var Gn=hn(function(ht){return(ht=A(ht))&&ht/_(ht)});function Rn(ht,Ot){return[ht,c(L((r+Ot)/2))]}function va(ht){var Ot,cr,Ut,ur=or(ht),Or=ur.center,jr=ur.scale,Zr=ur.translate,ln=ur.clipExtent,an=null;function dn(){var Tn=a*jr(),cn=ur(Ar(ur.rotate()).invert([0,0]));return ln(an==null?[[cn[0]-Tn,cn[1]-Tn],[cn[0]+Tn,cn[1]+Tn]]:ht===Rn?[[Math.max(cn[0]-Tn,an),Ot],[Math.min(cn[0]+Tn,cr),Ut]]:[[an,Math.max(cn[1]-Tn,Ot)],[cr,Math.min(cn[1]+Tn,Ut)]])}return ur.scale=function(Tn){return arguments.length?(jr(Tn),dn()):jr()},ur.translate=function(Tn){return arguments.length?(Zr(Tn),dn()):Zr()},ur.center=function(Tn){return arguments.length?(Or(Tn),dn()):Or()},ur.clipExtent=function(Tn){return arguments.length?(Tn==null?an=Ot=cr=Ut=null:(an=+Tn[0][0],Ot=+Tn[0][1],cr=+Tn[1][0],Ut=+Tn[1][1]),dn()):an==null?null:[[an,Ot],[cr,Ut]]},dn()}function Sa(ht){return L((r+ht)/2)}function Ua(ht,Ot){var cr=d(ht),Ut=ht===Ot?_(ht):c(cr/d(Ot))/c(Sa(Ot)/Sa(ht)),ur=cr*T(Sa(ht),Ut)/Ut;if(!Ut)return Rn;function Or(jr,Zr){ur>0?Zr<-r+t&&(Zr=-r+t):Zr>r-t&&(Zr=r-t);var ln=ur/T(Sa(Zr),Ut);return[ln*_(Ut*jr),ur-ln*d(Ut*jr)]}return Or.invert=function(jr,Zr){var ln=ur-Zr,an=w(Ut)*k(jr*jr+ln*ln),dn=h(jr,f(ln))*w(ln);return ln*Ut<0&&(dn-=a*w(jr)*w(ln)),[dn/Ut,2*l(T(ur/an,1/Ut))-r]},Or}function ja(ht,Ot){return[ht,Ot]}function Va(ht,Ot){var cr=d(ht),Ut=ht===Ot?_(ht):(cr-d(Ot))/(Ot-ht),ur=cr/Ut+ht;if(f(Ut)<t)return ja;function Or(jr,Zr){var ln=ur-Zr,an=Ut*jr;return[ln*_(an),ur-ln*d(an)]}return Or.invert=function(jr,Zr){var ln=ur-Zr,an=h(jr,f(ln))*w(ln);return ln*Ut<0&&(an-=a*w(jr)*w(ln)),[an/Ut,ur-w(Ut)*k(jr*jr+ln*ln)]},Or}Gn.invert=Cn(function(ht){return ht}),Rn.invert=function(ht,Ot){return[ht,2*l(x(Ot))-r]},ja.invert=ja;var Ai=1.340264,Ti=-.081106,ci=893e-6,ui=.003796,ki=k(3)/2;function Vi(ht,Ot){var cr=I(ki*_(Ot)),Ut=cr*cr,ur=Ut*Ut*Ut;return[ht*d(cr)/(ki*(Ai+3*Ti*Ut+ur*(7*ci+9*ui*Ut))),cr*(Ai+Ti*Ut+ur*(ci+ui*Ut))]}function ro(ht,Ot){var cr=d(Ot),Ut=d(ht)*cr;return[cr*_(ht)/Ut,_(Ot)/Ut]}function no(ht,Ot){var cr=Ot*Ot,Ut=cr*cr;return[ht*(.8707-.131979*cr+Ut*(Ut*(.003971*cr-.001529*Ut)-.013791)),Ot*(1.007226+cr*(.015085+Ut*(.028874*cr-.044475-.005916*Ut)))]}function ao(ht,Ot){return[d(Ot)*_(ht),_(Ot)]}function io(ht,Ot){var cr=d(Ot),Ut=1+d(ht)*cr;return[cr*_(ht)/Ut,_(Ot)/Ut]}function Da(ht,Ot){return[c(L((r+Ot)/2)),-ht]}Vi.invert=function(ht,Ot){for(var cr,Ut=Ot,ur=Ut*Ut,Or=ur*ur*ur,jr=0;jr<12&&(Or=(ur=(Ut-=cr=(Ut*(Ai+Ti*ur+Or*(ci+ui*ur))-Ot)/(Ai+3*Ti*ur+Or*(7*ci+9*ui*ur)))*Ut)*ur*ur,!(f(cr)<1e-12));++jr);return[ki*ht*(Ai+3*Ti*ur+Or*(7*ci+9*ui*ur))/d(Ut),I(_(Ut)/ki)]},ro.invert=Cn(l),no.invert=function(ht,Ot){var cr,Ut=Ot,ur=25;do{var Or=Ut*Ut,jr=Or*Or;Ut-=cr=(Ut*(1.007226+Or*(.015085+jr*(.028874*Or-.044475-.005916*jr)))-Ot)/(1.007226+Or*(.045255+jr*(.259866*Or-.311325-.005916*11*jr)))}while(f(cr)>t&&--ur>0);return[ht/(.8707+(Or=Ut*Ut)*(Or*(Or*Or*Or*(.003971-.001529*Or)-.013791)-.131979)),Ut]},ao.invert=Cn(I),io.invert=Cn(function(ht){return 2*l(ht)}),Da.invert=function(ht,Ot){return[-Ot,2*l(x(ht))-r]},p.geoAlbers=nn,p.geoAlbersUsa=function(){var ht,Ot,cr,Ut,ur,Or,jr=nn(),Zr=Dr().rotate([154,0]).center([-2,58.5]).parallels([55,65]),ln=Dr().rotate([157,0]).center([-3,19.9]).parallels([8,18]),an={point:function(cn,kn){Or=[cn,kn]}};function dn(cn){var kn=cn[0],Fn=cn[1];return Or=null,cr.point(kn,Fn),Or||(Ut.point(kn,Fn),Or)||(ur.point(kn,Fn),Or)}function Tn(){return ht=Ot=null,dn}return dn.invert=function(cn){var kn=jr.scale(),Fn=jr.translate(),qn=(cn[0]-Fn[0])/kn,oa=(cn[1]-Fn[1])/kn;return(oa>=.12&&oa<.234&&qn>=-.425&&qn<-.214?Zr:oa>=.166&&oa<.234&&qn>=-.214&&qn<-.115?ln:jr).invert(cn)},dn.stream=function(cn){return ht&&Ot===cn?ht:(kn=[jr.stream(Ot=cn),Zr.stream(cn),ln.stream(cn)],Fn=kn.length,ht={point:function(qn,oa){for(var Kr=-1;++Kr<Fn;)kn[Kr].point(qn,oa)},sphere:function(){for(var qn=-1;++qn<Fn;)kn[qn].sphere()},lineStart:function(){for(var qn=-1;++qn<Fn;)kn[qn].lineStart()},lineEnd:function(){for(var qn=-1;++qn<Fn;)kn[qn].lineEnd()},polygonStart:function(){for(var qn=-1;++qn<Fn;)kn[qn].polygonStart()},polygonEnd:function(){for(var qn=-1;++qn<Fn;)kn[qn].polygonEnd()}});var kn,Fn},dn.precision=function(cn){return arguments.length?(jr.precision(cn),Zr.precision(cn),ln.precision(cn),Tn()):jr.precision()},dn.scale=function(cn){return arguments.length?(jr.scale(cn),Zr.scale(.35*cn),ln.scale(cn),dn.translate(jr.translate())):jr.scale()},dn.translate=function(cn){if(!arguments.length)return jr.translate();var kn=jr.scale(),Fn=+cn[0],qn=+cn[1];return cr=jr.translate(cn).clipExtent([[Fn-.455*kn,qn-.238*kn],[Fn+.455*kn,qn+.238*kn]]).stream(an),Ut=Zr.translate([Fn-.307*kn,qn+.201*kn]).clipExtent([[Fn-.425*kn+t,qn+.12*kn+t],[Fn-.214*kn-t,qn+.234*kn-t]]).stream(an),ur=ln.translate([Fn-.205*kn,qn+.212*kn]).clipExtent([[Fn-.214*kn+t,qn+.166*kn+t],[Fn-.115*kn-t,qn+.234*kn-t]]).stream(an),Tn()},dn.fitExtent=function(cn,kn){return Ge(dn,cn,kn)},dn.fitSize=function(cn,kn){return et(dn,cn,kn)},dn.fitWidth=function(cn,kn){return lt(dn,cn,kn)},dn.fitHeight=function(cn,kn){return gt(dn,cn,kn)},dn.scale(1070)},p.geoArea=function(ht){return U.reset(),X(ht,ee),2*U},p.geoAzimuthalEqualArea=function(){return or(Dn).scale(124.75).clipAngle(179.999)},p.geoAzimuthalEqualAreaRaw=Dn,p.geoAzimuthalEquidistant=function(){return or(Gn).scale(79.4188).clipAngle(179.999)},p.geoAzimuthalEquidistantRaw=Gn,p.geoBounds=function(ht){var Ot,cr,Ut,ur,Or,jr,Zr;if(fe=Ce=-(_e=be=1/0),ze=[],X(ht,Jt),cr=ze.length){for(ze.sort(Xe),Ot=1,Or=[Ut=ze[0]];Ot<cr;++Ot)He(Ut,(ur=ze[Ot])[0])||He(Ut,ur[1])?(qe(Ut[0],ur[1])>qe(Ut[0],Ut[1])&&(Ut[1]=ur[1]),qe(ur[0],Ut[1])>qe(Ut[0],Ut[1])&&(Ut[0]=ur[0])):Or.push(Ut=ur);for(jr=-1/0,Ot=0,Ut=Or[cr=Or.length-1];Ot<=cr;Ut=ur,++Ot)ur=Or[Ot],(Zr=qe(Ut[1],ur[0]))>jr&&(jr=Zr,_e=ur[0],Ce=Ut[1])}return ze=Re=null,_e===1/0||be===1/0?[[NaN,NaN],[NaN,NaN]]:[[_e,be],[Ce,fe]]},p.geoCentroid=function(ht){Oe=Ze=Pe=Ie=Be=Fe=$e=ot=pt=_t=yt=0,X(ht,st);var Ot=pt,cr=_t,Ut=yt,ur=Ot*Ot+cr*cr+Ut*Ut;return ur<1e-12&&(Ot=Fe,cr=$e,Ut=ot,Ze<t&&(Ot=Pe,cr=Ie,Ut=Be),(ur=Ot*Ot+cr*cr+Ut*Ut)<1e-12)?[NaN,NaN]:[h(cr,Ot)*i,I(Ut/k(ur))*i]},p.geoCircle=function(){var ht,Ot,cr=nt([0,0]),Ut=nt(90),ur=nt(6),Or={point:function(Zr,ln){ht.push(Zr=Ot(Zr,ln)),Zr[0]*=i,Zr[1]*=i}};function jr(){var Zr=cr.apply(this,arguments),ln=Ut.apply(this,arguments)*u,an=ur.apply(this,arguments)*u;return ht=[],Ot=Rt(-Zr[0]*u,-Zr[1]*u,0).invert,fr(Or,ln,an,1),Zr={type:"Polygon",coordinates:[ht]},ht=Ot=null,Zr}return jr.center=function(Zr){return arguments.length?(cr=typeof Zr=="function"?Zr:nt([+Zr[0],+Zr[1]]),jr):cr},jr.radius=function(Zr){return arguments.length?(Ut=typeof Zr=="function"?Zr:nt(+Zr),jr):Ut},jr.precision=function(Zr){return arguments.length?(ur=typeof Zr=="function"?Zr:nt(+Zr),jr):ur},jr},p.geoClipAntimeridian=vn,p.geoClipCircle=gn,p.geoClipExtent=function(){var ht,Ot,cr,Ut=0,ur=0,Or=960,jr=500;return cr={stream:function(Zr){return ht&&Ot===Zr?ht:ht=Sn(Ut,ur,Or,jr)(Ot=Zr)},extent:function(Zr){return arguments.length?(Ut=+Zr[0][0],ur=+Zr[0][1],Or=+Zr[1][0],jr=+Zr[1][1],ht=Ot=null,cr):[[Ut,ur],[Or,jr]]}}},p.geoClipRectangle=Sn,p.geoConicConformal=function(){return wr(Ua).scale(109.5).parallels([30,30])},p.geoConicConformalRaw=Ua,p.geoConicEqualArea=Dr,p.geoConicEqualAreaRaw=Tr,p.geoConicEquidistant=function(){return wr(Va).scale(131.154).center([0,13.9389])},p.geoConicEquidistantRaw=Va,p.geoContains=function(ht,Ot){return(ht&&Ct.hasOwnProperty(ht.type)?Ct[ht.type]:dr)(ht,Ot)},p.geoDistance=yr,p.geoEqualEarth=function(){return or(Vi).scale(177.158)},p.geoEqualEarthRaw=Vi,p.geoEquirectangular=function(){return or(ja).scale(152.63)},p.geoEquirectangularRaw=ja,p.geoGnomonic=function(){return or(ro).scale(144.049).clipAngle(60)},p.geoGnomonicRaw=ro,p.geoGraticule=Cr,p.geoGraticule10=function(){return Cr()()},p.geoIdentity=function(){var ht,Ot,cr,Ut,ur,Or,jr,Zr=1,ln=0,an=0,dn=1,Tn=1,cn=0,kn=null,Fn=1,qn=1,oa=Do({point:function(Un,ra){var ka=Pn([Un,ra]);this.stream.point(ka[0],ka[1])}}),Kr=Gr;function na(){return Fn=Zr*dn,qn=Zr*Tn,Or=jr=null,Pn}function Pn(Un){var ra=Un[0]*Fn,ka=Un[1]*qn;if(cn){var Pa=ka*ht-ra*Ot;ra=ra*ht+ka*Ot,ka=Pa}return[ra+ln,ka+an]}return Pn.invert=function(Un){var ra=Un[0]-ln,ka=Un[1]-an;if(cn){var Pa=ka*ht+ra*Ot;ra=ra*ht-ka*Ot,ka=Pa}return[ra/Fn,ka/qn]},Pn.stream=function(Un){return Or&&jr===Un?Or:Or=oa(Kr(jr=Un))},Pn.postclip=function(Un){return arguments.length?(Kr=Un,kn=cr=Ut=ur=null,na()):Kr},Pn.clipExtent=function(Un){return arguments.length?(Kr=Un==null?(kn=cr=Ut=ur=null,Gr):Sn(kn=+Un[0][0],cr=+Un[0][1],Ut=+Un[1][0],ur=+Un[1][1]),na()):kn==null?null:[[kn,cr],[Ut,ur]]},Pn.scale=function(Un){return arguments.length?(Zr=+Un,na()):Zr},Pn.translate=function(Un){return arguments.length?(ln=+Un[0],an=+Un[1],na()):[ln,an]},Pn.angle=function(Un){return arguments.length?(Ot=_(cn=Un%360*u),ht=d(cn),na()):cn*i},Pn.reflectX=function(Un){return arguments.length?(dn=Un?-1:1,na()):dn<0},Pn.reflectY=function(Un){return arguments.length?(Tn=Un?-1:1,na()):Tn<0},Pn.fitExtent=function(Un,ra){return Ge(Pn,Un,ra)},Pn.fitSize=function(Un,ra){return et(Pn,Un,ra)},Pn.fitWidth=function(Un,ra){return lt(Pn,Un,ra)},Pn.fitHeight=function(Un,ra){return gt(Pn,Un,ra)},Pn},p.geoInterpolate=function(ht,Ot){var cr=ht[0]*u,Ut=ht[1]*u,ur=Ot[0]*u,Or=Ot[1]*u,jr=d(Ut),Zr=_(Ut),ln=d(Or),an=_(Or),dn=jr*d(cr),Tn=jr*_(cr),cn=ln*d(ur),kn=ln*_(ur),Fn=2*I(k(P(Or-Ut)+jr*ln*P(ur-cr))),qn=_(Fn),oa=Fn?function(Kr){var na=_(Kr*=Fn)/qn,Pn=_(Fn-Kr)/qn,Un=Pn*dn+na*cn,ra=Pn*Tn+na*kn,ka=Pn*Zr+na*an;return[h(ra,Un)*i,h(ka,k(Un*Un+ra*ra))*i]}:function(){return[cr*i,Ut*i]};return oa.distance=Fn,oa},p.geoLength=On,p.geoMercator=function(){return va(Rn).scale(961/o)},p.geoMercatorRaw=Rn,p.geoNaturalEarth1=function(){return or(no).scale(175.295)},p.geoNaturalEarth1Raw=no,p.geoOrthographic=function(){return or(ao).scale(249.5).clipAngle(90+t)},p.geoOrthographicRaw=ao,p.geoPath=function(ht,Ot){var cr,Ut,ur=4.5;function Or(jr){return jr&&(typeof ur=="function"&&Ut.pointRadius(+ur.apply(this,arguments)),X(jr,cr(Ut))),Ut.result()}return Or.area=function(jr){return X(jr,cr(Ln)),Ln.result()},Or.measure=function(jr){return X(jr,cr(wo)),wo.result()},Or.bounds=function(jr){return X(jr,cr(vi)),vi.result()},Or.centroid=function(jr){return X(jr,cr(yi)),yi.result()},Or.projection=function(jr){return arguments.length?(cr=jr==null?(ht=null,Gr):(ht=jr).stream,Or):ht},Or.context=function(jr){return arguments.length?(Ut=jr==null?(Ot=null,new Xo):new Ps(Ot=jr),typeof ur!="function"&&Ut.pointRadius(ur),Or):Ot},Or.pointRadius=function(jr){return arguments.length?(ur=typeof jr=="function"?jr:(Ut.pointRadius(+jr),+jr),Or):ur},Or.projection(ht).context(Ot)},p.geoProjection=or,p.geoProjectionMutator=mr,p.geoRotation=Ar,p.geoStereographic=function(){return or(io).scale(250).clipAngle(142)},p.geoStereographicRaw=io,p.geoStream=X,p.geoTransform=function(ht){return{stream:Do(ht)}},p.geoTransverseMercator=function(){var ht=va(Da),Ot=ht.center,cr=ht.rotate;return ht.center=function(Ut){return arguments.length?Ot([-Ut[1],Ut[0]]):[(Ut=Ot())[1],-Ut[0]]},ht.rotate=function(Ut){return arguments.length?cr([Ut[0],Ut[1],Ut.length>2?Ut[2]+90:90]):[(Ut=cr())[0],Ut[1],Ut[2]-90]},cr([0,0,90]).scale(159.155)},p.geoTransverseMercatorRaw=Da,Object.defineProperty(p,"__esModule",{value:!0})})},{"d3-array":107}],115:[function(v,J,Z){(function(p,g){g(typeof Z=="object"&&J!==void 0?Z:(p=p||self).d3=p.d3||{})})(this,function(p){function g(oe,de){return oe.parent===de.parent?1:2}function b(oe,de){return oe+de.x}function y(oe,de){return Math.max(oe,de.y)}function e(oe){var de=0,se=oe.children,me=se&&se.length;if(me)for(;--me>=0;)de+=se[me].value;else de=1;oe.value=de}function n(oe,de){var se,me,Te,_e,be,Ce=new m(oe),fe=+oe.value&&(Ce.value=oe.value),ve=[Ce];for(de==null&&(de=t);se=ve.pop();)if(fe&&(se.value=+se.data.value),(Te=de(se.data))&&(be=Te.length))for(se.children=new Array(be),_e=be-1;_e>=0;--_e)ve.push(me=se.children[_e]=new m(Te[_e])),me.parent=se,me.depth=se.depth+1;return Ce.eachBefore(r)}function t(oe){return oe.children}function a(oe){oe.data=oe.data.data}function r(oe){var de=0;do oe.height=de;while((oe=oe.parent)&&oe.height<++de)}function m(oe){this.data=oe,this.depth=this.height=0,this.parent=null}m.prototype=n.prototype={constructor:m,count:function(){return this.eachAfter(e)},each:function(oe){var de,se,me,Te,_e=this,be=[_e];do for(de=be.reverse(),be=[];_e=de.pop();)if(oe(_e),se=_e.children)for(me=0,Te=se.length;me<Te;++me)be.push(se[me]);while(be.length);return this},eachAfter:function(oe){for(var de,se,me,Te=this,_e=[Te],be=[];Te=_e.pop();)if(be.push(Te),de=Te.children)for(se=0,me=de.length;se<me;++se)_e.push(de[se]);for(;Te=be.pop();)oe(Te);return this},eachBefore:function(oe){for(var de,se,me=this,Te=[me];me=Te.pop();)if(oe(me),de=me.children)for(se=de.length-1;se>=0;--se)Te.push(de[se]);return this},sum:function(oe){return this.eachAfter(function(de){for(var se=+oe(de.data)||0,me=de.children,Te=me&&me.length;--Te>=0;)se+=me[Te].value;de.value=se})},sort:function(oe){return this.eachBefore(function(de){de.children&&de.children.sort(oe)})},path:function(oe){for(var de=this,se=function(_e,be){if(_e===be)return _e;var Ce=_e.ancestors(),fe=be.ancestors(),ve=null;for(_e=Ce.pop(),be=fe.pop();_e===be;)ve=_e,_e=Ce.pop(),be=fe.pop();return ve}(de,oe),me=[de];de!==se;)de=de.parent,me.push(de);for(var Te=me.length;oe!==se;)me.splice(Te,0,oe),oe=oe.parent;return me},ancestors:function(){for(var oe=this,de=[oe];oe=oe.parent;)de.push(oe);return de},descendants:function(){var oe=[];return this.each(function(de){oe.push(de)}),oe},leaves:function(){var oe=[];return this.eachBefore(function(de){de.children||oe.push(de)}),oe},links:function(){var oe=this,de=[];return oe.each(function(se){se!==oe&&de.push({source:se.parent,target:se})}),de},copy:function(){return n(this).eachBefore(a)}};var o=Array.prototype.slice;function i(oe){for(var de,se,me=0,Te=(oe=function(be){for(var Ce,fe,ve=be.length;ve;)fe=Math.random()*ve--|0,Ce=be[ve],be[ve]=be[fe],be[fe]=Ce;return be}(o.call(oe))).length,_e=[];me<Te;)de=oe[me],se&&l(se,de)?++me:(se=d(_e=u(_e,de)),me=0);return se}function u(oe,de){var se,me;if(h(de,oe))return[de];for(se=0;se<oe.length;++se)if(f(de,oe[se])&&h(s(oe[se],de),oe))return[oe[se],de];for(se=0;se<oe.length-1;++se)for(me=se+1;me<oe.length;++me)if(f(s(oe[se],oe[me]),de)&&f(s(oe[se],de),oe[me])&&f(s(oe[me],de),oe[se])&&h(x(oe[se],oe[me],de),oe))return[oe[se],oe[me],de];throw new Error}function f(oe,de){var se=oe.r-de.r,me=de.x-oe.x,Te=de.y-oe.y;return se<0||se*se<me*me+Te*Te}function l(oe,de){var se=oe.r-de.r+1e-6,me=de.x-oe.x,Te=de.y-oe.y;return se>0&&se*se>me*me+Te*Te}function h(oe,de){for(var se=0;se<de.length;++se)if(!l(oe,de[se]))return!1;return!0}function d(oe){switch(oe.length){case 1:return{x:(de=oe[0]).x,y:de.y,r:de.r};case 2:return s(oe[0],oe[1]);case 3:return x(oe[0],oe[1],oe[2])}var de}function s(oe,de){var se=oe.x,me=oe.y,Te=oe.r,_e=de.x,be=de.y,Ce=de.r,fe=_e-se,ve=be-me,Me=Ce-Te,ke=Math.sqrt(fe*fe+ve*ve);return{x:(se+_e+fe/ke*Me)/2,y:(me+be+ve/ke*Me)/2,r:(ke+Te+Ce)/2}}function x(oe,de,se){var me=oe.x,Te=oe.y,_e=oe.r,be=de.x,Ce=de.y,fe=de.r,ve=se.x,Me=se.y,ke=se.r,Le=me-be,ze=me-ve,Re=Te-Ce,Oe=Te-Me,Ze=fe-_e,Pe=ke-_e,Ie=me*me+Te*Te-_e*_e,Be=Ie-be*be-Ce*Ce+fe*fe,Fe=Ie-ve*ve-Me*Me+ke*ke,$e=ze*Re-Le*Oe,ot=(Re*Fe-Oe*Be)/(2*$e)-me,pt=(Oe*Ze-Re*Pe)/$e,_t=(ze*Be-Le*Fe)/(2*$e)-Te,yt=(Le*Pe-ze*Ze)/$e,tt=pt*pt+yt*yt-1,Ke=2*(_e+ot*pt+_t*yt),vt=ot*ot+_t*_t-_e*_e,Nt=-(tt?(Ke+Math.sqrt(Ke*Ke-4*tt*vt))/(2*tt):vt/Ke);return{x:me+ot+pt*Nt,y:Te+_t+yt*Nt,r:Nt}}function c(oe,de,se){var me,Te,_e,be,Ce=oe.x-de.x,fe=oe.y-de.y,ve=Ce*Ce+fe*fe;ve?(Te=de.r+se.r,Te*=Te,be=oe.r+se.r,Te>(be*=be)?(me=(ve+be-Te)/(2*ve),_e=Math.sqrt(Math.max(0,be/ve-me*me)),se.x=oe.x-me*Ce-_e*fe,se.y=oe.y-me*fe+_e*Ce):(me=(ve+Te-be)/(2*ve),_e=Math.sqrt(Math.max(0,Te/ve-me*me)),se.x=de.x+me*Ce-_e*fe,se.y=de.y+me*fe+_e*Ce)):(se.x=de.x+se.r,se.y=de.y)}function T(oe,de){var se=oe.r+de.r-1e-6,me=de.x-oe.x,Te=de.y-oe.y;return se>0&&se*se>me*me+Te*Te}function _(oe){var de=oe._,se=oe.next._,me=de.r+se.r,Te=(de.x*se.r+se.x*de.r)/me,_e=(de.y*se.r+se.y*de.r)/me;return Te*Te+_e*_e}function w(oe){this._=oe,this.next=null,this.previous=null}function k(oe){if(!(Te=oe.length))return 0;var de,se,me,Te,_e,be,Ce,fe,ve,Me,ke;if((de=oe[0]).x=0,de.y=0,!(Te>1))return de.r;if(se=oe[1],de.x=-se.r,se.x=de.r,se.y=0,!(Te>2))return de.r+se.r;c(se,de,me=oe[2]),de=new w(de),se=new w(se),me=new w(me),de.next=me.previous=se,se.next=de.previous=me,me.next=se.previous=de;e:for(Ce=3;Ce<Te;++Ce){c(de._,se._,me=oe[Ce]),me=new w(me),fe=se.next,ve=de.previous,Me=se._.r,ke=de._.r;do if(Me<=ke){if(T(fe._,me._)){se=fe,de.next=se,se.previous=de,--Ce;continue e}Me+=fe._.r,fe=fe.next}else{if(T(ve._,me._)){(de=ve).next=se,se.previous=de,--Ce;continue e}ke+=ve._.r,ve=ve.previous}while(fe!==ve.next);for(me.previous=de,me.next=se,de.next=se.previous=se=me,_e=_(de);(me=me.next)!==se;)(be=_(me))<_e&&(de=me,_e=be);se=de.next}for(de=[se._],me=se;(me=me.next)!==se;)de.push(me._);for(me=i(de),Ce=0;Ce<Te;++Ce)(de=oe[Ce]).x-=me.x,de.y-=me.y;return me.r}function L(oe){return oe==null?null:A(oe)}function A(oe){if(typeof oe!="function")throw new Error;return oe}function I(){return 0}function P(oe){return function(){return oe}}function S(oe){return Math.sqrt(oe.value)}function E(oe){return function(de){de.children||(de.r=Math.max(0,+oe(de)||0))}}function D(oe,de){return function(se){if(me=se.children){var me,Te,_e,be=me.length,Ce=oe(se)*de||0;if(Ce)for(Te=0;Te<be;++Te)me[Te].r+=Ce;if(_e=k(me),Ce)for(Te=0;Te<be;++Te)me[Te].r-=Ce;se.r=_e+Ce}}}function R(oe){return function(de){var se=de.parent;de.r*=oe,se&&(de.x=se.x+oe*de.x,de.y=se.y+oe*de.y)}}function H(oe){oe.x0=Math.round(oe.x0),oe.y0=Math.round(oe.y0),oe.x1=Math.round(oe.x1),oe.y1=Math.round(oe.y1)}function V(oe,de,se,me,Te){for(var _e,be=oe.children,Ce=-1,fe=be.length,ve=oe.value&&(me-de)/oe.value;++Ce<fe;)(_e=be[Ce]).y0=se,_e.y1=Te,_e.x0=de,_e.x1=de+=_e.value*ve}var X={depth:-1},$={};function G(oe){return oe.id}function W(oe){return oe.parentId}function te(oe,de){return oe.parent===de.parent?1:2}function N(oe){var de=oe.children;return de?de[0]:oe.t}function B(oe){var de=oe.children;return de?de[de.length-1]:oe.t}function U(oe,de,se){var me=se/(de.i-oe.i);de.c-=me,de.s+=se,oe.c+=me,de.z+=se,de.m+=se}function ee(oe,de,se){return oe.a.parent===de.parent?oe.a:se}function j(oe,de){this._=oe,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=de}function Q(oe,de,se,me,Te){for(var _e,be=oe.children,Ce=-1,fe=be.length,ve=oe.value&&(Te-se)/oe.value;++Ce<fe;)(_e=be[Ce]).x0=de,_e.x1=me,_e.y0=se,_e.y1=se+=_e.value*ve}j.prototype=Object.create(m.prototype);var K=(1+Math.sqrt(5))/2;function re(oe,de,se,me,Te,_e){for(var be,Ce,fe,ve,Me,ke,Le,ze,Re,Oe,Ze,Pe=[],Ie=de.children,Be=0,Fe=0,$e=Ie.length,ot=de.value;Be<$e;){fe=Te-se,ve=_e-me;do Me=Ie[Fe++].value;while(!Me&&Fe<$e);for(ke=Le=Me,Ze=Me*Me*(Oe=Math.max(ve/fe,fe/ve)/(ot*oe)),Re=Math.max(Le/Ze,Ze/ke);Fe<$e;++Fe){if(Me+=Ce=Ie[Fe].value,Ce<ke&&(ke=Ce),Ce>Le&&(Le=Ce),Ze=Me*Me*Oe,(ze=Math.max(Le/Ze,Ze/ke))>Re){Me-=Ce;break}Re=ze}Pe.push(be={value:Me,dice:fe<ve,children:Ie.slice(Be,Fe)}),be.dice?V(be,se,me,Te,ot?me+=ve*Me/ot:_e):Q(be,se,me,ot?se+=fe*Me/ot:Te,_e),ot-=Me,Be=Fe}return Pe}var ne=function oe(de){function se(me,Te,_e,be,Ce){re(de,me,Te,_e,be,Ce)}return se.ratio=function(me){return oe((me=+me)>1?me:1)},se}(K),le=function oe(de){function se(me,Te,_e,be,Ce){if((fe=me._squarify)&&fe.ratio===de)for(var fe,ve,Me,ke,Le,ze=-1,Re=fe.length,Oe=me.value;++ze<Re;){for(Me=(ve=fe[ze]).children,ke=ve.value=0,Le=Me.length;ke<Le;++ke)ve.value+=Me[ke].value;ve.dice?V(ve,Te,_e,be,_e+=(Ce-_e)*ve.value/Oe):Q(ve,Te,_e,Te+=(be-Te)*ve.value/Oe,Ce),Oe-=ve.value}else me._squarify=fe=re(de,me,Te,_e,be,Ce),fe.ratio=de}return se.ratio=function(me){return oe((me=+me)>1?me:1)},se}(K);p.cluster=function(){var oe=g,de=1,se=1,me=!1;function Te(_e){var be,Ce=0;_e.eachAfter(function(Le){var ze=Le.children;ze?(Le.x=function(Re){return Re.reduce(b,0)/Re.length}(ze),Le.y=function(Re){return 1+Re.reduce(y,0)}(ze)):(Le.x=be?Ce+=oe(Le,be):0,Le.y=0,be=Le)});var fe=function(Le){for(var ze;ze=Le.children;)Le=ze[0];return Le}(_e),ve=function(Le){for(var ze;ze=Le.children;)Le=ze[ze.length-1];return Le}(_e),Me=fe.x-oe(fe,ve)/2,ke=ve.x+oe(ve,fe)/2;return _e.eachAfter(me?function(Le){Le.x=(Le.x-_e.x)*de,Le.y=(_e.y-Le.y)*se}:function(Le){Le.x=(Le.x-Me)/(ke-Me)*de,Le.y=(1-(_e.y?Le.y/_e.y:1))*se})}return Te.separation=function(_e){return arguments.length?(oe=_e,Te):oe},Te.size=function(_e){return arguments.length?(me=!1,de=+_e[0],se=+_e[1],Te):me?null:[de,se]},Te.nodeSize=function(_e){return arguments.length?(me=!0,de=+_e[0],se=+_e[1],Te):me?[de,se]:null},Te},p.hierarchy=n,p.pack=function(){var oe=null,de=1,se=1,me=I;function Te(_e){return _e.x=de/2,_e.y=se/2,oe?_e.eachBefore(E(oe)).eachAfter(D(me,.5)).eachBefore(R(1)):_e.eachBefore(E(S)).eachAfter(D(I,1)).eachAfter(D(me,_e.r/Math.min(de,se))).eachBefore(R(Math.min(de,se)/(2*_e.r))),_e}return Te.radius=function(_e){return arguments.length?(oe=L(_e),Te):oe},Te.size=function(_e){return arguments.length?(de=+_e[0],se=+_e[1],Te):[de,se]},Te.padding=function(_e){return arguments.length?(me=typeof _e=="function"?_e:P(+_e),Te):me},Te},p.packEnclose=i,p.packSiblings=function(oe){return k(oe),oe},p.partition=function(){var oe=1,de=1,se=0,me=!1;function Te(_e){var be=_e.height+1;return _e.x0=_e.y0=se,_e.x1=oe,_e.y1=de/be,_e.eachBefore(function(Ce,fe){return function(ve){ve.children&&V(ve,ve.x0,Ce*(ve.depth+1)/fe,ve.x1,Ce*(ve.depth+2)/fe);var Me=ve.x0,ke=ve.y0,Le=ve.x1-se,ze=ve.y1-se;Le<Me&&(Me=Le=(Me+Le)/2),ze<ke&&(ke=ze=(ke+ze)/2),ve.x0=Me,ve.y0=ke,ve.x1=Le,ve.y1=ze}}(de,be)),me&&_e.eachBefore(H),_e}return Te.round=function(_e){return arguments.length?(me=!!_e,Te):me},Te.size=function(_e){return arguments.length?(oe=+_e[0],de=+_e[1],Te):[oe,de]},Te.padding=function(_e){return arguments.length?(se=+_e,Te):se},Te},p.stratify=function(){var oe=G,de=W;function se(me){var Te,_e,be,Ce,fe,ve,Me,ke=me.length,Le=new Array(ke),ze={};for(_e=0;_e<ke;++_e)Te=me[_e],fe=Le[_e]=new m(Te),(ve=oe(Te,_e,me))!=null&&(ve+="")&&(ze[Me="$"+(fe.id=ve)]=Me in ze?$:fe);for(_e=0;_e<ke;++_e)if(fe=Le[_e],(ve=de(me[_e],_e,me))!=null&&(ve+="")){if(!(Ce=ze["$"+ve]))throw new Error("missing: "+ve);if(Ce===$)throw new Error("ambiguous: "+ve);Ce.children?Ce.children.push(fe):Ce.children=[fe],fe.parent=Ce}else{if(be)throw new Error("multiple roots");be=fe}if(!be)throw new Error("no root");if(be.parent=X,be.eachBefore(function(Re){Re.depth=Re.parent.depth+1,--ke}).eachBefore(r),be.parent=null,ke>0)throw new Error("cycle");return be}return se.id=function(me){return arguments.length?(oe=A(me),se):oe},se.parentId=function(me){return arguments.length?(de=A(me),se):de},se},p.tree=function(){var oe=te,de=1,se=1,me=null;function Te(fe){var ve=function(Pe){for(var Ie,Be,Fe,$e,ot,pt=new j(Pe,0),_t=[pt];Ie=_t.pop();)if(Fe=Ie._.children)for(Ie.children=new Array(ot=Fe.length),$e=ot-1;$e>=0;--$e)_t.push(Be=Ie.children[$e]=new j(Fe[$e],$e)),Be.parent=Ie;return(pt.parent=new j(null,0)).children=[pt],pt}(fe);if(ve.eachAfter(_e),ve.parent.m=-ve.z,ve.eachBefore(be),me)fe.eachBefore(Ce);else{var Me=fe,ke=fe,Le=fe;fe.eachBefore(function(Pe){Pe.x<Me.x&&(Me=Pe),Pe.x>ke.x&&(ke=Pe),Pe.depth>Le.depth&&(Le=Pe)});var ze=Me===ke?1:oe(Me,ke)/2,Re=ze-Me.x,Oe=de/(ke.x+ze+Re),Ze=se/(Le.depth||1);fe.eachBefore(function(Pe){Pe.x=(Pe.x+Re)*Oe,Pe.y=Pe.depth*Ze})}return fe}function _e(fe){var ve=fe.children,Me=fe.parent.children,ke=fe.i?Me[fe.i-1]:null;if(ve){(function(ze){for(var Re,Oe=0,Ze=0,Pe=ze.children,Ie=Pe.length;--Ie>=0;)(Re=Pe[Ie]).z+=Oe,Re.m+=Oe,Oe+=Re.s+(Ze+=Re.c)})(fe);var Le=(ve[0].z+ve[ve.length-1].z)/2;ke?(fe.z=ke.z+oe(fe._,ke._),fe.m=fe.z-Le):fe.z=Le}else ke&&(fe.z=ke.z+oe(fe._,ke._));fe.parent.A=function(ze,Re,Oe){if(Re){for(var Ze,Pe=ze,Ie=ze,Be=Re,Fe=Pe.parent.children[0],$e=Pe.m,ot=Ie.m,pt=Be.m,_t=Fe.m;Be=B(Be),Pe=N(Pe),Be&&Pe;)Fe=N(Fe),(Ie=B(Ie)).a=ze,(Ze=Be.z+pt-Pe.z-$e+oe(Be._,Pe._))>0&&(U(ee(Be,ze,Oe),ze,Ze),$e+=Ze,ot+=Ze),pt+=Be.m,$e+=Pe.m,_t+=Fe.m,ot+=Ie.m;Be&&!B(Ie)&&(Ie.t=Be,Ie.m+=pt-ot),Pe&&!N(Fe)&&(Fe.t=Pe,Fe.m+=$e-_t,Oe=ze)}return Oe}(fe,ke,fe.parent.A||Me[0])}function be(fe){fe._.x=fe.z+fe.parent.m,fe.m+=fe.parent.m}function Ce(fe){fe.x*=de,fe.y=fe.depth*se}return Te.separation=function(fe){return arguments.length?(oe=fe,Te):oe},Te.size=function(fe){return arguments.length?(me=!1,de=+fe[0],se=+fe[1],Te):me?null:[de,se]},Te.nodeSize=function(fe){return arguments.length?(me=!0,de=+fe[0],se=+fe[1],Te):me?[de,se]:null},Te},p.treemap=function(){var oe=ne,de=!1,se=1,me=1,Te=[0],_e=I,be=I,Ce=I,fe=I,ve=I;function Me(Le){return Le.x0=Le.y0=0,Le.x1=se,Le.y1=me,Le.eachBefore(ke),Te=[0],de&&Le.eachBefore(H),Le}function ke(Le){var ze=Te[Le.depth],Re=Le.x0+ze,Oe=Le.y0+ze,Ze=Le.x1-ze,Pe=Le.y1-ze;Ze<Re&&(Re=Ze=(Re+Ze)/2),Pe<Oe&&(Oe=Pe=(Oe+Pe)/2),Le.x0=Re,Le.y0=Oe,Le.x1=Ze,Le.y1=Pe,Le.children&&(ze=Te[Le.depth+1]=_e(Le)/2,Re+=ve(Le)-ze,Oe+=be(Le)-ze,(Ze-=Ce(Le)-ze)<Re&&(Re=Ze=(Re+Ze)/2),(Pe-=fe(Le)-ze)<Oe&&(Oe=Pe=(Oe+Pe)/2),oe(Le,Re,Oe,Ze,Pe))}return Me.round=function(Le){return arguments.length?(de=!!Le,Me):de},Me.size=function(Le){return arguments.length?(se=+Le[0],me=+Le[1],Me):[se,me]},Me.tile=function(Le){return arguments.length?(oe=A(Le),Me):oe},Me.padding=function(Le){return arguments.length?Me.paddingInner(Le).paddingOuter(Le):Me.paddingInner()},Me.paddingInner=function(Le){return arguments.length?(_e=typeof Le=="function"?Le:P(+Le),Me):_e},Me.paddingOuter=function(Le){return arguments.length?Me.paddingTop(Le).paddingRight(Le).paddingBottom(Le).paddingLeft(Le):Me.paddingTop()},Me.paddingTop=function(Le){return arguments.length?(be=typeof Le=="function"?Le:P(+Le),Me):be},Me.paddingRight=function(Le){return arguments.length?(Ce=typeof Le=="function"?Le:P(+Le),Me):Ce},Me.paddingBottom=function(Le){return arguments.length?(fe=typeof Le=="function"?Le:P(+Le),Me):fe},Me.paddingLeft=function(Le){return arguments.length?(ve=typeof Le=="function"?Le:P(+Le),Me):ve},Me},p.treemapBinary=function(oe,de,se,me,Te){var _e,be,Ce=oe.children,fe=Ce.length,ve=new Array(fe+1);for(ve[0]=be=_e=0;_e<fe;++_e)ve[_e+1]=be+=Ce[_e].value;(function Me(ke,Le,ze,Re,Oe,Ze,Pe){if(ke>=Le-1){var Ie=Ce[ke];return Ie.x0=Re,Ie.y0=Oe,Ie.x1=Ze,void(Ie.y1=Pe)}for(var Be=ve[ke],Fe=ze/2+Be,$e=ke+1,ot=Le-1;$e<ot;){var pt=$e+ot>>>1;ve[pt]<Fe?$e=pt+1:ot=pt}Fe-ve[$e-1]<ve[$e]-Fe&&ke+1<$e&&--$e;var _t=ve[$e]-Be,yt=ze-_t;if(Ze-Re>Pe-Oe){var tt=(Re*yt+Ze*_t)/ze;Me(ke,$e,_t,Re,Oe,tt,Pe),Me($e,Le,yt,tt,Oe,Ze,Pe)}else{var Ke=(Oe*yt+Pe*_t)/ze;Me(ke,$e,_t,Re,Oe,Ze,Ke),Me($e,Le,yt,Re,Ke,Ze,Pe)}})(0,fe,oe.value,de,se,me,Te)},p.treemapDice=V,p.treemapResquarify=le,p.treemapSlice=Q,p.treemapSliceDice=function(oe,de,se,me,Te){(1&oe.depth?Q:V)(oe,de,se,me,Te)},p.treemapSquarify=ne,Object.defineProperty(p,"__esModule",{value:!0})})},{}],116:[function(v,J,Z){(function(p,g){typeof Z=="object"&&J!==void 0?g(Z,v("d3-color")):g((p=p||self).d3=p.d3||{},p.d3)})(this,function(p,g){function b(K,re,ne,le,oe){var de=K*K,se=de*K;return((1-3*K+3*de-se)*re+(4-6*de+3*se)*ne+(1+3*K+3*de-3*se)*le+se*oe)/6}function y(K){var re=K.length-1;return function(ne){var le=ne<=0?ne=0:ne>=1?(ne=1,re-1):Math.floor(ne*re),oe=K[le],de=K[le+1],se=le>0?K[le-1]:2*oe-de,me=le<re-1?K[le+2]:2*de-oe;return b((ne-le/re)*re,se,oe,de,me)}}function e(K){var re=K.length;return function(ne){var le=Math.floor(((ne%=1)<0?++ne:ne)*re),oe=K[(le+re-1)%re],de=K[le%re],se=K[(le+1)%re],me=K[(le+2)%re];return b((ne-le/re)*re,oe,de,se,me)}}function n(K){return function(){return K}}function t(K,re){return function(ne){return K+ne*re}}function a(K,re){var ne=re-K;return ne?t(K,ne>180||ne<-180?ne-360*Math.round(ne/360):ne):n(isNaN(K)?re:K)}function r(K){return(K=+K)==1?m:function(re,ne){return ne-re?function(le,oe,de){return le=Math.pow(le,de),oe=Math.pow(oe,de)-le,de=1/de,function(se){return Math.pow(le+se*oe,de)}}(re,ne,K):n(isNaN(re)?ne:re)}}function m(K,re){var ne=re-K;return ne?t(K,ne):n(isNaN(K)?re:K)}var o=function K(re){var ne=r(re);function le(oe,de){var se=ne((oe=g.rgb(oe)).r,(de=g.rgb(de)).r),me=ne(oe.g,de.g),Te=ne(oe.b,de.b),_e=m(oe.opacity,de.opacity);return function(be){return oe.r=se(be),oe.g=me(be),oe.b=Te(be),oe.opacity=_e(be),oe+""}}return le.gamma=K,le}(1);function i(K){return function(re){var ne,le,oe=re.length,de=new Array(oe),se=new Array(oe),me=new Array(oe);for(ne=0;ne<oe;++ne)le=g.rgb(re[ne]),de[ne]=le.r||0,se[ne]=le.g||0,me[ne]=le.b||0;return de=K(de),se=K(se),me=K(me),le.opacity=1,function(Te){return le.r=de(Te),le.g=se(Te),le.b=me(Te),le+""}}}var u=i(y),f=i(e);function l(K,re){re||(re=[]);var ne,le=K?Math.min(re.length,K.length):0,oe=re.slice();return function(de){for(ne=0;ne<le;++ne)oe[ne]=K[ne]*(1-de)+re[ne]*de;return oe}}function h(K){return ArrayBuffer.isView(K)&&!(K instanceof DataView)}function d(K,re){var ne,le=re?re.length:0,oe=K?Math.min(le,K.length):0,de=new Array(oe),se=new Array(le);for(ne=0;ne<oe;++ne)de[ne]=k(K[ne],re[ne]);for(;ne<le;++ne)se[ne]=re[ne];return function(me){for(ne=0;ne<oe;++ne)se[ne]=de[ne](me);return se}}function s(K,re){var ne=new Date;return K=+K,re=+re,function(le){return ne.setTime(K*(1-le)+re*le),ne}}function x(K,re){return K=+K,re=+re,function(ne){return K*(1-ne)+re*ne}}function c(K,re){var ne,le={},oe={};for(ne in K!==null&&typeof K=="object"||(K={}),re!==null&&typeof re=="object"||(re={}),re)ne in K?le[ne]=k(K[ne],re[ne]):oe[ne]=re[ne];return function(de){for(ne in le)oe[ne]=le[ne](de);return oe}}var T=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_=new RegExp(T.source,"g");function w(K,re){var ne,le,oe,de=T.lastIndex=_.lastIndex=0,se=-1,me=[],Te=[];for(K+="",re+="";(ne=T.exec(K))&&(le=_.exec(re));)(oe=le.index)>de&&(oe=re.slice(de,oe),me[se]?me[se]+=oe:me[++se]=oe),(ne=ne[0])===(le=le[0])?me[se]?me[se]+=le:me[++se]=le:(me[++se]=null,Te.push({i:se,x:x(ne,le)})),de=_.lastIndex;return de<re.length&&(oe=re.slice(de),me[se]?me[se]+=oe:me[++se]=oe),me.length<2?Te[0]?function(_e){return function(be){return _e(be)+""}}(Te[0].x):function(_e){return function(){return _e}}(re):(re=Te.length,function(_e){for(var be,Ce=0;Ce<re;++Ce)me[(be=Te[Ce]).i]=be.x(_e);return me.join("")})}function k(K,re){var ne,le=typeof re;return re==null||le==="boolean"?n(re):(le==="number"?x:le==="string"?(ne=g.color(re))?(re=ne,o):w:re instanceof g.color?o:re instanceof Date?s:h(re)?l:Array.isArray(re)?d:typeof re.valueOf!="function"&&typeof re.toString!="function"||isNaN(re)?c:x)(K,re)}var L,A,I,P,S=180/Math.PI,E={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function D(K,re,ne,le,oe,de){var se,me,Te;return(se=Math.sqrt(K*K+re*re))&&(K/=se,re/=se),(Te=K*ne+re*le)&&(ne-=K*Te,le-=re*Te),(me=Math.sqrt(ne*ne+le*le))&&(ne/=me,le/=me,Te/=me),K*le<re*ne&&(K=-K,re=-re,Te=-Te,se=-se),{translateX:oe,translateY:de,rotate:Math.atan2(re,K)*S,skewX:Math.atan(Te)*S,scaleX:se,scaleY:me}}function R(K,re,ne,le){function oe(de){return de.length?de.pop()+" ":""}return function(de,se){var me=[],Te=[];return de=K(de),se=K(se),function(_e,be,Ce,fe,ve,Me){if(_e!==Ce||be!==fe){var ke=ve.push("translate(",null,re,null,ne);Me.push({i:ke-4,x:x(_e,Ce)},{i:ke-2,x:x(be,fe)})}else(Ce||fe)&&ve.push("translate("+Ce+re+fe+ne)}(de.translateX,de.translateY,se.translateX,se.translateY,me,Te),function(_e,be,Ce,fe){_e!==be?(_e-be>180?be+=360:be-_e>180&&(_e+=360),fe.push({i:Ce.push(oe(Ce)+"rotate(",null,le)-2,x:x(_e,be)})):be&&Ce.push(oe(Ce)+"rotate("+be+le)}(de.rotate,se.rotate,me,Te),function(_e,be,Ce,fe){_e!==be?fe.push({i:Ce.push(oe(Ce)+"skewX(",null,le)-2,x:x(_e,be)}):be&&Ce.push(oe(Ce)+"skewX("+be+le)}(de.skewX,se.skewX,me,Te),function(_e,be,Ce,fe,ve,Me){if(_e!==Ce||be!==fe){var ke=ve.push(oe(ve)+"scale(",null,",",null,")");Me.push({i:ke-4,x:x(_e,Ce)},{i:ke-2,x:x(be,fe)})}else Ce===1&&fe===1||ve.push(oe(ve)+"scale("+Ce+","+fe+")")}(de.scaleX,de.scaleY,se.scaleX,se.scaleY,me,Te),de=se=null,function(_e){for(var be,Ce=-1,fe=Te.length;++Ce<fe;)me[(be=Te[Ce]).i]=be.x(_e);return me.join("")}}}var H=R(function(K){return K==="none"?E:(L||(L=document.createElement("DIV"),A=document.documentElement,I=document.defaultView),L.style.transform=K,K=I.getComputedStyle(A.appendChild(L),null).getPropertyValue("transform"),A.removeChild(L),D(+(K=K.slice(7,-1).split(","))[0],+K[1],+K[2],+K[3],+K[4],+K[5]))},"px, ","px)","deg)"),V=R(function(K){return K==null?E:(P||(P=document.createElementNS("http://www.w3.org/2000/svg","g")),P.setAttribute("transform",K),(K=P.transform.baseVal.consolidate())?D((K=K.matrix).a,K.b,K.c,K.d,K.e,K.f):E)},", ",")",")"),X=Math.SQRT2;function $(K){return((K=Math.exp(K))+1/K)/2}function G(K){return function(re,ne){var le=K((re=g.hsl(re)).h,(ne=g.hsl(ne)).h),oe=m(re.s,ne.s),de=m(re.l,ne.l),se=m(re.opacity,ne.opacity);return function(me){return re.h=le(me),re.s=oe(me),re.l=de(me),re.opacity=se(me),re+""}}}var W=G(a),te=G(m);function N(K){return function(re,ne){var le=K((re=g.hcl(re)).h,(ne=g.hcl(ne)).h),oe=m(re.c,ne.c),de=m(re.l,ne.l),se=m(re.opacity,ne.opacity);return function(me){return re.h=le(me),re.c=oe(me),re.l=de(me),re.opacity=se(me),re+""}}}var B=N(a),U=N(m);function ee(K){return function re(ne){function le(oe,de){var se=K((oe=g.cubehelix(oe)).h,(de=g.cubehelix(de)).h),me=m(oe.s,de.s),Te=m(oe.l,de.l),_e=m(oe.opacity,de.opacity);return function(be){return oe.h=se(be),oe.s=me(be),oe.l=Te(Math.pow(be,ne)),oe.opacity=_e(be),oe+""}}return ne=+ne,le.gamma=re,le}(1)}var j=ee(a),Q=ee(m);p.interpolate=k,p.interpolateArray=function(K,re){return(h(re)?l:d)(K,re)},p.interpolateBasis=y,p.interpolateBasisClosed=e,p.interpolateCubehelix=j,p.interpolateCubehelixLong=Q,p.interpolateDate=s,p.interpolateDiscrete=function(K){var re=K.length;return function(ne){return K[Math.max(0,Math.min(re-1,Math.floor(ne*re)))]}},p.interpolateHcl=B,p.interpolateHclLong=U,p.interpolateHsl=W,p.interpolateHslLong=te,p.interpolateHue=function(K,re){var ne=a(+K,+re);return function(le){var oe=ne(le);return oe-360*Math.floor(oe/360)}},p.interpolateLab=function(K,re){var ne=m((K=g.lab(K)).l,(re=g.lab(re)).l),le=m(K.a,re.a),oe=m(K.b,re.b),de=m(K.opacity,re.opacity);return function(se){return K.l=ne(se),K.a=le(se),K.b=oe(se),K.opacity=de(se),K+""}},p.interpolateNumber=x,p.interpolateNumberArray=l,p.interpolateObject=c,p.interpolateRgb=o,p.interpolateRgbBasis=u,p.interpolateRgbBasisClosed=f,p.interpolateRound=function(K,re){return K=+K,re=+re,function(ne){return Math.round(K*(1-ne)+re*ne)}},p.interpolateString=w,p.interpolateTransformCss=H,p.interpolateTransformSvg=V,p.interpolateZoom=function(K,re){var ne,le,oe=K[0],de=K[1],se=K[2],me=re[0],Te=re[1],_e=re[2],be=me-oe,Ce=Te-de,fe=be*be+Ce*Ce;if(fe<1e-12)le=Math.log(_e/se)/X,ne=function(Re){return[oe+Re*be,de+Re*Ce,se*Math.exp(X*Re*le)]};else{var ve=Math.sqrt(fe),Me=(_e*_e-se*se+4*fe)/(2*se*2*ve),ke=(_e*_e-se*se-4*fe)/(2*_e*2*ve),Le=Math.log(Math.sqrt(Me*Me+1)-Me),ze=Math.log(Math.sqrt(ke*ke+1)-ke);le=(ze-Le)/X,ne=function(Re){var Oe,Ze=Re*le,Pe=$(Le),Ie=se/(2*ve)*(Pe*(Oe=X*Ze+Le,((Oe=Math.exp(2*Oe))-1)/(Oe+1))-function(Be){return((Be=Math.exp(Be))-1/Be)/2}(Le));return[oe+Ie*be,de+Ie*Ce,se*Pe/$(X*Ze+Le)]}}return ne.duration=1e3*le,ne},p.piecewise=function(K,re){for(var ne=0,le=re.length-1,oe=re[0],de=new Array(le<0?0:le);ne<le;)de[ne]=K(oe,oe=re[++ne]);return function(se){var me=Math.max(0,Math.min(le-1,Math.floor(se*=le)));return de[me](se-me)}},p.quantize=function(K,re){for(var ne=new Array(re),le=0;le<re;++le)ne[le]=K(le/(re-1));return ne},Object.defineProperty(p,"__esModule",{value:!0})})},{"d3-color":109}],117:[function(v,J,Z){(function(p,g){g(typeof Z=="object"&&J!==void 0?Z:(p=p||self).d3=p.d3||{})})(this,function(p){var g=Math.PI,b=2*g,y=b-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function n(){return new e}e.prototype=n.prototype={constructor:e,moveTo:function(t,a){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+a)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,a){this._+="L"+(this._x1=+t)+","+(this._y1=+a)},quadraticCurveTo:function(t,a,r,m){this._+="Q"+ +t+","+ +a+","+(this._x1=+r)+","+(this._y1=+m)},bezierCurveTo:function(t,a,r,m,o,i){this._+="C"+ +t+","+ +a+","+ +r+","+ +m+","+(this._x1=+o)+","+(this._y1=+i)},arcTo:function(t,a,r,m,o){t=+t,a=+a,r=+r,m=+m,o=+o;var i=this._x1,u=this._y1,f=r-t,l=m-a,h=i-t,d=u-a,s=h*h+d*d;if(o<0)throw new Error("negative radius: "+o);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=a);else if(s>1e-6)if(Math.abs(d*f-l*h)>1e-6&&o){var x=r-i,c=m-u,T=f*f+l*l,_=x*x+c*c,w=Math.sqrt(T),k=Math.sqrt(s),L=o*Math.tan((g-Math.acos((T+s-_)/(2*w*k)))/2),A=L/k,I=L/w;Math.abs(A-1)>1e-6&&(this._+="L"+(t+A*h)+","+(a+A*d)),this._+="A"+o+","+o+",0,0,"+ +(d*x>h*c)+","+(this._x1=t+I*f)+","+(this._y1=a+I*l)}else this._+="L"+(this._x1=t)+","+(this._y1=a)},arc:function(t,a,r,m,o,i){t=+t,a=+a,i=!!i;var u=(r=+r)*Math.cos(m),f=r*Math.sin(m),l=t+u,h=a+f,d=1^i,s=i?m-o:o-m;if(r<0)throw new Error("negative radius: "+r);this._x1===null?this._+="M"+l+","+h:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-h)>1e-6)&&(this._+="L"+l+","+h),r&&(s<0&&(s=s%b+b),s>y?this._+="A"+r+","+r+",0,1,"+d+","+(t-u)+","+(a-f)+"A"+r+","+r+",0,1,"+d+","+(this._x1=l)+","+(this._y1=h):s>1e-6&&(this._+="A"+r+","+r+",0,"+ +(s>=g)+","+d+","+(this._x1=t+r*Math.cos(o))+","+(this._y1=a+r*Math.sin(o))))},rect:function(t,a,r,m){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+a)+"h"+ +r+"v"+ +m+"h"+-r+"Z"},toString:function(){return this._}},p.path=n,Object.defineProperty(p,"__esModule",{value:!0})})},{}],118:[function(v,J,Z){(function(p,g){g(typeof Z=="object"&&J!==void 0?Z:(p=p||self).d3=p.d3||{})})(this,function(p){function g(m,o,i,u){if(isNaN(o)||isNaN(i))return m;var f,l,h,d,s,x,c,T,_,w=m._root,k={data:u},L=m._x0,A=m._y0,I=m._x1,P=m._y1;if(!w)return m._root=k,m;for(;w.length;)if((x=o>=(l=(L+I)/2))?L=l:I=l,(c=i>=(h=(A+P)/2))?A=h:P=h,f=w,!(w=w[T=c<<1|x]))return f[T]=k,m;if(d=+m._x.call(null,w.data),s=+m._y.call(null,w.data),o===d&&i===s)return k.next=w,f?f[T]=k:m._root=k,m;do f=f?f[T]=new Array(4):m._root=new Array(4),(x=o>=(l=(L+I)/2))?L=l:I=l,(c=i>=(h=(A+P)/2))?A=h:P=h;while((T=c<<1|x)==(_=(s>=h)<<1|d>=l));return f[_]=w,f[T]=k,m}function b(m,o,i,u,f){this.node=m,this.x0=o,this.y0=i,this.x1=u,this.y1=f}function y(m){return m[0]}function e(m){return m[1]}function n(m,o,i){var u=new t(o==null?y:o,i==null?e:i,NaN,NaN,NaN,NaN);return m==null?u:u.addAll(m)}function t(m,o,i,u,f,l){this._x=m,this._y=o,this._x0=i,this._y0=u,this._x1=f,this._y1=l,this._root=void 0}function a(m){for(var o={data:m.data},i=o;m=m.next;)i=i.next={data:m.data};return o}var r=n.prototype=t.prototype;r.copy=function(){var m,o,i=new t(this._x,this._y,this._x0,this._y0,this._x1,this._y1),u=this._root;if(!u)return i;if(!u.length)return i._root=a(u),i;for(m=[{source:u,target:i._root=new Array(4)}];u=m.pop();)for(var f=0;f<4;++f)(o=u.source[f])&&(o.length?m.push({source:o,target:u.target[f]=new Array(4)}):u.target[f]=a(o));return i},r.add=function(m){var o=+this._x.call(null,m),i=+this._y.call(null,m);return g(this.cover(o,i),o,i,m)},r.addAll=function(m){var o,i,u,f,l=m.length,h=new Array(l),d=new Array(l),s=1/0,x=1/0,c=-1/0,T=-1/0;for(i=0;i<l;++i)isNaN(u=+this._x.call(null,o=m[i]))||isNaN(f=+this._y.call(null,o))||(h[i]=u,d[i]=f,u<s&&(s=u),u>c&&(c=u),f<x&&(x=f),f>T&&(T=f));if(s>c||x>T)return this;for(this.cover(s,x).cover(c,T),i=0;i<l;++i)g(this,h[i],d[i],m[i]);return this},r.cover=function(m,o){if(isNaN(m=+m)||isNaN(o=+o))return this;var i=this._x0,u=this._y0,f=this._x1,l=this._y1;if(isNaN(i))f=(i=Math.floor(m))+1,l=(u=Math.floor(o))+1;else{for(var h,d,s=f-i,x=this._root;i>m||m>=f||u>o||o>=l;)switch(d=(o<u)<<1|m<i,(h=new Array(4))[d]=x,x=h,s*=2,d){case 0:f=i+s,l=u+s;break;case 1:i=f-s,l=u+s;break;case 2:f=i+s,u=l-s;break;case 3:i=f-s,u=l-s}this._root&&this._root.length&&(this._root=x)}return this._x0=i,this._y0=u,this._x1=f,this._y1=l,this},r.data=function(){var m=[];return this.visit(function(o){if(!o.length)do m.push(o.data);while(o=o.next)}),m},r.extent=function(m){return arguments.length?this.cover(+m[0][0],+m[0][1]).cover(+m[1][0],+m[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},r.find=function(m,o,i){var u,f,l,h,d,s,x,c=this._x0,T=this._y0,_=this._x1,w=this._y1,k=[],L=this._root;for(L&&k.push(new b(L,c,T,_,w)),i==null?i=1/0:(c=m-i,T=o-i,_=m+i,w=o+i,i*=i);s=k.pop();)if(!(!(L=s.node)||(f=s.x0)>_||(l=s.y0)>w||(h=s.x1)<c||(d=s.y1)<T))if(L.length){var A=(f+h)/2,I=(l+d)/2;k.push(new b(L[3],A,I,h,d),new b(L[2],f,I,A,d),new b(L[1],A,l,h,I),new b(L[0],f,l,A,I)),(x=(o>=I)<<1|m>=A)&&(s=k[k.length-1],k[k.length-1]=k[k.length-1-x],k[k.length-1-x]=s)}else{var P=m-+this._x.call(null,L.data),S=o-+this._y.call(null,L.data),E=P*P+S*S;if(E<i){var D=Math.sqrt(i=E);c=m-D,T=o-D,_=m+D,w=o+D,u=L.data}}return u},r.remove=function(m){if(isNaN(l=+this._x.call(null,m))||isNaN(h=+this._y.call(null,m)))return this;var o,i,u,f,l,h,d,s,x,c,T,_,w=this._root,k=this._x0,L=this._y0,A=this._x1,I=this._y1;if(!w)return this;if(w.length)for(;;){if((x=l>=(d=(k+A)/2))?k=d:A=d,(c=h>=(s=(L+I)/2))?L=s:I=s,o=w,!(w=w[T=c<<1|x]))return this;if(!w.length)break;(o[T+1&3]||o[T+2&3]||o[T+3&3])&&(i=o,_=T)}for(;w.data!==m;)if(u=w,!(w=w.next))return this;return(f=w.next)&&delete w.next,u?(f?u.next=f:delete u.next,this):o?(f?o[T]=f:delete o[T],(w=o[0]||o[1]||o[2]||o[3])&&w===(o[3]||o[2]||o[1]||o[0])&&!w.length&&(i?i[_]=w:this._root=w),this):(this._root=f,this)},r.removeAll=function(m){for(var o=0,i=m.length;o<i;++o)this.remove(m[o]);return this},r.root=function(){return this._root},r.size=function(){var m=0;return this.visit(function(o){if(!o.length)do++m;while(o=o.next)}),m},r.visit=function(m){var o,i,u,f,l,h,d=[],s=this._root;for(s&&d.push(new b(s,this._x0,this._y0,this._x1,this._y1));o=d.pop();)if(!m(s=o.node,u=o.x0,f=o.y0,l=o.x1,h=o.y1)&&s.length){var x=(u+l)/2,c=(f+h)/2;(i=s[3])&&d.push(new b(i,x,c,l,h)),(i=s[2])&&d.push(new b(i,u,c,x,h)),(i=s[1])&&d.push(new b(i,x,f,l,c)),(i=s[0])&&d.push(new b(i,u,f,x,c))}return this},r.visitAfter=function(m){var o,i=[],u=[];for(this._root&&i.push(new b(this._root,this._x0,this._y0,this._x1,this._y1));o=i.pop();){var f=o.node;if(f.length){var l,h=o.x0,d=o.y0,s=o.x1,x=o.y1,c=(h+s)/2,T=(d+x)/2;(l=f[0])&&i.push(new b(l,h,d,c,T)),(l=f[1])&&i.push(new b(l,c,d,s,T)),(l=f[2])&&i.push(new b(l,h,T,c,x)),(l=f[3])&&i.push(new b(l,c,T,s,x))}u.push(o)}for(;o=u.pop();)m(o.node,o.x0,o.y0,o.x1,o.y1);return this},r.x=function(m){return arguments.length?(this._x=m,this):this._x},r.y=function(m){return arguments.length?(this._y=m,this):this._y},p.quadtree=n,Object.defineProperty(p,"__esModule",{value:!0})})},{}],119:[function(v,J,Z){(function(p,g){typeof Z=="object"&&J!==void 0?g(Z,v("d3-path")):g((p=p||self).d3=p.d3||{},p.d3)})(this,function(p,g){function b(Ae){return function(){return Ae}}var y=Math.abs,e=Math.atan2,n=Math.cos,t=Math.max,a=Math.min,r=Math.sin,m=Math.sqrt,o=Math.PI,i=o/2,u=2*o;function f(Ae){return Ae>1?0:Ae<-1?o:Math.acos(Ae)}function l(Ae){return Ae>=1?i:Ae<=-1?-i:Math.asin(Ae)}function h(Ae){return Ae.innerRadius}function d(Ae){return Ae.outerRadius}function s(Ae){return Ae.startAngle}function x(Ae){return Ae.endAngle}function c(Ae){return Ae&&Ae.padAngle}function T(Ae,Ye,nt,ft,Mt,Rt,Gt,jt){var pr=nt-Ae,Ar=ft-Ye,fr=Gt-Mt,Zt=jt-Rt,Qt=Zt*pr-fr*Ar;if(!(Qt*Qt<1e-12))return[Ae+(Qt=(fr*(Ye-Rt)-Zt*(Ae-Mt))/Qt)*pr,Ye+Qt*Ar]}function _(Ae,Ye,nt,ft,Mt,Rt,Gt){var jt=Ae-nt,pr=Ye-ft,Ar=(Gt?Rt:-Rt)/m(jt*jt+pr*pr),fr=Ar*pr,Zt=-Ar*jt,Qt=Ae+fr,$t=Ye+Zt,hr=nt+fr,vr=ft+Zt,Mr=(Qt+hr)/2,Nr=($t+vr)/2,Ur=hr-Qt,Jr=vr-$t,mn=Ur*Ur+Jr*Jr,en=Mt-Rt,In=Qt*vr-hr*$t,vn=(Jr<0?-1:1)*m(t(0,en*en*mn-In*In)),gn=(In*Jr-Ur*vn)/mn,Sn=(-In*Ur-Jr*vn)/mn,Xn=(In*Jr+Ur*vn)/mn,Br=(-In*Ur+Jr*vn)/mn,pn=gn-Mr,on=Sn-Nr,Yr=Xn-Mr,Nn=Br-Nr;return pn*pn+on*on>Yr*Yr+Nn*Nn&&(gn=Xn,Sn=Br),{cx:gn,cy:Sn,x01:-fr,y01:-Zt,x11:gn*(Mt/en-1),y11:Sn*(Mt/en-1)}}function w(Ae){this._context=Ae}function k(Ae){return new w(Ae)}function L(Ae){return Ae[0]}function A(Ae){return Ae[1]}function I(){var Ae=L,Ye=A,nt=b(!0),ft=null,Mt=k,Rt=null;function Gt(jt){var pr,Ar,fr,Zt=jt.length,Qt=!1;for(ft==null&&(Rt=Mt(fr=g.path())),pr=0;pr<=Zt;++pr)!(pr<Zt&&nt(Ar=jt[pr],pr,jt))===Qt&&((Qt=!Qt)?Rt.lineStart():Rt.lineEnd()),Qt&&Rt.point(+Ae(Ar,pr,jt),+Ye(Ar,pr,jt));if(fr)return Rt=null,fr+""||null}return Gt.x=function(jt){return arguments.length?(Ae=typeof jt=="function"?jt:b(+jt),Gt):Ae},Gt.y=function(jt){return arguments.length?(Ye=typeof jt=="function"?jt:b(+jt),Gt):Ye},Gt.defined=function(jt){return arguments.length?(nt=typeof jt=="function"?jt:b(!!jt),Gt):nt},Gt.curve=function(jt){return arguments.length?(Mt=jt,ft!=null&&(Rt=Mt(ft)),Gt):Mt},Gt.context=function(jt){return arguments.length?(jt==null?ft=Rt=null:Rt=Mt(ft=jt),Gt):ft},Gt}function P(){var Ae=L,Ye=null,nt=b(0),ft=A,Mt=b(!0),Rt=null,Gt=k,jt=null;function pr(fr){var Zt,Qt,$t,hr,vr,Mr=fr.length,Nr=!1,Ur=new Array(Mr),Jr=new Array(Mr);for(Rt==null&&(jt=Gt(vr=g.path())),Zt=0;Zt<=Mr;++Zt){if(!(Zt<Mr&&Mt(hr=fr[Zt],Zt,fr))===Nr)if(Nr=!Nr)Qt=Zt,jt.areaStart(),jt.lineStart();else{for(jt.lineEnd(),jt.lineStart(),$t=Zt-1;$t>=Qt;--$t)jt.point(Ur[$t],Jr[$t]);jt.lineEnd(),jt.areaEnd()}Nr&&(Ur[Zt]=+Ae(hr,Zt,fr),Jr[Zt]=+nt(hr,Zt,fr),jt.point(Ye?+Ye(hr,Zt,fr):Ur[Zt],ft?+ft(hr,Zt,fr):Jr[Zt]))}if(vr)return jt=null,vr+""||null}function Ar(){return I().defined(Mt).curve(Gt).context(Rt)}return pr.x=function(fr){return arguments.length?(Ae=typeof fr=="function"?fr:b(+fr),Ye=null,pr):Ae},pr.x0=function(fr){return arguments.length?(Ae=typeof fr=="function"?fr:b(+fr),pr):Ae},pr.x1=function(fr){return arguments.length?(Ye=fr==null?null:typeof fr=="function"?fr:b(+fr),pr):Ye},pr.y=function(fr){return arguments.length?(nt=typeof fr=="function"?fr:b(+fr),ft=null,pr):nt},pr.y0=function(fr){return arguments.length?(nt=typeof fr=="function"?fr:b(+fr),pr):nt},pr.y1=function(fr){return arguments.length?(ft=fr==null?null:typeof fr=="function"?fr:b(+fr),pr):ft},pr.lineX0=pr.lineY0=function(){return Ar().x(Ae).y(nt)},pr.lineY1=function(){return Ar().x(Ae).y(ft)},pr.lineX1=function(){return Ar().x(Ye).y(nt)},pr.defined=function(fr){return arguments.length?(Mt=typeof fr=="function"?fr:b(!!fr),pr):Mt},pr.curve=function(fr){return arguments.length?(Gt=fr,Rt!=null&&(jt=Gt(Rt)),pr):Gt},pr.context=function(fr){return arguments.length?(fr==null?Rt=jt=null:jt=Gt(Rt=fr),pr):Rt},pr}function S(Ae,Ye){return Ye<Ae?-1:Ye>Ae?1:Ye>=Ae?0:NaN}function E(Ae){return Ae}w.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ae,Ye){switch(Ae=+Ae,Ye=+Ye,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ae,Ye):this._context.moveTo(Ae,Ye);break;case 1:this._point=2;default:this._context.lineTo(Ae,Ye)}}};var D=H(k);function R(Ae){this._curve=Ae}function H(Ae){function Ye(nt){return new R(Ae(nt))}return Ye._curve=Ae,Ye}function V(Ae){var Ye=Ae.curve;return Ae.angle=Ae.x,delete Ae.x,Ae.radius=Ae.y,delete Ae.y,Ae.curve=function(nt){return arguments.length?Ye(H(nt)):Ye()._curve},Ae}function X(){return V(I().curve(D))}function $(){var Ae=P().curve(D),Ye=Ae.curve,nt=Ae.lineX0,ft=Ae.lineX1,Mt=Ae.lineY0,Rt=Ae.lineY1;return Ae.angle=Ae.x,delete Ae.x,Ae.startAngle=Ae.x0,delete Ae.x0,Ae.endAngle=Ae.x1,delete Ae.x1,Ae.radius=Ae.y,delete Ae.y,Ae.innerRadius=Ae.y0,delete Ae.y0,Ae.outerRadius=Ae.y1,delete Ae.y1,Ae.lineStartAngle=function(){return V(nt())},delete Ae.lineX0,Ae.lineEndAngle=function(){return V(ft())},delete Ae.lineX1,Ae.lineInnerRadius=function(){return V(Mt())},delete Ae.lineY0,Ae.lineOuterRadius=function(){return V(Rt())},delete Ae.lineY1,Ae.curve=function(Gt){return arguments.length?Ye(H(Gt)):Ye()._curve},Ae}function G(Ae,Ye){return[(Ye=+Ye)*Math.cos(Ae-=Math.PI/2),Ye*Math.sin(Ae)]}R.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Ae,Ye){this._curve.point(Ye*Math.sin(Ae),Ye*-Math.cos(Ae))}};var W=Array.prototype.slice;function te(Ae){return Ae.source}function N(Ae){return Ae.target}function B(Ae){var Ye=te,nt=N,ft=L,Mt=A,Rt=null;function Gt(){var jt,pr=W.call(arguments),Ar=Ye.apply(this,pr),fr=nt.apply(this,pr);if(Rt||(Rt=jt=g.path()),Ae(Rt,+ft.apply(this,(pr[0]=Ar,pr)),+Mt.apply(this,pr),+ft.apply(this,(pr[0]=fr,pr)),+Mt.apply(this,pr)),jt)return Rt=null,jt+""||null}return Gt.source=function(jt){return arguments.length?(Ye=jt,Gt):Ye},Gt.target=function(jt){return arguments.length?(nt=jt,Gt):nt},Gt.x=function(jt){return arguments.length?(ft=typeof jt=="function"?jt:b(+jt),Gt):ft},Gt.y=function(jt){return arguments.length?(Mt=typeof jt=="function"?jt:b(+jt),Gt):Mt},Gt.context=function(jt){return arguments.length?(Rt=jt==null?null:jt,Gt):Rt},Gt}function U(Ae,Ye,nt,ft,Mt){Ae.moveTo(Ye,nt),Ae.bezierCurveTo(Ye=(Ye+ft)/2,nt,Ye,Mt,ft,Mt)}function ee(Ae,Ye,nt,ft,Mt){Ae.moveTo(Ye,nt),Ae.bezierCurveTo(Ye,nt=(nt+Mt)/2,ft,nt,ft,Mt)}function j(Ae,Ye,nt,ft,Mt){var Rt=G(Ye,nt),Gt=G(Ye,nt=(nt+Mt)/2),jt=G(ft,nt),pr=G(ft,Mt);Ae.moveTo(Rt[0],Rt[1]),Ae.bezierCurveTo(Gt[0],Gt[1],jt[0],jt[1],pr[0],pr[1])}var Q={draw:function(Ae,Ye){var nt=Math.sqrt(Ye/o);Ae.moveTo(nt,0),Ae.arc(0,0,nt,0,u)}},K={draw:function(Ae,Ye){var nt=Math.sqrt(Ye/5)/2;Ae.moveTo(-3*nt,-nt),Ae.lineTo(-nt,-nt),Ae.lineTo(-nt,-3*nt),Ae.lineTo(nt,-3*nt),Ae.lineTo(nt,-nt),Ae.lineTo(3*nt,-nt),Ae.lineTo(3*nt,nt),Ae.lineTo(nt,nt),Ae.lineTo(nt,3*nt),Ae.lineTo(-nt,3*nt),Ae.lineTo(-nt,nt),Ae.lineTo(-3*nt,nt),Ae.closePath()}},re=Math.sqrt(1/3),ne=2*re,le={draw:function(Ae,Ye){var nt=Math.sqrt(Ye/ne),ft=nt*re;Ae.moveTo(0,-nt),Ae.lineTo(ft,0),Ae.lineTo(0,nt),Ae.lineTo(-ft,0),Ae.closePath()}},oe=Math.sin(o/10)/Math.sin(7*o/10),de=Math.sin(u/10)*oe,se=-Math.cos(u/10)*oe,me={draw:function(Ae,Ye){var nt=Math.sqrt(.8908130915292852*Ye),ft=de*nt,Mt=se*nt;Ae.moveTo(0,-nt),Ae.lineTo(ft,Mt);for(var Rt=1;Rt<5;++Rt){var Gt=u*Rt/5,jt=Math.cos(Gt),pr=Math.sin(Gt);Ae.lineTo(pr*nt,-jt*nt),Ae.lineTo(jt*ft-pr*Mt,pr*ft+jt*Mt)}Ae.closePath()}},Te={draw:function(Ae,Ye){var nt=Math.sqrt(Ye),ft=-nt/2;Ae.rect(ft,ft,nt,nt)}},_e=Math.sqrt(3),be={draw:function(Ae,Ye){var nt=-Math.sqrt(Ye/(3*_e));Ae.moveTo(0,2*nt),Ae.lineTo(-_e*nt,-nt),Ae.lineTo(_e*nt,-nt),Ae.closePath()}},Ce=-.5,fe=Math.sqrt(3)/2,ve=1/Math.sqrt(12),Me=3*(ve/2+1),ke={draw:function(Ae,Ye){var nt=Math.sqrt(Ye/Me),ft=nt/2,Mt=nt*ve,Rt=ft,Gt=nt*ve+nt,jt=-Rt,pr=Gt;Ae.moveTo(ft,Mt),Ae.lineTo(Rt,Gt),Ae.lineTo(jt,pr),Ae.lineTo(Ce*ft-fe*Mt,fe*ft+Ce*Mt),Ae.lineTo(Ce*Rt-fe*Gt,fe*Rt+Ce*Gt),Ae.lineTo(Ce*jt-fe*pr,fe*jt+Ce*pr),Ae.lineTo(Ce*ft+fe*Mt,Ce*Mt-fe*ft),Ae.lineTo(Ce*Rt+fe*Gt,Ce*Gt-fe*Rt),Ae.lineTo(Ce*jt+fe*pr,Ce*pr-fe*jt),Ae.closePath()}},Le=[Q,K,le,Te,me,be,ke];function ze(){}function Re(Ae,Ye,nt){Ae._context.bezierCurveTo((2*Ae._x0+Ae._x1)/3,(2*Ae._y0+Ae._y1)/3,(Ae._x0+2*Ae._x1)/3,(Ae._y0+2*Ae._y1)/3,(Ae._x0+4*Ae._x1+Ye)/6,(Ae._y0+4*Ae._y1+nt)/6)}function Oe(Ae){this._context=Ae}function Ze(Ae){this._context=Ae}function Pe(Ae){this._context=Ae}function Ie(Ae,Ye){this._basis=new Oe(Ae),this._beta=Ye}Oe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Re(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ae,Ye){switch(Ae=+Ae,Ye=+Ye,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ae,Ye):this._context.moveTo(Ae,Ye);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Re(this,Ae,Ye)}this._x0=this._x1,this._x1=Ae,this._y0=this._y1,this._y1=Ye}},Ze.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Ae,Ye){switch(Ae=+Ae,Ye=+Ye,this._point){case 0:this._point=1,this._x2=Ae,this._y2=Ye;break;case 1:this._point=2,this._x3=Ae,this._y3=Ye;break;case 2:this._point=3,this._x4=Ae,this._y4=Ye,this._context.moveTo((this._x0+4*this._x1+Ae)/6,(this._y0+4*this._y1+Ye)/6);break;default:Re(this,Ae,Ye)}this._x0=this._x1,this._x1=Ae,this._y0=this._y1,this._y1=Ye}},Pe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ae,Ye){switch(Ae=+Ae,Ye=+Ye,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var nt=(this._x0+4*this._x1+Ae)/6,ft=(this._y0+4*this._y1+Ye)/6;this._line?this._context.lineTo(nt,ft):this._context.moveTo(nt,ft);break;case 3:this._point=4;default:Re(this,Ae,Ye)}this._x0=this._x1,this._x1=Ae,this._y0=this._y1,this._y1=Ye}},Ie.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Ae=this._x,Ye=this._y,nt=Ae.length-1;if(nt>0)for(var ft,Mt=Ae[0],Rt=Ye[0],Gt=Ae[nt]-Mt,jt=Ye[nt]-Rt,pr=-1;++pr<=nt;)ft=pr/nt,this._basis.point(this._beta*Ae[pr]+(1-this._beta)*(Mt+ft*Gt),this._beta*Ye[pr]+(1-this._beta)*(Rt+ft*jt));this._x=this._y=null,this._basis.lineEnd()},point:function(Ae,Ye){this._x.push(+Ae),this._y.push(+Ye)}};var Be=function Ae(Ye){function nt(ft){return Ye===1?new Oe(ft):new Ie(ft,Ye)}return nt.beta=function(ft){return Ae(+ft)},nt}(.85);function Fe(Ae,Ye,nt){Ae._context.bezierCurveTo(Ae._x1+Ae._k*(Ae._x2-Ae._x0),Ae._y1+Ae._k*(Ae._y2-Ae._y0),Ae._x2+Ae._k*(Ae._x1-Ye),Ae._y2+Ae._k*(Ae._y1-nt),Ae._x2,Ae._y2)}function $e(Ae,Ye){this._context=Ae,this._k=(1-Ye)/6}$e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Fe(this,this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ae,Ye){switch(Ae=+Ae,Ye=+Ye,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ae,Ye):this._context.moveTo(Ae,Ye);break;case 1:this._point=2,this._x1=Ae,this._y1=Ye;break;case 2:this._point=3;default:Fe(this,Ae,Ye)}this._x0=this._x1,this._x1=this._x2,this._x2=Ae,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var ot=function Ae(Ye){function nt(ft){return new $e(ft,Ye)}return nt.tension=function(ft){return Ae(+ft)},nt}(0);function pt(Ae,Ye){this._context=Ae,this._k=(1-Ye)/6}pt.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ae,Ye){switch(Ae=+Ae,Ye=+Ye,this._point){case 0:this._point=1,this._x3=Ae,this._y3=Ye;break;case 1:this._point=2,this._context.moveTo(this._x4=Ae,this._y4=Ye);break;case 2:this._point=3,this._x5=Ae,this._y5=Ye;break;default:Fe(this,Ae,Ye)}this._x0=this._x1,this._x1=this._x2,this._x2=Ae,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var _t=function Ae(Ye){function nt(ft){return new pt(ft,Ye)}return nt.tension=function(ft){return Ae(+ft)},nt}(0);function yt(Ae,Ye){this._context=Ae,this._k=(1-Ye)/6}yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ae,Ye){switch(Ae=+Ae,Ye=+Ye,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Fe(this,Ae,Ye)}this._x0=this._x1,this._x1=this._x2,this._x2=Ae,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var tt=function Ae(Ye){function nt(ft){return new yt(ft,Ye)}return nt.tension=function(ft){return Ae(+ft)},nt}(0);function Ke(Ae,Ye,nt){var ft=Ae._x1,Mt=Ae._y1,Rt=Ae._x2,Gt=Ae._y2;if(Ae._l01_a>1e-12){var jt=2*Ae._l01_2a+3*Ae._l01_a*Ae._l12_a+Ae._l12_2a,pr=3*Ae._l01_a*(Ae._l01_a+Ae._l12_a);ft=(ft*jt-Ae._x0*Ae._l12_2a+Ae._x2*Ae._l01_2a)/pr,Mt=(Mt*jt-Ae._y0*Ae._l12_2a+Ae._y2*Ae._l01_2a)/pr}if(Ae._l23_a>1e-12){var Ar=2*Ae._l23_2a+3*Ae._l23_a*Ae._l12_a+Ae._l12_2a,fr=3*Ae._l23_a*(Ae._l23_a+Ae._l12_a);Rt=(Rt*Ar+Ae._x1*Ae._l23_2a-Ye*Ae._l12_2a)/fr,Gt=(Gt*Ar+Ae._y1*Ae._l23_2a-nt*Ae._l12_2a)/fr}Ae._context.bezierCurveTo(ft,Mt,Rt,Gt,Ae._x2,Ae._y2)}function vt(Ae,Ye){this._context=Ae,this._alpha=Ye}vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ae,Ye){if(Ae=+Ae,Ye=+Ye,this._point){var nt=this._x2-Ae,ft=this._y2-Ye;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(nt*nt+ft*ft,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ae,Ye):this._context.moveTo(Ae,Ye);break;case 1:this._point=2;break;case 2:this._point=3;default:Ke(this,Ae,Ye)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ae,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var Nt=function Ae(Ye){function nt(ft){return Ye?new vt(ft,Ye):new $e(ft,0)}return nt.alpha=function(ft){return Ae(+ft)},nt}(.5);function qt(Ae,Ye){this._context=Ae,this._alpha=Ye}qt.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ae,Ye){if(Ae=+Ae,Ye=+Ye,this._point){var nt=this._x2-Ae,ft=this._y2-Ye;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(nt*nt+ft*ft,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Ae,this._y3=Ye;break;case 1:this._point=2,this._context.moveTo(this._x4=Ae,this._y4=Ye);break;case 2:this._point=3,this._x5=Ae,this._y5=Ye;break;default:Ke(this,Ae,Ye)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ae,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var er=function Ae(Ye){function nt(ft){return Ye?new qt(ft,Ye):new pt(ft,0)}return nt.alpha=function(ft){return Ae(+ft)},nt}(.5);function Jt(Ae,Ye){this._context=Ae,this._alpha=Ye}Jt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ae,Ye){if(Ae=+Ae,Ye=+Ye,this._point){var nt=this._x2-Ae,ft=this._y2-Ye;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(nt*nt+ft*ft,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ke(this,Ae,Ye)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ae,this._y0=this._y1,this._y1=this._y2,this._y2=Ye}};var ir=function Ae(Ye){function nt(ft){return Ye?new Jt(ft,Ye):new yt(ft,0)}return nt.alpha=function(ft){return Ae(+ft)},nt}(.5);function Ht(Ae){this._context=Ae}function Ue(Ae){return Ae<0?-1:1}function We(Ae,Ye,nt){var ft=Ae._x1-Ae._x0,Mt=Ye-Ae._x1,Rt=(Ae._y1-Ae._y0)/(ft||Mt<0&&-0),Gt=(nt-Ae._y1)/(Mt||ft<0&&-0),jt=(Rt*Mt+Gt*ft)/(ft+Mt);return(Ue(Rt)+Ue(Gt))*Math.min(Math.abs(Rt),Math.abs(Gt),.5*Math.abs(jt))||0}function he(Ae,Ye){var nt=Ae._x1-Ae._x0;return nt?(3*(Ae._y1-Ae._y0)/nt-Ye)/2:Ye}function xe(Ae,Ye,nt){var ft=Ae._x0,Mt=Ae._y0,Rt=Ae._x1,Gt=Ae._y1,jt=(Rt-ft)/3;Ae._context.bezierCurveTo(ft+jt,Mt+jt*Ye,Rt-jt,Gt-jt*nt,Rt,Gt)}function De(Ae){this._context=Ae}function qe(Ae){this._context=new Xe(Ae)}function Xe(Ae){this._context=Ae}function He(Ae){this._context=Ae}function st(Ae){var Ye,nt,ft=Ae.length-1,Mt=new Array(ft),Rt=new Array(ft),Gt=new Array(ft);for(Mt[0]=0,Rt[0]=2,Gt[0]=Ae[0]+2*Ae[1],Ye=1;Ye<ft-1;++Ye)Mt[Ye]=1,Rt[Ye]=4,Gt[Ye]=4*Ae[Ye]+2*Ae[Ye+1];for(Mt[ft-1]=2,Rt[ft-1]=7,Gt[ft-1]=8*Ae[ft-1]+Ae[ft],Ye=1;Ye<ft;++Ye)nt=Mt[Ye]/Rt[Ye-1],Rt[Ye]-=nt,Gt[Ye]-=nt*Gt[Ye-1];for(Mt[ft-1]=Gt[ft-1]/Rt[ft-1],Ye=ft-2;Ye>=0;--Ye)Mt[Ye]=(Gt[Ye]-Mt[Ye+1])/Rt[Ye];for(Rt[ft-1]=(Ae[ft]+Mt[ft-1])/2,Ye=0;Ye<ft-1;++Ye)Rt[Ye]=2*Ae[Ye+1]-Mt[Ye+1];return[Mt,Rt]}function it(Ae,Ye){this._context=Ae,this._t=Ye}function Tt(Ae,Ye){if((Mt=Ae.length)>1)for(var nt,ft,Mt,Rt=1,Gt=Ae[Ye[0]],jt=Gt.length;Rt<Mt;++Rt)for(ft=Gt,Gt=Ae[Ye[Rt]],nt=0;nt<jt;++nt)Gt[nt][1]+=Gt[nt][0]=isNaN(ft[nt][1])?ft[nt][0]:ft[nt][1]}function Pt(Ae){for(var Ye=Ae.length,nt=new Array(Ye);--Ye>=0;)nt[Ye]=Ye;return nt}function rt(Ae,Ye){return Ae[Ye]}function ut(Ae){var Ye=Ae.map(Ft);return Pt(Ae).sort(function(nt,ft){return Ye[nt]-Ye[ft]})}function Ft(Ae){for(var Ye,nt=-1,ft=0,Mt=Ae.length,Rt=-1/0;++nt<Mt;)(Ye=+Ae[nt][1])>Rt&&(Rt=Ye,ft=nt);return ft}function wt(Ae){var Ye=Ae.map(Lt);return Pt(Ae).sort(function(nt,ft){return Ye[nt]-Ye[ft]})}function Lt(Ae){for(var Ye,nt=0,ft=-1,Mt=Ae.length;++ft<Mt;)(Ye=+Ae[ft][1])&&(nt+=Ye);return nt}Ht.prototype={areaStart:ze,areaEnd:ze,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Ae,Ye){Ae=+Ae,Ye=+Ye,this._point?this._context.lineTo(Ae,Ye):(this._point=1,this._context.moveTo(Ae,Ye))}},De.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:xe(this,this._t0,he(this,this._t0))}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ae,Ye){var nt=NaN;if(Ye=+Ye,(Ae=+Ae)!==this._x1||Ye!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ae,Ye):this._context.moveTo(Ae,Ye);break;case 1:this._point=2;break;case 2:this._point=3,xe(this,he(this,nt=We(this,Ae,Ye)),nt);break;default:xe(this,this._t0,nt=We(this,Ae,Ye))}this._x0=this._x1,this._x1=Ae,this._y0=this._y1,this._y1=Ye,this._t0=nt}}},(qe.prototype=Object.create(De.prototype)).point=function(Ae,Ye){De.prototype.point.call(this,Ye,Ae)},Xe.prototype={moveTo:function(Ae,Ye){this._context.moveTo(Ye,Ae)},closePath:function(){this._context.closePath()},lineTo:function(Ae,Ye){this._context.lineTo(Ye,Ae)},bezierCurveTo:function(Ae,Ye,nt,ft,Mt,Rt){this._context.bezierCurveTo(Ye,Ae,ft,nt,Rt,Mt)}},He.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Ae=this._x,Ye=this._y,nt=Ae.length;if(nt)if(this._line?this._context.lineTo(Ae[0],Ye[0]):this._context.moveTo(Ae[0],Ye[0]),nt===2)this._context.lineTo(Ae[1],Ye[1]);else for(var ft=st(Ae),Mt=st(Ye),Rt=0,Gt=1;Gt<nt;++Rt,++Gt)this._context.bezierCurveTo(ft[0][Rt],Mt[0][Rt],ft[1][Rt],Mt[1][Rt],Ae[Gt],Ye[Gt]);(this._line||this._line!==0&&nt===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Ae,Ye){this._x.push(+Ae),this._y.push(+Ye)}},it.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Ae,Ye){switch(Ae=+Ae,Ye=+Ye,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ae,Ye):this._context.moveTo(Ae,Ye);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,Ye),this._context.lineTo(Ae,Ye);else{var nt=this._x*(1-this._t)+Ae*this._t;this._context.lineTo(nt,this._y),this._context.lineTo(nt,Ye)}}this._x=Ae,this._y=Ye}},p.arc=function(){var Ae=h,Ye=d,nt=b(0),ft=null,Mt=s,Rt=x,Gt=c,jt=null;function pr(){var Ar,fr,Zt=+Ae.apply(this,arguments),Qt=+Ye.apply(this,arguments),$t=Mt.apply(this,arguments)-i,hr=Rt.apply(this,arguments)-i,vr=y(hr-$t),Mr=hr>$t;if(jt||(jt=Ar=g.path()),Qt<Zt&&(fr=Qt,Qt=Zt,Zt=fr),Qt>1e-12)if(vr>u-1e-12)jt.moveTo(Qt*n($t),Qt*r($t)),jt.arc(0,0,Qt,$t,hr,!Mr),Zt>1e-12&&(jt.moveTo(Zt*n(hr),Zt*r(hr)),jt.arc(0,0,Zt,hr,$t,Mr));else{var Nr,Ur,Jr=$t,mn=hr,en=$t,In=hr,vn=vr,gn=vr,Sn=Gt.apply(this,arguments)/2,Xn=Sn>1e-12&&(ft?+ft.apply(this,arguments):m(Zt*Zt+Qt*Qt)),Br=a(y(Qt-Zt)/2,+nt.apply(this,arguments)),pn=Br,on=Br;if(Xn>1e-12){var Yr=l(Xn/Zt*r(Sn)),Nn=l(Xn/Qt*r(Sn));(vn-=2*Yr)>1e-12?(en+=Yr*=Mr?1:-1,In-=Yr):(vn=0,en=In=($t+hr)/2),(gn-=2*Nn)>1e-12?(Jr+=Nn*=Mr?1:-1,mn-=Nn):(gn=0,Jr=mn=($t+hr)/2)}var Hn=Qt*n(Jr),xn=Qt*r(Jr),On=Zt*n(In),ua=Zt*r(In);if(Br>1e-12){var tr,yr=Qt*n(mn),Ct=Qt*r(mn),lr=Zt*n(en),dr=Zt*r(en);if(vr<o&&(tr=T(Hn,xn,lr,dr,yr,Ct,On,ua))){var Fr=Hn-tr[0],Rr=xn-tr[1],zr=yr-tr[0],Er=Ct-tr[1],xr=1/r(f((Fr*zr+Rr*Er)/(m(Fr*Fr+Rr*Rr)*m(zr*zr+Er*Er)))/2),_r=m(tr[0]*tr[0]+tr[1]*tr[1]);pn=a(Br,(Zt-_r)/(xr-1)),on=a(Br,(Qt-_r)/(xr+1))}}gn>1e-12?on>1e-12?(Nr=_(lr,dr,Hn,xn,Qt,on,Mr),Ur=_(yr,Ct,On,ua,Qt,on,Mr),jt.moveTo(Nr.cx+Nr.x01,Nr.cy+Nr.y01),on<Br?jt.arc(Nr.cx,Nr.cy,on,e(Nr.y01,Nr.x01),e(Ur.y01,Ur.x01),!Mr):(jt.arc(Nr.cx,Nr.cy,on,e(Nr.y01,Nr.x01),e(Nr.y11,Nr.x11),!Mr),jt.arc(0,0,Qt,e(Nr.cy+Nr.y11,Nr.cx+Nr.x11),e(Ur.cy+Ur.y11,Ur.cx+Ur.x11),!Mr),jt.arc(Ur.cx,Ur.cy,on,e(Ur.y11,Ur.x11),e(Ur.y01,Ur.x01),!Mr))):(jt.moveTo(Hn,xn),jt.arc(0,0,Qt,Jr,mn,!Mr)):jt.moveTo(Hn,xn),Zt>1e-12&&vn>1e-12?pn>1e-12?(Nr=_(On,ua,yr,Ct,Zt,-pn,Mr),Ur=_(Hn,xn,lr,dr,Zt,-pn,Mr),jt.lineTo(Nr.cx+Nr.x01,Nr.cy+Nr.y01),pn<Br?jt.arc(Nr.cx,Nr.cy,pn,e(Nr.y01,Nr.x01),e(Ur.y01,Ur.x01),!Mr):(jt.arc(Nr.cx,Nr.cy,pn,e(Nr.y01,Nr.x01),e(Nr.y11,Nr.x11),!Mr),jt.arc(0,0,Zt,e(Nr.cy+Nr.y11,Nr.cx+Nr.x11),e(Ur.cy+Ur.y11,Ur.cx+Ur.x11),Mr),jt.arc(Ur.cx,Ur.cy,pn,e(Ur.y11,Ur.x11),e(Ur.y01,Ur.x01),!Mr))):jt.arc(0,0,Zt,In,en,Mr):jt.lineTo(On,ua)}else jt.moveTo(0,0);if(jt.closePath(),Ar)return jt=null,Ar+""||null}return pr.centroid=function(){var Ar=(+Ae.apply(this,arguments)+ +Ye.apply(this,arguments))/2,fr=(+Mt.apply(this,arguments)+ +Rt.apply(this,arguments))/2-o/2;return[n(fr)*Ar,r(fr)*Ar]},pr.innerRadius=function(Ar){return arguments.length?(Ae=typeof Ar=="function"?Ar:b(+Ar),pr):Ae},pr.outerRadius=function(Ar){return arguments.length?(Ye=typeof Ar=="function"?Ar:b(+Ar),pr):Ye},pr.cornerRadius=function(Ar){return arguments.length?(nt=typeof Ar=="function"?Ar:b(+Ar),pr):nt},pr.padRadius=function(Ar){return arguments.length?(ft=Ar==null?null:typeof Ar=="function"?Ar:b(+Ar),pr):ft},pr.startAngle=function(Ar){return arguments.length?(Mt=typeof Ar=="function"?Ar:b(+Ar),pr):Mt},pr.endAngle=function(Ar){return arguments.length?(Rt=typeof Ar=="function"?Ar:b(+Ar),pr):Rt},pr.padAngle=function(Ar){return arguments.length?(Gt=typeof Ar=="function"?Ar:b(+Ar),pr):Gt},pr.context=function(Ar){return arguments.length?(jt=Ar==null?null:Ar,pr):jt},pr},p.area=P,p.areaRadial=$,p.curveBasis=function(Ae){return new Oe(Ae)},p.curveBasisClosed=function(Ae){return new Ze(Ae)},p.curveBasisOpen=function(Ae){return new Pe(Ae)},p.curveBundle=Be,p.curveCardinal=ot,p.curveCardinalClosed=_t,p.curveCardinalOpen=tt,p.curveCatmullRom=Nt,p.curveCatmullRomClosed=er,p.curveCatmullRomOpen=ir,p.curveLinear=k,p.curveLinearClosed=function(Ae){return new Ht(Ae)},p.curveMonotoneX=function(Ae){return new De(Ae)},p.curveMonotoneY=function(Ae){return new qe(Ae)},p.curveNatural=function(Ae){return new He(Ae)},p.curveStep=function(Ae){return new it(Ae,.5)},p.curveStepAfter=function(Ae){return new it(Ae,1)},p.curveStepBefore=function(Ae){return new it(Ae,0)},p.line=I,p.lineRadial=X,p.linkHorizontal=function(){return B(U)},p.linkRadial=function(){var Ae=B(j);return Ae.angle=Ae.x,delete Ae.x,Ae.radius=Ae.y,delete Ae.y,Ae},p.linkVertical=function(){return B(ee)},p.pie=function(){var Ae=E,Ye=S,nt=null,ft=b(0),Mt=b(u),Rt=b(0);function Gt(jt){var pr,Ar,fr,Zt,Qt,$t=jt.length,hr=0,vr=new Array($t),Mr=new Array($t),Nr=+ft.apply(this,arguments),Ur=Math.min(u,Math.max(-u,Mt.apply(this,arguments)-Nr)),Jr=Math.min(Math.abs(Ur)/$t,Rt.apply(this,arguments)),mn=Jr*(Ur<0?-1:1);for(pr=0;pr<$t;++pr)(Qt=Mr[vr[pr]=pr]=+Ae(jt[pr],pr,jt))>0&&(hr+=Qt);for(Ye!=null?vr.sort(function(en,In){return Ye(Mr[en],Mr[In])}):nt!=null&&vr.sort(function(en,In){return nt(jt[en],jt[In])}),pr=0,fr=hr?(Ur-$t*mn)/hr:0;pr<$t;++pr,Nr=Zt)Ar=vr[pr],Zt=Nr+((Qt=Mr[Ar])>0?Qt*fr:0)+mn,Mr[Ar]={data:jt[Ar],index:pr,value:Qt,startAngle:Nr,endAngle:Zt,padAngle:Jr};return Mr}return Gt.value=function(jt){return arguments.length?(Ae=typeof jt=="function"?jt:b(+jt),Gt):Ae},Gt.sortValues=function(jt){return arguments.length?(Ye=jt,nt=null,Gt):Ye},Gt.sort=function(jt){return arguments.length?(nt=jt,Ye=null,Gt):nt},Gt.startAngle=function(jt){return arguments.length?(ft=typeof jt=="function"?jt:b(+jt),Gt):ft},Gt.endAngle=function(jt){return arguments.length?(Mt=typeof jt=="function"?jt:b(+jt),Gt):Mt},Gt.padAngle=function(jt){return arguments.length?(Rt=typeof jt=="function"?jt:b(+jt),Gt):Rt},Gt},p.pointRadial=G,p.radialArea=$,p.radialLine=X,p.stack=function(){var Ae=b([]),Ye=Pt,nt=Tt,ft=rt;function Mt(Rt){var Gt,jt,pr=Ae.apply(this,arguments),Ar=Rt.length,fr=pr.length,Zt=new Array(fr);for(Gt=0;Gt<fr;++Gt){for(var Qt,$t=pr[Gt],hr=Zt[Gt]=new Array(Ar),vr=0;vr<Ar;++vr)hr[vr]=Qt=[0,+ft(Rt[vr],$t,vr,Rt)],Qt.data=Rt[vr];hr.key=$t}for(Gt=0,jt=Ye(Zt);Gt<fr;++Gt)Zt[jt[Gt]].index=Gt;return nt(Zt,jt),Zt}return Mt.keys=function(Rt){return arguments.length?(Ae=typeof Rt=="function"?Rt:b(W.call(Rt)),Mt):Ae},Mt.value=function(Rt){return arguments.length?(ft=typeof Rt=="function"?Rt:b(+Rt),Mt):ft},Mt.order=function(Rt){return arguments.length?(Ye=Rt==null?Pt:typeof Rt=="function"?Rt:b(W.call(Rt)),Mt):Ye},Mt.offset=function(Rt){return arguments.length?(nt=Rt==null?Tt:Rt,Mt):nt},Mt},p.stackOffsetDiverging=function(Ae,Ye){if((jt=Ae.length)>0)for(var nt,ft,Mt,Rt,Gt,jt,pr=0,Ar=Ae[Ye[0]].length;pr<Ar;++pr)for(Rt=Gt=0,nt=0;nt<jt;++nt)(Mt=(ft=Ae[Ye[nt]][pr])[1]-ft[0])>0?(ft[0]=Rt,ft[1]=Rt+=Mt):Mt<0?(ft[1]=Gt,ft[0]=Gt+=Mt):(ft[0]=0,ft[1]=Mt)},p.stackOffsetExpand=function(Ae,Ye){if((ft=Ae.length)>0){for(var nt,ft,Mt,Rt=0,Gt=Ae[0].length;Rt<Gt;++Rt){for(Mt=nt=0;nt<ft;++nt)Mt+=Ae[nt][Rt][1]||0;if(Mt)for(nt=0;nt<ft;++nt)Ae[nt][Rt][1]/=Mt}Tt(Ae,Ye)}},p.stackOffsetNone=Tt,p.stackOffsetSilhouette=function(Ae,Ye){if((nt=Ae.length)>0){for(var nt,ft=0,Mt=Ae[Ye[0]],Rt=Mt.length;ft<Rt;++ft){for(var Gt=0,jt=0;Gt<nt;++Gt)jt+=Ae[Gt][ft][1]||0;Mt[ft][1]+=Mt[ft][0]=-jt/2}Tt(Ae,Ye)}},p.stackOffsetWiggle=function(Ae,Ye){if((Mt=Ae.length)>0&&(ft=(nt=Ae[Ye[0]]).length)>0){for(var nt,ft,Mt,Rt=0,Gt=1;Gt<ft;++Gt){for(var jt=0,pr=0,Ar=0;jt<Mt;++jt){for(var fr=Ae[Ye[jt]],Zt=fr[Gt][1]||0,Qt=(Zt-(fr[Gt-1][1]||0))/2,$t=0;$t<jt;++$t){var hr=Ae[Ye[$t]];Qt+=(hr[Gt][1]||0)-(hr[Gt-1][1]||0)}pr+=Zt,Ar+=Qt*Zt}nt[Gt-1][1]+=nt[Gt-1][0]=Rt,pr&&(Rt-=Ar/pr)}nt[Gt-1][1]+=nt[Gt-1][0]=Rt,Tt(Ae,Ye)}},p.stackOrderAppearance=ut,p.stackOrderAscending=wt,p.stackOrderDescending=function(Ae){return wt(Ae).reverse()},p.stackOrderInsideOut=function(Ae){var Ye,nt,ft=Ae.length,Mt=Ae.map(Lt),Rt=ut(Ae),Gt=0,jt=0,pr=[],Ar=[];for(Ye=0;Ye<ft;++Ye)nt=Rt[Ye],Gt<jt?(Gt+=Mt[nt],pr.push(nt)):(jt+=Mt[nt],Ar.push(nt));return Ar.reverse().concat(pr)},p.stackOrderNone=Pt,p.stackOrderReverse=function(Ae){return Pt(Ae).reverse()},p.symbol=function(){var Ae=b(Q),Ye=b(64),nt=null;function ft(){var Mt;if(nt||(nt=Mt=g.path()),Ae.apply(this,arguments).draw(nt,+Ye.apply(this,arguments)),Mt)return nt=null,Mt+""||null}return ft.type=function(Mt){return arguments.length?(Ae=typeof Mt=="function"?Mt:b(Mt),ft):Ae},ft.size=function(Mt){return arguments.length?(Ye=typeof Mt=="function"?Mt:b(+Mt),ft):Ye},ft.context=function(Mt){return arguments.length?(nt=Mt==null?null:Mt,ft):nt},ft},p.symbolCircle=Q,p.symbolCross=K,p.symbolDiamond=le,p.symbolSquare=Te,p.symbolStar=me,p.symbolTriangle=be,p.symbolWye=ke,p.symbols=Le,Object.defineProperty(p,"__esModule",{value:!0})})},{"d3-path":117}],120:[function(v,J,Z){(function(p,g){typeof Z=="object"&&J!==void 0?g(Z,v("d3-time")):g((p=p||self).d3=p.d3||{},p.d3)})(this,function(p,g){function b(tt){if(0<=tt.y&&tt.y<100){var Ke=new Date(-1,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L);return Ke.setFullYear(tt.y),Ke}return new Date(tt.y,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L)}function y(tt){if(0<=tt.y&&tt.y<100){var Ke=new Date(Date.UTC(-1,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L));return Ke.setUTCFullYear(tt.y),Ke}return new Date(Date.UTC(tt.y,tt.m,tt.d,tt.H,tt.M,tt.S,tt.L))}function e(tt,Ke,vt){return{y:tt,m:Ke,d:vt,H:0,M:0,S:0,L:0}}function n(tt){var Ke=tt.dateTime,vt=tt.date,Nt=tt.time,qt=tt.periods,er=tt.days,Jt=tt.shortDays,ir=tt.months,Ht=tt.shortMonths,Ue=f(qt),We=l(qt),he=f(er),xe=l(er),De=f(Jt),qe=l(Jt),Xe=f(ir),He=l(ir),st=f(Ht),it=l(Ht),Tt={a:function(Lt){return Jt[Lt.getDay()]},A:function(Lt){return er[Lt.getDay()]},b:function(Lt){return Ht[Lt.getMonth()]},B:function(Lt){return ir[Lt.getMonth()]},c:null,d:$,e:$,f:B,H:G,I:W,j:te,L:N,m:U,M:ee,p:function(Lt){return qt[+(Lt.getHours()>=12)]},q:function(Lt){return 1+~~(Lt.getMonth()/3)},Q:$e,s:ot,S:j,u:Q,U:K,V:re,w:ne,W:le,x:null,X:null,y:oe,Y:de,Z:se,"%":Fe},Pt={a:function(Lt){return Jt[Lt.getUTCDay()]},A:function(Lt){return er[Lt.getUTCDay()]},b:function(Lt){return Ht[Lt.getUTCMonth()]},B:function(Lt){return ir[Lt.getUTCMonth()]},c:null,d:me,e:me,f:fe,H:Te,I:_e,j:be,L:Ce,m:ve,M:Me,p:function(Lt){return qt[+(Lt.getUTCHours()>=12)]},q:function(Lt){return 1+~~(Lt.getUTCMonth()/3)},Q:$e,s:ot,S:ke,u:Le,U:ze,V:Re,w:Oe,W:Ze,x:null,X:null,y:Pe,Y:Ie,Z:Be,"%":Fe},rt={a:function(Lt,Ae,Ye){var nt=De.exec(Ae.slice(Ye));return nt?(Lt.w=qe[nt[0].toLowerCase()],Ye+nt[0].length):-1},A:function(Lt,Ae,Ye){var nt=he.exec(Ae.slice(Ye));return nt?(Lt.w=xe[nt[0].toLowerCase()],Ye+nt[0].length):-1},b:function(Lt,Ae,Ye){var nt=st.exec(Ae.slice(Ye));return nt?(Lt.m=it[nt[0].toLowerCase()],Ye+nt[0].length):-1},B:function(Lt,Ae,Ye){var nt=Xe.exec(Ae.slice(Ye));return nt?(Lt.m=He[nt[0].toLowerCase()],Ye+nt[0].length):-1},c:function(Lt,Ae,Ye){return wt(Lt,Ke,Ae,Ye)},d:A,e:A,f:R,H:P,I:P,j:I,L:D,m:L,M:S,p:function(Lt,Ae,Ye){var nt=Ue.exec(Ae.slice(Ye));return nt?(Lt.p=We[nt[0].toLowerCase()],Ye+nt[0].length):-1},q:k,Q:V,s:X,S:E,u:d,U:s,V:x,w:h,W:c,x:function(Lt,Ae,Ye){return wt(Lt,vt,Ae,Ye)},X:function(Lt,Ae,Ye){return wt(Lt,Nt,Ae,Ye)},y:_,Y:T,Z:w,"%":H};function ut(Lt,Ae){return function(Ye){var nt,ft,Mt,Rt=[],Gt=-1,jt=0,pr=Lt.length;for(Ye instanceof Date||(Ye=new Date(+Ye));++Gt<pr;)Lt.charCodeAt(Gt)===37&&(Rt.push(Lt.slice(jt,Gt)),(ft=a[nt=Lt.charAt(++Gt)])!=null?nt=Lt.charAt(++Gt):ft=nt==="e"?" ":"0",(Mt=Ae[nt])&&(nt=Mt(Ye,ft)),Rt.push(nt),jt=Gt+1);return Rt.push(Lt.slice(jt,Gt)),Rt.join("")}}function Ft(Lt,Ae){return function(Ye){var nt,ft,Mt=e(1900,void 0,1);if(wt(Mt,Lt,Ye+="",0)!=Ye.length)return null;if("Q"in Mt)return new Date(Mt.Q);if("s"in Mt)return new Date(1e3*Mt.s+("L"in Mt?Mt.L:0));if(Ae&&!("Z"in Mt)&&(Mt.Z=0),"p"in Mt&&(Mt.H=Mt.H%12+12*Mt.p),Mt.m===void 0&&(Mt.m="q"in Mt?Mt.q:0),"V"in Mt){if(Mt.V<1||Mt.V>53)return null;"w"in Mt||(Mt.w=1),"Z"in Mt?(ft=(nt=y(e(Mt.y,0,1))).getUTCDay(),nt=ft>4||ft===0?g.utcMonday.ceil(nt):g.utcMonday(nt),nt=g.utcDay.offset(nt,7*(Mt.V-1)),Mt.y=nt.getUTCFullYear(),Mt.m=nt.getUTCMonth(),Mt.d=nt.getUTCDate()+(Mt.w+6)%7):(ft=(nt=b(e(Mt.y,0,1))).getDay(),nt=ft>4||ft===0?g.timeMonday.ceil(nt):g.timeMonday(nt),nt=g.timeDay.offset(nt,7*(Mt.V-1)),Mt.y=nt.getFullYear(),Mt.m=nt.getMonth(),Mt.d=nt.getDate()+(Mt.w+6)%7)}else("W"in Mt||"U"in Mt)&&("w"in Mt||(Mt.w="u"in Mt?Mt.u%7:"W"in Mt?1:0),ft="Z"in Mt?y(e(Mt.y,0,1)).getUTCDay():b(e(Mt.y,0,1)).getDay(),Mt.m=0,Mt.d="W"in Mt?(Mt.w+6)%7+7*Mt.W-(ft+5)%7:Mt.w+7*Mt.U-(ft+6)%7);return"Z"in Mt?(Mt.H+=Mt.Z/100|0,Mt.M+=Mt.Z%100,y(Mt)):b(Mt)}}function wt(Lt,Ae,Ye,nt){for(var ft,Mt,Rt=0,Gt=Ae.length,jt=Ye.length;Rt<Gt;){if(nt>=jt)return-1;if((ft=Ae.charCodeAt(Rt++))===37){if(ft=Ae.charAt(Rt++),!(Mt=rt[ft in a?Ae.charAt(Rt++):ft])||(nt=Mt(Lt,Ye,nt))<0)return-1}else if(ft!=Ye.charCodeAt(nt++))return-1}return nt}return Tt.x=ut(vt,Tt),Tt.X=ut(Nt,Tt),Tt.c=ut(Ke,Tt),Pt.x=ut(vt,Pt),Pt.X=ut(Nt,Pt),Pt.c=ut(Ke,Pt),{format:function(Lt){var Ae=ut(Lt+="",Tt);return Ae.toString=function(){return Lt},Ae},parse:function(Lt){var Ae=Ft(Lt+="",!1);return Ae.toString=function(){return Lt},Ae},utcFormat:function(Lt){var Ae=ut(Lt+="",Pt);return Ae.toString=function(){return Lt},Ae},utcParse:function(Lt){var Ae=Ft(Lt+="",!0);return Ae.toString=function(){return Lt},Ae}}}var t,a={"-":"",_:" ",0:"0"},r=/^\s*\d+/,m=/^%/,o=/[\\^$*+?|[\]().{}]/g;function i(tt,Ke,vt){var Nt=tt<0?"-":"",qt=(Nt?-tt:tt)+"",er=qt.length;return Nt+(er<vt?new Array(vt-er+1).join(Ke)+qt:qt)}function u(tt){return tt.replace(o,"\\$&")}function f(tt){return new RegExp("^(?:"+tt.map(u).join("|")+")","i")}function l(tt){for(var Ke={},vt=-1,Nt=tt.length;++vt<Nt;)Ke[tt[vt].toLowerCase()]=vt;return Ke}function h(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+1));return Nt?(tt.w=+Nt[0],vt+Nt[0].length):-1}function d(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+1));return Nt?(tt.u=+Nt[0],vt+Nt[0].length):-1}function s(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+2));return Nt?(tt.U=+Nt[0],vt+Nt[0].length):-1}function x(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+2));return Nt?(tt.V=+Nt[0],vt+Nt[0].length):-1}function c(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+2));return Nt?(tt.W=+Nt[0],vt+Nt[0].length):-1}function T(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+4));return Nt?(tt.y=+Nt[0],vt+Nt[0].length):-1}function _(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+2));return Nt?(tt.y=+Nt[0]+(+Nt[0]>68?1900:2e3),vt+Nt[0].length):-1}function w(tt,Ke,vt){var Nt=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(Ke.slice(vt,vt+6));return Nt?(tt.Z=Nt[1]?0:-(Nt[2]+(Nt[3]||"00")),vt+Nt[0].length):-1}function k(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+1));return Nt?(tt.q=3*Nt[0]-3,vt+Nt[0].length):-1}function L(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+2));return Nt?(tt.m=Nt[0]-1,vt+Nt[0].length):-1}function A(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+2));return Nt?(tt.d=+Nt[0],vt+Nt[0].length):-1}function I(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+3));return Nt?(tt.m=0,tt.d=+Nt[0],vt+Nt[0].length):-1}function P(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+2));return Nt?(tt.H=+Nt[0],vt+Nt[0].length):-1}function S(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+2));return Nt?(tt.M=+Nt[0],vt+Nt[0].length):-1}function E(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+2));return Nt?(tt.S=+Nt[0],vt+Nt[0].length):-1}function D(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+3));return Nt?(tt.L=+Nt[0],vt+Nt[0].length):-1}function R(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt,vt+6));return Nt?(tt.L=Math.floor(Nt[0]/1e3),vt+Nt[0].length):-1}function H(tt,Ke,vt){var Nt=m.exec(Ke.slice(vt,vt+1));return Nt?vt+Nt[0].length:-1}function V(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt));return Nt?(tt.Q=+Nt[0],vt+Nt[0].length):-1}function X(tt,Ke,vt){var Nt=r.exec(Ke.slice(vt));return Nt?(tt.s=+Nt[0],vt+Nt[0].length):-1}function $(tt,Ke){return i(tt.getDate(),Ke,2)}function G(tt,Ke){return i(tt.getHours(),Ke,2)}function W(tt,Ke){return i(tt.getHours()%12||12,Ke,2)}function te(tt,Ke){return i(1+g.timeDay.count(g.timeYear(tt),tt),Ke,3)}function N(tt,Ke){return i(tt.getMilliseconds(),Ke,3)}function B(tt,Ke){return N(tt,Ke)+"000"}function U(tt,Ke){return i(tt.getMonth()+1,Ke,2)}function ee(tt,Ke){return i(tt.getMinutes(),Ke,2)}function j(tt,Ke){return i(tt.getSeconds(),Ke,2)}function Q(tt){var Ke=tt.getDay();return Ke===0?7:Ke}function K(tt,Ke){return i(g.timeSunday.count(g.timeYear(tt)-1,tt),Ke,2)}function re(tt,Ke){var vt=tt.getDay();return tt=vt>=4||vt===0?g.timeThursday(tt):g.timeThursday.ceil(tt),i(g.timeThursday.count(g.timeYear(tt),tt)+(g.timeYear(tt).getDay()===4),Ke,2)}function ne(tt){return tt.getDay()}function le(tt,Ke){return i(g.timeMonday.count(g.timeYear(tt)-1,tt),Ke,2)}function oe(tt,Ke){return i(tt.getFullYear()%100,Ke,2)}function de(tt,Ke){return i(tt.getFullYear()%1e4,Ke,4)}function se(tt){var Ke=tt.getTimezoneOffset();return(Ke>0?"-":(Ke*=-1,"+"))+i(Ke/60|0,"0",2)+i(Ke%60,"0",2)}function me(tt,Ke){return i(tt.getUTCDate(),Ke,2)}function Te(tt,Ke){return i(tt.getUTCHours(),Ke,2)}function _e(tt,Ke){return i(tt.getUTCHours()%12||12,Ke,2)}function be(tt,Ke){return i(1+g.utcDay.count(g.utcYear(tt),tt),Ke,3)}function Ce(tt,Ke){return i(tt.getUTCMilliseconds(),Ke,3)}function fe(tt,Ke){return Ce(tt,Ke)+"000"}function ve(tt,Ke){return i(tt.getUTCMonth()+1,Ke,2)}function Me(tt,Ke){return i(tt.getUTCMinutes(),Ke,2)}function ke(tt,Ke){return i(tt.getUTCSeconds(),Ke,2)}function Le(tt){var Ke=tt.getUTCDay();return Ke===0?7:Ke}function ze(tt,Ke){return i(g.utcSunday.count(g.utcYear(tt)-1,tt),Ke,2)}function Re(tt,Ke){var vt=tt.getUTCDay();return tt=vt>=4||vt===0?g.utcThursday(tt):g.utcThursday.ceil(tt),i(g.utcThursday.count(g.utcYear(tt),tt)+(g.utcYear(tt).getUTCDay()===4),Ke,2)}function Oe(tt){return tt.getUTCDay()}function Ze(tt,Ke){return i(g.utcMonday.count(g.utcYear(tt)-1,tt),Ke,2)}function Pe(tt,Ke){return i(tt.getUTCFullYear()%100,Ke,2)}function Ie(tt,Ke){return i(tt.getUTCFullYear()%1e4,Ke,4)}function Be(){return"+0000"}function Fe(){return"%"}function $e(tt){return+tt}function ot(tt){return Math.floor(+tt/1e3)}function pt(tt){return t=n(tt),p.timeFormat=t.format,p.timeParse=t.parse,p.utcFormat=t.utcFormat,p.utcParse=t.utcParse,t}pt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var _t=Date.prototype.toISOString?function(tt){return tt.toISOString()}:p.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),yt=+new Date("2000-01-01T00:00:00.000Z")?function(tt){var Ke=new Date(tt);return isNaN(Ke)?null:Ke}:p.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");p.isoFormat=_t,p.isoParse=yt,p.timeFormatDefaultLocale=pt,p.timeFormatLocale=n,Object.defineProperty(p,"__esModule",{value:!0})})},{"d3-time":121}],121:[function(v,J,Z){(function(p,g){g(typeof Z=="object"&&J!==void 0?Z:(p=p||self).d3=p.d3||{})})(this,function(p){var g=new Date,b=new Date;function y(ve,Me,ke,Le){function ze(Re){return ve(Re=arguments.length===0?new Date:new Date(+Re)),Re}return ze.floor=function(Re){return ve(Re=new Date(+Re)),Re},ze.ceil=function(Re){return ve(Re=new Date(Re-1)),Me(Re,1),ve(Re),Re},ze.round=function(Re){var Oe=ze(Re),Ze=ze.ceil(Re);return Re-Oe<Ze-Re?Oe:Ze},ze.offset=function(Re,Oe){return Me(Re=new Date(+Re),Oe==null?1:Math.floor(Oe)),Re},ze.range=function(Re,Oe,Ze){var Pe,Ie=[];if(Re=ze.ceil(Re),Ze=Ze==null?1:Math.floor(Ze),!(Re<Oe&&Ze>0))return Ie;do Ie.push(Pe=new Date(+Re)),Me(Re,Ze),ve(Re);while(Pe<Re&&Re<Oe);return Ie},ze.filter=function(Re){return y(function(Oe){if(Oe>=Oe)for(;ve(Oe),!Re(Oe);)Oe.setTime(Oe-1)},function(Oe,Ze){if(Oe>=Oe)if(Ze<0)for(;++Ze<=0;)for(;Me(Oe,-1),!Re(Oe););else for(;--Ze>=0;)for(;Me(Oe,1),!Re(Oe););})},ke&&(ze.count=function(Re,Oe){return g.setTime(+Re),b.setTime(+Oe),ve(g),ve(b),Math.floor(ke(g,b))},ze.every=function(Re){return Re=Math.floor(Re),isFinite(Re)&&Re>0?Re>1?ze.filter(Le?function(Oe){return Le(Oe)%Re==0}:function(Oe){return ze.count(0,Oe)%Re==0}):ze:null}),ze}var e=y(function(){},function(ve,Me){ve.setTime(+ve+Me)},function(ve,Me){return Me-ve});e.every=function(ve){return ve=Math.floor(ve),isFinite(ve)&&ve>0?ve>1?y(function(Me){Me.setTime(Math.floor(Me/ve)*ve)},function(Me,ke){Me.setTime(+Me+ke*ve)},function(Me,ke){return(ke-Me)/ve}):e:null};var n=e.range,t=y(function(ve){ve.setTime(ve-ve.getMilliseconds())},function(ve,Me){ve.setTime(+ve+1e3*Me)},function(ve,Me){return(Me-ve)/1e3},function(ve){return ve.getUTCSeconds()}),a=t.range,r=y(function(ve){ve.setTime(ve-ve.getMilliseconds()-1e3*ve.getSeconds())},function(ve,Me){ve.setTime(+ve+6e4*Me)},function(ve,Me){return(Me-ve)/6e4},function(ve){return ve.getMinutes()}),m=r.range,o=y(function(ve){ve.setTime(ve-ve.getMilliseconds()-1e3*ve.getSeconds()-6e4*ve.getMinutes())},function(ve,Me){ve.setTime(+ve+36e5*Me)},function(ve,Me){return(Me-ve)/36e5},function(ve){return ve.getHours()}),i=o.range,u=y(function(ve){ve.setHours(0,0,0,0)},function(ve,Me){ve.setDate(ve.getDate()+Me)},function(ve,Me){return(Me-ve-6e4*(Me.getTimezoneOffset()-ve.getTimezoneOffset()))/864e5},function(ve){return ve.getDate()-1}),f=u.range;function l(ve){return y(function(Me){Me.setDate(Me.getDate()-(Me.getDay()+7-ve)%7),Me.setHours(0,0,0,0)},function(Me,ke){Me.setDate(Me.getDate()+7*ke)},function(Me,ke){return(ke-Me-6e4*(ke.getTimezoneOffset()-Me.getTimezoneOffset()))/6048e5})}var h=l(0),d=l(1),s=l(2),x=l(3),c=l(4),T=l(5),_=l(6),w=h.range,k=d.range,L=s.range,A=x.range,I=c.range,P=T.range,S=_.range,E=y(function(ve){ve.setDate(1),ve.setHours(0,0,0,0)},function(ve,Me){ve.setMonth(ve.getMonth()+Me)},function(ve,Me){return Me.getMonth()-ve.getMonth()+12*(Me.getFullYear()-ve.getFullYear())},function(ve){return ve.getMonth()}),D=E.range,R=y(function(ve){ve.setMonth(0,1),ve.setHours(0,0,0,0)},function(ve,Me){ve.setFullYear(ve.getFullYear()+Me)},function(ve,Me){return Me.getFullYear()-ve.getFullYear()},function(ve){return ve.getFullYear()});R.every=function(ve){return isFinite(ve=Math.floor(ve))&&ve>0?y(function(Me){Me.setFullYear(Math.floor(Me.getFullYear()/ve)*ve),Me.setMonth(0,1),Me.setHours(0,0,0,0)},function(Me,ke){Me.setFullYear(Me.getFullYear()+ke*ve)}):null};var H=R.range,V=y(function(ve){ve.setUTCSeconds(0,0)},function(ve,Me){ve.setTime(+ve+6e4*Me)},function(ve,Me){return(Me-ve)/6e4},function(ve){return ve.getUTCMinutes()}),X=V.range,$=y(function(ve){ve.setUTCMinutes(0,0,0)},function(ve,Me){ve.setTime(+ve+36e5*Me)},function(ve,Me){return(Me-ve)/36e5},function(ve){return ve.getUTCHours()}),G=$.range,W=y(function(ve){ve.setUTCHours(0,0,0,0)},function(ve,Me){ve.setUTCDate(ve.getUTCDate()+Me)},function(ve,Me){return(Me-ve)/864e5},function(ve){return ve.getUTCDate()-1}),te=W.range;function N(ve){return y(function(Me){Me.setUTCDate(Me.getUTCDate()-(Me.getUTCDay()+7-ve)%7),Me.setUTCHours(0,0,0,0)},function(Me,ke){Me.setUTCDate(Me.getUTCDate()+7*ke)},function(Me,ke){return(ke-Me)/6048e5})}var B=N(0),U=N(1),ee=N(2),j=N(3),Q=N(4),K=N(5),re=N(6),ne=B.range,le=U.range,oe=ee.range,de=j.range,se=Q.range,me=K.range,Te=re.range,_e=y(function(ve){ve.setUTCDate(1),ve.setUTCHours(0,0,0,0)},function(ve,Me){ve.setUTCMonth(ve.getUTCMonth()+Me)},function(ve,Me){return Me.getUTCMonth()-ve.getUTCMonth()+12*(Me.getUTCFullYear()-ve.getUTCFullYear())},function(ve){return ve.getUTCMonth()}),be=_e.range,Ce=y(function(ve){ve.setUTCMonth(0,1),ve.setUTCHours(0,0,0,0)},function(ve,Me){ve.setUTCFullYear(ve.getUTCFullYear()+Me)},function(ve,Me){return Me.getUTCFullYear()-ve.getUTCFullYear()},function(ve){return ve.getUTCFullYear()});Ce.every=function(ve){return isFinite(ve=Math.floor(ve))&&ve>0?y(function(Me){Me.setUTCFullYear(Math.floor(Me.getUTCFullYear()/ve)*ve),Me.setUTCMonth(0,1),Me.setUTCHours(0,0,0,0)},function(Me,ke){Me.setUTCFullYear(Me.getUTCFullYear()+ke*ve)}):null};var fe=Ce.range;p.timeDay=u,p.timeDays=f,p.timeFriday=T,p.timeFridays=P,p.timeHour=o,p.timeHours=i,p.timeInterval=y,p.timeMillisecond=e,p.timeMilliseconds=n,p.timeMinute=r,p.timeMinutes=m,p.timeMonday=d,p.timeMondays=k,p.timeMonth=E,p.timeMonths=D,p.timeSaturday=_,p.timeSaturdays=S,p.timeSecond=t,p.timeSeconds=a,p.timeSunday=h,p.timeSundays=w,p.timeThursday=c,p.timeThursdays=I,p.timeTuesday=s,p.timeTuesdays=L,p.timeWednesday=x,p.timeWednesdays=A,p.timeWeek=h,p.timeWeeks=w,p.timeYear=R,p.timeYears=H,p.utcDay=W,p.utcDays=te,p.utcFriday=K,p.utcFridays=me,p.utcHour=$,p.utcHours=G,p.utcMillisecond=e,p.utcMilliseconds=n,p.utcMinute=V,p.utcMinutes=X,p.utcMonday=U,p.utcMondays=le,p.utcMonth=_e,p.utcMonths=be,p.utcSaturday=re,p.utcSaturdays=Te,p.utcSecond=t,p.utcSeconds=a,p.utcSunday=B,p.utcSundays=ne,p.utcThursday=Q,p.utcThursdays=se,p.utcTuesday=ee,p.utcTuesdays=oe,p.utcWednesday=j,p.utcWednesdays=de,p.utcWeek=B,p.utcWeeks=ne,p.utcYear=Ce,p.utcYears=fe,Object.defineProperty(p,"__esModule",{value:!0})})},{}],122:[function(v,J,Z){arguments[4][121][0].apply(Z,arguments)},{dup:121}],123:[function(v,J,Z){(function(p,g){g(typeof Z=="object"&&J!==void 0?Z:(p=p||self).d3=p.d3||{})})(this,function(p){var g,b,y=0,e=0,n=0,t=0,a=0,r=0,m=typeof performance=="object"&&performance.now?performance:Date,o=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(c){setTimeout(c,17)};function i(){return a||(o(u),a=m.now()+r)}function u(){a=0}function f(){this._call=this._time=this._next=null}function l(c,T,_){var w=new f;return w.restart(c,T,_),w}function h(){i(),++y;for(var c,T=g;T;)(c=a-T._time)>=0&&T._call.call(null,c),T=T._next;--y}function d(){a=(t=m.now())+r,y=e=0;try{h()}finally{y=0,function(){for(var c,T,_=g,w=1/0;_;)_._call?(w>_._time&&(w=_._time),c=_,_=_._next):(T=_._next,_._next=null,_=c?c._next=T:g=T);b=c,x(w)}(),a=0}}function s(){var c=m.now(),T=c-t;T>1e3&&(r-=T,t=c)}function x(c){y||(e&&(e=clearTimeout(e)),c-a>24?(c<1/0&&(e=setTimeout(d,c-m.now()-r)),n&&(n=clearInterval(n))):(n||(t=m.now(),n=setInterval(s,1e3)),y=1,o(d)))}f.prototype=l.prototype={constructor:f,restart:function(c,T,_){if(typeof c!="function")throw new TypeError("callback is not a function");_=(_==null?i():+_)+(T==null?0:+T),this._next||b===this||(b?b._next=this:g=this,b=this),this._call=c,this._time=_,x()},stop:function(){this._call&&(this._call=null,this._time=1/0,x())}},p.interval=function(c,T,_){var w=new f,k=T;return T==null?(w.restart(c,T,_),w):(T=+T,_=_==null?i():+_,w.restart(function L(A){A+=k,w.restart(L,k+=T,_),c(A)},T,_),w)},p.now=i,p.timeout=function(c,T,_){var w=new f;return T=T==null?0:+T,w.restart(function(k){w.stop(),c(k+T)},T,_),w},p.timer=l,p.timerFlush=h,Object.defineProperty(p,"__esModule",{value:!0})})},{}],124:[function(v,J,Z){J.exports=function(){for(var p=0;p<arguments.length;p++)if(arguments[p]!==void 0)return arguments[p]}},{}],125:[function(v,J,Z){J.exports=b;var p=(b.canvas=document.createElement("canvas")).getContext("2d"),g=y([32,126]);function b(e,n){Array.isArray(e)&&(e=e.join(", "));var t,a={},r=16,m=.05;n&&(n.length===2&&typeof n[0]=="number"?t=y(n):Array.isArray(n)?t=n:(n.o?t=y(n.o):n.pairs&&(t=n.pairs),n.fontSize&&(r=n.fontSize),n.threshold!=null&&(m=n.threshold))),t||(t=g),p.font=r+"px "+e;for(var o=0;o<t.length;o++){var i=t[o],u=p.measureText(i[0]).width+p.measureText(i[1]).width,f=p.measureText(i).width;if(Math.abs(u-f)>r*m){var l=(f-u)/r;a[i]=1e3*l}}return a}function y(e){for(var n=[],t=e[0];t<=e[1];t++)for(var a=String.fromCharCode(t),r=e[0];r<e[1];r++){var m=a+String.fromCharCode(r);n.push(m)}return n}b.createPairs=y,b.ascii=g},{}],126:[function(v,J,Z){var p=v("abs-svg-path"),g=v("normalize-svg-path"),b={M:"moveTo",C:"bezierCurveTo"};J.exports=function(y,e){y.beginPath(),g(p(e)).forEach(function(n){var t=n[0],a=n.slice(1);y[b[t]].apply(y,a)}),y.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(v,J,Z){J.exports=function(p){switch(p){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(v,J,Z){J.exports=function(p,g){switch(g===void 0&&(g=0),typeof p){case"number":if(p>0)return function(b,y){var e,n;for(e=new Array(b),n=0;n<b;++n)e[n]=y;return e}(0|p,g);break;case"object":if(typeof p.length=="number")return function b(y,e,n){var t=0|y[n];if(t<=0)return[];var a,r=new Array(t);if(n===y.length-1)for(a=0;a<t;++a)r[a]=e;else for(a=0;a<t;++a)r[a]=b(y,e,n+1);return r}(p,g,0)}return[]}},{}],129:[function(v,J,Z){function p(I,P,S){S=S||2;var E,D,R,H,V,X,$,G=P&&P.length,W=G?P[0]*S:I.length,te=g(I,0,W,S,!0),N=[];if(!te||te.next===te.prev)return N;if(G&&(te=function(U,ee,j,Q){var K,re,ne,le,oe,de=[];for(K=0,re=ee.length;K<re;K++)ne=ee[K]*Q,le=K<re-1?ee[K+1]*Q:U.length,(oe=g(U,ne,le,Q,!1))===oe.next&&(oe.steiner=!0),de.push(u(oe));for(de.sort(r),K=0;K<de.length;K++)m(de[K],j),j=b(j,j.next);return j}(I,P,te,S)),I.length>80*S){E=R=I[0],D=H=I[1];for(var B=S;B<W;B+=S)(V=I[B])<E&&(E=V),(X=I[B+1])<D&&(D=X),V>R&&(R=V),X>H&&(H=X);$=($=Math.max(R-E,H-D))!==0?1/$:0}return y(te,N,S,E,D,$),N}function g(I,P,S,E,D){var R,H;if(D===A(I,P,S,E)>0)for(R=P;R<S;R+=E)H=w(R,I[R],I[R+1],H);else for(R=S-E;R>=P;R-=E)H=w(R,I[R],I[R+1],H);return H&&d(H,H.next)&&(k(H),H=H.next),H}function b(I,P){if(!I)return I;P||(P=I);var S,E=I;do if(S=!1,E.steiner||!d(E,E.next)&&h(E.prev,E,E.next)!==0)E=E.next;else{if(k(E),(E=P=E.prev)===E.next)break;S=!0}while(S||E!==P);return P}function y(I,P,S,E,D,R,H){if(I){!H&&R&&function(G,W,te,N){var B=G;do B.z===null&&(B.z=i(B.x,B.y,W,te,N)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==G);B.prevZ.nextZ=null,B.prevZ=null,function(U){var ee,j,Q,K,re,ne,le,oe,de=1;do{for(j=U,U=null,re=null,ne=0;j;){for(ne++,Q=j,le=0,ee=0;ee<de&&(le++,Q=Q.nextZ);ee++);for(oe=de;le>0||oe>0&&Q;)le!==0&&(oe===0||!Q||j.z<=Q.z)?(K=j,j=j.nextZ,le--):(K=Q,Q=Q.nextZ,oe--),re?re.nextZ=K:U=K,K.prevZ=re,re=K;j=Q}re.nextZ=null,de*=2}while(ne>1)}(B)}(I,E,D,R);for(var V,X,$=I;I.prev!==I.next;)if(V=I.prev,X=I.next,R?n(I,E,D,R):e(I))P.push(V.i/S),P.push(I.i/S),P.push(X.i/S),k(I),I=X.next,$=X.next;else if((I=X)===$){H?H===1?y(I=t(b(I),P,S),P,S,E,D,R,2):H===2&&a(I,P,S,E,D,R):y(b(I),P,S,E,D,R,1);break}}}function e(I){var P=I.prev,S=I,E=I.next;if(h(P,S,E)>=0)return!1;for(var D=I.next.next;D!==I.prev;){if(f(P.x,P.y,S.x,S.y,E.x,E.y,D.x,D.y)&&h(D.prev,D,D.next)>=0)return!1;D=D.next}return!0}function n(I,P,S,E){var D=I.prev,R=I,H=I.next;if(h(D,R,H)>=0)return!1;for(var V=D.x<R.x?D.x<H.x?D.x:H.x:R.x<H.x?R.x:H.x,X=D.y<R.y?D.y<H.y?D.y:H.y:R.y<H.y?R.y:H.y,$=D.x>R.x?D.x>H.x?D.x:H.x:R.x>H.x?R.x:H.x,G=D.y>R.y?D.y>H.y?D.y:H.y:R.y>H.y?R.y:H.y,W=i(V,X,P,S,E),te=i($,G,P,S,E),N=I.prevZ,B=I.nextZ;N&&N.z>=W&&B&&B.z<=te;){if(N!==I.prev&&N!==I.next&&f(D.x,D.y,R.x,R.y,H.x,H.y,N.x,N.y)&&h(N.prev,N,N.next)>=0||(N=N.prevZ,B!==I.prev&&B!==I.next&&f(D.x,D.y,R.x,R.y,H.x,H.y,B.x,B.y)&&h(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;N&&N.z>=W;){if(N!==I.prev&&N!==I.next&&f(D.x,D.y,R.x,R.y,H.x,H.y,N.x,N.y)&&h(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;B&&B.z<=te;){if(B!==I.prev&&B!==I.next&&f(D.x,D.y,R.x,R.y,H.x,H.y,B.x,B.y)&&h(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function t(I,P,S){var E=I;do{var D=E.prev,R=E.next.next;!d(D,R)&&s(D,E,E.next,R)&&T(D,R)&&T(R,D)&&(P.push(D.i/S),P.push(E.i/S),P.push(R.i/S),k(E),k(E.next),E=I=R),E=E.next}while(E!==I);return b(E)}function a(I,P,S,E,D,R){var H=I;do{for(var V=H.next.next;V!==H.prev;){if(H.i!==V.i&&l(H,V)){var X=_(H,V);return H=b(H,H.next),X=b(X,X.next),y(H,P,S,E,D,R),void y(X,P,S,E,D,R)}V=V.next}H=H.next}while(H!==I)}function r(I,P){return I.x-P.x}function m(I,P){if(P=function(E,D){var R,H=D,V=E.x,X=E.y,$=-1/0;do{if(X<=H.y&&X>=H.next.y&&H.next.y!==H.y){var G=H.x+(X-H.y)*(H.next.x-H.x)/(H.next.y-H.y);if(G<=V&&G>$){if($=G,G===V){if(X===H.y)return H;if(X===H.next.y)return H.next}R=H.x<H.next.x?H:H.next}}H=H.next}while(H!==D);if(!R)return null;if(V===$)return R;var W,te=R,N=R.x,B=R.y,U=1/0;H=R;do V>=H.x&&H.x>=N&&V!==H.x&&f(X<B?V:$,X,N,B,X<B?$:V,X,H.x,H.y)&&(W=Math.abs(X-H.y)/(V-H.x),T(H,E)&&(W<U||W===U&&(H.x>R.x||H.x===R.x&&o(R,H)))&&(R=H,U=W)),H=H.next;while(H!==te);return R}(I,P)){var S=_(P,I);b(P,P.next),b(S,S.next)}}function o(I,P){return h(I.prev,I,P.prev)<0&&h(P.next,I,I.next)<0}function i(I,P,S,E,D){return(I=1431655765&((I=858993459&((I=252645135&((I=16711935&((I=32767*(I-S)*D)|I<<8))|I<<4))|I<<2))|I<<1))|(P=1431655765&((P=858993459&((P=252645135&((P=16711935&((P=32767*(P-E)*D)|P<<8))|P<<4))|P<<2))|P<<1))<<1}function u(I){var P=I,S=I;do(P.x<S.x||P.x===S.x&&P.y<S.y)&&(S=P),P=P.next;while(P!==I);return S}function f(I,P,S,E,D,R,H,V){return(D-H)*(P-V)-(I-H)*(R-V)>=0&&(I-H)*(E-V)-(S-H)*(P-V)>=0&&(S-H)*(R-V)-(D-H)*(E-V)>=0}function l(I,P){return I.next.i!==P.i&&I.prev.i!==P.i&&!function(S,E){var D=S;do{if(D.i!==S.i&&D.next.i!==S.i&&D.i!==E.i&&D.next.i!==E.i&&s(D,D.next,S,E))return!0;D=D.next}while(D!==S);return!1}(I,P)&&(T(I,P)&&T(P,I)&&function(S,E){var D=S,R=!1,H=(S.x+E.x)/2,V=(S.y+E.y)/2;do D.y>V!=D.next.y>V&&D.next.y!==D.y&&H<(D.next.x-D.x)*(V-D.y)/(D.next.y-D.y)+D.x&&(R=!R),D=D.next;while(D!==S);return R}(I,P)&&(h(I.prev,I,P.prev)||h(I,P.prev,P))||d(I,P)&&h(I.prev,I,I.next)>0&&h(P.prev,P,P.next)>0)}function h(I,P,S){return(P.y-I.y)*(S.x-P.x)-(P.x-I.x)*(S.y-P.y)}function d(I,P){return I.x===P.x&&I.y===P.y}function s(I,P,S,E){var D=c(h(I,P,S)),R=c(h(I,P,E)),H=c(h(S,E,I)),V=c(h(S,E,P));return D!==R&&H!==V||!(D!==0||!x(I,S,P))||!(R!==0||!x(I,E,P))||!(H!==0||!x(S,I,E))||!(V!==0||!x(S,P,E))}function x(I,P,S){return P.x<=Math.max(I.x,S.x)&&P.x>=Math.min(I.x,S.x)&&P.y<=Math.max(I.y,S.y)&&P.y>=Math.min(I.y,S.y)}function c(I){return I>0?1:I<0?-1:0}function T(I,P){return h(I.prev,I,I.next)<0?h(I,P,I.next)>=0&&h(I,I.prev,P)>=0:h(I,P,I.prev)<0||h(I,I.next,P)<0}function _(I,P){var S=new L(I.i,I.x,I.y),E=new L(P.i,P.x,P.y),D=I.next,R=P.prev;return I.next=P,P.prev=I,S.next=D,D.prev=S,E.next=S,S.prev=E,R.next=E,E.prev=R,E}function w(I,P,S,E){var D=new L(I,P,S);return E?(D.next=E.next,D.prev=E,E.next.prev=D,E.next=D):(D.prev=D,D.next=D),D}function k(I){I.next.prev=I.prev,I.prev.next=I.next,I.prevZ&&(I.prevZ.nextZ=I.nextZ),I.nextZ&&(I.nextZ.prevZ=I.prevZ)}function L(I,P,S){this.i=I,this.x=P,this.y=S,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(I,P,S,E){for(var D=0,R=P,H=S-E;R<S;R+=E)D+=(I[H]-I[R])*(I[R+1]+I[H+1]),H=R;return D}J.exports=p,J.exports.default=p,p.deviation=function(I,P,S,E){var D=P&&P.length,R=D?P[0]*S:I.length,H=Math.abs(A(I,0,R,S));if(D)for(var V=0,X=P.length;V<X;V++){var $=P[V]*S,G=V<X-1?P[V+1]*S:I.length;H-=Math.abs(A(I,$,G,S))}var W=0;for(V=0;V<E.length;V+=3){var te=E[V]*S,N=E[V+1]*S,B=E[V+2]*S;W+=Math.abs((I[te]-I[B])*(I[N+1]-I[te+1])-(I[te]-I[N])*(I[B+1]-I[te+1]))}return H===0&&W===0?0:Math.abs((W-H)/H)},p.flatten=function(I){for(var P=I[0][0].length,S={vertices:[],holes:[],dimensions:P},E=0,D=0;D<I.length;D++){for(var R=0;R<I[D].length;R++)for(var H=0;H<P;H++)S.vertices.push(I[D][R][H]);D>0&&(E+=I[D-1].length,S.holes.push(E))}return S}},{}],130:[function(v,J,Z){var p=v("strongly-connected-components");J.exports=function(g,b){var y,e=[],n=[],t=[],a={},r=[];function m(s){var x,c,T=!1;for(n.push(s),t[s]=!0,x=0;x<r[s].length;x++)(c=r[s][x])===y?(o(y,n),T=!0):t[c]||(T=m(c));if(T)(function w(k){t[k]=!1,a.hasOwnProperty(k)&&Object.keys(a[k]).forEach(function(L){delete a[k][L],t[L]&&w(L)})})(s);else for(x=0;x<r[s].length;x++){c=r[s][x];var _=a[c];_||(_={},a[c]=_),_[c]=!0}return n.pop(),T}function o(s,x){var c=[].concat(x).concat(s);b?b(m):e.push(c)}function i(s){(function(L){for(var A=0;A<g.length;A++)A<L&&(g[A]=[]),g[A]=g[A].filter(function(I){return I>=L})})(s);for(var x,c=p(g).components.filter(function(L){return L.length>1}),T=1/0,_=0;_<c.length;_++)for(var w=0;w<c[_].length;w++)c[_][w]<T&&(T=c[_][w],x=_);var k=c[x];return!!k&&{leastVertex:T,adjList:g.map(function(L,A){return k.indexOf(A)===-1?[]:L.filter(function(I){return k.indexOf(I)!==-1})})}}y=0;for(var u=g.length;y<u;){var f=i(y);if(y=f.leastVertex,r=f.adjList){for(var l=0;l<r.length;l++)for(var h=0;h<r[l].length;h++){var d=r[l][h];t[+d]=!1,a[d]={}}m(y),y+=1}else y=u}return b?void 0:e}},{"strongly-connected-components":307}],131:[function(v,J,Z){var p=v("../../object/valid-value");J.exports=function(){return p(this).length=0,this}},{"../../object/valid-value":162}],132:[function(v,J,Z){J.exports=v("./is-implemented")()?Array.from:v("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(v,J,Z){J.exports=function(){var p,g,b=Array.from;return typeof b=="function"&&(g=b(p=["raz","dwa"]),Boolean(g&&g!==p&&g[1]==="dwa"))}},{}],134:[function(v,J,Z){var p=v("es6-symbol").iterator,g=v("../../function/is-arguments"),b=v("../../function/is-function"),y=v("../../number/to-pos-integer"),e=v("../../object/valid-callable"),n=v("../../object/valid-value"),t=v("../../object/is-value"),a=v("../../string/is-string"),r=Array.isArray,m=Function.prototype.call,o={configurable:!0,enumerable:!0,writable:!0,value:null},i=Object.defineProperty;J.exports=function(u){var f,l,h,d,s,x,c,T,_,w,k=arguments[1],L=arguments[2];if(u=Object(n(u)),t(k)&&e(k),this&&this!==Array&&b(this))f=this;else{if(!k){if(g(u))return(s=u.length)!==1?Array.apply(null,u):((d=new Array(1))[0]=u[0],d);if(r(u)){for(d=new Array(s=u.length),l=0;l<s;++l)d[l]=u[l];return d}}d=[]}if(!r(u)){if((_=u[p])!==void 0){for(c=e(_).call(u),f&&(d=new f),T=c.next(),l=0;!T.done;)w=k?m.call(k,L,T.value,l):T.value,f?(o.value=w,i(d,l,o)):d[l]=w,T=c.next(),++l;s=l}else if(a(u)){for(s=u.length,f&&(d=new f),l=0,h=0;l<s;++l)w=u[l],l+1<s&&(x=w.charCodeAt(0))>=55296&&x<=56319&&(w+=u[++l]),w=k?m.call(k,L,w,h):w,f?(o.value=w,i(d,h,o)):d[h]=w,++h;s=h}}if(s===void 0)for(s=y(u.length),f&&(d=new f(s)),l=0;l<s;++l)w=k?m.call(k,L,u[l],l):u[l],f?(o.value=w,i(d,l,o)):d[l]=w;return f&&(o.value=null,d.length=s),d}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(v,J,Z){var p=Object.prototype.toString,g=p.call(function(){return arguments}());J.exports=function(b){return p.call(b)===g}},{}],136:[function(v,J,Z){var p=Object.prototype.toString,g=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);J.exports=function(b){return typeof b=="function"&&g(p.call(b))}},{}],137:[function(v,J,Z){J.exports=function(){}},{}],138:[function(v,J,Z){J.exports=v("./is-implemented")()?Math.sign:v("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(v,J,Z){J.exports=function(){var p=Math.sign;return typeof p=="function"&&p(10)===1&&p(-20)===-1}},{}],140:[function(v,J,Z){J.exports=function(p){return p=Number(p),isNaN(p)||p===0?p:p>0?1:-1}},{}],141:[function(v,J,Z){var p=v("../math/sign"),g=Math.abs,b=Math.floor;J.exports=function(y){return isNaN(y)?0:(y=Number(y))!==0&&isFinite(y)?p(y)*b(g(y)):y}},{"../math/sign":138}],142:[function(v,J,Z){var p=v("./to-integer"),g=Math.max;J.exports=function(b){return g(0,p(b))}},{"./to-integer":141}],143:[function(v,J,Z){var p=v("./valid-callable"),g=v("./valid-value"),b=Function.prototype.bind,y=Function.prototype.call,e=Object.keys,n=Object.prototype.propertyIsEnumerable;J.exports=function(t,a){return function(r,m){var o,i=arguments[2],u=arguments[3];return r=Object(g(r)),p(m),o=e(r),u&&o.sort(typeof u=="function"?b.call(u,r):void 0),typeof t!="function"&&(t=o[t]),y.call(t,o,function(f,l){return n.call(r,f)?y.call(m,i,r[f],f,r,l):a})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(v,J,Z){J.exports=v("./is-implemented")()?Object.assign:v("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(v,J,Z){J.exports=function(){var p,g=Object.assign;return typeof g=="function"&&(g(p={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),p.foo+p.bar+p.trzy==="razdwatrzy")}},{}],146:[function(v,J,Z){var p=v("../keys"),g=v("../valid-value"),b=Math.max;J.exports=function(y,e){var n,t,a,r=b(arguments.length,2);for(y=Object(g(y)),a=function(m){try{y[m]=e[m]}catch(o){n||(n=o)}},t=1;t<r;++t)p(e=arguments[t]).forEach(a);if(n!==void 0)throw n;return y}},{"../keys":152,"../valid-value":162}],147:[function(v,J,Z){var p=v("../array/from"),g=v("./assign"),b=v("./valid-value");J.exports=function(y){var e=Object(b(y)),n=arguments[1],t=Object(arguments[2]);if(e!==y&&!n)return e;var a={};return n?p(n,function(r){(t.ensure||r in y)&&(a[r]=y[r])}):g(a,y),a}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(v,J,Z){var p,g,b,y,e=Object.create;v("./set-prototype-of/is-implemented")()||(p=v("./set-prototype-of/shim")),J.exports=p?p.level!==1?e:(g={},b={},y={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(n){b[n]=n!=="__proto__"?y:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(g,b),Object.defineProperty(p,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:g}),function(n,t){return e(n===null?g:n,t)}):e},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(v,J,Z){J.exports=v("./_iterate")("forEach")},{"./_iterate":143}],150:[function(v,J,Z){var p=v("./is-value"),g={function:!0,object:!0};J.exports=function(b){return p(b)&&g[typeof b]||!1}},{"./is-value":151}],151:[function(v,J,Z){var p=v("../function/noop")();J.exports=function(g){return g!==p&&g!==null}},{"../function/noop":137}],152:[function(v,J,Z){J.exports=v("./is-implemented")()?Object.keys:v("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(v,J,Z){J.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],154:[function(v,J,Z){var p=v("../is-value"),g=Object.keys;J.exports=function(b){return g(p(b)?Object(b):b)}},{"../is-value":151}],155:[function(v,J,Z){var p=v("./valid-callable"),g=v("./for-each"),b=Function.prototype.call;J.exports=function(y,e){var n={},t=arguments[2];return p(e),g(y,function(a,r,m,o){n[r]=b.call(e,t,a,r,m,o)}),n}},{"./for-each":149,"./valid-callable":160}],156:[function(v,J,Z){var p=v("./is-value"),g=Array.prototype.forEach,b=Object.create,y=function(e,n){var t;for(t in e)n[t]=e[t]};J.exports=function(e){var n=b(null);return g.call(arguments,function(t){p(t)&&y(Object(t),n)}),n}},{"./is-value":151}],157:[function(v,J,Z){J.exports=v("./is-implemented")()?Object.setPrototypeOf:v("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(v,J,Z){var p=Object.create,g=Object.getPrototypeOf,b={};J.exports=function(){var y=Object.setPrototypeOf,e=arguments[0]||p;return typeof y=="function"&&g(y(e(null),b))===b}},{}],159:[function(v,J,Z){var p,g=v("../is-object"),b=v("../valid-value"),y=Object.prototype.isPrototypeOf,e=Object.defineProperty,n={configurable:!0,enumerable:!1,writable:!0,value:void 0};p=function(t,a){if(b(t),a===null||g(a))return t;throw new TypeError("Prototype must be null or an object")},J.exports=function(t){var a,r;return t?(t.level===2?t.set?(r=t.set,a=function(m,o){return r.call(p(m,o),o),m}):a=function(m,o){return p(m,o).__proto__=o,m}:a=function m(o,i){var u;return p(o,i),(u=y.call(m.nullPolyfill,o))&&delete m.nullPolyfill.__proto__,i===null&&(i=m.nullPolyfill),o.__proto__=i,u&&e(m.nullPolyfill,"__proto__",n),o},Object.defineProperty(a,"level",{configurable:!1,enumerable:!1,writable:!1,value:t.level})):null}(function(){var t,a=Object.create(null),r={},m=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(m){try{(t=m.set).call(a,r)}catch{}if(Object.getPrototypeOf(a)===r)return{set:t,level:2}}return a.__proto__=r,Object.getPrototypeOf(a)===r?{level:2}:((a={}).__proto__=r,Object.getPrototypeOf(a)===r&&{level:1})}()),v("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(v,J,Z){J.exports=function(p){if(typeof p!="function")throw new TypeError(p+" is not a function");return p}},{}],161:[function(v,J,Z){var p=v("./is-object");J.exports=function(g){if(!p(g))throw new TypeError(g+" is not an Object");return g}},{"./is-object":150}],162:[function(v,J,Z){var p=v("./is-value");J.exports=function(g){if(!p(g))throw new TypeError("Cannot use null or undefined");return g}},{"./is-value":151}],163:[function(v,J,Z){J.exports=v("./is-implemented")()?String.prototype.contains:v("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(v,J,Z){var p="razdwatrzy";J.exports=function(){return typeof p.contains=="function"&&p.contains("dwa")===!0&&p.contains("foo")===!1}},{}],165:[function(v,J,Z){var p=String.prototype.indexOf;J.exports=function(g){return p.call(this,g,arguments[1])>-1}},{}],166:[function(v,J,Z){var p=Object.prototype.toString,g=p.call("");J.exports=function(b){return typeof b=="string"||b&&typeof b=="object"&&(b instanceof String||p.call(b)===g)||!1}},{}],167:[function(v,J,Z){var p=Object.create(null),g=Math.random;J.exports=function(){var b;do b=g().toString(36).slice(2);while(p[b]);return b}},{}],168:[function(v,J,Z){var p,g=v("es5-ext/object/set-prototype-of"),b=v("es5-ext/string/#/contains"),y=v("d"),e=v("es6-symbol"),n=v("./"),t=Object.defineProperty;p=J.exports=function(a,r){if(!(this instanceof p))throw new TypeError("Constructor requires 'new'");n.call(this,a),r=r?b.call(r,"key+value")?"key+value":b.call(r,"key")?"key":"value":"value",t(this,"__kind__",y("",r))},g&&g(p,n),delete p.prototype.constructor,p.prototype=Object.create(n.prototype,{_resolve:y(function(a){return this.__kind__==="value"?this.__list__[a]:this.__kind__==="key+value"?[a,this.__list__[a]]:a})}),t(p.prototype,e.toStringTag,y("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(v,J,Z){var p=v("es5-ext/function/is-arguments"),g=v("es5-ext/object/valid-callable"),b=v("es5-ext/string/is-string"),y=v("./get"),e=Array.isArray,n=Function.prototype.call,t=Array.prototype.some;J.exports=function(a,r){var m,o,i,u,f,l,h,d,s=arguments[2];if(e(a)||p(a)?m="array":b(a)?m="string":a=y(a),g(r),i=function(){u=!0},m!=="array")if(m!=="string")for(o=a.next();!o.done;){if(n.call(r,s,o.value,i),u)return;o=a.next()}else for(l=a.length,f=0;f<l&&(h=a[f],f+1<l&&(d=h.charCodeAt(0))>=55296&&d<=56319&&(h+=a[++f]),n.call(r,s,h,i),!u);++f);else t.call(a,function(x){return n.call(r,s,x,i),u})}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(v,J,Z){var p=v("es5-ext/function/is-arguments"),g=v("es5-ext/string/is-string"),b=v("./array"),y=v("./string"),e=v("./valid-iterable"),n=v("es6-symbol").iterator;J.exports=function(t){return typeof e(t)[n]=="function"?t[n]():p(t)?new b(t):g(t)?new y(t):new b(t)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(v,J,Z){var p,g=v("es5-ext/array/#/clear"),b=v("es5-ext/object/assign"),y=v("es5-ext/object/valid-callable"),e=v("es5-ext/object/valid-value"),n=v("d"),t=v("d/auto-bind"),a=v("es6-symbol"),r=Object.defineProperty,m=Object.defineProperties;J.exports=p=function(o,i){if(!(this instanceof p))throw new TypeError("Constructor requires 'new'");m(this,{__list__:n("w",e(o)),__context__:n("w",i),__nextIndex__:n("w",0)}),i&&(y(i.on),i.on("_add",this._onAdd),i.on("_delete",this._onDelete),i.on("_clear",this._onClear))},delete p.prototype.constructor,m(p.prototype,b({_next:n(function(){var o;if(this.__list__)return this.__redo__&&(o=this.__redo__.shift())!==void 0?o:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:n(function(){return this._createResult(this._next())}),_createResult:n(function(o){return o===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(o)}}),_resolve:n(function(o){return this.__list__[o]}),_unBind:n(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:n(function(){return"[object "+(this[a.toStringTag]||"Object")+"]"})},t({_onAdd:n(function(o){o>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(i,u){i>=o&&(this.__redo__[u]=++i)},this),this.__redo__.push(o)):r(this,"__redo__",n("c",[o])))}),_onDelete:n(function(o){var i;o>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&((i=this.__redo__.indexOf(o))!==-1&&this.__redo__.splice(i,1),this.__redo__.forEach(function(u,f){u>o&&(this.__redo__[f]=--u)},this)))}),_onClear:n(function(){this.__redo__&&g.call(this.__redo__),this.__nextIndex__=0})}))),r(p.prototype,a.iterator,n(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(v,J,Z){var p=v("es5-ext/function/is-arguments"),g=v("es5-ext/object/is-value"),b=v("es5-ext/string/is-string"),y=v("es6-symbol").iterator,e=Array.isArray;J.exports=function(n){return!!g(n)&&(!!e(n)||!!b(n)||!!p(n)||typeof n[y]=="function")}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(v,J,Z){var p,g=v("es5-ext/object/set-prototype-of"),b=v("d"),y=v("es6-symbol"),e=v("./"),n=Object.defineProperty;p=J.exports=function(t){if(!(this instanceof p))throw new TypeError("Constructor requires 'new'");t=String(t),e.call(this,t),n(this,"__length__",b("",t.length))},g&&g(p,e),delete p.prototype.constructor,p.prototype=Object.create(e.prototype,{_next:b(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:b(function(t){var a,r=this.__list__[t];return this.__nextIndex__===this.__length__?r:(a=r.charCodeAt(0))>=55296&&a<=56319?r+this.__list__[this.__nextIndex__++]:r})}),n(p.prototype,y.toStringTag,b("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(v,J,Z){var p=v("./is-iterable");J.exports=function(g){if(!p(g))throw new TypeError(g+" is not iterable");return g}},{"./is-iterable":172}],175:[function(v,J,Z){J.exports=v("./is-implemented")()?v("ext/global-this").Symbol:v("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(v,J,Z){var p=v("ext/global-this"),g={object:!0,symbol:!0};J.exports=function(){var b,y=p.Symbol;if(typeof y!="function")return!1;b=y("test symbol");try{String(b)}catch{return!1}return!!g[typeof y.iterator]&&!!g[typeof y.toPrimitive]&&!!g[typeof y.toStringTag]}},{"ext/global-this":188}],177:[function(v,J,Z){J.exports=function(p){return!!p&&(typeof p=="symbol"||!!p.constructor&&p.constructor.name==="Symbol"&&p[p.constructor.toStringTag]==="Symbol")}},{}],178:[function(v,J,Z){var p=v("d"),g=Object.create,b=Object.defineProperty,y=Object.prototype,e=g(null);J.exports=function(n){for(var t,a,r=0;e[n+(r||"")];)++r;return e[n+=r||""]=!0,b(y,t="@@"+n,p.gs(null,function(m){a||(a=!0,b(this,t,p(m)),a=!1)})),t}},{d:106}],179:[function(v,J,Z){var p=v("d"),g=v("ext/global-this").Symbol;J.exports=function(b){return Object.defineProperties(b,{hasInstance:p("",g&&g.hasInstance||b("hasInstance")),isConcatSpreadable:p("",g&&g.isConcatSpreadable||b("isConcatSpreadable")),iterator:p("",g&&g.iterator||b("iterator")),match:p("",g&&g.match||b("match")),replace:p("",g&&g.replace||b("replace")),search:p("",g&&g.search||b("search")),species:p("",g&&g.species||b("species")),split:p("",g&&g.split||b("split")),toPrimitive:p("",g&&g.toPrimitive||b("toPrimitive")),toStringTag:p("",g&&g.toStringTag||b("toStringTag")),unscopables:p("",g&&g.unscopables||b("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(v,J,Z){var p=v("d"),g=v("../../../validate-symbol"),b=Object.create(null);J.exports=function(y){return Object.defineProperties(y,{for:p(function(e){return b[e]?b[e]:b[e]=y(String(e))}),keyFor:p(function(e){var n;for(n in g(e),b)if(b[n]===e)return n})})}},{"../../../validate-symbol":182,d:106}],181:[function(v,J,Z){var p,g,b,y=v("d"),e=v("./validate-symbol"),n=v("ext/global-this").Symbol,t=v("./lib/private/generate-name"),a=v("./lib/private/setup/standard-symbols"),r=v("./lib/private/setup/symbol-registry"),m=Object.create,o=Object.defineProperties,i=Object.defineProperty;if(typeof n=="function")try{String(n()),b=!0}catch{}else n=null;g=function(u){if(this instanceof g)throw new TypeError("Symbol is not a constructor");return p(u)},J.exports=p=function u(f){var l;if(this instanceof u)throw new TypeError("Symbol is not a constructor");return b?n(f):(l=m(g.prototype),f=f===void 0?"":String(f),o(l,{__description__:y("",f),__name__:y("",t(f))}))},a(p),r(p),o(g.prototype,{constructor:y(p),toString:y("",function(){return this.__name__})}),o(p.prototype,{toString:y(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:y(function(){return e(this)})}),i(p.prototype,p.toPrimitive,y("",function(){var u=e(this);return typeof u=="symbol"?u:u.toString()})),i(p.prototype,p.toStringTag,y("c","Symbol")),i(g.prototype,p.toStringTag,y("c",p.prototype[p.toStringTag])),i(g.prototype,p.toPrimitive,y("c",p.prototype[p.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(v,J,Z){var p=v("./is-symbol");J.exports=function(g){if(!p(g))throw new TypeError(g+" is not a symbol");return g}},{"./is-symbol":177}],183:[function(v,J,Z){J.exports=v("./is-implemented")()?WeakMap:v("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(v,J,Z){J.exports=function(){var p,g;if(typeof WeakMap!="function")return!1;try{p=new WeakMap([[g={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return String(p)==="[object WeakMap]"&&typeof p.set=="function"&&p.set({},1)===p&&typeof p.delete=="function"&&typeof p.has=="function"&&p.get(g)==="one"}},{}],185:[function(v,J,Z){J.exports=typeof WeakMap=="function"&&Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"},{}],186:[function(v,J,Z){var p,g=v("es5-ext/object/is-value"),b=v("es5-ext/object/set-prototype-of"),y=v("es5-ext/object/valid-object"),e=v("es5-ext/object/valid-value"),n=v("es5-ext/string/random-uniq"),t=v("d"),a=v("es6-iterator/get"),r=v("es6-iterator/for-of"),m=v("es6-symbol").toStringTag,o=v("./is-native-implemented"),i=Array.isArray,u=Object.defineProperty,f=Object.prototype.hasOwnProperty,l=Object.getPrototypeOf;J.exports=p=function(){var h,d=arguments[0];if(!(this instanceof p))throw new TypeError("Constructor requires 'new'");return h=o&&b&&WeakMap!==p?b(new WeakMap,l(this)):this,g(d)&&(i(d)||(d=a(d))),u(h,"__weakMapData__",t("c","$weakMap$"+n())),d&&r(d,function(s){e(s),h.set(s[0],s[1])}),h},o&&(b&&b(p,WeakMap),p.prototype=Object.create(WeakMap.prototype,{constructor:t(p)})),Object.defineProperties(p.prototype,{delete:t(function(h){return!!f.call(y(h),this.__weakMapData__)&&(delete h[this.__weakMapData__],!0)}),get:t(function(h){if(f.call(y(h),this.__weakMapData__))return h[this.__weakMapData__]}),has:t(function(h){return f.call(y(h),this.__weakMapData__)}),set:t(function(h,d){return u(y(h),this.__weakMapData__,t("c",d)),this}),toString:t(function(){return"[object WeakMap]"})}),u(p.prototype,m,t("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(v,J,Z){var p=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};J.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return p()}try{return __global__||p()}finally{delete Object.prototype.__global__}}()},{}],188:[function(v,J,Z){J.exports=v("./is-implemented")()?globalThis:v("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(v,J,Z){J.exports=function(){return typeof globalThis=="object"&&!!globalThis&&globalThis.Array===Array}},{}],190:[function(v,J,Z){var p=v("is-string-blank");J.exports=function(g){var b=typeof g;if(b==="string"){var y=g;if((g=+g)==0&&p(y))return!1}else if(b!=="number")return!1;return g-g<1}},{"is-string-blank":237}],191:[function(v,J,Z){var p=v("dtype");J.exports=function(g,b,y){if(!g)throw new TypeError("must specify data as first parameter");if(y=0|+(y||0),Array.isArray(g)&&g[0]&&typeof g[0][0]=="number"){var e,n,t,a,r=g[0].length,m=g.length*r;b&&typeof b!="string"||(b=new(p(b||"float32"))(m+y));var o=b.length-y;if(m!==o)throw new Error("source length "+m+" ("+r+"x"+g.length+") does not match destination length "+o);for(e=0,t=y;e<g.length;e++)for(n=0;n<r;n++)b[t++]=g[e][n]===null?NaN:g[e][n]}else if(b&&typeof b!="string")b.set(g,y);else{var i=p(b||"float32");if(Array.isArray(g)||b==="array")for(b=new i(g.length+y),e=0,t=y,a=b.length;t<a;t++,e++)b[t]=g[e]===null?NaN:g[e];else y===0?b=new i(g):(b=new i(g.length+y)).set(g,y)}return b}},{dtype:127}],192:[function(v,J,Z){var p=v("css-font/stringify"),g=[32,126];J.exports=function(b){var y=(b=b||{}).shape?b.shape:b.canvas?[b.canvas.width,b.canvas.height]:[512,512],e=b.canvas||document.createElement("canvas"),n=b.font,t=typeof b.step=="number"?[b.step,b.step]:b.step||[32,32],a=b.chars||g;if(n&&typeof n!="string"&&(n=p(n)),Array.isArray(a)){if(a.length===2&&typeof a[0]=="number"&&typeof a[1]=="number"){for(var r=[],m=a[0],o=0;m<=a[1];m++)r[o++]=String.fromCharCode(m);a=r}}else a=String(a).split("");y=y.slice(),e.width=y[0],e.height=y[1];var i=e.getContext("2d");i.fillStyle="#000",i.fillRect(0,0,e.width,e.height),i.font=n,i.textAlign="center",i.textBaseline="middle",i.fillStyle="#fff";var u=t[0]/2,f=t[1]/2;for(m=0;m<a.length;m++)i.fillText(a[m],u,f),(u+=t[0])>y[0]-t[0]/2&&(u=t[0]/2,f+=t[1]);return e}},{"css-font/stringify":102}],193:[function(v,J,Z){function p(e,n){n||(n={}),(typeof e=="string"||Array.isArray(e))&&(n.family=e);var t=Array.isArray(n.family)?n.family.join(", "):n.family;if(!t)throw Error("`family` must be defined");var a=n.size||n.fontSize||n.em||48,r=n.weight||n.fontWeight||"",m=(e=[n.style||n.fontStyle||"",r,a].join(" ")+"px "+t,n.origin||"top");if(p.cache[t]&&a<=p.cache[t].em)return g(p.cache[t],m);var o=n.canvas||p.canvas,i=o.getContext("2d"),u={upper:n.upper!==void 0?n.upper:"H",lower:n.lower!==void 0?n.lower:"x",descent:n.descent!==void 0?n.descent:"p",ascent:n.ascent!==void 0?n.ascent:"h",tittle:n.tittle!==void 0?n.tittle:"i",overshoot:n.overshoot!==void 0?n.overshoot:"O"},f=Math.ceil(1.5*a);o.height=f,o.width=.5*f,i.font=e;var l={top:0};i.clearRect(0,0,f,f),i.textBaseline="top",i.fillStyle="black",i.fillText("H",0,0);var h=b(i.getImageData(0,0,f,f));i.clearRect(0,0,f,f),i.textBaseline="bottom",i.fillText("H",0,f);var d=b(i.getImageData(0,0,f,f));l.lineHeight=l.bottom=f-d+h,i.clearRect(0,0,f,f),i.textBaseline="alphabetic",i.fillText("H",0,f);var s=f-b(i.getImageData(0,0,f,f))-1+h;l.baseline=l.alphabetic=s,i.clearRect(0,0,f,f),i.textBaseline="middle",i.fillText("H",0,.5*f);var x=b(i.getImageData(0,0,f,f));l.median=l.middle=f-x-1+h-.5*f,i.clearRect(0,0,f,f),i.textBaseline="hanging",i.fillText("H",0,.5*f);var c=b(i.getImageData(0,0,f,f));l.hanging=f-c-1+h-.5*f,i.clearRect(0,0,f,f),i.textBaseline="ideographic",i.fillText("H",0,f);var T=b(i.getImageData(0,0,f,f));if(l.ideographic=f-T-1+h,u.upper&&(i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.upper,0,0),l.upper=b(i.getImageData(0,0,f,f)),l.capHeight=l.baseline-l.upper),u.lower&&(i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.lower,0,0),l.lower=b(i.getImageData(0,0,f,f)),l.xHeight=l.baseline-l.lower),u.tittle&&(i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.tittle,0,0),l.tittle=b(i.getImageData(0,0,f,f))),u.ascent&&(i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.ascent,0,0),l.ascent=b(i.getImageData(0,0,f,f))),u.descent&&(i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.descent,0,0),l.descent=y(i.getImageData(0,0,f,f))),u.overshoot){i.clearRect(0,0,f,f),i.textBaseline="top",i.fillText(u.overshoot,0,0);var _=y(i.getImageData(0,0,f,f));l.overshoot=_-s}for(var w in l)l[w]/=a;return l.em=a,p.cache[t]=l,g(l,m)}function g(e,n){var t={};for(var a in typeof n=="string"&&(n=e[n]),e)a!=="em"&&(t[a]=e[a]-n);return t}function b(e){for(var n=e.height,t=e.data,a=3;a<t.length;a+=4)if(t[a]!==0)return Math.floor(.25*(a-3)/n)}function y(e){for(var n=e.height,t=e.data,a=t.length-1;a>0;a-=4)if(t[a]!==0)return Math.floor(.25*(a-3)/n)}J.exports=p,p.canvas=document.createElement("canvas"),p.cache={}},{}],194:[function(v,J,Z){J.exports=function(p,g){if(typeof p!="string")throw new TypeError("must specify type string");if(g=g||{},typeof document>"u"&&!g.canvas)return null;var b=g.canvas||document.createElement("canvas");typeof g.width=="number"&&(b.width=g.width),typeof g.height=="number"&&(b.height=g.height);var y,e=g;try{var n=[p];p.indexOf("webgl")===0&&n.push("experimental-"+p);for(var t=0;t<n.length;t++)if(y=b.getContext(n[t],e))return y}catch{y=null}return y||null}},{}],195:[function(v,J,Z){J.exports=function(p,g){var b=g[0],y=g[1],e=g[2],n=g[3],t=g[4],a=g[5],r=g[6],m=g[7],o=g[8],i=g[9],u=g[10],f=g[11],l=g[12],h=g[13],d=g[14],s=g[15];return p[0]=a*(u*s-f*d)-i*(r*s-m*d)+h*(r*f-m*u),p[1]=-(y*(u*s-f*d)-i*(e*s-n*d)+h*(e*f-n*u)),p[2]=y*(r*s-m*d)-a*(e*s-n*d)+h*(e*m-n*r),p[3]=-(y*(r*f-m*u)-a*(e*f-n*u)+i*(e*m-n*r)),p[4]=-(t*(u*s-f*d)-o*(r*s-m*d)+l*(r*f-m*u)),p[5]=b*(u*s-f*d)-o*(e*s-n*d)+l*(e*f-n*u),p[6]=-(b*(r*s-m*d)-t*(e*s-n*d)+l*(e*m-n*r)),p[7]=b*(r*f-m*u)-t*(e*f-n*u)+o*(e*m-n*r),p[8]=t*(i*s-f*h)-o*(a*s-m*h)+l*(a*f-m*i),p[9]=-(b*(i*s-f*h)-o*(y*s-n*h)+l*(y*f-n*i)),p[10]=b*(a*s-m*h)-t*(y*s-n*h)+l*(y*m-n*a),p[11]=-(b*(a*f-m*i)-t*(y*f-n*i)+o*(y*m-n*a)),p[12]=-(t*(i*d-u*h)-o*(a*d-r*h)+l*(a*u-r*i)),p[13]=b*(i*d-u*h)-o*(y*d-e*h)+l*(y*u-e*i),p[14]=-(b*(a*d-r*h)-t*(y*d-e*h)+l*(y*r-e*a)),p[15]=b*(a*u-r*i)-t*(y*u-e*i)+o*(y*r-e*a),p}},{}],196:[function(v,J,Z){J.exports=function(p){var g=new Float32Array(16);return g[0]=p[0],g[1]=p[1],g[2]=p[2],g[3]=p[3],g[4]=p[4],g[5]=p[5],g[6]=p[6],g[7]=p[7],g[8]=p[8],g[9]=p[9],g[10]=p[10],g[11]=p[11],g[12]=p[12],g[13]=p[13],g[14]=p[14],g[15]=p[15],g}},{}],197:[function(v,J,Z){J.exports=function(p,g){return p[0]=g[0],p[1]=g[1],p[2]=g[2],p[3]=g[3],p[4]=g[4],p[5]=g[5],p[6]=g[6],p[7]=g[7],p[8]=g[8],p[9]=g[9],p[10]=g[10],p[11]=g[11],p[12]=g[12],p[13]=g[13],p[14]=g[14],p[15]=g[15],p}},{}],198:[function(v,J,Z){J.exports=function(){var p=new Float32Array(16);return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}},{}],199:[function(v,J,Z){J.exports=function(p){var g=p[0],b=p[1],y=p[2],e=p[3],n=p[4],t=p[5],a=p[6],r=p[7],m=p[8],o=p[9],i=p[10],u=p[11],f=p[12],l=p[13],h=p[14],d=p[15];return(g*t-b*n)*(i*d-u*h)-(g*a-y*n)*(o*d-u*l)+(g*r-e*n)*(o*h-i*l)+(b*a-y*t)*(m*d-u*f)-(b*r-e*t)*(m*h-i*f)+(y*r-e*a)*(m*l-o*f)}},{}],200:[function(v,J,Z){J.exports=function(p,g){var b=g[0],y=g[1],e=g[2],n=g[3],t=b+b,a=y+y,r=e+e,m=b*t,o=y*t,i=y*a,u=e*t,f=e*a,l=e*r,h=n*t,d=n*a,s=n*r;return p[0]=1-i-l,p[1]=o+s,p[2]=u-d,p[3]=0,p[4]=o-s,p[5]=1-m-l,p[6]=f+h,p[7]=0,p[8]=u+d,p[9]=f-h,p[10]=1-m-i,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}},{}],201:[function(v,J,Z){J.exports=function(p,g,b){var y,e,n,t=b[0],a=b[1],r=b[2],m=Math.sqrt(t*t+a*a+r*r);return Math.abs(m)<1e-6?null:(t*=m=1/m,a*=m,r*=m,y=Math.sin(g),e=Math.cos(g),n=1-e,p[0]=t*t*n+e,p[1]=a*t*n+r*y,p[2]=r*t*n-a*y,p[3]=0,p[4]=t*a*n-r*y,p[5]=a*a*n+e,p[6]=r*a*n+t*y,p[7]=0,p[8]=t*r*n+a*y,p[9]=a*r*n-t*y,p[10]=r*r*n+e,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p)}},{}],202:[function(v,J,Z){J.exports=function(p,g,b){var y=g[0],e=g[1],n=g[2],t=g[3],a=y+y,r=e+e,m=n+n,o=y*a,i=y*r,u=y*m,f=e*r,l=e*m,h=n*m,d=t*a,s=t*r,x=t*m;return p[0]=1-(f+h),p[1]=i+x,p[2]=u-s,p[3]=0,p[4]=i-x,p[5]=1-(o+h),p[6]=l+d,p[7]=0,p[8]=u+s,p[9]=l-d,p[10]=1-(o+f),p[11]=0,p[12]=b[0],p[13]=b[1],p[14]=b[2],p[15]=1,p}},{}],203:[function(v,J,Z){J.exports=function(p,g){return p[0]=g[0],p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=g[1],p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=g[2],p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}},{}],204:[function(v,J,Z){J.exports=function(p,g){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=g[0],p[13]=g[1],p[14]=g[2],p[15]=1,p}},{}],205:[function(v,J,Z){J.exports=function(p,g){var b=Math.sin(g),y=Math.cos(g);return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=y,p[6]=b,p[7]=0,p[8]=0,p[9]=-b,p[10]=y,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}},{}],206:[function(v,J,Z){J.exports=function(p,g){var b=Math.sin(g),y=Math.cos(g);return p[0]=y,p[1]=0,p[2]=-b,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=b,p[9]=0,p[10]=y,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}},{}],207:[function(v,J,Z){J.exports=function(p,g){var b=Math.sin(g),y=Math.cos(g);return p[0]=y,p[1]=b,p[2]=0,p[3]=0,p[4]=-b,p[5]=y,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}},{}],208:[function(v,J,Z){J.exports=function(p,g,b,y,e,n,t){var a=1/(b-g),r=1/(e-y),m=1/(n-t);return p[0]=2*n*a,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=2*n*r,p[6]=0,p[7]=0,p[8]=(b+g)*a,p[9]=(e+y)*r,p[10]=(t+n)*m,p[11]=-1,p[12]=0,p[13]=0,p[14]=t*n*2*m,p[15]=0,p}},{}],209:[function(v,J,Z){J.exports=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}},{}],210:[function(v,J,Z){J.exports={create:v("./create"),clone:v("./clone"),copy:v("./copy"),identity:v("./identity"),transpose:v("./transpose"),invert:v("./invert"),adjoint:v("./adjoint"),determinant:v("./determinant"),multiply:v("./multiply"),translate:v("./translate"),scale:v("./scale"),rotate:v("./rotate"),rotateX:v("./rotateX"),rotateY:v("./rotateY"),rotateZ:v("./rotateZ"),fromRotation:v("./fromRotation"),fromRotationTranslation:v("./fromRotationTranslation"),fromScaling:v("./fromScaling"),fromTranslation:v("./fromTranslation"),fromXRotation:v("./fromXRotation"),fromYRotation:v("./fromYRotation"),fromZRotation:v("./fromZRotation"),fromQuat:v("./fromQuat"),frustum:v("./frustum"),perspective:v("./perspective"),perspectiveFromFieldOfView:v("./perspectiveFromFieldOfView"),ortho:v("./ortho"),lookAt:v("./lookAt"),str:v("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(v,J,Z){J.exports=function(p,g){var b=g[0],y=g[1],e=g[2],n=g[3],t=g[4],a=g[5],r=g[6],m=g[7],o=g[8],i=g[9],u=g[10],f=g[11],l=g[12],h=g[13],d=g[14],s=g[15],x=b*a-y*t,c=b*r-e*t,T=b*m-n*t,_=y*r-e*a,w=y*m-n*a,k=e*m-n*r,L=o*h-i*l,A=o*d-u*l,I=o*s-f*l,P=i*d-u*h,S=i*s-f*h,E=u*s-f*d,D=x*E-c*S+T*P+_*I-w*A+k*L;return D?(D=1/D,p[0]=(a*E-r*S+m*P)*D,p[1]=(e*S-y*E-n*P)*D,p[2]=(h*k-d*w+s*_)*D,p[3]=(u*w-i*k-f*_)*D,p[4]=(r*I-t*E-m*A)*D,p[5]=(b*E-e*I+n*A)*D,p[6]=(d*T-l*k-s*c)*D,p[7]=(o*k-u*T+f*c)*D,p[8]=(t*S-a*I+m*L)*D,p[9]=(y*I-b*S-n*L)*D,p[10]=(l*w-h*T+s*x)*D,p[11]=(i*T-o*w-f*x)*D,p[12]=(a*A-t*P-r*L)*D,p[13]=(b*P-y*A+e*L)*D,p[14]=(h*c-l*_-d*x)*D,p[15]=(o*_-i*c+u*x)*D,p):null}},{}],212:[function(v,J,Z){var p=v("./identity");J.exports=function(g,b,y,e){var n,t,a,r,m,o,i,u,f,l,h=b[0],d=b[1],s=b[2],x=e[0],c=e[1],T=e[2],_=y[0],w=y[1],k=y[2];return Math.abs(h-_)<1e-6&&Math.abs(d-w)<1e-6&&Math.abs(s-k)<1e-6?p(g):(i=h-_,u=d-w,f=s-k,l=1/Math.sqrt(i*i+u*u+f*f),n=c*(f*=l)-T*(u*=l),t=T*(i*=l)-x*f,a=x*u-c*i,(l=Math.sqrt(n*n+t*t+a*a))?(n*=l=1/l,t*=l,a*=l):(n=0,t=0,a=0),r=u*a-f*t,m=f*n-i*a,o=i*t-u*n,(l=Math.sqrt(r*r+m*m+o*o))?(r*=l=1/l,m*=l,o*=l):(r=0,m=0,o=0),g[0]=n,g[1]=r,g[2]=i,g[3]=0,g[4]=t,g[5]=m,g[6]=u,g[7]=0,g[8]=a,g[9]=o,g[10]=f,g[11]=0,g[12]=-(n*h+t*d+a*s),g[13]=-(r*h+m*d+o*s),g[14]=-(i*h+u*d+f*s),g[15]=1,g)}},{"./identity":209}],213:[function(v,J,Z){J.exports=function(p,g,b){var y=g[0],e=g[1],n=g[2],t=g[3],a=g[4],r=g[5],m=g[6],o=g[7],i=g[8],u=g[9],f=g[10],l=g[11],h=g[12],d=g[13],s=g[14],x=g[15],c=b[0],T=b[1],_=b[2],w=b[3];return p[0]=c*y+T*a+_*i+w*h,p[1]=c*e+T*r+_*u+w*d,p[2]=c*n+T*m+_*f+w*s,p[3]=c*t+T*o+_*l+w*x,c=b[4],T=b[5],_=b[6],w=b[7],p[4]=c*y+T*a+_*i+w*h,p[5]=c*e+T*r+_*u+w*d,p[6]=c*n+T*m+_*f+w*s,p[7]=c*t+T*o+_*l+w*x,c=b[8],T=b[9],_=b[10],w=b[11],p[8]=c*y+T*a+_*i+w*h,p[9]=c*e+T*r+_*u+w*d,p[10]=c*n+T*m+_*f+w*s,p[11]=c*t+T*o+_*l+w*x,c=b[12],T=b[13],_=b[14],w=b[15],p[12]=c*y+T*a+_*i+w*h,p[13]=c*e+T*r+_*u+w*d,p[14]=c*n+T*m+_*f+w*s,p[15]=c*t+T*o+_*l+w*x,p}},{}],214:[function(v,J,Z){J.exports=function(p,g,b,y,e,n,t){var a=1/(g-b),r=1/(y-e),m=1/(n-t);return p[0]=-2*a,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=-2*r,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=2*m,p[11]=0,p[12]=(g+b)*a,p[13]=(e+y)*r,p[14]=(t+n)*m,p[15]=1,p}},{}],215:[function(v,J,Z){J.exports=function(p,g,b,y,e){var n=1/Math.tan(g/2),t=1/(y-e);return p[0]=n/b,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=n,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=(e+y)*t,p[11]=-1,p[12]=0,p[13]=0,p[14]=2*e*y*t,p[15]=0,p}},{}],216:[function(v,J,Z){J.exports=function(p,g,b,y){var e=Math.tan(g.upDegrees*Math.PI/180),n=Math.tan(g.downDegrees*Math.PI/180),t=Math.tan(g.leftDegrees*Math.PI/180),a=Math.tan(g.rightDegrees*Math.PI/180),r=2/(t+a),m=2/(e+n);return p[0]=r,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=m,p[6]=0,p[7]=0,p[8]=-(t-a)*r*.5,p[9]=(e-n)*m*.5,p[10]=y/(b-y),p[11]=-1,p[12]=0,p[13]=0,p[14]=y*b/(b-y),p[15]=0,p}},{}],217:[function(v,J,Z){J.exports=function(p,g,b,y){var e,n,t,a,r,m,o,i,u,f,l,h,d,s,x,c,T,_,w,k,L,A,I,P,S=y[0],E=y[1],D=y[2],R=Math.sqrt(S*S+E*E+D*D);return Math.abs(R)<1e-6?null:(S*=R=1/R,E*=R,D*=R,e=Math.sin(b),n=Math.cos(b),t=1-n,a=g[0],r=g[1],m=g[2],o=g[3],i=g[4],u=g[5],f=g[6],l=g[7],h=g[8],d=g[9],s=g[10],x=g[11],c=S*S*t+n,T=E*S*t+D*e,_=D*S*t-E*e,w=S*E*t-D*e,k=E*E*t+n,L=D*E*t+S*e,A=S*D*t+E*e,I=E*D*t-S*e,P=D*D*t+n,p[0]=a*c+i*T+h*_,p[1]=r*c+u*T+d*_,p[2]=m*c+f*T+s*_,p[3]=o*c+l*T+x*_,p[4]=a*w+i*k+h*L,p[5]=r*w+u*k+d*L,p[6]=m*w+f*k+s*L,p[7]=o*w+l*k+x*L,p[8]=a*A+i*I+h*P,p[9]=r*A+u*I+d*P,p[10]=m*A+f*I+s*P,p[11]=o*A+l*I+x*P,g!==p&&(p[12]=g[12],p[13]=g[13],p[14]=g[14],p[15]=g[15]),p)}},{}],218:[function(v,J,Z){J.exports=function(p,g,b){var y=Math.sin(b),e=Math.cos(b),n=g[4],t=g[5],a=g[6],r=g[7],m=g[8],o=g[9],i=g[10],u=g[11];return g!==p&&(p[0]=g[0],p[1]=g[1],p[2]=g[2],p[3]=g[3],p[12]=g[12],p[13]=g[13],p[14]=g[14],p[15]=g[15]),p[4]=n*e+m*y,p[5]=t*e+o*y,p[6]=a*e+i*y,p[7]=r*e+u*y,p[8]=m*e-n*y,p[9]=o*e-t*y,p[10]=i*e-a*y,p[11]=u*e-r*y,p}},{}],219:[function(v,J,Z){J.exports=function(p,g,b){var y=Math.sin(b),e=Math.cos(b),n=g[0],t=g[1],a=g[2],r=g[3],m=g[8],o=g[9],i=g[10],u=g[11];return g!==p&&(p[4]=g[4],p[5]=g[5],p[6]=g[6],p[7]=g[7],p[12]=g[12],p[13]=g[13],p[14]=g[14],p[15]=g[15]),p[0]=n*e-m*y,p[1]=t*e-o*y,p[2]=a*e-i*y,p[3]=r*e-u*y,p[8]=n*y+m*e,p[9]=t*y+o*e,p[10]=a*y+i*e,p[11]=r*y+u*e,p}},{}],220:[function(v,J,Z){J.exports=function(p,g,b){var y=Math.sin(b),e=Math.cos(b),n=g[0],t=g[1],a=g[2],r=g[3],m=g[4],o=g[5],i=g[6],u=g[7];return g!==p&&(p[8]=g[8],p[9]=g[9],p[10]=g[10],p[11]=g[11],p[12]=g[12],p[13]=g[13],p[14]=g[14],p[15]=g[15]),p[0]=n*e+m*y,p[1]=t*e+o*y,p[2]=a*e+i*y,p[3]=r*e+u*y,p[4]=m*e-n*y,p[5]=o*e-t*y,p[6]=i*e-a*y,p[7]=u*e-r*y,p}},{}],221:[function(v,J,Z){J.exports=function(p,g,b){var y=b[0],e=b[1],n=b[2];return p[0]=g[0]*y,p[1]=g[1]*y,p[2]=g[2]*y,p[3]=g[3]*y,p[4]=g[4]*e,p[5]=g[5]*e,p[6]=g[6]*e,p[7]=g[7]*e,p[8]=g[8]*n,p[9]=g[9]*n,p[10]=g[10]*n,p[11]=g[11]*n,p[12]=g[12],p[13]=g[13],p[14]=g[14],p[15]=g[15],p}},{}],222:[function(v,J,Z){J.exports=function(p){return"mat4("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+", "+p[6]+", "+p[7]+", "+p[8]+", "+p[9]+", "+p[10]+", "+p[11]+", "+p[12]+", "+p[13]+", "+p[14]+", "+p[15]+")"}},{}],223:[function(v,J,Z){J.exports=function(p,g,b){var y,e,n,t,a,r,m,o,i,u,f,l,h=b[0],d=b[1],s=b[2];return g===p?(p[12]=g[0]*h+g[4]*d+g[8]*s+g[12],p[13]=g[1]*h+g[5]*d+g[9]*s+g[13],p[14]=g[2]*h+g[6]*d+g[10]*s+g[14],p[15]=g[3]*h+g[7]*d+g[11]*s+g[15]):(y=g[0],e=g[1],n=g[2],t=g[3],a=g[4],r=g[5],m=g[6],o=g[7],i=g[8],u=g[9],f=g[10],l=g[11],p[0]=y,p[1]=e,p[2]=n,p[3]=t,p[4]=a,p[5]=r,p[6]=m,p[7]=o,p[8]=i,p[9]=u,p[10]=f,p[11]=l,p[12]=y*h+a*d+i*s+g[12],p[13]=e*h+r*d+u*s+g[13],p[14]=n*h+m*d+f*s+g[14],p[15]=t*h+o*d+l*s+g[15]),p}},{}],224:[function(v,J,Z){J.exports=function(p,g){if(p===g){var b=g[1],y=g[2],e=g[3],n=g[6],t=g[7],a=g[11];p[1]=g[4],p[2]=g[8],p[3]=g[12],p[4]=b,p[6]=g[9],p[7]=g[13],p[8]=y,p[9]=n,p[11]=g[14],p[12]=e,p[13]=t,p[14]=a}else p[0]=g[0],p[1]=g[4],p[2]=g[8],p[3]=g[12],p[4]=g[1],p[5]=g[5],p[6]=g[9],p[7]=g[13],p[8]=g[2],p[9]=g[6],p[10]=g[10],p[11]=g[14],p[12]=g[3],p[13]=g[7],p[14]=g[11],p[15]=g[15];return p}},{}],225:[function(v,J,Z){var p=v("css-font"),g=v("pick-by-alias"),b=v("regl"),y=v("gl-util/context"),e=v("es6-weak-map"),n=v("color-normalize"),t=v("font-atlas"),a=v("typedarray-pool"),r=v("parse-rect"),m=v("is-plain-obj"),o=v("parse-unit"),i=v("to-px"),u=v("detect-kerning"),f=v("object-assign"),l=v("font-measure"),h=v("flatten-vertex-data"),d=v("bit-twiddle").nextPow2,s=new e,x=!1;if(document.body){var c=document.body.appendChild(document.createElement("div"));c.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(c).fontStretch&&(x=!0),document.body.removeChild(c)}var T=function(_){(function(w){return typeof w=="function"&&w._gl&&w.prop&&w.texture&&w.buffer})(_)?(_={regl:_},this.gl=_.regl._gl):this.gl=y(_),this.shader=s.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=_.regl||b({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),s.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(m(_)?_:{})};T.prototype.createShader=function(){var _=this.regl,w=_({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:_.prop("count"),offset:_.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:_.this("sizeBuffer")},width:{offset:0,stride:8,buffer:_.this("sizeBuffer")},char:_.this("charBuffer"),position:_.this("position")},uniforms:{atlasSize:function(k,L){return[L.atlas.width,L.atlas.height]},atlasDim:function(k,L){return[L.atlas.cols,L.atlas.rows]},atlas:function(k,L){return L.atlas.texture},charStep:function(k,L){return L.atlas.step},em:function(k,L){return L.atlas.em},color:_.prop("color"),opacity:_.prop("opacity"),viewport:_.this("viewportArray"),scale:_.this("scale"),align:_.prop("align"),baseline:_.prop("baseline"),translate:_.this("translate"),positionOffset:_.prop("positionOffset")},primitive:"points",viewport:_.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`});return{regl:_,draw:w,atlas:{}}},T.prototype.update=function(_){var w=this;if(typeof _=="string")_={text:_};else if(!_)return;(_=g(_,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity!=null&&(Array.isArray(_.opacity)?this.opacity=_.opacity.map(function(ve){return parseFloat(ve)}):this.opacity=parseFloat(_.opacity)),_.viewport!=null&&(this.viewport=r(_.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),_.kerning!=null&&(this.kerning=_.kerning),_.offset!=null&&(typeof _.offset=="number"&&(_.offset=[_.offset,0]),this.positionOffset=h(_.offset)),_.direction&&(this.direction=_.direction),_.range&&(this.range=_.range,this.scale=[1/(_.range[2]-_.range[0]),1/(_.range[3]-_.range[1])],this.translate=[-_.range[0],-_.range[1]]),_.scale&&(this.scale=_.scale),_.translate&&(this.translate=_.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||_.font||(_.font=T.baseFontSize+"px sans-serif");var k,L=!1,A=!1;if(_.font&&(Array.isArray(_.font)?_.font:[_.font]).forEach(function(ve,Me){if(typeof ve=="string")try{ve=p.parse(ve)}catch{ve=p.parse(T.baseFontSize+"px "+ve)}else ve=p.parse(p.stringify(ve));var ke=p.stringify({size:T.baseFontSize,family:ve.family,stretch:x?ve.stretch:void 0,variant:ve.variant,weight:ve.weight,style:ve.style}),Le=o(ve.size),ze=Math.round(Le[0]*i(Le[1]));if(ze!==w.fontSize[Me]&&(A=!0,w.fontSize[Me]=ze),!(w.font[Me]&&ke==w.font[Me].baseString||(L=!0,w.font[Me]=T.fonts[ke],w.font[Me]))){var Re=ve.family.join(", "),Oe=[ve.style];ve.style!=ve.variant&&Oe.push(ve.variant),ve.variant!=ve.weight&&Oe.push(ve.weight),x&&ve.weight!=ve.stretch&&Oe.push(ve.stretch),w.font[Me]={baseString:ke,family:Re,weight:ve.weight,stretch:ve.stretch,style:ve.style,variant:ve.variant,width:{},kerning:{},metrics:l(Re,{origin:"top",fontSize:T.baseFontSize,fontStyle:Oe.join(" ")})},T.fonts[ke]=w.font[Me]}}),(L||A)&&this.font.forEach(function(ve,Me){var ke=p.stringify({size:w.fontSize[Me],family:ve.family,stretch:x?ve.stretch:void 0,variant:ve.variant,weight:ve.weight,style:ve.style});if(w.fontAtlas[Me]=w.shader.atlas[ke],!w.fontAtlas[Me]){var Le=ve.metrics;w.shader.atlas[ke]=w.fontAtlas[Me]={fontString:ke,step:2*Math.ceil(w.fontSize[Me]*Le.bottom*.5),em:w.fontSize[Me],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:w.regl.texture()}}_.text==null&&(_.text=w.text)}),typeof _.text=="string"&&_.position&&_.position.length>2){for(var I=Array(.5*_.position.length),P=0;P<I.length;P++)I[P]=_.text;_.text=I}if(_.text!=null||L){if(this.textOffsets=[0],Array.isArray(_.text)){this.count=_.text[0].length,this.counts=[this.count];for(var S=1;S<_.text.length;S++)this.textOffsets[S]=this.textOffsets[S-1]+_.text[S-1].length,this.count+=_.text[S].length,this.counts.push(_.text[S].length);this.text=_.text.join("")}else this.text=_.text,this.count=this.text.length,this.counts=[this.count];k=[],this.font.forEach(function(ve,Me){T.atlasContext.font=ve.baseString;for(var ke=w.fontAtlas[Me],Le=0;Le<w.text.length;Le++){var ze=w.text.charAt(Le);if(ke.ids[ze]==null&&(ke.ids[ze]=ke.chars.length,ke.chars.push(ze),k.push(ze)),ve.width[ze]==null&&(ve.width[ze]=T.atlasContext.measureText(ze).width/T.baseFontSize,w.kerning)){var Re=[];for(var Oe in ve.width)Re.push(Oe+ze,ze+Oe);f(ve.kerning,u(ve.family,{pairs:Re}))}}})}if(_.position)if(_.position.length>2){for(var E=!_.position[0].length,D=a.mallocFloat(2*this.count),R=0,H=0;R<this.counts.length;R++){var V=this.counts[R];if(E)for(var X=0;X<V;X++)D[H++]=_.position[2*R],D[H++]=_.position[2*R+1];else for(var $=0;$<V;$++)D[H++]=_.position[R][0],D[H++]=_.position[R][1]}this.position.call?this.position({type:"float",data:D}):this.position=this.regl.buffer({type:"float",data:D}),a.freeFloat(D)}else this.position.destroy&&this.position.destroy(),this.position={constant:_.position};if(_.text||L){var G=a.mallocUint8(this.count),W=a.mallocFloat(2*this.count);this.textWidth=[];for(var te=0,N=0;te<this.counts.length;te++){for(var B=this.counts[te],U=this.font[te]||this.font[0],ee=this.fontAtlas[te]||this.fontAtlas[0],j=0;j<B;j++){var Q=this.text.charAt(N),K=this.text.charAt(N-1);if(G[N]=ee.ids[Q],W[2*N]=U.width[Q],j){var re=W[2*N-2],ne=W[2*N],le=W[2*N-1]+.5*re+.5*ne;if(this.kerning){var oe=U.kerning[K+Q];oe&&(le+=.001*oe)}W[2*N+1]=le}else W[2*N+1]=.5*W[2*N];N++}this.textWidth.push(W.length?.5*W[2*N-2]+W[2*N-1]:0)}_.align||(_.align=this.align),this.charBuffer({data:G,type:"uint8",usage:"stream"}),this.sizeBuffer({data:W,type:"float",usage:"stream"}),a.freeUint8(G),a.freeFloat(W),k.length&&this.font.forEach(function(ve,Me){var ke=w.fontAtlas[Me],Le=ke.step,ze=Math.floor(T.maxAtlasSize/Le),Re=Math.min(ze,ke.chars.length),Oe=Math.ceil(ke.chars.length/Re),Ze=d(Re*Le),Pe=d(Oe*Le);ke.width=Ze,ke.height=Pe,ke.rows=Oe,ke.cols=Re,ke.em&&ke.texture({data:t({canvas:T.atlasCanvas,font:ke.fontString,chars:ke.chars,shape:[Ze,Pe],step:[Le,Le]})})})}if(_.align&&(this.align=_.align,this.alignOffset=this.textWidth.map(function(ve,Me){var ke=Array.isArray(w.align)?w.align.length>1?w.align[Me]:w.align[0]:w.align;if(typeof ke=="number")return ke;switch(ke){case"right":case"end":return-ve;case"center":case"centre":case"middle":return .5*-ve}return 0})),this.baseline==null&&_.baseline==null&&(_.baseline=0),_.baseline!=null&&(this.baseline=_.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(ve,Me){var ke=(w.font[Me]||w.font[0]).metrics,Le=0;return Le+=.5*ke.bottom,Le+=typeof ve=="number"?ve-ke.baseline:-ke[ve],Le*=-1})),_.color!=null)if(_.color||(_.color="transparent"),typeof _.color!="string"&&isNaN(_.color)){var de;if(typeof _.color[0]=="number"&&_.color.length>this.counts.length){var se=_.color.length;de=a.mallocUint8(se);for(var me=(_.color.subarray||_.color.slice).bind(_.color),Te=0;Te<se;Te+=4)de.set(n(me(Te,Te+4),"uint8"),Te)}else{var _e=_.color.length;de=a.mallocUint8(4*_e);for(var be=0;be<_e;be++)de.set(n(_.color[be]||0,"uint8"),4*be)}this.color=de}else this.color=n(_.color,"uint8");if(_.position||_.text||_.color||_.baseline||_.align||_.font||_.offset||_.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var Ce=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(Ce);for(var fe=0;fe<this.batch.length;fe++)this.batch[fe]={count:this.counts.length>1?this.counts[fe]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[fe]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*fe,4*fe+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[fe]:this.opacity,baseline:this.baselineOffset[fe]!=null?this.baselineOffset[fe]:this.baselineOffset[0],align:this.align?this.alignOffset[fe]!=null?this.alignOffset[fe]:this.alignOffset[0]:0,atlas:this.fontAtlas[fe]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*fe,2*fe+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]},T.prototype.destroy=function(){},T.prototype.kerning=!0,T.prototype.position={constant:new Float32Array(2)},T.prototype.translate=null,T.prototype.scale=null,T.prototype.font=null,T.prototype.text="",T.prototype.positionOffset=[0,0],T.prototype.opacity=1,T.prototype.color=new Uint8Array([0,0,0,255]),T.prototype.alignOffset=[0,0],T.maxAtlasSize=1024,T.atlasCanvas=document.createElement("canvas"),T.atlasContext=T.atlasCanvas.getContext("2d",{alpha:!1}),T.baseFontSize=64,T.fonts={},J.exports=T},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:284,"to-px":315,"typedarray-pool":328}],226:[function(v,J,Z){(function(p){(function(){var g=v("pick-by-alias");function b(n){if(n.container)if(n.container==document.body)document.body.style.width||(n.canvas.width=n.width||n.pixelRatio*p.innerWidth),document.body.style.height||(n.canvas.height=n.height||n.pixelRatio*p.innerHeight);else{var t=n.container.getBoundingClientRect();n.canvas.width=n.width||t.right-t.left,n.canvas.height=n.height||t.bottom-t.top}}function y(n){return typeof n.getContext=="function"&&"width"in n&&"height"in n}function e(){var n=document.createElement("canvas");return n.style.position="absolute",n.style.top=0,n.style.left=0,n}J.exports=function(n){var t;if(n?typeof n=="string"&&(n={container:n}):n={},y(n)?n={container:n}:n=typeof(t=n).nodeName=="string"&&typeof t.appendChild=="function"&&typeof t.getBoundingClientRect=="function"?{container:n}:function(r){return typeof r.drawArrays=="function"||typeof r.drawElements=="function"}(n)?{gl:n}:g(n,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),n.pixelRatio||(n.pixelRatio=p.pixelRatio||1),n.gl)return n.gl;if(n.canvas&&(n.container=n.canvas.parentNode),n.container){if(typeof n.container=="string"){var a=document.querySelector(n.container);if(!a)throw Error("Element "+n.container+" is not found");n.container=a}y(n.container)?(n.canvas=n.container,n.container=n.canvas.parentNode):n.canvas||(n.canvas=e(),n.container.appendChild(n.canvas),b(n))}else if(!n.canvas){if(typeof document>"u")throw Error("Not DOM environment. Use headless-gl.");n.container=document.body||document.documentElement,n.canvas=e(),n.container.appendChild(n.canvas),b(n)}return n.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(r){try{n.gl=n.canvas.getContext(r,n.attrs)}catch{}return n.gl}),n.gl}}).call(this)}).call(this,typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":253}],227:[function(v,J,Z){J.exports=function(p){typeof p=="string"&&(p=[p]);for(var g=[].slice.call(arguments,1),b=[],y=0;y<p.length-1;y++)b.push(p[y],g[y]||"");return b.push(p[y]),b.join("")}},{}],228:[function(v,J,Z){(function(p){(function(){var g,b=v("is-browser");g=typeof p.matchMedia=="function"?!p.matchMedia("(hover: none)").matches:b,J.exports=g}).call(this)}).call(this,typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":232}],229:[function(v,J,Z){var p=v("is-browser");J.exports=p&&function(){var g=!1;try{var b=Object.defineProperty({},"passive",{get:function(){g=!0}});window.addEventListener("test",null,b),window.removeEventListener("test",null,b)}catch{g=!1}return g}()},{"is-browser":232}],230:[function(v,J,Z){Z.read=function(p,g,b,y,e){var n,t,a=8*e-y-1,r=(1<<a)-1,m=r>>1,o=-7,i=b?e-1:0,u=b?-1:1,f=p[g+i];for(i+=u,n=f&(1<<-o)-1,f>>=-o,o+=a;o>0;n=256*n+p[g+i],i+=u,o-=8);for(t=n&(1<<-o)-1,n>>=-o,o+=y;o>0;t=256*t+p[g+i],i+=u,o-=8);if(n===0)n=1-m;else{if(n===r)return t?NaN:1/0*(f?-1:1);t+=Math.pow(2,y),n-=m}return(f?-1:1)*t*Math.pow(2,n-y)},Z.write=function(p,g,b,y,e,n){var t,a,r,m=8*n-e-1,o=(1<<m)-1,i=o>>1,u=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=y?0:n-1,l=y?1:-1,h=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(a=isNaN(g)?1:0,t=o):(t=Math.floor(Math.log(g)/Math.LN2),g*(r=Math.pow(2,-t))<1&&(t--,r*=2),(g+=t+i>=1?u/r:u*Math.pow(2,1-i))*r>=2&&(t++,r/=2),t+i>=o?(a=0,t=o):t+i>=1?(a=(g*r-1)*Math.pow(2,e),t+=i):(a=g*Math.pow(2,i-1)*Math.pow(2,e),t=0));e>=8;p[b+f]=255&a,f+=l,a/=256,e-=8);for(t=t<<e|a,m+=e;m>0;p[b+f]=255&t,f+=l,t/=256,m-=8);p[b+f-l]|=128*h}},{}],231:[function(v,J,Z){typeof Object.create=="function"?J.exports=function(p,g){g&&(p.super_=g,p.prototype=Object.create(g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}))}:J.exports=function(p,g){if(g){p.super_=g;var b=function(){};b.prototype=g.prototype,p.prototype=new b,p.prototype.constructor=p}}},{}],232:[function(v,J,Z){J.exports=!0},{}],233:[function(v,J,Z){J.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(v,J,Z){J.exports=b,J.exports.isMobile=b,J.exports.default=b;var p=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,g=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function b(y){y||(y={});var e=y.ua;if(e||typeof navigator>"u"||(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var n=y.tablet?g.test(e):p.test(e);return!n&&y.tablet&&y.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(n=!0),n}},{}],235:[function(v,J,Z){J.exports=function(p){var g=typeof p;return p!==null&&(g==="object"||g==="function")}},{}],236:[function(v,J,Z){var p=Object.prototype.toString;J.exports=function(g){var b;return p.call(g)==="[object Object]"&&((b=Object.getPrototypeOf(g))===null||b===Object.getPrototypeOf({}))}},{}],237:[function(v,J,Z){J.exports=function(p){for(var g,b=p.length,y=0;y<b;y++)if(((g=p.charCodeAt(y))<9||g>13)&&g!==32&&g!==133&&g!==160&&g!==5760&&g!==6158&&(g<8192||g>8205)&&g!==8232&&g!==8233&&g!==8239&&g!==8287&&g!==8288&&g!==12288&&g!==65279)return!1;return!0}},{}],238:[function(v,J,Z){J.exports=function(p){return typeof p=="string"&&(p=p.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(p)&&/[\dz]$/i.test(p)&&p.length>4))}},{}],239:[function(v,J,Z){(function(p,g){typeof Z=="object"&&J!==void 0?J.exports=g():(p=p||self).mapboxgl=g()})(this,function(){var p,g,b;function y(e,n){if(p)if(g){var t="var sharedChunk = {}; ("+p+")(sharedChunk); ("+g+")(sharedChunk);",a={};p(a),(b=n(a)).workerUrl=window.URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}else g=n;else p=n}return y(0,function(e){function n(M,O){return M(O={exports:{}},O.exports),O.exports}var t=a;function a(M,O,Y,ae){this.cx=3*M,this.bx=3*(Y-M)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*O,this.by=3*(ae-O)-this.cy,this.ay=1-this.cy-this.by,this.p1x=M,this.p1y=ae,this.p2x=Y,this.p2y=ae}a.prototype.sampleCurveX=function(M){return((this.ax*M+this.bx)*M+this.cx)*M},a.prototype.sampleCurveY=function(M){return((this.ay*M+this.by)*M+this.cy)*M},a.prototype.sampleCurveDerivativeX=function(M){return(3*this.ax*M+2*this.bx)*M+this.cx},a.prototype.solveCurveX=function(M,O){var Y,ae,pe,ye,Ee;for(O===void 0&&(O=1e-6),pe=M,Ee=0;Ee<8;Ee++){if(ye=this.sampleCurveX(pe)-M,Math.abs(ye)<O)return pe;var Ne=this.sampleCurveDerivativeX(pe);if(Math.abs(Ne)<1e-6)break;pe-=ye/Ne}if((pe=M)<(Y=0))return Y;if(pe>(ae=1))return ae;for(;Y<ae;){if(ye=this.sampleCurveX(pe),Math.abs(ye-M)<O)return pe;M>ye?Y=pe:ae=pe,pe=.5*(ae-Y)+Y}return pe},a.prototype.solve=function(M,O){return this.sampleCurveY(this.solveCurveX(M,O))};var r=m;function m(M,O){this.x=M,this.y=O}function o(M,O,Y,ae){var pe=new t(M,O,Y,ae);return function(ye){return pe.solve(ye)}}m.prototype={clone:function(){return new m(this.x,this.y)},add:function(M){return this.clone()._add(M)},sub:function(M){return this.clone()._sub(M)},multByPoint:function(M){return this.clone()._multByPoint(M)},divByPoint:function(M){return this.clone()._divByPoint(M)},mult:function(M){return this.clone()._mult(M)},div:function(M){return this.clone()._div(M)},rotate:function(M){return this.clone()._rotate(M)},rotateAround:function(M,O){return this.clone()._rotateAround(M,O)},matMult:function(M){return this.clone()._matMult(M)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(M){return this.x===M.x&&this.y===M.y},dist:function(M){return Math.sqrt(this.distSqr(M))},distSqr:function(M){var O=M.x-this.x,Y=M.y-this.y;return O*O+Y*Y},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(M){return Math.atan2(this.y-M.y,this.x-M.x)},angleWith:function(M){return this.angleWithSep(M.x,M.y)},angleWithSep:function(M,O){return Math.atan2(this.x*O-this.y*M,this.x*M+this.y*O)},_matMult:function(M){var O=M[0]*this.x+M[1]*this.y,Y=M[2]*this.x+M[3]*this.y;return this.x=O,this.y=Y,this},_add:function(M){return this.x+=M.x,this.y+=M.y,this},_sub:function(M){return this.x-=M.x,this.y-=M.y,this},_mult:function(M){return this.x*=M,this.y*=M,this},_div:function(M){return this.x/=M,this.y/=M,this},_multByPoint:function(M){return this.x*=M.x,this.y*=M.y,this},_divByPoint:function(M){return this.x/=M.x,this.y/=M.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var M=this.y;return this.y=this.x,this.x=-M,this},_rotate:function(M){var O=Math.cos(M),Y=Math.sin(M),ae=O*this.x-Y*this.y,pe=Y*this.x+O*this.y;return this.x=ae,this.y=pe,this},_rotateAround:function(M,O){var Y=Math.cos(M),ae=Math.sin(M),pe=O.x+Y*(this.x-O.x)-ae*(this.y-O.y),ye=O.y+ae*(this.x-O.x)+Y*(this.y-O.y);return this.x=pe,this.y=ye,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},m.convert=function(M){return M instanceof m?M:Array.isArray(M)?new m(M[0],M[1]):M};var i=o(.25,.1,.25,1);function u(M,O,Y){return Math.min(Y,Math.max(O,M))}function f(M,O,Y){var ae=Y-O,pe=((M-O)%ae+ae)%ae+O;return pe===O?Y:pe}function l(M){for(var O=[],Y=arguments.length-1;Y-- >0;)O[Y]=arguments[Y+1];for(var ae=0,pe=O;ae<pe.length;ae+=1){var ye=pe[ae];for(var Ee in ye)M[Ee]=ye[Ee]}return M}var h=1;function d(){return h++}function s(){return function M(O){return O?(O^16*Math.random()>>O/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,M)}()}function x(M){return!!M&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(M)}function c(M,O){M.forEach(function(Y){O[Y]&&(O[Y]=O[Y].bind(O))})}function T(M,O){return M.indexOf(O,M.length-O.length)!==-1}function _(M,O,Y){var ae={};for(var pe in M)ae[pe]=O.call(Y||this,M[pe],pe,M);return ae}function w(M,O,Y){var ae={};for(var pe in M)O.call(Y||this,M[pe],pe,M)&&(ae[pe]=M[pe]);return ae}function k(M){return Array.isArray(M)?M.map(k):typeof M=="object"&&M?_(M,k):M}var L={};function A(M){L[M]||(typeof console<"u"&&console.warn(M),L[M]=!0)}function I(M,O,Y){return(Y.y-M.y)*(O.x-M.x)>(O.y-M.y)*(Y.x-M.x)}function P(M){for(var O=0,Y=0,ae=M.length,pe=ae-1,ye=void 0,Ee=void 0;Y<ae;pe=Y++)ye=M[Y],O+=((Ee=M[pe]).x-ye.x)*(ye.y+Ee.y);return O}function S(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function E(M){var O={};if(M.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(ae,pe,ye,Ee){var Ne=ye||Ee;return O[pe]=!Ne||Ne.toLowerCase(),""}),O["max-age"]){var Y=parseInt(O["max-age"],10);isNaN(Y)?delete O["max-age"]:O["max-age"]=Y}return O}var D=null;function R(M){if(D==null){var O=M.navigator?M.navigator.userAgent:null;D=!!M.safari||!(!O||!(/\b(iPad|iPhone|iPod)\b/.test(O)||O.match("Safari")&&!O.match("Chrome")))}return D}function H(M){try{var O=self[M];return O.setItem("_mapbox_test_",1),O.removeItem("_mapbox_test_"),!0}catch{return!1}}var V,X,$,G,W=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),te=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,N=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,B={now:W,frame:function(M){var O=te(M);return{cancel:function(){return N(O)}}},getImageData:function(M,O){O===void 0&&(O=0);var Y=self.document.createElement("canvas"),ae=Y.getContext("2d");if(!ae)throw new Error("failed to create canvas 2d context");return Y.width=M.width,Y.height=M.height,ae.drawImage(M,0,0,M.width,M.height),ae.getImageData(-O,-O,M.width+2*O,M.height+2*O)},resolveURL:function(M){return V||(V=self.document.createElement("a")),V.href=M,V.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(X==null&&(X=self.matchMedia("(prefers-reduced-motion: reduce)")),X.matches)}},U={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ee={supported:!1,testSupport:function(M){j||!G||(Q?K(M):$=M)}},j=!1,Q=!1;function K(M){var O=M.createTexture();M.bindTexture(M.TEXTURE_2D,O);try{if(M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,G),M.isContextLost())return;ee.supported=!0}catch{}M.deleteTexture(O),j=!0}self.document&&((G=self.document.createElement("img")).onload=function(){$&&K($),$=null,Q=!0},G.onerror=function(){j=!0,$=null},G.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var re="01",ne=function(M,O){this._transformRequestFn=M,this._customAccessToken=O,this._createSkuToken()};function le(M){return M.indexOf("mapbox:")===0}ne.prototype._createSkuToken=function(){var M=function(){for(var O="",Y=0;Y<10;Y++)O+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",re,O].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=M.token,this._skuTokenExpiresAt=M.tokenExpiresAt},ne.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ne.prototype.transformRequest=function(M,O){return this._transformRequestFn&&this._transformRequestFn(M,O)||{url:M}},ne.prototype.normalizeStyleURL=function(M,O){if(!le(M))return M;var Y=me(M);return Y.path="/styles/v1"+Y.path,this._makeAPIURL(Y,this._customAccessToken||O)},ne.prototype.normalizeGlyphsURL=function(M,O){if(!le(M))return M;var Y=me(M);return Y.path="/fonts/v1"+Y.path,this._makeAPIURL(Y,this._customAccessToken||O)},ne.prototype.normalizeSourceURL=function(M,O){if(!le(M))return M;var Y=me(M);return Y.path="/v4/"+Y.authority+".json",Y.params.push("secure"),this._makeAPIURL(Y,this._customAccessToken||O)},ne.prototype.normalizeSpriteURL=function(M,O,Y,ae){var pe=me(M);return le(M)?(pe.path="/styles/v1"+pe.path+"/sprite"+O+Y,this._makeAPIURL(pe,this._customAccessToken||ae)):(pe.path+=""+O+Y,Te(pe))},ne.prototype.normalizeTileURL=function(M,O){if(this._isSkuTokenExpired()&&this._createSkuToken(),M&&!le(M))return M;var Y=me(M),ae=B.devicePixelRatio>=2||O===512?"@2x":"",pe=ee.supported?".webp":"$1";Y.path=Y.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+ae+pe),Y.path=Y.path.replace(/^.+\/v4\//,"/"),Y.path="/v4"+Y.path;var ye=this._customAccessToken||function(Ee){for(var Ne=0,Qe=Ee;Ne<Qe.length;Ne+=1){var ct=Qe[Ne].match(/^access_token=(.*)$/);if(ct)return ct[1]}return null}(Y.params)||U.ACCESS_TOKEN;return U.REQUIRE_ACCESS_TOKEN&&ye&&this._skuToken&&Y.params.push("sku="+this._skuToken),this._makeAPIURL(Y,ye)},ne.prototype.canonicalizeTileURL=function(M,O){var Y=me(M);if(!Y.path.match(/(^\/v4\/)/)||!Y.path.match(/\.[\w]+$/))return M;var ae="mapbox://tiles/";ae+=Y.path.replace("/v4/","");var pe=Y.params;return O&&(pe=pe.filter(function(ye){return!ye.match(/^access_token=/)})),pe.length&&(ae+="?"+pe.join("&")),ae},ne.prototype.canonicalizeTileset=function(M,O){for(var Y=!!O&&le(O),ae=[],pe=0,ye=M.tiles||[];pe<ye.length;pe+=1){var Ee=ye[pe];de(Ee)?ae.push(this.canonicalizeTileURL(Ee,Y)):ae.push(Ee)}return ae},ne.prototype._makeAPIURL=function(M,O){var Y="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",ae=me(U.API_URL);if(M.protocol=ae.protocol,M.authority=ae.authority,ae.path!=="/"&&(M.path=""+ae.path+M.path),!U.REQUIRE_ACCESS_TOKEN)return Te(M);if(!(O=O||U.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+Y);if(O[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+Y);return M.params=M.params.filter(function(pe){return pe.indexOf("access_token")===-1}),M.params.push("access_token="+O),Te(M)};var oe=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function de(M){return oe.test(M)}var se=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function me(M){var O=M.match(se);if(!O)throw new Error("Unable to parse URL object");return{protocol:O[1],authority:O[2],path:O[3]||"/",params:O[4]?O[4].split("&"):[]}}function Te(M){var O=M.params.length?"?"+M.params.join("&"):"";return M.protocol+"://"+M.authority+M.path+O}function _e(M){if(!M)return null;var O,Y=M.split(".");if(!Y||Y.length!==3)return null;try{return JSON.parse((O=Y[1],decodeURIComponent(self.atob(O).split("").map(function(ae){return"%"+("00"+ae.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch{return null}}var be=function(M){this.type=M,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};be.prototype.getStorageKey=function(M){var O,Y=_e(U.ACCESS_TOKEN),ae="";return Y&&Y.u?(O=Y.u,ae=self.btoa(encodeURIComponent(O).replace(/%([0-9A-F]{2})/g,function(pe,ye){return String.fromCharCode(Number("0x"+ye))}))):ae=U.ACCESS_TOKEN||"",M?"mapbox.eventData."+M+":"+ae:"mapbox.eventData:"+ae},be.prototype.fetchEventData=function(){var M=H("localStorage"),O=this.getStorageKey(),Y=this.getStorageKey("uuid");if(M)try{var ae=self.localStorage.getItem(O);ae&&(this.eventData=JSON.parse(ae));var pe=self.localStorage.getItem(Y);pe&&(this.anonId=pe)}catch{A("Unable to read from LocalStorage")}},be.prototype.saveEventData=function(){var M=H("localStorage"),O=this.getStorageKey(),Y=this.getStorageKey("uuid");if(M)try{self.localStorage.setItem(Y,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(O,JSON.stringify(this.eventData))}catch{A("Unable to write to LocalStorage")}},be.prototype.processRequests=function(M){},be.prototype.postEvent=function(M,O,Y,ae){var pe=this;if(U.EVENTS_URL){var ye=me(U.EVENTS_URL);ye.params.push("access_token="+(ae||U.ACCESS_TOKEN||""));var Ee={event:this.type,created:new Date(M).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:re,userId:this.anonId},Ne=O?l(Ee,O):Ee,Qe={url:Te(ye),headers:{"Content-Type":"text/plain"},body:JSON.stringify([Ne])};this.pendingRequest=Nt(Qe,function(ct){pe.pendingRequest=null,Y(ct),pe.saveEventData(),pe.processRequests(ae)})}},be.prototype.queueRequest=function(M,O){this.queue.push(M),this.processRequests(O)};var Ce,fe,ve=function(M){function O(){M.call(this,"map.load"),this.success={},this.skuToken=""}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.postMapLoadEvent=function(Y,ae,pe,ye){this.skuToken=pe,(U.EVENTS_URL&&ye||U.ACCESS_TOKEN&&Array.isArray(Y)&&Y.some(function(Ee){return le(Ee)||de(Ee)}))&&this.queueRequest({id:ae,timestamp:Date.now()},ye)},O.prototype.processRequests=function(Y){var ae=this;if(!this.pendingRequest&&this.queue.length!==0){var pe=this.queue.shift(),ye=pe.id,Ee=pe.timestamp;ye&&this.success[ye]||(this.anonId||this.fetchEventData(),x(this.anonId)||(this.anonId=s()),this.postEvent(Ee,{skuToken:this.skuToken},function(Ne){Ne||ye&&(ae.success[ye]=!0)},Y))}},O}(be),Me=new(function(M){function O(Y){M.call(this,"appUserTurnstile"),this._customAccessToken=Y}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.postTurnstileEvent=function(Y,ae){U.EVENTS_URL&&U.ACCESS_TOKEN&&Array.isArray(Y)&&Y.some(function(pe){return le(pe)||de(pe)})&&this.queueRequest(Date.now(),ae)},O.prototype.processRequests=function(Y){var ae=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var pe=_e(U.ACCESS_TOKEN),ye=pe?pe.u:U.ACCESS_TOKEN,Ee=ye!==this.eventData.tokenU;x(this.anonId)||(this.anonId=s(),Ee=!0);var Ne=this.queue.shift();if(this.eventData.lastSuccess){var Qe=new Date(this.eventData.lastSuccess),ct=new Date(Ne),mt=(Ne-this.eventData.lastSuccess)/864e5;Ee=Ee||mt>=1||mt<-1||Qe.getDate()!==ct.getDate()}else Ee=!0;if(!Ee)return this.processRequests();this.postEvent(Ne,{"enabled.telemetry":!1},function(Dt){Dt||(ae.eventData.lastSuccess=Ne,ae.eventData.tokenU=ye)},Y)}},O}(be)),ke=Me.postTurnstileEvent.bind(Me),Le=new ve,ze=Le.postMapLoadEvent.bind(Le),Re=500,Oe=50;function Ze(){self.caches&&!Ce&&(Ce=self.caches.open("mapbox-tiles"))}function Pe(M,O,Y){if(Ze(),Ce){var ae={status:O.status,statusText:O.statusText,headers:new self.Headers};O.headers.forEach(function(ye,Ee){return ae.headers.set(Ee,ye)});var pe=E(O.headers.get("Cache-Control")||"");pe["no-store"]||(pe["max-age"]&&ae.headers.set("Expires",new Date(Y+1e3*pe["max-age"]).toUTCString()),new Date(ae.headers.get("Expires")).getTime()-Y<42e4||function(ye,Ee){if(fe===void 0)try{new Response(new ReadableStream),fe=!0}catch{fe=!1}fe?Ee(ye.body):ye.blob().then(Ee)}(O,function(ye){var Ee=new self.Response(ye,ae);Ze(),Ce&&Ce.then(function(Ne){return Ne.put(Ie(M.url),Ee)}).catch(function(Ne){return A(Ne.message)})}))}}function Ie(M){var O=M.indexOf("?");return O<0?M:M.slice(0,O)}function Be(M,O){if(Ze(),!Ce)return O(null);var Y=Ie(M.url);Ce.then(function(ae){ae.match(Y).then(function(pe){var ye=function(Ee){if(!Ee)return!1;var Ne=new Date(Ee.headers.get("Expires")||0),Qe=E(Ee.headers.get("Cache-Control")||"");return Ne>Date.now()&&!Qe["no-cache"]}(pe);ae.delete(Y),ye&&ae.put(Y,pe.clone()),O(null,pe,ye)}).catch(O)}).catch(O)}var Fe,$e=1/0;function ot(){return Fe==null&&(Fe=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Fe}var pt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(pt);var _t=function(M){function O(Y,ae,pe){ae===401&&de(pe)&&(Y+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),M.call(this,Y),this.status=ae,this.url=pe,this.name=this.constructor.name,this.message=Y}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},O}(Error),yt=S()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href};function tt(M,O){var Y,ae=new self.AbortController,pe=new self.Request(M.url,{method:M.method||"GET",body:M.body,credentials:M.credentials,headers:M.headers,referrer:yt(),signal:ae.signal}),ye=!1,Ee=!1,Ne=(Y=pe.url).indexOf("sku=")>0&&de(Y);M.type==="json"&&pe.headers.set("Accept","application/json");var Qe=function(mt,Dt,Wt){if(!Ee){if(mt&&mt.message!=="SecurityError"&&A(mt),Dt&&Wt)return ct(Dt);var Vt=Date.now();self.fetch(pe).then(function(sr){if(sr.ok){var br=Ne?sr.clone():null;return ct(sr,br,Vt)}return O(new _t(sr.statusText,sr.status,M.url))}).catch(function(sr){sr.code!==20&&O(new Error(sr.message))})}},ct=function(mt,Dt,Wt){(M.type==="arrayBuffer"?mt.arrayBuffer():M.type==="json"?mt.json():mt.text()).then(function(Vt){Ee||(Dt&&Wt&&Pe(pe,Dt,Wt),ye=!0,O(null,Vt,mt.headers.get("Cache-Control"),mt.headers.get("Expires")))}).catch(function(Vt){Ee||O(new Error(Vt.message))})};return Ne?Be(pe,Qe):Qe(null,null),{cancel:function(){Ee=!0,ye||ae.abort()}}}var Ke=function(M,O){if(Y=M.url,!(/^file:/.test(Y)||/^file:/.test(yt())&&!/^\w+:/.test(Y))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return tt(M,O);if(S()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",M,O,void 0,!0)}var Y;return function(ae,pe){var ye=new self.XMLHttpRequest;for(var Ee in ye.open(ae.method||"GET",ae.url,!0),ae.type==="arrayBuffer"&&(ye.responseType="arraybuffer"),ae.headers)ye.setRequestHeader(Ee,ae.headers[Ee]);return ae.type==="json"&&(ye.responseType="text",ye.setRequestHeader("Accept","application/json")),ye.withCredentials=ae.credentials==="include",ye.onerror=function(){pe(new Error(ye.statusText))},ye.onload=function(){if((ye.status>=200&&ye.status<300||ye.status===0)&&ye.response!==null){var Ne=ye.response;if(ae.type==="json")try{Ne=JSON.parse(ye.response)}catch(Qe){return pe(Qe)}pe(null,Ne,ye.getResponseHeader("Cache-Control"),ye.getResponseHeader("Expires"))}else pe(new _t(ye.statusText,ye.status,ae.url))},ye.send(ae.body),{cancel:function(){return ye.abort()}}}(M,O)},vt=function(M,O){return Ke(l(M,{type:"arrayBuffer"}),O)},Nt=function(M,O){return Ke(l(M,{method:"POST"}),O)},qt,er;qt=[],er=0;var Jt=function(M,O){if(ee.supported&&(M.headers||(M.headers={}),M.headers.accept="image/webp,*/*"),er>=U.MAX_PARALLEL_IMAGE_REQUESTS){var Y={requestParameters:M,callback:O,cancelled:!1,cancel:function(){this.cancelled=!0}};return qt.push(Y),Y}er++;var ae=!1,pe=function(){if(!ae)for(ae=!0,er--;qt.length&&er<U.MAX_PARALLEL_IMAGE_REQUESTS;){var Ee=qt.shift(),Ne=Ee.requestParameters,Qe=Ee.callback;Ee.cancelled||(Ee.cancel=Jt(Ne,Qe).cancel)}},ye=vt(M,function(Ee,Ne,Qe,ct){pe(),Ee?O(Ee):Ne&&(ot()?function(mt,Dt){var Wt=new self.Blob([new Uint8Array(mt)],{type:"image/png"});self.createImageBitmap(Wt).then(function(Vt){Dt(null,Vt)}).catch(function(Vt){Dt(new Error("Could not load image because of "+Vt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(Ne,O):function(mt,Dt,Wt,Vt){var sr=new self.Image,br=self.URL;sr.onload=function(){Dt(null,sr),br.revokeObjectURL(sr.src)},sr.onerror=function(){return Dt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Ir=new self.Blob([new Uint8Array(mt)],{type:"image/png"});sr.cacheControl=Wt,sr.expires=Vt,sr.src=mt.byteLength?br.createObjectURL(Ir):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(Ne,O,Qe,ct))});return{cancel:function(){ye.cancel(),pe()}}};function ir(M,O,Y){Y[M]&&Y[M].indexOf(O)!==-1||(Y[M]=Y[M]||[],Y[M].push(O))}function Ht(M,O,Y){if(Y&&Y[M]){var ae=Y[M].indexOf(O);ae!==-1&&Y[M].splice(ae,1)}}var Ue=function(M,O){O===void 0&&(O={}),l(this,O),this.type=M},We=function(M){function O(Y,ae){ae===void 0&&(ae={}),M.call(this,"error",l({error:Y},ae))}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Ue),he=function(){};he.prototype.on=function(M,O){return this._listeners=this._listeners||{},ir(M,O,this._listeners),this},he.prototype.off=function(M,O){return Ht(M,O,this._listeners),Ht(M,O,this._oneTimeListeners),this},he.prototype.once=function(M,O){return this._oneTimeListeners=this._oneTimeListeners||{},ir(M,O,this._oneTimeListeners),this},he.prototype.fire=function(M,O){typeof M=="string"&&(M=new Ue(M,O||{}));var Y=M.type;if(this.listens(Y)){M.target=this;for(var ae=0,pe=this._listeners&&this._listeners[Y]?this._listeners[Y].slice():[];ae<pe.length;ae+=1)pe[ae].call(this,M);for(var ye=0,Ee=this._oneTimeListeners&&this._oneTimeListeners[Y]?this._oneTimeListeners[Y].slice():[];ye<Ee.length;ye+=1){var Ne=Ee[ye];Ht(Y,Ne,this._oneTimeListeners),Ne.call(this,M)}var Qe=this._eventedParent;Qe&&(l(M,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Qe.fire(M))}else M instanceof We&&console.error(M.error);return this},he.prototype.listens=function(M){return this._listeners&&this._listeners[M]&&this._listeners[M].length>0||this._oneTimeListeners&&this._oneTimeListeners[M]&&this._oneTimeListeners[M].length>0||this._eventedParent&&this._eventedParent.listens(M)},he.prototype.setEventedParent=function(M,O){return this._eventedParent=M,this._eventedParentData=O,this};var xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},De=function(M,O,Y,ae){this.message=(M?M+": ":"")+Y,ae&&(this.identifier=ae),O!=null&&O.__line__&&(this.line=O.__line__)};function qe(M){var O=M.key,Y=M.value;return Y?[new De(O,Y,"constants have been deprecated as of v8")]:[]}function Xe(M){for(var O=[],Y=arguments.length-1;Y-- >0;)O[Y]=arguments[Y+1];for(var ae=0,pe=O;ae<pe.length;ae+=1){var ye=pe[ae];for(var Ee in ye)M[Ee]=ye[Ee]}return M}function He(M){return M instanceof Number||M instanceof String||M instanceof Boolean?M.valueOf():M}function st(M){if(Array.isArray(M))return M.map(st);if(M instanceof Object&&!(M instanceof Number||M instanceof String||M instanceof Boolean)){var O={};for(var Y in M)O[Y]=st(M[Y]);return O}return He(M)}var it=function(M){function O(Y,ae){M.call(this,ae),this.message=ae,this.key=Y}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Error),Tt=function(M,O){O===void 0&&(O=[]),this.parent=M,this.bindings={};for(var Y=0,ae=O;Y<ae.length;Y+=1){var pe=ae[Y],ye=pe[0],Ee=pe[1];this.bindings[ye]=Ee}};Tt.prototype.concat=function(M){return new Tt(this,M)},Tt.prototype.get=function(M){if(this.bindings[M])return this.bindings[M];if(this.parent)return this.parent.get(M);throw new Error(M+" not found in scope.")},Tt.prototype.has=function(M){return!!this.bindings[M]||!!this.parent&&this.parent.has(M)};var Pt={kind:"null"},rt={kind:"number"},ut={kind:"string"},Ft={kind:"boolean"},wt={kind:"color"},Lt={kind:"object"},Ae={kind:"value"},Ye={kind:"collator"},nt={kind:"formatted"},ft={kind:"resolvedImage"};function Mt(M,O){return{kind:"array",itemType:M,N:O}}function Rt(M){if(M.kind==="array"){var O=Rt(M.itemType);return typeof M.N=="number"?"array<"+O+", "+M.N+">":M.itemType.kind==="value"?"array":"array<"+O+">"}return M.kind}var Gt=[Pt,rt,ut,Ft,wt,nt,Lt,Mt(Ae),ft];function jt(M,O){if(O.kind==="error")return null;if(M.kind==="array"){if(O.kind==="array"&&(O.N===0&&O.itemType.kind==="value"||!jt(M.itemType,O.itemType))&&(typeof M.N!="number"||M.N===O.N))return null}else{if(M.kind===O.kind)return null;if(M.kind==="value"){for(var Y=0,ae=Gt;Y<ae.length;Y+=1)if(!jt(ae[Y],O))return null}}return"Expected "+Rt(M)+" but found "+Rt(O)+" instead."}function pr(M,O){return O.some(function(Y){return Y.kind===M.kind})}function Ar(M,O){return O.some(function(Y){return Y==="null"?M===null:Y==="array"?Array.isArray(M):Y==="object"?M&&!Array.isArray(M)&&typeof M=="object":Y===typeof M})}var fr=n(function(M,O){var Y={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ae(Qe){return(Qe=Math.round(Qe))<0?0:Qe>255?255:Qe}function pe(Qe){return Qe<0?0:Qe>1?1:Qe}function ye(Qe){return Qe[Qe.length-1]==="%"?ae(parseFloat(Qe)/100*255):ae(parseInt(Qe))}function Ee(Qe){return Qe[Qe.length-1]==="%"?pe(parseFloat(Qe)/100):pe(parseFloat(Qe))}function Ne(Qe,ct,mt){return mt<0?mt+=1:mt>1&&(mt-=1),6*mt<1?Qe+(ct-Qe)*mt*6:2*mt<1?ct:3*mt<2?Qe+(ct-Qe)*(2/3-mt)*6:Qe}try{O.parseCSSColor=function(Qe){var ct,mt=Qe.replace(/ /g,"").toLowerCase();if(mt in Y)return Y[mt].slice();if(mt[0]==="#")return mt.length===4?(ct=parseInt(mt.substr(1),16))>=0&&ct<=4095?[(3840&ct)>>4|(3840&ct)>>8,240&ct|(240&ct)>>4,15&ct|(15&ct)<<4,1]:null:mt.length===7&&(ct=parseInt(mt.substr(1),16))>=0&&ct<=16777215?[(16711680&ct)>>16,(65280&ct)>>8,255&ct,1]:null;var Dt=mt.indexOf("("),Wt=mt.indexOf(")");if(Dt!==-1&&Wt+1===mt.length){var Vt=mt.substr(0,Dt),sr=mt.substr(Dt+1,Wt-(Dt+1)).split(","),br=1;switch(Vt){case"rgba":if(sr.length!==4)return null;br=Ee(sr.pop());case"rgb":return sr.length!==3?null:[ye(sr[0]),ye(sr[1]),ye(sr[2]),br];case"hsla":if(sr.length!==4)return null;br=Ee(sr.pop());case"hsl":if(sr.length!==3)return null;var Ir=(parseFloat(sr[0])%360+360)%360/360,Pr=Ee(sr[1]),Vr=Ee(sr[2]),Hr=Vr<=.5?Vr*(Pr+1):Vr+Pr-Vr*Pr,Xr=2*Vr-Hr;return[ae(255*Ne(Xr,Hr,Ir+1/3)),ae(255*Ne(Xr,Hr,Ir)),ae(255*Ne(Xr,Hr,Ir-1/3)),br];default:return null}}return null}}catch{}}).parseCSSColor,Zt=function(M,O,Y,ae){ae===void 0&&(ae=1),this.r=M,this.g=O,this.b=Y,this.a=ae};Zt.parse=function(M){if(M){if(M instanceof Zt)return M;if(typeof M=="string"){var O=fr(M);if(O)return new Zt(O[0]/255*O[3],O[1]/255*O[3],O[2]/255*O[3],O[3])}}},Zt.prototype.toString=function(){var M=this.toArray(),O=M[0],Y=M[1],ae=M[2],pe=M[3];return"rgba("+Math.round(O)+","+Math.round(Y)+","+Math.round(ae)+","+pe+")"},Zt.prototype.toArray=function(){var M=this.r,O=this.g,Y=this.b,ae=this.a;return ae===0?[0,0,0,0]:[255*M/ae,255*O/ae,255*Y/ae,ae]},Zt.black=new Zt(0,0,0,1),Zt.white=new Zt(1,1,1,1),Zt.transparent=new Zt(0,0,0,0),Zt.red=new Zt(1,0,0,1);var Qt=function(M,O,Y){this.sensitivity=M?O?"variant":"case":O?"accent":"base",this.locale=Y,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Qt.prototype.compare=function(M,O){return this.collator.compare(M,O)},Qt.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var $t=function(M,O,Y,ae,pe){this.text=M,this.image=O,this.scale=Y,this.fontStack=ae,this.textColor=pe},hr=function(M){this.sections=M};hr.fromString=function(M){return new hr([new $t(M,null,null,null,null)])},hr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(M){return M.text.length!==0||M.image&&M.image.name.length!==0})},hr.factory=function(M){return M instanceof hr?M:hr.fromString(M)},hr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(M){return M.text}).join("")},hr.prototype.serialize=function(){for(var M=["format"],O=0,Y=this.sections;O<Y.length;O+=1){var ae=Y[O];if(ae.image)M.push(["image",ae.image.name]);else{M.push(ae.text);var pe={};ae.fontStack&&(pe["text-font"]=["literal",ae.fontStack.split(",")]),ae.scale&&(pe["font-scale"]=ae.scale),ae.textColor&&(pe["text-color"]=["rgba"].concat(ae.textColor.toArray())),M.push(pe)}}return M};var vr=function(M){this.name=M.name,this.available=M.available};function Mr(M,O,Y,ae){return typeof M=="number"&&M>=0&&M<=255&&typeof O=="number"&&O>=0&&O<=255&&typeof Y=="number"&&Y>=0&&Y<=255?ae===void 0||typeof ae=="number"&&ae>=0&&ae<=1?null:"Invalid rgba value ["+[M,O,Y,ae].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof ae=="number"?[M,O,Y,ae]:[M,O,Y]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Nr(M){if(M===null||typeof M=="string"||typeof M=="boolean"||typeof M=="number"||M instanceof Zt||M instanceof Qt||M instanceof hr||M instanceof vr)return!0;if(Array.isArray(M)){for(var O=0,Y=M;O<Y.length;O+=1)if(!Nr(Y[O]))return!1;return!0}if(typeof M=="object"){for(var ae in M)if(!Nr(M[ae]))return!1;return!0}return!1}function Ur(M){if(M===null)return Pt;if(typeof M=="string")return ut;if(typeof M=="boolean")return Ft;if(typeof M=="number")return rt;if(M instanceof Zt)return wt;if(M instanceof Qt)return Ye;if(M instanceof hr)return nt;if(M instanceof vr)return ft;if(Array.isArray(M)){for(var O,Y=M.length,ae=0,pe=M;ae<pe.length;ae+=1){var ye=Ur(pe[ae]);if(O){if(O===ye)continue;O=Ae;break}O=ye}return Mt(O||Ae,Y)}return Lt}function Jr(M){var O=typeof M;return M===null?"":O==="string"||O==="number"||O==="boolean"?String(M):M instanceof Zt||M instanceof hr||M instanceof vr?M.toString():JSON.stringify(M)}vr.prototype.toString=function(){return this.name},vr.fromString=function(M){return M?new vr({name:M,available:!1}):null},vr.prototype.serialize=function(){return["image",this.name]};var mn=function(M,O){this.type=M,this.value=O};mn.parse=function(M,O){if(M.length!==2)return O.error("'literal' expression requires exactly one argument, but found "+(M.length-1)+" instead.");if(!Nr(M[1]))return O.error("invalid value");var Y=M[1],ae=Ur(Y),pe=O.expectedType;return ae.kind!=="array"||ae.N!==0||!pe||pe.kind!=="array"||typeof pe.N=="number"&&pe.N!==0||(ae=pe),new mn(ae,Y)},mn.prototype.evaluate=function(){return this.value},mn.prototype.eachChild=function(){},mn.prototype.outputDefined=function(){return!0},mn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Zt?["rgba"].concat(this.value.toArray()):this.value instanceof hr?this.value.serialize():this.value};var en=function(M){this.name="ExpressionEvaluationError",this.message=M};en.prototype.toJSON=function(){return this.message};var In={string:ut,number:rt,boolean:Ft,object:Lt},vn=function(M,O){this.type=M,this.args=O};vn.parse=function(M,O){if(M.length<2)return O.error("Expected at least one argument.");var Y,ae=1,pe=M[0];if(pe==="array"){var ye,Ee;if(M.length>2){var Ne=M[1];if(typeof Ne!="string"||!(Ne in In)||Ne==="object")return O.error('The item type argument of "array" must be one of string, number, boolean',1);ye=In[Ne],ae++}else ye=Ae;if(M.length>3){if(M[2]!==null&&(typeof M[2]!="number"||M[2]<0||M[2]!==Math.floor(M[2])))return O.error('The length argument to "array" must be a positive integer literal',2);Ee=M[2],ae++}Y=Mt(ye,Ee)}else Y=In[pe];for(var Qe=[];ae<M.length;ae++){var ct=O.parse(M[ae],ae,Ae);if(!ct)return null;Qe.push(ct)}return new vn(Y,Qe)},vn.prototype.evaluate=function(M){for(var O=0;O<this.args.length;O++){var Y=this.args[O].evaluate(M);if(!jt(this.type,Ur(Y)))return Y;if(O===this.args.length-1)throw new en("Expected value to be of type "+Rt(this.type)+", but found "+Rt(Ur(Y))+" instead.")}return null},vn.prototype.eachChild=function(M){this.args.forEach(M)},vn.prototype.outputDefined=function(){return this.args.every(function(M){return M.outputDefined()})},vn.prototype.serialize=function(){var M=this.type,O=[M.kind];if(M.kind==="array"){var Y=M.itemType;if(Y.kind==="string"||Y.kind==="number"||Y.kind==="boolean"){O.push(Y.kind);var ae=M.N;(typeof ae=="number"||this.args.length>1)&&O.push(ae)}}return O.concat(this.args.map(function(pe){return pe.serialize()}))};var gn=function(M){this.type=nt,this.sections=M};gn.parse=function(M,O){if(M.length<2)return O.error("Expected at least one argument.");var Y=M[1];if(!Array.isArray(Y)&&typeof Y=="object")return O.error("First argument must be an image or text section.");for(var ae=[],pe=!1,ye=1;ye<=M.length-1;++ye){var Ee=M[ye];if(pe&&typeof Ee=="object"&&!Array.isArray(Ee)){pe=!1;var Ne=null;if(Ee["font-scale"]&&!(Ne=O.parse(Ee["font-scale"],1,rt)))return null;var Qe=null;if(Ee["text-font"]&&!(Qe=O.parse(Ee["text-font"],1,Mt(ut))))return null;var ct=null;if(Ee["text-color"]&&!(ct=O.parse(Ee["text-color"],1,wt)))return null;var mt=ae[ae.length-1];mt.scale=Ne,mt.font=Qe,mt.textColor=ct}else{var Dt=O.parse(M[ye],1,Ae);if(!Dt)return null;var Wt=Dt.type.kind;if(Wt!=="string"&&Wt!=="value"&&Wt!=="null"&&Wt!=="resolvedImage")return O.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");pe=!0,ae.push({content:Dt,scale:null,font:null,textColor:null})}}return new gn(ae)},gn.prototype.evaluate=function(M){return new hr(this.sections.map(function(O){var Y=O.content.evaluate(M);return Ur(Y)===ft?new $t("",Y,null,null,null):new $t(Jr(Y),null,O.scale?O.scale.evaluate(M):null,O.font?O.font.evaluate(M).join(","):null,O.textColor?O.textColor.evaluate(M):null)}))},gn.prototype.eachChild=function(M){for(var O=0,Y=this.sections;O<Y.length;O+=1){var ae=Y[O];M(ae.content),ae.scale&&M(ae.scale),ae.font&&M(ae.font),ae.textColor&&M(ae.textColor)}},gn.prototype.outputDefined=function(){return!1},gn.prototype.serialize=function(){for(var M=["format"],O=0,Y=this.sections;O<Y.length;O+=1){var ae=Y[O];M.push(ae.content.serialize());var pe={};ae.scale&&(pe["font-scale"]=ae.scale.serialize()),ae.font&&(pe["text-font"]=ae.font.serialize()),ae.textColor&&(pe["text-color"]=ae.textColor.serialize()),M.push(pe)}return M};var Sn=function(M){this.type=ft,this.input=M};Sn.parse=function(M,O){if(M.length!==2)return O.error("Expected two arguments.");var Y=O.parse(M[1],1,ut);return Y?new Sn(Y):O.error("No image name provided.")},Sn.prototype.evaluate=function(M){var O=this.input.evaluate(M),Y=vr.fromString(O);return Y&&M.availableImages&&(Y.available=M.availableImages.indexOf(O)>-1),Y},Sn.prototype.eachChild=function(M){M(this.input)},Sn.prototype.outputDefined=function(){return!1},Sn.prototype.serialize=function(){return["image",this.input.serialize()]};var Xn={"to-boolean":Ft,"to-color":wt,"to-number":rt,"to-string":ut},Br=function(M,O){this.type=M,this.args=O};Br.parse=function(M,O){if(M.length<2)return O.error("Expected at least one argument.");var Y=M[0];if((Y==="to-boolean"||Y==="to-string")&&M.length!==2)return O.error("Expected one argument.");for(var ae=Xn[Y],pe=[],ye=1;ye<M.length;ye++){var Ee=O.parse(M[ye],ye,Ae);if(!Ee)return null;pe.push(Ee)}return new Br(ae,pe)},Br.prototype.evaluate=function(M){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(M));if(this.type.kind==="color"){for(var O,Y,ae=0,pe=this.args;ae<pe.length;ae+=1){if(Y=null,(O=pe[ae].evaluate(M))instanceof Zt)return O;if(typeof O=="string"){var ye=M.parseColor(O);if(ye)return ye}else if(Array.isArray(O)&&!(Y=O.length<3||O.length>4?"Invalid rbga value "+JSON.stringify(O)+": expected an array containing either three or four numeric values.":Mr(O[0],O[1],O[2],O[3])))return new Zt(O[0]/255,O[1]/255,O[2]/255,O[3])}throw new en(Y||"Could not parse color from value '"+(typeof O=="string"?O:String(JSON.stringify(O)))+"'")}if(this.type.kind==="number"){for(var Ee=null,Ne=0,Qe=this.args;Ne<Qe.length;Ne+=1){if((Ee=Qe[Ne].evaluate(M))===null)return 0;var ct=Number(Ee);if(!isNaN(ct))return ct}throw new en("Could not convert "+JSON.stringify(Ee)+" to number.")}return this.type.kind==="formatted"?hr.fromString(Jr(this.args[0].evaluate(M))):this.type.kind==="resolvedImage"?vr.fromString(Jr(this.args[0].evaluate(M))):Jr(this.args[0].evaluate(M))},Br.prototype.eachChild=function(M){this.args.forEach(M)},Br.prototype.outputDefined=function(){return this.args.every(function(M){return M.outputDefined()})},Br.prototype.serialize=function(){if(this.type.kind==="formatted")return new gn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Sn(this.args[0]).serialize();var M=["to-"+this.type.kind];return this.eachChild(function(O){M.push(O.serialize())}),M};var pn=["Unknown","Point","LineString","Polygon"],on=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};on.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},on.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?pn[this.feature.type]:this.feature.type:null},on.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},on.prototype.canonicalID=function(){return this.canonical},on.prototype.properties=function(){return this.feature&&this.feature.properties||{}},on.prototype.parseColor=function(M){var O=this._parseColorCache[M];return O||(O=this._parseColorCache[M]=Zt.parse(M)),O};var Yr=function(M,O,Y,ae){this.name=M,this.type=O,this._evaluate=Y,this.args=ae};Yr.prototype.evaluate=function(M){return this._evaluate(M,this.args)},Yr.prototype.eachChild=function(M){this.args.forEach(M)},Yr.prototype.outputDefined=function(){return!1},Yr.prototype.serialize=function(){return[this.name].concat(this.args.map(function(M){return M.serialize()}))},Yr.parse=function(M,O){var Y,ae=M[0],pe=Yr.definitions[ae];if(!pe)return O.error('Unknown expression "'+ae+'". If you wanted a literal array, use ["literal", [...]].',0);for(var ye=Array.isArray(pe)?pe[0]:pe.type,Ee=Array.isArray(pe)?[[pe[1],pe[2]]]:pe.overloads,Ne=Ee.filter(function(la){var $n=la[0];return!Array.isArray($n)||$n.length===M.length-1}),Qe=null,ct=0,mt=Ne;ct<mt.length;ct+=1){var Dt=mt[ct],Wt=Dt[0],Vt=Dt[1];Qe=new rn(O.registry,O.path,null,O.scope);for(var sr=[],br=!1,Ir=1;Ir<M.length;Ir++){var Pr=M[Ir],Vr=Array.isArray(Wt)?Wt[Ir-1]:Wt.type,Hr=Qe.parse(Pr,1+sr.length,Vr);if(!Hr){br=!0;break}sr.push(Hr)}if(!br)if(Array.isArray(Wt)&&Wt.length!==sr.length)Qe.error("Expected "+Wt.length+" arguments, but found "+sr.length+" instead.");else{for(var Xr=0;Xr<sr.length;Xr++){var un=Array.isArray(Wt)?Wt[Xr]:Wt.type,bn=sr[Xr];Qe.concat(Xr+1).checkSubtype(un,bn.type)}if(Qe.errors.length===0)return new Yr(ae,ye,Vt,sr)}}if(Ne.length===1)(Y=O.errors).push.apply(Y,Qe.errors);else{for(var jn=(Ne.length?Ne:Ee).map(function(la){var $n,ma=la[0];return $n=ma,Array.isArray($n)?"("+$n.map(Rt).join(", ")+")":"("+Rt($n.type)+"...)"}).join(" | "),Bn=[],Wn=1;Wn<M.length;Wn++){var sa=O.parse(M[Wn],1+Bn.length);if(!sa)return null;Bn.push(Rt(sa.type))}O.error("Expected arguments of type "+jn+", but found ("+Bn.join(", ")+") instead.")}return null},Yr.register=function(M,O){for(var Y in Yr.definitions=O,O)M[Y]=Yr};var Nn=function(M,O,Y){this.type=Ye,this.locale=Y,this.caseSensitive=M,this.diacriticSensitive=O};Nn.parse=function(M,O){if(M.length!==2)return O.error("Expected one argument.");var Y=M[1];if(typeof Y!="object"||Array.isArray(Y))return O.error("Collator options argument must be an object.");var ae=O.parse(Y["case-sensitive"]!==void 0&&Y["case-sensitive"],1,Ft);if(!ae)return null;var pe=O.parse(Y["diacritic-sensitive"]!==void 0&&Y["diacritic-sensitive"],1,Ft);if(!pe)return null;var ye=null;return Y.locale&&!(ye=O.parse(Y.locale,1,ut))?null:new Nn(ae,pe,ye)},Nn.prototype.evaluate=function(M){return new Qt(this.caseSensitive.evaluate(M),this.diacriticSensitive.evaluate(M),this.locale?this.locale.evaluate(M):null)},Nn.prototype.eachChild=function(M){M(this.caseSensitive),M(this.diacriticSensitive),this.locale&&M(this.locale)},Nn.prototype.outputDefined=function(){return!1},Nn.prototype.serialize=function(){var M={};return M["case-sensitive"]=this.caseSensitive.serialize(),M["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(M.locale=this.locale.serialize()),["collator",M]};function Hn(M,O){M[0]=Math.min(M[0],O[0]),M[1]=Math.min(M[1],O[1]),M[2]=Math.max(M[2],O[0]),M[3]=Math.max(M[3],O[1])}function xn(M,O){return!(M[0]<=O[0])&&!(M[2]>=O[2])&&!(M[1]<=O[1])&&!(M[3]>=O[3])}function On(M,O){var Y,ae=(180+M[0])/360,pe=(Y=M[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+Y*Math.PI/360)))/360),ye=Math.pow(2,O.z);return[Math.round(ae*ye*8192),Math.round(pe*ye*8192)]}function ua(M,O,Y){return O[1]>M[1]!=Y[1]>M[1]&&M[0]<(Y[0]-O[0])*(M[1]-O[1])/(Y[1]-O[1])+O[0]}function tr(M,O){for(var Y,ae,pe,ye,Ee,Ne,Qe,ct=!1,mt=0,Dt=O.length;mt<Dt;mt++)for(var Wt=O[mt],Vt=0,sr=Wt.length;Vt<sr-1;Vt++){if(Y=M,ae=Wt[Vt],pe=Wt[Vt+1],ye=void 0,Ee=void 0,Ne=void 0,Qe=void 0,ye=Y[0]-ae[0],Ee=Y[1]-ae[1],Ne=Y[0]-pe[0],Qe=Y[1]-pe[1],ye*Qe-Ne*Ee==0&&ye*Ne<=0&&Ee*Qe<=0)return!1;ua(M,Wt[Vt],Wt[Vt+1])&&(ct=!ct)}return ct}function yr(M,O){for(var Y=0;Y<O.length;Y++)if(tr(M,O[Y]))return!0;return!1}function Ct(M,O,Y,ae){var pe=M[0]-Y[0],ye=M[1]-Y[1],Ee=O[0]-Y[0],Ne=O[1]-Y[1],Qe=ae[0]-Y[0],ct=ae[1]-Y[1],mt=pe*ct-Qe*ye,Dt=Ee*ct-Qe*Ne;return mt>0&&Dt<0||mt<0&&Dt>0}function lr(M,O,Y){for(var ae=0,pe=Y;ae<pe.length;ae+=1)for(var ye=pe[ae],Ee=0;Ee<ye.length-1;++Ee)if(Ne=M,Qe=O,ct=ye[Ee],mt=ye[Ee+1],Dt=void 0,Wt=void 0,Vt=void 0,sr=void 0,Vt=[Qe[0]-Ne[0],Qe[1]-Ne[1]],sr=[mt[0]-ct[0],mt[1]-ct[1]],(Dt=sr)[0]*(Wt=Vt)[1]-Dt[1]*Wt[0]!=0&&Ct(Ne,Qe,ct,mt)&&Ct(ct,mt,Ne,Qe))return!0;var Ne,Qe,ct,mt,Dt,Wt,Vt,sr;return!1}function dr(M,O){for(var Y=0;Y<M.length;++Y)if(!tr(M[Y],O))return!1;for(var ae=0;ae<M.length-1;++ae)if(lr(M[ae],M[ae+1],O))return!1;return!0}function Fr(M,O){for(var Y=0;Y<O.length;Y++)if(dr(M,O[Y]))return!0;return!1}function Rr(M,O,Y){for(var ae=[],pe=0;pe<M.length;pe++){for(var ye=[],Ee=0;Ee<M[pe].length;Ee++){var Ne=On(M[pe][Ee],Y);Hn(O,Ne),ye.push(Ne)}ae.push(ye)}return ae}function zr(M,O,Y){for(var ae=[],pe=0;pe<M.length;pe++){var ye=Rr(M[pe],O,Y);ae.push(ye)}return ae}function Er(M,O,Y,ae){if(M[0]<Y[0]||M[0]>Y[2]){var pe=.5*ae,ye=M[0]-Y[0]>pe?-ae:Y[0]-M[0]>pe?ae:0;ye===0&&(ye=M[0]-Y[2]>pe?-ae:Y[2]-M[0]>pe?ae:0),M[0]+=ye}Hn(O,M)}function xr(M,O,Y,ae){for(var pe=8192*Math.pow(2,ae.z),ye=[8192*ae.x,8192*ae.y],Ee=[],Ne=0,Qe=M;Ne<Qe.length;Ne+=1)for(var ct=0,mt=Qe[Ne];ct<mt.length;ct+=1){var Dt=mt[ct],Wt=[Dt.x+ye[0],Dt.y+ye[1]];Er(Wt,O,Y,pe),Ee.push(Wt)}return Ee}function _r(M,O,Y,ae){for(var pe,ye=8192*Math.pow(2,ae.z),Ee=[8192*ae.x,8192*ae.y],Ne=[],Qe=0,ct=M;Qe<ct.length;Qe+=1){for(var mt=[],Dt=0,Wt=ct[Qe];Dt<Wt.length;Dt+=1){var Vt=Wt[Dt],sr=[Vt.x+Ee[0],Vt.y+Ee[1]];Hn(O,sr),mt.push(sr)}Ne.push(mt)}if(O[2]-O[0]<=ye/2){(pe=O)[0]=pe[1]=1/0,pe[2]=pe[3]=-1/0;for(var br=0,Ir=Ne;br<Ir.length;br+=1)for(var Pr=0,Vr=Ir[br];Pr<Vr.length;Pr+=1)Er(Vr[Pr],O,Y,ye)}return Ne}var kr=function(M,O){this.type=Ft,this.geojson=M,this.geometries=O};function Cr(M){if(M instanceof Yr&&(M.name==="get"&&M.args.length===1||M.name==="feature-state"||M.name==="has"&&M.args.length===1||M.name==="properties"||M.name==="geometry-type"||M.name==="id"||/^filter-/.test(M.name))||M instanceof kr)return!1;var O=!0;return M.eachChild(function(Y){O&&!Cr(Y)&&(O=!1)}),O}function Gr(M){if(M instanceof Yr&&M.name==="feature-state")return!1;var O=!0;return M.eachChild(function(Y){O&&!Gr(Y)&&(O=!1)}),O}function qr(M,O){if(M instanceof Yr&&O.indexOf(M.name)>=0)return!1;var Y=!0;return M.eachChild(function(ae){Y&&!qr(ae,O)&&(Y=!1)}),Y}kr.parse=function(M,O){if(M.length!==2)return O.error("'within' expression requires exactly one argument, but found "+(M.length-1)+" instead.");if(Nr(M[1])){var Y=M[1];if(Y.type==="FeatureCollection")for(var ae=0;ae<Y.features.length;++ae){var pe=Y.features[ae].geometry.type;if(pe==="Polygon"||pe==="MultiPolygon")return new kr(Y,Y.features[ae].geometry)}else if(Y.type==="Feature"){var ye=Y.geometry.type;if(ye==="Polygon"||ye==="MultiPolygon")return new kr(Y,Y.geometry)}else if(Y.type==="Polygon"||Y.type==="MultiPolygon")return new kr(Y,Y)}return O.error("'within' expression requires valid geojson object that contains polygon geometry type.")},kr.prototype.evaluate=function(M){if(M.geometry()!=null&&M.canonicalID()!=null){if(M.geometryType()==="Point")return function(O,Y){var ae=[1/0,1/0,-1/0,-1/0],pe=[1/0,1/0,-1/0,-1/0],ye=O.canonicalID();if(Y.type==="Polygon"){var Ee=Rr(Y.coordinates,pe,ye),Ne=xr(O.geometry(),ae,pe,ye);if(!xn(ae,pe))return!1;for(var Qe=0,ct=Ne;Qe<ct.length;Qe+=1)if(!tr(ct[Qe],Ee))return!1}if(Y.type==="MultiPolygon"){var mt=zr(Y.coordinates,pe,ye),Dt=xr(O.geometry(),ae,pe,ye);if(!xn(ae,pe))return!1;for(var Wt=0,Vt=Dt;Wt<Vt.length;Wt+=1)if(!yr(Vt[Wt],mt))return!1}return!0}(M,this.geometries);if(M.geometryType()==="LineString")return function(O,Y){var ae=[1/0,1/0,-1/0,-1/0],pe=[1/0,1/0,-1/0,-1/0],ye=O.canonicalID();if(Y.type==="Polygon"){var Ee=Rr(Y.coordinates,pe,ye),Ne=_r(O.geometry(),ae,pe,ye);if(!xn(ae,pe))return!1;for(var Qe=0,ct=Ne;Qe<ct.length;Qe+=1)if(!dr(ct[Qe],Ee))return!1}if(Y.type==="MultiPolygon"){var mt=zr(Y.coordinates,pe,ye),Dt=_r(O.geometry(),ae,pe,ye);if(!xn(ae,pe))return!1;for(var Wt=0,Vt=Dt;Wt<Vt.length;Wt+=1)if(!Fr(Vt[Wt],mt))return!1}return!0}(M,this.geometries)}return!1},kr.prototype.eachChild=function(){},kr.prototype.outputDefined=function(){return!0},kr.prototype.serialize=function(){return["within",this.geojson]};var tn=function(M,O){this.type=O.type,this.name=M,this.boundExpression=O};tn.parse=function(M,O){if(M.length!==2||typeof M[1]!="string")return O.error("'var' expression requires exactly one string literal argument.");var Y=M[1];return O.scope.has(Y)?new tn(Y,O.scope.get(Y)):O.error('Unknown variable "'+Y+'". Make sure "'+Y+'" has been bound in an enclosing "let" expression before using it.',1)},tn.prototype.evaluate=function(M){return this.boundExpression.evaluate(M)},tn.prototype.eachChild=function(){},tn.prototype.outputDefined=function(){return!1},tn.prototype.serialize=function(){return["var",this.name]};var rn=function(M,O,Y,ae,pe){O===void 0&&(O=[]),ae===void 0&&(ae=new Tt),pe===void 0&&(pe=[]),this.registry=M,this.path=O,this.key=O.map(function(ye){return"["+ye+"]"}).join(""),this.scope=ae,this.errors=pe,this.expectedType=Y};function yn(M,O){for(var Y,ae,pe=M.length-1,ye=0,Ee=pe,Ne=0;ye<=Ee;)if(Y=M[Ne=Math.floor((ye+Ee)/2)],ae=M[Ne+1],Y<=O){if(Ne===pe||O<ae)return Ne;ye=Ne+1}else{if(!(Y>O))throw new en("Input is not a number.");Ee=Ne-1}return 0}rn.prototype.parse=function(M,O,Y,ae,pe){return pe===void 0&&(pe={}),O?this.concat(O,Y,ae)._parse(M,pe):this._parse(M,pe)},rn.prototype._parse=function(M,O){function Y(ct,mt,Dt){return Dt==="assert"?new vn(mt,[ct]):Dt==="coerce"?new Br(mt,[ct]):ct}if(M!==null&&typeof M!="string"&&typeof M!="boolean"&&typeof M!="number"||(M=["literal",M]),Array.isArray(M)){if(M.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var ae=M[0];if(typeof ae!="string")return this.error("Expression name must be a string, but found "+typeof ae+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var pe=this.registry[ae];if(pe){var ye=pe.parse(M,this);if(!ye)return null;if(this.expectedType){var Ee=this.expectedType,Ne=ye.type;if(Ee.kind!=="string"&&Ee.kind!=="number"&&Ee.kind!=="boolean"&&Ee.kind!=="object"&&Ee.kind!=="array"||Ne.kind!=="value")if(Ee.kind!=="color"&&Ee.kind!=="formatted"&&Ee.kind!=="resolvedImage"||Ne.kind!=="value"&&Ne.kind!=="string"){if(this.checkSubtype(Ee,Ne))return null}else ye=Y(ye,Ee,O.typeAnnotation||"coerce");else ye=Y(ye,Ee,O.typeAnnotation||"assert")}if(!(ye instanceof mn)&&ye.type.kind!=="resolvedImage"&&function ct(mt){if(mt instanceof tn)return ct(mt.boundExpression);if(mt instanceof Yr&&mt.name==="error"||mt instanceof Nn||mt instanceof kr)return!1;var Dt=mt instanceof Br||mt instanceof vn,Wt=!0;return mt.eachChild(function(Vt){Wt=Dt?Wt&&ct(Vt):Wt&&Vt instanceof mn}),Wt?Cr(mt)&&qr(mt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}(ye)){var Qe=new on;try{ye=new mn(ye.type,ye.evaluate(Qe))}catch(ct){return this.error(ct.message),null}}return ye}return this.error('Unknown expression "'+ae+'". If you wanted a literal array, use ["literal", [...]].',0)}return M===void 0?this.error("'undefined' value invalid. Use null instead."):typeof M=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof M+" instead.")},rn.prototype.concat=function(M,O,Y){var ae=typeof M=="number"?this.path.concat(M):this.path,pe=Y?this.scope.concat(Y):this.scope;return new rn(this.registry,ae,O||null,pe,this.errors)},rn.prototype.error=function(M){for(var O=[],Y=arguments.length-1;Y-- >0;)O[Y]=arguments[Y+1];var ae=""+this.key+O.map(function(pe){return"["+pe+"]"}).join("");this.errors.push(new it(ae,M))},rn.prototype.checkSubtype=function(M,O){var Y=jt(M,O);return Y&&this.error(Y),Y};var _n=function(M,O,Y){this.type=M,this.input=O,this.labels=[],this.outputs=[];for(var ae=0,pe=Y;ae<pe.length;ae+=1){var ye=pe[ae],Ee=ye[0],Ne=ye[1];this.labels.push(Ee),this.outputs.push(Ne)}};function wn(M,O,Y){return M*(1-Y)+O*Y}_n.parse=function(M,O){if(M.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(M.length-1)+".");if((M.length-1)%2!=0)return O.error("Expected an even number of arguments.");var Y=O.parse(M[1],1,rt);if(!Y)return null;var ae=[],pe=null;O.expectedType&&O.expectedType.kind!=="value"&&(pe=O.expectedType);for(var ye=1;ye<M.length;ye+=2){var Ee=ye===1?-1/0:M[ye],Ne=M[ye+1],Qe=ye,ct=ye+1;if(typeof Ee!="number")return O.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Qe);if(ae.length&&ae[ae.length-1][0]>=Ee)return O.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Qe);var mt=O.parse(Ne,ct,pe);if(!mt)return null;pe=pe||mt.type,ae.push([Ee,mt])}return new _n(pe,Y,ae)},_n.prototype.evaluate=function(M){var O=this.labels,Y=this.outputs;if(O.length===1)return Y[0].evaluate(M);var ae=this.input.evaluate(M);if(ae<=O[0])return Y[0].evaluate(M);var pe=O.length;return ae>=O[pe-1]?Y[pe-1].evaluate(M):Y[yn(O,ae)].evaluate(M)},_n.prototype.eachChild=function(M){M(this.input);for(var O=0,Y=this.outputs;O<Y.length;O+=1)M(Y[O])},_n.prototype.outputDefined=function(){return this.outputs.every(function(M){return M.outputDefined()})},_n.prototype.serialize=function(){for(var M=["step",this.input.serialize()],O=0;O<this.labels.length;O++)O>0&&M.push(this.labels[O]),M.push(this.outputs[O].serialize());return M};var Ln=Object.freeze({__proto__:null,number:wn,color:function(M,O,Y){return new Zt(wn(M.r,O.r,Y),wn(M.g,O.g,Y),wn(M.b,O.b,Y),wn(M.a,O.a,Y))},array:function(M,O,Y){return M.map(function(ae,pe){return wn(ae,O[pe],Y)})}}),zn=6/29,Zn=3*zn*zn,Aa=Math.PI/180,Ma=180/Math.PI;function An(M){return M>.008856451679035631?Math.pow(M,1/3):M/Zn+4/29}function ea(M){return M>zn?M*M*M:Zn*(M-4/29)}function Qn(M){return 255*(M<=.0031308?12.92*M:1.055*Math.pow(M,1/2.4)-.055)}function za(M){return(M/=255)<=.04045?M/12.92:Math.pow((M+.055)/1.055,2.4)}function vi(M){var O=za(M.r),Y=za(M.g),ae=za(M.b),pe=An((.4124564*O+.3575761*Y+.1804375*ae)/.95047),ye=An((.2126729*O+.7151522*Y+.072175*ae)/1);return{l:116*ye-16,a:500*(pe-ye),b:200*(ye-An((.0193339*O+.119192*Y+.9503041*ae)/1.08883)),alpha:M.a}}function Fi(M){var O=(M.l+16)/116,Y=isNaN(M.a)?O:O+M.a/500,ae=isNaN(M.b)?O:O-M.b/200;return O=1*ea(O),Y=.95047*ea(Y),ae=1.08883*ea(ae),new Zt(Qn(3.2404542*Y-1.5371385*O-.4985314*ae),Qn(-.969266*Y+1.8760108*O+.041556*ae),Qn(.0556434*Y-.2040259*O+1.0572252*ae),M.alpha)}function po(M,O,Y){var ae=O-M;return M+Y*(ae>180||ae<-180?ae-360*Math.round(ae/360):ae)}var Xa={forward:vi,reverse:Fi,interpolate:function(M,O,Y){return{l:wn(M.l,O.l,Y),a:wn(M.a,O.a,Y),b:wn(M.b,O.b,Y),alpha:wn(M.alpha,O.alpha,Y)}}},Za={forward:function(M){var O=vi(M),Y=O.l,ae=O.a,pe=O.b,ye=Math.atan2(pe,ae)*Ma;return{h:ye<0?ye+360:ye,c:Math.sqrt(ae*ae+pe*pe),l:Y,alpha:M.a}},reverse:function(M){var O=M.h*Aa,Y=M.c;return Fi({l:M.l,a:Math.cos(O)*Y,b:Math.sin(O)*Y,alpha:M.alpha})},interpolate:function(M,O,Y){return{h:po(M.h,O.h,Y),c:wn(M.c,O.c,Y),l:wn(M.l,O.l,Y),alpha:wn(M.alpha,O.alpha,Y)}}},eo=Object.freeze({__proto__:null,lab:Xa,hcl:Za}),Na=function(M,O,Y,ae,pe){this.type=M,this.operator=O,this.interpolation=Y,this.input=ae,this.labels=[],this.outputs=[];for(var ye=0,Ee=pe;ye<Ee.length;ye+=1){var Ne=Ee[ye],Qe=Ne[0],ct=Ne[1];this.labels.push(Qe),this.outputs.push(ct)}};function mo(M,O,Y,ae){var pe=ae-Y,ye=M-Y;return pe===0?0:O===1?ye/pe:(Math.pow(O,ye)-1)/(Math.pow(O,pe)-1)}Na.interpolationFactor=function(M,O,Y,ae){var pe=0;if(M.name==="exponential")pe=mo(O,M.base,Y,ae);else if(M.name==="linear")pe=mo(O,1,Y,ae);else if(M.name==="cubic-bezier"){var ye=M.controlPoints;pe=new t(ye[0],ye[1],ye[2],ye[3]).solve(mo(O,1,Y,ae))}return pe},Na.parse=function(M,O){var Y=M[0],ae=M[1],pe=M[2],ye=M.slice(3);if(!Array.isArray(ae)||ae.length===0)return O.error("Expected an interpolation type expression.",1);if(ae[0]==="linear")ae={name:"linear"};else if(ae[0]==="exponential"){var Ee=ae[1];if(typeof Ee!="number")return O.error("Exponential interpolation requires a numeric base.",1,1);ae={name:"exponential",base:Ee}}else{if(ae[0]!=="cubic-bezier")return O.error("Unknown interpolation type "+String(ae[0]),1,0);var Ne=ae.slice(1);if(Ne.length!==4||Ne.some(function(Ir){return typeof Ir!="number"||Ir<0||Ir>1}))return O.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);ae={name:"cubic-bezier",controlPoints:Ne}}if(M.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(M.length-1)+".");if((M.length-1)%2!=0)return O.error("Expected an even number of arguments.");if(!(pe=O.parse(pe,2,rt)))return null;var Qe=[],ct=null;Y==="interpolate-hcl"||Y==="interpolate-lab"?ct=wt:O.expectedType&&O.expectedType.kind!=="value"&&(ct=O.expectedType);for(var mt=0;mt<ye.length;mt+=2){var Dt=ye[mt],Wt=ye[mt+1],Vt=mt+3,sr=mt+4;if(typeof Dt!="number")return O.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Vt);if(Qe.length&&Qe[Qe.length-1][0]>=Dt)return O.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Vt);var br=O.parse(Wt,sr,ct);if(!br)return null;ct=ct||br.type,Qe.push([Dt,br])}return ct.kind==="number"||ct.kind==="color"||ct.kind==="array"&&ct.itemType.kind==="number"&&typeof ct.N=="number"?new Na(ct,Y,ae,pe,Qe):O.error("Type "+Rt(ct)+" is not interpolatable.")},Na.prototype.evaluate=function(M){var O=this.labels,Y=this.outputs;if(O.length===1)return Y[0].evaluate(M);var ae=this.input.evaluate(M);if(ae<=O[0])return Y[0].evaluate(M);var pe=O.length;if(ae>=O[pe-1])return Y[pe-1].evaluate(M);var ye=yn(O,ae),Ee=O[ye],Ne=O[ye+1],Qe=Na.interpolationFactor(this.interpolation,ae,Ee,Ne),ct=Y[ye].evaluate(M),mt=Y[ye+1].evaluate(M);return this.operator==="interpolate"?Ln[this.type.kind.toLowerCase()](ct,mt,Qe):this.operator==="interpolate-hcl"?Za.reverse(Za.interpolate(Za.forward(ct),Za.forward(mt),Qe)):Xa.reverse(Xa.interpolate(Xa.forward(ct),Xa.forward(mt),Qe))},Na.prototype.eachChild=function(M){M(this.input);for(var O=0,Y=this.outputs;O<Y.length;O+=1)M(Y[O])},Na.prototype.outputDefined=function(){return this.outputs.every(function(M){return M.outputDefined()})},Na.prototype.serialize=function(){var M;M=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var O=[this.operator,M,this.input.serialize()],Y=0;Y<this.labels.length;Y++)O.push(this.labels[Y],this.outputs[Y].serialize());return O};var bo=function(M,O){this.type=M,this.args=O};bo.parse=function(M,O){if(M.length<2)return O.error("Expectected at least one argument.");var Y=null,ae=O.expectedType;ae&&ae.kind!=="value"&&(Y=ae);for(var pe=[],ye=0,Ee=M.slice(1);ye<Ee.length;ye+=1){var Ne=Ee[ye],Qe=O.parse(Ne,1+pe.length,Y,void 0,{typeAnnotation:"omit"});if(!Qe)return null;Y=Y||Qe.type,pe.push(Qe)}var ct=ae&&pe.some(function(mt){return jt(ae,mt.type)});return new bo(ct?Ae:Y,pe)},bo.prototype.evaluate=function(M){for(var O,Y=null,ae=0,pe=0,ye=this.args;pe<ye.length&&(ae++,(Y=ye[pe].evaluate(M))&&Y instanceof vr&&!Y.available&&(O||(O=Y.name),Y=null,ae===this.args.length&&(Y=O)),Y===null);pe+=1);return Y},bo.prototype.eachChild=function(M){this.args.forEach(M)},bo.prototype.outputDefined=function(){return this.args.every(function(M){return M.outputDefined()})},bo.prototype.serialize=function(){var M=["coalesce"];return this.eachChild(function(O){M.push(O.serialize())}),M};var Mi=function(M,O){this.type=O.type,this.bindings=[].concat(M),this.result=O};Mi.prototype.evaluate=function(M){return this.result.evaluate(M)},Mi.prototype.eachChild=function(M){for(var O=0,Y=this.bindings;O<Y.length;O+=1)M(Y[O][1]);M(this.result)},Mi.parse=function(M,O){if(M.length<4)return O.error("Expected at least 3 arguments, but found "+(M.length-1)+" instead.");for(var Y=[],ae=1;ae<M.length-1;ae+=2){var pe=M[ae];if(typeof pe!="string")return O.error("Expected string, but found "+typeof pe+" instead.",ae);if(/[^a-zA-Z0-9_]/.test(pe))return O.error("Variable names must contain only alphanumeric characters or '_'.",ae);var ye=O.parse(M[ae+1],ae+1);if(!ye)return null;Y.push([pe,ye])}var Ee=O.parse(M[M.length-1],M.length-1,O.expectedType,Y);return Ee?new Mi(Y,Ee):null},Mi.prototype.outputDefined=function(){return this.result.outputDefined()},Mi.prototype.serialize=function(){for(var M=["let"],O=0,Y=this.bindings;O<Y.length;O+=1){var ae=Y[O],pe=ae[0],ye=ae[1];M.push(pe,ye.serialize())}return M.push(this.result.serialize()),M};var to=function(M,O,Y){this.type=M,this.index=O,this.input=Y};to.parse=function(M,O){if(M.length!==3)return O.error("Expected 2 arguments, but found "+(M.length-1)+" instead.");var Y=O.parse(M[1],1,rt),ae=O.parse(M[2],2,Mt(O.expectedType||Ae));if(!Y||!ae)return null;var pe=ae.type;return new to(pe.itemType,Y,ae)},to.prototype.evaluate=function(M){var O=this.index.evaluate(M),Y=this.input.evaluate(M);if(O<0)throw new en("Array index out of bounds: "+O+" < 0.");if(O>=Y.length)throw new en("Array index out of bounds: "+O+" > "+(Y.length-1)+".");if(O!==Math.floor(O))throw new en("Array index must be an integer, but found "+O+" instead.");return Y[O]},to.prototype.eachChild=function(M){M(this.index),M(this.input)},to.prototype.outputDefined=function(){return!1},to.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var _o=function(M,O){this.type=Ft,this.needle=M,this.haystack=O};_o.parse=function(M,O){if(M.length!==3)return O.error("Expected 2 arguments, but found "+(M.length-1)+" instead.");var Y=O.parse(M[1],1,Ae),ae=O.parse(M[2],2,Ae);return Y&&ae?pr(Y.type,[Ft,ut,rt,Pt,Ae])?new _o(Y,ae):O.error("Expected first argument to be of type boolean, string, number or null, but found "+Rt(Y.type)+" instead"):null},_o.prototype.evaluate=function(M){var O=this.needle.evaluate(M),Y=this.haystack.evaluate(M);if(!Y)return!1;if(!Ar(O,["boolean","string","number","null"]))throw new en("Expected first argument to be of type boolean, string, number or null, but found "+Rt(Ur(O))+" instead.");if(!Ar(Y,["string","array"]))throw new en("Expected second argument to be of type array or string, but found "+Rt(Ur(Y))+" instead.");return Y.indexOf(O)>=0},_o.prototype.eachChild=function(M){M(this.needle),M(this.haystack)},_o.prototype.outputDefined=function(){return!0},_o.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Co=function(M,O,Y){this.type=rt,this.needle=M,this.haystack=O,this.fromIndex=Y};Co.parse=function(M,O){if(M.length<=2||M.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(M.length-1)+" instead.");var Y=O.parse(M[1],1,Ae),ae=O.parse(M[2],2,Ae);if(!Y||!ae)return null;if(!pr(Y.type,[Ft,ut,rt,Pt,Ae]))return O.error("Expected first argument to be of type boolean, string, number or null, but found "+Rt(Y.type)+" instead");if(M.length===4){var pe=O.parse(M[3],3,rt);return pe?new Co(Y,ae,pe):null}return new Co(Y,ae)},Co.prototype.evaluate=function(M){var O=this.needle.evaluate(M),Y=this.haystack.evaluate(M);if(!Ar(O,["boolean","string","number","null"]))throw new en("Expected first argument to be of type boolean, string, number or null, but found "+Rt(Ur(O))+" instead.");if(!Ar(Y,["string","array"]))throw new en("Expected second argument to be of type array or string, but found "+Rt(Ur(Y))+" instead.");if(this.fromIndex){var ae=this.fromIndex.evaluate(M);return Y.indexOf(O,ae)}return Y.indexOf(O)},Co.prototype.eachChild=function(M){M(this.needle),M(this.haystack),this.fromIndex&&M(this.fromIndex)},Co.prototype.outputDefined=function(){return!1},Co.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var M=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),M]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Ui=function(M,O,Y,ae,pe,ye){this.inputType=M,this.type=O,this.input=Y,this.cases=ae,this.outputs=pe,this.otherwise=ye};Ui.parse=function(M,O){if(M.length<5)return O.error("Expected at least 4 arguments, but found only "+(M.length-1)+".");if(M.length%2!=1)return O.error("Expected an even number of arguments.");var Y,ae;O.expectedType&&O.expectedType.kind!=="value"&&(ae=O.expectedType);for(var pe={},ye=[],Ee=2;Ee<M.length-1;Ee+=2){var Ne=M[Ee],Qe=M[Ee+1];Array.isArray(Ne)||(Ne=[Ne]);var ct=O.concat(Ee);if(Ne.length===0)return ct.error("Expected at least one branch label.");for(var mt=0,Dt=Ne;mt<Dt.length;mt+=1){var Wt=Dt[mt];if(typeof Wt!="number"&&typeof Wt!="string")return ct.error("Branch labels must be numbers or strings.");if(typeof Wt=="number"&&Math.abs(Wt)>Number.MAX_SAFE_INTEGER)return ct.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Wt=="number"&&Math.floor(Wt)!==Wt)return ct.error("Numeric branch labels must be integer values.");if(Y){if(ct.checkSubtype(Y,Ur(Wt)))return null}else Y=Ur(Wt);if(pe[String(Wt)]!==void 0)return ct.error("Branch labels must be unique.");pe[String(Wt)]=ye.length}var Vt=O.parse(Qe,Ee,ae);if(!Vt)return null;ae=ae||Vt.type,ye.push(Vt)}var sr=O.parse(M[1],1,Ae);if(!sr)return null;var br=O.parse(M[M.length-1],M.length-1,ae);return br?sr.type.kind!=="value"&&O.concat(1).checkSubtype(Y,sr.type)?null:new Ui(Y,ae,sr,pe,ye,br):null},Ui.prototype.evaluate=function(M){var O=this.input.evaluate(M);return(Ur(O)===this.inputType&&this.outputs[this.cases[O]]||this.otherwise).evaluate(M)},Ui.prototype.eachChild=function(M){M(this.input),this.outputs.forEach(M),M(this.otherwise)},Ui.prototype.outputDefined=function(){return this.outputs.every(function(M){return M.outputDefined()})&&this.otherwise.outputDefined()},Ui.prototype.serialize=function(){for(var M=this,O=["match",this.input.serialize()],Y=[],ae={},pe=0,ye=Object.keys(this.cases).sort();pe<ye.length;pe+=1){var Ee=ye[pe];(Dt=ae[this.cases[Ee]])===void 0?(ae[this.cases[Ee]]=Y.length,Y.push([this.cases[Ee],[Ee]])):Y[Dt][1].push(Ee)}for(var Ne=function(Vt){return M.inputType.kind==="number"?Number(Vt):Vt},Qe=0,ct=Y;Qe<ct.length;Qe+=1){var mt=ct[Qe],Dt=mt[0],Wt=mt[1];Wt.length===1?O.push(Ne(Wt[0])):O.push(Wt.map(Ne)),O.push(this.outputs[outputIndex$1].serialize())}return O.push(this.otherwise.serialize()),O};var yi=function(M,O,Y){this.type=M,this.branches=O,this.otherwise=Y};yi.parse=function(M,O){if(M.length<4)return O.error("Expected at least 3 arguments, but found only "+(M.length-1)+".");if(M.length%2!=0)return O.error("Expected an odd number of arguments.");var Y;O.expectedType&&O.expectedType.kind!=="value"&&(Y=O.expectedType);for(var ae=[],pe=1;pe<M.length-1;pe+=2){var ye=O.parse(M[pe],pe,Ft);if(!ye)return null;var Ee=O.parse(M[pe+1],pe+1,Y);if(!Ee)return null;ae.push([ye,Ee]),Y=Y||Ee.type}var Ne=O.parse(M[M.length-1],M.length-1,Y);return Ne?new yi(Y,ae,Ne):null},yi.prototype.evaluate=function(M){for(var O=0,Y=this.branches;O<Y.length;O+=1){var ae=Y[O],pe=ae[0],ye=ae[1];if(pe.evaluate(M))return ye.evaluate(M)}return this.otherwise.evaluate(M)},yi.prototype.eachChild=function(M){for(var O=0,Y=this.branches;O<Y.length;O+=1){var ae=Y[O],pe=ae[0],ye=ae[1];M(pe),M(ye)}M(this.otherwise)},yi.prototype.outputDefined=function(){return this.branches.every(function(M){return M[0],M[1].outputDefined()})&&this.otherwise.outputDefined()},yi.prototype.serialize=function(){var M=["case"];return this.eachChild(function(O){M.push(O.serialize())}),M};var Ki=function(M,O,Y,ae){this.type=M,this.input=O,this.beginIndex=Y,this.endIndex=ae};function Ts(M,O){return M==="=="||M==="!="?O.kind==="boolean"||O.kind==="string"||O.kind==="number"||O.kind==="null"||O.kind==="value":O.kind==="string"||O.kind==="number"||O.kind==="value"}function Es(M,O,Y,ae){return ae.compare(O,Y)===0}function Ja(M,O,Y){var ae=M!=="=="&&M!=="!=";return function(){function pe(ye,Ee,Ne){this.type=Ft,this.lhs=ye,this.rhs=Ee,this.collator=Ne,this.hasUntypedArgument=ye.type.kind==="value"||Ee.type.kind==="value"}return pe.parse=function(ye,Ee){if(ye.length!==3&&ye.length!==4)return Ee.error("Expected two or three arguments.");var Ne=ye[0],Qe=Ee.parse(ye[1],1,Ae);if(!Qe)return null;if(!Ts(Ne,Qe.type))return Ee.concat(1).error('"'+Ne+`" comparisons are not supported for type '`+Rt(Qe.type)+"'.");var ct=Ee.parse(ye[2],2,Ae);if(!ct)return null;if(!Ts(Ne,ct.type))return Ee.concat(2).error('"'+Ne+`" comparisons are not supported for type '`+Rt(ct.type)+"'.");if(Qe.type.kind!==ct.type.kind&&Qe.type.kind!=="value"&&ct.type.kind!=="value")return Ee.error("Cannot compare types '"+Rt(Qe.type)+"' and '"+Rt(ct.type)+"'.");ae&&(Qe.type.kind==="value"&&ct.type.kind!=="value"?Qe=new vn(ct.type,[Qe]):Qe.type.kind!=="value"&&ct.type.kind==="value"&&(ct=new vn(Qe.type,[ct])));var mt=null;if(ye.length===4){if(Qe.type.kind!=="string"&&ct.type.kind!=="string"&&Qe.type.kind!=="value"&&ct.type.kind!=="value")return Ee.error("Cannot use collator to compare non-string types.");if(!(mt=Ee.parse(ye[3],3,Ye)))return null}return new pe(Qe,ct,mt)},pe.prototype.evaluate=function(ye){var Ee=this.lhs.evaluate(ye),Ne=this.rhs.evaluate(ye);if(ae&&this.hasUntypedArgument){var Qe=Ur(Ee),ct=Ur(Ne);if(Qe.kind!==ct.kind||Qe.kind!=="string"&&Qe.kind!=="number")throw new en('Expected arguments for "'+M+'" to be (string, string) or (number, number), but found ('+Qe.kind+", "+ct.kind+") instead.")}if(this.collator&&!ae&&this.hasUntypedArgument){var mt=Ur(Ee),Dt=Ur(Ne);if(mt.kind!=="string"||Dt.kind!=="string")return O(ye,Ee,Ne)}return this.collator?Y(ye,Ee,Ne,this.collator.evaluate(ye)):O(ye,Ee,Ne)},pe.prototype.eachChild=function(ye){ye(this.lhs),ye(this.rhs),this.collator&&ye(this.collator)},pe.prototype.outputDefined=function(){return!0},pe.prototype.serialize=function(){var ye=[M];return this.eachChild(function(Ee){ye.push(Ee.serialize())}),ye},pe}()}Ki.parse=function(M,O){if(M.length<=2||M.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(M.length-1)+" instead.");var Y=O.parse(M[1],1,Ae),ae=O.parse(M[2],2,rt);if(!Y||!ae)return null;if(!pr(Y.type,[Mt(Ae),ut,Ae]))return O.error("Expected first argument to be of type array or string, but found "+Rt(Y.type)+" instead");if(M.length===4){var pe=O.parse(M[3],3,rt);return pe?new Ki(Y.type,Y,ae,pe):null}return new Ki(Y.type,Y,ae)},Ki.prototype.evaluate=function(M){var O=this.input.evaluate(M),Y=this.beginIndex.evaluate(M);if(!Ar(O,["string","array"]))throw new en("Expected first argument to be of type array or string, but found "+Rt(Ur(O))+" instead.");if(this.endIndex){var ae=this.endIndex.evaluate(M);return O.slice(Y,ae)}return O.slice(Y)},Ki.prototype.eachChild=function(M){M(this.input),M(this.beginIndex),this.endIndex&&M(this.endIndex)},Ki.prototype.outputDefined=function(){return!1},Ki.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var M=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),M]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var vs=Ja("==",function(M,O,Y){return O===Y},Es),rs=Ja("!=",function(M,O,Y){return O!==Y},function(M,O,Y,ae){return!Es(0,O,Y,ae)}),Ls=Ja("<",function(M,O,Y){return O<Y},function(M,O,Y,ae){return ae.compare(O,Y)<0}),Cs=Ja(">",function(M,O,Y){return O>Y},function(M,O,Y,ae){return ae.compare(O,Y)>0}),ks=Ja("<=",function(M,O,Y){return O<=Y},function(M,O,Y,ae){return ae.compare(O,Y)<=0}),Ps=Ja(">=",function(M,O,Y){return O>=Y},function(M,O,Y,ae){return ae.compare(O,Y)>=0}),Oo=function(M,O,Y,ae,pe){this.type=ut,this.number=M,this.locale=O,this.currency=Y,this.minFractionDigits=ae,this.maxFractionDigits=pe};Oo.parse=function(M,O){if(M.length!==3)return O.error("Expected two arguments.");var Y=O.parse(M[1],1,rt);if(!Y)return null;var ae=M[2];if(typeof ae!="object"||Array.isArray(ae))return O.error("NumberFormat options argument must be an object.");var pe=null;if(ae.locale&&!(pe=O.parse(ae.locale,1,ut)))return null;var ye=null;if(ae.currency&&!(ye=O.parse(ae.currency,1,ut)))return null;var Ee=null;if(ae["min-fraction-digits"]&&!(Ee=O.parse(ae["min-fraction-digits"],1,rt)))return null;var Ne=null;return ae["max-fraction-digits"]&&!(Ne=O.parse(ae["max-fraction-digits"],1,rt))?null:new Oo(Y,pe,ye,Ee,Ne)},Oo.prototype.evaluate=function(M){return new Intl.NumberFormat(this.locale?this.locale.evaluate(M):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(M):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(M):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(M):void 0}).format(this.number.evaluate(M))},Oo.prototype.eachChild=function(M){M(this.number),this.locale&&M(this.locale),this.currency&&M(this.currency),this.minFractionDigits&&M(this.minFractionDigits),this.maxFractionDigits&&M(this.maxFractionDigits)},Oo.prototype.outputDefined=function(){return!1},Oo.prototype.serialize=function(){var M={};return this.locale&&(M.locale=this.locale.serialize()),this.currency&&(M.currency=this.currency.serialize()),this.minFractionDigits&&(M["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(M["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),M]};var zo=function(M){this.type=rt,this.input=M};zo.parse=function(M,O){if(M.length!==2)return O.error("Expected 1 argument, but found "+(M.length-1)+" instead.");var Y=O.parse(M[1],1);return Y?Y.type.kind!=="array"&&Y.type.kind!=="string"&&Y.type.kind!=="value"?O.error("Expected argument of type string or array, but found "+Rt(Y.type)+" instead."):new zo(Y):null},zo.prototype.evaluate=function(M){var O=this.input.evaluate(M);if(typeof O=="string"||Array.isArray(O))return O.length;throw new en("Expected value to be of type string or array, but found "+Rt(Ur(O))+" instead.")},zo.prototype.eachChild=function(M){M(this.input)},zo.prototype.outputDefined=function(){return!1},zo.prototype.serialize=function(){var M=["length"];return this.eachChild(function(O){M.push(O.serialize())}),M};var Go={"==":vs,"!=":rs,">":Cs,"<":Ls,">=":Ps,"<=":ks,array:vn,at:to,boolean:vn,case:yi,coalesce:bo,collator:Nn,format:gn,image:Sn,in:_o,"index-of":Co,interpolate:Na,"interpolate-hcl":Na,"interpolate-lab":Na,length:zo,let:Mi,literal:mn,match:Ui,number:vn,"number-format":Oo,object:vn,slice:Ki,step:_n,string:vn,"to-boolean":Br,"to-color":Br,"to-number":Br,"to-string":Br,var:tn,within:kr};function Yo(M,O){var Y=O[0],ae=O[1],pe=O[2],ye=O[3];Y=Y.evaluate(M),ae=ae.evaluate(M),pe=pe.evaluate(M);var Ee=ye?ye.evaluate(M):1,Ne=Mr(Y,ae,pe,Ee);if(Ne)throw new en(Ne);return new Zt(Y/255*Ee,ae/255*Ee,pe/255*Ee,Ee)}function Wo(M,O){return M in O}function ns(M,O){var Y=O[M];return Y===void 0?null:Y}function wo(M){return{type:M}}function ys(M){return{result:"success",value:M}}function go(M){return{result:"error",value:M}}function Xo(M){return M["property-type"]==="data-driven"||M["property-type"]==="cross-faded-data-driven"}function xs(M){return!!M.expression&&M.expression.parameters.indexOf("zoom")>-1}function Do(M){return!!M.expression&&M.expression.interpolated}function Ya(M){return M instanceof Number?"number":M instanceof String?"string":M instanceof Boolean?"boolean":Array.isArray(M)?"array":M===null?"null":typeof M}function je(M){return typeof M=="object"&&M!==null&&!Array.isArray(M)}function Ge(M){return M}function et(M,O,Y){return M!==void 0?M:O!==void 0?O:Y!==void 0?Y:void 0}function lt(M,O,Y,ae,pe){return et(typeof Y===pe?ae[Y]:void 0,M.default,O.default)}function gt(M,O,Y){if(Ya(Y)!=="number")return et(M.default,O.default);var ae=M.stops.length;if(ae===1||Y<=M.stops[0][0])return M.stops[0][1];if(Y>=M.stops[ae-1][0])return M.stops[ae-1][1];var pe=yn(M.stops.map(function(ye){return ye[0]}),Y);return M.stops[pe][1]}function dt(M,O,Y){var ae=M.base!==void 0?M.base:1;if(Ya(Y)!=="number")return et(M.default,O.default);var pe=M.stops.length;if(pe===1||Y<=M.stops[0][0])return M.stops[0][1];if(Y>=M.stops[pe-1][0])return M.stops[pe-1][1];var ye=yn(M.stops.map(function(Dt){return Dt[0]}),Y),Ee=function(Dt,Wt,Vt,sr){var br=sr-Vt,Ir=Dt-Vt;return br===0?0:Wt===1?Ir/br:(Math.pow(Wt,Ir)-1)/(Math.pow(Wt,br)-1)}(Y,ae,M.stops[ye][0],M.stops[ye+1][0]),Ne=M.stops[ye][1],Qe=M.stops[ye+1][1],ct=Ln[O.type]||Ge;if(M.colorSpace&&M.colorSpace!=="rgb"){var mt=eo[M.colorSpace];ct=function(Dt,Wt){return mt.reverse(mt.interpolate(mt.forward(Dt),mt.forward(Wt),Ee))}}return typeof Ne.evaluate=="function"?{evaluate:function(){for(var Dt=[],Wt=arguments.length;Wt--;)Dt[Wt]=arguments[Wt];var Vt=Ne.evaluate.apply(void 0,Dt),sr=Qe.evaluate.apply(void 0,Dt);if(Vt!==void 0&&sr!==void 0)return ct(Vt,sr,Ee)}}:ct(Ne,Qe,Ee)}function St(M,O,Y){return O.type==="color"?Y=Zt.parse(Y):O.type==="formatted"?Y=hr.fromString(Y.toString()):O.type==="resolvedImage"?Y=vr.fromString(Y.toString()):Ya(Y)===O.type||O.type==="enum"&&O.values[Y]||(Y=void 0),et(Y,M.default,O.default)}Yr.register(Go,{error:[{kind:"error"},[ut],function(M,O){var Y=O[0];throw new en(Y.evaluate(M))}],typeof:[ut,[Ae],function(M,O){return Rt(Ur(O[0].evaluate(M)))}],"to-rgba":[Mt(rt,4),[wt],function(M,O){return O[0].evaluate(M).toArray()}],rgb:[wt,[rt,rt,rt],Yo],rgba:[wt,[rt,rt,rt,rt],Yo],has:{type:Ft,overloads:[[[ut],function(M,O){return Wo(O[0].evaluate(M),M.properties())}],[[ut,Lt],function(M,O){var Y=O[0],ae=O[1];return Wo(Y.evaluate(M),ae.evaluate(M))}]]},get:{type:Ae,overloads:[[[ut],function(M,O){return ns(O[0].evaluate(M),M.properties())}],[[ut,Lt],function(M,O){var Y=O[0],ae=O[1];return ns(Y.evaluate(M),ae.evaluate(M))}]]},"feature-state":[Ae,[ut],function(M,O){return ns(O[0].evaluate(M),M.featureState||{})}],properties:[Lt,[],function(M){return M.properties()}],"geometry-type":[ut,[],function(M){return M.geometryType()}],id:[Ae,[],function(M){return M.id()}],zoom:[rt,[],function(M){return M.globals.zoom}],"heatmap-density":[rt,[],function(M){return M.globals.heatmapDensity||0}],"line-progress":[rt,[],function(M){return M.globals.lineProgress||0}],accumulated:[Ae,[],function(M){return M.globals.accumulated===void 0?null:M.globals.accumulated}],"+":[rt,wo(rt),function(M,O){for(var Y=0,ae=0,pe=O;ae<pe.length;ae+=1)Y+=pe[ae].evaluate(M);return Y}],"*":[rt,wo(rt),function(M,O){for(var Y=1,ae=0,pe=O;ae<pe.length;ae+=1)Y*=pe[ae].evaluate(M);return Y}],"-":{type:rt,overloads:[[[rt,rt],function(M,O){var Y=O[0],ae=O[1];return Y.evaluate(M)-ae.evaluate(M)}],[[rt],function(M,O){return-O[0].evaluate(M)}]]},"/":[rt,[rt,rt],function(M,O){var Y=O[0],ae=O[1];return Y.evaluate(M)/ae.evaluate(M)}],"%":[rt,[rt,rt],function(M,O){var Y=O[0],ae=O[1];return Y.evaluate(M)%ae.evaluate(M)}],ln2:[rt,[],function(){return Math.LN2}],pi:[rt,[],function(){return Math.PI}],e:[rt,[],function(){return Math.E}],"^":[rt,[rt,rt],function(M,O){var Y=O[0],ae=O[1];return Math.pow(Y.evaluate(M),ae.evaluate(M))}],sqrt:[rt,[rt],function(M,O){var Y=O[0];return Math.sqrt(Y.evaluate(M))}],log10:[rt,[rt],function(M,O){var Y=O[0];return Math.log(Y.evaluate(M))/Math.LN10}],ln:[rt,[rt],function(M,O){var Y=O[0];return Math.log(Y.evaluate(M))}],log2:[rt,[rt],function(M,O){var Y=O[0];return Math.log(Y.evaluate(M))/Math.LN2}],sin:[rt,[rt],function(M,O){var Y=O[0];return Math.sin(Y.evaluate(M))}],cos:[rt,[rt],function(M,O){var Y=O[0];return Math.cos(Y.evaluate(M))}],tan:[rt,[rt],function(M,O){var Y=O[0];return Math.tan(Y.evaluate(M))}],asin:[rt,[rt],function(M,O){var Y=O[0];return Math.asin(Y.evaluate(M))}],acos:[rt,[rt],function(M,O){var Y=O[0];return Math.acos(Y.evaluate(M))}],atan:[rt,[rt],function(M,O){var Y=O[0];return Math.atan(Y.evaluate(M))}],min:[rt,wo(rt),function(M,O){return Math.min.apply(Math,O.map(function(Y){return Y.evaluate(M)}))}],max:[rt,wo(rt),function(M,O){return Math.max.apply(Math,O.map(function(Y){return Y.evaluate(M)}))}],abs:[rt,[rt],function(M,O){var Y=O[0];return Math.abs(Y.evaluate(M))}],round:[rt,[rt],function(M,O){var Y=O[0].evaluate(M);return Y<0?-Math.round(-Y):Math.round(Y)}],floor:[rt,[rt],function(M,O){var Y=O[0];return Math.floor(Y.evaluate(M))}],ceil:[rt,[rt],function(M,O){var Y=O[0];return Math.ceil(Y.evaluate(M))}],"filter-==":[Ft,[ut,Ae],function(M,O){var Y=O[0],ae=O[1];return M.properties()[Y.value]===ae.value}],"filter-id-==":[Ft,[Ae],function(M,O){var Y=O[0];return M.id()===Y.value}],"filter-type-==":[Ft,[ut],function(M,O){var Y=O[0];return M.geometryType()===Y.value}],"filter-<":[Ft,[ut,Ae],function(M,O){var Y=O[0],ae=O[1],pe=M.properties()[Y.value],ye=ae.value;return typeof pe==typeof ye&&pe<ye}],"filter-id-<":[Ft,[Ae],function(M,O){var Y=O[0],ae=M.id(),pe=Y.value;return typeof ae==typeof pe&&ae<pe}],"filter->":[Ft,[ut,Ae],function(M,O){var Y=O[0],ae=O[1],pe=M.properties()[Y.value],ye=ae.value;return typeof pe==typeof ye&&pe>ye}],"filter-id->":[Ft,[Ae],function(M,O){var Y=O[0],ae=M.id(),pe=Y.value;return typeof ae==typeof pe&&ae>pe}],"filter-<=":[Ft,[ut,Ae],function(M,O){var Y=O[0],ae=O[1],pe=M.properties()[Y.value],ye=ae.value;return typeof pe==typeof ye&&pe<=ye}],"filter-id-<=":[Ft,[Ae],function(M,O){var Y=O[0],ae=M.id(),pe=Y.value;return typeof ae==typeof pe&&ae<=pe}],"filter->=":[Ft,[ut,Ae],function(M,O){var Y=O[0],ae=O[1],pe=M.properties()[Y.value],ye=ae.value;return typeof pe==typeof ye&&pe>=ye}],"filter-id->=":[Ft,[Ae],function(M,O){var Y=O[0],ae=M.id(),pe=Y.value;return typeof ae==typeof pe&&ae>=pe}],"filter-has":[Ft,[Ae],function(M,O){return O[0].value in M.properties()}],"filter-has-id":[Ft,[],function(M){return M.id()!==null&&M.id()!==void 0}],"filter-type-in":[Ft,[Mt(ut)],function(M,O){return O[0].value.indexOf(M.geometryType())>=0}],"filter-id-in":[Ft,[Mt(Ae)],function(M,O){return O[0].value.indexOf(M.id())>=0}],"filter-in-small":[Ft,[ut,Mt(Ae)],function(M,O){var Y=O[0];return O[1].value.indexOf(M.properties()[Y.value])>=0}],"filter-in-large":[Ft,[ut,Mt(Ae)],function(M,O){var Y=O[0],ae=O[1];return function(pe,ye,Ee,Ne){for(;Ee<=Ne;){var Qe=Ee+Ne>>1;if(ye[Qe]===pe)return!0;ye[Qe]>pe?Ne=Qe-1:Ee=Qe+1}return!1}(M.properties()[Y.value],ae.value,0,ae.value.length-1)}],all:{type:Ft,overloads:[[[Ft,Ft],function(M,O){var Y=O[0],ae=O[1];return Y.evaluate(M)&&ae.evaluate(M)}],[wo(Ft),function(M,O){for(var Y=0,ae=O;Y<ae.length;Y+=1)if(!ae[Y].evaluate(M))return!1;return!0}]]},any:{type:Ft,overloads:[[[Ft,Ft],function(M,O){var Y=O[0],ae=O[1];return Y.evaluate(M)||ae.evaluate(M)}],[wo(Ft),function(M,O){for(var Y=0,ae=O;Y<ae.length;Y+=1)if(ae[Y].evaluate(M))return!0;return!1}]]},"!":[Ft,[Ft],function(M,O){return!O[0].evaluate(M)}],"is-supported-script":[Ft,[ut],function(M,O){var Y=O[0],ae=M.globals&&M.globals.isSupportedScript;return!ae||ae(Y.evaluate(M))}],upcase:[ut,[ut],function(M,O){return O[0].evaluate(M).toUpperCase()}],downcase:[ut,[ut],function(M,O){return O[0].evaluate(M).toLowerCase()}],concat:[ut,wo(Ae),function(M,O){return O.map(function(Y){return Jr(Y.evaluate(M))}).join("")}],"resolved-locale":[ut,[Ye],function(M,O){return O[0].evaluate(M).resolvedLocale()}]});var Xt=function(M,O){this.expression=M,this._warningHistory={},this._evaluator=new on,this._defaultValue=O?function(Y){return Y.type==="color"&&je(Y.default)?new Zt(0,0,0,0):Y.type==="color"?Zt.parse(Y.default)||null:Y.default===void 0?null:Y.default}(O):null,this._enumValues=O&&O.type==="enum"?O.values:null};function Kt(M){return Array.isArray(M)&&M.length>0&&typeof M[0]=="string"&&M[0]in Go}function Yt(M,O){var Y=new rn(Go,[],O?function(pe){var ye={color:wt,string:ut,number:rt,enum:ut,boolean:Ft,formatted:nt,resolvedImage:ft};return pe.type==="array"?Mt(ye[pe.value]||Ae,pe.length):ye[pe.type]}(O):void 0),ae=Y.parse(M,void 0,void 0,void 0,O&&O.type==="string"?{typeAnnotation:"coerce"}:void 0);return ae?ys(new Xt(ae,O)):go(Y.errors)}Xt.prototype.evaluateWithoutErrorHandling=function(M,O,Y,ae,pe,ye){return this._evaluator.globals=M,this._evaluator.feature=O,this._evaluator.featureState=Y,this._evaluator.canonical=ae,this._evaluator.availableImages=pe||null,this._evaluator.formattedSection=ye,this.expression.evaluate(this._evaluator)},Xt.prototype.evaluate=function(M,O,Y,ae,pe,ye){this._evaluator.globals=M,this._evaluator.feature=O||null,this._evaluator.featureState=Y||null,this._evaluator.canonical=ae,this._evaluator.availableImages=pe||null,this._evaluator.formattedSection=ye||null;try{var Ee=this.expression.evaluate(this._evaluator);if(Ee==null||typeof Ee=="number"&&Ee!=Ee)return this._defaultValue;if(this._enumValues&&!(Ee in this._enumValues))throw new en("Expected value to be one of "+Object.keys(this._enumValues).map(function(Ne){return JSON.stringify(Ne)}).join(", ")+", but found "+JSON.stringify(Ee)+" instead.");return Ee}catch(Ne){return this._warningHistory[Ne.message]||(this._warningHistory[Ne.message]=!0,typeof console<"u"&&console.warn(Ne.message)),this._defaultValue}};var or=function(M,O){this.kind=M,this._styleExpression=O,this.isStateDependent=M!=="constant"&&!Gr(O.expression)};or.prototype.evaluateWithoutErrorHandling=function(M,O,Y,ae,pe,ye){return this._styleExpression.evaluateWithoutErrorHandling(M,O,Y,ae,pe,ye)},or.prototype.evaluate=function(M,O,Y,ae,pe,ye){return this._styleExpression.evaluate(M,O,Y,ae,pe,ye)};var mr=function(M,O,Y,ae){this.kind=M,this.zoomStops=Y,this._styleExpression=O,this.isStateDependent=M!=="camera"&&!Gr(O.expression),this.interpolationType=ae};function wr(M,O){if((M=Yt(M,O)).result==="error")return M;var Y=M.value.expression,ae=Cr(Y);if(!ae&&!Xo(O))return go([new it("","data expressions not supported")]);var pe=qr(Y,["zoom"]);if(!pe&&!xs(O))return go([new it("","zoom expressions not supported")]);var ye=function Ne(Qe){var ct=null;if(Qe instanceof Mi)ct=Ne(Qe.result);else if(Qe instanceof bo)for(var mt=0,Dt=Qe.args;mt<Dt.length;mt+=1){var Wt=Dt[mt];if(ct=Ne(Wt))break}else(Qe instanceof _n||Qe instanceof Na)&&Qe.input instanceof Yr&&Qe.input.name==="zoom"&&(ct=Qe);return ct instanceof it||Qe.eachChild(function(Vt){var sr=Ne(Vt);sr instanceof it?ct=sr:!ct&&sr?ct=new it("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):ct&&sr&&ct!==sr&&(ct=new it("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),ct}(Y);if(!ye&&!pe)return go([new it("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(ye instanceof it)return go([ye]);if(ye instanceof Na&&!Do(O))return go([new it("",'"interpolate" expressions cannot be used with this property')]);if(!ye)return ys(new or(ae?"constant":"source",M.value));var Ee=ye instanceof Na?ye.interpolation:void 0;return ys(new mr(ae?"camera":"composite",M.value,ye.labels,Ee))}mr.prototype.evaluateWithoutErrorHandling=function(M,O,Y,ae,pe,ye){return this._styleExpression.evaluateWithoutErrorHandling(M,O,Y,ae,pe,ye)},mr.prototype.evaluate=function(M,O,Y,ae,pe,ye){return this._styleExpression.evaluate(M,O,Y,ae,pe,ye)},mr.prototype.interpolationFactor=function(M,O,Y){return this.interpolationType?Na.interpolationFactor(this.interpolationType,M,O,Y):0};var Tr=function(M,O){this._parameters=M,this._specification=O,Xe(this,function Y(ae,pe){var ye,Ee,Ne,Qe=pe.type==="color",ct=ae.stops&&typeof ae.stops[0][0]=="object",mt=ct||ae.property!==void 0,Dt=ct||!mt,Wt=ae.type||(Do(pe)?"exponential":"interval");if(Qe&&((ae=Xe({},ae)).stops&&(ae.stops=ae.stops.map(function(la){return[la[0],Zt.parse(la[1])]})),ae.default?ae.default=Zt.parse(ae.default):ae.default=Zt.parse(pe.default)),ae.colorSpace&&ae.colorSpace!=="rgb"&&!eo[ae.colorSpace])throw new Error("Unknown color space: "+ae.colorSpace);if(Wt==="exponential")ye=dt;else if(Wt==="interval")ye=gt;else if(Wt==="categorical"){ye=lt,Ee=Object.create(null);for(var Vt=0,sr=ae.stops;Vt<sr.length;Vt+=1){var br=sr[Vt];Ee[br[0]]=br[1]}Ne=typeof ae.stops[0][0]}else{if(Wt!=="identity")throw new Error('Unknown function type "'+Wt+'"');ye=St}if(ct){for(var Ir={},Pr=[],Vr=0;Vr<ae.stops.length;Vr++){var Hr=ae.stops[Vr],Xr=Hr[0].zoom;Ir[Xr]===void 0&&(Ir[Xr]={zoom:Xr,type:ae.type,property:ae.property,default:ae.default,stops:[]},Pr.push(Xr)),Ir[Xr].stops.push([Hr[0].value,Hr[1]])}for(var un=[],bn=0,jn=Pr;bn<jn.length;bn+=1){var Bn=jn[bn];un.push([Ir[Bn].zoom,Y(Ir[Bn],pe)])}var Wn={name:"linear"};return{kind:"composite",interpolationType:Wn,interpolationFactor:Na.interpolationFactor.bind(void 0,Wn),zoomStops:un.map(function(la){return la[0]}),evaluate:function(la,$n){var ma=la.zoom;return dt({stops:un,base:ae.base},pe,ma).evaluate(ma,$n)}}}if(Dt){var sa=Wt==="exponential"?{name:"exponential",base:ae.base!==void 0?ae.base:1}:null;return{kind:"camera",interpolationType:sa,interpolationFactor:Na.interpolationFactor.bind(void 0,sa),zoomStops:ae.stops.map(function(la){return la[0]}),evaluate:function(la){var $n=la.zoom;return ye(ae,pe,$n,Ee,Ne)}}}return{kind:"source",evaluate:function(la,$n){var ma=$n&&$n.properties?$n.properties[ae.property]:void 0;return ma===void 0?et(ae.default,pe.default):ye(ae,pe,ma,Ee,Ne)}}}(this._parameters,this._specification))};function Dr(M){var O=M.key,Y=M.value,ae=M.valueSpec||{},pe=M.objectElementValidators||{},ye=M.style,Ee=M.styleSpec,Ne=[],Qe=Ya(Y);if(Qe!=="object")return[new De(O,Y,"object expected, "+Qe+" found")];for(var ct in Y){var mt=ct.split(".")[0],Dt=ae[mt]||ae["*"],Wt=void 0;if(pe[mt])Wt=pe[mt];else if(ae[mt])Wt=cr;else if(pe["*"])Wt=pe["*"];else{if(!ae["*"]){Ne.push(new De(O,Y[ct],'unknown property "'+ct+'"'));continue}Wt=cr}Ne=Ne.concat(Wt({key:(O&&O+".")+ct,value:Y[ct],valueSpec:Dt,style:ye,styleSpec:Ee,object:Y,objectKey:ct},Y))}for(var Vt in ae)pe[Vt]||ae[Vt].required&&ae[Vt].default===void 0&&Y[Vt]===void 0&&Ne.push(new De(O,Y,'missing required property "'+Vt+'"'));return Ne}function nn(M){var O=M.value,Y=M.valueSpec,ae=M.style,pe=M.styleSpec,ye=M.key,Ee=M.arrayElementValidator||cr;if(Ya(O)!=="array")return[new De(ye,O,"array expected, "+Ya(O)+" found")];if(Y.length&&O.length!==Y.length)return[new De(ye,O,"array length "+Y.length+" expected, length "+O.length+" found")];if(Y["min-length"]&&O.length<Y["min-length"])return[new De(ye,O,"array length at least "+Y["min-length"]+" expected, length "+O.length+" found")];var Ne={type:Y.value,values:Y.values};pe.$version<7&&(Ne.function=Y.function),Ya(Y.value)==="object"&&(Ne=Y.value);for(var Qe=[],ct=0;ct<O.length;ct++)Qe=Qe.concat(Ee({array:O,arrayIndex:ct,value:O[ct],valueSpec:Ne,style:ae,styleSpec:pe,key:ye+"["+ct+"]"}));return Qe}function hn(M){var O=M.key,Y=M.value,ae=M.valueSpec,pe=Ya(Y);return pe==="number"&&Y!=Y&&(pe="NaN"),pe!=="number"?[new De(O,Y,"number expected, "+pe+" found")]:"minimum"in ae&&Y<ae.minimum?[new De(O,Y,Y+" is less than the minimum value "+ae.minimum)]:"maximum"in ae&&Y>ae.maximum?[new De(O,Y,Y+" is greater than the maximum value "+ae.maximum)]:[]}function Cn(M){var O,Y,ae,pe=M.valueSpec,ye=He(M.value.type),Ee={},Ne=ye!=="categorical"&&M.value.property===void 0,Qe=!Ne,ct=Ya(M.value.stops)==="array"&&Ya(M.value.stops[0])==="array"&&Ya(M.value.stops[0][0])==="object",mt=Dr({key:M.key,value:M.value,valueSpec:M.styleSpec.function,style:M.style,styleSpec:M.styleSpec,objectElementValidators:{stops:function(Vt){if(ye==="identity")return[new De(Vt.key,Vt.value,'identity function may not have a "stops" property')];var sr=[],br=Vt.value;return sr=sr.concat(nn({key:Vt.key,value:br,valueSpec:Vt.valueSpec,style:Vt.style,styleSpec:Vt.styleSpec,arrayElementValidator:Dt})),Ya(br)==="array"&&br.length===0&&sr.push(new De(Vt.key,br,"array must have at least one stop")),sr},default:function(Vt){return cr({key:Vt.key,value:Vt.value,valueSpec:pe,style:Vt.style,styleSpec:Vt.styleSpec})}}});return ye==="identity"&&Ne&&mt.push(new De(M.key,M.value,'missing required property "property"')),ye==="identity"||M.value.stops||mt.push(new De(M.key,M.value,'missing required property "stops"')),ye==="exponential"&&M.valueSpec.expression&&!Do(M.valueSpec)&&mt.push(new De(M.key,M.value,"exponential functions not supported")),M.styleSpec.$version>=8&&(Qe&&!Xo(M.valueSpec)?mt.push(new De(M.key,M.value,"property functions not supported")):Ne&&!xs(M.valueSpec)&&mt.push(new De(M.key,M.value,"zoom functions not supported"))),ye!=="categorical"&&!ct||M.value.property!==void 0||mt.push(new De(M.key,M.value,'"property" property is required')),mt;function Dt(Vt){var sr=[],br=Vt.value,Ir=Vt.key;if(Ya(br)!=="array")return[new De(Ir,br,"array expected, "+Ya(br)+" found")];if(br.length!==2)return[new De(Ir,br,"array length 2 expected, length "+br.length+" found")];if(ct){if(Ya(br[0])!=="object")return[new De(Ir,br,"object expected, "+Ya(br[0])+" found")];if(br[0].zoom===void 0)return[new De(Ir,br,"object stop key must have zoom")];if(br[0].value===void 0)return[new De(Ir,br,"object stop key must have value")];if(ae&&ae>He(br[0].zoom))return[new De(Ir,br[0].zoom,"stop zoom values must appear in ascending order")];He(br[0].zoom)!==ae&&(ae=He(br[0].zoom),Y=void 0,Ee={}),sr=sr.concat(Dr({key:Ir+"[0]",value:br[0],valueSpec:{zoom:{}},style:Vt.style,styleSpec:Vt.styleSpec,objectElementValidators:{zoom:hn,value:Wt}}))}else sr=sr.concat(Wt({key:Ir+"[0]",value:br[0],valueSpec:{},style:Vt.style,styleSpec:Vt.styleSpec},br));return Kt(st(br[1]))?sr.concat([new De(Ir+"[1]",br[1],"expressions are not allowed in function stops.")]):sr.concat(cr({key:Ir+"[1]",value:br[1],valueSpec:pe,style:Vt.style,styleSpec:Vt.styleSpec}))}function Wt(Vt,sr){var br=Ya(Vt.value),Ir=He(Vt.value),Pr=Vt.value!==null?Vt.value:sr;if(O){if(br!==O)return[new De(Vt.key,Pr,br+" stop domain type must match previous stop domain type "+O)]}else O=br;if(br!=="number"&&br!=="string"&&br!=="boolean")return[new De(Vt.key,Pr,"stop domain value must be a number, string, or boolean")];if(br!=="number"&&ye!=="categorical"){var Vr="number expected, "+br+" found";return Xo(pe)&&ye===void 0&&(Vr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new De(Vt.key,Pr,Vr)]}return ye!=="categorical"||br!=="number"||isFinite(Ir)&&Math.floor(Ir)===Ir?ye!=="categorical"&&br==="number"&&Y!==void 0&&Ir<Y?[new De(Vt.key,Pr,"stop domain values must appear in ascending order")]:(Y=Ir,ye==="categorical"&&Ir in Ee?[new De(Vt.key,Pr,"stop domain values must be unique")]:(Ee[Ir]=!0,[])):[new De(Vt.key,Pr,"integer expected, found "+Ir)]}}function Dn(M){var O=(M.expressionContext==="property"?wr:Yt)(st(M.value),M.valueSpec);if(O.result==="error")return O.value.map(function(ae){return new De(""+M.key+ae.key,M.value,ae.message)});var Y=O.value.expression||O.value._styleExpression.expression;if(M.expressionContext==="property"&&M.propertyKey==="text-font"&&!Y.outputDefined())return[new De(M.key,M.value,'Invalid data expression for "'+M.propertyKey+'". Output values must be contained as literals within the expression.')];if(M.expressionContext==="property"&&M.propertyType==="layout"&&!Gr(Y))return[new De(M.key,M.value,'"feature-state" data expressions are not supported with layout properties.')];if(M.expressionContext==="filter"&&!Gr(Y))return[new De(M.key,M.value,'"feature-state" data expressions are not supported with filters.')];if(M.expressionContext&&M.expressionContext.indexOf("cluster")===0){if(!qr(Y,["zoom","feature-state"]))return[new De(M.key,M.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(M.expressionContext==="cluster-initial"&&!Cr(Y))return[new De(M.key,M.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Gn(M){var O=M.key,Y=M.value,ae=M.valueSpec,pe=[];return Array.isArray(ae.values)?ae.values.indexOf(He(Y))===-1&&pe.push(new De(O,Y,"expected one of ["+ae.values.join(", ")+"], "+JSON.stringify(Y)+" found")):Object.keys(ae.values).indexOf(He(Y))===-1&&pe.push(new De(O,Y,"expected one of ["+Object.keys(ae.values).join(", ")+"], "+JSON.stringify(Y)+" found")),pe}function Rn(M){if(M===!0||M===!1)return!0;if(!Array.isArray(M)||M.length===0)return!1;switch(M[0]){case"has":return M.length>=2&&M[1]!=="$id"&&M[1]!=="$type";case"in":return M.length>=3&&(typeof M[1]!="string"||Array.isArray(M[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return M.length!==3||Array.isArray(M[1])||Array.isArray(M[2]);case"any":case"all":for(var O=0,Y=M.slice(1);O<Y.length;O+=1){var ae=Y[O];if(!Rn(ae)&&typeof ae!="boolean")return!1}return!0;default:return!0}}Tr.deserialize=function(M){return new Tr(M._parameters,M._specification)},Tr.serialize=function(M){return{_parameters:M._parameters,_specification:M._specification}};var va={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Sa(M){if(M==null)return{filter:function(){return!0},needGeometry:!1};Rn(M)||(M=ja(M));var O=Yt(M,va);if(O.result==="error")throw new Error(O.value.map(function(Y){return Y.key+": "+Y.message}).join(", "));return{filter:function(Y,ae,pe){return O.value.evaluate(Y,ae,{},pe)},needGeometry:function Y(ae){if(!Array.isArray(ae))return!1;if(ae[0]==="within")return!0;for(var pe=1;pe<ae.length;pe++)if(Y(ae[pe]))return!0;return!1}(M)}}function Ua(M,O){return M<O?-1:M>O?1:0}function ja(M){if(!M)return!0;var O,Y=M[0];return M.length<=1?Y!=="any":Y==="=="?Va(M[1],M[2],"=="):Y==="!="?ci(Va(M[1],M[2],"==")):Y==="<"||Y===">"||Y==="<="||Y===">="?Va(M[1],M[2],Y):Y==="any"?(O=M.slice(1),["any"].concat(O.map(ja))):Y==="all"?["all"].concat(M.slice(1).map(ja)):Y==="none"?["all"].concat(M.slice(1).map(ja).map(ci)):Y==="in"?Ai(M[1],M.slice(2)):Y==="!in"?ci(Ai(M[1],M.slice(2))):Y==="has"?Ti(M[1]):Y==="!has"?ci(Ti(M[1])):Y!=="within"||M}function Va(M,O,Y){switch(M){case"$type":return["filter-type-"+Y,O];case"$id":return["filter-id-"+Y,O];default:return["filter-"+Y,M,O]}}function Ai(M,O){if(O.length===0)return!1;switch(M){case"$type":return["filter-type-in",["literal",O]];case"$id":return["filter-id-in",["literal",O]];default:return O.length>200&&!O.some(function(Y){return typeof Y!=typeof O[0]})?["filter-in-large",M,["literal",O.sort(Ua)]]:["filter-in-small",M,["literal",O]]}}function Ti(M){switch(M){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",M]}}function ci(M){return["!",M]}function ui(M){return Rn(st(M.value))?Dn(Xe({},M,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function O(Y){var ae=Y.value,pe=Y.key;if(Ya(ae)!=="array")return[new De(pe,ae,"array expected, "+Ya(ae)+" found")];var ye,Ee=Y.styleSpec,Ne=[];if(ae.length<1)return[new De(pe,ae,"filter array must have at least 1 element")];switch(Ne=Ne.concat(Gn({key:pe+"[0]",value:ae[0],valueSpec:Ee.filter_operator,style:Y.style,styleSpec:Y.styleSpec})),He(ae[0])){case"<":case"<=":case">":case">=":ae.length>=2&&He(ae[1])==="$type"&&Ne.push(new De(pe,ae,'"$type" cannot be use with operator "'+ae[0]+'"'));case"==":case"!=":ae.length!==3&&Ne.push(new De(pe,ae,'filter array for operator "'+ae[0]+'" must have 3 elements'));case"in":case"!in":ae.length>=2&&(ye=Ya(ae[1]))!=="string"&&Ne.push(new De(pe+"[1]",ae[1],"string expected, "+ye+" found"));for(var Qe=2;Qe<ae.length;Qe++)ye=Ya(ae[Qe]),He(ae[1])==="$type"?Ne=Ne.concat(Gn({key:pe+"["+Qe+"]",value:ae[Qe],valueSpec:Ee.geometry_type,style:Y.style,styleSpec:Y.styleSpec})):ye!=="string"&&ye!=="number"&&ye!=="boolean"&&Ne.push(new De(pe+"["+Qe+"]",ae[Qe],"string, number, or boolean expected, "+ye+" found"));break;case"any":case"all":case"none":for(var ct=1;ct<ae.length;ct++)Ne=Ne.concat(O({key:pe+"["+ct+"]",value:ae[ct],style:Y.style,styleSpec:Y.styleSpec}));break;case"has":case"!has":ye=Ya(ae[1]),ae.length!==2?Ne.push(new De(pe,ae,'filter array for "'+ae[0]+'" operator must have 2 elements')):ye!=="string"&&Ne.push(new De(pe+"[1]",ae[1],"string expected, "+ye+" found"));break;case"within":ye=Ya(ae[1]),ae.length!==2?Ne.push(new De(pe,ae,'filter array for "'+ae[0]+'" operator must have 2 elements')):ye!=="object"&&Ne.push(new De(pe+"[1]",ae[1],"object expected, "+ye+" found"))}return Ne}(M)}function ki(M,O){var Y=M.key,ae=M.style,pe=M.styleSpec,ye=M.value,Ee=M.objectKey,Ne=pe[O+"_"+M.layerType];if(!Ne)return[];var Qe=Ee.match(/^(.*)-transition$/);if(O==="paint"&&Qe&&Ne[Qe[1]]&&Ne[Qe[1]].transition)return cr({key:Y,value:ye,valueSpec:pe.transition,style:ae,styleSpec:pe});var ct,mt=M.valueSpec||Ne[Ee];if(!mt)return[new De(Y,ye,'unknown property "'+Ee+'"')];if(Ya(ye)==="string"&&Xo(mt)&&!mt.tokens&&(ct=/^{([^}]+)}$/.exec(ye)))return[new De(Y,ye,'"'+Ee+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ct[1])+" }`.")];var Dt=[];return M.layerType==="symbol"&&(Ee==="text-field"&&ae&&!ae.glyphs&&Dt.push(new De(Y,ye,'use of "text-field" requires a style "glyphs" property')),Ee==="text-font"&&je(st(ye))&&He(ye.type)==="identity"&&Dt.push(new De(Y,ye,'"text-font" does not support identity functions'))),Dt.concat(cr({key:M.key,value:ye,valueSpec:mt,style:ae,styleSpec:pe,expressionContext:"property",propertyType:O,propertyKey:Ee}))}function Vi(M){return ki(M,"paint")}function ro(M){return ki(M,"layout")}function no(M){var O=[],Y=M.value,ae=M.key,pe=M.style,ye=M.styleSpec;Y.type||Y.ref||O.push(new De(ae,Y,'either "type" or "ref" is required'));var Ee,Ne=He(Y.type),Qe=He(Y.ref);if(Y.id)for(var ct=He(Y.id),mt=0;mt<M.arrayIndex;mt++){var Dt=pe.layers[mt];He(Dt.id)===ct&&O.push(new De(ae,Y.id,'duplicate layer id "'+Y.id+'", previously used at line '+Dt.id.__line__))}if("ref"in Y)["type","source","source-layer","filter","layout"].forEach(function(sr){sr in Y&&O.push(new De(ae,Y[sr],'"'+sr+'" is prohibited for ref layers'))}),pe.layers.forEach(function(sr){He(sr.id)===Qe&&(Ee=sr)}),Ee?Ee.ref?O.push(new De(ae,Y.ref,"ref cannot reference another ref layer")):Ne=He(Ee.type):O.push(new De(ae,Y.ref,'ref layer "'+Qe+'" not found'));else if(Ne!=="background")if(Y.source){var Wt=pe.sources&&pe.sources[Y.source],Vt=Wt&&He(Wt.type);Wt?Vt==="vector"&&Ne==="raster"?O.push(new De(ae,Y.source,'layer "'+Y.id+'" requires a raster source')):Vt==="raster"&&Ne!=="raster"?O.push(new De(ae,Y.source,'layer "'+Y.id+'" requires a vector source')):Vt!=="vector"||Y["source-layer"]?Vt==="raster-dem"&&Ne!=="hillshade"?O.push(new De(ae,Y.source,"raster-dem source can only be used with layer type 'hillshade'.")):Ne!=="line"||!Y.paint||!Y.paint["line-gradient"]||Vt==="geojson"&&Wt.lineMetrics||O.push(new De(ae,Y,'layer "'+Y.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):O.push(new De(ae,Y,'layer "'+Y.id+'" must specify a "source-layer"')):O.push(new De(ae,Y.source,'source "'+Y.source+'" not found'))}else O.push(new De(ae,Y,'missing required property "source"'));return O=O.concat(Dr({key:ae,value:Y,valueSpec:ye.layer,style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return cr({key:ae+".type",value:Y.type,valueSpec:ye.layer.type,style:M.style,styleSpec:M.styleSpec,object:Y,objectKey:"type"})},filter:ui,layout:function(sr){return Dr({layer:Y,key:sr.key,value:sr.value,style:sr.style,styleSpec:sr.styleSpec,objectElementValidators:{"*":function(br){return ro(Xe({layerType:Ne},br))}}})},paint:function(sr){return Dr({layer:Y,key:sr.key,value:sr.value,style:sr.style,styleSpec:sr.styleSpec,objectElementValidators:{"*":function(br){return Vi(Xe({layerType:Ne},br))}}})}}}))}function ao(M){var O=M.value,Y=M.key,ae=Ya(O);return ae!=="string"?[new De(Y,O,"string expected, "+ae+" found")]:[]}var io={promoteId:function(M){var O=M.key,Y=M.value;if(Ya(Y)==="string")return ao({key:O,value:Y});var ae=[];for(var pe in Y)ae.push.apply(ae,ao({key:O+"."+pe,value:Y[pe]}));return ae}};function Da(M){var O=M.value,Y=M.key,ae=M.styleSpec,pe=M.style;if(!O.type)return[new De(Y,O,'"type" is required')];var ye,Ee=He(O.type);switch(Ee){case"vector":case"raster":case"raster-dem":return ye=Dr({key:Y,value:O,valueSpec:ae["source_"+Ee.replace("-","_")],style:M.style,styleSpec:ae,objectElementValidators:io});case"geojson":if(ye=Dr({key:Y,value:O,valueSpec:ae.source_geojson,style:pe,styleSpec:ae,objectElementValidators:io}),O.cluster)for(var Ne in O.clusterProperties){var Qe=O.clusterProperties[Ne],ct=Qe[0],mt=Qe[1],Dt=typeof ct=="string"?[ct,["accumulated"],["get",Ne]]:ct;ye.push.apply(ye,Dn({key:Y+"."+Ne+".map",value:mt,expressionContext:"cluster-map"})),ye.push.apply(ye,Dn({key:Y+"."+Ne+".reduce",value:Dt,expressionContext:"cluster-reduce"}))}return ye;case"video":return Dr({key:Y,value:O,valueSpec:ae.source_video,style:pe,styleSpec:ae});case"image":return Dr({key:Y,value:O,valueSpec:ae.source_image,style:pe,styleSpec:ae});case"canvas":return[new De(Y,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Gn({key:Y+".type",value:O.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:pe,styleSpec:ae})}}function ht(M){var O=M.value,Y=M.styleSpec,ae=Y.light,pe=M.style,ye=[],Ee=Ya(O);if(O===void 0)return ye;if(Ee!=="object")return ye=ye.concat([new De("light",O,"object expected, "+Ee+" found")]);for(var Ne in O){var Qe=Ne.match(/^(.*)-transition$/);ye=Qe&&ae[Qe[1]]&&ae[Qe[1]].transition?ye.concat(cr({key:Ne,value:O[Ne],valueSpec:Y.transition,style:pe,styleSpec:Y})):ae[Ne]?ye.concat(cr({key:Ne,value:O[Ne],valueSpec:ae[Ne],style:pe,styleSpec:Y})):ye.concat([new De(Ne,O[Ne],'unknown property "'+Ne+'"')])}return ye}var Ot={"*":function(){return[]},array:nn,boolean:function(M){var O=M.value,Y=M.key,ae=Ya(O);return ae!=="boolean"?[new De(Y,O,"boolean expected, "+ae+" found")]:[]},number:hn,color:function(M){var O=M.key,Y=M.value,ae=Ya(Y);return ae!=="string"?[new De(O,Y,"color expected, "+ae+" found")]:fr(Y)===null?[new De(O,Y,'color expected, "'+Y+'" found')]:[]},constants:qe,enum:Gn,filter:ui,function:Cn,layer:no,object:Dr,source:Da,light:ht,string:ao,formatted:function(M){return ao(M).length===0?[]:Dn(M)},resolvedImage:function(M){return ao(M).length===0?[]:Dn(M)}};function cr(M){var O=M.value,Y=M.valueSpec,ae=M.styleSpec;return Y.expression&&je(He(O))?Cn(M):Y.expression&&Kt(st(O))?Dn(M):Y.type&&Ot[Y.type]?Ot[Y.type](M):Dr(Xe({},M,{valueSpec:Y.type?ae[Y.type]:Y}))}function Ut(M){var O=M.value,Y=M.key,ae=ao(M);return ae.length||(O.indexOf("{fontstack}")===-1&&ae.push(new De(Y,O,'"glyphs" url must include a "{fontstack}" token')),O.indexOf("{range}")===-1&&ae.push(new De(Y,O,'"glyphs" url must include a "{range}" token'))),ae}function ur(M,O){O===void 0&&(O=xe);var Y=[];return Y=Y.concat(cr({key:"",value:M,valueSpec:O.$root,styleSpec:O,style:M,objectElementValidators:{glyphs:Ut,"*":function(){return[]}}})),M.constants&&(Y=Y.concat(qe({key:"constants",value:M.constants,style:M,styleSpec:O}))),Or(Y)}function Or(M){return[].concat(M).sort(function(O,Y){return O.line-Y.line})}function jr(M){return function(){for(var O=[],Y=arguments.length;Y--;)O[Y]=arguments[Y];return Or(M.apply(this,O))}}ur.source=jr(Da),ur.light=jr(ht),ur.layer=jr(no),ur.filter=jr(ui),ur.paintProperty=jr(Vi),ur.layoutProperty=jr(ro);var Zr=ur,ln=Zr.light,an=Zr.paintProperty,dn=Zr.layoutProperty;function Tn(M,O){var Y=!1;if(O&&O.length)for(var ae=0,pe=O;ae<pe.length;ae+=1){var ye=pe[ae];M.fire(new We(new Error(ye.message))),Y=!0}return Y}var cn=kn;function kn(M,O,Y){var ae=this.cells=[];if(M instanceof ArrayBuffer){this.arrayBuffer=M;var pe=new Int32Array(this.arrayBuffer);M=pe[0],O=pe[1],Y=pe[2],this.d=O+2*Y;for(var ye=0;ye<this.d*this.d;ye++){var Ee=pe[3+ye],Ne=pe[3+ye+1];ae.push(Ee===Ne?null:pe.subarray(Ee,Ne))}var Qe=pe[3+ae.length],ct=pe[3+ae.length+1];this.keys=pe.subarray(Qe,ct),this.bboxes=pe.subarray(ct),this.insert=this._insertReadonly}else{this.d=O+2*Y;for(var mt=0;mt<this.d*this.d;mt++)ae.push([]);this.keys=[],this.bboxes=[]}this.n=O,this.extent=M,this.padding=Y,this.scale=O/M,this.uid=0;var Dt=Y/O*M;this.min=-Dt,this.max=M+Dt}kn.prototype.insert=function(M,O,Y,ae,pe){this._forEachCell(O,Y,ae,pe,this._insertCell,this.uid++),this.keys.push(M),this.bboxes.push(O),this.bboxes.push(Y),this.bboxes.push(ae),this.bboxes.push(pe)},kn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},kn.prototype._insertCell=function(M,O,Y,ae,pe,ye){this.cells[pe].push(ye)},kn.prototype.query=function(M,O,Y,ae,pe){var ye=this.min,Ee=this.max;if(M<=ye&&O<=ye&&Ee<=Y&&Ee<=ae&&!pe)return Array.prototype.slice.call(this.keys);var Ne=[];return this._forEachCell(M,O,Y,ae,this._queryCell,Ne,{},pe),Ne},kn.prototype._queryCell=function(M,O,Y,ae,pe,ye,Ee,Ne){var Qe=this.cells[pe];if(Qe!==null)for(var ct=this.keys,mt=this.bboxes,Dt=0;Dt<Qe.length;Dt++){var Wt=Qe[Dt];if(Ee[Wt]===void 0){var Vt=4*Wt;(Ne?Ne(mt[Vt+0],mt[Vt+1],mt[Vt+2],mt[Vt+3]):M<=mt[Vt+2]&&O<=mt[Vt+3]&&Y>=mt[Vt+0]&&ae>=mt[Vt+1])?(Ee[Wt]=!0,ye.push(ct[Wt])):Ee[Wt]=!1}}},kn.prototype._forEachCell=function(M,O,Y,ae,pe,ye,Ee,Ne){for(var Qe=this._convertToCellCoord(M),ct=this._convertToCellCoord(O),mt=this._convertToCellCoord(Y),Dt=this._convertToCellCoord(ae),Wt=Qe;Wt<=mt;Wt++)for(var Vt=ct;Vt<=Dt;Vt++){var sr=this.d*Vt+Wt;if((!Ne||Ne(this._convertFromCellCoord(Wt),this._convertFromCellCoord(Vt),this._convertFromCellCoord(Wt+1),this._convertFromCellCoord(Vt+1)))&&pe.call(this,M,O,Y,ae,sr,ye,Ee,Ne))return}},kn.prototype._convertFromCellCoord=function(M){return(M-this.padding)/this.scale},kn.prototype._convertToCellCoord=function(M){return Math.max(0,Math.min(this.d-1,Math.floor(M*this.scale)+this.padding))},kn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var M=this.cells,O=3+this.cells.length+1+1,Y=0,ae=0;ae<this.cells.length;ae++)Y+=this.cells[ae].length;var pe=new Int32Array(O+Y+this.keys.length+this.bboxes.length);pe[0]=this.extent,pe[1]=this.n,pe[2]=this.padding;for(var ye=O,Ee=0;Ee<M.length;Ee++){var Ne=M[Ee];pe[3+Ee]=ye,pe.set(Ne,ye),ye+=Ne.length}return pe[3+M.length]=ye,pe.set(this.keys,ye),ye+=this.keys.length,pe[3+M.length+1]=ye,pe.set(this.bboxes,ye),ye+=this.bboxes.length,pe.buffer};var Fn=self.ImageData,qn=self.ImageBitmap,oa={};function Kr(M,O,Y){Y===void 0&&(Y={}),Object.defineProperty(O,"_classRegistryKey",{value:M,writeable:!1}),oa[M]={klass:O,omit:Y.omit||[],shallow:Y.shallow||[]}}for(var na in Kr("Object",Object),cn.serialize=function(M,O){var Y=M.toArrayBuffer();return O&&O.push(Y),{buffer:Y}},cn.deserialize=function(M){return new cn(M.buffer)},Kr("Grid",cn),Kr("Color",Zt),Kr("Error",Error),Kr("ResolvedImage",vr),Kr("StylePropertyFunction",Tr),Kr("StyleExpression",Xt,{omit:["_evaluator"]}),Kr("ZoomDependentExpression",mr),Kr("ZoomConstantExpression",or),Kr("CompoundExpression",Yr,{omit:["_evaluate"]}),Go)Go[na]._classRegistryKey||Kr("Expression_"+na,Go[na]);function Pn(M){return M&&typeof ArrayBuffer<"u"&&(M instanceof ArrayBuffer||M.constructor&&M.constructor.name==="ArrayBuffer")}function Un(M){return qn&&M instanceof qn}function ra(M,O){if(M==null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||M instanceof Boolean||M instanceof Number||M instanceof String||M instanceof Date||M instanceof RegExp)return M;if(Pn(M)||Un(M))return O&&O.push(M),M;if(ArrayBuffer.isView(M)){var Y=M;return O&&O.push(Y.buffer),Y}if(M instanceof Fn)return O&&O.push(M.data.buffer),M;if(Array.isArray(M)){for(var ae=[],pe=0,ye=M;pe<ye.length;pe+=1){var Ee=ye[pe];ae.push(ra(Ee,O))}return ae}if(typeof M=="object"){var Ne=M.constructor,Qe=Ne._classRegistryKey;if(!Qe)throw new Error("can't serialize object of unregistered class");var ct=Ne.serialize?Ne.serialize(M,O):{};if(!Ne.serialize){for(var mt in M)if(M.hasOwnProperty(mt)&&!(oa[Qe].omit.indexOf(mt)>=0)){var Dt=M[mt];ct[mt]=oa[Qe].shallow.indexOf(mt)>=0?Dt:ra(Dt,O)}M instanceof Error&&(ct.message=M.message)}if(ct.$name)throw new Error("$name property is reserved for worker serialization logic.");return Qe!=="Object"&&(ct.$name=Qe),ct}throw new Error("can't serialize object of type "+typeof M)}function ka(M){if(M==null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||M instanceof Boolean||M instanceof Number||M instanceof String||M instanceof Date||M instanceof RegExp||Pn(M)||Un(M)||ArrayBuffer.isView(M)||M instanceof Fn)return M;if(Array.isArray(M))return M.map(ka);if(typeof M=="object"){var O=M.$name||"Object",Y=oa[O].klass;if(!Y)throw new Error("can't deserialize unregistered class "+O);if(Y.deserialize)return Y.deserialize(M);for(var ae=Object.create(Y.prototype),pe=0,ye=Object.keys(M);pe<ye.length;pe+=1){var Ee=ye[pe];if(Ee!=="$name"){var Ne=M[Ee];ae[Ee]=oa[O].shallow.indexOf(Ee)>=0?Ne:ka(Ne)}}return ae}throw new Error("can't deserialize object of type "+typeof M)}var Pa=function(){this.first=!0};Pa.prototype.update=function(M,O){var Y=Math.floor(M);return this.first?(this.first=!1,this.lastIntegerZoom=Y,this.lastIntegerZoomTime=0,this.lastZoom=M,this.lastFloorZoom=Y,!0):(this.lastFloorZoom>Y?(this.lastIntegerZoom=Y+1,this.lastIntegerZoomTime=O):this.lastFloorZoom<Y&&(this.lastIntegerZoom=Y,this.lastIntegerZoomTime=O),M!==this.lastZoom&&(this.lastZoom=M,this.lastFloorZoom=Y,!0))};var En={"Latin-1 Supplement":function(M){return M>=128&&M<=255},Arabic:function(M){return M>=1536&&M<=1791},"Arabic Supplement":function(M){return M>=1872&&M<=1919},"Arabic Extended-A":function(M){return M>=2208&&M<=2303},"Hangul Jamo":function(M){return M>=4352&&M<=4607},"Unified Canadian Aboriginal Syllabics":function(M){return M>=5120&&M<=5759},Khmer:function(M){return M>=6016&&M<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(M){return M>=6320&&M<=6399},"General Punctuation":function(M){return M>=8192&&M<=8303},"Letterlike Symbols":function(M){return M>=8448&&M<=8527},"Number Forms":function(M){return M>=8528&&M<=8591},"Miscellaneous Technical":function(M){return M>=8960&&M<=9215},"Control Pictures":function(M){return M>=9216&&M<=9279},"Optical Character Recognition":function(M){return M>=9280&&M<=9311},"Enclosed Alphanumerics":function(M){return M>=9312&&M<=9471},"Geometric Shapes":function(M){return M>=9632&&M<=9727},"Miscellaneous Symbols":function(M){return M>=9728&&M<=9983},"Miscellaneous Symbols and Arrows":function(M){return M>=11008&&M<=11263},"CJK Radicals Supplement":function(M){return M>=11904&&M<=12031},"Kangxi Radicals":function(M){return M>=12032&&M<=12255},"Ideographic Description Characters":function(M){return M>=12272&&M<=12287},"CJK Symbols and Punctuation":function(M){return M>=12288&&M<=12351},Hiragana:function(M){return M>=12352&&M<=12447},Katakana:function(M){return M>=12448&&M<=12543},Bopomofo:function(M){return M>=12544&&M<=12591},"Hangul Compatibility Jamo":function(M){return M>=12592&&M<=12687},Kanbun:function(M){return M>=12688&&M<=12703},"Bopomofo Extended":function(M){return M>=12704&&M<=12735},"CJK Strokes":function(M){return M>=12736&&M<=12783},"Katakana Phonetic Extensions":function(M){return M>=12784&&M<=12799},"Enclosed CJK Letters and Months":function(M){return M>=12800&&M<=13055},"CJK Compatibility":function(M){return M>=13056&&M<=13311},"CJK Unified Ideographs Extension A":function(M){return M>=13312&&M<=19903},"Yijing Hexagram Symbols":function(M){return M>=19904&&M<=19967},"CJK Unified Ideographs":function(M){return M>=19968&&M<=40959},"Yi Syllables":function(M){return M>=40960&&M<=42127},"Yi Radicals":function(M){return M>=42128&&M<=42191},"Hangul Jamo Extended-A":function(M){return M>=43360&&M<=43391},"Hangul Syllables":function(M){return M>=44032&&M<=55215},"Hangul Jamo Extended-B":function(M){return M>=55216&&M<=55295},"Private Use Area":function(M){return M>=57344&&M<=63743},"CJK Compatibility Ideographs":function(M){return M>=63744&&M<=64255},"Arabic Presentation Forms-A":function(M){return M>=64336&&M<=65023},"Vertical Forms":function(M){return M>=65040&&M<=65055},"CJK Compatibility Forms":function(M){return M>=65072&&M<=65103},"Small Form Variants":function(M){return M>=65104&&M<=65135},"Arabic Presentation Forms-B":function(M){return M>=65136&&M<=65279},"Halfwidth and Fullwidth Forms":function(M){return M>=65280&&M<=65519}};function Ra(M){for(var O=0,Y=M;O<Y.length;O+=1)if(ga(Y[O].charCodeAt(0)))return!0;return!1}function Ca(M){return!En.Arabic(M)&&!En["Arabic Supplement"](M)&&!En["Arabic Extended-A"](M)&&!En["Arabic Presentation Forms-A"](M)&&!En["Arabic Presentation Forms-B"](M)}function ga(M){return M===746||M===747||!(M<4352)&&(!!En["Bopomofo Extended"](M)||!!En.Bopomofo(M)||!(!En["CJK Compatibility Forms"](M)||M>=65097&&M<=65103)||!!En["CJK Compatibility Ideographs"](M)||!!En["CJK Compatibility"](M)||!!En["CJK Radicals Supplement"](M)||!!En["CJK Strokes"](M)||!(!En["CJK Symbols and Punctuation"](M)||M>=12296&&M<=12305||M>=12308&&M<=12319||M===12336)||!!En["CJK Unified Ideographs Extension A"](M)||!!En["CJK Unified Ideographs"](M)||!!En["Enclosed CJK Letters and Months"](M)||!!En["Hangul Compatibility Jamo"](M)||!!En["Hangul Jamo Extended-A"](M)||!!En["Hangul Jamo Extended-B"](M)||!!En["Hangul Jamo"](M)||!!En["Hangul Syllables"](M)||!!En.Hiragana(M)||!!En["Ideographic Description Characters"](M)||!!En.Kanbun(M)||!!En["Kangxi Radicals"](M)||!!En["Katakana Phonetic Extensions"](M)||!(!En.Katakana(M)||M===12540)||!(!En["Halfwidth and Fullwidth Forms"](M)||M===65288||M===65289||M===65293||M>=65306&&M<=65310||M===65339||M===65341||M===65343||M>=65371&&M<=65503||M===65507||M>=65512&&M<=65519)||!(!En["Small Form Variants"](M)||M>=65112&&M<=65118||M>=65123&&M<=65126)||!!En["Unified Canadian Aboriginal Syllabics"](M)||!!En["Unified Canadian Aboriginal Syllabics Extended"](M)||!!En["Vertical Forms"](M)||!!En["Yijing Hexagram Symbols"](M)||!!En["Yi Syllables"](M)||!!En["Yi Radicals"](M))}function Fa(M){return!(ga(M)||function(O){return!(!En["Latin-1 Supplement"](O)||O!==167&&O!==169&&O!==174&&O!==177&&O!==188&&O!==189&&O!==190&&O!==215&&O!==247)||!(!En["General Punctuation"](O)||O!==8214&&O!==8224&&O!==8225&&O!==8240&&O!==8241&&O!==8251&&O!==8252&&O!==8258&&O!==8263&&O!==8264&&O!==8265&&O!==8273)||!!En["Letterlike Symbols"](O)||!!En["Number Forms"](O)||!(!En["Miscellaneous Technical"](O)||!(O>=8960&&O<=8967||O>=8972&&O<=8991||O>=8996&&O<=9e3||O===9003||O>=9085&&O<=9114||O>=9150&&O<=9165||O===9167||O>=9169&&O<=9179||O>=9186&&O<=9215))||!(!En["Control Pictures"](O)||O===9251)||!!En["Optical Character Recognition"](O)||!!En["Enclosed Alphanumerics"](O)||!!En["Geometric Shapes"](O)||!(!En["Miscellaneous Symbols"](O)||O>=9754&&O<=9759)||!(!En["Miscellaneous Symbols and Arrows"](O)||!(O>=11026&&O<=11055||O>=11088&&O<=11097||O>=11192&&O<=11243))||!!En["CJK Symbols and Punctuation"](O)||!!En.Katakana(O)||!!En["Private Use Area"](O)||!!En["CJK Compatibility Forms"](O)||!!En["Small Form Variants"](O)||!!En["Halfwidth and Fullwidth Forms"](O)||O===8734||O===8756||O===8757||O>=9984&&O<=10087||O>=10102&&O<=10131||O===65532||O===65533}(M))}function Ea(M){return M>=1424&&M<=2303||En["Arabic Presentation Forms-A"](M)||En["Arabic Presentation Forms-B"](M)}function ri(M,O){return!(!O&&Ea(M))&&!(M>=2304&&M<=3583||M>=3840&&M<=4255||En.Khmer(M))}function aa(M){for(var O=0,Y=M;O<Y.length;O+=1)if(Ea(Y[O].charCodeAt(0)))return!0;return!1}var Ka="deferred",Hi="loading",Qo="loaded",jo="error",To=null,xa="unavailable",xi=null,ko=function(M){M&&typeof M=="string"&&M.indexOf("NetworkError")>-1&&(xa=jo),To&&To(M)};function Qa(){Si.fire(new Ue("pluginStateChange",{pluginStatus:xa,pluginURL:xi}))}var Si=new he,Xi=function(){return xa},ai=function(){if(xa!==Ka||!xi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");xa=Hi,Qa(),xi&&vt({url:xi},function(M){M?ko(M):(xa=Qo,Qa())})},vo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return xa===Qo||vo.applyArabicShaping!=null},isLoading:function(){return xa===Hi},setState:function(M){xa=M.pluginStatus,xi=M.pluginURL},isParsed:function(){return vo.applyArabicShaping!=null&&vo.processBidirectionalText!=null&&vo.processStyledBidirectionalText!=null},getPluginURL:function(){return xi}},ii=function(M,O){this.zoom=M,O?(this.now=O.now,this.fadeDuration=O.fadeDuration,this.zoomHistory=O.zoomHistory,this.transition=O.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Pa,this.transition={})};ii.prototype.isSupportedScript=function(M){return function(O,Y){for(var ae=0,pe=O;ae<pe.length;ae+=1)if(!ri(pe[ae].charCodeAt(0),Y))return!1;return!0}(M,vo.isLoaded())},ii.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ii.prototype.getCrossfadeParameters=function(){var M=this.zoom,O=M-Math.floor(M),Y=this.crossFadingFactor();return M>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:O+(1-O)*Y}:{fromScale:.5,toScale:1,t:1-(1-Y)*O}};var oo=function(M,O){this.property=M,this.value=O,this.expression=function(Y,ae){if(je(Y))return new Tr(Y,ae);if(Kt(Y)){var pe=wr(Y,ae);if(pe.result==="error")throw new Error(pe.value.map(function(Ee){return Ee.key+": "+Ee.message}).join(", "));return pe.value}var ye=Y;return typeof Y=="string"&&ae.type==="color"&&(ye=Zt.parse(Y)),{kind:"constant",evaluate:function(){return ye}}}(O===void 0?M.specification.default:O,M.specification)};oo.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},oo.prototype.possiblyEvaluate=function(M,O,Y){return this.property.possiblyEvaluate(this,M,O,Y)};var fs=function(M){this.property=M,this.value=new oo(M,void 0)};fs.prototype.transitioned=function(M,O){return new qs(this.property,this.value,O,l({},M.transition,this.transition),M.now)},fs.prototype.untransitioned=function(){return new qs(this.property,this.value,null,{},0)};var as=function(M){this._properties=M,this._values=Object.create(M.defaultTransitionablePropertyValues)};as.prototype.getValue=function(M){return k(this._values[M].value.value)},as.prototype.setValue=function(M,O){this._values.hasOwnProperty(M)||(this._values[M]=new fs(this._values[M].property)),this._values[M].value=new oo(this._values[M].property,O===null?void 0:k(O))},as.prototype.getTransition=function(M){return k(this._values[M].transition)},as.prototype.setTransition=function(M,O){this._values.hasOwnProperty(M)||(this._values[M]=new fs(this._values[M].property)),this._values[M].transition=k(O)||void 0},as.prototype.serialize=function(){for(var M={},O=0,Y=Object.keys(this._values);O<Y.length;O+=1){var ae=Y[O],pe=this.getValue(ae);pe!==void 0&&(M[ae]=pe);var ye=this.getTransition(ae);ye!==void 0&&(M[ae+"-transition"]=ye)}return M},as.prototype.transitioned=function(M,O){for(var Y=new Bi(this._properties),ae=0,pe=Object.keys(this._values);ae<pe.length;ae+=1){var ye=pe[ae];Y._values[ye]=this._values[ye].transitioned(M,O._values[ye])}return Y},as.prototype.untransitioned=function(){for(var M=new Bi(this._properties),O=0,Y=Object.keys(this._values);O<Y.length;O+=1){var ae=Y[O];M._values[ae]=this._values[ae].untransitioned()}return M};var qs=function(M,O,Y,ae,pe){this.property=M,this.value=O,this.begin=pe+ae.delay||0,this.end=this.begin+ae.duration||0,M.specification.transition&&(ae.delay||ae.duration)&&(this.prior=Y)};qs.prototype.possiblyEvaluate=function(M,O,Y){var ae=M.now||0,pe=this.value.possiblyEvaluate(M,O,Y),ye=this.prior;if(ye){if(ae>this.end)return this.prior=null,pe;if(this.value.isDataDriven())return this.prior=null,pe;if(ae<this.begin)return ye.possiblyEvaluate(M,O,Y);var Ee=(ae-this.begin)/(this.end-this.begin);return this.property.interpolate(ye.possiblyEvaluate(M,O,Y),pe,function(Ne){if(Ne<=0)return 0;if(Ne>=1)return 1;var Qe=Ne*Ne,ct=Qe*Ne;return 4*(Ne<.5?ct:3*(Ne-Qe)+ct-.75)}(Ee))}return pe};var Bi=function(M){this._properties=M,this._values=Object.create(M.defaultTransitioningPropertyValues)};Bi.prototype.possiblyEvaluate=function(M,O,Y){for(var ae=new is(this._properties),pe=0,ye=Object.keys(this._values);pe<ye.length;pe+=1){var Ee=ye[pe];ae._values[Ee]=this._values[Ee].possiblyEvaluate(M,O,Y)}return ae},Bi.prototype.hasTransition=function(){for(var M=0,O=Object.keys(this._values);M<O.length;M+=1){var Y=O[M];if(this._values[Y].prior)return!0}return!1};var Gs=function(M){this._properties=M,this._values=Object.create(M.defaultPropertyValues)};Gs.prototype.getValue=function(M){return k(this._values[M].value)},Gs.prototype.setValue=function(M,O){this._values[M]=new oo(this._values[M].property,O===null?void 0:k(O))},Gs.prototype.serialize=function(){for(var M={},O=0,Y=Object.keys(this._values);O<Y.length;O+=1){var ae=Y[O],pe=this.getValue(ae);pe!==void 0&&(M[ae]=pe)}return M},Gs.prototype.possiblyEvaluate=function(M,O,Y){for(var ae=new is(this._properties),pe=0,ye=Object.keys(this._values);pe<ye.length;pe+=1){var Ee=ye[pe];ae._values[Ee]=this._values[Ee].possiblyEvaluate(M,O,Y)}return ae};var Ni=function(M,O,Y){this.property=M,this.value=O,this.parameters=Y};Ni.prototype.isConstant=function(){return this.value.kind==="constant"},Ni.prototype.constantOr=function(M){return this.value.kind==="constant"?this.value.value:M},Ni.prototype.evaluate=function(M,O,Y,ae){return this.property.evaluate(this.value,this.parameters,M,O,Y,ae)};var is=function(M){this._properties=M,this._values=Object.create(M.defaultPossiblyEvaluatedValues)};is.prototype.get=function(M){return this._values[M]};var fa=function(M){this.specification=M};fa.prototype.possiblyEvaluate=function(M,O){return M.expression.evaluate(O)},fa.prototype.interpolate=function(M,O,Y){var ae=Ln[this.specification.type];return ae?ae(M,O,Y):M};var ba=function(M,O){this.specification=M,this.overrides=O};ba.prototype.possiblyEvaluate=function(M,O,Y,ae){return M.expression.kind==="constant"||M.expression.kind==="camera"?new Ni(this,{kind:"constant",value:M.expression.evaluate(O,null,{},Y,ae)},O):new Ni(this,M.expression,O)},ba.prototype.interpolate=function(M,O,Y){if(M.value.kind!=="constant"||O.value.kind!=="constant")return M;if(M.value.value===void 0||O.value.value===void 0)return new Ni(this,{kind:"constant",value:void 0},M.parameters);var ae=Ln[this.specification.type];return ae?new Ni(this,{kind:"constant",value:ae(M.value.value,O.value.value,Y)},M.parameters):M},ba.prototype.evaluate=function(M,O,Y,ae,pe,ye){return M.kind==="constant"?M.value:M.evaluate(O,Y,ae,pe,ye)};var Ys=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.possiblyEvaluate=function(Y,ae,pe,ye){if(Y.value===void 0)return new Ni(this,{kind:"constant",value:void 0},ae);if(Y.expression.kind==="constant"){var Ee=Y.expression.evaluate(ae,null,{},pe,ye),Ne=Y.property.specification.type==="resolvedImage"&&typeof Ee!="string"?Ee.name:Ee,Qe=this._calculate(Ne,Ne,Ne,ae);return new Ni(this,{kind:"constant",value:Qe},ae)}if(Y.expression.kind==="camera"){var ct=this._calculate(Y.expression.evaluate({zoom:ae.zoom-1}),Y.expression.evaluate({zoom:ae.zoom}),Y.expression.evaluate({zoom:ae.zoom+1}),ae);return new Ni(this,{kind:"constant",value:ct},ae)}return new Ni(this,Y.expression,ae)},O.prototype.evaluate=function(Y,ae,pe,ye,Ee,Ne){if(Y.kind==="source"){var Qe=Y.evaluate(ae,pe,ye,Ee,Ne);return this._calculate(Qe,Qe,Qe,ae)}return Y.kind==="composite"?this._calculate(Y.evaluate({zoom:Math.floor(ae.zoom)-1},pe,ye),Y.evaluate({zoom:Math.floor(ae.zoom)},pe,ye),Y.evaluate({zoom:Math.floor(ae.zoom)+1},pe,ye),ae):Y.value},O.prototype._calculate=function(Y,ae,pe,ye){return ye.zoom>ye.zoomHistory.lastIntegerZoom?{from:Y,to:ae}:{from:pe,to:ae}},O.prototype.interpolate=function(Y){return Y},O}(ba),Ws=function(M){this.specification=M};Ws.prototype.possiblyEvaluate=function(M,O,Y,ae){if(M.value!==void 0){if(M.expression.kind==="constant"){var pe=M.expression.evaluate(O,null,{},Y,ae);return this._calculate(pe,pe,pe,O)}return this._calculate(M.expression.evaluate(new ii(Math.floor(O.zoom-1),O)),M.expression.evaluate(new ii(Math.floor(O.zoom),O)),M.expression.evaluate(new ii(Math.floor(O.zoom+1),O)),O)}},Ws.prototype._calculate=function(M,O,Y,ae){return ae.zoom>ae.zoomHistory.lastIntegerZoom?{from:M,to:O}:{from:Y,to:O}},Ws.prototype.interpolate=function(M){return M};var os=function(M){this.specification=M};os.prototype.possiblyEvaluate=function(M,O,Y,ae){return!!M.expression.evaluate(O,null,{},Y,ae)},os.prototype.interpolate=function(){return!1};var Ro=function(M){for(var O in this.properties=M,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],M){var Y=M[O];Y.specification.overridable&&this.overridableProperties.push(O);var ae=this.defaultPropertyValues[O]=new oo(Y,void 0),pe=this.defaultTransitionablePropertyValues[O]=new fs(Y);this.defaultTransitioningPropertyValues[O]=pe.untransitioned(),this.defaultPossiblyEvaluatedValues[O]=ae.possiblyEvaluate({})}};Kr("DataDrivenProperty",ba),Kr("DataConstantProperty",fa),Kr("CrossFadedDataDrivenProperty",Ys),Kr("CrossFadedProperty",Ws),Kr("ColorRampProperty",os);var Zo=function(M){function O(Y,ae){if(M.call(this),this.id=Y.id,this.type=Y.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},Y.type!=="custom"&&(Y=Y,this.metadata=Y.metadata,this.minzoom=Y.minzoom,this.maxzoom=Y.maxzoom,Y.type!=="background"&&(this.source=Y.source,this.sourceLayer=Y["source-layer"],this.filter=Y.filter),ae.layout&&(this._unevaluatedLayout=new Gs(ae.layout)),ae.paint)){for(var pe in this._transitionablePaint=new as(ae.paint),Y.paint)this.setPaintProperty(pe,Y.paint[pe],{validate:!1});for(var ye in Y.layout)this.setLayoutProperty(ye,Y.layout[ye],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new is(ae.paint)}}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},O.prototype.getLayoutProperty=function(Y){return Y==="visibility"?this.visibility:this._unevaluatedLayout.getValue(Y)},O.prototype.setLayoutProperty=function(Y,ae,pe){if(pe===void 0&&(pe={}),ae!=null){var ye="layers."+this.id+".layout."+Y;if(this._validate(dn,ye,Y,ae,pe))return}Y!=="visibility"?this._unevaluatedLayout.setValue(Y,ae):this.visibility=ae},O.prototype.getPaintProperty=function(Y){return T(Y,"-transition")?this._transitionablePaint.getTransition(Y.slice(0,-11)):this._transitionablePaint.getValue(Y)},O.prototype.setPaintProperty=function(Y,ae,pe){if(pe===void 0&&(pe={}),ae!=null){var ye="layers."+this.id+".paint."+Y;if(this._validate(an,ye,Y,ae,pe))return!1}if(T(Y,"-transition"))return this._transitionablePaint.setTransition(Y.slice(0,-11),ae||void 0),!1;var Ee=this._transitionablePaint._values[Y],Ne=Ee.property.specification["property-type"]==="cross-faded-data-driven",Qe=Ee.value.isDataDriven(),ct=Ee.value;this._transitionablePaint.setValue(Y,ae),this._handleSpecialPaintPropertyUpdate(Y);var mt=this._transitionablePaint._values[Y].value;return mt.isDataDriven()||Qe||Ne||this._handleOverridablePaintPropertyUpdate(Y,ct,mt)},O.prototype._handleSpecialPaintPropertyUpdate=function(Y){},O.prototype._handleOverridablePaintPropertyUpdate=function(Y,ae,pe){return!1},O.prototype.isHidden=function(Y){return!!(this.minzoom&&Y<this.minzoom)||!!(this.maxzoom&&Y>=this.maxzoom)||this.visibility==="none"},O.prototype.updateTransitions=function(Y){this._transitioningPaint=this._transitionablePaint.transitioned(Y,this._transitioningPaint)},O.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},O.prototype.recalculate=function(Y,ae){Y.getCrossfadeParameters&&(this._crossfadeParameters=Y.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(Y,void 0,ae)),this.paint=this._transitioningPaint.possiblyEvaluate(Y,void 0,ae)},O.prototype.serialize=function(){var Y={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(Y.layout=Y.layout||{},Y.layout.visibility=this.visibility),w(Y,function(ae,pe){return!(ae===void 0||pe==="layout"&&!Object.keys(ae).length||pe==="paint"&&!Object.keys(ae).length)})},O.prototype._validate=function(Y,ae,pe,ye,Ee){return Ee===void 0&&(Ee={}),(!Ee||Ee.validate!==!1)&&Tn(this,Y.call(Zr,{key:ae,layerType:this.type,objectKey:pe,value:ye,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))},O.prototype.is3D=function(){return!1},O.prototype.isTileClipped=function(){return!1},O.prototype.hasOffscreenPass=function(){return!1},O.prototype.resize=function(){},O.prototype.isStateDependent=function(){for(var Y in this.paint._values){var ae=this.paint.get(Y);if(ae instanceof Ni&&Xo(ae.property.specification)&&(ae.value.kind==="source"||ae.value.kind==="composite")&&ae.value.isStateDependent)return!0}return!1},O}(he),ll={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Is=function(M,O){this._structArray=M,this._pos1=O*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},$a=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function oi(M,O){O===void 0&&(O=1);var Y=0,ae=0;return{members:M.map(function(pe){var ye,Ee=(ye=pe.type,ll[ye].BYTES_PER_ELEMENT),Ne=Y=bs(Y,Math.max(O,Ee)),Qe=pe.components||1;return ae=Math.max(ae,Ee),Y+=Ee*Qe,{name:pe.name,type:pe.type,components:Qe,offset:Ne}}),size:bs(Y,Math.max(ae,O)),alignment:O}}function bs(M,O){return Math.ceil(M/O)*O}$a.serialize=function(M,O){return M._trim(),O&&(M.isTransferred=!0,O.push(M.arrayBuffer)),{length:M.length,arrayBuffer:M.arrayBuffer}},$a.deserialize=function(M){var O=Object.create(this.prototype);return O.arrayBuffer=M.arrayBuffer,O.length=M.length,O.capacity=M.arrayBuffer.byteLength/O.bytesPerElement,O._refreshViews(),O},$a.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},$a.prototype.clear=function(){this.length=0},$a.prototype.resize=function(M){this.reserve(M),this.length=M},$a.prototype.reserve=function(M){if(M>this.capacity){this.capacity=Math.max(M,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var O=this.uint8;this._refreshViews(),O&&this.uint8.set(O)}},$a.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var hs=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae){var pe=this.length;return this.resize(pe+1),this.emplace(pe,Y,ae)},O.prototype.emplace=function(Y,ae,pe){var ye=2*Y;return this.int16[ye+0]=ae,this.int16[ye+1]=pe,Y},O}($a);hs.prototype.bytesPerElement=4,Kr("StructArrayLayout2i4",hs);var zi=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye){var Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,Y,ae,pe,ye)},O.prototype.emplace=function(Y,ae,pe,ye,Ee){var Ne=4*Y;return this.int16[Ne+0]=ae,this.int16[Ne+1]=pe,this.int16[Ne+2]=ye,this.int16[Ne+3]=Ee,Y},O}($a);zi.prototype.bytesPerElement=8,Kr("StructArrayLayout4i8",zi);var _s=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye,Ee,Ne){var Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,Y,ae,pe,ye,Ee,Ne)},O.prototype.emplace=function(Y,ae,pe,ye,Ee,Ne,Qe){var ct=6*Y;return this.int16[ct+0]=ae,this.int16[ct+1]=pe,this.int16[ct+2]=ye,this.int16[ct+3]=Ee,this.int16[ct+4]=Ne,this.int16[ct+5]=Qe,Y},O}($a);_s.prototype.bytesPerElement=12,Kr("StructArrayLayout2i4i12",_s);var Os=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye,Ee,Ne){var Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,Y,ae,pe,ye,Ee,Ne)},O.prototype.emplace=function(Y,ae,pe,ye,Ee,Ne,Qe){var ct=4*Y,mt=8*Y;return this.int16[ct+0]=ae,this.int16[ct+1]=pe,this.uint8[mt+4]=ye,this.uint8[mt+5]=Ee,this.uint8[mt+6]=Ne,this.uint8[mt+7]=Qe,Y},O}($a);Os.prototype.bytesPerElement=8,Kr("StructArrayLayout2i4ub8",Os);var Ms=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt){var Wt=this.length;return this.resize(Wt+1),this.emplace(Wt,Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt)},O.prototype.emplace=function(Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt){var Vt=9*Y,sr=18*Y;return this.uint16[Vt+0]=ae,this.uint16[Vt+1]=pe,this.uint16[Vt+2]=ye,this.uint16[Vt+3]=Ee,this.uint16[Vt+4]=Ne,this.uint16[Vt+5]=Qe,this.uint16[Vt+6]=ct,this.uint16[Vt+7]=mt,this.uint8[sr+16]=Dt,this.uint8[sr+17]=Wt,Y},O}($a);Ms.prototype.bytesPerElement=18,Kr("StructArrayLayout8ui2ub18",Ms);var zs=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt){var sr=this.length;return this.resize(sr+1),this.emplace(sr,Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt)},O.prototype.emplace=function(Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt,sr){var br=12*Y;return this.int16[br+0]=ae,this.int16[br+1]=pe,this.int16[br+2]=ye,this.int16[br+3]=Ee,this.uint16[br+4]=Ne,this.uint16[br+5]=Qe,this.uint16[br+6]=ct,this.uint16[br+7]=mt,this.int16[br+8]=Dt,this.int16[br+9]=Wt,this.int16[br+10]=Vt,this.int16[br+11]=sr,Y},O}($a);zs.prototype.bytesPerElement=24,Kr("StructArrayLayout4i4ui4i24",zs);var ps=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe){var ye=this.length;return this.resize(ye+1),this.emplace(ye,Y,ae,pe)},O.prototype.emplace=function(Y,ae,pe,ye){var Ee=3*Y;return this.float32[Ee+0]=ae,this.float32[Ee+1]=pe,this.float32[Ee+2]=ye,Y},O}($a);ps.prototype.bytesPerElement=12,Kr("StructArrayLayout3f12",ps);var cl=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y){var ae=this.length;return this.resize(ae+1),this.emplace(ae,Y)},O.prototype.emplace=function(Y,ae){var pe=1*Y;return this.uint32[pe+0]=ae,Y},O}($a);cl.prototype.bytesPerElement=4,Kr("StructArrayLayout1ul4",cl);var Tl=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye,Ee,Ne,Qe,ct,mt){var Dt=this.length;return this.resize(Dt+1),this.emplace(Dt,Y,ae,pe,ye,Ee,Ne,Qe,ct,mt)},O.prototype.emplace=function(Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt){var Wt=10*Y,Vt=5*Y;return this.int16[Wt+0]=ae,this.int16[Wt+1]=pe,this.int16[Wt+2]=ye,this.int16[Wt+3]=Ee,this.int16[Wt+4]=Ne,this.int16[Wt+5]=Qe,this.uint32[Vt+3]=ct,this.uint16[Wt+8]=mt,this.uint16[Wt+9]=Dt,Y},O}($a);Tl.prototype.bytesPerElement=20,Kr("StructArrayLayout6i1ul2ui20",Tl);var ws=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye,Ee,Ne){var Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,Y,ae,pe,ye,Ee,Ne)},O.prototype.emplace=function(Y,ae,pe,ye,Ee,Ne,Qe){var ct=6*Y;return this.int16[ct+0]=ae,this.int16[ct+1]=pe,this.int16[ct+2]=ye,this.int16[ct+3]=Ee,this.int16[ct+4]=Ne,this.int16[ct+5]=Qe,Y},O}($a);ws.prototype.bytesPerElement=12,Kr("StructArrayLayout2i2i2i12",ws);var ul=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye,Ee){var Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,Y,ae,pe,ye,Ee)},O.prototype.emplace=function(Y,ae,pe,ye,Ee,Ne){var Qe=4*Y,ct=8*Y;return this.float32[Qe+0]=ae,this.float32[Qe+1]=pe,this.float32[Qe+2]=ye,this.int16[ct+6]=Ee,this.int16[ct+7]=Ne,Y},O}($a);ul.prototype.bytesPerElement=16,Kr("StructArrayLayout2f1f2i16",ul);var Ds=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye){var Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,Y,ae,pe,ye)},O.prototype.emplace=function(Y,ae,pe,ye,Ee){var Ne=12*Y,Qe=3*Y;return this.uint8[Ne+0]=ae,this.uint8[Ne+1]=pe,this.float32[Qe+1]=ye,this.float32[Qe+2]=Ee,Y},O}($a);Ds.prototype.bytesPerElement=12,Kr("StructArrayLayout2ub2f12",Ds);var so=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe){var ye=this.length;return this.resize(ye+1),this.emplace(ye,Y,ae,pe)},O.prototype.emplace=function(Y,ae,pe,ye){var Ee=3*Y;return this.uint16[Ee+0]=ae,this.uint16[Ee+1]=pe,this.uint16[Ee+2]=ye,Y},O}($a);so.prototype.bytesPerElement=6,Kr("StructArrayLayout3ui6",so);var kl=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt,sr,br,Ir,Pr,Vr){var Hr=this.length;return this.resize(Hr+1),this.emplace(Hr,Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt,sr,br,Ir,Pr,Vr)},O.prototype.emplace=function(Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt,sr,br,Ir,Pr,Vr,Hr){var Xr=24*Y,un=12*Y,bn=48*Y;return this.int16[Xr+0]=ae,this.int16[Xr+1]=pe,this.uint16[Xr+2]=ye,this.uint16[Xr+3]=Ee,this.uint32[un+2]=Ne,this.uint32[un+3]=Qe,this.uint32[un+4]=ct,this.uint16[Xr+10]=mt,this.uint16[Xr+11]=Dt,this.uint16[Xr+12]=Wt,this.float32[un+7]=Vt,this.float32[un+8]=sr,this.uint8[bn+36]=br,this.uint8[bn+37]=Ir,this.uint8[bn+38]=Pr,this.uint32[un+10]=Vr,this.int16[Xr+22]=Hr,Y},O}($a);kl.prototype.bytesPerElement=48,Kr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",kl);var Ml=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt,sr,br,Ir,Pr,Vr,Hr,Xr,un,bn,jn,Bn,Wn,sa,la,$n,ma){var pa=this.length;return this.resize(pa+1),this.emplace(pa,Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt,sr,br,Ir,Pr,Vr,Hr,Xr,un,bn,jn,Bn,Wn,sa,la,$n,ma)},O.prototype.emplace=function(Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt,sr,br,Ir,Pr,Vr,Hr,Xr,un,bn,jn,Bn,Wn,sa,la,$n,ma,pa){var ca=34*Y,ei=17*Y;return this.int16[ca+0]=ae,this.int16[ca+1]=pe,this.int16[ca+2]=ye,this.int16[ca+3]=Ee,this.int16[ca+4]=Ne,this.int16[ca+5]=Qe,this.int16[ca+6]=ct,this.int16[ca+7]=mt,this.uint16[ca+8]=Dt,this.uint16[ca+9]=Wt,this.uint16[ca+10]=Vt,this.uint16[ca+11]=sr,this.uint16[ca+12]=br,this.uint16[ca+13]=Ir,this.uint16[ca+14]=Pr,this.uint16[ca+15]=Vr,this.uint16[ca+16]=Hr,this.uint16[ca+17]=Xr,this.uint16[ca+18]=un,this.uint16[ca+19]=bn,this.uint16[ca+20]=jn,this.uint16[ca+21]=Bn,this.uint16[ca+22]=Wn,this.uint32[ei+12]=sa,this.float32[ei+13]=la,this.float32[ei+14]=$n,this.float32[ei+15]=ma,this.float32[ei+16]=pa,Y},O}($a);Ml.prototype.bytesPerElement=68,Kr("StructArrayLayout8i15ui1ul4f68",Ml);var ce=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y){var ae=this.length;return this.resize(ae+1),this.emplace(ae,Y)},O.prototype.emplace=function(Y,ae){var pe=1*Y;return this.float32[pe+0]=ae,Y},O}($a);ce.prototype.bytesPerElement=4,Kr("StructArrayLayout1f4",ce);var C=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe){var ye=this.length;return this.resize(ye+1),this.emplace(ye,Y,ae,pe)},O.prototype.emplace=function(Y,ae,pe,ye){var Ee=3*Y;return this.int16[Ee+0]=ae,this.int16[Ee+1]=pe,this.int16[Ee+2]=ye,Y},O}($a);C.prototype.bytesPerElement=6,Kr("StructArrayLayout3i6",C);var z=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe){var ye=this.length;return this.resize(ye+1),this.emplace(ye,Y,ae,pe)},O.prototype.emplace=function(Y,ae,pe,ye){var Ee=2*Y,Ne=4*Y;return this.uint32[Ee+0]=ae,this.uint16[Ne+2]=pe,this.uint16[Ne+3]=ye,Y},O}($a);z.prototype.bytesPerElement=8,Kr("StructArrayLayout1ul2ui8",z);var F=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae){var pe=this.length;return this.resize(pe+1),this.emplace(pe,Y,ae)},O.prototype.emplace=function(Y,ae,pe){var ye=2*Y;return this.uint16[ye+0]=ae,this.uint16[ye+1]=pe,Y},O}($a);F.prototype.bytesPerElement=4,Kr("StructArrayLayout2ui4",F);var q=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y){var ae=this.length;return this.resize(ae+1),this.emplace(ae,Y)},O.prototype.emplace=function(Y,ae){var pe=1*Y;return this.uint16[pe+0]=ae,Y},O}($a);q.prototype.bytesPerElement=2,Kr("StructArrayLayout1ui2",q);var ie=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae){var pe=this.length;return this.resize(pe+1),this.emplace(pe,Y,ae)},O.prototype.emplace=function(Y,ae,pe){var ye=2*Y;return this.float32[ye+0]=ae,this.float32[ye+1]=pe,Y},O}($a);ie.prototype.bytesPerElement=8,Kr("StructArrayLayout2f8",ie);var ue=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(Y,ae,pe,ye){var Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,Y,ae,pe,ye)},O.prototype.emplace=function(Y,ae,pe,ye,Ee){var Ne=4*Y;return this.float32[Ne+0]=ae,this.float32[Ne+1]=pe,this.float32[Ne+2]=ye,this.float32[Ne+3]=Ee,Y},O}($a);ue.prototype.bytesPerElement=16,Kr("StructArrayLayout4f16",ue);var ge=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var Y={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return Y.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},Y.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},Y.x1.get=function(){return this._structArray.int16[this._pos2+2]},Y.y1.get=function(){return this._structArray.int16[this._pos2+3]},Y.x2.get=function(){return this._structArray.int16[this._pos2+4]},Y.y2.get=function(){return this._structArray.int16[this._pos2+5]},Y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},Y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},Y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},Y.anchorPoint.get=function(){return new r(this.anchorPointX,this.anchorPointY)},Object.defineProperties(O.prototype,Y),O}(Is);ge.prototype.size=20;var we=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(Y){return new ge(this,Y)},O}(Tl);Kr("CollisionBoxArray",we);var Se=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var Y={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return Y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},Y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},Y.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},Y.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},Y.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},Y.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},Y.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},Y.segment.get=function(){return this._structArray.uint16[this._pos2+10]},Y.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},Y.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},Y.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},Y.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},Y.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},Y.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},Y.placedOrientation.set=function(ae){this._structArray.uint8[this._pos1+37]=ae},Y.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},Y.hidden.set=function(ae){this._structArray.uint8[this._pos1+38]=ae},Y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},Y.crossTileID.set=function(ae){this._structArray.uint32[this._pos4+10]=ae},Y.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(O.prototype,Y),O}(Is);Se.prototype.size=48;var Ve=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(Y){return new Se(this,Y)},O}(kl);Kr("PlacedSymbolArray",Ve);var Je=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var Y={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return Y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},Y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},Y.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},Y.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},Y.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},Y.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},Y.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},Y.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},Y.key.get=function(){return this._structArray.uint16[this._pos2+8]},Y.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},Y.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},Y.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},Y.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},Y.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},Y.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},Y.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},Y.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},Y.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},Y.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},Y.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},Y.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},Y.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},Y.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},Y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},Y.crossTileID.set=function(ae){this._structArray.uint32[this._pos4+12]=ae},Y.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},Y.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},Y.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},Y.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(O.prototype,Y),O}(Is);Je.prototype.size=68;var at=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(Y){return new Je(this,Y)},O}(Ml);Kr("SymbolInstanceArray",at);var bt=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getoffsetX=function(Y){return this.float32[1*Y+0]},O}(ce);Kr("GlyphOffsetArray",bt);var Et=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getx=function(Y){return this.int16[3*Y+0]},O.prototype.gety=function(Y){return this.int16[3*Y+1]},O.prototype.gettileUnitDistanceFromAnchor=function(Y){return this.int16[3*Y+2]},O}(C);Kr("SymbolLineVertexArray",Et);var kt=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var Y={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return Y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},Y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},Y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(O.prototype,Y),O}(Is);kt.prototype.size=8;var At=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(Y){return new kt(this,Y)},O}(z);Kr("FeatureIndexArray",At);var xt=oi([{name:"a_pos",components:2,type:"Int16"}],4).members,zt=function(M){M===void 0&&(M=[]),this.segments=M};function It(M,O){return 256*(M=u(Math.floor(M),0,255))+(O=u(Math.floor(O),0,255))}zt.prototype.prepareSegment=function(M,O,Y,ae){var pe=this.segments[this.segments.length-1];return M>zt.MAX_VERTEX_ARRAY_LENGTH&&A("Max vertices per segment is "+zt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+M),(!pe||pe.vertexLength+M>zt.MAX_VERTEX_ARRAY_LENGTH||pe.sortKey!==ae)&&(pe={vertexOffset:O.length,primitiveOffset:Y.length,vertexLength:0,primitiveLength:0},ae!==void 0&&(pe.sortKey=ae),this.segments.push(pe)),pe},zt.prototype.get=function(){return this.segments},zt.prototype.destroy=function(){for(var M=0,O=this.segments;M<O.length;M+=1){var Y=O[M];for(var ae in Y.vaos)Y.vaos[ae].destroy()}},zt.simpleSegment=function(M,O,Y,ae){return new zt([{vertexOffset:M,primitiveOffset:O,vertexLength:Y,primitiveLength:ae,vaos:{},sortKey:0}])},zt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Kr("SegmentVector",zt);var Bt=oi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),nr=n(function(M){M.exports=function(O,Y){var ae,pe,ye,Ee,Ne,Qe,ct,mt;for(ae=3&O.length,pe=O.length-ae,ye=Y,Ne=3432918353,Qe=461845907,mt=0;mt<pe;)ct=255&O.charCodeAt(mt)|(255&O.charCodeAt(++mt))<<8|(255&O.charCodeAt(++mt))<<16|(255&O.charCodeAt(++mt))<<24,++mt,ye=27492+(65535&(Ee=5*(65535&(ye=(ye^=ct=(65535&(ct=(ct=(65535&ct)*Ne+(((ct>>>16)*Ne&65535)<<16)&4294967295)<<15|ct>>>17))*Qe+(((ct>>>16)*Qe&65535)<<16)&4294967295)<<13|ye>>>19))+((5*(ye>>>16)&65535)<<16)&4294967295))+((58964+(Ee>>>16)&65535)<<16);switch(ct=0,ae){case 3:ct^=(255&O.charCodeAt(mt+2))<<16;case 2:ct^=(255&O.charCodeAt(mt+1))<<8;case 1:ye^=ct=(65535&(ct=(ct=(65535&(ct^=255&O.charCodeAt(mt)))*Ne+(((ct>>>16)*Ne&65535)<<16)&4294967295)<<15|ct>>>17))*Qe+(((ct>>>16)*Qe&65535)<<16)&4294967295}return ye^=O.length,ye=2246822507*(65535&(ye^=ye>>>16))+((2246822507*(ye>>>16)&65535)<<16)&4294967295,ye=3266489909*(65535&(ye^=ye>>>13))+((3266489909*(ye>>>16)&65535)<<16)&4294967295,(ye^=ye>>>16)>>>0}}),gr=n(function(M){M.exports=function(O,Y){for(var ae,pe=O.length,ye=Y^pe,Ee=0;pe>=4;)ae=1540483477*(65535&(ae=255&O.charCodeAt(Ee)|(255&O.charCodeAt(++Ee))<<8|(255&O.charCodeAt(++Ee))<<16|(255&O.charCodeAt(++Ee))<<24))+((1540483477*(ae>>>16)&65535)<<16),ye=1540483477*(65535&ye)+((1540483477*(ye>>>16)&65535)<<16)^(ae=1540483477*(65535&(ae^=ae>>>24))+((1540483477*(ae>>>16)&65535)<<16)),pe-=4,++Ee;switch(pe){case 3:ye^=(255&O.charCodeAt(Ee+2))<<16;case 2:ye^=(255&O.charCodeAt(Ee+1))<<8;case 1:ye=1540483477*(65535&(ye^=255&O.charCodeAt(Ee)))+((1540483477*(ye>>>16)&65535)<<16)}return ye=1540483477*(65535&(ye^=ye>>>13))+((1540483477*(ye>>>16)&65535)<<16),(ye^=ye>>>15)>>>0}}),Lr=nr,Sr=nr,$r=gr;Lr.murmur3=Sr,Lr.murmur2=$r;var Qr=function(){this.ids=[],this.positions=[],this.indexed=!1};Qr.prototype.add=function(M,O,Y,ae){this.ids.push(sn(M)),this.positions.push(O,Y,ae)},Qr.prototype.getPositions=function(M){for(var O=sn(M),Y=0,ae=this.ids.length-1;Y<ae;){var pe=Y+ae>>1;this.ids[pe]>=O?ae=pe:Y=pe+1}for(var ye=[];this.ids[Y]===O;){var Ee=this.positions[3*Y],Ne=this.positions[3*Y+1],Qe=this.positions[3*Y+2];ye.push({index:Ee,start:Ne,end:Qe}),Y++}return ye},Qr.serialize=function(M,O){var Y=new Float64Array(M.ids),ae=new Uint32Array(M.positions);return function pe(ye,Ee,Ne,Qe){for(;Ne<Qe;){for(var ct=ye[Ne+Qe>>1],mt=Ne-1,Dt=Qe+1;;){do mt++;while(ye[mt]<ct);do Dt--;while(ye[Dt]>ct);if(mt>=Dt)break;Vn(ye,mt,Dt),Vn(Ee,3*mt,3*Dt),Vn(Ee,3*mt+1,3*Dt+1),Vn(Ee,3*mt+2,3*Dt+2)}Dt-Ne<Qe-Dt?(pe(ye,Ee,Ne,Dt),Ne=Dt+1):(pe(ye,Ee,Dt+1,Qe),Qe=Dt)}}(Y,ae,0,Y.length-1),O&&O.push(Y.buffer,ae.buffer),{ids:Y,positions:ae}},Qr.deserialize=function(M){var O=new Qr;return O.ids=M.ids,O.positions=M.positions,O.indexed=!0,O};var fn=Math.pow(2,53)-1;function sn(M){var O=+M;return!isNaN(O)&&O<=fn?O:Lr(String(M))}function Vn(M,O,Y){var ae=M[O];M[O]=M[Y],M[Y]=ae}Kr("FeaturePositionMap",Qr);var Jn=function(M,O){this.gl=M.gl,this.location=O},ha=function(M){function O(Y,ae){M.call(this,Y,ae),this.current=0}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){this.current!==Y&&(this.current=Y,this.gl.uniform1i(this.location,Y))},O}(Jn),Wr=function(M){function O(Y,ae){M.call(this,Y,ae),this.current=0}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){this.current!==Y&&(this.current=Y,this.gl.uniform1f(this.location,Y))},O}(Jn),Mn=function(M){function O(Y,ae){M.call(this,Y,ae),this.current=[0,0]}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){Y[0]===this.current[0]&&Y[1]===this.current[1]||(this.current=Y,this.gl.uniform2f(this.location,Y[0],Y[1]))},O}(Jn),Kn=function(M){function O(Y,ae){M.call(this,Y,ae),this.current=[0,0,0]}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){Y[0]===this.current[0]&&Y[1]===this.current[1]&&Y[2]===this.current[2]||(this.current=Y,this.gl.uniform3f(this.location,Y[0],Y[1],Y[2]))},O}(Jn),Yn=function(M){function O(Y,ae){M.call(this,Y,ae),this.current=[0,0,0,0]}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){Y[0]===this.current[0]&&Y[1]===this.current[1]&&Y[2]===this.current[2]&&Y[3]===this.current[3]||(this.current=Y,this.gl.uniform4f(this.location,Y[0],Y[1],Y[2],Y[3]))},O}(Jn),ia=function(M){function O(Y,ae){M.call(this,Y,ae),this.current=Zt.transparent}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){Y.r===this.current.r&&Y.g===this.current.g&&Y.b===this.current.b&&Y.a===this.current.a||(this.current=Y,this.gl.uniform4f(this.location,Y.r,Y.g,Y.b,Y.a))},O}(Jn),da=new Float32Array(16),La=function(M){function O(Y,ae){M.call(this,Y,ae),this.current=da}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(Y){if(Y[12]!==this.current[12]||Y[0]!==this.current[0])return this.current=Y,void this.gl.uniformMatrix4fv(this.location,!1,Y);for(var ae=1;ae<16;ae++)if(Y[ae]!==this.current[ae]){this.current=Y,this.gl.uniformMatrix4fv(this.location,!1,Y);break}},O}(Jn);function ta(M){return[It(255*M.r,255*M.g),It(255*M.b,255*M.a)]}var _a=function(M,O,Y){this.value=M,this.uniformNames=O.map(function(ae){return"u_"+ae}),this.type=Y};_a.prototype.setUniform=function(M,O,Y){M.set(Y.constantOr(this.value))},_a.prototype.getBinding=function(M,O,Y){return this.type==="color"?new ia(M,O):new Wr(M,O)};var ya=function(M,O){this.uniformNames=O.map(function(Y){return"u_"+Y}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ya.prototype.setConstantPatternPositions=function(M,O){this.pixelRatioFrom=O.pixelRatio,this.pixelRatioTo=M.pixelRatio,this.patternFrom=O.tlbr,this.patternTo=M.tlbr},ya.prototype.setUniform=function(M,O,Y,ae){var pe=ae==="u_pattern_to"?this.patternTo:ae==="u_pattern_from"?this.patternFrom:ae==="u_pixel_ratio_to"?this.pixelRatioTo:ae==="u_pixel_ratio_from"?this.pixelRatioFrom:null;pe&&M.set(pe)},ya.prototype.getBinding=function(M,O,Y){return Y.substr(0,9)==="u_pattern"?new Yn(M,O):new Wr(M,O)};var Ia=function(M,O,Y,ae){this.expression=M,this.type=Y,this.maxValue=0,this.paintVertexAttributes=O.map(function(pe){return{name:"a_"+pe,type:"Float32",components:Y==="color"?2:1,offset:0}}),this.paintVertexArray=new ae};Ia.prototype.populatePaintArray=function(M,O,Y,ae,pe){var ye=this.paintVertexArray.length,Ee=this.expression.evaluate(new ii(0),O,{},ae,[],pe);this.paintVertexArray.resize(M),this._setPaintValue(ye,M,Ee)},Ia.prototype.updatePaintArray=function(M,O,Y,ae){var pe=this.expression.evaluate({zoom:0},Y,ae);this._setPaintValue(M,O,pe)},Ia.prototype._setPaintValue=function(M,O,Y){if(this.type==="color")for(var ae=ta(Y),pe=M;pe<O;pe++)this.paintVertexArray.emplace(pe,ae[0],ae[1]);else{for(var ye=M;ye<O;ye++)this.paintVertexArray.emplace(ye,Y);this.maxValue=Math.max(this.maxValue,Math.abs(Y))}},Ia.prototype.upload=function(M){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=M.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ia.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var wa=function(M,O,Y,ae,pe,ye){this.expression=M,this.uniformNames=O.map(function(Ee){return"u_"+Ee+"_t"}),this.type=Y,this.useIntegerZoom=ae,this.zoom=pe,this.maxValue=0,this.paintVertexAttributes=O.map(function(Ee){return{name:"a_"+Ee,type:"Float32",components:Y==="color"?4:2,offset:0}}),this.paintVertexArray=new ye};wa.prototype.populatePaintArray=function(M,O,Y,ae,pe){var ye=this.expression.evaluate(new ii(this.zoom),O,{},ae,[],pe),Ee=this.expression.evaluate(new ii(this.zoom+1),O,{},ae,[],pe),Ne=this.paintVertexArray.length;this.paintVertexArray.resize(M),this._setPaintValue(Ne,M,ye,Ee)},wa.prototype.updatePaintArray=function(M,O,Y,ae){var pe=this.expression.evaluate({zoom:this.zoom},Y,ae),ye=this.expression.evaluate({zoom:this.zoom+1},Y,ae);this._setPaintValue(M,O,pe,ye)},wa.prototype._setPaintValue=function(M,O,Y,ae){if(this.type==="color")for(var pe=ta(Y),ye=ta(ae),Ee=M;Ee<O;Ee++)this.paintVertexArray.emplace(Ee,pe[0],pe[1],ye[0],ye[1]);else{for(var Ne=M;Ne<O;Ne++)this.paintVertexArray.emplace(Ne,Y,ae);this.maxValue=Math.max(this.maxValue,Math.abs(Y),Math.abs(ae))}},wa.prototype.upload=function(M){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=M.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},wa.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},wa.prototype.setUniform=function(M,O){var Y=this.useIntegerZoom?Math.floor(O.zoom):O.zoom,ae=u(this.expression.interpolationFactor(Y,this.zoom,this.zoom+1),0,1);M.set(ae)},wa.prototype.getBinding=function(M,O,Y){return new Wr(M,O)};var Oa=function(M,O,Y,ae,pe,ye){this.expression=M,this.type=O,this.useIntegerZoom=Y,this.zoom=ae,this.layerId=ye,this.zoomInPaintVertexArray=new pe,this.zoomOutPaintVertexArray=new pe};Oa.prototype.populatePaintArray=function(M,O,Y){var ae=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(M),this.zoomOutPaintVertexArray.resize(M),this._setPaintValues(ae,M,O.patterns&&O.patterns[this.layerId],Y)},Oa.prototype.updatePaintArray=function(M,O,Y,ae,pe){this._setPaintValues(M,O,Y.patterns&&Y.patterns[this.layerId],pe)},Oa.prototype._setPaintValues=function(M,O,Y,ae){if(ae&&Y){var pe=Y.min,ye=Y.mid,Ee=Y.max,Ne=ae[pe],Qe=ae[ye],ct=ae[Ee];if(Ne&&Qe&&ct)for(var mt=M;mt<O;mt++)this.zoomInPaintVertexArray.emplace(mt,Qe.tl[0],Qe.tl[1],Qe.br[0],Qe.br[1],Ne.tl[0],Ne.tl[1],Ne.br[0],Ne.br[1],Qe.pixelRatio,Ne.pixelRatio),this.zoomOutPaintVertexArray.emplace(mt,Qe.tl[0],Qe.tl[1],Qe.br[0],Qe.br[1],ct.tl[0],ct.tl[1],ct.br[0],ct.br[1],Qe.pixelRatio,ct.pixelRatio)}},Oa.prototype.upload=function(M){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=M.createVertexBuffer(this.zoomInPaintVertexArray,Bt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=M.createVertexBuffer(this.zoomOutPaintVertexArray,Bt.members,this.expression.isStateDependent))},Oa.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ha=function(M,O,Y,ae){this.binders={},this.layoutAttributes=ae,this._buffers=[];var pe=[];for(var ye in M.paint._values)if(Y(ye)){var Ee=M.paint.get(ye);if(Ee instanceof Ni&&Xo(Ee.property.specification)){var Ne=Di(ye,M.type),Qe=Ee.value,ct=Ee.property.specification.type,mt=Ee.property.useIntegerZoom,Dt=Ee.property.specification["property-type"],Wt=Dt==="cross-faded"||Dt==="cross-faded-data-driven";if(Qe.kind==="constant")this.binders[ye]=Wt?new ya(Qe.value,Ne):new _a(Qe.value,Ne,ct),pe.push("/u_"+ye);else if(Qe.kind==="source"||Wt){var Vt=Ri(ye,ct,"source");this.binders[ye]=Wt?new Oa(Qe,ct,mt,O,Vt,M.id):new Ia(Qe,Ne,ct,Vt),pe.push("/a_"+ye)}else{var sr=Ri(ye,ct,"composite");this.binders[ye]=new wa(Qe,Ne,ct,mt,O,sr),pe.push("/z_"+ye)}}}this.cacheKey=pe.sort().join("")};Ha.prototype.getMaxValue=function(M){var O=this.binders[M];return O instanceof Ia||O instanceof wa?O.maxValue:0},Ha.prototype.populatePaintArrays=function(M,O,Y,ae,pe){for(var ye in this.binders){var Ee=this.binders[ye];(Ee instanceof Ia||Ee instanceof wa||Ee instanceof Oa)&&Ee.populatePaintArray(M,O,Y,ae,pe)}},Ha.prototype.setConstantPatternPositions=function(M,O){for(var Y in this.binders){var ae=this.binders[Y];ae instanceof ya&&ae.setConstantPatternPositions(M,O)}},Ha.prototype.updatePaintArrays=function(M,O,Y,ae,pe){var ye=!1;for(var Ee in M)for(var Ne=0,Qe=O.getPositions(Ee);Ne<Qe.length;Ne+=1){var ct=Qe[Ne],mt=Y.feature(ct.index);for(var Dt in this.binders){var Wt=this.binders[Dt];if((Wt instanceof Ia||Wt instanceof wa||Wt instanceof Oa)&&Wt.expression.isStateDependent===!0){var Vt=ae.paint.get(Dt);Wt.expression=Vt.value,Wt.updatePaintArray(ct.start,ct.end,mt,M[Ee],pe),ye=!0}}}return ye},Ha.prototype.defines=function(){var M=[];for(var O in this.binders){var Y=this.binders[O];(Y instanceof _a||Y instanceof ya)&&M.push.apply(M,Y.uniformNames.map(function(ae){return"#define HAS_UNIFORM_"+ae}))}return M},Ha.prototype.getPaintVertexBuffers=function(){return this._buffers},Ha.prototype.getUniforms=function(M,O){var Y=[];for(var ae in this.binders){var pe=this.binders[ae];if(pe instanceof _a||pe instanceof ya||pe instanceof wa)for(var ye=0,Ee=pe.uniformNames;ye<Ee.length;ye+=1){var Ne=Ee[ye];if(O[Ne]){var Qe=pe.getBinding(M,O[Ne],Ne);Y.push({name:Ne,property:ae,binding:Qe})}}}return Y},Ha.prototype.setUniforms=function(M,O,Y,ae){for(var pe=0,ye=O;pe<ye.length;pe+=1){var Ee=ye[pe],Ne=Ee.name,Qe=Ee.property,ct=Ee.binding;this.binders[Qe].setUniform(ct,ae,Y.get(Qe),Ne)}},Ha.prototype.updatePaintBuffers=function(M){for(var O in this._buffers=[],this.binders){var Y=this.binders[O];if(M&&Y instanceof Oa){var ae=M.fromScale===2?Y.zoomInPaintVertexBuffer:Y.zoomOutPaintVertexBuffer;ae&&this._buffers.push(ae)}else(Y instanceof Ia||Y instanceof wa)&&Y.paintVertexBuffer&&this._buffers.push(Y.paintVertexBuffer)}},Ha.prototype.upload=function(M){for(var O in this.binders){var Y=this.binders[O];(Y instanceof Ia||Y instanceof wa||Y instanceof Oa)&&Y.upload(M)}this.updatePaintBuffers()},Ha.prototype.destroy=function(){for(var M in this.binders){var O=this.binders[M];(O instanceof Ia||O instanceof wa||O instanceof Oa)&&O.destroy()}};var di=function(M,O,Y,ae){ae===void 0&&(ae=function(){return!0}),this.programConfigurations={};for(var pe=0,ye=O;pe<ye.length;pe+=1){var Ee=ye[pe];this.programConfigurations[Ee.id]=new Ha(Ee,Y,ae,M)}this.needsUpload=!1,this._featureMap=new Qr,this._bufferOffset=0};function Di(M,O){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[M]||[M.replace(O+"-","").replace(/-/g,"_")]}function Ri(M,O,Y){var ae={color:{source:ie,composite:ue},number:{source:ce,composite:ie}},pe=function(ye){return{"line-pattern":{source:Ms,composite:Ms},"fill-pattern":{source:Ms,composite:Ms},"fill-extrusion-pattern":{source:Ms,composite:Ms}}[ye]}(M);return pe&&pe[Y]||ae[O][Y]}di.prototype.populatePaintArrays=function(M,O,Y,ae,pe,ye){for(var Ee in this.programConfigurations)this.programConfigurations[Ee].populatePaintArrays(M,O,ae,pe,ye);O.id!==void 0&&this._featureMap.add(O.id,Y,this._bufferOffset,M),this._bufferOffset=M,this.needsUpload=!0},di.prototype.updatePaintArrays=function(M,O,Y,ae){for(var pe=0,ye=Y;pe<ye.length;pe+=1){var Ee=ye[pe];this.needsUpload=this.programConfigurations[Ee.id].updatePaintArrays(M,this._featureMap,O,Ee,ae)||this.needsUpload}},di.prototype.get=function(M){return this.programConfigurations[M]},di.prototype.upload=function(M){if(this.needsUpload){for(var O in this.programConfigurations)this.programConfigurations[O].upload(M);this.needsUpload=!1}},di.prototype.destroy=function(){for(var M in this.programConfigurations)this.programConfigurations[M].destroy()},Kr("ConstantBinder",_a),Kr("CrossFadedConstantBinder",ya),Kr("SourceExpressionBinder",Ia),Kr("CrossFadedCompositeBinder",Oa),Kr("CompositeExpressionBinder",wa),Kr("ProgramConfiguration",Ha,{omit:["_buffers"]}),Kr("ProgramConfigurationSet",di);var pi,Ei=(pi=15,{min:-1*Math.pow(2,pi-1),max:Math.pow(2,pi-1)-1});function bi(M){for(var O=8192/M.extent,Y=M.loadGeometry(),ae=0;ae<Y.length;ae++)for(var pe=Y[ae],ye=0;ye<pe.length;ye++){var Ee=pe[ye];Ee.x=Math.round(Ee.x*O),Ee.y=Math.round(Ee.y*O),(Ee.x<Ei.min||Ee.x>Ei.max||Ee.y<Ei.min||Ee.y>Ei.max)&&(A("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Ee.x=u(Ee.x,Ei.min,Ei.max),Ee.y=u(Ee.y,Ei.min,Ei.max))}return Y}function Mo(M,O,Y,ae,pe){M.emplaceBack(2*O+(ae+1)/2,2*Y+(pe+1)/2)}var Zi=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.layoutVertexArray=new hs,this.indexArray=new so,this.segments=new zt,this.programConfigurations=new di(xt,M.layers,M.zoom),this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function Uo(M,O){for(var Y=0;Y<M.length;Y++)if(ss(O,M[Y]))return!0;for(var ae=0;ae<O.length;ae++)if(ss(M,O[ae]))return!0;return!!fl(M,O)}function As(M,O,Y){return!!ss(M,O)||!!Ao(O,M,Y)}function Xs(M,O){if(M.length===1)return Sl(O,M[0]);for(var Y=0;Y<O.length;Y++)for(var ae=O[Y],pe=0;pe<ae.length;pe++)if(ss(M,ae[pe]))return!0;for(var ye=0;ye<M.length;ye++)if(Sl(O,M[ye]))return!0;for(var Ee=0;Ee<O.length;Ee++)if(fl(M,O[Ee]))return!0;return!1}function Al(M,O,Y){if(M.length>1){if(fl(M,O))return!0;for(var ae=0;ae<O.length;ae++)if(Ao(O[ae],M,Y))return!0}for(var pe=0;pe<M.length;pe++)if(Ao(M[pe],O,Y))return!0;return!1}function fl(M,O){if(M.length===0||O.length===0)return!1;for(var Y=0;Y<M.length-1;Y++)for(var ae=M[Y],pe=M[Y+1],ye=0;ye<O.length-1;ye++)if(hl(ae,pe,O[ye],O[ye+1]))return!0;return!1}function hl(M,O,Y,ae){return I(M,Y,ae)!==I(O,Y,ae)&&I(M,O,Y)!==I(M,O,ae)}function Ao(M,O,Y){var ae=Y*Y;if(O.length===1)return M.distSqr(O[0])<ae;for(var pe=1;pe<O.length;pe++)if(Qs(M,O[pe-1],O[pe])<ae)return!0;return!1}function Qs(M,O,Y){var ae=O.distSqr(Y);if(ae===0)return M.distSqr(O);var pe=((M.x-O.x)*(Y.x-O.x)+(M.y-O.y)*(Y.y-O.y))/ae;return pe<0?M.distSqr(O):pe>1?M.distSqr(Y):M.distSqr(Y.sub(O)._mult(pe)._add(O))}function Sl(M,O){for(var Y,ae,pe,ye=!1,Ee=0;Ee<M.length;Ee++)for(var Ne=0,Qe=(Y=M[Ee]).length-1;Ne<Y.length;Qe=Ne++)ae=Y[Ne],pe=Y[Qe],ae.y>O.y!=pe.y>O.y&&O.x<(pe.x-ae.x)*(O.y-ae.y)/(pe.y-ae.y)+ae.x&&(ye=!ye);return ye}function ss(M,O){for(var Y=!1,ae=0,pe=M.length-1;ae<M.length;pe=ae++){var ye=M[ae],Ee=M[pe];ye.y>O.y!=Ee.y>O.y&&O.x<(Ee.x-ye.x)*(O.y-ye.y)/(Ee.y-ye.y)+ye.x&&(Y=!Y)}return Y}function El(M,O,Y){var ae=Y[0],pe=Y[2];if(M.x<ae.x&&O.x<ae.x||M.x>pe.x&&O.x>pe.x||M.y<ae.y&&O.y<ae.y||M.y>pe.y&&O.y>pe.y)return!1;var ye=I(M,O,Y[0]);return ye!==I(M,O,Y[1])||ye!==I(M,O,Y[2])||ye!==I(M,O,Y[3])}function Li(M,O,Y){var ae=O.paint.get(M).value;return ae.kind==="constant"?ae.value:Y.programConfigurations.get(O.id).getMaxValue(M)}function Fo(M){return Math.sqrt(M[0]*M[0]+M[1]*M[1])}function Bo(M,O,Y,ae,pe){if(!O[0]&&!O[1])return M;var ye=r.convert(O)._mult(pe);Y==="viewport"&&ye._rotate(-ae);for(var Ee=[],Ne=0;Ne<M.length;Ne++){var Qe=M[Ne];Ee.push(Qe.sub(ye))}return Ee}Zi.prototype.populate=function(M,O,Y){var ae=this.layers[0],pe=[],ye=null;ae.type==="circle"&&(ye=ae.layout.get("circle-sort-key"));for(var Ee=0,Ne=M;Ee<Ne.length;Ee+=1){var Qe=Ne[Ee],ct=Qe.feature,mt=Qe.id,Dt=Qe.index,Wt=Qe.sourceLayerIndex,Vt=this.layers[0]._featureFilter.needGeometry,sr={type:ct.type,id:mt,properties:ct.properties,geometry:Vt?bi(ct):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),sr,Y)){Vt||(sr.geometry=bi(ct));var br=ye?ye.evaluate(sr,{},Y):void 0,Ir={id:mt,properties:ct.properties,type:ct.type,sourceLayerIndex:Wt,index:Dt,geometry:sr.geometry,patterns:{},sortKey:br};pe.push(Ir)}}ye&&pe.sort(function(Wn,sa){return Wn.sortKey-sa.sortKey});for(var Pr=0,Vr=pe;Pr<Vr.length;Pr+=1){var Hr=Vr[Pr],Xr=Hr,un=Xr.geometry,bn=Xr.index,jn=Xr.sourceLayerIndex,Bn=M[bn].feature;this.addFeature(Hr,un,bn,Y),O.featureIndex.insert(Bn,un,bn,jn,this.index)}},Zi.prototype.update=function(M,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,Y)},Zi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Zi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Zi.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,xt),this.indexBuffer=M.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(M),this.uploaded=!0},Zi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Zi.prototype.addFeature=function(M,O,Y,ae){for(var pe=0,ye=O;pe<ye.length;pe+=1)for(var Ee=0,Ne=ye[pe];Ee<Ne.length;Ee+=1){var Qe=Ne[Ee],ct=Qe.x,mt=Qe.y;if(!(ct<0||ct>=8192||mt<0||mt>=8192)){var Dt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,M.sortKey),Wt=Dt.vertexLength;Mo(this.layoutVertexArray,ct,mt,-1,-1),Mo(this.layoutVertexArray,ct,mt,1,-1),Mo(this.layoutVertexArray,ct,mt,1,1),Mo(this.layoutVertexArray,ct,mt,-1,1),this.indexArray.emplaceBack(Wt,Wt+1,Wt+2),this.indexArray.emplaceBack(Wt,Wt+3,Wt+2),Dt.vertexLength+=4,Dt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,Y,{},ae)},Kr("CircleBucket",Zi,{omit:["layers"]});var Vl=new Ro({"circle-sort-key":new ba(xe.layout_circle["circle-sort-key"])}),Fu={paint:new Ro({"circle-radius":new ba(xe.paint_circle["circle-radius"]),"circle-color":new ba(xe.paint_circle["circle-color"]),"circle-blur":new ba(xe.paint_circle["circle-blur"]),"circle-opacity":new ba(xe.paint_circle["circle-opacity"]),"circle-translate":new fa(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new fa(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new fa(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new fa(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ba(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ba(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ba(xe.paint_circle["circle-stroke-opacity"])}),layout:Vl},$o=typeof Float32Array<"u"?Float32Array:Array;function yc(M){return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function Ll(M,O,Y){var ae=O[0],pe=O[1],ye=O[2],Ee=O[3],Ne=O[4],Qe=O[5],ct=O[6],mt=O[7],Dt=O[8],Wt=O[9],Vt=O[10],sr=O[11],br=O[12],Ir=O[13],Pr=O[14],Vr=O[15],Hr=Y[0],Xr=Y[1],un=Y[2],bn=Y[3];return M[0]=Hr*ae+Xr*Ne+un*Dt+bn*br,M[1]=Hr*pe+Xr*Qe+un*Wt+bn*Ir,M[2]=Hr*ye+Xr*ct+un*Vt+bn*Pr,M[3]=Hr*Ee+Xr*mt+un*sr+bn*Vr,Hr=Y[4],Xr=Y[5],un=Y[6],bn=Y[7],M[4]=Hr*ae+Xr*Ne+un*Dt+bn*br,M[5]=Hr*pe+Xr*Qe+un*Wt+bn*Ir,M[6]=Hr*ye+Xr*ct+un*Vt+bn*Pr,M[7]=Hr*Ee+Xr*mt+un*sr+bn*Vr,Hr=Y[8],Xr=Y[9],un=Y[10],bn=Y[11],M[8]=Hr*ae+Xr*Ne+un*Dt+bn*br,M[9]=Hr*pe+Xr*Qe+un*Wt+bn*Ir,M[10]=Hr*ye+Xr*ct+un*Vt+bn*Pr,M[11]=Hr*Ee+Xr*mt+un*sr+bn*Vr,Hr=Y[12],Xr=Y[13],un=Y[14],bn=Y[15],M[12]=Hr*ae+Xr*Ne+un*Dt+bn*br,M[13]=Hr*pe+Xr*Qe+un*Wt+bn*Ir,M[14]=Hr*ye+Xr*ct+un*Vt+bn*Pr,M[15]=Hr*Ee+Xr*mt+un*sr+bn*Vr,M}Math.hypot||(Math.hypot=function(){for(var M=arguments,O=0,Y=arguments.length;Y--;)O+=M[Y]*M[Y];return Math.sqrt(O)});var Bu=Ll,$s,Nu=function(M,O,Y){return M[0]=O[0]-Y[0],M[1]=O[1]-Y[1],M[2]=O[2]-Y[2],M};$s=new $o(3),$o!=Float32Array&&($s[0]=0,$s[1]=0,$s[2]=0);function Hl(M,O,Y){var ae=O[0],pe=O[1],ye=O[2],Ee=O[3];return M[0]=Y[0]*ae+Y[4]*pe+Y[8]*ye+Y[12]*Ee,M[1]=Y[1]*ae+Y[5]*pe+Y[9]*ye+Y[13]*Ee,M[2]=Y[2]*ae+Y[6]*pe+Y[10]*ye+Y[14]*Ee,M[3]=Y[3]*ae+Y[7]*pe+Y[11]*ye+Y[15]*Ee,M}(function(){(function(){var M=new $o(4);return $o!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0,M[3]=0),M})()})();var xc=function(M){var O=M[0],Y=M[1];return O*O+Y*Y},Rp=(function(){(function(){var M=new $o(2);return $o!=Float32Array&&(M[0]=0,M[1]=0),M})()}(),function(M){function O(Y){M.call(this,Y,Fu)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(Y){return new Zi(Y)},O.prototype.queryRadius=function(Y){var ae=Y;return Li("circle-radius",this,ae)+Li("circle-stroke-width",this,ae)+Fo(this.paint.get("circle-translate"))},O.prototype.queryIntersectsFeature=function(Y,ae,pe,ye,Ee,Ne,Qe,ct){for(var mt=Bo(Y,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Ne.angle,Qe),Dt=this.paint.get("circle-radius").evaluate(ae,pe)+this.paint.get("circle-stroke-width").evaluate(ae,pe),Wt=this.paint.get("circle-pitch-alignment")==="map",Vt=Wt?mt:function(jn,Bn){return jn.map(function(Wn){return Of(Wn,Bn)})}(mt,ct),sr=Wt?Dt*Qe:Dt,br=0,Ir=ye;br<Ir.length;br+=1)for(var Pr=0,Vr=Ir[br];Pr<Vr.length;Pr+=1){var Hr=Vr[Pr],Xr=Wt?Hr:Of(Hr,ct),un=sr,bn=Hl([],[Hr.x,Hr.y,0,1],ct);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?un*=bn[3]/Ne.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(un*=Ne.cameraToCenterDistance/bn[3]),As(Vt,Xr,un))return!0}return!1},O}(Zo));function Of(M,O){var Y=Hl([],[M.x,M.y,0,1],O);return new r(Y[0]/Y[3],Y[1]/Y[3])}var zf=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Zi);function ju(M,O,Y,ae){var pe=O.width,ye=O.height;if(ae){if(ae instanceof Uint8ClampedArray)ae=new Uint8Array(ae.buffer);else if(ae.length!==pe*ye*Y)throw new RangeError("mismatched image size")}else ae=new Uint8Array(pe*ye*Y);return M.width=pe,M.height=ye,M.data=ae,M}function Df(M,O,Y){var ae=O.width,pe=O.height;if(ae!==M.width||pe!==M.height){var ye=ju({},{width:ae,height:pe},Y);Uu(M,ye,{x:0,y:0},{x:0,y:0},{width:Math.min(M.width,ae),height:Math.min(M.height,pe)},Y),M.width=ae,M.height=pe,M.data=ye.data}}function Uu(M,O,Y,ae,pe,ye){if(pe.width===0||pe.height===0)return O;if(pe.width>M.width||pe.height>M.height||Y.x>M.width-pe.width||Y.y>M.height-pe.height)throw new RangeError("out of range source coordinates for image copy");if(pe.width>O.width||pe.height>O.height||ae.x>O.width-pe.width||ae.y>O.height-pe.height)throw new RangeError("out of range destination coordinates for image copy");for(var Ee=M.data,Ne=O.data,Qe=0;Qe<pe.height;Qe++)for(var ct=((Y.y+Qe)*M.width+Y.x)*ye,mt=((ae.y+Qe)*O.width+ae.x)*ye,Dt=0;Dt<pe.width*ye;Dt++)Ne[mt+Dt]=Ee[ct+Dt];return O}Kr("HeatmapBucket",zf,{omit:["layers"]});var Cl=function(M,O){ju(this,M,1,O)};Cl.prototype.resize=function(M){Df(this,M,1)},Cl.prototype.clone=function(){return new Cl({width:this.width,height:this.height},new Uint8Array(this.data))},Cl.copy=function(M,O,Y,ae,pe){Uu(M,O,Y,ae,pe,1)};var es=function(M,O){ju(this,M,4,O)};es.prototype.resize=function(M){Df(this,M,4)},es.prototype.replace=function(M,O){O?this.data.set(M):M instanceof Uint8ClampedArray?this.data=new Uint8Array(M.buffer):this.data=M},es.prototype.clone=function(){return new es({width:this.width,height:this.height},new Uint8Array(this.data))},es.copy=function(M,O,Y,ae,pe){Uu(M,O,Y,ae,pe,4)},Kr("AlphaImage",Cl),Kr("RGBAImage",es);var Fp={paint:new Ro({"heatmap-radius":new ba(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ba(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new fa(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new os(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new fa(xe.paint_heatmap["heatmap-opacity"])})};function Rf(M,O){for(var Y=new Uint8Array(1024),ae={},pe=0,ye=0;pe<256;pe++,ye+=4){ae[O]=pe/255;var Ee=M.evaluate(ae);Y[ye+0]=Math.floor(255*Ee.r/Ee.a),Y[ye+1]=Math.floor(255*Ee.g/Ee.a),Y[ye+2]=Math.floor(255*Ee.b/Ee.a),Y[ye+3]=Math.floor(255*Ee.a)}return new es({width:256,height:1},Y)}var Bp=function(M){function O(Y){M.call(this,Y,Fp),this._updateColorRamp()}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(Y){return new zf(Y)},O.prototype._handleSpecialPaintPropertyUpdate=function(Y){Y==="heatmap-color"&&this._updateColorRamp()},O.prototype._updateColorRamp=function(){var Y=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Rf(Y,"heatmapDensity"),this.colorRampTexture=null},O.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},O}(Zo),Np={paint:new Ro({"hillshade-illumination-direction":new fa(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new fa(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new fa(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new fa(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new fa(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new fa(xe.paint_hillshade["hillshade-accent-color"])})},jp=function(M){function O(Y){M.call(this,Y,Np)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},O}(Zo),Ff=oi([{name:"a_pos",components:2,type:"Int16"}],4).members,Vu=Wc,Up=Wc;function Wc(M,O,Y){Y=Y||2;var ae,pe,ye,Ee,Ne,Qe,ct,mt=O&&O.length,Dt=mt?O[0]*Y:M.length,Wt=Bf(M,0,Dt,Y,!0),Vt=[];if(!Wt||Wt.next===Wt.prev)return Vt;if(mt&&(Wt=function(br,Ir,Pr,Vr){var Hr,Xr,un,bn,jn,Bn=[];for(Hr=0,Xr=Ir.length;Hr<Xr;Hr++)un=Ir[Hr]*Vr,bn=Hr<Xr-1?Ir[Hr+1]*Vr:br.length,(jn=Bf(br,un,bn,Vr,!1))===jn.next&&(jn.steiner=!0),Bn.push(Zp(jn));for(Bn.sort(Yp),Hr=0;Hr<Bn.length;Hr++)Wp(Bn[Hr],Pr),Pr=pl(Pr,Pr.next);return Pr}(M,O,Wt,Y)),M.length>80*Y){ae=ye=M[0],pe=Ee=M[1];for(var sr=Y;sr<Dt;sr+=Y)(Ne=M[sr])<ae&&(ae=Ne),(Qe=M[sr+1])<pe&&(pe=Qe),Ne>ye&&(ye=Ne),Qe>Ee&&(Ee=Qe);ct=(ct=Math.max(ye-ae,Ee-pe))!==0?1/ct:0}return bc(Wt,Vt,Y,ae,pe,ct),Vt}function Bf(M,O,Y,ae,pe){var ye,Ee;if(pe===Gu(M,O,Y,ae)>0)for(ye=O;ye<Y;ye+=ae)Ee=Uf(ye,M[ye],M[ye+1],Ee);else for(ye=Y-ae;ye>=O;ye-=ae)Ee=Uf(ye,M[ye],M[ye+1],Ee);return Ee&&Xc(Ee,Ee.next)&&(wc(Ee),Ee=Ee.next),Ee}function pl(M,O){if(!M)return M;O||(O=M);var Y,ae=M;do if(Y=!1,ae.steiner||!Xc(ae,ae.next)&&lo(ae.prev,ae,ae.next)!==0)ae=ae.next;else{if(wc(ae),(ae=O=ae.prev)===ae.next)break;Y=!0}while(Y||ae!==O);return O}function bc(M,O,Y,ae,pe,ye,Ee){if(M){!Ee&&ye&&function(mt,Dt,Wt,Vt){var sr=mt;do sr.z===null&&(sr.z=Hu(sr.x,sr.y,Dt,Wt,Vt)),sr.prevZ=sr.prev,sr.nextZ=sr.next,sr=sr.next;while(sr!==mt);sr.prevZ.nextZ=null,sr.prevZ=null,function(br){var Ir,Pr,Vr,Hr,Xr,un,bn,jn,Bn=1;do{for(Pr=br,br=null,Xr=null,un=0;Pr;){for(un++,Vr=Pr,bn=0,Ir=0;Ir<Bn&&(bn++,Vr=Vr.nextZ);Ir++);for(jn=Bn;bn>0||jn>0&&Vr;)bn!==0&&(jn===0||!Vr||Pr.z<=Vr.z)?(Hr=Pr,Pr=Pr.nextZ,bn--):(Hr=Vr,Vr=Vr.nextZ,jn--),Xr?Xr.nextZ=Hr:br=Hr,Hr.prevZ=Xr,Xr=Hr;Pr=Vr}Xr.nextZ=null,Bn*=2}while(un>1)}(sr)}(M,ae,pe,ye);for(var Ne,Qe,ct=M;M.prev!==M.next;)if(Ne=M.prev,Qe=M.next,ye?Hp(M,ae,pe,ye):Vp(M))O.push(Ne.i/Y),O.push(M.i/Y),O.push(Qe.i/Y),wc(M),M=Qe.next,ct=Qe.next;else if((M=Qe)===ct){Ee?Ee===1?bc(M=qp(pl(M),O,Y),O,Y,ae,pe,ye,2):Ee===2&&Gp(M,O,Y,ae,pe,ye):bc(pl(M),O,Y,ae,pe,ye,1);break}}}function Vp(M){var O=M.prev,Y=M,ae=M.next;if(lo(O,Y,ae)>=0)return!1;for(var pe=M.next.next;pe!==M.prev;){if(ql(O.x,O.y,Y.x,Y.y,ae.x,ae.y,pe.x,pe.y)&&lo(pe.prev,pe,pe.next)>=0)return!1;pe=pe.next}return!0}function Hp(M,O,Y,ae){var pe=M.prev,ye=M,Ee=M.next;if(lo(pe,ye,Ee)>=0)return!1;for(var Ne=pe.x<ye.x?pe.x<Ee.x?pe.x:Ee.x:ye.x<Ee.x?ye.x:Ee.x,Qe=pe.y<ye.y?pe.y<Ee.y?pe.y:Ee.y:ye.y<Ee.y?ye.y:Ee.y,ct=pe.x>ye.x?pe.x>Ee.x?pe.x:Ee.x:ye.x>Ee.x?ye.x:Ee.x,mt=pe.y>ye.y?pe.y>Ee.y?pe.y:Ee.y:ye.y>Ee.y?ye.y:Ee.y,Dt=Hu(Ne,Qe,O,Y,ae),Wt=Hu(ct,mt,O,Y,ae),Vt=M.prevZ,sr=M.nextZ;Vt&&Vt.z>=Dt&&sr&&sr.z<=Wt;){if(Vt!==M.prev&&Vt!==M.next&&ql(pe.x,pe.y,ye.x,ye.y,Ee.x,Ee.y,Vt.x,Vt.y)&&lo(Vt.prev,Vt,Vt.next)>=0||(Vt=Vt.prevZ,sr!==M.prev&&sr!==M.next&&ql(pe.x,pe.y,ye.x,ye.y,Ee.x,Ee.y,sr.x,sr.y)&&lo(sr.prev,sr,sr.next)>=0))return!1;sr=sr.nextZ}for(;Vt&&Vt.z>=Dt;){if(Vt!==M.prev&&Vt!==M.next&&ql(pe.x,pe.y,ye.x,ye.y,Ee.x,Ee.y,Vt.x,Vt.y)&&lo(Vt.prev,Vt,Vt.next)>=0)return!1;Vt=Vt.prevZ}for(;sr&&sr.z<=Wt;){if(sr!==M.prev&&sr!==M.next&&ql(pe.x,pe.y,ye.x,ye.y,Ee.x,Ee.y,sr.x,sr.y)&&lo(sr.prev,sr,sr.next)>=0)return!1;sr=sr.nextZ}return!0}function qp(M,O,Y){var ae=M;do{var pe=ae.prev,ye=ae.next.next;!Xc(pe,ye)&&Nf(pe,ae,ae.next,ye)&&_c(pe,ye)&&_c(ye,pe)&&(O.push(pe.i/Y),O.push(ae.i/Y),O.push(ye.i/Y),wc(ae),wc(ae.next),ae=M=ye),ae=ae.next}while(ae!==M);return pl(ae)}function Gp(M,O,Y,ae,pe,ye){var Ee=M;do{for(var Ne=Ee.next.next;Ne!==Ee.prev;){if(Ee.i!==Ne.i&&Jp(Ee,Ne)){var Qe=jf(Ee,Ne);return Ee=pl(Ee,Ee.next),Qe=pl(Qe,Qe.next),bc(Ee,O,Y,ae,pe,ye),void bc(Qe,O,Y,ae,pe,ye)}Ne=Ne.next}Ee=Ee.next}while(Ee!==M)}function Yp(M,O){return M.x-O.x}function Wp(M,O){if(O=function(ae,pe){var ye,Ee=pe,Ne=ae.x,Qe=ae.y,ct=-1/0;do{if(Qe<=Ee.y&&Qe>=Ee.next.y&&Ee.next.y!==Ee.y){var mt=Ee.x+(Qe-Ee.y)*(Ee.next.x-Ee.x)/(Ee.next.y-Ee.y);if(mt<=Ne&&mt>ct){if(ct=mt,mt===Ne){if(Qe===Ee.y)return Ee;if(Qe===Ee.next.y)return Ee.next}ye=Ee.x<Ee.next.x?Ee:Ee.next}}Ee=Ee.next}while(Ee!==pe);if(!ye)return null;if(Ne===ct)return ye;var Dt,Wt=ye,Vt=ye.x,sr=ye.y,br=1/0;Ee=ye;do Ne>=Ee.x&&Ee.x>=Vt&&Ne!==Ee.x&&ql(Qe<sr?Ne:ct,Qe,Vt,sr,Qe<sr?ct:Ne,Qe,Ee.x,Ee.y)&&(Dt=Math.abs(Qe-Ee.y)/(Ne-Ee.x),_c(Ee,ae)&&(Dt<br||Dt===br&&(Ee.x>ye.x||Ee.x===ye.x&&Xp(ye,Ee)))&&(ye=Ee,br=Dt)),Ee=Ee.next;while(Ee!==Wt);return ye}(M,O)){var Y=jf(O,M);pl(O,O.next),pl(Y,Y.next)}}function Xp(M,O){return lo(M.prev,M,O.prev)<0&&lo(O.next,M,M.next)<0}function Hu(M,O,Y,ae,pe){return(M=1431655765&((M=858993459&((M=252645135&((M=16711935&((M=32767*(M-Y)*pe)|M<<8))|M<<4))|M<<2))|M<<1))|(O=1431655765&((O=858993459&((O=252645135&((O=16711935&((O=32767*(O-ae)*pe)|O<<8))|O<<4))|O<<2))|O<<1))<<1}function Zp(M){var O=M,Y=M;do(O.x<Y.x||O.x===Y.x&&O.y<Y.y)&&(Y=O),O=O.next;while(O!==M);return Y}function ql(M,O,Y,ae,pe,ye,Ee,Ne){return(pe-Ee)*(O-Ne)-(M-Ee)*(ye-Ne)>=0&&(M-Ee)*(ae-Ne)-(Y-Ee)*(O-Ne)>=0&&(Y-Ee)*(ye-Ne)-(pe-Ee)*(ae-Ne)>=0}function Jp(M,O){return M.next.i!==O.i&&M.prev.i!==O.i&&!function(Y,ae){var pe=Y;do{if(pe.i!==Y.i&&pe.next.i!==Y.i&&pe.i!==ae.i&&pe.next.i!==ae.i&&Nf(pe,pe.next,Y,ae))return!0;pe=pe.next}while(pe!==Y);return!1}(M,O)&&(_c(M,O)&&_c(O,M)&&function(Y,ae){var pe=Y,ye=!1,Ee=(Y.x+ae.x)/2,Ne=(Y.y+ae.y)/2;do pe.y>Ne!=pe.next.y>Ne&&pe.next.y!==pe.y&&Ee<(pe.next.x-pe.x)*(Ne-pe.y)/(pe.next.y-pe.y)+pe.x&&(ye=!ye),pe=pe.next;while(pe!==Y);return ye}(M,O)&&(lo(M.prev,M,O.prev)||lo(M,O.prev,O))||Xc(M,O)&&lo(M.prev,M,M.next)>0&&lo(O.prev,O,O.next)>0)}function lo(M,O,Y){return(O.y-M.y)*(Y.x-O.x)-(O.x-M.x)*(Y.y-O.y)}function Xc(M,O){return M.x===O.x&&M.y===O.y}function Nf(M,O,Y,ae){var pe=Jc(lo(M,O,Y)),ye=Jc(lo(M,O,ae)),Ee=Jc(lo(Y,ae,M)),Ne=Jc(lo(Y,ae,O));return pe!==ye&&Ee!==Ne||!(pe!==0||!Zc(M,Y,O))||!(ye!==0||!Zc(M,ae,O))||!(Ee!==0||!Zc(Y,M,ae))||!(Ne!==0||!Zc(Y,O,ae))}function Zc(M,O,Y){return O.x<=Math.max(M.x,Y.x)&&O.x>=Math.min(M.x,Y.x)&&O.y<=Math.max(M.y,Y.y)&&O.y>=Math.min(M.y,Y.y)}function Jc(M){return M>0?1:M<0?-1:0}function _c(M,O){return lo(M.prev,M,M.next)<0?lo(M,O,M.next)>=0&&lo(M,M.prev,O)>=0:lo(M,O,M.prev)<0||lo(M,M.next,O)<0}function jf(M,O){var Y=new qu(M.i,M.x,M.y),ae=new qu(O.i,O.x,O.y),pe=M.next,ye=O.prev;return M.next=O,O.prev=M,Y.next=pe,pe.prev=Y,ae.next=Y,Y.prev=ae,ye.next=ae,ae.prev=ye,ae}function Uf(M,O,Y,ae){var pe=new qu(M,O,Y);return ae?(pe.next=ae.next,pe.prev=ae,ae.next.prev=pe,ae.next=pe):(pe.prev=pe,pe.next=pe),pe}function wc(M){M.next.prev=M.prev,M.prev.next=M.next,M.prevZ&&(M.prevZ.nextZ=M.nextZ),M.nextZ&&(M.nextZ.prevZ=M.prevZ)}function qu(M,O,Y){this.i=M,this.x=O,this.y=Y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gu(M,O,Y,ae){for(var pe=0,ye=O,Ee=Y-ae;ye<Y;ye+=ae)pe+=(M[Ee]-M[ye])*(M[ye+1]+M[Ee+1]),Ee=ye;return pe}function Kp(M,O,Y,ae,pe){(function ye(Ee,Ne,Qe,ct,mt){for(;ct>Qe;){if(ct-Qe>600){var Dt=ct-Qe+1,Wt=Ne-Qe+1,Vt=Math.log(Dt),sr=.5*Math.exp(2*Vt/3),br=.5*Math.sqrt(Vt*sr*(Dt-sr)/Dt)*(Wt-Dt/2<0?-1:1),Ir=Math.max(Qe,Math.floor(Ne-Wt*sr/Dt+br)),Pr=Math.min(ct,Math.floor(Ne+(Dt-Wt)*sr/Dt+br));ye(Ee,Ne,Ir,Pr,mt)}var Vr=Ee[Ne],Hr=Qe,Xr=ct;for(Tc(Ee,Qe,Ne),mt(Ee[ct],Vr)>0&&Tc(Ee,Qe,ct);Hr<Xr;){for(Tc(Ee,Hr,Xr),Hr++,Xr--;mt(Ee[Hr],Vr)<0;)Hr++;for(;mt(Ee[Xr],Vr)>0;)Xr--}mt(Ee[Qe],Vr)===0?Tc(Ee,Qe,Xr):(Xr++,Tc(Ee,Xr,ct)),Xr<=Ne&&(Qe=Xr+1),Ne<=Xr&&(ct=Xr-1)}})(M,O,Y||0,ae||M.length-1,pe||Qp)}function Tc(M,O,Y){var ae=M[O];M[O]=M[Y],M[Y]=ae}function Qp(M,O){return M<O?-1:M>O?1:0}function Yu(M,O){var Y=M.length;if(Y<=1)return[M];for(var ae,pe,ye=[],Ee=0;Ee<Y;Ee++){var Ne=P(M[Ee]);Ne!==0&&(M[Ee].area=Math.abs(Ne),pe===void 0&&(pe=Ne<0),pe===Ne<0?(ae&&ye.push(ae),ae=[M[Ee]]):ae.push(M[Ee]))}if(ae&&ye.push(ae),O>1)for(var Qe=0;Qe<ye.length;Qe++)ye[Qe].length<=O||(Kp(ye[Qe],O,1,ye[Qe].length-1,$p),ye[Qe]=ye[Qe].slice(0,O));return ye}function $p(M,O){return O.area-M.area}function Wu(M,O,Y){for(var ae=Y.patternDependencies,pe=!1,ye=0,Ee=O;ye<Ee.length;ye+=1){var Ne=Ee[ye].paint.get(M+"-pattern");Ne.isConstant()||(pe=!0);var Qe=Ne.constantOr(null);Qe&&(pe=!0,ae[Qe.to]=!0,ae[Qe.from]=!0)}return pe}function Xu(M,O,Y,ae,pe){for(var ye=pe.patternDependencies,Ee=0,Ne=O;Ee<Ne.length;Ee+=1){var Qe=Ne[Ee],ct=Qe.paint.get(M+"-pattern").value;if(ct.kind!=="constant"){var mt=ct.evaluate({zoom:ae-1},Y,{},pe.availableImages),Dt=ct.evaluate({zoom:ae},Y,{},pe.availableImages),Wt=ct.evaluate({zoom:ae+1},Y,{},pe.availableImages);mt=mt&&mt.name?mt.name:mt,Dt=Dt&&Dt.name?Dt.name:Dt,Wt=Wt&&Wt.name?Wt.name:Wt,ye[mt]=!0,ye[Dt]=!0,ye[Wt]=!0,Y.patterns[Qe.id]={min:mt,mid:Dt,max:Wt}}}return Y}Wc.deviation=function(M,O,Y,ae){var pe=O&&O.length,ye=pe?O[0]*Y:M.length,Ee=Math.abs(Gu(M,0,ye,Y));if(pe)for(var Ne=0,Qe=O.length;Ne<Qe;Ne++){var ct=O[Ne]*Y,mt=Ne<Qe-1?O[Ne+1]*Y:M.length;Ee-=Math.abs(Gu(M,ct,mt,Y))}var Dt=0;for(Ne=0;Ne<ae.length;Ne+=3){var Wt=ae[Ne]*Y,Vt=ae[Ne+1]*Y,sr=ae[Ne+2]*Y;Dt+=Math.abs((M[Wt]-M[sr])*(M[Vt+1]-M[Wt+1])-(M[Wt]-M[Vt])*(M[sr+1]-M[Wt+1]))}return Ee===0&&Dt===0?0:Math.abs((Dt-Ee)/Ee)},Wc.flatten=function(M){for(var O=M[0][0].length,Y={vertices:[],holes:[],dimensions:O},ae=0,pe=0;pe<M.length;pe++){for(var ye=0;ye<M[pe].length;ye++)for(var Ee=0;Ee<O;Ee++)Y.vertices.push(M[pe][ye][Ee]);pe>0&&(ae+=M[pe-1].length,Y.holes.push(ae))}return Y},Vu.default=Up;var Rs=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new hs,this.indexArray=new so,this.indexArray2=new F,this.programConfigurations=new di(Ff,M.layers,M.zoom),this.segments=new zt,this.segments2=new zt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};Rs.prototype.populate=function(M,O,Y){this.hasPattern=Wu("fill",this.layers,O);for(var ae=this.layers[0].layout.get("fill-sort-key"),pe=[],ye=0,Ee=M;ye<Ee.length;ye+=1){var Ne=Ee[ye],Qe=Ne.feature,ct=Ne.id,mt=Ne.index,Dt=Ne.sourceLayerIndex,Wt=this.layers[0]._featureFilter.needGeometry,Vt={type:Qe.type,id:ct,properties:Qe.properties,geometry:Wt?bi(Qe):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Vt,Y)){Wt||(Vt.geometry=bi(Qe));var sr=ae?ae.evaluate(Vt,{},Y,O.availableImages):void 0,br={id:ct,properties:Qe.properties,type:Qe.type,sourceLayerIndex:Dt,index:mt,geometry:Vt.geometry,patterns:{},sortKey:sr};pe.push(br)}}ae&&pe.sort(function(Wn,sa){return Wn.sortKey-sa.sortKey});for(var Ir=0,Pr=pe;Ir<Pr.length;Ir+=1){var Vr=Pr[Ir],Hr=Vr,Xr=Hr.geometry,un=Hr.index,bn=Hr.sourceLayerIndex;if(this.hasPattern){var jn=Xu("fill",this.layers,Vr,this.zoom,O);this.patternFeatures.push(jn)}else this.addFeature(Vr,Xr,un,Y,{});var Bn=M[un].feature;O.featureIndex.insert(Bn,Xr,un,bn,this.index)}},Rs.prototype.update=function(M,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,Y)},Rs.prototype.addFeatures=function(M,O,Y){for(var ae=0,pe=this.patternFeatures;ae<pe.length;ae+=1){var ye=pe[ae];this.addFeature(ye,ye.geometry,ye.index,O,Y)}},Rs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Rs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Rs.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,Ff),this.indexBuffer=M.createIndexBuffer(this.indexArray),this.indexBuffer2=M.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(M),this.uploaded=!0},Rs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Rs.prototype.addFeature=function(M,O,Y,ae,pe){for(var ye=0,Ee=Yu(O,500);ye<Ee.length;ye+=1){for(var Ne=Ee[ye],Qe=0,ct=0,mt=Ne;ct<mt.length;ct+=1)Qe+=mt[ct].length;for(var Dt=this.segments.prepareSegment(Qe,this.layoutVertexArray,this.indexArray),Wt=Dt.vertexLength,Vt=[],sr=[],br=0,Ir=Ne;br<Ir.length;br+=1){var Pr=Ir[br];if(Pr.length!==0){Pr!==Ne[0]&&sr.push(Vt.length/2);var Vr=this.segments2.prepareSegment(Pr.length,this.layoutVertexArray,this.indexArray2),Hr=Vr.vertexLength;this.layoutVertexArray.emplaceBack(Pr[0].x,Pr[0].y),this.indexArray2.emplaceBack(Hr+Pr.length-1,Hr),Vt.push(Pr[0].x),Vt.push(Pr[0].y);for(var Xr=1;Xr<Pr.length;Xr++)this.layoutVertexArray.emplaceBack(Pr[Xr].x,Pr[Xr].y),this.indexArray2.emplaceBack(Hr+Xr-1,Hr+Xr),Vt.push(Pr[Xr].x),Vt.push(Pr[Xr].y);Vr.vertexLength+=Pr.length,Vr.primitiveLength+=Pr.length}}for(var un=Vu(Vt,sr),bn=0;bn<un.length;bn+=3)this.indexArray.emplaceBack(Wt+un[bn],Wt+un[bn+1],Wt+un[bn+2]);Dt.vertexLength+=Qe,Dt.primitiveLength+=un.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,Y,pe,ae)},Kr("FillBucket",Rs,{omit:["layers","patternFeatures"]});var ed=new Ro({"fill-sort-key":new ba(xe.layout_fill["fill-sort-key"])}),td={paint:new Ro({"fill-antialias":new fa(xe.paint_fill["fill-antialias"]),"fill-opacity":new ba(xe.paint_fill["fill-opacity"]),"fill-color":new ba(xe.paint_fill["fill-color"]),"fill-outline-color":new ba(xe.paint_fill["fill-outline-color"]),"fill-translate":new fa(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new fa(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ys(xe.paint_fill["fill-pattern"])}),layout:ed},rd=function(M){function O(Y){M.call(this,Y,td)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.recalculate=function(Y,ae){M.prototype.recalculate.call(this,Y,ae);var pe=this.paint._values["fill-outline-color"];pe.value.kind==="constant"&&pe.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},O.prototype.createBucket=function(Y){return new Rs(Y)},O.prototype.queryRadius=function(){return Fo(this.paint.get("fill-translate"))},O.prototype.queryIntersectsFeature=function(Y,ae,pe,ye,Ee,Ne,Qe){return Xs(Bo(Y,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Ne.angle,Qe),ye)},O.prototype.isTileClipped=function(){return!0},O}(Zo),Vf=oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Hf=Gl;function Gl(M,O,Y,ae,pe){this.properties={},this.extent=Y,this.type=0,this._pbf=M,this._geometry=-1,this._keys=ae,this._values=pe,M.readFields(nd,this,O)}function nd(M,O,Y){M==1?O.id=Y.readVarint():M==2?function(ae,pe){for(var ye=ae.readVarint()+ae.pos;ae.pos<ye;){var Ee=pe._keys[ae.readVarint()],Ne=pe._values[ae.readVarint()];pe.properties[Ee]=Ne}}(Y,O):M==3?O.type=Y.readVarint():M==4&&(O._geometry=Y.pos)}function ad(M){for(var O,Y,ae=0,pe=0,ye=M.length,Ee=ye-1;pe<ye;Ee=pe++)O=M[pe],ae+=((Y=M[Ee]).x-O.x)*(O.y+Y.y);return ae}Gl.types=["Unknown","Point","LineString","Polygon"],Gl.prototype.loadGeometry=function(){var M=this._pbf;M.pos=this._geometry;for(var O,Y=M.readVarint()+M.pos,ae=1,pe=0,ye=0,Ee=0,Ne=[];M.pos<Y;){if(pe<=0){var Qe=M.readVarint();ae=7&Qe,pe=Qe>>3}if(pe--,ae===1||ae===2)ye+=M.readSVarint(),Ee+=M.readSVarint(),ae===1&&(O&&Ne.push(O),O=[]),O.push(new r(ye,Ee));else{if(ae!==7)throw new Error("unknown command "+ae);O&&O.push(O[0].clone())}}return O&&Ne.push(O),Ne},Gl.prototype.bbox=function(){var M=this._pbf;M.pos=this._geometry;for(var O=M.readVarint()+M.pos,Y=1,ae=0,pe=0,ye=0,Ee=1/0,Ne=-1/0,Qe=1/0,ct=-1/0;M.pos<O;){if(ae<=0){var mt=M.readVarint();Y=7&mt,ae=mt>>3}if(ae--,Y===1||Y===2)(pe+=M.readSVarint())<Ee&&(Ee=pe),pe>Ne&&(Ne=pe),(ye+=M.readSVarint())<Qe&&(Qe=ye),ye>ct&&(ct=ye);else if(Y!==7)throw new Error("unknown command "+Y)}return[Ee,Qe,Ne,ct]},Gl.prototype.toGeoJSON=function(M,O,Y){var ae,pe,ye=this.extent*Math.pow(2,Y),Ee=this.extent*M,Ne=this.extent*O,Qe=this.loadGeometry(),ct=Gl.types[this.type];function mt(Vt){for(var sr=0;sr<Vt.length;sr++){var br=Vt[sr],Ir=180-360*(br.y+Ne)/ye;Vt[sr]=[360*(br.x+Ee)/ye-180,360/Math.PI*Math.atan(Math.exp(Ir*Math.PI/180))-90]}}switch(this.type){case 1:var Dt=[];for(ae=0;ae<Qe.length;ae++)Dt[ae]=Qe[ae][0];mt(Qe=Dt);break;case 2:for(ae=0;ae<Qe.length;ae++)mt(Qe[ae]);break;case 3:for(Qe=function(Vt){var sr=Vt.length;if(sr<=1)return[Vt];for(var br,Ir,Pr=[],Vr=0;Vr<sr;Vr++){var Hr=ad(Vt[Vr]);Hr!==0&&(Ir===void 0&&(Ir=Hr<0),Ir===Hr<0?(br&&Pr.push(br),br=[Vt[Vr]]):br.push(Vt[Vr]))}return br&&Pr.push(br),Pr}(Qe),ae=0;ae<Qe.length;ae++)for(pe=0;pe<Qe[ae].length;pe++)mt(Qe[ae][pe])}Qe.length===1?Qe=Qe[0]:ct="Multi"+ct;var Wt={type:"Feature",geometry:{type:ct,coordinates:Qe},properties:this.properties};return"id"in this&&(Wt.id=this.id),Wt};var qf=Gf;function Gf(M,O){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=M,this._keys=[],this._values=[],this._features=[],M.readFields(id,this,O),this.length=this._features.length}function id(M,O,Y){M===15?O.version=Y.readVarint():M===1?O.name=Y.readString():M===5?O.extent=Y.readVarint():M===2?O._features.push(Y.pos):M===3?O._keys.push(Y.readString()):M===4&&O._values.push(function(ae){for(var pe=null,ye=ae.readVarint()+ae.pos;ae.pos<ye;){var Ee=ae.readVarint()>>3;pe=Ee===1?ae.readString():Ee===2?ae.readFloat():Ee===3?ae.readDouble():Ee===4?ae.readVarint64():Ee===5?ae.readVarint():Ee===6?ae.readSVarint():Ee===7?ae.readBoolean():null}return pe}(Y))}function od(M,O,Y){if(M===3){var ae=new qf(Y,Y.readVarint()+Y.pos);ae.length&&(O[ae.name]=ae)}}Gf.prototype.feature=function(M){if(M<0||M>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[M];var O=this._pbf.readVarint()+this._pbf.pos;return new Hf(this._pbf,O,this.extent,this._keys,this._values)};var Yl={VectorTile:function(M,O){this.layers=M.readFields(od,{},O)},VectorTileFeature:Hf,VectorTileLayer:qf},sd=Yl.VectorTileFeature.types,Zu=Math.pow(2,13);function kc(M,O,Y,ae,pe,ye,Ee,Ne){M.emplaceBack(O,Y,2*Math.floor(ae*Zu)+Ee,pe*Zu*2,ye*Zu*2,Math.round(Ne))}var Fs=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.layoutVertexArray=new _s,this.indexArray=new so,this.programConfigurations=new di(Vf,M.layers,M.zoom),this.segments=new zt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function ld(M,O){return M.x===O.x&&(M.x<0||M.x>8192)||M.y===O.y&&(M.y<0||M.y>8192)}function cd(M){return M.every(function(O){return O.x<0})||M.every(function(O){return O.x>8192})||M.every(function(O){return O.y<0})||M.every(function(O){return O.y>8192})}Fs.prototype.populate=function(M,O,Y){this.features=[],this.hasPattern=Wu("fill-extrusion",this.layers,O);for(var ae=0,pe=M;ae<pe.length;ae+=1){var ye=pe[ae],Ee=ye.feature,Ne=ye.id,Qe=ye.index,ct=ye.sourceLayerIndex,mt=this.layers[0]._featureFilter.needGeometry,Dt={type:Ee.type,id:Ne,properties:Ee.properties,geometry:mt?bi(Ee):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Dt,Y)){var Wt={id:Ne,sourceLayerIndex:ct,index:Qe,geometry:mt?Dt.geometry:bi(Ee),properties:Ee.properties,type:Ee.type,patterns:{}};Ee.id!==void 0&&(Wt.id=Ee.id),this.hasPattern?this.features.push(Xu("fill-extrusion",this.layers,Wt,this.zoom,O)):this.addFeature(Wt,Wt.geometry,Qe,Y,{}),O.featureIndex.insert(Ee,Wt.geometry,Qe,ct,this.index,!0)}}},Fs.prototype.addFeatures=function(M,O,Y){for(var ae=0,pe=this.features;ae<pe.length;ae+=1){var ye=pe[ae],Ee=ye.geometry;this.addFeature(ye,Ee,ye.index,O,Y)}},Fs.prototype.update=function(M,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,Y)},Fs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Fs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Fs.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,Vf),this.indexBuffer=M.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(M),this.uploaded=!0},Fs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Fs.prototype.addFeature=function(M,O,Y,ae,pe){for(var ye=0,Ee=Yu(O,500);ye<Ee.length;ye+=1){for(var Ne=Ee[ye],Qe=0,ct=0,mt=Ne;ct<mt.length;ct+=1)Qe+=mt[ct].length;for(var Dt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Wt=0,Vt=Ne;Wt<Vt.length;Wt+=1){var sr=Vt[Wt];if(sr.length!==0&&!cd(sr))for(var br=0,Ir=0;Ir<sr.length;Ir++){var Pr=sr[Ir];if(Ir>=1){var Vr=sr[Ir-1];if(!ld(Pr,Vr)){Dt.vertexLength+4>zt.MAX_VERTEX_ARRAY_LENGTH&&(Dt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Hr=Pr.sub(Vr)._perp()._unit(),Xr=Vr.dist(Pr);br+Xr>32768&&(br=0),kc(this.layoutVertexArray,Pr.x,Pr.y,Hr.x,Hr.y,0,0,br),kc(this.layoutVertexArray,Pr.x,Pr.y,Hr.x,Hr.y,0,1,br),br+=Xr,kc(this.layoutVertexArray,Vr.x,Vr.y,Hr.x,Hr.y,0,0,br),kc(this.layoutVertexArray,Vr.x,Vr.y,Hr.x,Hr.y,0,1,br);var un=Dt.vertexLength;this.indexArray.emplaceBack(un,un+2,un+1),this.indexArray.emplaceBack(un+1,un+2,un+3),Dt.vertexLength+=4,Dt.primitiveLength+=2}}}}if(Dt.vertexLength+Qe>zt.MAX_VERTEX_ARRAY_LENGTH&&(Dt=this.segments.prepareSegment(Qe,this.layoutVertexArray,this.indexArray)),sd[M.type]==="Polygon"){for(var bn=[],jn=[],Bn=Dt.vertexLength,Wn=0,sa=Ne;Wn<sa.length;Wn+=1){var la=sa[Wn];if(la.length!==0){la!==Ne[0]&&jn.push(bn.length/2);for(var $n=0;$n<la.length;$n++){var ma=la[$n];kc(this.layoutVertexArray,ma.x,ma.y,0,0,1,1,0),bn.push(ma.x),bn.push(ma.y)}}}for(var pa=Vu(bn,jn),ca=0;ca<pa.length;ca+=3)this.indexArray.emplaceBack(Bn+pa[ca],Bn+pa[ca+2],Bn+pa[ca+1]);Dt.primitiveLength+=pa.length/3,Dt.vertexLength+=Qe}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,Y,pe,ae)},Kr("FillExtrusionBucket",Fs,{omit:["layers","features"]});var ud={paint:new Ro({"fill-extrusion-opacity":new fa(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ba(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new fa(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new fa(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ys(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ba(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ba(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new fa(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},fd=function(M){function O(Y){M.call(this,Y,ud)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(Y){return new Fs(Y)},O.prototype.queryRadius=function(){return Fo(this.paint.get("fill-extrusion-translate"))},O.prototype.is3D=function(){return!0},O.prototype.queryIntersectsFeature=function(Y,ae,pe,ye,Ee,Ne,Qe,ct){var mt=Bo(Y,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Ne.angle,Qe),Dt=this.paint.get("fill-extrusion-height").evaluate(ae,pe),Wt=this.paint.get("fill-extrusion-base").evaluate(ae,pe),Vt=function(br,Ir,Pr,Vr){for(var Hr=[],Xr=0,un=br;Xr<un.length;Xr+=1){var bn=un[Xr],jn=[bn.x,bn.y,Vr,1];Hl(jn,jn,Ir),Hr.push(new r(jn[0]/jn[3],jn[1]/jn[3]))}return Hr}(mt,ct,0,0),sr=function(br,Ir,Pr,Vr){for(var Hr=[],Xr=[],un=Vr[8]*Ir,bn=Vr[9]*Ir,jn=Vr[10]*Ir,Bn=Vr[11]*Ir,Wn=Vr[8]*Pr,sa=Vr[9]*Pr,la=Vr[10]*Pr,$n=Vr[11]*Pr,ma=0,pa=br;ma<pa.length;ma+=1){for(var ca=pa[ma],ei=[],qa=[],ni=0,Ta=ca;ni<Ta.length;ni+=1){var Wa=Ta[ni],wi=Wa.x,mi=Wa.y,Pi=Vr[0]*wi+Vr[4]*mi+Vr[12],gi=Vr[1]*wi+Vr[5]*mi+Vr[13],fo=Vr[2]*wi+Vr[6]*mi+Vr[14],Ii=Vr[3]*wi+Vr[7]*mi+Vr[15],No=fo+jn,Eo=Ii+Bn,Po=Pi+Wn,Jo=gi+sa,Ho=fo+la,ho=Ii+$n,Io=new r((Pi+un)/Eo,(gi+bn)/Eo);Io.z=No/Eo,ei.push(Io);var Qi=new r(Po/ho,Jo/ho);Qi.z=Ho/ho,qa.push(Qi)}Hr.push(ei),Xr.push(qa)}return[Hr,Xr]}(ye,Wt,Dt,ct);return function(br,Ir,Pr){var Vr=1/0;Xs(Pr,Ir)&&(Vr=Yf(Pr,Ir[0]));for(var Hr=0;Hr<Ir.length;Hr++)for(var Xr=Ir[Hr],un=br[Hr],bn=0;bn<Xr.length-1;bn++){var jn=Xr[bn],Bn=Xr[bn+1],Wn=un[bn],sa=un[bn+1],la=[jn,Bn,sa,Wn,jn];Uo(Pr,la)&&(Vr=Math.min(Vr,Yf(Pr,la)))}return Vr!==1/0&&Vr}(sr[0],sr[1],Vt)},O}(Zo);function Mc(M,O){return M.x*O.x+M.y*O.y}function Yf(M,O){if(M.length===1){for(var Y,ae=0,pe=O[ae++];!Y||pe.equals(Y);)if(!(Y=O[ae++]))return 1/0;for(;ae<O.length;ae++){var ye=O[ae],Ee=M[0],Ne=Y.sub(pe),Qe=ye.sub(pe),ct=Ee.sub(pe),mt=Mc(Ne,Ne),Dt=Mc(Ne,Qe),Wt=Mc(Qe,Qe),Vt=Mc(ct,Ne),sr=Mc(ct,Qe),br=mt*Wt-Dt*Dt,Ir=(Wt*Vt-Dt*sr)/br,Pr=(mt*sr-Dt*Vt)/br,Vr=1-Ir-Pr,Hr=pe.z*Vr+Y.z*Ir+ye.z*Pr;if(isFinite(Hr))return Hr}return 1/0}for(var Xr=1/0,un=0,bn=O;un<bn.length;un+=1){var jn=bn[un];Xr=Math.min(Xr,jn.z)}return Xr}var Wf=oi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,hd=Yl.VectorTileFeature.types,pd=Math.cos(Math.PI/180*37.5),Xf=Math.pow(2,14)/.5,ts=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Os,this.indexArray=new so,this.programConfigurations=new di(Wf,M.layers,M.zoom),this.segments=new zt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};ts.prototype.populate=function(M,O,Y){this.hasPattern=Wu("line",this.layers,O);for(var ae=this.layers[0].layout.get("line-sort-key"),pe=[],ye=0,Ee=M;ye<Ee.length;ye+=1){var Ne=Ee[ye],Qe=Ne.feature,ct=Ne.id,mt=Ne.index,Dt=Ne.sourceLayerIndex,Wt=this.layers[0]._featureFilter.needGeometry,Vt={type:Qe.type,id:ct,properties:Qe.properties,geometry:Wt?bi(Qe):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Vt,Y)){Wt||(Vt.geometry=bi(Qe));var sr=ae?ae.evaluate(Vt,{},Y):void 0,br={id:ct,properties:Qe.properties,type:Qe.type,sourceLayerIndex:Dt,index:mt,geometry:Vt.geometry,patterns:{},sortKey:sr};pe.push(br)}}ae&&pe.sort(function(Wn,sa){return Wn.sortKey-sa.sortKey});for(var Ir=0,Pr=pe;Ir<Pr.length;Ir+=1){var Vr=Pr[Ir],Hr=Vr,Xr=Hr.geometry,un=Hr.index,bn=Hr.sourceLayerIndex;if(this.hasPattern){var jn=Xu("line",this.layers,Vr,this.zoom,O);this.patternFeatures.push(jn)}else this.addFeature(Vr,Xr,un,Y,{});var Bn=M[un].feature;O.featureIndex.insert(Bn,Xr,un,bn,this.index)}},ts.prototype.update=function(M,O,Y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,Y)},ts.prototype.addFeatures=function(M,O,Y){for(var ae=0,pe=this.patternFeatures;ae<pe.length;ae+=1){var ye=pe[ae];this.addFeature(ye,ye.geometry,ye.index,O,Y)}},ts.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ts.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ts.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,Wf),this.indexBuffer=M.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(M),this.uploaded=!0},ts.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ts.prototype.addFeature=function(M,O,Y,ae,pe){for(var ye=this.layers[0].layout,Ee=ye.get("line-join").evaluate(M,{}),Ne=ye.get("line-cap"),Qe=ye.get("line-miter-limit"),ct=ye.get("line-round-limit"),mt=0,Dt=O;mt<Dt.length;mt+=1){var Wt=Dt[mt];this.addLine(Wt,M,Ee,Ne,Qe,ct)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,Y,pe,ae)},ts.prototype.addLine=function(M,O,Y,ae,pe,ye){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,O.properties&&O.properties.hasOwnProperty("mapbox_clip_start")&&O.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+O.properties.mapbox_clip_start,this.clipEnd=+O.properties.mapbox_clip_end;for(var Ee=0;Ee<M.length-1;Ee++)this.totalDistance+=M[Ee].dist(M[Ee+1]);this.updateScaledDistance()}for(var Ne=hd[O.type]==="Polygon",Qe=M.length;Qe>=2&&M[Qe-1].equals(M[Qe-2]);)Qe--;for(var ct=0;ct<Qe-1&&M[ct].equals(M[ct+1]);)ct++;if(!(Qe<(Ne?3:2))){Y==="bevel"&&(pe=1.05);var mt,Dt=this.overscaling<=16?122880/(512*this.overscaling):0,Wt=this.segments.prepareSegment(10*Qe,this.layoutVertexArray,this.indexArray),Vt=void 0,sr=void 0,br=void 0,Ir=void 0;this.e1=this.e2=-1,Ne&&(mt=M[Qe-2],Ir=M[ct].sub(mt)._unit()._perp());for(var Pr=ct;Pr<Qe;Pr++)if(!(sr=Pr===Qe-1?Ne?M[ct+1]:void 0:M[Pr+1])||!M[Pr].equals(sr)){Ir&&(br=Ir),mt&&(Vt=mt),mt=M[Pr],Ir=sr?sr.sub(mt)._unit()._perp():br;var Vr=(br=br||Ir).add(Ir);Vr.x===0&&Vr.y===0||Vr._unit();var Hr=br.x*Ir.x+br.y*Ir.y,Xr=Vr.x*Ir.x+Vr.y*Ir.y,un=Xr!==0?1/Xr:1/0,bn=2*Math.sqrt(2-2*Xr),jn=Xr<pd&&Vt&&sr,Bn=br.x*Ir.y-br.y*Ir.x>0;if(jn&&Pr>ct){var Wn=mt.dist(Vt);if(Wn>2*Dt){var sa=mt.sub(mt.sub(Vt)._mult(Dt/Wn)._round());this.updateDistance(Vt,sa),this.addCurrentVertex(sa,br,0,0,Wt),Vt=sa}}var la=Vt&&sr,$n=la?Y:Ne?"butt":ae;if(la&&$n==="round"&&(un<ye?$n="miter":un<=2&&($n="fakeround")),$n==="miter"&&un>pe&&($n="bevel"),$n==="bevel"&&(un>2&&($n="flipbevel"),un<pe&&($n="miter")),Vt&&this.updateDistance(Vt,mt),$n==="miter")Vr._mult(un),this.addCurrentVertex(mt,Vr,0,0,Wt);else if($n==="flipbevel"){if(un>100)Vr=Ir.mult(-1);else{var ma=un*br.add(Ir).mag()/br.sub(Ir).mag();Vr._perp()._mult(ma*(Bn?-1:1))}this.addCurrentVertex(mt,Vr,0,0,Wt),this.addCurrentVertex(mt,Vr.mult(-1),0,0,Wt)}else if($n==="bevel"||$n==="fakeround"){var pa=-Math.sqrt(un*un-1),ca=Bn?pa:0,ei=Bn?0:pa;if(Vt&&this.addCurrentVertex(mt,br,ca,ei,Wt),$n==="fakeround")for(var qa=Math.round(180*bn/Math.PI/20),ni=1;ni<qa;ni++){var Ta=ni/qa;if(Ta!==.5){var Wa=Ta-.5;Ta+=Ta*Wa*(Ta-1)*((1.0904+Hr*(Hr*(3.55645-1.43519*Hr)-3.2452))*Wa*Wa+(.848013+Hr*(.215638*Hr-1.06021)))}var wi=Ir.sub(br)._mult(Ta)._add(br)._unit()._mult(Bn?-1:1);this.addHalfVertex(mt,wi.x,wi.y,!1,Bn,0,Wt)}sr&&this.addCurrentVertex(mt,Ir,-ca,-ei,Wt)}else if($n==="butt")this.addCurrentVertex(mt,Vr,0,0,Wt);else if($n==="square"){var mi=Vt?1:-1;this.addCurrentVertex(mt,Vr,mi,mi,Wt)}else $n==="round"&&(Vt&&(this.addCurrentVertex(mt,br,0,0,Wt),this.addCurrentVertex(mt,br,1,1,Wt,!0)),sr&&(this.addCurrentVertex(mt,Ir,-1,-1,Wt,!0),this.addCurrentVertex(mt,Ir,0,0,Wt)));if(jn&&Pr<Qe-1){var Pi=mt.dist(sr);if(Pi>2*Dt){var gi=mt.add(sr.sub(mt)._mult(Dt/Pi)._round());this.updateDistance(mt,gi),this.addCurrentVertex(gi,Ir,0,0,Wt),mt=gi}}}}},ts.prototype.addCurrentVertex=function(M,O,Y,ae,pe,ye){ye===void 0&&(ye=!1);var Ee=O.x+O.y*Y,Ne=O.y-O.x*Y,Qe=-O.x+O.y*ae,ct=-O.y-O.x*ae;this.addHalfVertex(M,Ee,Ne,ye,!1,Y,pe),this.addHalfVertex(M,Qe,ct,ye,!0,-ae,pe),this.distance>Xf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(M,O,Y,ae,pe,ye))},ts.prototype.addHalfVertex=function(M,O,Y,ae,pe,ye,Ee){var Ne=M.x,Qe=M.y,ct=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((Ne<<1)+(ae?1:0),(Qe<<1)+(pe?1:0),Math.round(63*O)+128,Math.round(63*Y)+128,1+(ye===0?0:ye<0?-1:1)|(63&ct)<<2,ct>>6);var mt=Ee.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,mt),Ee.primitiveLength++),pe?this.e2=mt:this.e1=mt},ts.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Xf-1):this.distance},ts.prototype.updateDistance=function(M,O){this.distance+=M.dist(O),this.updateScaledDistance()},Kr("LineBucket",ts,{omit:["layers","patternFeatures"]});var dd=new Ro({"line-cap":new fa(xe.layout_line["line-cap"]),"line-join":new ba(xe.layout_line["line-join"]),"line-miter-limit":new fa(xe.layout_line["line-miter-limit"]),"line-round-limit":new fa(xe.layout_line["line-round-limit"]),"line-sort-key":new ba(xe.layout_line["line-sort-key"])}),Zf={paint:new Ro({"line-opacity":new ba(xe.paint_line["line-opacity"]),"line-color":new ba(xe.paint_line["line-color"]),"line-translate":new fa(xe.paint_line["line-translate"]),"line-translate-anchor":new fa(xe.paint_line["line-translate-anchor"]),"line-width":new ba(xe.paint_line["line-width"]),"line-gap-width":new ba(xe.paint_line["line-gap-width"]),"line-offset":new ba(xe.paint_line["line-offset"]),"line-blur":new ba(xe.paint_line["line-blur"]),"line-dasharray":new Ws(xe.paint_line["line-dasharray"]),"line-pattern":new Ys(xe.paint_line["line-pattern"]),"line-gradient":new os(xe.paint_line["line-gradient"])}),layout:dd},Jf=new(function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.possiblyEvaluate=function(Y,ae){return ae=new ii(Math.floor(ae.zoom),{now:ae.now,fadeDuration:ae.fadeDuration,zoomHistory:ae.zoomHistory,transition:ae.transition}),M.prototype.possiblyEvaluate.call(this,Y,ae)},O.prototype.evaluate=function(Y,ae,pe,ye){return ae=l({},ae,{zoom:Math.floor(ae.zoom)}),M.prototype.evaluate.call(this,Y,ae,pe,ye)},O}(ba))(Zf.paint.properties["line-width"].specification);Jf.useIntegerZoom=!0;var md=function(M){function O(Y){M.call(this,Y,Zf)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._handleSpecialPaintPropertyUpdate=function(Y){Y==="line-gradient"&&this._updateGradient()},O.prototype._updateGradient=function(){var Y=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Rf(Y,"lineProgress"),this.gradientTexture=null},O.prototype.recalculate=function(Y,ae){M.prototype.recalculate.call(this,Y,ae),this.paint._values["line-floorwidth"]=Jf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,Y)},O.prototype.createBucket=function(Y){return new ts(Y)},O.prototype.queryRadius=function(Y){var ae=Y,pe=Kf(Li("line-width",this,ae),Li("line-gap-width",this,ae)),ye=Li("line-offset",this,ae);return pe/2+Math.abs(ye)+Fo(this.paint.get("line-translate"))},O.prototype.queryIntersectsFeature=function(Y,ae,pe,ye,Ee,Ne,Qe){var ct=Bo(Y,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Ne.angle,Qe),mt=Qe/2*Kf(this.paint.get("line-width").evaluate(ae,pe),this.paint.get("line-gap-width").evaluate(ae,pe)),Dt=this.paint.get("line-offset").evaluate(ae,pe);return Dt&&(ye=function(Wt,Vt){for(var sr=[],br=new r(0,0),Ir=0;Ir<Wt.length;Ir++){for(var Pr=Wt[Ir],Vr=[],Hr=0;Hr<Pr.length;Hr++){var Xr=Pr[Hr-1],un=Pr[Hr],bn=Pr[Hr+1],jn=Hr===0?br:un.sub(Xr)._unit()._perp(),Bn=Hr===Pr.length-1?br:bn.sub(un)._unit()._perp(),Wn=jn._add(Bn)._unit(),sa=Wn.x*Bn.x+Wn.y*Bn.y;Wn._mult(1/sa),Vr.push(Wn._mult(Vt)._add(un))}sr.push(Vr)}return sr}(ye,Dt*Qe)),function(Wt,Vt,sr){for(var br=0;br<Vt.length;br++){var Ir=Vt[br];if(Wt.length>=3){for(var Pr=0;Pr<Ir.length;Pr++)if(ss(Wt,Ir[Pr]))return!0}if(Al(Wt,Ir,sr))return!0}return!1}(ct,ye,mt)},O.prototype.isTileClipped=function(){return!0},O}(Zo);function Kf(M,O){return O>0?O+2*M:M}var Ju=oi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),gd=oi([{name:"a_projected_pos",components:3,type:"Float32"}],4),vd=(oi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),oi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Qf=(oi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),yd=oi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);oi([{name:"triangle",components:3,type:"Uint16"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),oi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),oi([{type:"Float32",name:"offsetX"}]),oi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function xd(M,O,Y){return M.sections.forEach(function(ae){ae.text=function(pe,ye,Ee){var Ne=ye.layout.get("text-transform").evaluate(Ee,{});return Ne==="uppercase"?pe=pe.toLocaleUpperCase():Ne==="lowercase"&&(pe=pe.toLocaleLowerCase()),vo.applyArabicShaping&&(pe=vo.applyArabicShaping(pe)),pe}(ae.text,O,Y)}),M}var Ac={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},$f=function(M,O,Y,ae,pe){var ye,Ee,Ne=8*pe-ae-1,Qe=(1<<Ne)-1,ct=Qe>>1,mt=-7,Dt=Y?pe-1:0,Wt=Y?-1:1,Vt=M[O+Dt];for(Dt+=Wt,ye=Vt&(1<<-mt)-1,Vt>>=-mt,mt+=Ne;mt>0;ye=256*ye+M[O+Dt],Dt+=Wt,mt-=8);for(Ee=ye&(1<<-mt)-1,ye>>=-mt,mt+=ae;mt>0;Ee=256*Ee+M[O+Dt],Dt+=Wt,mt-=8);if(ye===0)ye=1-ct;else{if(ye===Qe)return Ee?NaN:1/0*(Vt?-1:1);Ee+=Math.pow(2,ae),ye-=ct}return(Vt?-1:1)*Ee*Math.pow(2,ye-ae)},eh=function(M,O,Y,ae,pe,ye){var Ee,Ne,Qe,ct=8*ye-pe-1,mt=(1<<ct)-1,Dt=mt>>1,Wt=pe===23?Math.pow(2,-24)-Math.pow(2,-77):0,Vt=ae?0:ye-1,sr=ae?1:-1,br=O<0||O===0&&1/O<0?1:0;for(O=Math.abs(O),isNaN(O)||O===1/0?(Ne=isNaN(O)?1:0,Ee=mt):(Ee=Math.floor(Math.log(O)/Math.LN2),O*(Qe=Math.pow(2,-Ee))<1&&(Ee--,Qe*=2),(O+=Ee+Dt>=1?Wt/Qe:Wt*Math.pow(2,1-Dt))*Qe>=2&&(Ee++,Qe/=2),Ee+Dt>=mt?(Ne=0,Ee=mt):Ee+Dt>=1?(Ne=(O*Qe-1)*Math.pow(2,pe),Ee+=Dt):(Ne=O*Math.pow(2,Dt-1)*Math.pow(2,pe),Ee=0));pe>=8;M[Y+Vt]=255&Ne,Vt+=sr,Ne/=256,pe-=8);for(Ee=Ee<<pe|Ne,ct+=pe;ct>0;M[Y+Vt]=255&Ee,Vt+=sr,Ee/=256,ct-=8);M[Y+Vt-sr]|=128*br},Kc=_i;function _i(M){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(M)?M:new Uint8Array(M||0),this.pos=0,this.type=0,this.length=this.buf.length}_i.Varint=0,_i.Fixed64=1,_i.Bytes=2,_i.Fixed32=5;var th=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function el(M){return M.type===_i.Bytes?M.readVarint()+M.pos:M.pos+1}function Wl(M,O,Y){return Y?4294967296*O+(M>>>0):4294967296*(O>>>0)+(M>>>0)}function rh(M,O,Y){var ae=O<=16383?1:O<=2097151?2:O<=268435455?3:Math.floor(Math.log(O)/(7*Math.LN2));Y.realloc(ae);for(var pe=Y.pos-1;pe>=M;pe--)Y.buf[pe+ae]=Y.buf[pe]}function bd(M,O){for(var Y=0;Y<M.length;Y++)O.writeVarint(M[Y])}function _d(M,O){for(var Y=0;Y<M.length;Y++)O.writeSVarint(M[Y])}function wd(M,O){for(var Y=0;Y<M.length;Y++)O.writeFloat(M[Y])}function Td(M,O){for(var Y=0;Y<M.length;Y++)O.writeDouble(M[Y])}function kd(M,O){for(var Y=0;Y<M.length;Y++)O.writeBoolean(M[Y])}function Md(M,O){for(var Y=0;Y<M.length;Y++)O.writeFixed32(M[Y])}function Ad(M,O){for(var Y=0;Y<M.length;Y++)O.writeSFixed32(M[Y])}function Sd(M,O){for(var Y=0;Y<M.length;Y++)O.writeFixed64(M[Y])}function Ed(M,O){for(var Y=0;Y<M.length;Y++)O.writeSFixed64(M[Y])}function Qc(M,O){return(M[O]|M[O+1]<<8|M[O+2]<<16)+16777216*M[O+3]}function Xl(M,O,Y){M[Y]=O,M[Y+1]=O>>>8,M[Y+2]=O>>>16,M[Y+3]=O>>>24}function nh(M,O){return(M[O]|M[O+1]<<8|M[O+2]<<16)+(M[O+3]<<24)}_i.prototype={destroy:function(){this.buf=null},readFields:function(M,O,Y){for(Y=Y||this.length;this.pos<Y;){var ae=this.readVarint(),pe=ae>>3,ye=this.pos;this.type=7&ae,M(pe,O,this),this.pos===ye&&this.skip(ae)}return O},readMessage:function(M,O){return this.readFields(M,O,this.readVarint()+this.pos)},readFixed32:function(){var M=Qc(this.buf,this.pos);return this.pos+=4,M},readSFixed32:function(){var M=nh(this.buf,this.pos);return this.pos+=4,M},readFixed64:function(){var M=Qc(this.buf,this.pos)+4294967296*Qc(this.buf,this.pos+4);return this.pos+=8,M},readSFixed64:function(){var M=Qc(this.buf,this.pos)+4294967296*nh(this.buf,this.pos+4);return this.pos+=8,M},readFloat:function(){var M=$f(this.buf,this.pos,!0,23,4);return this.pos+=4,M},readDouble:function(){var M=$f(this.buf,this.pos,!0,52,8);return this.pos+=8,M},readVarint:function(M){var O,Y,ae=this.buf;return O=127&(Y=ae[this.pos++]),Y<128?O:(O|=(127&(Y=ae[this.pos++]))<<7,Y<128?O:(O|=(127&(Y=ae[this.pos++]))<<14,Y<128?O:(O|=(127&(Y=ae[this.pos++]))<<21,Y<128?O:function(pe,ye,Ee){var Ne,Qe,ct=Ee.buf;if(Qe=ct[Ee.pos++],Ne=(112&Qe)>>4,Qe<128||(Qe=ct[Ee.pos++],Ne|=(127&Qe)<<3,Qe<128)||(Qe=ct[Ee.pos++],Ne|=(127&Qe)<<10,Qe<128)||(Qe=ct[Ee.pos++],Ne|=(127&Qe)<<17,Qe<128)||(Qe=ct[Ee.pos++],Ne|=(127&Qe)<<24,Qe<128)||(Qe=ct[Ee.pos++],Ne|=(1&Qe)<<31,Qe<128))return Wl(pe,Ne,ye);throw new Error("Expected varint not more than 10 bytes")}(O|=(15&(Y=ae[this.pos]))<<28,M,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var M=this.readVarint();return M%2==1?(M+1)/-2:M/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var M=this.readVarint()+this.pos,O=this.pos;return this.pos=M,M-O>=12&&th?function(Y,ae,pe){return th.decode(Y.subarray(ae,pe))}(this.buf,O,M):function(Y,ae,pe){for(var ye="",Ee=ae;Ee<pe;){var Ne,Qe,ct,mt=Y[Ee],Dt=null,Wt=mt>239?4:mt>223?3:mt>191?2:1;if(Ee+Wt>pe)break;Wt===1?mt<128&&(Dt=mt):Wt===2?(192&(Ne=Y[Ee+1]))==128&&(Dt=(31&mt)<<6|63&Ne)<=127&&(Dt=null):Wt===3?(Ne=Y[Ee+1],Qe=Y[Ee+2],(192&Ne)==128&&(192&Qe)==128&&((Dt=(15&mt)<<12|(63&Ne)<<6|63&Qe)<=2047||Dt>=55296&&Dt<=57343)&&(Dt=null)):Wt===4&&(Ne=Y[Ee+1],Qe=Y[Ee+2],ct=Y[Ee+3],(192&Ne)==128&&(192&Qe)==128&&(192&ct)==128&&((Dt=(15&mt)<<18|(63&Ne)<<12|(63&Qe)<<6|63&ct)<=65535||Dt>=1114112)&&(Dt=null)),Dt===null?(Dt=65533,Wt=1):Dt>65535&&(Dt-=65536,ye+=String.fromCharCode(Dt>>>10&1023|55296),Dt=56320|1023&Dt),ye+=String.fromCharCode(Dt),Ee+=Wt}return ye}(this.buf,O,M)},readBytes:function(){var M=this.readVarint()+this.pos,O=this.buf.subarray(this.pos,M);return this.pos=M,O},readPackedVarint:function(M,O){if(this.type!==_i.Bytes)return M.push(this.readVarint(O));var Y=el(this);for(M=M||[];this.pos<Y;)M.push(this.readVarint(O));return M},readPackedSVarint:function(M){if(this.type!==_i.Bytes)return M.push(this.readSVarint());var O=el(this);for(M=M||[];this.pos<O;)M.push(this.readSVarint());return M},readPackedBoolean:function(M){if(this.type!==_i.Bytes)return M.push(this.readBoolean());var O=el(this);for(M=M||[];this.pos<O;)M.push(this.readBoolean());return M},readPackedFloat:function(M){if(this.type!==_i.Bytes)return M.push(this.readFloat());var O=el(this);for(M=M||[];this.pos<O;)M.push(this.readFloat());return M},readPackedDouble:function(M){if(this.type!==_i.Bytes)return M.push(this.readDouble());var O=el(this);for(M=M||[];this.pos<O;)M.push(this.readDouble());return M},readPackedFixed32:function(M){if(this.type!==_i.Bytes)return M.push(this.readFixed32());var O=el(this);for(M=M||[];this.pos<O;)M.push(this.readFixed32());return M},readPackedSFixed32:function(M){if(this.type!==_i.Bytes)return M.push(this.readSFixed32());var O=el(this);for(M=M||[];this.pos<O;)M.push(this.readSFixed32());return M},readPackedFixed64:function(M){if(this.type!==_i.Bytes)return M.push(this.readFixed64());var O=el(this);for(M=M||[];this.pos<O;)M.push(this.readFixed64());return M},readPackedSFixed64:function(M){if(this.type!==_i.Bytes)return M.push(this.readSFixed64());var O=el(this);for(M=M||[];this.pos<O;)M.push(this.readSFixed64());return M},skip:function(M){var O=7&M;if(O===_i.Varint)for(;this.buf[this.pos++]>127;);else if(O===_i.Bytes)this.pos=this.readVarint()+this.pos;else if(O===_i.Fixed32)this.pos+=4;else{if(O!==_i.Fixed64)throw new Error("Unimplemented type: "+O);this.pos+=8}},writeTag:function(M,O){this.writeVarint(M<<3|O)},realloc:function(M){for(var O=this.length||16;O<this.pos+M;)O*=2;if(O!==this.length){var Y=new Uint8Array(O);Y.set(this.buf),this.buf=Y,this.length=O}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(M){this.realloc(4),Xl(this.buf,M,this.pos),this.pos+=4},writeSFixed32:function(M){this.realloc(4),Xl(this.buf,M,this.pos),this.pos+=4},writeFixed64:function(M){this.realloc(8),Xl(this.buf,-1&M,this.pos),Xl(this.buf,Math.floor(M*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(M){this.realloc(8),Xl(this.buf,-1&M,this.pos),Xl(this.buf,Math.floor(M*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(M){(M=+M||0)>268435455||M<0?function(O,Y){var ae,pe;if(O>=0?(ae=O%4294967296|0,pe=O/4294967296|0):(pe=~(-O/4294967296),4294967295^(ae=~(-O%4294967296))?ae=ae+1|0:(ae=0,pe=pe+1|0)),O>=18446744073709552e3||O<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Y.realloc(10),function(ye,Ee,Ne){Ne.buf[Ne.pos++]=127&ye|128,ye>>>=7,Ne.buf[Ne.pos++]=127&ye|128,ye>>>=7,Ne.buf[Ne.pos++]=127&ye|128,ye>>>=7,Ne.buf[Ne.pos++]=127&ye|128,ye>>>=7,Ne.buf[Ne.pos]=127&ye}(ae,0,Y),function(ye,Ee){var Ne=(7&ye)<<4;Ee.buf[Ee.pos++]|=Ne|((ye>>>=3)?128:0),ye&&(Ee.buf[Ee.pos++]=127&ye|((ye>>>=7)?128:0),ye&&(Ee.buf[Ee.pos++]=127&ye|((ye>>>=7)?128:0),ye&&(Ee.buf[Ee.pos++]=127&ye|((ye>>>=7)?128:0),ye&&(Ee.buf[Ee.pos++]=127&ye|((ye>>>=7)?128:0),ye&&(Ee.buf[Ee.pos++]=127&ye)))))}(pe,Y)}(M,this):(this.realloc(4),this.buf[this.pos++]=127&M|(M>127?128:0),M<=127||(this.buf[this.pos++]=127&(M>>>=7)|(M>127?128:0),M<=127||(this.buf[this.pos++]=127&(M>>>=7)|(M>127?128:0),M<=127||(this.buf[this.pos++]=M>>>7&127))))},writeSVarint:function(M){this.writeVarint(M<0?2*-M-1:2*M)},writeBoolean:function(M){this.writeVarint(Boolean(M))},writeString:function(M){M=String(M),this.realloc(4*M.length),this.pos++;var O=this.pos;this.pos=function(ae,pe,ye){for(var Ee,Ne,Qe=0;Qe<pe.length;Qe++){if((Ee=pe.charCodeAt(Qe))>55295&&Ee<57344){if(!Ne){Ee>56319||Qe+1===pe.length?(ae[ye++]=239,ae[ye++]=191,ae[ye++]=189):Ne=Ee;continue}if(Ee<56320){ae[ye++]=239,ae[ye++]=191,ae[ye++]=189,Ne=Ee;continue}Ee=Ne-55296<<10|Ee-56320|65536,Ne=null}else Ne&&(ae[ye++]=239,ae[ye++]=191,ae[ye++]=189,Ne=null);Ee<128?ae[ye++]=Ee:(Ee<2048?ae[ye++]=Ee>>6|192:(Ee<65536?ae[ye++]=Ee>>12|224:(ae[ye++]=Ee>>18|240,ae[ye++]=Ee>>12&63|128),ae[ye++]=Ee>>6&63|128),ae[ye++]=63&Ee|128)}return ye}(this.buf,M,this.pos);var Y=this.pos-O;Y>=128&&rh(O,Y,this),this.pos=O-1,this.writeVarint(Y),this.pos+=Y},writeFloat:function(M){this.realloc(4),eh(this.buf,M,this.pos,!0,23,4),this.pos+=4},writeDouble:function(M){this.realloc(8),eh(this.buf,M,this.pos,!0,52,8),this.pos+=8},writeBytes:function(M){var O=M.length;this.writeVarint(O),this.realloc(O);for(var Y=0;Y<O;Y++)this.buf[this.pos++]=M[Y]},writeRawMessage:function(M,O){this.pos++;var Y=this.pos;M(O,this);var ae=this.pos-Y;ae>=128&&rh(Y,ae,this),this.pos=Y-1,this.writeVarint(ae),this.pos+=ae},writeMessage:function(M,O,Y){this.writeTag(M,_i.Bytes),this.writeRawMessage(O,Y)},writePackedVarint:function(M,O){O.length&&this.writeMessage(M,bd,O)},writePackedSVarint:function(M,O){O.length&&this.writeMessage(M,_d,O)},writePackedBoolean:function(M,O){O.length&&this.writeMessage(M,kd,O)},writePackedFloat:function(M,O){O.length&&this.writeMessage(M,wd,O)},writePackedDouble:function(M,O){O.length&&this.writeMessage(M,Td,O)},writePackedFixed32:function(M,O){O.length&&this.writeMessage(M,Md,O)},writePackedSFixed32:function(M,O){O.length&&this.writeMessage(M,Ad,O)},writePackedFixed64:function(M,O){O.length&&this.writeMessage(M,Sd,O)},writePackedSFixed64:function(M,O){O.length&&this.writeMessage(M,Ed,O)},writeBytesField:function(M,O){this.writeTag(M,_i.Bytes),this.writeBytes(O)},writeFixed32Field:function(M,O){this.writeTag(M,_i.Fixed32),this.writeFixed32(O)},writeSFixed32Field:function(M,O){this.writeTag(M,_i.Fixed32),this.writeSFixed32(O)},writeFixed64Field:function(M,O){this.writeTag(M,_i.Fixed64),this.writeFixed64(O)},writeSFixed64Field:function(M,O){this.writeTag(M,_i.Fixed64),this.writeSFixed64(O)},writeVarintField:function(M,O){this.writeTag(M,_i.Varint),this.writeVarint(O)},writeSVarintField:function(M,O){this.writeTag(M,_i.Varint),this.writeSVarint(O)},writeStringField:function(M,O){this.writeTag(M,_i.Bytes),this.writeString(O)},writeFloatField:function(M,O){this.writeTag(M,_i.Fixed32),this.writeFloat(O)},writeDoubleField:function(M,O){this.writeTag(M,_i.Fixed64),this.writeDouble(O)},writeBooleanField:function(M,O){this.writeVarintField(M,Boolean(O))}};function Ld(M,O,Y){M===1&&Y.readMessage(Cd,O)}function Cd(M,O,Y){if(M===3){var ae=Y.readMessage(Pd,{}),pe=ae.id,ye=ae.bitmap,Ee=ae.width,Ne=ae.height,Qe=ae.left,ct=ae.top,mt=ae.advance;O.push({id:pe,bitmap:new Cl({width:Ee+6,height:Ne+6},ye),metrics:{width:Ee,height:Ne,left:Qe,top:ct,advance:mt}})}}function Pd(M,O,Y){M===1?O.id=Y.readVarint():M===2?O.bitmap=Y.readBytes():M===3?O.width=Y.readVarint():M===4?O.height=Y.readVarint():M===5?O.left=Y.readSVarint():M===6?O.top=Y.readSVarint():M===7&&(O.advance=Y.readVarint())}function ah(M){for(var O=0,Y=0,ae=0,pe=M;ae<pe.length;ae+=1){var ye=pe[ae];O+=ye.w*ye.h,Y=Math.max(Y,ye.w)}M.sort(function(br,Ir){return Ir.h-br.h});for(var Ee=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(O/.95)),Y),h:1/0}],Ne=0,Qe=0,ct=0,mt=M;ct<mt.length;ct+=1)for(var Dt=mt[ct],Wt=Ee.length-1;Wt>=0;Wt--){var Vt=Ee[Wt];if(!(Dt.w>Vt.w||Dt.h>Vt.h)){if(Dt.x=Vt.x,Dt.y=Vt.y,Qe=Math.max(Qe,Dt.y+Dt.h),Ne=Math.max(Ne,Dt.x+Dt.w),Dt.w===Vt.w&&Dt.h===Vt.h){var sr=Ee.pop();Wt<Ee.length&&(Ee[Wt]=sr)}else Dt.h===Vt.h?(Vt.x+=Dt.w,Vt.w-=Dt.w):Dt.w===Vt.w?(Vt.y+=Dt.h,Vt.h-=Dt.h):(Ee.push({x:Vt.x+Dt.w,y:Vt.y,w:Vt.w-Dt.w,h:Dt.h}),Vt.y+=Dt.h,Vt.h-=Dt.h);break}}return{w:Ne,h:Qe,fill:O/(Ne*Qe)||0}}var $c=function(M,O){var Y=O.pixelRatio,ae=O.version,pe=O.stretchX,ye=O.stretchY,Ee=O.content;this.paddedRect=M,this.pixelRatio=Y,this.stretchX=pe,this.stretchY=ye,this.content=Ee,this.version=ae},Sc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Sc.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Sc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Sc.tlbr.get=function(){return this.tl.concat(this.br)},Sc.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties($c.prototype,Sc);var Ec=function(M,O){var Y={},ae={};this.haveRenderCallbacks=[];var pe=[];this.addImages(M,Y,pe),this.addImages(O,ae,pe);var ye=ah(pe),Ee=ye.w,Ne=ye.h,Qe=new es({width:Ee||1,height:Ne||1});for(var ct in M){var mt=M[ct],Dt=Y[ct].paddedRect;es.copy(mt.data,Qe,{x:0,y:0},{x:Dt.x+1,y:Dt.y+1},mt.data)}for(var Wt in O){var Vt=O[Wt],sr=ae[Wt].paddedRect,br=sr.x+1,Ir=sr.y+1,Pr=Vt.data.width,Vr=Vt.data.height;es.copy(Vt.data,Qe,{x:0,y:0},{x:br,y:Ir},Vt.data),es.copy(Vt.data,Qe,{x:0,y:Vr-1},{x:br,y:Ir-1},{width:Pr,height:1}),es.copy(Vt.data,Qe,{x:0,y:0},{x:br,y:Ir+Vr},{width:Pr,height:1}),es.copy(Vt.data,Qe,{x:Pr-1,y:0},{x:br-1,y:Ir},{width:1,height:Vr}),es.copy(Vt.data,Qe,{x:0,y:0},{x:br+Pr,y:Ir},{width:1,height:Vr})}this.image=Qe,this.iconPositions=Y,this.patternPositions=ae};Ec.prototype.addImages=function(M,O,Y){for(var ae in M){var pe=M[ae],ye={x:0,y:0,w:pe.data.width+2,h:pe.data.height+2};Y.push(ye),O[ae]=new $c(ye,pe),pe.hasRenderCallback&&this.haveRenderCallbacks.push(ae)}},Ec.prototype.patchUpdatedImages=function(M,O){for(var Y in M.dispatchRenderCallbacks(this.haveRenderCallbacks),M.updatedImages)this.patchUpdatedImage(this.iconPositions[Y],M.getImage(Y),O),this.patchUpdatedImage(this.patternPositions[Y],M.getImage(Y),O)},Ec.prototype.patchUpdatedImage=function(M,O,Y){if(M&&O&&M.version!==O.version){M.version=O.version;var ae=M.tl,pe=ae[0],ye=ae[1];Y.update(O.data,void 0,{x:pe,y:ye})}},Kr("ImagePosition",$c),Kr("ImageAtlas",Ec);var ds={horizontal:1,vertical:2,horizontalOnly:3},Zl=function(){this.scale=1,this.fontStack="",this.imageName=null};Zl.forText=function(M,O){var Y=new Zl;return Y.scale=M||1,Y.fontStack=O,Y},Zl.forImage=function(M){var O=new Zl;return O.imageName=M,O};var Vo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function eu(M,O,Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt,sr,br){var Ir,Pr=Vo.fromFeature(M,pe);Dt===ds.vertical&&Pr.verticalizePunctuation();var Vr=vo.processBidirectionalText,Hr=vo.processStyledBidirectionalText;if(Vr&&Pr.sections.length===1){Ir=[];for(var Xr=0,un=Vr(Pr.toString(),Ku(Pr,ct,ye,O,ae,Vt,sr));Xr<un.length;Xr+=1){var bn=un[Xr],jn=new Vo;jn.text=bn,jn.sections=Pr.sections;for(var Bn=0;Bn<bn.length;Bn++)jn.sectionIndex.push(0);Ir.push(jn)}}else if(Hr){Ir=[];for(var Wn=0,sa=Hr(Pr.text,Pr.sectionIndex,Ku(Pr,ct,ye,O,ae,Vt,sr));Wn<sa.length;Wn+=1){var la=sa[Wn],$n=new Vo;$n.text=la[0],$n.sectionIndex=la[1],$n.sections=Pr.sections,Ir.push($n)}}else Ir=function(ca,ei){for(var qa=[],ni=ca.text,Ta=0,Wa=0,wi=ei;Wa<wi.length;Wa+=1){var mi=wi[Wa];qa.push(ca.substring(Ta,mi)),Ta=mi}return Ta<ni.length&&qa.push(ca.substring(Ta,ni.length)),qa}(Pr,Ku(Pr,ct,ye,O,ae,Vt,sr));var ma=[],pa={positionedLines:ma,text:Pr.toString(),top:mt[1],bottom:mt[1],left:mt[0],right:mt[0],writingMode:Dt,iconsInText:!1,verticalizable:!1};return function(ca,ei,qa,ni,Ta,Wa,wi,mi,Pi,gi,fo,Ii){for(var No=0,Eo=-17,Po=0,Jo=0,Ho=mi==="right"?1:mi==="left"?0:.5,ho=0,Io=0,Qi=Ta;Io<Qi.length;Io+=1){var yo=Qi[Io];yo.trim();var Ba=yo.getMaxScale(),ti=24*(Ba-1),qi={positionedGlyphs:[],lineOffset:0};ca.positionedLines[ho]=qi;var Gi=qi.positionedGlyphs,ji=0;if(yo.length()){for(var Oi=0;Oi<yo.length();Oi++){var si=yo.getSection(Oi),Yi=yo.getSectionIndex(Oi),Ko=yo.getCharCode(Oi),cs=0,qo=null,Bs=null,nl=null,Lo=24,Ns=!(Pi===ds.horizontal||!fo&&!ga(Ko)||fo&&(tu[Ko]||(ml=Ko,En.Arabic(ml)||En["Arabic Supplement"](ml)||En["Arabic Extended-A"](ml)||En["Arabic Presentation Forms-A"](ml)||En["Arabic Presentation Forms-B"](ml))));if(si.imageName){var js=ni[si.imageName];if(!js)continue;nl=si.imageName,ca.iconsInText=ca.iconsInText||!0,Bs=js.paddedRect;var Us=js.displaySize;si.scale=24*si.scale/Ii,qo={width:Us[0],height:Us[1],left:1,top:-3,advance:Ns?Us[1]:Us[0]};var lf=24-Us[1]*si.scale;cs=ti+lf,Lo=qo.advance;var nc=Ns?Us[0]*si.scale-24*Ba:Us[1]*si.scale-24*Ba;nc>0&&nc>ji&&(ji=nc)}else{var uu=qa[si.fontStack],zl=uu&&uu[Ko];if(zl&&zl.rect)Bs=zl.rect,qo=zl.metrics;else{var fu=ei[si.fontStack],hu=fu&&fu[Ko];if(!hu)continue;qo=hu.metrics}cs=24*(Ba-si.scale)}Ns?(ca.verticalizable=!0,Gi.push({glyph:Ko,imageName:nl,x:No,y:Eo+cs,vertical:Ns,scale:si.scale,fontStack:si.fontStack,sectionIndex:Yi,metrics:qo,rect:Bs}),No+=Lo*si.scale+gi):(Gi.push({glyph:Ko,imageName:nl,x:No,y:Eo+cs,vertical:Ns,scale:si.scale,fontStack:si.fontStack,sectionIndex:Yi,metrics:qo,rect:Bs}),No+=qo.advance*si.scale+gi)}if(Gi.length!==0){var pu=No-gi;Po=Math.max(pu,Po),Od(Gi,0,Gi.length-1,Ho,ji)}No=0;var du=Wa*Ba+ji;qi.lineOffset=Math.max(ji,ti),Eo+=du,Jo=Math.max(du,Jo),++ho}else Eo+=Wa,++ho}var ml,ac=Eo- -17,mu=Qu(wi),ic=mu.horizontalAlign,vl=mu.verticalAlign;(function(Pc,gu,vu,yu,Ic,xu,Oc,bu,zc){var _u=(gu-vu)*Ic,oc=0;oc=xu!==Oc?-bu*yu- -17:(-yu*zc+.5)*Oc;for(var sc=0,lc=Pc;sc<lc.length;sc+=1)for(var wu=lc[sc],cc=0,Dc=wu.positionedGlyphs;cc<Dc.length;cc+=1){var uc=Dc[cc];uc.x+=_u,uc.y+=oc}})(ca.positionedLines,Ho,ic,vl,Po,Jo,Wa,ac,Ta.length),ca.top+=-vl*ac,ca.bottom=ca.top+ac,ca.left+=-ic*Po,ca.right=ca.left+Po}(pa,O,Y,ae,Ir,Ee,Ne,Qe,Dt,ct,Wt,br),!function(ca){for(var ei=0,qa=ca;ei<qa.length;ei+=1)if(qa[ei].positionedGlyphs.length!==0)return!1;return!0}(ma)&&pa}Vo.fromFeature=function(M,O){for(var Y=new Vo,ae=0;ae<M.sections.length;ae++){var pe=M.sections[ae];pe.image?Y.addImageSection(pe):Y.addTextSection(pe,O)}return Y},Vo.prototype.length=function(){return this.text.length},Vo.prototype.getSection=function(M){return this.sections[this.sectionIndex[M]]},Vo.prototype.getSectionIndex=function(M){return this.sectionIndex[M]},Vo.prototype.getCharCode=function(M){return this.text.charCodeAt(M)},Vo.prototype.verticalizePunctuation=function(){this.text=function(M){for(var O="",Y=0;Y<M.length;Y++){var ae=M.charCodeAt(Y+1)||null,pe=M.charCodeAt(Y-1)||null;(!ae||!Fa(ae)||Ac[M[Y+1]])&&(!pe||!Fa(pe)||Ac[M[Y-1]])&&Ac[M[Y]]?O+=Ac[M[Y]]:O+=M[Y]}return O}(this.text)},Vo.prototype.trim=function(){for(var M=0,O=0;O<this.text.length&&tu[this.text.charCodeAt(O)];O++)M++;for(var Y=this.text.length,ae=this.text.length-1;ae>=0&&ae>=M&&tu[this.text.charCodeAt(ae)];ae--)Y--;this.text=this.text.substring(M,Y),this.sectionIndex=this.sectionIndex.slice(M,Y)},Vo.prototype.substring=function(M,O){var Y=new Vo;return Y.text=this.text.substring(M,O),Y.sectionIndex=this.sectionIndex.slice(M,O),Y.sections=this.sections,Y},Vo.prototype.toString=function(){return this.text},Vo.prototype.getMaxScale=function(){var M=this;return this.sectionIndex.reduce(function(O,Y){return Math.max(O,M.sections[Y].scale)},0)},Vo.prototype.addTextSection=function(M,O){this.text+=M.text,this.sections.push(Zl.forText(M.scale,M.fontStack||O));for(var Y=this.sections.length-1,ae=0;ae<M.text.length;++ae)this.sectionIndex.push(Y)},Vo.prototype.addImageSection=function(M){var O=M.image?M.image.name:"";if(O.length!==0){var Y=this.getNextImageSectionCharCode();Y?(this.text+=String.fromCharCode(Y),this.sections.push(Zl.forImage(O)),this.sectionIndex.push(this.sections.length-1)):A("Reached maximum number of images 6401")}else A("Can't add FormattedSection with an empty image.")},Vo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var tu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ls={};function ih(M,O,Y,ae,pe,ye){if(O.imageName){var Ee=ae[O.imageName];return Ee?Ee.displaySize[0]*O.scale*24/ye+pe:0}var Ne=Y[O.fontStack],Qe=Ne&&Ne[M];return Qe?Qe.metrics.advance*O.scale+pe:0}function oh(M,O,Y,ae){var pe=Math.pow(M-O,2);return ae?M<O?pe/2:2*pe:pe+Math.abs(Y)*Y}function Id(M,O,Y){var ae=0;return M===10&&(ae-=1e4),Y&&(ae+=150),M!==40&&M!==65288||(ae+=50),O!==41&&O!==65289||(ae+=50),ae}function sh(M,O,Y,ae,pe,ye){for(var Ee=null,Ne=oh(O,Y,pe,ye),Qe=0,ct=ae;Qe<ct.length;Qe+=1){var mt=ct[Qe],Dt=oh(O-mt.x,Y,pe,ye)+mt.badness;Dt<=Ne&&(Ee=mt,Ne=Dt)}return{index:M,x:O,priorBreak:Ee,badness:Ne}}function Ku(M,O,Y,ae,pe,ye,Ee){if(ye!=="point")return[];if(!M)return[];for(var Ne,Qe=[],ct=function(Ir,Pr,Vr,Hr,Xr,un){for(var bn=0,jn=0;jn<Ir.length();jn++){var Bn=Ir.getSection(jn);bn+=ih(Ir.getCharCode(jn),Bn,Hr,Xr,Pr,un)}return bn/Math.max(1,Math.ceil(bn/Vr))}(M,O,Y,ae,pe,Ee),mt=M.text.indexOf("\u200B")>=0,Dt=0,Wt=0;Wt<M.length();Wt++){var Vt=M.getSection(Wt),sr=M.getCharCode(Wt);if(tu[sr]||(Dt+=ih(sr,Vt,ae,pe,O,Ee)),Wt<M.length()-1){var br=!!(!((Ne=sr)<11904)&&(En["Bopomofo Extended"](Ne)||En.Bopomofo(Ne)||En["CJK Compatibility Forms"](Ne)||En["CJK Compatibility Ideographs"](Ne)||En["CJK Compatibility"](Ne)||En["CJK Radicals Supplement"](Ne)||En["CJK Strokes"](Ne)||En["CJK Symbols and Punctuation"](Ne)||En["CJK Unified Ideographs Extension A"](Ne)||En["CJK Unified Ideographs"](Ne)||En["Enclosed CJK Letters and Months"](Ne)||En["Halfwidth and Fullwidth Forms"](Ne)||En.Hiragana(Ne)||En["Ideographic Description Characters"](Ne)||En["Kangxi Radicals"](Ne)||En["Katakana Phonetic Extensions"](Ne)||En.Katakana(Ne)||En["Vertical Forms"](Ne)||En["Yi Radicals"](Ne)||En["Yi Syllables"](Ne)));(ls[sr]||br||Vt.imageName)&&Qe.push(sh(Wt+1,Dt,ct,Qe,Id(sr,M.getCharCode(Wt+1),br&&mt),!1))}}return function Ir(Pr){return Pr?Ir(Pr.priorBreak).concat(Pr.index):[]}(sh(M.length(),Dt,ct,Qe,0,!0))}function Qu(M){var O=.5,Y=.5;switch(M){case"right":case"top-right":case"bottom-right":O=1;break;case"left":case"top-left":case"bottom-left":O=0}switch(M){case"bottom":case"bottom-right":case"bottom-left":Y=1;break;case"top":case"top-right":case"top-left":Y=0}return{horizontalAlign:O,verticalAlign:Y}}function Od(M,O,Y,ae,pe){if(ae||pe)for(var ye=M[Y],Ee=ye.metrics.advance*ye.scale,Ne=(M[Y].x+Ee)*ae,Qe=O;Qe<=Y;Qe++)M[Qe].x-=Ne,M[Qe].y+=pe}function lh(M,O,Y,ae,pe,ye){var Ee,Ne=M.image;if(Ne.content){var Qe=Ne.content,ct=Ne.pixelRatio||1;Ee=[Qe[0]/ct,Qe[1]/ct,Ne.displaySize[0]-Qe[2]/ct,Ne.displaySize[1]-Qe[3]/ct]}var mt,Dt,Wt,Vt,sr=O.left*ye,br=O.right*ye;Y==="width"||Y==="both"?(Vt=pe[0]+sr-ae[3],Dt=pe[0]+br+ae[1]):Dt=(Vt=pe[0]+(sr+br-Ne.displaySize[0])/2)+Ne.displaySize[0];var Ir=O.top*ye,Pr=O.bottom*ye;return Y==="height"||Y==="both"?(mt=pe[1]+Ir-ae[0],Wt=pe[1]+Pr+ae[2]):Wt=(mt=pe[1]+(Ir+Pr-Ne.displaySize[1])/2)+Ne.displaySize[1],{image:Ne,top:mt,right:Dt,bottom:Wt,left:Vt,collisionPadding:Ee}}ls[10]=!0,ls[32]=!0,ls[38]=!0,ls[40]=!0,ls[41]=!0,ls[43]=!0,ls[45]=!0,ls[47]=!0,ls[173]=!0,ls[183]=!0,ls[8203]=!0,ls[8208]=!0,ls[8211]=!0,ls[8231]=!0;var Jl=function(M){function O(Y,ae,pe,ye){M.call(this,Y,ae),this.angle=pe,ye!==void 0&&(this.segment=ye)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.clone=function(){return new O(this.x,this.y,this.angle,this.segment)},O}(r);Kr("Anchor",Jl);function $u(M,O){var Y=O.expression;if(Y.kind==="constant")return{kind:"constant",layoutSize:Y.evaluate(new ii(M+1))};if(Y.kind==="source")return{kind:"source"};for(var ae=Y.zoomStops,pe=Y.interpolationType,ye=0;ye<ae.length&&ae[ye]<=M;)ye++;for(var Ee=ye=Math.max(0,ye-1);Ee<ae.length&&ae[Ee]<M+1;)Ee++;Ee=Math.min(ae.length-1,Ee);var Ne=ae[ye],Qe=ae[Ee];return Y.kind==="composite"?{kind:"composite",minZoom:Ne,maxZoom:Qe,interpolationType:pe}:{kind:"camera",minZoom:Ne,maxZoom:Qe,minSize:Y.evaluate(new ii(Ne)),maxSize:Y.evaluate(new ii(Qe)),interpolationType:pe}}function ch(M,O,Y){var ae=O.uSize,pe=O.uSizeT,ye=Y.lowerSize,Ee=Y.upperSize;return M.kind==="source"?ye/128:M.kind==="composite"?wn(ye/128,Ee/128,pe):ae}function uh(M,O){var Y=0,ae=0;if(M.kind==="constant")ae=M.layoutSize;else if(M.kind!=="source"){var pe=M.interpolationType,ye=M.minZoom,Ee=M.maxZoom,Ne=pe?u(Na.interpolationFactor(pe,O,ye,Ee),0,1):0;M.kind==="camera"?ae=wn(M.minSize,M.maxSize,Ne):Y=Ne}return{uSizeT:Y,uSize:ae}}var zd=Object.freeze({__proto__:null,getSizeData:$u,evaluateSizeForFeature:ch,evaluateSizeForZoom:uh,SIZE_PACK_FACTOR:128});function fh(M,O,Y,ae,pe){if(O.segment===void 0)return!0;for(var ye=O,Ee=O.segment+1,Ne=0;Ne>-Y/2;){if(--Ee<0)return!1;Ne-=M[Ee].dist(ye),ye=M[Ee]}Ne+=M[Ee].dist(M[Ee+1]),Ee++;for(var Qe=[],ct=0;Ne<Y/2;){var mt=M[Ee-1],Dt=M[Ee],Wt=M[Ee+1];if(!Wt)return!1;var Vt=mt.angleTo(Dt)-Dt.angleTo(Wt);for(Vt=Math.abs((Vt+3*Math.PI)%(2*Math.PI)-Math.PI),Qe.push({distance:Ne,angleDelta:Vt}),ct+=Vt;Ne-Qe[0].distance>ae;)ct-=Qe.shift().angleDelta;if(ct>pe)return!1;Ee++,Ne+=Dt.dist(Wt)}return!0}function hh(M){for(var O=0,Y=0;Y<M.length-1;Y++)O+=M[Y].dist(M[Y+1]);return O}function ph(M,O,Y){return M?.6*O*Y:0}function dh(M,O){return Math.max(M?M.right-M.left:0,O?O.right-O.left:0)}function Dd(M,O,Y,ae,pe,ye){for(var Ee=ph(Y,pe,ye),Ne=dh(Y,ae)*ye,Qe=0,ct=hh(M)/2,mt=0;mt<M.length-1;mt++){var Dt=M[mt],Wt=M[mt+1],Vt=Dt.dist(Wt);if(Qe+Vt>ct){var sr=(ct-Qe)/Vt,br=wn(Dt.x,Wt.x,sr),Ir=wn(Dt.y,Wt.y,sr),Pr=new Jl(br,Ir,Wt.angleTo(Dt),mt);return Pr._round(),!Ee||fh(M,Pr,Ne,Ee,O)?Pr:void 0}Qe+=Vt}}function Rd(M,O,Y,ae,pe,ye,Ee,Ne,Qe){var ct=ph(ae,ye,Ee),mt=dh(ae,pe),Dt=mt*Ee,Wt=M[0].x===0||M[0].x===Qe||M[0].y===0||M[0].y===Qe;return O-Dt<O/4&&(O=Dt+O/4),function Vt(sr,br,Ir,Pr,Vr,Hr,Xr,un,bn){for(var jn=Hr/2,Bn=hh(sr),Wn=0,sa=br-Ir,la=[],$n=0;$n<sr.length-1;$n++){for(var ma=sr[$n],pa=sr[$n+1],ca=ma.dist(pa),ei=pa.angleTo(ma);sa+Ir<Wn+ca;){var qa=((sa+=Ir)-Wn)/ca,ni=wn(ma.x,pa.x,qa),Ta=wn(ma.y,pa.y,qa);if(ni>=0&&ni<bn&&Ta>=0&&Ta<bn&&sa-jn>=0&&sa+jn<=Bn){var Wa=new Jl(ni,Ta,ei,$n);Wa._round(),Pr&&!fh(sr,Wa,Hr,Pr,Vr)||la.push(Wa)}}Wn+=ca}return un||la.length||Xr||(la=Vt(sr,Wn/2,Ir,Pr,Vr,Hr,Xr,!0,bn)),la}(M,Wt?O/2*Ne%O:(mt/2+2*ye)*Ee*Ne%O,O,ct,Y,Dt,Wt,!1,Qe)}function mh(M,O,Y,ae,pe){for(var ye=[],Ee=0;Ee<M.length;Ee++)for(var Ne=M[Ee],Qe=void 0,ct=0;ct<Ne.length-1;ct++){var mt=Ne[ct],Dt=Ne[ct+1];mt.x<O&&Dt.x<O||(mt.x<O?mt=new r(O,mt.y+(Dt.y-mt.y)*((O-mt.x)/(Dt.x-mt.x)))._round():Dt.x<O&&(Dt=new r(O,mt.y+(Dt.y-mt.y)*((O-mt.x)/(Dt.x-mt.x)))._round()),mt.y<Y&&Dt.y<Y||(mt.y<Y?mt=new r(mt.x+(Dt.x-mt.x)*((Y-mt.y)/(Dt.y-mt.y)),Y)._round():Dt.y<Y&&(Dt=new r(mt.x+(Dt.x-mt.x)*((Y-mt.y)/(Dt.y-mt.y)),Y)._round()),mt.x>=ae&&Dt.x>=ae||(mt.x>=ae?mt=new r(ae,mt.y+(Dt.y-mt.y)*((ae-mt.x)/(Dt.x-mt.x)))._round():Dt.x>=ae&&(Dt=new r(ae,mt.y+(Dt.y-mt.y)*((ae-mt.x)/(Dt.x-mt.x)))._round()),mt.y>=pe&&Dt.y>=pe||(mt.y>=pe?mt=new r(mt.x+(Dt.x-mt.x)*((pe-mt.y)/(Dt.y-mt.y)),pe)._round():Dt.y>=pe&&(Dt=new r(mt.x+(Dt.x-mt.x)*((pe-mt.y)/(Dt.y-mt.y)),pe)._round()),Qe&&mt.equals(Qe[Qe.length-1])||(Qe=[mt],ye.push(Qe)),Qe.push(Dt)))))}return ye}function gh(M,O,Y,ae){var pe=[],ye=M.image,Ee=ye.pixelRatio,Ne=ye.paddedRect.w-2,Qe=ye.paddedRect.h-2,ct=M.right-M.left,mt=M.bottom-M.top,Dt=ye.stretchX||[[0,Ne]],Wt=ye.stretchY||[[0,Qe]],Vt=function(Wa,wi){return Wa+wi[1]-wi[0]},sr=Dt.reduce(Vt,0),br=Wt.reduce(Vt,0),Ir=Ne-sr,Pr=Qe-br,Vr=0,Hr=sr,Xr=0,un=br,bn=0,jn=Ir,Bn=0,Wn=Pr;if(ye.content&&ae){var sa=ye.content;Vr=ru(Dt,0,sa[0]),Xr=ru(Wt,0,sa[1]),Hr=ru(Dt,sa[0],sa[2]),un=ru(Wt,sa[1],sa[3]),bn=sa[0]-Vr,Bn=sa[1]-Xr,jn=sa[2]-sa[0]-Hr,Wn=sa[3]-sa[1]-un}var la=function(Wa,wi,mi,Pi){var gi=nu(Wa.stretch-Vr,Hr,ct,M.left),fo=au(Wa.fixed-bn,jn,Wa.stretch,sr),Ii=nu(wi.stretch-Xr,un,mt,M.top),No=au(wi.fixed-Bn,Wn,wi.stretch,br),Eo=nu(mi.stretch-Vr,Hr,ct,M.left),Po=au(mi.fixed-bn,jn,mi.stretch,sr),Jo=nu(Pi.stretch-Xr,un,mt,M.top),Ho=au(Pi.fixed-Bn,Wn,Pi.stretch,br),ho=new r(gi,Ii),Io=new r(Eo,Ii),Qi=new r(Eo,Jo),yo=new r(gi,Jo),Ba=new r(fo/Ee,No/Ee),ti=new r(Po/Ee,Ho/Ee),qi=O*Math.PI/180;if(qi){var Gi=Math.sin(qi),ji=Math.cos(qi),Oi=[ji,-Gi,Gi,ji];ho._matMult(Oi),Io._matMult(Oi),yo._matMult(Oi),Qi._matMult(Oi)}var si=Wa.stretch+Wa.fixed,Yi=mi.stretch+mi.fixed,Ko=wi.stretch+wi.fixed,cs=Pi.stretch+Pi.fixed;return{tl:ho,tr:Io,bl:yo,br:Qi,tex:{x:ye.paddedRect.x+1+si,y:ye.paddedRect.y+1+Ko,w:Yi-si,h:cs-Ko},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ba,pixelOffsetBR:ti,minFontScaleX:jn/Ee/ct,minFontScaleY:Wn/Ee/mt,isSDF:Y}};if(ae&&(ye.stretchX||ye.stretchY))for(var $n=vh(Dt,Ir,sr),ma=vh(Wt,Pr,br),pa=0;pa<$n.length-1;pa++)for(var ca=$n[pa],ei=$n[pa+1],qa=0;qa<ma.length-1;qa++){var ni=ma[qa],Ta=ma[qa+1];pe.push(la(ca,ni,ei,Ta))}else pe.push(la({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Ne+1},{fixed:0,stretch:Qe+1}));return pe}function ru(M,O,Y){for(var ae=0,pe=0,ye=M;pe<ye.length;pe+=1){var Ee=ye[pe];ae+=Math.max(O,Math.min(Y,Ee[1]))-Math.max(O,Math.min(Y,Ee[0]))}return ae}function vh(M,O,Y){for(var ae=[{fixed:-1,stretch:0}],pe=0,ye=M;pe<ye.length;pe+=1){var Ee=ye[pe],Ne=Ee[0],Qe=Ee[1],ct=ae[ae.length-1];ae.push({fixed:Ne-ct.stretch,stretch:ct.stretch}),ae.push({fixed:Ne-ct.stretch,stretch:ct.stretch+(Qe-Ne)})}return ae.push({fixed:O+1,stretch:Y}),ae}function nu(M,O,Y,ae){return M/O*Y+ae}function au(M,O,Y,ae){return M-O*Y/ae}var iu=function(M,O,Y,ae,pe,ye,Ee,Ne,Qe,ct){if(this.boxStartIndex=M.length,Qe){var mt=ye.top,Dt=ye.bottom,Wt=ye.collisionPadding;Wt&&(mt-=Wt[1],Dt+=Wt[3]);var Vt=Dt-mt;Vt>0&&(Vt=Math.max(10,Vt),this.circleDiameter=Vt)}else{var sr=ye.top*Ee-Ne,br=ye.bottom*Ee+Ne,Ir=ye.left*Ee-Ne,Pr=ye.right*Ee+Ne,Vr=ye.collisionPadding;if(Vr&&(Ir-=Vr[0]*Ee,sr-=Vr[1]*Ee,Pr+=Vr[2]*Ee,br+=Vr[3]*Ee),ct){var Hr=new r(Ir,sr),Xr=new r(Pr,sr),un=new r(Ir,br),bn=new r(Pr,br),jn=ct*Math.PI/180;Hr._rotate(jn),Xr._rotate(jn),un._rotate(jn),bn._rotate(jn),Ir=Math.min(Hr.x,Xr.x,un.x,bn.x),Pr=Math.max(Hr.x,Xr.x,un.x,bn.x),sr=Math.min(Hr.y,Xr.y,un.y,bn.y),br=Math.max(Hr.y,Xr.y,un.y,bn.y)}M.emplaceBack(O.x,O.y,Ir,sr,Pr,br,Y,ae,pe)}this.boxEndIndex=M.length},Kl=function(M,O){if(M===void 0&&(M=[]),O===void 0&&(O=Fd),this.data=M,this.length=this.data.length,this.compare=O,this.length>0)for(var Y=(this.length>>1)-1;Y>=0;Y--)this._down(Y)};function Fd(M,O){return M<O?-1:M>O?1:0}function Bd(M,O,Y){O===void 0&&(O=1),Y===void 0&&(Y=!1);for(var ae=1/0,pe=1/0,ye=-1/0,Ee=-1/0,Ne=M[0],Qe=0;Qe<Ne.length;Qe++){var ct=Ne[Qe];(!Qe||ct.x<ae)&&(ae=ct.x),(!Qe||ct.y<pe)&&(pe=ct.y),(!Qe||ct.x>ye)&&(ye=ct.x),(!Qe||ct.y>Ee)&&(Ee=ct.y)}var mt=ye-ae,Dt=Ee-pe,Wt=Math.min(mt,Dt),Vt=Wt/2,sr=new Kl([],Nd);if(Wt===0)return new r(ae,pe);for(var br=ae;br<ye;br+=Wt)for(var Ir=pe;Ir<Ee;Ir+=Wt)sr.push(new Ql(br+Vt,Ir+Vt,Vt,M));for(var Pr=function(Xr){for(var un=0,bn=0,jn=0,Bn=Xr[0],Wn=0,sa=Bn.length,la=sa-1;Wn<sa;la=Wn++){var $n=Bn[Wn],ma=Bn[la],pa=$n.x*ma.y-ma.x*$n.y;bn+=($n.x+ma.x)*pa,jn+=($n.y+ma.y)*pa,un+=3*pa}return new Ql(bn/un,jn/un,0,Xr)}(M),Vr=sr.length;sr.length;){var Hr=sr.pop();(Hr.d>Pr.d||!Pr.d)&&(Pr=Hr,Y&&console.log("found best %d after %d probes",Math.round(1e4*Hr.d)/1e4,Vr)),Hr.max-Pr.d<=O||(Vt=Hr.h/2,sr.push(new Ql(Hr.p.x-Vt,Hr.p.y-Vt,Vt,M)),sr.push(new Ql(Hr.p.x+Vt,Hr.p.y-Vt,Vt,M)),sr.push(new Ql(Hr.p.x-Vt,Hr.p.y+Vt,Vt,M)),sr.push(new Ql(Hr.p.x+Vt,Hr.p.y+Vt,Vt,M)),Vr+=4)}return Y&&(console.log("num probes: "+Vr),console.log("best distance: "+Pr.d)),Pr.p}function Nd(M,O){return O.max-M.max}function Ql(M,O,Y,ae){this.p=new r(M,O),this.h=Y,this.d=function(pe,ye){for(var Ee=!1,Ne=1/0,Qe=0;Qe<ye.length;Qe++)for(var ct=ye[Qe],mt=0,Dt=ct.length,Wt=Dt-1;mt<Dt;Wt=mt++){var Vt=ct[mt],sr=ct[Wt];Vt.y>pe.y!=sr.y>pe.y&&pe.x<(sr.x-Vt.x)*(pe.y-Vt.y)/(sr.y-Vt.y)+Vt.x&&(Ee=!Ee),Ne=Math.min(Ne,Qs(pe,Vt,sr))}return(Ee?1:-1)*Math.sqrt(Ne)}(this.p,ae),this.max=this.d+this.h*Math.SQRT2}Kl.prototype.push=function(M){this.data.push(M),this.length++,this._up(this.length-1)},Kl.prototype.pop=function(){if(this.length!==0){var M=this.data[0],O=this.data.pop();return this.length--,this.length>0&&(this.data[0]=O,this._down(0)),M}},Kl.prototype.peek=function(){return this.data[0]},Kl.prototype._up=function(M){for(var O=this.data,Y=this.compare,ae=O[M];M>0;){var pe=M-1>>1,ye=O[pe];if(Y(ae,ye)>=0)break;O[M]=ye,M=pe}O[M]=ae},Kl.prototype._down=function(M){for(var O=this.data,Y=this.compare,ae=this.length>>1,pe=O[M];M<ae;){var ye=1+(M<<1),Ee=O[ye],Ne=ye+1;if(Ne<this.length&&Y(O[Ne],Ee)<0&&(ye=Ne,Ee=O[Ne]),Y(Ee,pe)>=0)break;O[M]=Ee,M=ye}O[M]=pe};var ef=Number.POSITIVE_INFINITY;function yh(M,O){return O[1]!==ef?function(Y,ae,pe){var ye=0,Ee=0;switch(ae=Math.abs(ae),pe=Math.abs(pe),Y){case"top-right":case"top-left":case"top":Ee=pe-7;break;case"bottom-right":case"bottom-left":case"bottom":Ee=7-pe}switch(Y){case"top-right":case"bottom-right":case"right":ye=-ae;break;case"top-left":case"bottom-left":case"left":ye=ae}return[ye,Ee]}(M,O[0],O[1]):function(Y,ae){var pe=0,ye=0;ae<0&&(ae=0);var Ee=ae/Math.sqrt(2);switch(Y){case"top-right":case"top-left":ye=Ee-7;break;case"bottom-right":case"bottom-left":ye=7-Ee;break;case"bottom":ye=7-ae;break;case"top":ye=ae-7}switch(Y){case"top-right":case"bottom-right":pe=-Ee;break;case"top-left":case"bottom-left":pe=Ee;break;case"left":pe=ae;break;case"right":pe=-ae}return[pe,ye]}(M,O[0])}function tf(M){switch(M){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function xh(M,O,Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt,sr){var br=function(Xr,un,bn,jn,Bn,Wn,sa,la){for(var $n=jn.layout.get("text-rotate").evaluate(Wn,{})*Math.PI/180,ma=[],pa=0,ca=un.positionedLines;pa<ca.length;pa+=1)for(var ei=ca[pa],qa=0,ni=ei.positionedGlyphs;qa<ni.length;qa+=1){var Ta=ni[qa];if(Ta.rect){var Wa=Ta.rect||{},wi=4,mi=!0,Pi=1,gi=0,fo=(Bn||la)&&Ta.vertical,Ii=Ta.metrics.advance*Ta.scale/2;if(la&&un.verticalizable){var No=24*(Ta.scale-1),Eo=(24-Ta.metrics.width*Ta.scale)/2;gi=ei.lineOffset/2-(Ta.imageName?-Eo:No)}if(Ta.imageName){var Po=sa[Ta.imageName];mi=Po.sdf,wi=1/(Pi=Po.pixelRatio)}var Jo=Bn?[Ta.x+Ii,Ta.y]:[0,0],Ho=Bn?[0,0]:[Ta.x+Ii+bn[0],Ta.y+bn[1]-gi],ho=[0,0];fo&&(ho=Ho,Ho=[0,0]);var Io=(Ta.metrics.left-wi)*Ta.scale-Ii+Ho[0],Qi=(-Ta.metrics.top-wi)*Ta.scale+Ho[1],yo=Io+Wa.w*Ta.scale/Pi,Ba=Qi+Wa.h*Ta.scale/Pi,ti=new r(Io,Qi),qi=new r(yo,Qi),Gi=new r(Io,Ba),ji=new r(yo,Ba);if(fo){var Oi=new r(-Ii,Ii- -17),si=-Math.PI/2,Yi=12-Ii,Ko=Ta.imageName?Yi:0,cs=new r(22-Yi,-Ko),qo=new(Function.prototype.bind.apply(r,[null].concat(ho)));ti._rotateAround(si,Oi)._add(cs)._add(qo),qi._rotateAround(si,Oi)._add(cs)._add(qo),Gi._rotateAround(si,Oi)._add(cs)._add(qo),ji._rotateAround(si,Oi)._add(cs)._add(qo)}if($n){var Bs=Math.sin($n),nl=Math.cos($n),Lo=[nl,-Bs,Bs,nl];ti._matMult(Lo),qi._matMult(Lo),Gi._matMult(Lo),ji._matMult(Lo)}var Ns=new r(0,0),js=new r(0,0);ma.push({tl:ti,tr:qi,bl:Gi,br:ji,tex:Wa,writingMode:un.writingMode,glyphOffset:Jo,sectionIndex:Ta.sectionIndex,isSDF:mi,pixelOffsetTL:Ns,pixelOffsetBR:js,minFontScaleX:0,minFontScaleY:0})}}return ma}(0,Y,Ne,pe,ye,Ee,ae,M.allowVerticalPlacement),Ir=M.textSizeData,Pr=null;Ir.kind==="source"?(Pr=[128*pe.layout.get("text-size").evaluate(Ee,{})])[0]>32640&&A(M.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Ir.kind==="composite"&&((Pr=[128*Vt.compositeTextSizes[0].evaluate(Ee,{},sr),128*Vt.compositeTextSizes[1].evaluate(Ee,{},sr)])[0]>32640||Pr[1]>32640)&&A(M.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),M.addSymbols(M.text,br,Pr,Ne,ye,Ee,ct,O,Qe.lineStartIndex,Qe.lineLength,Wt,sr);for(var Vr=0,Hr=mt;Vr<Hr.length;Vr+=1)Dt[Hr[Vr]]=M.text.placedSymbolArray.length-1;return 4*br.length}function bh(M){for(var O in M)return M[O];return null}function jd(M,O,Y,ae){var pe=M.compareText;if(O in pe){for(var ye=pe[O],Ee=ye.length-1;Ee>=0;Ee--)if(ae.dist(ye[Ee])<Y)return!0}else pe[O]=[];return pe[O].push(ae),!1}var Ud=Yl.VectorTileFeature.types,Vd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ou(M,O,Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt){var Vt=Ne?Math.min(32640,Math.round(Ne[0])):0,sr=Ne?Math.min(32640,Math.round(Ne[1])):0;M.emplaceBack(O,Y,Math.round(32*ae),Math.round(32*pe),ye,Ee,(Vt<<1)+(Qe?1:0),sr,16*ct,16*mt,256*Dt,256*Wt)}function rf(M,O,Y){M.emplaceBack(O.x,O.y,Y),M.emplaceBack(O.x,O.y,Y),M.emplaceBack(O.x,O.y,Y),M.emplaceBack(O.x,O.y,Y)}function Hd(M){for(var O=0,Y=M.sections;O<Y.length;O+=1)if(aa(Y[O].text))return!0;return!1}var $l=function(M){this.layoutVertexArray=new zs,this.indexArray=new so,this.programConfigurations=M,this.segments=new zt,this.dynamicLayoutVertexArray=new ps,this.opacityVertexArray=new cl,this.placedSymbolArray=new Ve};$l.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},$l.prototype.upload=function(M,O,Y,ae){this.isEmpty()||(Y&&(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,Ju.members),this.indexBuffer=M.createIndexBuffer(this.indexArray,O),this.dynamicLayoutVertexBuffer=M.createVertexBuffer(this.dynamicLayoutVertexArray,gd.members,!0),this.opacityVertexBuffer=M.createVertexBuffer(this.opacityVertexArray,Vd,!0),this.opacityVertexBuffer.itemSize=1),(Y||ae)&&this.programConfigurations.upload(M))},$l.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Kr("SymbolBuffers",$l);var Lc=function(M,O,Y){this.layoutVertexArray=new M,this.layoutAttributes=O,this.indexArray=new Y,this.segments=new zt,this.collisionVertexArray=new Ds};Lc.prototype.upload=function(M){this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=M.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=M.createVertexBuffer(this.collisionVertexArray,vd.members,!0)},Lc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Kr("CollisionBuffers",Lc);var hi=function(M){this.collisionBoxArray=M.collisionBoxArray,this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(Ee){return Ee.id}),this.index=M.index,this.pixelRatio=M.pixelRatio,this.sourceLayerIndex=M.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=yc([]),this.placementViewportMatrix=yc([]);var O=this.layers[0]._unevaluatedLayout._values;this.textSizeData=$u(this.zoom,O["text-size"]),this.iconSizeData=$u(this.zoom,O["icon-size"]);var Y=this.layers[0].layout,ae=Y.get("symbol-sort-key"),pe=Y.get("symbol-z-order");this.sortFeaturesByKey=pe!=="viewport-y"&&ae.constantOr(1)!==void 0;var ye=pe==="viewport-y"||pe==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=ye&&(Y.get("text-allow-overlap")||Y.get("icon-allow-overlap")||Y.get("text-ignore-placement")||Y.get("icon-ignore-placement")),Y.get("symbol-placement")==="point"&&(this.writingModes=Y.get("text-writing-mode").map(function(Ee){return ds[Ee]})),this.stateDependentLayerIds=this.layers.filter(function(Ee){return Ee.isStateDependent()}).map(function(Ee){return Ee.id}),this.sourceID=M.sourceID};hi.prototype.createArrays=function(){this.text=new $l(new di(Ju.members,this.layers,this.zoom,function(M){return/^text/.test(M)})),this.icon=new $l(new di(Ju.members,this.layers,this.zoom,function(M){return/^icon/.test(M)})),this.glyphOffsetArray=new bt,this.lineVertexArray=new Et,this.symbolInstances=new at},hi.prototype.calculateGlyphDependencies=function(M,O,Y,ae,pe){for(var ye=0;ye<M.length;ye++)if(O[M.charCodeAt(ye)]=!0,(Y||ae)&&pe){var Ee=Ac[M.charAt(ye)];Ee&&(O[Ee.charCodeAt(0)]=!0)}},hi.prototype.populate=function(M,O,Y){var ae=this.layers[0],pe=ae.layout,ye=pe.get("text-font"),Ee=pe.get("text-field"),Ne=pe.get("icon-image"),Qe=(Ee.value.kind!=="constant"||Ee.value.value instanceof hr&&!Ee.value.value.isEmpty()||Ee.value.value.toString().length>0)&&(ye.value.kind!=="constant"||ye.value.value.length>0),ct=Ne.value.kind!=="constant"||!!Ne.value.value||Object.keys(Ne.parameters).length>0,mt=pe.get("symbol-sort-key");if(this.features=[],Qe||ct){for(var Dt=O.iconDependencies,Wt=O.glyphDependencies,Vt=O.availableImages,sr=new ii(this.zoom),br=0,Ir=M;br<Ir.length;br+=1){var Pr=Ir[br],Vr=Pr.feature,Hr=Pr.id,Xr=Pr.index,un=Pr.sourceLayerIndex,bn=ae._featureFilter.needGeometry,jn={type:Vr.type,id:Hr,properties:Vr.properties,geometry:bn?bi(Vr):[]};if(ae._featureFilter.filter(sr,jn,Y)){bn||(jn.geometry=bi(Vr));var Bn=void 0;if(Qe){var Wn=ae.getValueAndResolveTokens("text-field",jn,Y,Vt),sa=hr.factory(Wn);Hd(sa)&&(this.hasRTLText=!0),(!this.hasRTLText||Xi()==="unavailable"||this.hasRTLText&&vo.isParsed())&&(Bn=xd(sa,ae,jn))}var la=void 0;if(ct){var $n=ae.getValueAndResolveTokens("icon-image",jn,Y,Vt);la=$n instanceof vr?$n:vr.fromString($n)}if(Bn||la){var ma=this.sortFeaturesByKey?mt.evaluate(jn,{},Y):void 0,pa={id:Hr,text:Bn,icon:la,index:Xr,sourceLayerIndex:un,geometry:bi(Vr),properties:Vr.properties,type:Ud[Vr.type],sortKey:ma};if(this.features.push(pa),la&&(Dt[la.name]=!0),Bn){var ca=ye.evaluate(jn,{},Y).join(","),ei=pe.get("text-rotation-alignment")==="map"&&pe.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ds.vertical)>=0;for(var qa=0,ni=Bn.sections;qa<ni.length;qa+=1){var Ta=ni[qa];if(Ta.image)Dt[Ta.image.name]=!0;else{var Wa=Ra(Bn.toString()),wi=Ta.fontStack||ca,mi=Wt[wi]=Wt[wi]||{};this.calculateGlyphDependencies(Ta.text,mi,ei,this.allowVerticalPlacement,Wa)}}}}}}pe.get("symbol-placement")==="line"&&(this.features=function(Pi){var gi={},fo={},Ii=[],No=0;function Eo(ji){Ii.push(Pi[ji]),No++}function Po(ji,Oi,si){var Yi=fo[ji];return delete fo[ji],fo[Oi]=Yi,Ii[Yi].geometry[0].pop(),Ii[Yi].geometry[0]=Ii[Yi].geometry[0].concat(si[0]),Yi}function Jo(ji,Oi,si){var Yi=gi[Oi];return delete gi[Oi],gi[ji]=Yi,Ii[Yi].geometry[0].shift(),Ii[Yi].geometry[0]=si[0].concat(Ii[Yi].geometry[0]),Yi}function Ho(ji,Oi,si){var Yi=si?Oi[0][Oi[0].length-1]:Oi[0][0];return ji+":"+Yi.x+":"+Yi.y}for(var ho=0;ho<Pi.length;ho++){var Io=Pi[ho],Qi=Io.geometry,yo=Io.text?Io.text.toString():null;if(yo){var Ba=Ho(yo,Qi),ti=Ho(yo,Qi,!0);if(Ba in fo&&ti in gi&&fo[Ba]!==gi[ti]){var qi=Jo(Ba,ti,Qi),Gi=Po(Ba,ti,Ii[qi].geometry);delete gi[Ba],delete fo[ti],fo[Ho(yo,Ii[Gi].geometry,!0)]=Gi,Ii[qi].geometry=null}else Ba in fo?Po(Ba,ti,Qi):ti in gi?Jo(Ba,ti,Qi):(Eo(ho),gi[Ba]=No-1,fo[ti]=No-1)}else Eo(ho)}return Ii.filter(function(ji){return ji.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Pi,gi){return Pi.sortKey-gi.sortKey})}},hi.prototype.update=function(M,O,Y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(M,O,this.layers,Y),this.icon.programConfigurations.updatePaintArrays(M,O,this.layers,Y))},hi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},hi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},hi.prototype.upload=function(M){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(M),this.iconCollisionBox.upload(M)),this.text.upload(M,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(M,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},hi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},hi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},hi.prototype.addToLineVertexArray=function(M,O){var Y=this.lineVertexArray.length;if(M.segment!==void 0){for(var ae=M.dist(O[M.segment+1]),pe=M.dist(O[M.segment]),ye={},Ee=M.segment+1;Ee<O.length;Ee++)ye[Ee]={x:O[Ee].x,y:O[Ee].y,tileUnitDistanceFromAnchor:ae},Ee<O.length-1&&(ae+=O[Ee+1].dist(O[Ee]));for(var Ne=M.segment||0;Ne>=0;Ne--)ye[Ne]={x:O[Ne].x,y:O[Ne].y,tileUnitDistanceFromAnchor:pe},Ne>0&&(pe+=O[Ne-1].dist(O[Ne]));for(var Qe=0;Qe<O.length;Qe++){var ct=ye[Qe];this.lineVertexArray.emplaceBack(ct.x,ct.y,ct.tileUnitDistanceFromAnchor)}}return{lineStartIndex:Y,lineLength:this.lineVertexArray.length-Y}},hi.prototype.addSymbols=function(M,O,Y,ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt){for(var Wt=M.indexArray,Vt=M.layoutVertexArray,sr=M.segments.prepareSegment(4*O.length,Vt,Wt,ye.sortKey),br=this.glyphOffsetArray.length,Ir=sr.vertexLength,Pr=this.allowVerticalPlacement&&Ee===ds.vertical?Math.PI/2:0,Vr=ye.text&&ye.text.sections,Hr=0;Hr<O.length;Hr++){var Xr=O[Hr],un=Xr.tl,bn=Xr.tr,jn=Xr.bl,Bn=Xr.br,Wn=Xr.tex,sa=Xr.pixelOffsetTL,la=Xr.pixelOffsetBR,$n=Xr.minFontScaleX,ma=Xr.minFontScaleY,pa=Xr.glyphOffset,ca=Xr.isSDF,ei=Xr.sectionIndex,qa=sr.vertexLength,ni=pa[1];ou(Vt,Ne.x,Ne.y,un.x,ni+un.y,Wn.x,Wn.y,Y,ca,sa.x,sa.y,$n,ma),ou(Vt,Ne.x,Ne.y,bn.x,ni+bn.y,Wn.x+Wn.w,Wn.y,Y,ca,la.x,sa.y,$n,ma),ou(Vt,Ne.x,Ne.y,jn.x,ni+jn.y,Wn.x,Wn.y+Wn.h,Y,ca,sa.x,la.y,$n,ma),ou(Vt,Ne.x,Ne.y,Bn.x,ni+Bn.y,Wn.x+Wn.w,Wn.y+Wn.h,Y,ca,la.x,la.y,$n,ma),rf(M.dynamicLayoutVertexArray,Ne,Pr),Wt.emplaceBack(qa,qa+1,qa+2),Wt.emplaceBack(qa+1,qa+2,qa+3),sr.vertexLength+=4,sr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(pa[0]),Hr!==O.length-1&&ei===O[Hr+1].sectionIndex||M.programConfigurations.populatePaintArrays(Vt.length,ye,ye.index,{},Dt,Vr&&Vr[ei])}M.placedSymbolArray.emplaceBack(Ne.x,Ne.y,br,this.glyphOffsetArray.length-br,Ir,Qe,ct,Ne.segment,Y?Y[0]:0,Y?Y[1]:0,ae[0],ae[1],Ee,0,!1,0,mt)},hi.prototype._addCollisionDebugVertex=function(M,O,Y,ae,pe,ye){return O.emplaceBack(0,0),M.emplaceBack(Y.x,Y.y,ae,pe,Math.round(ye.x),Math.round(ye.y))},hi.prototype.addCollisionDebugVertices=function(M,O,Y,ae,pe,ye,Ee){var Ne=pe.segments.prepareSegment(4,pe.layoutVertexArray,pe.indexArray),Qe=Ne.vertexLength,ct=pe.layoutVertexArray,mt=pe.collisionVertexArray,Dt=Ee.anchorX,Wt=Ee.anchorY;this._addCollisionDebugVertex(ct,mt,ye,Dt,Wt,new r(M,O)),this._addCollisionDebugVertex(ct,mt,ye,Dt,Wt,new r(Y,O)),this._addCollisionDebugVertex(ct,mt,ye,Dt,Wt,new r(Y,ae)),this._addCollisionDebugVertex(ct,mt,ye,Dt,Wt,new r(M,ae)),Ne.vertexLength+=4;var Vt=pe.indexArray;Vt.emplaceBack(Qe,Qe+1),Vt.emplaceBack(Qe+1,Qe+2),Vt.emplaceBack(Qe+2,Qe+3),Vt.emplaceBack(Qe+3,Qe),Ne.primitiveLength+=4},hi.prototype.addDebugCollisionBoxes=function(M,O,Y,ae){for(var pe=M;pe<O;pe++){var ye=this.collisionBoxArray.get(pe),Ee=ye.x1,Ne=ye.y1,Qe=ye.x2,ct=ye.y2;this.addCollisionDebugVertices(Ee,Ne,Qe,ct,ae?this.textCollisionBox:this.iconCollisionBox,ye.anchorPoint,Y)}},hi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Lc(ws,Qf.members,F),this.iconCollisionBox=new Lc(ws,Qf.members,F);for(var M=0;M<this.symbolInstances.length;M++){var O=this.symbolInstances.get(M);this.addDebugCollisionBoxes(O.textBoxStartIndex,O.textBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.iconBoxStartIndex,O.iconBoxEndIndex,O,!1),this.addDebugCollisionBoxes(O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,!1)}},hi.prototype._deserializeCollisionBoxesForSymbol=function(M,O,Y,ae,pe,ye,Ee,Ne,Qe){for(var ct={},mt=O;mt<Y;mt++){var Dt=M.get(mt);ct.textBox={x1:Dt.x1,y1:Dt.y1,x2:Dt.x2,y2:Dt.y2,anchorPointX:Dt.anchorPointX,anchorPointY:Dt.anchorPointY},ct.textFeatureIndex=Dt.featureIndex;break}for(var Wt=ae;Wt<pe;Wt++){var Vt=M.get(Wt);ct.verticalTextBox={x1:Vt.x1,y1:Vt.y1,x2:Vt.x2,y2:Vt.y2,anchorPointX:Vt.anchorPointX,anchorPointY:Vt.anchorPointY},ct.verticalTextFeatureIndex=Vt.featureIndex;break}for(var sr=ye;sr<Ee;sr++){var br=M.get(sr);ct.iconBox={x1:br.x1,y1:br.y1,x2:br.x2,y2:br.y2,anchorPointX:br.anchorPointX,anchorPointY:br.anchorPointY},ct.iconFeatureIndex=br.featureIndex;break}for(var Ir=Ne;Ir<Qe;Ir++){var Pr=M.get(Ir);ct.verticalIconBox={x1:Pr.x1,y1:Pr.y1,x2:Pr.x2,y2:Pr.y2,anchorPointX:Pr.anchorPointX,anchorPointY:Pr.anchorPointY},ct.verticalIconFeatureIndex=Pr.featureIndex;break}return ct},hi.prototype.deserializeCollisionBoxes=function(M){this.collisionArrays=[];for(var O=0;O<this.symbolInstances.length;O++){var Y=this.symbolInstances.get(O);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(M,Y.textBoxStartIndex,Y.textBoxEndIndex,Y.verticalTextBoxStartIndex,Y.verticalTextBoxEndIndex,Y.iconBoxStartIndex,Y.iconBoxEndIndex,Y.verticalIconBoxStartIndex,Y.verticalIconBoxEndIndex))}},hi.prototype.hasTextData=function(){return this.text.segments.get().length>0},hi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},hi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},hi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},hi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},hi.prototype.addIndicesForPlacedSymbol=function(M,O){for(var Y=M.placedSymbolArray.get(O),ae=Y.vertexStartIndex+4*Y.numGlyphs,pe=Y.vertexStartIndex;pe<ae;pe+=4)M.indexArray.emplaceBack(pe,pe+1,pe+2),M.indexArray.emplaceBack(pe+1,pe+2,pe+3)},hi.prototype.getSortedSymbolIndexes=function(M){if(this.sortedAngle===M&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var O=Math.sin(M),Y=Math.cos(M),ae=[],pe=[],ye=[],Ee=0;Ee<this.symbolInstances.length;++Ee){ye.push(Ee);var Ne=this.symbolInstances.get(Ee);ae.push(0|Math.round(O*Ne.anchorX+Y*Ne.anchorY)),pe.push(Ne.featureIndex)}return ye.sort(function(Qe,ct){return ae[Qe]-ae[ct]||pe[ct]-pe[Qe]}),ye},hi.prototype.addToSortKeyRanges=function(M,O){var Y=this.sortKeyRanges[this.sortKeyRanges.length-1];Y&&Y.sortKey===O?Y.symbolInstanceEnd=M+1:this.sortKeyRanges.push({sortKey:O,symbolInstanceStart:M,symbolInstanceEnd:M+1})},hi.prototype.sortFeatures=function(M){var O=this;if(this.sortFeaturesByY&&this.sortedAngle!==M&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(M),this.sortedAngle=M,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var Y=0,ae=this.symbolInstanceIndexes;Y<ae.length;Y+=1){var pe=ae[Y],ye=this.symbolInstances.get(pe);this.featureSortOrder.push(ye.featureIndex),[ye.rightJustifiedTextSymbolIndex,ye.centerJustifiedTextSymbolIndex,ye.leftJustifiedTextSymbolIndex].forEach(function(Ee,Ne,Qe){Ee>=0&&Qe.indexOf(Ee)===Ne&&O.addIndicesForPlacedSymbol(O.text,Ee)}),ye.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,ye.verticalPlacedTextSymbolIndex),ye.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,ye.placedIconSymbolIndex),ye.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,ye.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Kr("SymbolBucket",hi,{omit:["layers","collisionBoxArray","features","compareText"]}),hi.MAX_GLYPHS=65535,hi.addDynamicAttributes=rf;var qd=new Ro({"symbol-placement":new fa(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new fa(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new fa(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ba(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new fa(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new fa(xe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new fa(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new fa(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new fa(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new ba(xe.layout_symbol["icon-size"]),"icon-text-fit":new fa(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fa(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new ba(xe.layout_symbol["icon-image"]),"icon-rotate":new ba(xe.layout_symbol["icon-rotate"]),"icon-padding":new fa(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new fa(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new ba(xe.layout_symbol["icon-offset"]),"icon-anchor":new ba(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new fa(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new fa(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new fa(xe.layout_symbol["text-rotation-alignment"]),"text-field":new ba(xe.layout_symbol["text-field"]),"text-font":new ba(xe.layout_symbol["text-font"]),"text-size":new ba(xe.layout_symbol["text-size"]),"text-max-width":new ba(xe.layout_symbol["text-max-width"]),"text-line-height":new fa(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new ba(xe.layout_symbol["text-letter-spacing"]),"text-justify":new ba(xe.layout_symbol["text-justify"]),"text-radial-offset":new ba(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new fa(xe.layout_symbol["text-variable-anchor"]),"text-anchor":new ba(xe.layout_symbol["text-anchor"]),"text-max-angle":new fa(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new fa(xe.layout_symbol["text-writing-mode"]),"text-rotate":new ba(xe.layout_symbol["text-rotate"]),"text-padding":new fa(xe.layout_symbol["text-padding"]),"text-keep-upright":new fa(xe.layout_symbol["text-keep-upright"]),"text-transform":new ba(xe.layout_symbol["text-transform"]),"text-offset":new ba(xe.layout_symbol["text-offset"]),"text-allow-overlap":new fa(xe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new fa(xe.layout_symbol["text-ignore-placement"]),"text-optional":new fa(xe.layout_symbol["text-optional"])}),nf={paint:new Ro({"icon-opacity":new ba(xe.paint_symbol["icon-opacity"]),"icon-color":new ba(xe.paint_symbol["icon-color"]),"icon-halo-color":new ba(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new ba(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ba(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new fa(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new fa(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new ba(xe.paint_symbol["text-opacity"]),"text-color":new ba(xe.paint_symbol["text-color"],{runtimeType:wt,getOverride:function(M){return M.textColor},hasOverride:function(M){return!!M.textColor}}),"text-halo-color":new ba(xe.paint_symbol["text-halo-color"]),"text-halo-width":new ba(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new ba(xe.paint_symbol["text-halo-blur"]),"text-translate":new fa(xe.paint_symbol["text-translate"]),"text-translate-anchor":new fa(xe.paint_symbol["text-translate-anchor"])}),layout:qd},ec=function(M){this.type=M.property.overrides?M.property.overrides.runtimeType:Pt,this.defaultValue=M};ec.prototype.evaluate=function(M){if(M.formattedSection){var O=this.defaultValue.property.overrides;if(O&&O.hasOverride(M.formattedSection))return O.getOverride(M.formattedSection)}return M.feature&&M.featureState?this.defaultValue.evaluate(M.feature,M.featureState):this.defaultValue.property.specification.default},ec.prototype.eachChild=function(M){this.defaultValue.isConstant()||M(this.defaultValue.value._styleExpression.expression)},ec.prototype.outputDefined=function(){return!1},ec.prototype.serialize=function(){return null},Kr("FormatSectionOverride",ec,{omit:["defaultValue"]});var Gd=function(M){function O(Y){M.call(this,Y,nf)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.recalculate=function(Y,ae){if(M.prototype.recalculate.call(this,Y,ae),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var pe=this.layout.get("text-writing-mode");if(pe){for(var ye=[],Ee=0,Ne=pe;Ee<Ne.length;Ee+=1){var Qe=Ne[Ee];ye.indexOf(Qe)<0&&ye.push(Qe)}this.layout._values["text-writing-mode"]=ye}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},O.prototype.getValueAndResolveTokens=function(Y,ae,pe,ye){var Ee=this.layout.get(Y).evaluate(ae,{},pe,ye),Ne=this._unevaluatedLayout._values[Y];return Ne.isDataDriven()||Kt(Ne.value)||!Ee?Ee:function(Qe,ct){return ct.replace(/{([^{}]+)}/g,function(mt,Dt){return Dt in Qe?String(Qe[Dt]):""})}(ae.properties,Ee)},O.prototype.createBucket=function(Y){return new hi(Y)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype._setPaintOverrides=function(){for(var Y=0,ae=nf.paint.overridableProperties;Y<ae.length;Y+=1){var pe=ae[Y];if(O.hasPaintOverride(this.layout,pe)){var ye=this.paint.get(pe),Ee=new ec(ye),Ne=new Xt(Ee,ye.property.specification),Qe=null;Qe=ye.value.kind==="constant"||ye.value.kind==="source"?new or("source",Ne):new mr("composite",Ne,ye.value.zoomStops,ye.value._interpolationType),this.paint._values[pe]=new Ni(ye.property,Qe,ye.parameters)}}},O.prototype._handleOverridablePaintPropertyUpdate=function(Y,ae,pe){return!(!this.layout||ae.isDataDriven()||pe.isDataDriven())&&O.hasPaintOverride(this.layout,Y)},O.hasPaintOverride=function(Y,ae){var pe=Y.get("text-field"),ye=nf.paint.properties[ae],Ee=!1,Ne=function(mt){for(var Dt=0,Wt=mt;Dt<Wt.length;Dt+=1){var Vt=Wt[Dt];if(ye.overrides&&ye.overrides.hasOverride(Vt))return void(Ee=!0)}};if(pe.value.kind==="constant"&&pe.value.value instanceof hr)Ne(pe.value.value.sections);else if(pe.value.kind==="source"){var Qe=function(mt){if(!Ee)if(mt instanceof mn&&Ur(mt.value)===nt){var Dt=mt.value;Ne(Dt.sections)}else mt instanceof gn?Ne(mt.sections):mt.eachChild(Qe)},ct=pe.value;ct._styleExpression&&Qe(ct._styleExpression.expression)}return Ee},O}(Zo),Yd={paint:new Ro({"background-color":new fa(xe.paint_background["background-color"]),"background-pattern":new Ws(xe.paint_background["background-pattern"]),"background-opacity":new fa(xe.paint_background["background-opacity"])})},Wd=function(M){function O(Y){M.call(this,Y,Yd)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Zo),Xd={paint:new Ro({"raster-opacity":new fa(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new fa(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new fa(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new fa(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new fa(xe.paint_raster["raster-saturation"]),"raster-contrast":new fa(xe.paint_raster["raster-contrast"]),"raster-resampling":new fa(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new fa(xe.paint_raster["raster-fade-duration"])})},Zd=function(M){function O(Y){M.call(this,Y,Xd)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Zo),Jd=function(M){function O(Y){M.call(this,Y,{}),this.implementation=Y}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},O.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},O.prototype.recalculate=function(){},O.prototype.updateTransitions=function(){},O.prototype.hasTransition=function(){},O.prototype.serialize=function(){},O.prototype.onAdd=function(Y){this.implementation.onAdd&&this.implementation.onAdd(Y,Y.painter.context.gl)},O.prototype.onRemove=function(Y){this.implementation.onRemove&&this.implementation.onRemove(Y,Y.painter.context.gl)},O}(Zo),Kd={circle:Rp,heatmap:Bp,hillshade:jp,fill:rd,"fill-extrusion":fd,line:md,symbol:Gd,background:Wd,raster:Zd},_h=self.HTMLImageElement,wh=self.HTMLCanvasElement,Th=self.HTMLVideoElement,kh=self.ImageData,su=self.ImageBitmap,Pl=function(M,O,Y,ae){this.context=M,this.format=Y,this.texture=M.gl.createTexture(),this.update(O,ae)};Pl.prototype.update=function(M,O,Y){var ae=M.width,pe=M.height,ye=!(this.size&&this.size[0]===ae&&this.size[1]===pe||Y),Ee=this.context,Ne=Ee.gl;if(this.useMipmap=Boolean(O&&O.useMipmap),Ne.bindTexture(Ne.TEXTURE_2D,this.texture),Ee.pixelStoreUnpackFlipY.set(!1),Ee.pixelStoreUnpack.set(1),Ee.pixelStoreUnpackPremultiplyAlpha.set(this.format===Ne.RGBA&&(!O||O.premultiply!==!1)),ye)this.size=[ae,pe],M instanceof _h||M instanceof wh||M instanceof Th||M instanceof kh||su&&M instanceof su?Ne.texImage2D(Ne.TEXTURE_2D,0,this.format,this.format,Ne.UNSIGNED_BYTE,M):Ne.texImage2D(Ne.TEXTURE_2D,0,this.format,ae,pe,0,this.format,Ne.UNSIGNED_BYTE,M.data);else{var Qe=Y||{x:0,y:0},ct=Qe.x,mt=Qe.y;M instanceof _h||M instanceof wh||M instanceof Th||M instanceof kh||su&&M instanceof su?Ne.texSubImage2D(Ne.TEXTURE_2D,0,ct,mt,Ne.RGBA,Ne.UNSIGNED_BYTE,M):Ne.texSubImage2D(Ne.TEXTURE_2D,0,ct,mt,ae,pe,Ne.RGBA,Ne.UNSIGNED_BYTE,M.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Ne.generateMipmap(Ne.TEXTURE_2D)},Pl.prototype.bind=function(M,O,Y){var ae=this.context.gl;ae.bindTexture(ae.TEXTURE_2D,this.texture),Y!==ae.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(Y=ae.LINEAR),M!==this.filter&&(ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,M),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,Y||M),this.filter=M),O!==this.wrap&&(ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_S,O),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_T,O),this.wrap=O)},Pl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Pl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var af=function(M){var O=this;this._callback=M,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){O._triggered=!1,O._callback()})};af.prototype.trigger=function(){var M=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){M._triggered=!1,M._callback()},0))},af.prototype.remove=function(){delete this._channel,this._callback=function(){}};var tc=function(M,O,Y){this.target=M,this.parent=O,this.mapId=Y,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},c(["receive","process"],this),this.invoker=new af(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=S()?M:self};function Mh(M,O,Y){var ae=2*Math.PI*6378137/256/Math.pow(2,Y);return[M*ae-2*Math.PI*6378137/2,O*ae-2*Math.PI*6378137/2]}tc.prototype.send=function(M,O,Y,ae,pe){var ye=this;pe===void 0&&(pe=!1);var Ee=Math.round(1e18*Math.random()).toString(36).substring(0,10);Y&&(this.callbacks[Ee]=Y);var Ne=R(this.globalScope)?void 0:[];return this.target.postMessage({id:Ee,type:M,hasCallback:!!Y,targetMapId:ae,mustQueue:pe,sourceMapId:this.mapId,data:ra(O,Ne)},Ne),{cancel:function(){Y&&delete ye.callbacks[Ee],ye.target.postMessage({id:Ee,type:"<cancel>",targetMapId:ae,sourceMapId:ye.mapId})}}},tc.prototype.receive=function(M){var O=M.data,Y=O.id;if(Y&&(!O.targetMapId||this.mapId===O.targetMapId))if(O.type==="<cancel>"){delete this.tasks[Y];var ae=this.cancelCallbacks[Y];delete this.cancelCallbacks[Y],ae&&ae()}else S()||O.mustQueue?(this.tasks[Y]=O,this.taskQueue.push(Y),this.invoker.trigger()):this.processTask(Y,O)},tc.prototype.process=function(){if(this.taskQueue.length){var M=this.taskQueue.shift(),O=this.tasks[M];delete this.tasks[M],this.taskQueue.length&&this.invoker.trigger(),O&&this.processTask(M,O)}},tc.prototype.processTask=function(M,O){var Y=this;if(O.type==="<response>"){var ae=this.callbacks[M];delete this.callbacks[M],ae&&(O.error?ae(ka(O.error)):ae(null,ka(O.data)))}else{var pe=!1,ye=R(this.globalScope)?void 0:[],Ee=O.hasCallback?function(mt,Dt){pe=!0,delete Y.cancelCallbacks[M],Y.target.postMessage({id:M,type:"<response>",sourceMapId:Y.mapId,error:mt?ra(mt):null,data:ra(Dt,ye)},ye)}:function(mt){pe=!0},Ne=null,Qe=ka(O.data);if(this.parent[O.type])Ne=this.parent[O.type](O.sourceMapId,Qe,Ee);else if(this.parent.getWorkerSource){var ct=O.type.split(".");Ne=this.parent.getWorkerSource(O.sourceMapId,ct[0],Qe.source)[ct[1]](Qe,Ee)}else Ee(new Error("Could not find function "+O.type));!pe&&Ne&&Ne.cancel&&(this.cancelCallbacks[M]=Ne.cancel)}},tc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var co=function(M,O){M&&(O?this.setSouthWest(M).setNorthEast(O):M.length===4?this.setSouthWest([M[0],M[1]]).setNorthEast([M[2],M[3]]):this.setSouthWest(M[0]).setNorthEast(M[1]))};co.prototype.setNorthEast=function(M){return this._ne=M instanceof Ci?new Ci(M.lng,M.lat):Ci.convert(M),this},co.prototype.setSouthWest=function(M){return this._sw=M instanceof Ci?new Ci(M.lng,M.lat):Ci.convert(M),this},co.prototype.extend=function(M){var O,Y,ae=this._sw,pe=this._ne;if(M instanceof Ci)O=M,Y=M;else{if(!(M instanceof co)){if(Array.isArray(M)){if(M.length===4||M.every(Array.isArray)){var ye=M;return this.extend(co.convert(ye))}var Ee=M;return this.extend(Ci.convert(Ee))}return this}if(O=M._sw,Y=M._ne,!O||!Y)return this}return ae||pe?(ae.lng=Math.min(O.lng,ae.lng),ae.lat=Math.min(O.lat,ae.lat),pe.lng=Math.max(Y.lng,pe.lng),pe.lat=Math.max(Y.lat,pe.lat)):(this._sw=new Ci(O.lng,O.lat),this._ne=new Ci(Y.lng,Y.lat)),this},co.prototype.getCenter=function(){return new Ci((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},co.prototype.getSouthWest=function(){return this._sw},co.prototype.getNorthEast=function(){return this._ne},co.prototype.getNorthWest=function(){return new Ci(this.getWest(),this.getNorth())},co.prototype.getSouthEast=function(){return new Ci(this.getEast(),this.getSouth())},co.prototype.getWest=function(){return this._sw.lng},co.prototype.getSouth=function(){return this._sw.lat},co.prototype.getEast=function(){return this._ne.lng},co.prototype.getNorth=function(){return this._ne.lat},co.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},co.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},co.prototype.isEmpty=function(){return!(this._sw&&this._ne)},co.prototype.contains=function(M){var O=Ci.convert(M),Y=O.lng,ae=O.lat,pe=this._sw.lat<=ae&&ae<=this._ne.lat,ye=this._sw.lng<=Y&&Y<=this._ne.lng;return this._sw.lng>this._ne.lng&&(ye=this._sw.lng>=Y&&Y>=this._ne.lng),pe&&ye},co.convert=function(M){return!M||M instanceof co?M:new co(M)};var Ci=function(M,O){if(isNaN(M)||isNaN(O))throw new Error("Invalid LngLat object: ("+M+", "+O+")");if(this.lng=+M,this.lat=+O,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ci.prototype.wrap=function(){return new Ci(f(this.lng,-180,180),this.lat)},Ci.prototype.toArray=function(){return[this.lng,this.lat]},Ci.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ci.prototype.distanceTo=function(M){var O=Math.PI/180,Y=this.lat*O,ae=M.lat*O,pe=Math.sin(Y)*Math.sin(ae)+Math.cos(Y)*Math.cos(ae)*Math.cos((M.lng-this.lng)*O);return 63710088e-1*Math.acos(Math.min(pe,1))},Ci.prototype.toBounds=function(M){M===void 0&&(M=0);var O=360*M/40075017,Y=O/Math.cos(Math.PI/180*this.lat);return new co(new Ci(this.lng-Y,this.lat-O),new Ci(this.lng+Y,this.lat+O))},Ci.convert=function(M){if(M instanceof Ci)return M;if(Array.isArray(M)&&(M.length===2||M.length===3))return new Ci(Number(M[0]),Number(M[1]));if(!Array.isArray(M)&&typeof M=="object"&&M!==null)return new Ci(Number("lng"in M?M.lng:M.lon),Number(M.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ah=2*Math.PI*63710088e-1;function Sh(M){return Ah*Math.cos(M*Math.PI/180)}function Eh(M){return(180+M)/360}function Lh(M){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+M*Math.PI/360)))/360}function Ch(M,O){return M/Sh(O)}function of(M){var O=180-360*M;return 360/Math.PI*Math.atan(Math.exp(O*Math.PI/180))-90}var Il=function(M,O,Y){Y===void 0&&(Y=0),this.x=+M,this.y=+O,this.z=+Y};Il.fromLngLat=function(M,O){O===void 0&&(O=0);var Y=Ci.convert(M);return new Il(Eh(Y.lng),Lh(Y.lat),Ch(O,Y.lat))},Il.prototype.toLngLat=function(){return new Ci(360*this.x-180,of(this.y))},Il.prototype.toAltitude=function(){return M=this.z,O=this.y,M*Sh(of(O));var M,O},Il.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ah*(M=of(this.y),1/Math.cos(M*Math.PI/180));var M};var Ol=function(M,O,Y){this.z=M,this.x=O,this.y=Y,this.key=Cc(0,M,M,O,Y)};Ol.prototype.equals=function(M){return this.z===M.z&&this.x===M.x&&this.y===M.y},Ol.prototype.url=function(M,O){var Y,ae,pe,ye,Ee,Ne=(Y=this.x,ae=this.y,pe=this.z,ye=Mh(256*Y,256*(ae=Math.pow(2,pe)-ae-1),pe),Ee=Mh(256*(Y+1),256*(ae+1),pe),ye[0]+","+ye[1]+","+Ee[0]+","+Ee[1]),Qe=function(ct,mt,Dt){for(var Wt,Vt="",sr=ct;sr>0;sr--)Vt+=(mt&(Wt=1<<sr-1)?1:0)+(Dt&Wt?2:0);return Vt}(this.z,this.x,this.y);return M[(this.x+this.y)%M.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(O==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",Qe).replace("{bbox-epsg-3857}",Ne)},Ol.prototype.getTilePoint=function(M){var O=Math.pow(2,this.z);return new r(8192*(M.x*O-this.x),8192*(M.y*O-this.y))},Ol.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Ph=function(M,O){this.wrap=M,this.canonical=O,this.key=Cc(M,O.z,O.z,O.x,O.y)},uo=function(M,O,Y,ae,pe){this.overscaledZ=M,this.wrap=O,this.canonical=new Ol(Y,+ae,+pe),this.key=Cc(O,M,Y,ae,pe)};function Cc(M,O,Y,ae,pe){(M*=2)<0&&(M=-1*M-1);var ye=1<<Y;return(ye*ye*M+ye*pe+ae).toString(36)+Y.toString(36)+O.toString(36)}uo.prototype.equals=function(M){return this.overscaledZ===M.overscaledZ&&this.wrap===M.wrap&&this.canonical.equals(M.canonical)},uo.prototype.scaledTo=function(M){var O=this.canonical.z-M;return M>this.canonical.z?new uo(M,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new uo(M,this.wrap,M,this.canonical.x>>O,this.canonical.y>>O)},uo.prototype.calculateScaledKey=function(M,O){var Y=this.canonical.z-M;return M>this.canonical.z?Cc(this.wrap*+O,M,this.canonical.z,this.canonical.x,this.canonical.y):Cc(this.wrap*+O,M,M,this.canonical.x>>Y,this.canonical.y>>Y)},uo.prototype.isChildOf=function(M){if(M.wrap!==this.wrap)return!1;var O=this.canonical.z-M.canonical.z;return M.overscaledZ===0||M.overscaledZ<this.overscaledZ&&M.canonical.x===this.canonical.x>>O&&M.canonical.y===this.canonical.y>>O},uo.prototype.children=function(M){if(this.overscaledZ>=M)return[new uo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var O=this.canonical.z+1,Y=2*this.canonical.x,ae=2*this.canonical.y;return[new uo(O,this.wrap,O,Y,ae),new uo(O,this.wrap,O,Y+1,ae),new uo(O,this.wrap,O,Y,ae+1),new uo(O,this.wrap,O,Y+1,ae+1)]},uo.prototype.isLessThan=function(M){return this.wrap<M.wrap||!(this.wrap>M.wrap)&&(this.overscaledZ<M.overscaledZ||!(this.overscaledZ>M.overscaledZ)&&(this.canonical.x<M.canonical.x||!(this.canonical.x>M.canonical.x)&&this.canonical.y<M.canonical.y))},uo.prototype.wrapped=function(){return new uo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},uo.prototype.unwrapTo=function(M){return new uo(this.overscaledZ,M,this.canonical.z,this.canonical.x,this.canonical.y)},uo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},uo.prototype.toUnwrapped=function(){return new Ph(this.wrap,this.canonical)},uo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},uo.prototype.getTilePoint=function(M){return this.canonical.getTilePoint(new Il(M.x-this.wrap,M.y))},Kr("CanonicalTileID",Ol),Kr("OverscaledTileID",uo,{omit:["posMatrix"]});var tl=function(M,O,Y){if(this.uid=M,O.height!==O.width)throw new RangeError("DEM tiles must be square");if(Y&&Y!=="mapbox"&&Y!=="terrarium")return A('"'+Y+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=O.height;var ae=this.dim=O.height-2;this.data=new Uint32Array(O.data.buffer),this.encoding=Y||"mapbox";for(var pe=0;pe<ae;pe++)this.data[this._idx(-1,pe)]=this.data[this._idx(0,pe)],this.data[this._idx(ae,pe)]=this.data[this._idx(ae-1,pe)],this.data[this._idx(pe,-1)]=this.data[this._idx(pe,0)],this.data[this._idx(pe,ae)]=this.data[this._idx(pe,ae-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ae,-1)]=this.data[this._idx(ae-1,0)],this.data[this._idx(-1,ae)]=this.data[this._idx(0,ae-1)],this.data[this._idx(ae,ae)]=this.data[this._idx(ae-1,ae-1)]};tl.prototype.get=function(M,O){var Y=new Uint8Array(this.data.buffer),ae=4*this._idx(M,O);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(Y[ae],Y[ae+1],Y[ae+2])},tl.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},tl.prototype._idx=function(M,O){if(M<-1||M>=this.dim+1||O<-1||O>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(O+1)*this.stride+(M+1)},tl.prototype._unpackMapbox=function(M,O,Y){return(256*M*256+256*O+Y)/10-1e4},tl.prototype._unpackTerrarium=function(M,O,Y){return 256*M+O+Y/256-32768},tl.prototype.getPixels=function(){return new es({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},tl.prototype.backfillBorder=function(M,O,Y){if(this.dim!==M.dim)throw new Error("dem dimension mismatch");var ae=O*this.dim,pe=O*this.dim+this.dim,ye=Y*this.dim,Ee=Y*this.dim+this.dim;switch(O){case-1:ae=pe-1;break;case 1:pe=ae+1}switch(Y){case-1:ye=Ee-1;break;case 1:Ee=ye+1}for(var Ne=-O*this.dim,Qe=-Y*this.dim,ct=ye;ct<Ee;ct++)for(var mt=ae;mt<pe;mt++)this.data[this._idx(mt,ct)]=M.data[this._idx(mt+Ne,ct+Qe)]},Kr("DEMData",tl);var lu=function(M){this._stringToNumber={},this._numberToString=[];for(var O=0;O<M.length;O++){var Y=M[O];this._stringToNumber[Y]=O,this._numberToString[O]=Y}};lu.prototype.encode=function(M){return this._stringToNumber[M]},lu.prototype.decode=function(M){return this._numberToString[M]};var cu=function(M,O,Y,ae,pe){this.type="Feature",this._vectorTileFeature=M,M._z=O,M._x=Y,M._y=ae,this.properties=M.properties,this.id=pe},sf={geometry:{configurable:!0}};sf.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},sf.geometry.set=function(M){this._geometry=M},cu.prototype.toJSON=function(){var M={geometry:this.geometry};for(var O in this)O!=="_geometry"&&O!=="_vectorTileFeature"&&(M[O]=this[O]);return M},Object.defineProperties(cu.prototype,sf);var rc=function(){this.state={},this.stateChanges={},this.deletedStates={}};rc.prototype.updateState=function(M,O,Y){var ae=String(O);if(this.stateChanges[M]=this.stateChanges[M]||{},this.stateChanges[M][ae]=this.stateChanges[M][ae]||{},l(this.stateChanges[M][ae],Y),this.deletedStates[M]===null)for(var pe in this.deletedStates[M]={},this.state[M])pe!==ae&&(this.deletedStates[M][pe]=null);else if(this.deletedStates[M]&&this.deletedStates[M][ae]===null)for(var ye in this.deletedStates[M][ae]={},this.state[M][ae])Y[ye]||(this.deletedStates[M][ae][ye]=null);else for(var Ee in Y)this.deletedStates[M]&&this.deletedStates[M][ae]&&this.deletedStates[M][ae][Ee]===null&&delete this.deletedStates[M][ae][Ee]},rc.prototype.removeFeatureState=function(M,O,Y){if(this.deletedStates[M]!==null){var ae=String(O);if(this.deletedStates[M]=this.deletedStates[M]||{},Y&&O!==void 0)this.deletedStates[M][ae]!==null&&(this.deletedStates[M][ae]=this.deletedStates[M][ae]||{},this.deletedStates[M][ae][Y]=null);else if(O!==void 0)if(this.stateChanges[M]&&this.stateChanges[M][ae])for(Y in this.deletedStates[M][ae]={},this.stateChanges[M][ae])this.deletedStates[M][ae][Y]=null;else this.deletedStates[M][ae]=null;else this.deletedStates[M]=null}},rc.prototype.getState=function(M,O){var Y=String(O),ae=this.state[M]||{},pe=this.stateChanges[M]||{},ye=l({},ae[Y],pe[Y]);if(this.deletedStates[M]===null)return{};if(this.deletedStates[M]){var Ee=this.deletedStates[M][O];if(Ee===null)return{};for(var Ne in Ee)delete ye[Ne]}return ye},rc.prototype.initializeTileState=function(M,O){M.setFeatureState(this.state,O)},rc.prototype.coalesceChanges=function(M,O){var Y={};for(var ae in this.stateChanges){this.state[ae]=this.state[ae]||{};var pe={};for(var ye in this.stateChanges[ae])this.state[ae][ye]||(this.state[ae][ye]={}),l(this.state[ae][ye],this.stateChanges[ae][ye]),pe[ye]=this.state[ae][ye];Y[ae]=pe}for(var Ee in this.deletedStates){this.state[Ee]=this.state[Ee]||{};var Ne={};if(this.deletedStates[Ee]===null)for(var Qe in this.state[Ee])Ne[Qe]={},this.state[Ee][Qe]={};else for(var ct in this.deletedStates[Ee]){if(this.deletedStates[Ee][ct]===null)this.state[Ee][ct]={};else for(var mt=0,Dt=Object.keys(this.deletedStates[Ee][ct]);mt<Dt.length;mt+=1){var Wt=Dt[mt];delete this.state[Ee][ct][Wt]}Ne[ct]=this.state[Ee][ct]}Y[Ee]=Y[Ee]||{},l(Y[Ee],Ne)}if(this.stateChanges={},this.deletedStates={},Object.keys(Y).length!==0)for(var Vt in M)M[Vt].setFeatureState(Y,O)};var rl=function(M,O){this.tileID=M,this.x=M.canonical.x,this.y=M.canonical.y,this.z=M.canonical.z,this.grid=new cn(8192,16,0),this.grid3D=new cn(8192,16,0),this.featureIndexArray=new At,this.promoteId=O};function Ih(M,O,Y,ae,pe){return _(M,function(ye,Ee){var Ne=O instanceof is?O.get(Ee):null;return Ne&&Ne.evaluate?Ne.evaluate(Y,ae,pe):Ne})}function Oh(M){for(var O=1/0,Y=1/0,ae=-1/0,pe=-1/0,ye=0,Ee=M;ye<Ee.length;ye+=1){var Ne=Ee[ye];O=Math.min(O,Ne.x),Y=Math.min(Y,Ne.y),ae=Math.max(ae,Ne.x),pe=Math.max(pe,Ne.y)}return{minX:O,minY:Y,maxX:ae,maxY:pe}}function Qd(M,O){return O-M}rl.prototype.insert=function(M,O,Y,ae,pe,ye){var Ee=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(Y,ae,pe);for(var Ne=ye?this.grid3D:this.grid,Qe=0;Qe<O.length;Qe++){for(var ct=O[Qe],mt=[1/0,1/0,-1/0,-1/0],Dt=0;Dt<ct.length;Dt++){var Wt=ct[Dt];mt[0]=Math.min(mt[0],Wt.x),mt[1]=Math.min(mt[1],Wt.y),mt[2]=Math.max(mt[2],Wt.x),mt[3]=Math.max(mt[3],Wt.y)}mt[0]<8192&&mt[1]<8192&&mt[2]>=0&&mt[3]>=0&&Ne.insert(Ee,mt[0],mt[1],mt[2],mt[3])}},rl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Yl.VectorTile(new Kc(this.rawTileData)).layers,this.sourceLayerCoder=new lu(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},rl.prototype.query=function(M,O,Y,ae){var pe=this;this.loadVTLayers();for(var ye=M.params||{},Ee=8192/M.tileSize/M.scale,Ne=Sa(ye.filter),Qe=M.queryGeometry,ct=M.queryPadding*Ee,mt=Oh(Qe),Dt=this.grid.query(mt.minX-ct,mt.minY-ct,mt.maxX+ct,mt.maxY+ct),Wt=Oh(M.cameraQueryGeometry),Vt=this.grid3D.query(Wt.minX-ct,Wt.minY-ct,Wt.maxX+ct,Wt.maxY+ct,function(un,bn,jn,Bn){return function(Wn,sa,la,$n,ma){for(var pa=0,ca=Wn;pa<ca.length;pa+=1){var ei=ca[pa];if(sa<=ei.x&&la<=ei.y&&$n>=ei.x&&ma>=ei.y)return!0}var qa=[new r(sa,la),new r(sa,ma),new r($n,ma),new r($n,la)];if(Wn.length>2){for(var ni=0,Ta=qa;ni<Ta.length;ni+=1)if(ss(Wn,Ta[ni]))return!0}for(var Wa=0;Wa<Wn.length-1;Wa++)if(El(Wn[Wa],Wn[Wa+1],qa))return!0;return!1}(M.cameraQueryGeometry,un-ct,bn-ct,jn+ct,Bn+ct)}),sr=0,br=Vt;sr<br.length;sr+=1){var Ir=br[sr];Dt.push(Ir)}Dt.sort(Qd);for(var Pr,Vr={},Hr=function(un){var bn=Dt[un];if(bn!==Pr){Pr=bn;var jn=pe.featureIndexArray.get(bn),Bn=null;pe.loadMatchingFeature(Vr,jn.bucketIndex,jn.sourceLayerIndex,jn.featureIndex,Ne,ye.layers,ye.availableImages,O,Y,ae,function(Wn,sa,la){return Bn||(Bn=bi(Wn)),sa.queryIntersectsFeature(Qe,Wn,la,Bn,pe.z,M.transform,Ee,M.pixelPosMatrix)})}},Xr=0;Xr<Dt.length;Xr++)Hr(Xr);return Vr},rl.prototype.loadMatchingFeature=function(M,O,Y,ae,pe,ye,Ee,Ne,Qe,ct,mt){var Dt=this.bucketLayerIDs[O];if(!ye||function(jn,Bn){for(var Wn=0;Wn<jn.length;Wn++)if(Bn.indexOf(jn[Wn])>=0)return!0;return!1}(ye,Dt)){var Wt=this.sourceLayerCoder.decode(Y),Vt=this.vtLayers[Wt].feature(ae);if(pe.filter(new ii(this.tileID.overscaledZ),Vt))for(var sr=this.getId(Vt,Wt),br=0;br<Dt.length;br++){var Ir=Dt[br];if(!(ye&&ye.indexOf(Ir)<0)){var Pr=Ne[Ir];if(Pr){var Vr={};sr!==void 0&&ct&&(Vr=ct.getState(Pr.sourceLayer||"_geojsonTileLayer",sr));var Hr=Qe[Ir];Hr.paint=Ih(Hr.paint,Pr.paint,Vt,Vr,Ee),Hr.layout=Ih(Hr.layout,Pr.layout,Vt,Vr,Ee);var Xr=!mt||mt(Vt,Pr,Vr);if(Xr){var un=new cu(Vt,this.z,this.x,this.y,sr);un.layer=Hr;var bn=M[Ir];bn===void 0&&(bn=M[Ir]=[]),bn.push({featureIndex:ae,feature:un,intersectionZ:Xr})}}}}}},rl.prototype.lookupSymbolFeatures=function(M,O,Y,ae,pe,ye,Ee,Ne){var Qe={};this.loadVTLayers();for(var ct=Sa(pe),mt=0,Dt=M;mt<Dt.length;mt+=1){var Wt=Dt[mt];this.loadMatchingFeature(Qe,Y,ae,Wt,ct,ye,Ee,Ne,O)}return Qe},rl.prototype.hasLayer=function(M){for(var O=0,Y=this.bucketLayerIDs;O<Y.length;O+=1)for(var ae=0,pe=Y[O];ae<pe.length;ae+=1)if(M===pe[ae])return!0;return!1},rl.prototype.getId=function(M,O){var Y=M.id;if(this.promoteId){var ae=typeof this.promoteId=="string"?this.promoteId:this.promoteId[O];typeof(Y=M.properties[ae])=="boolean"&&(Y=Number(Y))}return Y},Kr("FeatureIndex",rl,{omit:["rawTileData","sourceLayerCoder"]});var So=function(M,O){this.tileID=M,this.uid=d(),this.uses=0,this.tileSize=O,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};So.prototype.registerFadeDuration=function(M){var O=M+this.timeAdded;O<B.now()||this.fadeEndTime&&O<this.fadeEndTime||(this.fadeEndTime=O)},So.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},So.prototype.loadVectorData=function(M,O,Y){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",M){for(var ae in M.featureIndex&&(this.latestFeatureIndex=M.featureIndex,M.rawTileData?(this.latestRawTileData=M.rawTileData,this.latestFeatureIndex.rawTileData=M.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=M.collisionBoxArray,this.buckets=function(ct,mt){var Dt={};if(!mt)return Dt;for(var Wt=function(){var br=sr[Vt],Ir=br.layerIds.map(function(Xr){return mt.getLayer(Xr)}).filter(Boolean);if(Ir.length!==0){br.layers=Ir,br.stateDependentLayerIds&&(br.stateDependentLayers=br.stateDependentLayerIds.map(function(Xr){return Ir.filter(function(un){return un.id===Xr})[0]}));for(var Pr=0,Vr=Ir;Pr<Vr.length;Pr+=1){var Hr=Vr[Pr];Dt[Hr.id]=br}}},Vt=0,sr=ct;Vt<sr.length;Vt+=1)Wt();return Dt}(M.buckets,O.style),this.hasSymbolBuckets=!1,this.buckets){var pe=this.buckets[ae];if(pe instanceof hi){if(this.hasSymbolBuckets=!0,!Y)break;pe.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var ye in this.buckets){var Ee=this.buckets[ye];if(Ee instanceof hi&&Ee.hasRTLText){this.hasRTLText=!0,vo.isLoading()||vo.isLoaded()||Xi()!=="deferred"||ai();break}}for(var Ne in this.queryPadding=0,this.buckets){var Qe=this.buckets[Ne];this.queryPadding=Math.max(this.queryPadding,O.style.getLayer(Ne).queryRadius(Qe))}M.imageAtlas&&(this.imageAtlas=M.imageAtlas),M.glyphAtlasImage&&(this.glyphAtlasImage=M.glyphAtlasImage)}else this.collisionBoxArray=new we},So.prototype.unloadVectorData=function(){for(var M in this.buckets)this.buckets[M].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},So.prototype.getBucket=function(M){return this.buckets[M.id]},So.prototype.upload=function(M){for(var O in this.buckets){var Y=this.buckets[O];Y.uploadPending()&&Y.upload(M)}var ae=M.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Pl(M,this.imageAtlas.image,ae.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Pl(M,this.glyphAtlasImage,ae.ALPHA),this.glyphAtlasImage=null)},So.prototype.prepare=function(M){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(M,this.imageAtlasTexture)},So.prototype.queryRenderedFeatures=function(M,O,Y,ae,pe,ye,Ee,Ne,Qe,ct){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:ae,cameraQueryGeometry:pe,scale:ye,tileSize:this.tileSize,pixelPosMatrix:ct,transform:Ne,params:Ee,queryPadding:this.queryPadding*Qe},M,O,Y):{}},So.prototype.querySourceFeatures=function(M,O){var Y=this.latestFeatureIndex;if(Y&&Y.rawTileData){var ae=Y.loadVTLayers(),pe=O?O.sourceLayer:"",ye=ae._geojsonTileLayer||ae[pe];if(ye)for(var Ee=Sa(O&&O.filter),Ne=this.tileID.canonical,Qe=Ne.z,ct=Ne.x,mt=Ne.y,Dt={z:Qe,x:ct,y:mt},Wt=0;Wt<ye.length;Wt++){var Vt=ye.feature(Wt);if(Ee.filter(new ii(this.tileID.overscaledZ),Vt)){var sr=Y.getId(Vt,pe),br=new cu(Vt,Qe,ct,mt,sr);br.tile=Dt,M.push(br)}}}},So.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},So.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},So.prototype.setExpiryData=function(M){var O=this.expirationTime;if(M.cacheControl){var Y=E(M.cacheControl);Y["max-age"]&&(this.expirationTime=Date.now()+1e3*Y["max-age"])}else M.expires&&(this.expirationTime=new Date(M.expires).getTime());if(this.expirationTime){var ae=Date.now(),pe=!1;if(this.expirationTime>ae)pe=!1;else if(O)if(this.expirationTime<O)pe=!0;else{var ye=this.expirationTime-O;ye?this.expirationTime=ae+Math.max(ye,3e4):pe=!0}else pe=!0;pe?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},So.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},So.prototype.setFeatureState=function(M,O){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(M).length!==0){var Y=this.latestFeatureIndex.loadVTLayers();for(var ae in this.buckets)if(O.style.hasLayer(ae)){var pe=this.buckets[ae],ye=pe.layers[0].sourceLayer||"_geojsonTileLayer",Ee=Y[ye],Ne=M[ye];if(Ee&&Ne&&Object.keys(Ne).length!==0){pe.update(Ne,Ee,this.imageAtlas&&this.imageAtlas.patternPositions||{});var Qe=O&&O.style&&O.style.getLayer(ae);Qe&&(this.queryPadding=Math.max(this.queryPadding,Qe.queryRadius(pe)))}}}},So.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},So.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<B.now()},So.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},So.prototype.setHoldDuration=function(M){this.symbolFadeHoldUntil=B.now()+M},So.prototype.setDependencies=function(M,O){for(var Y={},ae=0,pe=O;ae<pe.length;ae+=1)Y[pe[ae]]=!0;this.dependencies[M]=Y},So.prototype.hasDependency=function(M,O){for(var Y=0,ae=M;Y<ae.length;Y+=1){var pe=ae[Y],ye=this.dependencies[pe];if(ye){for(var Ee=0,Ne=O;Ee<Ne.length;Ee+=1)if(ye[Ne[Ee]])return!0}}return!1};var dl=self.performance,zh=function(M){this._marks={start:[M.url,"start"].join("#"),end:[M.url,"end"].join("#"),measure:M.url.toString()},dl.mark(this._marks.start)};zh.prototype.finish=function(){dl.mark(this._marks.end);var M=dl.getEntriesByName(this._marks.measure);return M.length===0&&(dl.measure(this._marks.measure,this._marks.start,this._marks.end),M=dl.getEntriesByName(this._marks.measure),dl.clearMarks(this._marks.start),dl.clearMarks(this._marks.end),dl.clearMeasures(this._marks.measure)),M},e.Actor=tc,e.AlphaImage=Cl,e.CanonicalTileID=Ol,e.CollisionBoxArray=we,e.Color=Zt,e.DEMData=tl,e.DataConstantProperty=fa,e.DictionaryCoder=lu,e.EXTENT=8192,e.ErrorEvent=We,e.EvaluationParameters=ii,e.Event=Ue,e.Evented=he,e.FeatureIndex=rl,e.FillBucket=Rs,e.FillExtrusionBucket=Fs,e.ImageAtlas=Ec,e.ImagePosition=$c,e.LineBucket=ts,e.LngLat=Ci,e.LngLatBounds=co,e.MercatorCoordinate=Il,e.ONE_EM=24,e.OverscaledTileID=uo,e.Point=r,e.Point$1=r,e.Properties=Ro,e.Protobuf=Kc,e.RGBAImage=es,e.RequestManager=ne,e.RequestPerformance=zh,e.ResourceType=pt,e.SegmentVector=zt,e.SourceFeatureState=rc,e.StructArrayLayout1ui2=q,e.StructArrayLayout2f1f2i16=ul,e.StructArrayLayout2i4=hs,e.StructArrayLayout3ui6=so,e.StructArrayLayout4i8=zi,e.SymbolBucket=hi,e.Texture=Pl,e.Tile=So,e.Transitionable=as,e.Uniform1f=Wr,e.Uniform1i=ha,e.Uniform2f=Mn,e.Uniform3f=Kn,e.Uniform4f=Yn,e.UniformColor=ia,e.UniformMatrix4f=La,e.UnwrappedTileID=Ph,e.ValidationError=De,e.WritingMode=ds,e.ZoomHistory=Pa,e.add=function(M,O,Y){return M[0]=O[0]+Y[0],M[1]=O[1]+Y[1],M[2]=O[2]+Y[2],M},e.addDynamicAttributes=rf,e.asyncAll=function(M,O,Y){if(!M.length)return Y(null,[]);var ae=M.length,pe=new Array(M.length),ye=null;M.forEach(function(Ee,Ne){O(Ee,function(Qe,ct){Qe&&(ye=Qe),pe[Ne]=ct,--ae==0&&Y(ye,pe)})})},e.bezier=o,e.bindAll=c,e.browser=B,e.cacheEntryPossiblyAdded=function(M){++$e>Oe&&(M.getActor().send("enforceCacheSizeLimit",Re),$e=0)},e.clamp=u,e.clearTileCache=function(M){var O=self.caches.delete("mapbox-tiles");M&&O.catch(M).then(function(){return M()})},e.clipLine=mh,e.clone=function(M){var O=new $o(16);return O[0]=M[0],O[1]=M[1],O[2]=M[2],O[3]=M[3],O[4]=M[4],O[5]=M[5],O[6]=M[6],O[7]=M[7],O[8]=M[8],O[9]=M[9],O[10]=M[10],O[11]=M[11],O[12]=M[12],O[13]=M[13],O[14]=M[14],O[15]=M[15],O},e.clone$1=k,e.clone$2=function(M){var O=new $o(3);return O[0]=M[0],O[1]=M[1],O[2]=M[2],O},e.collisionCircleLayout=yd,e.config=U,e.create=function(){var M=new $o(16);return $o!=Float32Array&&(M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=0,M[12]=0,M[13]=0,M[14]=0),M[0]=1,M[5]=1,M[10]=1,M[15]=1,M},e.create$1=function(){var M=new $o(9);return $o!=Float32Array&&(M[1]=0,M[2]=0,M[3]=0,M[5]=0,M[6]=0,M[7]=0),M[0]=1,M[4]=1,M[8]=1,M},e.create$2=function(){var M=new $o(4);return $o!=Float32Array&&(M[1]=0,M[2]=0),M[0]=1,M[3]=1,M},e.createCommonjsModule=n,e.createExpression=Yt,e.createLayout=oi,e.createStyleLayer=function(M){return M.type==="custom"?new Jd(M):new Kd[M.type](M)},e.cross=function(M,O,Y){var ae=O[0],pe=O[1],ye=O[2],Ee=Y[0],Ne=Y[1],Qe=Y[2];return M[0]=pe*Qe-ye*Ne,M[1]=ye*Ee-ae*Qe,M[2]=ae*Ne-pe*Ee,M},e.deepEqual=function M(O,Y){if(Array.isArray(O)){if(!Array.isArray(Y)||O.length!==Y.length)return!1;for(var ae=0;ae<O.length;ae++)if(!M(O[ae],Y[ae]))return!1;return!0}if(typeof O=="object"&&O!==null&&Y!==null){if(typeof Y!="object"||Object.keys(O).length!==Object.keys(Y).length)return!1;for(var pe in O)if(!M(O[pe],Y[pe]))return!1;return!0}return O===Y},e.dot=function(M,O){return M[0]*O[0]+M[1]*O[1]+M[2]*O[2]},e.dot$1=function(M,O){return M[0]*O[0]+M[1]*O[1]+M[2]*O[2]+M[3]*O[3]},e.ease=i,e.emitValidationErrors=Tn,e.endsWith=T,e.enforceCacheSizeLimit=function(M){Ze(),Ce&&Ce.then(function(O){O.keys().then(function(Y){for(var ae=0;ae<Y.length-M;ae++)O.delete(Y[ae])})})},e.evaluateSizeForFeature=ch,e.evaluateSizeForZoom=uh,e.evaluateVariableOffset=yh,e.evented=Si,e.extend=l,e.featureFilter=Sa,e.filterObject=w,e.fromRotation=function(M,O){var Y=Math.sin(O),ae=Math.cos(O);return M[0]=ae,M[1]=Y,M[2]=0,M[3]=-Y,M[4]=ae,M[5]=0,M[6]=0,M[7]=0,M[8]=1,M},e.getAnchorAlignment=Qu,e.getAnchorJustification=tf,e.getArrayBuffer=vt,e.getImage=Jt,e.getJSON=function(M,O){return Ke(l(M,{type:"json"}),O)},e.getRTLTextPluginStatus=Xi,e.getReferrer=yt,e.getVideo=function(M,O){var Y,ae,pe=self.document.createElement("video");pe.muted=!0,pe.onloadstart=function(){O(null,pe)};for(var ye=0;ye<M.length;ye++){var Ee=self.document.createElement("source");Y=M[ye],ae=void 0,(ae=self.document.createElement("a")).href=Y,(ae.protocol!==self.document.location.protocol||ae.host!==self.document.location.host)&&(pe.crossOrigin="Anonymous"),Ee.src=M[ye],pe.appendChild(Ee)}return{cancel:function(){}}},e.identity=yc,e.invert=function(M,O){var Y=O[0],ae=O[1],pe=O[2],ye=O[3],Ee=O[4],Ne=O[5],Qe=O[6],ct=O[7],mt=O[8],Dt=O[9],Wt=O[10],Vt=O[11],sr=O[12],br=O[13],Ir=O[14],Pr=O[15],Vr=Y*Ne-ae*Ee,Hr=Y*Qe-pe*Ee,Xr=Y*ct-ye*Ee,un=ae*Qe-pe*Ne,bn=ae*ct-ye*Ne,jn=pe*ct-ye*Qe,Bn=mt*br-Dt*sr,Wn=mt*Ir-Wt*sr,sa=mt*Pr-Vt*sr,la=Dt*Ir-Wt*br,$n=Dt*Pr-Vt*br,ma=Wt*Pr-Vt*Ir,pa=Vr*ma-Hr*$n+Xr*la+un*sa-bn*Wn+jn*Bn;return pa?(pa=1/pa,M[0]=(Ne*ma-Qe*$n+ct*la)*pa,M[1]=(pe*$n-ae*ma-ye*la)*pa,M[2]=(br*jn-Ir*bn+Pr*un)*pa,M[3]=(Wt*bn-Dt*jn-Vt*un)*pa,M[4]=(Qe*sa-Ee*ma-ct*Wn)*pa,M[5]=(Y*ma-pe*sa+ye*Wn)*pa,M[6]=(Ir*Xr-sr*jn-Pr*Hr)*pa,M[7]=(mt*jn-Wt*Xr+Vt*Hr)*pa,M[8]=(Ee*$n-Ne*sa+ct*Bn)*pa,M[9]=(ae*sa-Y*$n-ye*Bn)*pa,M[10]=(sr*bn-br*Xr+Pr*Vr)*pa,M[11]=(Dt*Xr-mt*bn-Vt*Vr)*pa,M[12]=(Ne*Wn-Ee*la-Qe*Bn)*pa,M[13]=(Y*la-ae*Wn+pe*Bn)*pa,M[14]=(br*Hr-sr*un-Ir*Vr)*pa,M[15]=(mt*un-Dt*Hr+Wt*Vr)*pa,M):null},e.isChar=En,e.isMapboxURL=le,e.keysDifference=function(M,O){var Y=[];for(var ae in M)ae in O||Y.push(ae);return Y},e.makeRequest=Ke,e.mapObject=_,e.mercatorXfromLng=Eh,e.mercatorYfromLat=Lh,e.mercatorZfromAltitude=Ch,e.mul=Bu,e.multiply=Ll,e.mvt=Yl,e.normalize=function(M,O){var Y=O[0],ae=O[1],pe=O[2],ye=Y*Y+ae*ae+pe*pe;return ye>0&&(ye=1/Math.sqrt(ye)),M[0]=O[0]*ye,M[1]=O[1]*ye,M[2]=O[2]*ye,M},e.number=wn,e.offscreenCanvasSupported=ot,e.ortho=function(M,O,Y,ae,pe,ye,Ee){var Ne=1/(O-Y),Qe=1/(ae-pe),ct=1/(ye-Ee);return M[0]=-2*Ne,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=-2*Qe,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=2*ct,M[11]=0,M[12]=(O+Y)*Ne,M[13]=(pe+ae)*Qe,M[14]=(Ee+ye)*ct,M[15]=1,M},e.parseGlyphPBF=function(M){return new Kc(M).readFields(Ld,[])},e.pbf=Kc,e.performSymbolLayout=function(M,O,Y,ae,pe,ye,Ee){M.createArrays();var Ne=512*M.overscaling;M.tilePixelRatio=8192/Ne,M.compareText={},M.iconsNeedLinear=!1;var Qe=M.layers[0].layout,ct=M.layers[0]._unevaluatedLayout._values,mt={};if(M.textSizeData.kind==="composite"){var Dt=M.textSizeData,Wt=Dt.minZoom,Vt=Dt.maxZoom;mt.compositeTextSizes=[ct["text-size"].possiblyEvaluate(new ii(Wt),Ee),ct["text-size"].possiblyEvaluate(new ii(Vt),Ee)]}if(M.iconSizeData.kind==="composite"){var sr=M.iconSizeData,br=sr.minZoom,Ir=sr.maxZoom;mt.compositeIconSizes=[ct["icon-size"].possiblyEvaluate(new ii(br),Ee),ct["icon-size"].possiblyEvaluate(new ii(Ir),Ee)]}mt.layoutTextSize=ct["text-size"].possiblyEvaluate(new ii(M.zoom+1),Ee),mt.layoutIconSize=ct["icon-size"].possiblyEvaluate(new ii(M.zoom+1),Ee),mt.textMaxSize=ct["text-size"].possiblyEvaluate(new ii(18));for(var Pr=24*Qe.get("text-line-height"),Vr=Qe.get("text-rotation-alignment")==="map"&&Qe.get("symbol-placement")!=="point",Hr=Qe.get("text-keep-upright"),Xr=Qe.get("text-size"),un=function(){var Bn=jn[bn],Wn=Qe.get("text-font").evaluate(Bn,{},Ee).join(","),sa=Xr.evaluate(Bn,{},Ee),la=mt.layoutTextSize.evaluate(Bn,{},Ee),$n=mt.layoutIconSize.evaluate(Bn,{},Ee),ma={horizontal:{},vertical:void 0},pa=Bn.text,ca=[0,0];if(pa){var ei=pa.toString(),qa=24*Qe.get("text-letter-spacing").evaluate(Bn,{},Ee),ni=function(Ba){for(var ti=0,qi=Ba;ti<qi.length;ti+=1)if(!Ca(qi[ti].charCodeAt(0)))return!1;return!0}(ei)?qa:0,Ta=Qe.get("text-anchor").evaluate(Bn,{},Ee),Wa=Qe.get("text-variable-anchor");if(!Wa){var wi=Qe.get("text-radial-offset").evaluate(Bn,{},Ee);ca=wi?yh(Ta,[24*wi,ef]):Qe.get("text-offset").evaluate(Bn,{},Ee).map(function(Ba){return 24*Ba})}var mi=Vr?"center":Qe.get("text-justify").evaluate(Bn,{},Ee),Pi=Qe.get("symbol-placement"),gi=Pi==="point"?24*Qe.get("text-max-width").evaluate(Bn,{},Ee):0,fo=function(){M.allowVerticalPlacement&&Ra(ei)&&(ma.vertical=eu(pa,O,Y,pe,Wn,gi,Pr,Ta,"left",ni,ca,ds.vertical,!0,Pi,la,sa))};if(!Vr&&Wa){for(var Ii=mi==="auto"?Wa.map(function(Ba){return tf(Ba)}):[mi],No=!1,Eo=0;Eo<Ii.length;Eo++){var Po=Ii[Eo];if(!ma.horizontal[Po])if(No)ma.horizontal[Po]=ma.horizontal[0];else{var Jo=eu(pa,O,Y,pe,Wn,gi,Pr,"center",Po,ni,ca,ds.horizontal,!1,Pi,la,sa);Jo&&(ma.horizontal[Po]=Jo,No=Jo.positionedLines.length===1)}}fo()}else{mi==="auto"&&(mi=tf(Ta));var Ho=eu(pa,O,Y,pe,Wn,gi,Pr,Ta,mi,ni,ca,ds.horizontal,!1,Pi,la,sa);Ho&&(ma.horizontal[mi]=Ho),fo(),Ra(ei)&&Vr&&Hr&&(ma.vertical=eu(pa,O,Y,pe,Wn,gi,Pr,Ta,mi,ni,ca,ds.vertical,!1,Pi,la,sa))}}var ho=void 0,Io=!1;if(Bn.icon&&Bn.icon.name){var Qi=ae[Bn.icon.name];Qi&&(ho=function(Ba,ti,qi){var Gi=Qu(qi),ji=Gi.horizontalAlign,Oi=Gi.verticalAlign,si=ti[0],Yi=ti[1],Ko=si-Ba.displaySize[0]*ji,cs=Ko+Ba.displaySize[0],qo=Yi-Ba.displaySize[1]*Oi;return{image:Ba,top:qo,bottom:qo+Ba.displaySize[1],left:Ko,right:cs}}(pe[Bn.icon.name],Qe.get("icon-offset").evaluate(Bn,{},Ee),Qe.get("icon-anchor").evaluate(Bn,{},Ee)),Io=Qi.sdf,M.sdfIcons===void 0?M.sdfIcons=Qi.sdf:M.sdfIcons!==Qi.sdf&&A("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Qi.pixelRatio!==M.pixelRatio||Qe.get("icon-rotate").constantOr(1)!==0)&&(M.iconsNeedLinear=!0))}var yo=bh(ma.horizontal)||ma.vertical;M.iconsInText=!!yo&&yo.iconsInText,(yo||ho)&&function(Ba,ti,qi,Gi,ji,Oi,si,Yi,Ko,cs,qo){var Bs=Oi.textMaxSize.evaluate(ti,{});Bs===void 0&&(Bs=si);var nl,Lo=Ba.layers[0].layout,Ns=Lo.get("icon-offset").evaluate(ti,{},qo),js=bh(qi.horizontal),Us=si/24,lf=Ba.tilePixelRatio*Us,nc=Ba.tilePixelRatio*Bs/24,uu=Ba.tilePixelRatio*Yi,zl=Ba.tilePixelRatio*Lo.get("symbol-spacing"),fu=Lo.get("text-padding")*Ba.tilePixelRatio,hu=Lo.get("icon-padding")*Ba.tilePixelRatio,pu=Lo.get("text-max-angle")/180*Math.PI,du=Lo.get("text-rotation-alignment")==="map"&&Lo.get("symbol-placement")!=="point",ml=Lo.get("icon-rotation-alignment")==="map"&&Lo.get("symbol-placement")!=="point",ac=Lo.get("symbol-placement"),mu=zl/2,ic=Lo.get("icon-text-fit");Gi&&ic!=="none"&&(Ba.allowVerticalPlacement&&qi.vertical&&(nl=lh(Gi,qi.vertical,ic,Lo.get("icon-text-fit-padding"),Ns,Us)),js&&(Gi=lh(Gi,js,ic,Lo.get("icon-text-fit-padding"),Ns,Us)));var vl=function(e0,Rc){Rc.x<0||Rc.x>=8192||Rc.y<0||Rc.y>=8192||function(Ji,Vs,t0,yl,pf,Bh,Tu,Zs,ku,Fc,Mu,Au,df,Nh,Bc,jh,Uh,Vh,Hh,qh,ms,Su,Gh,Js,r0){var mf,Dl,fc,hc,pc,dc=Ji.addToLineVertexArray(Vs,t0),Yh=0,Wh=0,Xh=0,Zh=0,gf=-1,vf=-1,al={},Jh=Lr(""),yf=0,xf=0;if(Zs._unevaluatedLayout.getValue("text-radial-offset")===void 0?(mf=Zs.layout.get("text-offset").evaluate(ms,{},Js).map(function(jc){return 24*jc}),yf=mf[0],xf=mf[1]):(yf=24*Zs.layout.get("text-radial-offset").evaluate(ms,{},Js),xf=ef),Ji.allowVerticalPlacement&&yl.vertical){var Kh=Zs.layout.get("text-rotate").evaluate(ms,{},Js)+90,n0=yl.vertical;hc=new iu(ku,Vs,Fc,Mu,Au,n0,df,Nh,Bc,Kh),Tu&&(pc=new iu(ku,Vs,Fc,Mu,Au,Tu,Uh,Vh,Bc,Kh))}if(pf){var bf=Zs.layout.get("icon-rotate").evaluate(ms,{}),Qh=Zs.layout.get("icon-text-fit")!=="none",$h=gh(pf,bf,Gh,Qh),_f=Tu?gh(Tu,bf,Gh,Qh):void 0;fc=new iu(ku,Vs,Fc,Mu,Au,pf,Uh,Vh,!1,bf),Yh=4*$h.length;var ep=Ji.iconSizeData,Nc=null;ep.kind==="source"?(Nc=[128*Zs.layout.get("icon-size").evaluate(ms,{})])[0]>32640&&A(Ji.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):ep.kind==="composite"&&((Nc=[128*Su.compositeIconSizes[0].evaluate(ms,{},Js),128*Su.compositeIconSizes[1].evaluate(ms,{},Js)])[0]>32640||Nc[1]>32640)&&A(Ji.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ji.addSymbols(Ji.icon,$h,Nc,qh,Hh,ms,!1,Vs,dc.lineStartIndex,dc.lineLength,-1,Js),gf=Ji.icon.placedSymbolArray.length-1,_f&&(Wh=4*_f.length,Ji.addSymbols(Ji.icon,_f,Nc,qh,Hh,ms,ds.vertical,Vs,dc.lineStartIndex,dc.lineLength,-1,Js),vf=Ji.icon.placedSymbolArray.length-1)}for(var tp in yl.horizontal){var Eu=yl.horizontal[tp];if(!Dl){Jh=Lr(Eu.text);var a0=Zs.layout.get("text-rotate").evaluate(ms,{},Js);Dl=new iu(ku,Vs,Fc,Mu,Au,Eu,df,Nh,Bc,a0)}var rp=Eu.positionedLines.length===1;if(Xh+=xh(Ji,Vs,Eu,Bh,Zs,Bc,ms,jh,dc,yl.vertical?ds.horizontal:ds.horizontalOnly,rp?Object.keys(yl.horizontal):[tp],al,gf,Su,Js),rp)break}yl.vertical&&(Zh+=xh(Ji,Vs,yl.vertical,Bh,Zs,Bc,ms,jh,dc,ds.vertical,["vertical"],al,vf,Su,Js));var i0=Dl?Dl.boxStartIndex:Ji.collisionBoxArray.length,o0=Dl?Dl.boxEndIndex:Ji.collisionBoxArray.length,s0=hc?hc.boxStartIndex:Ji.collisionBoxArray.length,l0=hc?hc.boxEndIndex:Ji.collisionBoxArray.length,c0=fc?fc.boxStartIndex:Ji.collisionBoxArray.length,u0=fc?fc.boxEndIndex:Ji.collisionBoxArray.length,f0=pc?pc.boxStartIndex:Ji.collisionBoxArray.length,h0=pc?pc.boxEndIndex:Ji.collisionBoxArray.length,Ks=-1,Lu=function(jc,ap){return jc&&jc.circleDiameter?Math.max(jc.circleDiameter,ap):ap};Ks=Lu(Dl,Ks),Ks=Lu(hc,Ks),Ks=Lu(fc,Ks);var np=(Ks=Lu(pc,Ks))>-1?1:0;np&&(Ks*=r0/24),Ji.glyphOffsetArray.length>=hi.MAX_GLYPHS&&A("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ms.sortKey!==void 0&&Ji.addToSortKeyRanges(Ji.symbolInstances.length,ms.sortKey),Ji.symbolInstances.emplaceBack(Vs.x,Vs.y,al.right>=0?al.right:-1,al.center>=0?al.center:-1,al.left>=0?al.left:-1,al.vertical||-1,gf,vf,Jh,i0,o0,s0,l0,c0,u0,f0,h0,Fc,Xh,Zh,Yh,Wh,np,0,df,yf,xf,Ks)}(Ba,Rc,e0,qi,Gi,ji,nl,Ba.layers[0],Ba.collisionBoxArray,ti.index,ti.sourceLayerIndex,Ba.index,lf,fu,du,Ko,uu,hu,ml,Ns,ti,Oi,cs,qo,si)};if(ac==="line")for(var Pc=0,gu=mh(ti.geometry,0,0,8192,8192);Pc<gu.length;Pc+=1)for(var vu=gu[Pc],yu=Rd(vu,zl,pu,qi.vertical||js,Gi,24,nc,Ba.overscaling,8192),Ic=0,xu=yu;Ic<xu.length;Ic+=1){var Oc=xu[Ic],bu=js;bu&&jd(Ba,bu.text,mu,Oc)||vl(vu,Oc)}else if(ac==="line-center")for(var zc=0,_u=ti.geometry;zc<_u.length;zc+=1){var oc=_u[zc];if(oc.length>1){var sc=Dd(oc,pu,qi.vertical||js,Gi,24,nc);sc&&vl(oc,sc)}}else if(ti.type==="Polygon")for(var lc=0,wu=Yu(ti.geometry,0);lc<wu.length;lc+=1){var cc=wu[lc],Dc=Bd(cc,16);vl(cc[0],new Jl(Dc.x,Dc.y,0))}else if(ti.type==="LineString")for(var uc=0,Dh=ti.geometry;uc<Dh.length;uc+=1){var cf=Dh[uc];vl(cf,new Jl(cf[0].x,cf[0].y,0))}else if(ti.type==="Point")for(var uf=0,Rh=ti.geometry;uf<Rh.length;uf+=1)for(var $d=Rh[uf],ff=0,Fh=$d;ff<Fh.length;ff+=1){var hf=Fh[ff];vl([hf],new Jl(hf.x,hf.y,0))}}(M,Bn,ma,ho,ae,mt,la,$n,ca,Io,Ee)},bn=0,jn=M.features;bn<jn.length;bn+=1)un();ye&&M.generateCollisionDebugBuffers()},e.perspective=function(M,O,Y,ae,pe){var ye,Ee=1/Math.tan(O/2);return M[0]=Ee/Y,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=Ee,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=-1,M[12]=0,M[13]=0,M[15]=0,pe!=null&&pe!==1/0?(ye=1/(ae-pe),M[10]=(pe+ae)*ye,M[14]=2*pe*ae*ye):(M[10]=-1,M[14]=-2*ae),M},e.pick=function(M,O){for(var Y={},ae=0;ae<O.length;ae++){var pe=O[ae];pe in M&&(Y[pe]=M[pe])}return Y},e.plugin=vo,e.polygonIntersectsPolygon=Uo,e.postMapLoadEvent=ze,e.postTurnstileEvent=ke,e.potpack=ah,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Kr,e.registerForPluginStateChange=function(M){return M({pluginStatus:xa,pluginURL:xi}),Si.on("pluginStateChange",M),M},e.rotate=function(M,O,Y){var ae=O[0],pe=O[1],ye=O[2],Ee=O[3],Ne=Math.sin(Y),Qe=Math.cos(Y);return M[0]=ae*Qe+ye*Ne,M[1]=pe*Qe+Ee*Ne,M[2]=ae*-Ne+ye*Qe,M[3]=pe*-Ne+Ee*Qe,M},e.rotateX=function(M,O,Y){var ae=Math.sin(Y),pe=Math.cos(Y),ye=O[4],Ee=O[5],Ne=O[6],Qe=O[7],ct=O[8],mt=O[9],Dt=O[10],Wt=O[11];return O!==M&&(M[0]=O[0],M[1]=O[1],M[2]=O[2],M[3]=O[3],M[12]=O[12],M[13]=O[13],M[14]=O[14],M[15]=O[15]),M[4]=ye*pe+ct*ae,M[5]=Ee*pe+mt*ae,M[6]=Ne*pe+Dt*ae,M[7]=Qe*pe+Wt*ae,M[8]=ct*pe-ye*ae,M[9]=mt*pe-Ee*ae,M[10]=Dt*pe-Ne*ae,M[11]=Wt*pe-Qe*ae,M},e.rotateZ=function(M,O,Y){var ae=Math.sin(Y),pe=Math.cos(Y),ye=O[0],Ee=O[1],Ne=O[2],Qe=O[3],ct=O[4],mt=O[5],Dt=O[6],Wt=O[7];return O!==M&&(M[8]=O[8],M[9]=O[9],M[10]=O[10],M[11]=O[11],M[12]=O[12],M[13]=O[13],M[14]=O[14],M[15]=O[15]),M[0]=ye*pe+ct*ae,M[1]=Ee*pe+mt*ae,M[2]=Ne*pe+Dt*ae,M[3]=Qe*pe+Wt*ae,M[4]=ct*pe-ye*ae,M[5]=mt*pe-Ee*ae,M[6]=Dt*pe-Ne*ae,M[7]=Wt*pe-Qe*ae,M},e.scale=function(M,O,Y){var ae=Y[0],pe=Y[1],ye=Y[2];return M[0]=O[0]*ae,M[1]=O[1]*ae,M[2]=O[2]*ae,M[3]=O[3]*ae,M[4]=O[4]*pe,M[5]=O[5]*pe,M[6]=O[6]*pe,M[7]=O[7]*pe,M[8]=O[8]*ye,M[9]=O[9]*ye,M[10]=O[10]*ye,M[11]=O[11]*ye,M[12]=O[12],M[13]=O[13],M[14]=O[14],M[15]=O[15],M},e.scale$1=function(M,O,Y){return M[0]=O[0]*Y,M[1]=O[1]*Y,M[2]=O[2]*Y,M[3]=O[3]*Y,M},e.scale$2=function(M,O,Y){return M[0]=O[0]*Y,M[1]=O[1]*Y,M[2]=O[2]*Y,M},e.setCacheLimits=function(M,O){Re=M,Oe=O},e.setRTLTextPlugin=function(M,O,Y){if(Y===void 0&&(Y=!1),xa===Ka||xa===Hi||xa===Qo)throw new Error("setRTLTextPlugin cannot be called multiple times.");xi=B.resolveURL(M),xa=Ka,To=O,Qa(),Y||ai()},e.sphericalToCartesian=function(M){var O=M[0],Y=M[1],ae=M[2];return Y+=90,Y*=Math.PI/180,ae*=Math.PI/180,{x:O*Math.cos(Y)*Math.sin(ae),y:O*Math.sin(Y)*Math.sin(ae),z:O*Math.cos(ae)}},e.sqrLen=xc,e.styleSpec=xe,e.sub=Nu,e.symbolSize=zd,e.transformMat3=function(M,O,Y){var ae=O[0],pe=O[1],ye=O[2];return M[0]=ae*Y[0]+pe*Y[3]+ye*Y[6],M[1]=ae*Y[1]+pe*Y[4]+ye*Y[7],M[2]=ae*Y[2]+pe*Y[5]+ye*Y[8],M},e.transformMat4=Hl,e.translate=function(M,O,Y){var ae,pe,ye,Ee,Ne,Qe,ct,mt,Dt,Wt,Vt,sr,br=Y[0],Ir=Y[1],Pr=Y[2];return O===M?(M[12]=O[0]*br+O[4]*Ir+O[8]*Pr+O[12],M[13]=O[1]*br+O[5]*Ir+O[9]*Pr+O[13],M[14]=O[2]*br+O[6]*Ir+O[10]*Pr+O[14],M[15]=O[3]*br+O[7]*Ir+O[11]*Pr+O[15]):(ae=O[0],pe=O[1],ye=O[2],Ee=O[3],Ne=O[4],Qe=O[5],ct=O[6],mt=O[7],Dt=O[8],Wt=O[9],Vt=O[10],sr=O[11],M[0]=ae,M[1]=pe,M[2]=ye,M[3]=Ee,M[4]=Ne,M[5]=Qe,M[6]=ct,M[7]=mt,M[8]=Dt,M[9]=Wt,M[10]=Vt,M[11]=sr,M[12]=ae*br+Ne*Ir+Dt*Pr+O[12],M[13]=pe*br+Qe*Ir+Wt*Pr+O[13],M[14]=ye*br+ct*Ir+Vt*Pr+O[14],M[15]=Ee*br+mt*Ir+sr*Pr+O[15]),M},e.triggerPluginCompletionEvent=ko,e.uniqueId=d,e.validateCustomStyleLayer=function(M){var O=[],Y=M.id;return Y===void 0&&O.push({message:"layers."+Y+': missing required property "id"'}),M.render===void 0&&O.push({message:"layers."+Y+': missing required method "render"'}),M.renderingMode&&M.renderingMode!=="2d"&&M.renderingMode!=="3d"&&O.push({message:"layers."+Y+': property "renderingMode" must be either "2d" or "3d"'}),O},e.validateLight=ln,e.validateStyle=Zr,e.values=function(M){var O=[];for(var Y in M)O.push(M[Y]);return O},e.vectorTile=Yl,e.version="1.10.1",e.warnOnce=A,e.webpSupported=ee,e.window=self,e.wrap=f}),y(0,function(e){function n(Ue){var We=typeof Ue;if(We==="number"||We==="boolean"||We==="string"||Ue==null)return JSON.stringify(Ue);if(Array.isArray(Ue)){for(var he="[",xe=0,De=Ue;xe<De.length;xe+=1)he+=n(De[xe])+",";return he+"]"}for(var qe=Object.keys(Ue).sort(),Xe="{",He=0;He<qe.length;He++)Xe+=JSON.stringify(qe[He])+":"+n(Ue[qe[He]])+",";return Xe+"}"}function t(Ue){for(var We="",he=0,xe=e.refProperties;he<xe.length;he+=1)We+="/"+n(Ue[xe[he]]);return We}var a=function(Ue){this.keyCache={},Ue&&this.replace(Ue)};a.prototype.replace=function(Ue){this._layerConfigs={},this._layers={},this.update(Ue,[])},a.prototype.update=function(Ue,We){for(var he=this,xe=0,De=Ue;xe<De.length;xe+=1){var qe=De[xe];this._layerConfigs[qe.id]=qe;var Xe=this._layers[qe.id]=e.createStyleLayer(qe);Xe._featureFilter=e.featureFilter(Xe.filter),this.keyCache[qe.id]&&delete this.keyCache[qe.id]}for(var He=0,st=We;He<st.length;He+=1){var it=st[He];delete this.keyCache[it],delete this._layerConfigs[it],delete this._layers[it]}this.familiesBySource={};for(var Tt=0,Pt=function(Ye,nt){for(var ft={},Mt=0;Mt<Ye.length;Mt++){var Rt=nt&&nt[Ye[Mt].id]||t(Ye[Mt]);nt&&(nt[Ye[Mt].id]=Rt);var Gt=ft[Rt];Gt||(Gt=ft[Rt]=[]),Gt.push(Ye[Mt])}var jt=[];for(var pr in ft)jt.push(ft[pr]);return jt}(e.values(this._layerConfigs),this.keyCache);Tt<Pt.length;Tt+=1){var rt=Pt[Tt].map(function(Ye){return he._layers[Ye.id]}),ut=rt[0];if(ut.visibility!=="none"){var Ft=ut.source||"",wt=this.familiesBySource[Ft];wt||(wt=this.familiesBySource[Ft]={});var Lt=ut.sourceLayer||"_geojsonTileLayer",Ae=wt[Lt];Ae||(Ae=wt[Lt]=[]),Ae.push(rt)}}};var r=function(Ue){var We={},he=[];for(var xe in Ue){var De=Ue[xe],qe=We[xe]={};for(var Xe in De){var He=De[+Xe];if(He&&He.bitmap.width!==0&&He.bitmap.height!==0){var st={x:0,y:0,w:He.bitmap.width+2,h:He.bitmap.height+2};he.push(st),qe[Xe]={rect:st,metrics:He.metrics}}}}var it=e.potpack(he),Tt=it.w,Pt=it.h,rt=new e.AlphaImage({width:Tt||1,height:Pt||1});for(var ut in Ue){var Ft=Ue[ut];for(var wt in Ft){var Lt=Ft[+wt];if(Lt&&Lt.bitmap.width!==0&&Lt.bitmap.height!==0){var Ae=We[ut][wt].rect;e.AlphaImage.copy(Lt.bitmap,rt,{x:0,y:0},{x:Ae.x+1,y:Ae.y+1},Lt.bitmap)}}}this.image=rt,this.positions=We};e.register("GlyphAtlas",r);var m=function(Ue){this.tileID=new e.OverscaledTileID(Ue.tileID.overscaledZ,Ue.tileID.wrap,Ue.tileID.canonical.z,Ue.tileID.canonical.x,Ue.tileID.canonical.y),this.uid=Ue.uid,this.zoom=Ue.zoom,this.pixelRatio=Ue.pixelRatio,this.tileSize=Ue.tileSize,this.source=Ue.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ue.showCollisionBoxes,this.collectResourceTiming=!!Ue.collectResourceTiming,this.returnDependencies=!!Ue.returnDependencies,this.promoteId=Ue.promoteId};function o(Ue,We,he){for(var xe=new e.EvaluationParameters(We),De=0,qe=Ue;De<qe.length;De+=1)qe[De].recalculate(xe,he)}function i(Ue,We){var he=e.getArrayBuffer(Ue.request,function(xe,De,qe,Xe){xe?We(xe):De&&We(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(De)),rawData:De,cacheControl:qe,expires:Xe})});return function(){he.cancel(),We()}}m.prototype.parse=function(Ue,We,he,xe,De){var qe=this;this.status="parsing",this.data=Ue,this.collisionBoxArray=new e.CollisionBoxArray;var Xe=new e.DictionaryCoder(Object.keys(Ue.layers).sort()),He=new e.FeatureIndex(this.tileID,this.promoteId);He.bucketLayerIDs=[];var st,it,Tt,Pt,rt={},ut={featureIndex:He,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:he},Ft=We.familiesBySource[this.source];for(var wt in Ft){var Lt=Ue.layers[wt];if(Lt){Lt.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+wt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ae=Xe.encode(wt),Ye=[],nt=0;nt<Lt.length;nt++){var ft=Lt.feature(nt),Mt=He.getId(ft,wt);Ye.push({feature:ft,id:Mt,index:nt,sourceLayerIndex:Ae})}for(var Rt=0,Gt=Ft[wt];Rt<Gt.length;Rt+=1){var jt=Gt[Rt],pr=jt[0];pr.minzoom&&this.zoom<Math.floor(pr.minzoom)||pr.maxzoom&&this.zoom>=pr.maxzoom||pr.visibility!=="none"&&(o(jt,this.zoom,he),(rt[pr.id]=pr.createBucket({index:He.bucketLayerIDs.length,layers:jt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ae,sourceID:this.source})).populate(Ye,ut,this.tileID.canonical),He.bucketLayerIDs.push(jt.map(function($t){return $t.id})))}}}var Ar=e.mapObject(ut.glyphDependencies,function($t){return Object.keys($t).map(Number)});Object.keys(Ar).length?xe.send("getGlyphs",{uid:this.uid,stacks:Ar},function($t,hr){st||(st=$t,it=hr,Qt.call(qe))}):it={};var fr=Object.keys(ut.iconDependencies);fr.length?xe.send("getImages",{icons:fr,source:this.source,tileID:this.tileID,type:"icons"},function($t,hr){st||(st=$t,Tt=hr,Qt.call(qe))}):Tt={};var Zt=Object.keys(ut.patternDependencies);function Qt(){if(st)return De(st);if(it&&Tt&&Pt){var $t=new r(it),hr=new e.ImageAtlas(Tt,Pt);for(var vr in rt){var Mr=rt[vr];Mr instanceof e.SymbolBucket?(o(Mr.layers,this.zoom,he),e.performSymbolLayout(Mr,it,$t.positions,Tt,hr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Mr.hasPattern&&(Mr instanceof e.LineBucket||Mr instanceof e.FillBucket||Mr instanceof e.FillExtrusionBucket)&&(o(Mr.layers,this.zoom,he),Mr.addFeatures(ut,this.tileID.canonical,hr.patternPositions))}this.status="done",De(null,{buckets:e.values(rt).filter(function(Nr){return!Nr.isEmpty()}),featureIndex:He,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:$t.image,imageAtlas:hr,glyphMap:this.returnDependencies?it:null,iconMap:this.returnDependencies?Tt:null,glyphPositions:this.returnDependencies?$t.positions:null})}}Zt.length?xe.send("getImages",{icons:Zt,source:this.source,tileID:this.tileID,type:"patterns"},function($t,hr){st||(st=$t,Pt=hr,Qt.call(qe))}):Pt={},Qt.call(this)};var u=function(Ue,We,he,xe){this.actor=Ue,this.layerIndex=We,this.availableImages=he,this.loadVectorData=xe||i,this.loading={},this.loaded={}};u.prototype.loadTile=function(Ue,We){var he=this,xe=Ue.uid;this.loading||(this.loading={});var De=!!(Ue&&Ue.request&&Ue.request.collectResourceTiming)&&new e.RequestPerformance(Ue.request),qe=this.loading[xe]=new m(Ue);qe.abort=this.loadVectorData(Ue,function(Xe,He){if(delete he.loading[xe],Xe||!He)return qe.status="done",he.loaded[xe]=qe,We(Xe);var st=He.rawData,it={};He.expires&&(it.expires=He.expires),He.cacheControl&&(it.cacheControl=He.cacheControl);var Tt={};if(De){var Pt=De.finish();Pt&&(Tt.resourceTiming=JSON.parse(JSON.stringify(Pt)))}qe.vectorTile=He.vectorTile,qe.parse(He.vectorTile,he.layerIndex,he.availableImages,he.actor,function(rt,ut){if(rt||!ut)return We(rt);We(null,e.extend({rawTileData:st.slice(0)},ut,it,Tt))}),he.loaded=he.loaded||{},he.loaded[xe]=qe})},u.prototype.reloadTile=function(Ue,We){var he=this,xe=this.loaded,De=Ue.uid,qe=this;if(xe&&xe[De]){var Xe=xe[De];Xe.showCollisionBoxes=Ue.showCollisionBoxes;var He=function(st,it){var Tt=Xe.reloadCallback;Tt&&(delete Xe.reloadCallback,Xe.parse(Xe.vectorTile,qe.layerIndex,he.availableImages,qe.actor,Tt)),We(st,it)};Xe.status==="parsing"?Xe.reloadCallback=He:Xe.status==="done"&&(Xe.vectorTile?Xe.parse(Xe.vectorTile,this.layerIndex,this.availableImages,this.actor,He):He())}},u.prototype.abortTile=function(Ue,We){var he=this.loading,xe=Ue.uid;he&&he[xe]&&he[xe].abort&&(he[xe].abort(),delete he[xe]),We()},u.prototype.removeTile=function(Ue,We){var he=this.loaded,xe=Ue.uid;he&&he[xe]&&delete he[xe],We()};var f=e.window.ImageBitmap,l=function(){this.loaded={}};l.prototype.loadTile=function(Ue,We){var he=Ue.uid,xe=Ue.encoding,De=Ue.rawImageData,qe=f&&De instanceof f?this.getImageData(De):De,Xe=new e.DEMData(he,qe,xe);this.loaded=this.loaded||{},this.loaded[he]=Xe,We(null,Xe)},l.prototype.getImageData=function(Ue){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ue.width,Ue.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Ue.width,this.offscreenCanvas.height=Ue.height,this.offscreenCanvasContext.drawImage(Ue,0,0,Ue.width,Ue.height);var We=this.offscreenCanvasContext.getImageData(-1,-1,Ue.width+2,Ue.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:We.width,height:We.height},We.data)},l.prototype.removeTile=function(Ue){var We=this.loaded,he=Ue.uid;We&&We[he]&&delete We[he]};var h=function Ue(We,he){var xe,De=We&&We.type;if(De==="FeatureCollection")for(xe=0;xe<We.features.length;xe++)Ue(We.features[xe],he);else if(De==="GeometryCollection")for(xe=0;xe<We.geometries.length;xe++)Ue(We.geometries[xe],he);else if(De==="Feature")Ue(We.geometry,he);else if(De==="Polygon")d(We.coordinates,he);else if(De==="MultiPolygon")for(xe=0;xe<We.coordinates.length;xe++)d(We.coordinates[xe],he);return We};function d(Ue,We){if(Ue.length!==0){s(Ue[0],We);for(var he=1;he<Ue.length;he++)s(Ue[he],!We)}}function s(Ue,We){for(var he=0,xe=0,De=Ue.length,qe=De-1;xe<De;qe=xe++)he+=(Ue[xe][0]-Ue[qe][0])*(Ue[qe][1]+Ue[xe][1]);he>=0!=!!We&&Ue.reverse()}var x=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,c=function(Ue){this._feature=Ue,this.extent=e.EXTENT,this.type=Ue.type,this.properties=Ue.tags,"id"in Ue&&!isNaN(Ue.id)&&(this.id=parseInt(Ue.id,10))};c.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Ue=[],We=0,he=this._feature.geometry;We<he.length;We+=1){var xe=he[We];Ue.push([new e.Point$1(xe[0],xe[1])])}return Ue}for(var De=[],qe=0,Xe=this._feature.geometry;qe<Xe.length;qe+=1){for(var He=[],st=0,it=Xe[qe];st<it.length;st+=1){var Tt=it[st];He.push(new e.Point$1(Tt[0],Tt[1]))}De.push(He)}return De},c.prototype.toGeoJSON=function(Ue,We,he){return x.call(this,Ue,We,he)};var T=function(Ue){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=Ue.length,this._features=Ue};T.prototype.feature=function(Ue){return new c(this._features[Ue])};var _=e.vectorTile.VectorTileFeature,w=k;function k(Ue,We){this.options=We||{},this.features=Ue,this.length=Ue.length}function L(Ue,We){this.id=typeof Ue.id=="number"?Ue.id:void 0,this.type=Ue.type,this.rawGeometry=Ue.type===1?[Ue.geometry]:Ue.geometry,this.properties=Ue.tags,this.extent=We||4096}k.prototype.feature=function(Ue){return new L(this.features[Ue],this.options.extent)},L.prototype.loadGeometry=function(){var Ue=this.rawGeometry;this.geometry=[];for(var We=0;We<Ue.length;We++){for(var he=Ue[We],xe=[],De=0;De<he.length;De++)xe.push(new e.Point$1(he[De][0],he[De][1]));this.geometry.push(xe)}return this.geometry},L.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ue=this.geometry,We=1/0,he=-1/0,xe=1/0,De=-1/0,qe=0;qe<Ue.length;qe++)for(var Xe=Ue[qe],He=0;He<Xe.length;He++){var st=Xe[He];We=Math.min(We,st.x),he=Math.max(he,st.x),xe=Math.min(xe,st.y),De=Math.max(De,st.y)}return[We,xe,he,De]},L.prototype.toGeoJSON=_.prototype.toGeoJSON;var A=E,I=E,P=function(Ue,We){We=We||{};var he={};for(var xe in Ue)he[xe]=new w(Ue[xe].features,We),he[xe].name=xe,he[xe].version=We.version,he[xe].extent=We.extent;return E({layers:he})},S=w;function E(Ue){var We=new e.pbf;return function(he,xe){for(var De in he.layers)xe.writeMessage(3,D,he.layers[De])}(Ue,We),We.finish()}function D(Ue,We){var he;We.writeVarintField(15,Ue.version||1),We.writeStringField(1,Ue.name||""),We.writeVarintField(5,Ue.extent||4096);var xe={keys:[],values:[],keycache:{},valuecache:{}};for(he=0;he<Ue.length;he++)xe.feature=Ue.feature(he),We.writeMessage(2,R,xe);var De=xe.keys;for(he=0;he<De.length;he++)We.writeStringField(3,De[he]);var qe=xe.values;for(he=0;he<qe.length;he++)We.writeMessage(4,G,qe[he])}function R(Ue,We){var he=Ue.feature;he.id!==void 0&&We.writeVarintField(1,he.id),We.writeMessage(2,H,Ue),We.writeVarintField(3,he.type),We.writeMessage(4,$,he)}function H(Ue,We){var he=Ue.feature,xe=Ue.keys,De=Ue.values,qe=Ue.keycache,Xe=Ue.valuecache;for(var He in he.properties){var st=qe[He];st===void 0&&(xe.push(He),st=xe.length-1,qe[He]=st),We.writeVarint(st);var it=he.properties[He],Tt=typeof it;Tt!=="string"&&Tt!=="boolean"&&Tt!=="number"&&(it=JSON.stringify(it));var Pt=Tt+":"+it,rt=Xe[Pt];rt===void 0&&(De.push(it),rt=De.length-1,Xe[Pt]=rt),We.writeVarint(rt)}}function V(Ue,We){return(We<<3)+(7&Ue)}function X(Ue){return Ue<<1^Ue>>31}function $(Ue,We){for(var he=Ue.loadGeometry(),xe=Ue.type,De=0,qe=0,Xe=he.length,He=0;He<Xe;He++){var st=he[He],it=1;xe===1&&(it=st.length),We.writeVarint(V(1,it));for(var Tt=xe===3?st.length-1:st.length,Pt=0;Pt<Tt;Pt++){Pt===1&&xe!==1&&We.writeVarint(V(2,Tt-1));var rt=st[Pt].x-De,ut=st[Pt].y-qe;We.writeVarint(X(rt)),We.writeVarint(X(ut)),De+=rt,qe+=ut}xe===3&&We.writeVarint(V(7,1))}}function G(Ue,We){var he=typeof Ue;he==="string"?We.writeStringField(1,Ue):he==="boolean"?We.writeBooleanField(7,Ue):he==="number"&&(Ue%1!=0?We.writeDoubleField(3,Ue):Ue<0?We.writeSVarintField(6,Ue):We.writeVarintField(5,Ue))}function W(Ue,We,he,xe,De,qe){if(!(De-xe<=he)){var Xe=xe+De>>1;(function He(st,it,Tt,Pt,rt,ut){for(;rt>Pt;){if(rt-Pt>600){var Ft=rt-Pt+1,wt=Tt-Pt+1,Lt=Math.log(Ft),Ae=.5*Math.exp(2*Lt/3),Ye=.5*Math.sqrt(Lt*Ae*(Ft-Ae)/Ft)*(wt-Ft/2<0?-1:1),nt=Math.max(Pt,Math.floor(Tt-wt*Ae/Ft+Ye)),ft=Math.min(rt,Math.floor(Tt+(Ft-wt)*Ae/Ft+Ye));He(st,it,Tt,nt,ft,ut)}var Mt=it[2*Tt+ut],Rt=Pt,Gt=rt;for(te(st,it,Pt,Tt),it[2*rt+ut]>Mt&&te(st,it,Pt,rt);Rt<Gt;){for(te(st,it,Rt,Gt),Rt++,Gt--;it[2*Rt+ut]<Mt;)Rt++;for(;it[2*Gt+ut]>Mt;)Gt--}it[2*Pt+ut]===Mt?te(st,it,Pt,Gt):(Gt++,te(st,it,Gt,rt)),Gt<=Tt&&(Pt=Gt+1),Tt<=Gt&&(rt=Gt-1)}})(Ue,We,Xe,xe,De,qe%2),W(Ue,We,he,xe,Xe-1,qe+1),W(Ue,We,he,Xe+1,De,qe+1)}}function te(Ue,We,he,xe){N(Ue,he,xe),N(We,2*he,2*xe),N(We,2*he+1,2*xe+1)}function N(Ue,We,he){var xe=Ue[We];Ue[We]=Ue[he],Ue[he]=xe}function B(Ue,We,he,xe){var De=Ue-he,qe=We-xe;return De*De+qe*qe}A.fromVectorTileJs=I,A.fromGeojsonVt=P,A.GeoJSONWrapper=S;var U=function(Ue){return Ue[0]},ee=function(Ue){return Ue[1]},j=function(Ue,We,he,xe,De){We===void 0&&(We=U),he===void 0&&(he=ee),xe===void 0&&(xe=64),De===void 0&&(De=Float64Array),this.nodeSize=xe,this.points=Ue;for(var qe=Ue.length<65536?Uint16Array:Uint32Array,Xe=this.ids=new qe(Ue.length),He=this.coords=new De(2*Ue.length),st=0;st<Ue.length;st++)Xe[st]=st,He[2*st]=We(Ue[st]),He[2*st+1]=he(Ue[st]);W(Xe,He,xe,0,Xe.length-1,0)};j.prototype.range=function(Ue,We,he,xe){return function(De,qe,Xe,He,st,it,Tt){for(var Pt,rt,ut=[0,De.length-1,0],Ft=[];ut.length;){var wt=ut.pop(),Lt=ut.pop(),Ae=ut.pop();if(Lt-Ae<=Tt)for(var Ye=Ae;Ye<=Lt;Ye++)Pt=qe[2*Ye],rt=qe[2*Ye+1],Pt>=Xe&&Pt<=st&&rt>=He&&rt<=it&&Ft.push(De[Ye]);else{var nt=Math.floor((Ae+Lt)/2);Pt=qe[2*nt],rt=qe[2*nt+1],Pt>=Xe&&Pt<=st&&rt>=He&&rt<=it&&Ft.push(De[nt]);var ft=(wt+1)%2;(wt===0?Xe<=Pt:He<=rt)&&(ut.push(Ae),ut.push(nt-1),ut.push(ft)),(wt===0?st>=Pt:it>=rt)&&(ut.push(nt+1),ut.push(Lt),ut.push(ft))}}return Ft}(this.ids,this.coords,Ue,We,he,xe,this.nodeSize)},j.prototype.within=function(Ue,We,he){return function(xe,De,qe,Xe,He,st){for(var it=[0,xe.length-1,0],Tt=[],Pt=He*He;it.length;){var rt=it.pop(),ut=it.pop(),Ft=it.pop();if(ut-Ft<=st)for(var wt=Ft;wt<=ut;wt++)B(De[2*wt],De[2*wt+1],qe,Xe)<=Pt&&Tt.push(xe[wt]);else{var Lt=Math.floor((Ft+ut)/2),Ae=De[2*Lt],Ye=De[2*Lt+1];B(Ae,Ye,qe,Xe)<=Pt&&Tt.push(xe[Lt]);var nt=(rt+1)%2;(rt===0?qe-He<=Ae:Xe-He<=Ye)&&(it.push(Ft),it.push(Lt-1),it.push(nt)),(rt===0?qe+He>=Ae:Xe+He>=Ye)&&(it.push(Lt+1),it.push(ut),it.push(nt))}}return Tt}(this.ids,this.coords,Ue,We,he,this.nodeSize)};var Q={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ue){return Ue}},K=function(Ue){this.options=me(Object.create(Q),Ue),this.trees=new Array(this.options.maxZoom+1)};function re(Ue,We,he,xe,De){return{x:Ue,y:We,zoom:1/0,id:he,parentId:-1,numPoints:xe,properties:De}}function ne(Ue,We){var he=Ue.geometry.coordinates,xe=he[0],De=he[1];return{x:de(xe),y:se(De),zoom:1/0,index:We,parentId:-1}}function le(Ue){return{type:"Feature",id:Ue.id,properties:oe(Ue),geometry:{type:"Point",coordinates:[(xe=Ue.x,360*(xe-.5)),(We=Ue.y,he=(180-360*We)*Math.PI/180,360*Math.atan(Math.exp(he))/Math.PI-90)]}};var We,he,xe}function oe(Ue){var We=Ue.numPoints,he=We>=1e4?Math.round(We/1e3)+"k":We>=1e3?Math.round(We/100)/10+"k":We;return me(me({},Ue.properties),{cluster:!0,cluster_id:Ue.id,point_count:We,point_count_abbreviated:he})}function de(Ue){return Ue/360+.5}function se(Ue){var We=Math.sin(Ue*Math.PI/180),he=.5-.25*Math.log((1+We)/(1-We))/Math.PI;return he<0?0:he>1?1:he}function me(Ue,We){for(var he in We)Ue[he]=We[he];return Ue}function Te(Ue){return Ue.x}function _e(Ue){return Ue.y}function be(Ue,We,he,xe,De,qe){var Xe=De-he,He=qe-xe;if(Xe!==0||He!==0){var st=((Ue-he)*Xe+(We-xe)*He)/(Xe*Xe+He*He);st>1?(he=De,xe=qe):st>0&&(he+=Xe*st,xe+=He*st)}return(Xe=Ue-he)*Xe+(He=We-xe)*He}function Ce(Ue,We,he,xe){var De={id:Ue===void 0?null:Ue,type:We,geometry:he,tags:xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(qe){var Xe=qe.geometry,He=qe.type;if(He==="Point"||He==="MultiPoint"||He==="LineString")fe(qe,Xe);else if(He==="Polygon"||He==="MultiLineString")for(var st=0;st<Xe.length;st++)fe(qe,Xe[st]);else if(He==="MultiPolygon")for(st=0;st<Xe.length;st++)for(var it=0;it<Xe[st].length;it++)fe(qe,Xe[st][it])}(De),De}function fe(Ue,We){for(var he=0;he<We.length;he+=3)Ue.minX=Math.min(Ue.minX,We[he]),Ue.minY=Math.min(Ue.minY,We[he+1]),Ue.maxX=Math.max(Ue.maxX,We[he]),Ue.maxY=Math.max(Ue.maxY,We[he+1])}function ve(Ue,We,he,xe){if(We.geometry){var De=We.geometry.coordinates,qe=We.geometry.type,Xe=Math.pow(he.tolerance/((1<<he.maxZoom)*he.extent),2),He=[],st=We.id;if(he.promoteId?st=We.properties[he.promoteId]:he.generateId&&(st=xe||0),qe==="Point")Me(De,He);else if(qe==="MultiPoint")for(var it=0;it<De.length;it++)Me(De[it],He);else if(qe==="LineString")ke(De,He,Xe,!1);else if(qe==="MultiLineString"){if(he.lineMetrics){for(it=0;it<De.length;it++)He=[],ke(De[it],He,Xe,!1),Ue.push(Ce(st,"LineString",He,We.properties));return}Le(De,He,Xe,!1)}else if(qe==="Polygon")Le(De,He,Xe,!0);else{if(qe!=="MultiPolygon"){if(qe==="GeometryCollection"){for(it=0;it<We.geometry.geometries.length;it++)ve(Ue,{id:st,geometry:We.geometry.geometries[it],properties:We.properties},he,xe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(it=0;it<De.length;it++){var Tt=[];Le(De[it],Tt,Xe,!0),He.push(Tt)}}Ue.push(Ce(st,qe,He,We.properties))}}function Me(Ue,We){We.push(ze(Ue[0])),We.push(Re(Ue[1])),We.push(0)}function ke(Ue,We,he,xe){for(var De,qe,Xe=0,He=0;He<Ue.length;He++){var st=ze(Ue[He][0]),it=Re(Ue[He][1]);We.push(st),We.push(it),We.push(0),He>0&&(Xe+=xe?(De*it-st*qe)/2:Math.sqrt(Math.pow(st-De,2)+Math.pow(it-qe,2))),De=st,qe=it}var Tt=We.length-3;We[2]=1,function Pt(rt,ut,Ft,wt){for(var Lt,Ae=wt,Ye=Ft-ut>>1,nt=Ft-ut,ft=rt[ut],Mt=rt[ut+1],Rt=rt[Ft],Gt=rt[Ft+1],jt=ut+3;jt<Ft;jt+=3){var pr=be(rt[jt],rt[jt+1],ft,Mt,Rt,Gt);if(pr>Ae)Lt=jt,Ae=pr;else if(pr===Ae){var Ar=Math.abs(jt-Ye);Ar<nt&&(Lt=jt,nt=Ar)}}Ae>wt&&(Lt-ut>3&&Pt(rt,ut,Lt,wt),rt[Lt+2]=Ae,Ft-Lt>3&&Pt(rt,Lt,Ft,wt))}(We,0,Tt,he),We[Tt+2]=1,We.size=Math.abs(Xe),We.start=0,We.end=We.size}function Le(Ue,We,he,xe){for(var De=0;De<Ue.length;De++){var qe=[];ke(Ue[De],qe,he,xe),We.push(qe)}}function ze(Ue){return Ue/360+.5}function Re(Ue){var We=Math.sin(Ue*Math.PI/180),he=.5-.25*Math.log((1+We)/(1-We))/Math.PI;return he<0?0:he>1?1:he}function Oe(Ue,We,he,xe,De,qe,Xe,He){if(xe/=We,qe>=(he/=We)&&Xe<xe)return Ue;if(Xe<he||qe>=xe)return null;for(var st=[],it=0;it<Ue.length;it++){var Tt=Ue[it],Pt=Tt.geometry,rt=Tt.type,ut=De===0?Tt.minX:Tt.minY,Ft=De===0?Tt.maxX:Tt.maxY;if(ut>=he&&Ft<xe)st.push(Tt);else if(!(Ft<he||ut>=xe)){var wt=[];if(rt==="Point"||rt==="MultiPoint")Ze(Pt,wt,he,xe,De);else if(rt==="LineString")Pe(Pt,wt,he,xe,De,!1,He.lineMetrics);else if(rt==="MultiLineString")Be(Pt,wt,he,xe,De,!1);else if(rt==="Polygon")Be(Pt,wt,he,xe,De,!0);else if(rt==="MultiPolygon")for(var Lt=0;Lt<Pt.length;Lt++){var Ae=[];Be(Pt[Lt],Ae,he,xe,De,!0),Ae.length&&wt.push(Ae)}if(wt.length){if(He.lineMetrics&&rt==="LineString"){for(Lt=0;Lt<wt.length;Lt++)st.push(Ce(Tt.id,rt,wt[Lt],Tt.tags));continue}rt!=="LineString"&&rt!=="MultiLineString"||(wt.length===1?(rt="LineString",wt=wt[0]):rt="MultiLineString"),rt!=="Point"&&rt!=="MultiPoint"||(rt=wt.length===3?"Point":"MultiPoint"),st.push(Ce(Tt.id,rt,wt,Tt.tags))}}}return st.length?st:null}function Ze(Ue,We,he,xe,De){for(var qe=0;qe<Ue.length;qe+=3){var Xe=Ue[qe+De];Xe>=he&&Xe<=xe&&(We.push(Ue[qe]),We.push(Ue[qe+1]),We.push(Ue[qe+2]))}}function Pe(Ue,We,he,xe,De,qe,Xe){for(var He,st,it=Ie(Ue),Tt=De===0?$e:ot,Pt=Ue.start,rt=0;rt<Ue.length-3;rt+=3){var ut=Ue[rt],Ft=Ue[rt+1],wt=Ue[rt+2],Lt=Ue[rt+3],Ae=Ue[rt+4],Ye=De===0?ut:Ft,nt=De===0?Lt:Ae,ft=!1;Xe&&(He=Math.sqrt(Math.pow(ut-Lt,2)+Math.pow(Ft-Ae,2))),Ye<he?nt>he&&(st=Tt(it,ut,Ft,Lt,Ae,he),Xe&&(it.start=Pt+He*st)):Ye>xe?nt<xe&&(st=Tt(it,ut,Ft,Lt,Ae,xe),Xe&&(it.start=Pt+He*st)):Fe(it,ut,Ft,wt),nt<he&&Ye>=he&&(st=Tt(it,ut,Ft,Lt,Ae,he),ft=!0),nt>xe&&Ye<=xe&&(st=Tt(it,ut,Ft,Lt,Ae,xe),ft=!0),!qe&&ft&&(Xe&&(it.end=Pt+He*st),We.push(it),it=Ie(Ue)),Xe&&(Pt+=He)}var Mt=Ue.length-3;ut=Ue[Mt],Ft=Ue[Mt+1],wt=Ue[Mt+2],(Ye=De===0?ut:Ft)>=he&&Ye<=xe&&Fe(it,ut,Ft,wt),Mt=it.length-3,qe&&Mt>=3&&(it[Mt]!==it[0]||it[Mt+1]!==it[1])&&Fe(it,it[0],it[1],it[2]),it.length&&We.push(it)}function Ie(Ue){var We=[];return We.size=Ue.size,We.start=Ue.start,We.end=Ue.end,We}function Be(Ue,We,he,xe,De,qe){for(var Xe=0;Xe<Ue.length;Xe++)Pe(Ue[Xe],We,he,xe,De,qe,!1)}function Fe(Ue,We,he,xe){Ue.push(We),Ue.push(he),Ue.push(xe)}function $e(Ue,We,he,xe,De,qe){var Xe=(qe-We)/(xe-We);return Ue.push(qe),Ue.push(he+(De-he)*Xe),Ue.push(1),Xe}function ot(Ue,We,he,xe,De,qe){var Xe=(qe-he)/(De-he);return Ue.push(We+(xe-We)*Xe),Ue.push(qe),Ue.push(1),Xe}function pt(Ue,We){for(var he=[],xe=0;xe<Ue.length;xe++){var De,qe=Ue[xe],Xe=qe.type;if(Xe==="Point"||Xe==="MultiPoint"||Xe==="LineString")De=_t(qe.geometry,We);else if(Xe==="MultiLineString"||Xe==="Polygon"){De=[];for(var He=0;He<qe.geometry.length;He++)De.push(_t(qe.geometry[He],We))}else if(Xe==="MultiPolygon")for(De=[],He=0;He<qe.geometry.length;He++){for(var st=[],it=0;it<qe.geometry[He].length;it++)st.push(_t(qe.geometry[He][it],We));De.push(st)}he.push(Ce(qe.id,Xe,De,qe.tags))}return he}function _t(Ue,We){var he=[];he.size=Ue.size,Ue.start!==void 0&&(he.start=Ue.start,he.end=Ue.end);for(var xe=0;xe<Ue.length;xe+=3)he.push(Ue[xe]+We,Ue[xe+1],Ue[xe+2]);return he}function yt(Ue,We){if(Ue.transformed)return Ue;var he,xe,De,qe=1<<Ue.z,Xe=Ue.x,He=Ue.y;for(he=0;he<Ue.features.length;he++){var st=Ue.features[he],it=st.geometry,Tt=st.type;if(st.geometry=[],Tt===1)for(xe=0;xe<it.length;xe+=2)st.geometry.push(tt(it[xe],it[xe+1],We,qe,Xe,He));else for(xe=0;xe<it.length;xe++){var Pt=[];for(De=0;De<it[xe].length;De+=2)Pt.push(tt(it[xe][De],it[xe][De+1],We,qe,Xe,He));st.geometry.push(Pt)}}return Ue.transformed=!0,Ue}function tt(Ue,We,he,xe,De,qe){return[Math.round(he*(Ue*xe-De)),Math.round(he*(We*xe-qe))]}function Ke(Ue,We,he,xe,De){for(var qe=We===De.maxZoom?0:De.tolerance/((1<<We)*De.extent),Xe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:he,y:xe,z:We,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},He=0;He<Ue.length;He++){Xe.numFeatures++,vt(Xe,Ue[He],qe,De);var st=Ue[He].minX,it=Ue[He].minY,Tt=Ue[He].maxX,Pt=Ue[He].maxY;st<Xe.minX&&(Xe.minX=st),it<Xe.minY&&(Xe.minY=it),Tt>Xe.maxX&&(Xe.maxX=Tt),Pt>Xe.maxY&&(Xe.maxY=Pt)}return Xe}function vt(Ue,We,he,xe){var De=We.geometry,qe=We.type,Xe=[];if(qe==="Point"||qe==="MultiPoint")for(var He=0;He<De.length;He+=3)Xe.push(De[He]),Xe.push(De[He+1]),Ue.numPoints++,Ue.numSimplified++;else if(qe==="LineString")Nt(Xe,De,Ue,he,!1,!1);else if(qe==="MultiLineString"||qe==="Polygon")for(He=0;He<De.length;He++)Nt(Xe,De[He],Ue,he,qe==="Polygon",He===0);else if(qe==="MultiPolygon")for(var st=0;st<De.length;st++){var it=De[st];for(He=0;He<it.length;He++)Nt(Xe,it[He],Ue,he,!0,He===0)}if(Xe.length){var Tt=We.tags||null;if(qe==="LineString"&&xe.lineMetrics){for(var Pt in Tt={},We.tags)Tt[Pt]=We.tags[Pt];Tt.mapbox_clip_start=De.start/De.size,Tt.mapbox_clip_end=De.end/De.size}var rt={geometry:Xe,type:qe==="Polygon"||qe==="MultiPolygon"?3:qe==="LineString"||qe==="MultiLineString"?2:1,tags:Tt};We.id!==null&&(rt.id=We.id),Ue.features.push(rt)}}function Nt(Ue,We,he,xe,De,qe){var Xe=xe*xe;if(xe>0&&We.size<(De?Xe:xe))he.numPoints+=We.length/3;else{for(var He=[],st=0;st<We.length;st+=3)(xe===0||We[st+2]>Xe)&&(he.numSimplified++,He.push(We[st]),He.push(We[st+1])),he.numPoints++;De&&function(it,Tt){for(var Pt=0,rt=0,ut=it.length,Ft=ut-2;rt<ut;Ft=rt,rt+=2)Pt+=(it[rt]-it[Ft])*(it[rt+1]+it[Ft+1]);if(Pt>0===Tt)for(rt=0,ut=it.length;rt<ut/2;rt+=2){var wt=it[rt],Lt=it[rt+1];it[rt]=it[ut-2-rt],it[rt+1]=it[ut-1-rt],it[ut-2-rt]=wt,it[ut-1-rt]=Lt}}(He,qe),Ue.push(He)}}function qt(Ue,We){var he=(We=this.options=function(De,qe){for(var Xe in qe)De[Xe]=qe[Xe];return De}(Object.create(this.options),We)).debug;if(he&&console.time("preprocess data"),We.maxZoom<0||We.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(We.promoteId&&We.generateId)throw new Error("promoteId and generateId cannot be used together.");var xe=function(De,qe){var Xe=[];if(De.type==="FeatureCollection")for(var He=0;He<De.features.length;He++)ve(Xe,De.features[He],qe,He);else De.type==="Feature"?ve(Xe,De,qe):ve(Xe,{geometry:De},qe);return Xe}(Ue,We);this.tiles={},this.tileCoords=[],he&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",We.indexMaxZoom,We.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(xe=function(De,qe){var Xe=qe.buffer/qe.extent,He=De,st=Oe(De,1,-1-Xe,Xe,0,-1,2,qe),it=Oe(De,1,1-Xe,2+Xe,0,-1,2,qe);return(st||it)&&(He=Oe(De,1,-Xe,1+Xe,0,-1,2,qe)||[],st&&(He=pt(st,1).concat(He)),it&&(He=He.concat(pt(it,-1)))),He}(xe,We)).length&&this.splitTile(xe,0,0,0),he&&(xe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function er(Ue,We,he){return 32*((1<<Ue)*he+We)+Ue}function Jt(Ue,We){var he=Ue.tileID.canonical;if(!this._geoJSONIndex)return We(null,null);var xe=this._geoJSONIndex.getTile(he.z,he.x,he.y);if(!xe)return We(null,null);var De=new T(xe.features),qe=A(De);qe.byteOffset===0&&qe.byteLength===qe.buffer.byteLength||(qe=new Uint8Array(qe)),We(null,{vectorTile:De,rawData:qe.buffer})}K.prototype.load=function(Ue){var We=this.options,he=We.log,xe=We.minZoom,De=We.maxZoom,qe=We.nodeSize;he&&console.time("total time");var Xe="prepare "+Ue.length+" points";he&&console.time(Xe),this.points=Ue;for(var He=[],st=0;st<Ue.length;st++)Ue[st].geometry&&He.push(ne(Ue[st],st));this.trees[De+1]=new j(He,Te,_e,qe,Float32Array),he&&console.timeEnd(Xe);for(var it=De;it>=xe;it--){var Tt=+Date.now();He=this._cluster(He,it),this.trees[it]=new j(He,Te,_e,qe,Float32Array),he&&console.log("z%d: %d clusters in %dms",it,He.length,+Date.now()-Tt)}return he&&console.timeEnd("total time"),this},K.prototype.getClusters=function(Ue,We){var he=((Ue[0]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,Ue[1])),De=Ue[2]===180?180:((Ue[2]+180)%360+360)%360-180,qe=Math.max(-90,Math.min(90,Ue[3]));if(Ue[2]-Ue[0]>=360)he=-180,De=180;else if(he>De){var Xe=this.getClusters([he,xe,180,qe],We),He=this.getClusters([-180,xe,De,qe],We);return Xe.concat(He)}for(var st=this.trees[this._limitZoom(We)],it=[],Tt=0,Pt=st.range(de(he),se(qe),de(De),se(xe));Tt<Pt.length;Tt+=1){var rt=Pt[Tt],ut=st.points[rt];it.push(ut.numPoints?le(ut):this.points[ut.index])}return it},K.prototype.getChildren=function(Ue){var We=this._getOriginId(Ue),he=this._getOriginZoom(Ue),xe="No cluster with the specified id.",De=this.trees[he];if(!De)throw new Error(xe);var qe=De.points[We];if(!qe)throw new Error(xe);for(var Xe=this.options.radius/(this.options.extent*Math.pow(2,he-1)),He=[],st=0,it=De.within(qe.x,qe.y,Xe);st<it.length;st+=1){var Tt=it[st],Pt=De.points[Tt];Pt.parentId===Ue&&He.push(Pt.numPoints?le(Pt):this.points[Pt.index])}if(He.length===0)throw new Error(xe);return He},K.prototype.getLeaves=function(Ue,We,he){We=We||10,he=he||0;var xe=[];return this._appendLeaves(xe,Ue,We,he,0),xe},K.prototype.getTile=function(Ue,We,he){var xe=this.trees[this._limitZoom(Ue)],De=Math.pow(2,Ue),qe=this.options,Xe=qe.extent,He=qe.radius/Xe,st=(he-He)/De,it=(he+1+He)/De,Tt={features:[]};return this._addTileFeatures(xe.range((We-He)/De,st,(We+1+He)/De,it),xe.points,We,he,De,Tt),We===0&&this._addTileFeatures(xe.range(1-He/De,st,1,it),xe.points,De,he,De,Tt),We===De-1&&this._addTileFeatures(xe.range(0,st,He/De,it),xe.points,-1,he,De,Tt),Tt.features.length?Tt:null},K.prototype.getClusterExpansionZoom=function(Ue){for(var We=this._getOriginZoom(Ue)-1;We<=this.options.maxZoom;){var he=this.getChildren(Ue);if(We++,he.length!==1)break;Ue=he[0].properties.cluster_id}return We},K.prototype._appendLeaves=function(Ue,We,he,xe,De){for(var qe=0,Xe=this.getChildren(We);qe<Xe.length;qe+=1){var He=Xe[qe],st=He.properties;if(st&&st.cluster?De+st.point_count<=xe?De+=st.point_count:De=this._appendLeaves(Ue,st.cluster_id,he,xe,De):De<xe?De++:Ue.push(He),Ue.length===he)break}return De},K.prototype._addTileFeatures=function(Ue,We,he,xe,De,qe){for(var Xe=0,He=Ue;Xe<He.length;Xe+=1){var st=We[He[Xe]],it=st.numPoints,Tt={type:1,geometry:[[Math.round(this.options.extent*(st.x*De-he)),Math.round(this.options.extent*(st.y*De-xe))]],tags:it?oe(st):this.points[st.index].properties},Pt=void 0;it?Pt=st.id:this.options.generateId?Pt=st.index:this.points[st.index].id&&(Pt=this.points[st.index].id),Pt!==void 0&&(Tt.id=Pt),qe.features.push(Tt)}},K.prototype._limitZoom=function(Ue){return Math.max(this.options.minZoom,Math.min(Ue,this.options.maxZoom+1))},K.prototype._cluster=function(Ue,We){for(var he=[],xe=this.options,De=xe.radius,qe=xe.extent,Xe=xe.reduce,He=De/(qe*Math.pow(2,We)),st=0;st<Ue.length;st++){var it=Ue[st];if(!(it.zoom<=We)){it.zoom=We;for(var Tt=this.trees[We+1],Pt=Tt.within(it.x,it.y,He),rt=it.numPoints||1,ut=it.x*rt,Ft=it.y*rt,wt=Xe&&rt>1?this._map(it,!0):null,Lt=(st<<5)+(We+1)+this.points.length,Ae=0,Ye=Pt;Ae<Ye.length;Ae+=1){var nt=Ye[Ae],ft=Tt.points[nt];if(!(ft.zoom<=We)){ft.zoom=We;var Mt=ft.numPoints||1;ut+=ft.x*Mt,Ft+=ft.y*Mt,rt+=Mt,ft.parentId=Lt,Xe&&(wt||(wt=this._map(it,!0)),Xe(wt,this._map(ft)))}}rt===1?he.push(it):(it.parentId=Lt,he.push(re(ut/rt,Ft/rt,Lt,rt,wt)))}}return he},K.prototype._getOriginId=function(Ue){return Ue-this.points.length>>5},K.prototype._getOriginZoom=function(Ue){return(Ue-this.points.length)%32},K.prototype._map=function(Ue,We){if(Ue.numPoints)return We?me({},Ue.properties):Ue.properties;var he=this.points[Ue.index].properties,xe=this.options.map(he);return We&&xe===he?me({},xe):xe},qt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},qt.prototype.splitTile=function(Ue,We,he,xe,De,qe,Xe){for(var He=[Ue,We,he,xe],st=this.options,it=st.debug;He.length;){xe=He.pop(),he=He.pop(),We=He.pop(),Ue=He.pop();var Tt=1<<We,Pt=er(We,he,xe),rt=this.tiles[Pt];if(!rt&&(it>1&&console.time("creation"),rt=this.tiles[Pt]=Ke(Ue,We,he,xe,st),this.tileCoords.push({z:We,x:he,y:xe}),it)){it>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",We,he,xe,rt.numFeatures,rt.numPoints,rt.numSimplified),console.timeEnd("creation"));var ut="z"+We;this.stats[ut]=(this.stats[ut]||0)+1,this.total++}if(rt.source=Ue,De){if(We===st.maxZoom||We===De)continue;var Ft=1<<De-We;if(he!==Math.floor(qe/Ft)||xe!==Math.floor(Xe/Ft))continue}else if(We===st.indexMaxZoom||rt.numPoints<=st.indexMaxPoints)continue;if(rt.source=null,Ue.length!==0){it>1&&console.time("clipping");var wt,Lt,Ae,Ye,nt,ft,Mt=.5*st.buffer/st.extent,Rt=.5-Mt,Gt=.5+Mt,jt=1+Mt;wt=Lt=Ae=Ye=null,nt=Oe(Ue,Tt,he-Mt,he+Gt,0,rt.minX,rt.maxX,st),ft=Oe(Ue,Tt,he+Rt,he+jt,0,rt.minX,rt.maxX,st),Ue=null,nt&&(wt=Oe(nt,Tt,xe-Mt,xe+Gt,1,rt.minY,rt.maxY,st),Lt=Oe(nt,Tt,xe+Rt,xe+jt,1,rt.minY,rt.maxY,st),nt=null),ft&&(Ae=Oe(ft,Tt,xe-Mt,xe+Gt,1,rt.minY,rt.maxY,st),Ye=Oe(ft,Tt,xe+Rt,xe+jt,1,rt.minY,rt.maxY,st),ft=null),it>1&&console.timeEnd("clipping"),He.push(wt||[],We+1,2*he,2*xe),He.push(Lt||[],We+1,2*he,2*xe+1),He.push(Ae||[],We+1,2*he+1,2*xe),He.push(Ye||[],We+1,2*he+1,2*xe+1)}}},qt.prototype.getTile=function(Ue,We,he){var xe=this.options,De=xe.extent,qe=xe.debug;if(Ue<0||Ue>24)return null;var Xe=1<<Ue,He=er(Ue,We=(We%Xe+Xe)%Xe,he);if(this.tiles[He])return yt(this.tiles[He],De);qe>1&&console.log("drilling down to z%d-%d-%d",Ue,We,he);for(var st,it=Ue,Tt=We,Pt=he;!st&&it>0;)it--,Tt=Math.floor(Tt/2),Pt=Math.floor(Pt/2),st=this.tiles[er(it,Tt,Pt)];return st&&st.source?(qe>1&&console.log("found parent tile z%d-%d-%d",it,Tt,Pt),qe>1&&console.time("drilling down"),this.splitTile(st.source,it,Tt,Pt,Ue,We,he),qe>1&&console.timeEnd("drilling down"),this.tiles[He]?yt(this.tiles[He],De):null):null};var ir=function(Ue){function We(he,xe,De,qe){Ue.call(this,he,xe,De,Jt),qe&&(this.loadGeoJSON=qe)}return Ue&&(We.__proto__=Ue),We.prototype=Object.create(Ue&&Ue.prototype),We.prototype.constructor=We,We.prototype.loadData=function(he,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=xe,this._pendingLoadDataParams=he,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},We.prototype._loadData=function(){var he=this;if(this._pendingCallback&&this._pendingLoadDataParams){var xe=this._pendingCallback,De=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var qe=!!(De&&De.request&&De.request.collectResourceTiming)&&new e.RequestPerformance(De.request);this.loadGeoJSON(De,function(Xe,He){if(Xe||!He)return xe(Xe);if(typeof He!="object")return xe(new Error("Input data given to '"+De.source+"' is not a valid GeoJSON object."));h(He,!0);try{he._geoJSONIndex=De.cluster?new K(function(Tt){var Pt=Tt.superclusterOptions,rt=Tt.clusterProperties;if(!rt||!Pt)return Pt;for(var ut={},Ft={},wt={accumulated:null,zoom:0},Lt={properties:null},Ae=Object.keys(rt),Ye=0,nt=Ae;Ye<nt.length;Ye+=1){var ft=nt[Ye],Mt=rt[ft],Rt=Mt[0],Gt=Mt[1],jt=e.createExpression(Gt),pr=e.createExpression(typeof Rt=="string"?[Rt,["accumulated"],["get",ft]]:Rt);ut[ft]=jt.value,Ft[ft]=pr.value}return Pt.map=function(Ar){Lt.properties=Ar;for(var fr={},Zt=0,Qt=Ae;Zt<Qt.length;Zt+=1){var $t=Qt[Zt];fr[$t]=ut[$t].evaluate(wt,Lt)}return fr},Pt.reduce=function(Ar,fr){Lt.properties=fr;for(var Zt=0,Qt=Ae;Zt<Qt.length;Zt+=1){var $t=Qt[Zt];wt.accumulated=Ar[$t],Ar[$t]=Ft[$t].evaluate(wt,Lt)}},Pt}(De)).load(He.features):function(Tt,Pt){return new qt(Tt,Pt)}(He,De.geojsonVtOptions)}catch(Tt){return xe(Tt)}he.loaded={};var st={};if(qe){var it=qe.finish();it&&(st.resourceTiming={},st.resourceTiming[De.source]=JSON.parse(JSON.stringify(it)))}xe(null,st)})}},We.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},We.prototype.reloadTile=function(he,xe){var De=this.loaded,qe=he.uid;return De&&De[qe]?Ue.prototype.reloadTile.call(this,he,xe):this.loadTile(he,xe)},We.prototype.loadGeoJSON=function(he,xe){if(he.request)e.getJSON(he.request,xe);else{if(typeof he.data!="string")return xe(new Error("Input data given to '"+he.source+"' is not a valid GeoJSON object."));try{return xe(null,JSON.parse(he.data))}catch{return xe(new Error("Input data given to '"+he.source+"' is not a valid GeoJSON object."))}}},We.prototype.removeSource=function(he,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),xe()},We.prototype.getClusterExpansionZoom=function(he,xe){try{xe(null,this._geoJSONIndex.getClusterExpansionZoom(he.clusterId))}catch(De){xe(De)}},We.prototype.getClusterChildren=function(he,xe){try{xe(null,this._geoJSONIndex.getChildren(he.clusterId))}catch(De){xe(De)}},We.prototype.getClusterLeaves=function(he,xe){try{xe(null,this._geoJSONIndex.getLeaves(he.clusterId,he.limit,he.offset))}catch(De){xe(De)}},We}(u),Ht=function(Ue){var We=this;this.self=Ue,this.actor=new e.Actor(Ue,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:u,geojson:ir},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(he,xe){if(We.workerSourceTypes[he])throw new Error('Worker source with name "'+he+'" already registered.');We.workerSourceTypes[he]=xe},this.self.registerRTLTextPlugin=function(he){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=he.applyArabicShaping,e.plugin.processBidirectionalText=he.processBidirectionalText,e.plugin.processStyledBidirectionalText=he.processStyledBidirectionalText}};return Ht.prototype.setReferrer=function(Ue,We){this.referrer=We},Ht.prototype.setImages=function(Ue,We,he){for(var xe in this.availableImages[Ue]=We,this.workerSources[Ue]){var De=this.workerSources[Ue][xe];for(var qe in De)De[qe].availableImages=We}he()},Ht.prototype.setLayers=function(Ue,We,he){this.getLayerIndex(Ue).replace(We),he()},Ht.prototype.updateLayers=function(Ue,We,he){this.getLayerIndex(Ue).update(We.layers,We.removedIds),he()},Ht.prototype.loadTile=function(Ue,We,he){this.getWorkerSource(Ue,We.type,We.source).loadTile(We,he)},Ht.prototype.loadDEMTile=function(Ue,We,he){this.getDEMWorkerSource(Ue,We.source).loadTile(We,he)},Ht.prototype.reloadTile=function(Ue,We,he){this.getWorkerSource(Ue,We.type,We.source).reloadTile(We,he)},Ht.prototype.abortTile=function(Ue,We,he){this.getWorkerSource(Ue,We.type,We.source).abortTile(We,he)},Ht.prototype.removeTile=function(Ue,We,he){this.getWorkerSource(Ue,We.type,We.source).removeTile(We,he)},Ht.prototype.removeDEMTile=function(Ue,We){this.getDEMWorkerSource(Ue,We.source).removeTile(We)},Ht.prototype.removeSource=function(Ue,We,he){if(this.workerSources[Ue]&&this.workerSources[Ue][We.type]&&this.workerSources[Ue][We.type][We.source]){var xe=this.workerSources[Ue][We.type][We.source];delete this.workerSources[Ue][We.type][We.source],xe.removeSource!==void 0?xe.removeSource(We,he):he()}},Ht.prototype.loadWorkerSource=function(Ue,We,he){try{this.self.importScripts(We.url),he()}catch(xe){he(xe.toString())}},Ht.prototype.syncRTLPluginState=function(Ue,We,he){try{e.plugin.setState(We);var xe=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&xe!=null){this.self.importScripts(xe);var De=e.plugin.isParsed();he(De?void 0:new Error("RTL Text Plugin failed to import scripts from "+xe),De)}}catch(qe){he(qe.toString())}},Ht.prototype.getAvailableImages=function(Ue){var We=this.availableImages[Ue];return We||(We=[]),We},Ht.prototype.getLayerIndex=function(Ue){var We=this.layerIndexes[Ue];return We||(We=this.layerIndexes[Ue]=new a),We},Ht.prototype.getWorkerSource=function(Ue,We,he){var xe=this;if(this.workerSources[Ue]||(this.workerSources[Ue]={}),this.workerSources[Ue][We]||(this.workerSources[Ue][We]={}),!this.workerSources[Ue][We][he]){var De={send:function(qe,Xe,He){xe.actor.send(qe,Xe,He,Ue)}};this.workerSources[Ue][We][he]=new this.workerSourceTypes[We](De,this.getLayerIndex(Ue),this.getAvailableImages(Ue))}return this.workerSources[Ue][We][he]},Ht.prototype.getDEMWorkerSource=function(Ue,We){return this.demWorkerSources[Ue]||(this.demWorkerSources[Ue]={}),this.demWorkerSources[Ue][We]||(this.demWorkerSources[Ue][We]=new l),this.demWorkerSources[Ue][We]},Ht.prototype.enforceCacheSizeLimit=function(Ue,We){e.enforceCacheSizeLimit(We)},typeof WorkerGlobalScope<"u"&&e.window!==void 0&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new Ht(e.window)),Ht}),y(0,function(e){var n=e.createCommonjsModule(function(C){function z(ie){return!F(ie)}function F(ie){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var ue,ge,we=new Blob([""],{type:"text/javascript"}),Se=URL.createObjectURL(we);try{ge=new Worker(Se),ue=!0}catch{ue=!1}return ge&&ge.terminate(),URL.revokeObjectURL(Se),ue}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var ue=document.createElement("canvas");ue.width=ue.height=1;var ge=ue.getContext("2d");if(!ge)return!1;var we=ge.getImageData(0,0,1,1);return we&&we.width===ue.width}()?function(ue){return q[ue]===void 0&&(q[ue]=function(ge){var we=function(Ve){var Je=document.createElement("canvas"),at=Object.create(z.webGLContextAttributes);return at.failIfMajorPerformanceCaveat=Ve,Je.probablySupportsContext?Je.probablySupportsContext("webgl",at)||Je.probablySupportsContext("experimental-webgl",at):Je.supportsContext?Je.supportsContext("webgl",at)||Je.supportsContext("experimental-webgl",at):Je.getContext("webgl",at)||Je.getContext("experimental-webgl",at)}(ge);if(!we)return!1;var Se=we.createShader(we.VERTEX_SHADER);return!Se||we.isContextLost()?!1:(we.shaderSource(Se,"void main() {}"),we.compileShader(Se),we.getShaderParameter(Se,we.COMPILE_STATUS)===!0)}(ue)),q[ue]}(ie&&ie.failIfMajorPerformanceCaveat)?void 0:"insufficient WebGL support":"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support"}C.exports?C.exports=z:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=z,window.mapboxgl.notSupportedReason=F);var q={};z.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),t={create:function(C,z,F){var q=e.window.document.createElement(C);return z!==void 0&&(q.className=z),F&&F.appendChild(q),q},createNS:function(C,z){return e.window.document.createElementNS(C,z)}},a=e.window.document.documentElement.style;function r(C){if(!a)return C[0];for(var z=0;z<C.length;z++)if(C[z]in a)return C[z];return C[0]}var m,o=r(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);t.disableDrag=function(){a&&o&&(m=a[o],a[o]="none")},t.enableDrag=function(){a&&o&&(a[o]=m)};var i=r(["transform","WebkitTransform"]);t.setTransform=function(C,z){C.style[i]=z};var u=!1;try{var f=Object.defineProperty({},"passive",{get:function(){u=!0}});e.window.addEventListener("test",f,f),e.window.removeEventListener("test",f,f)}catch{u=!1}t.addEventListener=function(C,z,F,q){q===void 0&&(q={}),"passive"in q&&u?C.addEventListener(z,F,q):C.addEventListener(z,F,q.capture)},t.removeEventListener=function(C,z,F,q){q===void 0&&(q={}),"passive"in q&&u?C.removeEventListener(z,F,q):C.removeEventListener(z,F,q.capture)};var l=function(C){C.preventDefault(),C.stopPropagation(),e.window.removeEventListener("click",l,!0)};function h(C){var z=C.userImage;return z&&z.render&&z.render()?(C.data.replace(new Uint8Array(z.data.buffer)),!0):!1}t.suppressClick=function(){e.window.addEventListener("click",l,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",l,!0)},0)},t.mousePos=function(C,z){var F=C.getBoundingClientRect();return new e.Point(z.clientX-F.left-C.clientLeft,z.clientY-F.top-C.clientTop)},t.touchPos=function(C,z){for(var F=C.getBoundingClientRect(),q=[],ie=0;ie<z.length;ie++)q.push(new e.Point(z[ie].clientX-F.left-C.clientLeft,z[ie].clientY-F.top-C.clientTop));return q},t.mouseButton=function(C){return e.window.InstallTrigger!==void 0&&C.button===2&&C.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:C.button},t.remove=function(C){C.parentNode&&C.parentNode.removeChild(C)};var d=function(C){function z(){C.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.isLoaded=function(){return this.loaded},z.prototype.setLoaded=function(F){if(this.loaded!==F&&(this.loaded=F,F)){for(var q=0,ie=this.requestors;q<ie.length;q+=1){var ue=ie[q],ge=ue.ids,we=ue.callback;this._notify(ge,we)}this.requestors=[]}},z.prototype.getImage=function(F){return this.images[F]},z.prototype.addImage=function(F,q){this._validate(F,q)&&(this.images[F]=q)},z.prototype._validate=function(F,q){var ie=!0;return this._validateStretch(q.stretchX,q.data&&q.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchX" value'))),ie=!1),this._validateStretch(q.stretchY,q.data&&q.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchY" value'))),ie=!1),this._validateContent(q.content,q)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "content" value'))),ie=!1),ie},z.prototype._validateStretch=function(F,q){if(!F)return!0;for(var ie=0,ue=0,ge=F;ue<ge.length;ue+=1){var we=ge[ue];if(we[0]<ie||we[1]<we[0]||q<we[1])return!1;ie=we[1]}return!0},z.prototype._validateContent=function(F,q){return!F||F.length===4&&!(F[0]<0||q.data.width<F[0])&&!(F[1]<0||q.data.height<F[1])&&!(F[2]<0||q.data.width<F[2])&&!(F[3]<0||q.data.height<F[3])&&!(F[2]<F[0])&&!(F[3]<F[1])},z.prototype.updateImage=function(F,q){var ie=this.images[F];q.version=ie.version+1,this.images[F]=q,this.updatedImages[F]=!0},z.prototype.removeImage=function(F){var q=this.images[F];delete this.images[F],delete this.patterns[F],q.userImage&&q.userImage.onRemove&&q.userImage.onRemove()},z.prototype.listImages=function(){return Object.keys(this.images)},z.prototype.getImages=function(F,q){var ie=!0;if(!this.isLoaded())for(var ue=0,ge=F;ue<ge.length;ue+=1){var we=ge[ue];this.images[we]||(ie=!1)}this.isLoaded()||ie?this._notify(F,q):this.requestors.push({ids:F,callback:q})},z.prototype._notify=function(F,q){for(var ie={},ue=0,ge=F;ue<ge.length;ue+=1){var we=ge[ue];this.images[we]||this.fire(new e.Event("styleimagemissing",{id:we}));var Se=this.images[we];Se?ie[we]={data:Se.data.clone(),pixelRatio:Se.pixelRatio,sdf:Se.sdf,version:Se.version,stretchX:Se.stretchX,stretchY:Se.stretchY,content:Se.content,hasRenderCallback:Boolean(Se.userImage&&Se.userImage.render)}:e.warnOnce('Image "'+we+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}q(null,ie)},z.prototype.getPixelSize=function(){var F=this.atlasImage;return{width:F.width,height:F.height}},z.prototype.getPattern=function(F){var q=this.patterns[F],ie=this.getImage(F);if(!ie)return null;if(q&&q.position.version===ie.version)return q.position;if(q)q.position.version=ie.version;else{var ue={w:ie.data.width+2,h:ie.data.height+2,x:0,y:0},ge=new e.ImagePosition(ue,ie);this.patterns[F]={bin:ue,position:ge}}return this._updatePatternAtlas(),this.patterns[F].position},z.prototype.bind=function(F){var q=F.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(F,this.atlasImage,q.RGBA),this.atlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE)},z.prototype._updatePatternAtlas=function(){var F=[];for(var q in this.patterns)F.push(this.patterns[q].bin);var ie=e.potpack(F),ue=ie.w,ge=ie.h,we=this.atlasImage;for(var Se in we.resize({width:ue||1,height:ge||1}),this.patterns){var Ve=this.patterns[Se].bin,Je=Ve.x+1,at=Ve.y+1,bt=this.images[Se].data,Et=bt.width,kt=bt.height;e.RGBAImage.copy(bt,we,{x:0,y:0},{x:Je,y:at},{width:Et,height:kt}),e.RGBAImage.copy(bt,we,{x:0,y:kt-1},{x:Je,y:at-1},{width:Et,height:1}),e.RGBAImage.copy(bt,we,{x:0,y:0},{x:Je,y:at+kt},{width:Et,height:1}),e.RGBAImage.copy(bt,we,{x:Et-1,y:0},{x:Je-1,y:at},{width:1,height:kt}),e.RGBAImage.copy(bt,we,{x:0,y:0},{x:Je+Et,y:at},{width:1,height:kt})}this.dirty=!0},z.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},z.prototype.dispatchRenderCallbacks=function(F){for(var q=0,ie=F;q<ie.length;q+=1){var ue=ie[q];if(!this.callbackDispatchedThisFrame[ue]){this.callbackDispatchedThisFrame[ue]=!0;var ge=this.images[ue];h(ge)&&this.updateImage(ue,ge)}}},z}(e.Evented),s=T,x=T,c=1e20;function T(C,z,F,q,ie,ue){this.fontSize=C||24,this.buffer=z===void 0?3:z,this.cutoff=q||.25,this.fontFamily=ie||"sans-serif",this.fontWeight=ue||"normal",this.radius=F||8;var ge=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=ge,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(ge*ge),this.gridInner=new Float64Array(ge*ge),this.f=new Float64Array(ge),this.d=new Float64Array(ge),this.z=new Float64Array(ge+1),this.v=new Int16Array(ge),this.middle=Math.round(ge/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function _(C,z,F,q,ie,ue,ge){for(var we=0;we<z;we++){for(var Se=0;Se<F;Se++)q[Se]=C[Se*z+we];for(w(q,ie,ue,ge,F),Se=0;Se<F;Se++)C[Se*z+we]=ie[Se]}for(Se=0;Se<F;Se++){for(we=0;we<z;we++)q[we]=C[Se*z+we];for(w(q,ie,ue,ge,z),we=0;we<z;we++)C[Se*z+we]=Math.sqrt(ie[we])}}function w(C,z,F,q,ie){F[0]=0,q[0]=-c,q[1]=+c;for(var ue=1,ge=0;ue<ie;ue++){for(var we=(C[ue]+ue*ue-(C[F[ge]]+F[ge]*F[ge]))/(2*ue-2*F[ge]);we<=q[ge];)ge--,we=(C[ue]+ue*ue-(C[F[ge]]+F[ge]*F[ge]))/(2*ue-2*F[ge]);F[++ge]=ue,q[ge]=we,q[ge+1]=+c}for(ue=0,ge=0;ue<ie;ue++){for(;q[ge+1]<ue;)ge++;z[ue]=(ue-F[ge])*(ue-F[ge])+C[F[ge]]}}T.prototype.draw=function(C){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(C,this.buffer,this.middle);for(var z=this.ctx.getImageData(0,0,this.size,this.size),F=new Uint8ClampedArray(this.size*this.size),q=0;q<this.size*this.size;q++){var ie=z.data[4*q+3]/255;this.gridOuter[q]=ie===1?0:ie===0?c:Math.pow(Math.max(0,.5-ie),2),this.gridInner[q]=ie===1?c:ie===0?0:Math.pow(Math.max(0,ie-.5),2)}for(_(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),_(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),q=0;q<this.size*this.size;q++){var ue=this.gridOuter[q]-this.gridInner[q];F[q]=Math.max(0,Math.min(255,Math.round(255-255*(ue/this.radius+this.cutoff))))}return F},s.default=x;var k=function(C,z){this.requestManager=C,this.localIdeographFontFamily=z,this.entries={}};k.prototype.setURL=function(C){this.url=C},k.prototype.getGlyphs=function(C,z){var F=this,q=[];for(var ie in C)for(var ue=0,ge=C[ie];ue<ge.length;ue+=1){var we=ge[ue];q.push({stack:ie,id:we})}e.asyncAll(q,function(Se,Ve){var Je=Se.stack,at=Se.id,bt=F.entries[Je];bt||(bt=F.entries[Je]={glyphs:{},requests:{},ranges:{}});var Et=bt.glyphs[at];if(Et===void 0){if(Et=F._tinySDF(bt,Je,at))return bt.glyphs[at]=Et,void Ve(null,{stack:Je,id:at,glyph:Et});var kt=Math.floor(at/256);if(256*kt>65535)Ve(new Error("glyphs > 65535 not supported"));else if(bt.ranges[kt])Ve(null,{stack:Je,id:at,glyph:Et});else{var At=bt.requests[kt];At||(At=bt.requests[kt]=[],k.loadGlyphRange(Je,kt,F.url,F.requestManager,function(xt,zt){if(zt){for(var It in zt)F._doesCharSupportLocalGlyph(+It)||(bt.glyphs[+It]=zt[+It]);bt.ranges[kt]=!0}for(var Bt=0,nr=At;Bt<nr.length;Bt+=1)(0,nr[Bt])(xt,zt);delete bt.requests[kt]})),At.push(function(xt,zt){xt?Ve(xt):zt&&Ve(null,{stack:Je,id:at,glyph:zt[at]||null})})}}else Ve(null,{stack:Je,id:at,glyph:Et})},function(Se,Ve){if(Se)z(Se);else if(Ve){for(var Je={},at=0,bt=Ve;at<bt.length;at+=1){var Et=bt[at],kt=Et.stack,At=Et.id,xt=Et.glyph;(Je[kt]||(Je[kt]={}))[At]=xt&&{id:xt.id,bitmap:xt.bitmap.clone(),metrics:xt.metrics}}z(null,Je)}})},k.prototype._doesCharSupportLocalGlyph=function(C){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](C)||e.isChar["Hangul Syllables"](C)||e.isChar.Hiragana(C)||e.isChar.Katakana(C))},k.prototype._tinySDF=function(C,z,F){var q=this.localIdeographFontFamily;if(q&&this._doesCharSupportLocalGlyph(F)){var ie=C.tinySDF;if(!ie){var ue="400";/bold/i.test(z)?ue="900":/medium/i.test(z)?ue="500":/light/i.test(z)&&(ue="200"),ie=C.tinySDF=new k.TinySDF(24,3,8,.25,q,ue)}return{id:F,bitmap:new e.AlphaImage({width:30,height:30},ie.draw(String.fromCharCode(F))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},k.loadGlyphRange=function(C,z,F,q,ie){var ue=256*z,ge=ue+255,we=q.transformRequest(q.normalizeGlyphsURL(F).replace("{fontstack}",C).replace("{range}",ue+"-"+ge),e.ResourceType.Glyphs);e.getArrayBuffer(we,function(Se,Ve){if(Se)ie(Se);else if(Ve){for(var Je={},at=0,bt=e.parseGlyphPBF(Ve);at<bt.length;at+=1){var Et=bt[at];Je[Et.id]=Et}ie(null,Je)}})},k.TinySDF=s;var L=function(){this.specification=e.styleSpec.light.position};L.prototype.possiblyEvaluate=function(C,z){return e.sphericalToCartesian(C.expression.evaluate(z))},L.prototype.interpolate=function(C,z,F){return{x:e.number(C.x,z.x,F),y:e.number(C.y,z.y,F),z:e.number(C.z,z.z,F)}};var A=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new L,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),I=function(C){function z(F){C.call(this),this._transitionable=new e.Transitionable(A),this.setLight(F),this._transitioning=this._transitionable.untransitioned()}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getLight=function(){return this._transitionable.serialize()},z.prototype.setLight=function(F,q){if(q===void 0&&(q={}),!this._validate(e.validateLight,F,q))for(var ie in F){var ue=F[ie];e.endsWith(ie,"-transition")?this._transitionable.setTransition(ie.slice(0,-11),ue):this._transitionable.setValue(ie,ue)}},z.prototype.updateTransitions=function(F){this._transitioning=this._transitionable.transitioned(F,this._transitioning)},z.prototype.hasTransition=function(){return this._transitioning.hasTransition()},z.prototype.recalculate=function(F){this.properties=this._transitioning.possiblyEvaluate(F)},z.prototype._validate=function(F,q,ie){return(!ie||ie.validate!==!1)&&e.emitValidationErrors(this,F.call(e.validateStyle,e.extend({value:q,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},z}(e.Evented),P=function(C,z){this.width=C,this.height=z,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};P.prototype.getDash=function(C,z){var F=C.join(",")+String(z);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(C,z)),this.dashEntry[F]},P.prototype.getDashRanges=function(C,z,F){var q=[],ie=C.length%2==1?-C[C.length-1]*F:0,ue=C[0]*F,ge=!0;q.push({left:ie,right:ue,isDash:ge,zeroLength:C[0]===0});for(var we=C[0],Se=1;Se<C.length;Se++){ge=!ge;var Ve=C[Se];ie=we*F,ue=(we+=Ve)*F,q.push({left:ie,right:ue,isDash:ge,zeroLength:Ve===0})}return q},P.prototype.addRoundDash=function(C,z,F){for(var q=z/2,ie=-F;ie<=F;ie++)for(var ue=this.nextRow+F+ie,ge=this.width*ue,we=0,Se=C[we],Ve=0;Ve<this.width;Ve++){Ve/Se.right>1&&(Se=C[++we]);var Je=Math.abs(Ve-Se.left),at=Math.abs(Ve-Se.right),bt=Math.min(Je,at),Et=void 0,kt=ie/F*(q+1);if(Se.isDash){var At=q-Math.abs(kt);Et=Math.sqrt(bt*bt+At*At)}else Et=q-Math.sqrt(bt*bt+kt*kt);this.data[ge+Ve]=Math.max(0,Math.min(255,Et+128))}},P.prototype.addRegularDash=function(C){for(var z=C.length-1;z>=0;--z){var F=C[z],q=C[z+1];F.zeroLength?C.splice(z,1):q&&q.isDash===F.isDash&&(q.left=F.left,C.splice(z,1))}var ie=C[0],ue=C[C.length-1];ie.isDash===ue.isDash&&(ie.left=ue.left-this.width,ue.right=ie.right+this.width);for(var ge=this.width*this.nextRow,we=0,Se=C[we],Ve=0;Ve<this.width;Ve++){Ve/Se.right>1&&(Se=C[++we]);var Je=Math.abs(Ve-Se.left),at=Math.abs(Ve-Se.right),bt=Math.min(Je,at),Et=Se.isDash?bt:-bt;this.data[ge+Ve]=Math.max(0,Math.min(255,Et+128))}},P.prototype.addDash=function(C,z){var F=z?7:0,q=2*F+1;if(this.nextRow+q>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var ie=0,ue=0;ue<C.length;ue++)ie+=C[ue];if(ie!==0){var ge=this.width/ie,we=this.getDashRanges(C,this.width,ge);z?this.addRoundDash(we,ge,F):this.addRegularDash(we)}var Se={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:ie};return this.nextRow+=q,this.dirty=!0,Se},P.prototype.bind=function(C){var z=C.gl;this.texture?(z.bindTexture(z.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,z.texSubImage2D(z.TEXTURE_2D,0,0,0,this.width,this.height,z.ALPHA,z.UNSIGNED_BYTE,this.data))):(this.texture=z.createTexture(),z.bindTexture(z.TEXTURE_2D,this.texture),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_S,z.REPEAT),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_T,z.REPEAT),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MIN_FILTER,z.LINEAR),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MAG_FILTER,z.LINEAR),z.texImage2D(z.TEXTURE_2D,0,z.ALPHA,this.width,this.height,0,z.ALPHA,z.UNSIGNED_BYTE,this.data))};var S=function C(z,F){this.workerPool=z,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var q=this.workerPool.acquire(this.id),ie=0;ie<q.length;ie++){var ue=q[ie],ge=new C.Actor(ue,F,this.id);ge.name="Worker "+ie,this.actors.push(ge)}};function E(C,z,F){var q=function(ie,ue){if(ie)return F(ie);if(ue){var ge=e.pick(e.extend(ue,C),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);ue.vector_layers&&(ge.vectorLayers=ue.vector_layers,ge.vectorLayerIds=ge.vectorLayers.map(function(we){return we.id})),ge.tiles=z.canonicalizeTileset(ge,C.url),F(null,ge)}};return C.url?e.getJSON(z.transformRequest(z.normalizeSourceURL(C.url),e.ResourceType.Source),q):e.browser.frame(function(){return q(null,C)})}S.prototype.broadcast=function(C,z,F){F=F||function(){},e.asyncAll(this.actors,function(q,ie){q.send(C,z,ie)},F)},S.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},S.prototype.remove=function(){this.actors.forEach(function(C){C.remove()}),this.actors=[],this.workerPool.release(this.id)},S.Actor=e.Actor;var D=function(C,z,F){this.bounds=e.LngLatBounds.convert(this.validateBounds(C)),this.minzoom=z||0,this.maxzoom=F||24};D.prototype.validateBounds=function(C){return Array.isArray(C)&&C.length===4?[Math.max(-180,C[0]),Math.max(-90,C[1]),Math.min(180,C[2]),Math.min(90,C[3])]:[-180,-90,180,90]},D.prototype.contains=function(C){var z=Math.pow(2,C.z),F=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*z),q=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*z),ie=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*z),ue=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*z);return C.x>=F&&C.x<ie&&C.y>=q&&C.y<ue};var R=function(C){function z(F,q,ie,ue){if(C.call(this),this.id=F,this.dispatcher=ie,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(q,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},q),this._collectResourceTiming=q.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(ue)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,function(q,ie){F._tileJSONRequest=null,F._loaded=!0,q?F.fire(new e.ErrorEvent(q)):ie&&(e.extend(F,ie),ie.bounds&&(F.tileBounds=new D(ie.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ie.tiles,F.map._requestManager._customAccessToken),e.postMapLoadEvent(ie.tiles,F.map._getMapId(),F.map._requestManager._skuToken,F.map._requestManager._customAccessToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},z.prototype.loaded=function(){return this._loaded},z.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},z.prototype.onAdd=function(F){this.map=F,this.load()},z.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},z.prototype.serialize=function(){return e.extend({},this._options)},z.prototype.loadTile=function(F,q){var ie=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme)),ue={request:this.map._requestManager.transformRequest(ie,e.ResourceType.Tile),uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,tileSize:this.tileSize*F.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function ge(we,Se){return delete F.request,F.aborted?q(null):we&&we.status!==404?q(we):(Se&&Se.resourceTiming&&(F.resourceTiming=Se.resourceTiming),this.map._refreshExpiredTiles&&Se&&F.setExpiryData(Se),F.loadVectorData(Se,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),q(null),void(F.reloadCallback&&(this.loadTile(F,F.reloadCallback),F.reloadCallback=null)))}ue.request.collectResourceTiming=this._collectResourceTiming,F.actor&&F.state!=="expired"?F.state==="loading"?F.reloadCallback=q:F.request=F.actor.send("reloadTile",ue,ge.bind(this)):(F.actor=this.dispatcher.getActor(),F.request=F.actor.send("loadTile",ue,ge.bind(this)))},z.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.actor&&F.actor.send("abortTile",{uid:F.uid,type:this.type,source:this.id},void 0)},z.prototype.unloadTile=function(F){F.unloadVectorData(),F.actor&&F.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id},void 0)},z.prototype.hasTransition=function(){return!1},z}(e.Evented),H=function(C){function z(F,q,ie,ue){C.call(this),this.id=F,this.dispatcher=ie,this.setEventedParent(ue),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},q),e.extend(this,e.pick(q,["url","scheme","tileSize"]))}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,function(q,ie){F._tileJSONRequest=null,F._loaded=!0,q?F.fire(new e.ErrorEvent(q)):ie&&(e.extend(F,ie),ie.bounds&&(F.tileBounds=new D(ie.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ie.tiles),e.postMapLoadEvent(ie.tiles,F.map._getMapId(),F.map._requestManager._skuToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},z.prototype.loaded=function(){return this._loaded},z.prototype.onAdd=function(F){this.map=F,this.load()},z.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},z.prototype.serialize=function(){return e.extend({},this._options)},z.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},z.prototype.loadTile=function(F,q){var ie=this,ue=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);F.request=e.getImage(this.map._requestManager.transformRequest(ue,e.ResourceType.Tile),function(ge,we){if(delete F.request,F.aborted)F.state="unloaded",q(null);else if(ge)F.state="errored",q(ge);else if(we){ie.map._refreshExpiredTiles&&F.setExpiryData(we),delete we.cacheControl,delete we.expires;var Se=ie.map.painter.context,Ve=Se.gl;F.texture=ie.map.painter.getTileTexture(we.width),F.texture?F.texture.update(we,{useMipmap:!0}):(F.texture=new e.Texture(Se,we,Ve.RGBA,{useMipmap:!0}),F.texture.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE,Ve.LINEAR_MIPMAP_NEAREST),Se.extTextureFilterAnisotropic&&Ve.texParameterf(Ve.TEXTURE_2D,Se.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Se.extTextureFilterAnisotropicMax)),F.state="loaded",e.cacheEntryPossiblyAdded(ie.dispatcher),q(null)}})},z.prototype.abortTile=function(F,q){F.request&&(F.request.cancel(),delete F.request),q()},z.prototype.unloadTile=function(F,q){F.texture&&this.map.painter.saveTileTexture(F.texture),q()},z.prototype.hasTransition=function(){return!1},z}(e.Evented),V=function(C){function z(F,q,ie,ue){C.call(this,F,q,ie,ue),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},q),this.encoding=q.encoding||"mapbox"}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},z.prototype.loadTile=function(F,q){var ie=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function ue(ge,we){ge&&(F.state="errored",q(ge)),we&&(F.dem=we,F.needsHillshadePrepare=!0,F.state="loaded",q(null))}F.request=e.getImage(this.map._requestManager.transformRequest(ie,e.ResourceType.Tile),function(ge,we){if(delete F.request,F.aborted)F.state="unloaded",q(null);else if(ge)F.state="errored",q(ge);else if(we){this.map._refreshExpiredTiles&&F.setExpiryData(we),delete we.cacheControl,delete we.expires;var Se=e.window.ImageBitmap&&we instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?we:e.browser.getImageData(we,1),Ve={uid:F.uid,coord:F.tileID,source:this.id,rawImageData:Se,encoding:this.encoding};F.actor&&F.state!=="expired"||(F.actor=this.dispatcher.getActor(),F.actor.send("loadDEMTile",Ve,ue.bind(this)))}}.bind(this)),F.neighboringTiles=this._getNeighboringTiles(F.tileID)},z.prototype._getNeighboringTiles=function(F){var q=F.canonical,ie=Math.pow(2,q.z),ue=(q.x-1+ie)%ie,ge=q.x===0?F.wrap-1:F.wrap,we=(q.x+1+ie)%ie,Se=q.x+1===ie?F.wrap+1:F.wrap,Ve={};return Ve[new e.OverscaledTileID(F.overscaledZ,ge,q.z,ue,q.y).key]={backfilled:!1},Ve[new e.OverscaledTileID(F.overscaledZ,Se,q.z,we,q.y).key]={backfilled:!1},q.y>0&&(Ve[new e.OverscaledTileID(F.overscaledZ,ge,q.z,ue,q.y-1).key]={backfilled:!1},Ve[new e.OverscaledTileID(F.overscaledZ,F.wrap,q.z,q.x,q.y-1).key]={backfilled:!1},Ve[new e.OverscaledTileID(F.overscaledZ,Se,q.z,we,q.y-1).key]={backfilled:!1}),q.y+1<ie&&(Ve[new e.OverscaledTileID(F.overscaledZ,ge,q.z,ue,q.y+1).key]={backfilled:!1},Ve[new e.OverscaledTileID(F.overscaledZ,F.wrap,q.z,q.x,q.y+1).key]={backfilled:!1},Ve[new e.OverscaledTileID(F.overscaledZ,Se,q.z,we,q.y+1).key]={backfilled:!1}),Ve},z.prototype.unloadTile=function(F){F.demTexture&&this.map.painter.saveTileTexture(F.demTexture),F.fbo&&(F.fbo.destroy(),delete F.fbo),F.dem&&delete F.dem,delete F.neighboringTiles,F.state="unloaded",F.actor&&F.actor.send("removeDEMTile",{uid:F.uid,source:this.id})},z}(H),X=function(C){function z(F,q,ie,ue){C.call(this),this.id=F,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=ie.getActor(),this.setEventedParent(ue),this._data=q.data,this._options=e.extend({},q),this._collectResourceTiming=q.collectResourceTiming,this._resourceTiming=[],q.maxzoom!==void 0&&(this.maxzoom=q.maxzoom),q.type&&(this.type=q.type),q.attribution&&(this.attribution=q.attribution),this.promoteId=q.promoteId;var ge=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:q.cluster||!1,geojsonVtOptions:{buffer:(q.buffer!==void 0?q.buffer:128)*ge,tolerance:(q.tolerance!==void 0?q.tolerance:.375)*ge,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:q.lineMetrics||!1,generateId:q.generateId||!1},superclusterOptions:{maxZoom:q.clusterMaxZoom!==void 0?Math.min(q.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(q.clusterRadius||50)*ge,log:!1,generateId:q.generateId||!1},clusterProperties:q.clusterProperties},q.workerOptions)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.load=function(){var F=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(q){if(q)F.fire(new e.ErrorEvent(q));else{var ie={dataType:"source",sourceDataType:"metadata"};F._collectResourceTiming&&F._resourceTiming&&F._resourceTiming.length>0&&(ie.resourceTiming=F._resourceTiming,F._resourceTiming=[]),F.fire(new e.Event("data",ie))}})},z.prototype.onAdd=function(F){this.map=F,this.load()},z.prototype.setData=function(F){var q=this;return this._data=F,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(ie){if(ie)q.fire(new e.ErrorEvent(ie));else{var ue={dataType:"source",sourceDataType:"content"};q._collectResourceTiming&&q._resourceTiming&&q._resourceTiming.length>0&&(ue.resourceTiming=q._resourceTiming,q._resourceTiming=[]),q.fire(new e.Event("data",ue))}}),this},z.prototype.getClusterExpansionZoom=function(F,q){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:F,source:this.id},q),this},z.prototype.getClusterChildren=function(F,q){return this.actor.send("geojson.getClusterChildren",{clusterId:F,source:this.id},q),this},z.prototype.getClusterLeaves=function(F,q,ie,ue){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:F,limit:q,offset:ie},ue),this},z.prototype._updateWorkerData=function(F){var q=this;this._loaded=!1;var ie=e.extend({},this.workerOptions),ue=this._data;typeof ue=="string"?(ie.request=this.map._requestManager.transformRequest(e.browser.resolveURL(ue),e.ResourceType.Source),ie.request.collectResourceTiming=this._collectResourceTiming):ie.data=JSON.stringify(ue),this.actor.send(this.type+".loadData",ie,function(ge,we){q._removed||we&&we.abandoned||(q._loaded=!0,we&&we.resourceTiming&&we.resourceTiming[q.id]&&(q._resourceTiming=we.resourceTiming[q.id].slice(0)),q.actor.send(q.type+".coalesce",{source:ie.source},null),F(ge))})},z.prototype.loaded=function(){return this._loaded},z.prototype.loadTile=function(F,q){var ie=this,ue=F.actor?"reloadTile":"loadTile";F.actor=this.actor;var ge={type:this.type,uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};F.request=this.actor.send(ue,ge,function(we,Se){return delete F.request,F.unloadVectorData(),F.aborted?q(null):we?q(we):(F.loadVectorData(Se,ie.map.painter,ue==="reloadTile"),q(null))})},z.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.aborted=!0},z.prototype.unloadTile=function(F){F.unloadVectorData(),this.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id})},z.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},z.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},z.prototype.hasTransition=function(){return!1},z}(e.Evented),$=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),G=function(C){function z(F,q,ie,ue){C.call(this),this.id=F,this.dispatcher=ie,this.coordinates=q.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(ue),this.options=q}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.load=function(F,q){var ie=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(ue,ge){ie._loaded=!0,ue?ie.fire(new e.ErrorEvent(ue)):ge&&(ie.image=ge,F&&(ie.coordinates=F),q&&q(),ie._finishLoading())})},z.prototype.loaded=function(){return this._loaded},z.prototype.updateImage=function(F){var q=this;return this.image&&F.url?(this.options.url=F.url,this.load(F.coordinates,function(){q.texture=null}),this):this},z.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},z.prototype.onAdd=function(F){this.map=F,this.load()},z.prototype.setCoordinates=function(F){var q=this;this.coordinates=F;var ie=F.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(ge){for(var we=1/0,Se=1/0,Ve=-1/0,Je=-1/0,at=0,bt=ge;at<bt.length;at+=1){var Et=bt[at];we=Math.min(we,Et.x),Se=Math.min(Se,Et.y),Ve=Math.max(Ve,Et.x),Je=Math.max(Je,Et.y)}var kt=Ve-we,At=Je-Se,xt=Math.max(kt,At),zt=Math.max(0,Math.floor(-Math.log(xt)/Math.LN2)),It=Math.pow(2,zt);return new e.CanonicalTileID(zt,Math.floor((we+Ve)/2*It),Math.floor((Se+Je)/2*It))}(ie),this.minzoom=this.maxzoom=this.tileID.z;var ue=ie.map(function(ge){return q.tileID.getTilePoint(ge)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(ue[0].x,ue[0].y,0,0),this._boundsArray.emplaceBack(ue[1].x,ue[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(ue[3].x,ue[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(ue[2].x,ue[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},z.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var F=this.map.painter.context,q=F.gl;for(var ie in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,$.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(F,this.image,q.RGBA),this.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE)),this.tiles){var ue=this.tiles[ie];ue.state!=="loaded"&&(ue.state="loaded",ue.texture=this.texture)}}},z.prototype.loadTile=function(F,q){this.tileID&&this.tileID.equals(F.tileID.canonical)?(this.tiles[String(F.tileID.wrap)]=F,F.buckets={},q(null)):(F.state="errored",q(null))},z.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},z.prototype.hasTransition=function(){return!1},z}(e.Evented),W=function(C){function z(F,q,ie,ue){C.call(this,F,q,ie,ue),this.roundZoom=!0,this.type="video",this.options=q}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.load=function(){var F=this;this._loaded=!1;var q=this.options;this.urls=[];for(var ie=0,ue=q.urls;ie<ue.length;ie+=1){var ge=ue[ie];this.urls.push(this.map._requestManager.transformRequest(ge,e.ResourceType.Source).url)}e.getVideo(this.urls,function(we,Se){F._loaded=!0,we?F.fire(new e.ErrorEvent(we)):Se&&(F.video=Se,F.video.loop=!0,F.video.addEventListener("playing",function(){F.map.triggerRepaint()}),F.map&&F.video.play(),F._finishLoading())})},z.prototype.pause=function(){this.video&&this.video.pause()},z.prototype.play=function(){this.video&&this.video.play()},z.prototype.seek=function(F){if(this.video){var q=this.video.seekable;F<q.start(0)||F>q.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+q.start(0)+" and "+q.end(0)+"-second mark."))):this.video.currentTime=F}},z.prototype.getVideo=function(){return this.video},z.prototype.onAdd=function(F){this.map||(this.map=F,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},z.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var F=this.map.painter.context,q=F.gl;for(var ie in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,$.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE),q.texSubImage2D(q.TEXTURE_2D,0,0,0,q.RGBA,q.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(F,this.video,q.RGBA),this.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE)),this.tiles){var ue=this.tiles[ie];ue.state!=="loaded"&&(ue.state="loaded",ue.texture=this.texture)}}},z.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},z.prototype.hasTransition=function(){return this.video&&!this.video.paused},z}(G),te=function(C){function z(F,q,ie,ue){C.call(this,F,q,ie,ue),q.coordinates?Array.isArray(q.coordinates)&&q.coordinates.length===4&&!q.coordinates.some(function(ge){return!Array.isArray(ge)||ge.length!==2||ge.some(function(we){return typeof we!="number"})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "coordinates"'))),q.animate&&typeof q.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'optional "animate" property must be a boolean value'))),q.canvas?typeof q.canvas=="string"||q.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "canvas"'))),this.options=q,this.animate=q.animate===void 0||q.animate}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},z.prototype.getCanvas=function(){return this.canvas},z.prototype.onAdd=function(F){this.map=F,this.load(),this.canvas&&this.animate&&this.play()},z.prototype.onRemove=function(){this.pause()},z.prototype.prepare=function(){var F=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,F=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,F=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var q=this.map.painter.context,ie=q.gl;for(var ue in this.boundsBuffer||(this.boundsBuffer=q.createVertexBuffer(this._boundsArray,$.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(F||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(q,this.canvas,ie.RGBA,{premultiply:!0}),this.tiles){var ge=this.tiles[ue];ge.state!=="loaded"&&(ge.state="loaded",ge.texture=this.texture)}}},z.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},z.prototype.hasTransition=function(){return this._playing},z.prototype._hasInvalidDimensions=function(){for(var F=0,q=[this.canvas.width,this.canvas.height];F<q.length;F+=1){var ie=q[F];if(isNaN(ie)||ie<=0)return!0}return!1},z}(G),N={vector:R,raster:H,"raster-dem":V,geojson:X,video:W,image:G,canvas:te};function B(C,z){var F=e.identity([]);return e.translate(F,F,[1,1,0]),e.scale(F,F,[.5*C.width,.5*C.height,1]),e.multiply(F,F,C.calculatePosMatrix(z.toUnwrapped()))}function U(C,z,F,q,ie,ue){var ge=function(At,xt,zt){if(At)for(var It=0,Bt=At;It<Bt.length;It+=1){var nr=xt[Bt[It]];if(nr&&nr.source===zt&&nr.type==="fill-extrusion")return!0}else for(var gr in xt){var Lr=xt[gr];if(Lr.source===zt&&Lr.type==="fill-extrusion")return!0}return!1}(ie&&ie.layers,z,C.id),we=ue.maxPitchScaleFactor(),Se=C.tilesIn(q,we,ge);Se.sort(ee);for(var Ve=[],Je=0,at=Se;Je<at.length;Je+=1){var bt=at[Je];Ve.push({wrappedTileID:bt.tileID.wrapped().key,queryResults:bt.tile.queryRenderedFeatures(z,F,C._state,bt.queryGeometry,bt.cameraQueryGeometry,bt.scale,ie,ue,we,B(C.transform,bt.tileID))})}var Et=function(At){for(var xt={},zt={},It=0,Bt=At;It<Bt.length;It+=1){var nr=Bt[It],gr=nr.queryResults,Lr=nr.wrappedTileID,Sr=zt[Lr]=zt[Lr]||{};for(var $r in gr)for(var Qr=gr[$r],fn=Sr[$r]=Sr[$r]||{},sn=xt[$r]=xt[$r]||[],Vn=0,Jn=Qr;Vn<Jn.length;Vn+=1){var ha=Jn[Vn];fn[ha.featureIndex]||(fn[ha.featureIndex]=!0,sn.push(ha))}}return xt}(Ve);for(var kt in Et)Et[kt].forEach(function(At){var xt=At.feature,zt=C.getFeatureState(xt.layer["source-layer"],xt.id);xt.source=xt.layer.source,xt.layer["source-layer"]&&(xt.sourceLayer=xt.layer["source-layer"]),xt.state=zt});return Et}function ee(C,z){var F=C.tileID,q=z.tileID;return F.overscaledZ-q.overscaledZ||F.canonical.y-q.canonical.y||F.wrap-q.wrap||F.canonical.x-q.canonical.x}var j=function(C,z){this.max=C,this.onRemove=z,this.reset()};j.prototype.reset=function(){for(var C in this.data)for(var z=0,F=this.data[C];z<F.length;z+=1){var q=F[z];q.timeout&&clearTimeout(q.timeout),this.onRemove(q.value)}return this.data={},this.order=[],this},j.prototype.add=function(C,z,F){var q=this,ie=C.wrapped().key;this.data[ie]===void 0&&(this.data[ie]=[]);var ue={value:z,timeout:void 0};if(F!==void 0&&(ue.timeout=setTimeout(function(){q.remove(C,ue)},F)),this.data[ie].push(ue),this.order.push(ie),this.order.length>this.max){var ge=this._getAndRemoveByKey(this.order[0]);ge&&this.onRemove(ge)}return this},j.prototype.has=function(C){return C.wrapped().key in this.data},j.prototype.getAndRemove=function(C){return this.has(C)?this._getAndRemoveByKey(C.wrapped().key):null},j.prototype._getAndRemoveByKey=function(C){var z=this.data[C].shift();return z.timeout&&clearTimeout(z.timeout),this.data[C].length===0&&delete this.data[C],this.order.splice(this.order.indexOf(C),1),z.value},j.prototype.getByKey=function(C){var z=this.data[C];return z?z[0].value:null},j.prototype.get=function(C){return this.has(C)?this.data[C.wrapped().key][0].value:null},j.prototype.remove=function(C,z){if(!this.has(C))return this;var F=C.wrapped().key,q=z===void 0?0:this.data[F].indexOf(z),ie=this.data[F][q];return this.data[F].splice(q,1),ie.timeout&&clearTimeout(ie.timeout),this.data[F].length===0&&delete this.data[F],this.onRemove(ie.value),this.order.splice(this.order.indexOf(F),1),this},j.prototype.setMaxSize=function(C){for(this.max=C;this.order.length>this.max;){var z=this._getAndRemoveByKey(this.order[0]);z&&this.onRemove(z)}return this},j.prototype.filter=function(C){var z=[];for(var F in this.data)for(var q=0,ie=this.data[F];q<ie.length;q+=1){var ue=ie[q];C(ue.value)||z.push(ue)}for(var ge=0,we=z;ge<we.length;ge+=1){var Se=we[ge];this.remove(Se.value.tileID,Se)}};var Q=function(C,z,F){this.context=C;var q=C.gl;this.buffer=q.createBuffer(),this.dynamicDraw=Boolean(F),this.context.unbindVAO(),C.bindElementBuffer.set(this.buffer),q.bufferData(q.ELEMENT_ARRAY_BUFFER,z.arrayBuffer,this.dynamicDraw?q.DYNAMIC_DRAW:q.STATIC_DRAW),this.dynamicDraw||delete z.arrayBuffer};Q.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Q.prototype.updateData=function(C){var z=this.context.gl;this.context.unbindVAO(),this.bind(),z.bufferSubData(z.ELEMENT_ARRAY_BUFFER,0,C.arrayBuffer)},Q.prototype.destroy=function(){var C=this.context.gl;this.buffer&&(C.deleteBuffer(this.buffer),delete this.buffer)};var K={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},re=function(C,z,F,q){this.length=z.length,this.attributes=F,this.itemSize=z.bytesPerElement,this.dynamicDraw=q,this.context=C;var ie=C.gl;this.buffer=ie.createBuffer(),C.bindVertexBuffer.set(this.buffer),ie.bufferData(ie.ARRAY_BUFFER,z.arrayBuffer,this.dynamicDraw?ie.DYNAMIC_DRAW:ie.STATIC_DRAW),this.dynamicDraw||delete z.arrayBuffer};re.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},re.prototype.updateData=function(C){var z=this.context.gl;this.bind(),z.bufferSubData(z.ARRAY_BUFFER,0,C.arrayBuffer)},re.prototype.enableAttributes=function(C,z){for(var F=0;F<this.attributes.length;F++){var q=this.attributes[F],ie=z.attributes[q.name];ie!==void 0&&C.enableVertexAttribArray(ie)}},re.prototype.setVertexAttribPointers=function(C,z,F){for(var q=0;q<this.attributes.length;q++){var ie=this.attributes[q],ue=z.attributes[ie.name];ue!==void 0&&C.vertexAttribPointer(ue,ie.components,C[K[ie.type]],!1,this.itemSize,ie.offset+this.itemSize*(F||0))}},re.prototype.destroy=function(){var C=this.context.gl;this.buffer&&(C.deleteBuffer(this.buffer),delete this.buffer)};var ne=function(C){this.gl=C.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ne.prototype.get=function(){return this.current},ne.prototype.set=function(C){},ne.prototype.getDefault=function(){return this.default},ne.prototype.setDefault=function(){this.set(this.default)};var le=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return e.Color.transparent},z.prototype.set=function(F){var q=this.current;(F.r!==q.r||F.g!==q.g||F.b!==q.b||F.a!==q.a||this.dirty)&&(this.gl.clearColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},z}(ne),oe=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return 1},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearDepth(F),this.current=F,this.dirty=!1)},z}(ne),de=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return 0},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearStencil(F),this.current=F,this.dirty=!1)},z}(ne),se=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return[!0,!0,!0,!0]},z.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||F[2]!==q[2]||F[3]!==q[3]||this.dirty)&&(this.gl.colorMask(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},z}(ne),me=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!0},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthMask(F),this.current=F,this.dirty=!1)},z}(ne),Te=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return 255},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.stencilMask(F),this.current=F,this.dirty=!1)},z}(ne),_e=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},z.prototype.set=function(F){var q=this.current;(F.func!==q.func||F.ref!==q.ref||F.mask!==q.mask||this.dirty)&&(this.gl.stencilFunc(F.func,F.ref,F.mask),this.current=F,this.dirty=!1)},z}(ne),be=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){var F=this.gl;return[F.KEEP,F.KEEP,F.KEEP]},z.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||F[2]!==q[2]||this.dirty)&&(this.gl.stencilOp(F[0],F[1],F[2]),this.current=F,this.dirty=!1)},z}(ne),Ce=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.STENCIL_TEST):q.disable(q.STENCIL_TEST),this.current=F,this.dirty=!1}},z}(ne),fe=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return[0,1]},z.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||this.dirty)&&(this.gl.depthRange(F[0],F[1]),this.current=F,this.dirty=!1)},z}(ne),ve=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.DEPTH_TEST):q.disable(q.DEPTH_TEST),this.current=F,this.dirty=!1}},z}(ne),Me=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return this.gl.LESS},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthFunc(F),this.current=F,this.dirty=!1)},z}(ne),ke=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.BLEND):q.disable(q.BLEND),this.current=F,this.dirty=!1}},z}(ne),Le=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){var F=this.gl;return[F.ONE,F.ZERO]},z.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||this.dirty)&&(this.gl.blendFunc(F[0],F[1]),this.current=F,this.dirty=!1)},z}(ne),ze=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return e.Color.transparent},z.prototype.set=function(F){var q=this.current;(F.r!==q.r||F.g!==q.g||F.b!==q.b||F.a!==q.a||this.dirty)&&(this.gl.blendColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},z}(ne),Re=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return this.gl.FUNC_ADD},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.blendEquation(F),this.current=F,this.dirty=!1)},z}(ne),Oe=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.CULL_FACE):q.disable(q.CULL_FACE),this.current=F,this.dirty=!1}},z}(ne),Ze=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return this.gl.BACK},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.cullFace(F),this.current=F,this.dirty=!1)},z}(ne),Pe=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return this.gl.CCW},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.frontFace(F),this.current=F,this.dirty=!1)},z}(ne),Ie=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.useProgram(F),this.current=F,this.dirty=!1)},z}(ne),Be=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return this.gl.TEXTURE0},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.activeTexture(F),this.current=F,this.dirty=!1)},z}(ne),Fe=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){var F=this.gl;return[0,0,F.drawingBufferWidth,F.drawingBufferHeight]},z.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||F[2]!==q[2]||F[3]!==q[3]||this.dirty)&&(this.gl.viewport(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},z}(ne),$e=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindFramebuffer(q.FRAMEBUFFER,F),this.current=F,this.dirty=!1}},z}(ne),ot=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindRenderbuffer(q.RENDERBUFFER,F),this.current=F,this.dirty=!1}},z}(ne),pt=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindTexture(q.TEXTURE_2D,F),this.current=F,this.dirty=!1}},z}(ne),_t=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindBuffer(q.ARRAY_BUFFER,F),this.current=F,this.dirty=!1}},z}(ne),yt=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){var q=this.gl;q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,F),this.current=F,this.dirty=!1},z}(ne),tt=function(C){function z(F){C.call(this,F),this.vao=F.extVertexArrayObject}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){this.vao&&(F!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(F),this.current=F,this.dirty=!1)},z}(ne),Ke=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return 4},z.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.pixelStorei(q.UNPACK_ALIGNMENT,F),this.current=F,this.dirty=!1}},z}(ne),vt=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F),this.current=F,this.dirty=!1}},z}(ne),Nt=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,F),this.current=F,this.dirty=!1}},z}(ne),qt=function(C){function z(F,q){C.call(this,F),this.context=F,this.parent=q}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getDefault=function(){return null},z}(ne),er=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.setDirty=function(){this.dirty=!0},z.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var q=this.gl;q.framebufferTexture2D(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0,q.TEXTURE_2D,F,0),this.current=F,this.dirty=!1}},z}(qt),Jt=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var q=this.gl;q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_ATTACHMENT,q.RENDERBUFFER,F),this.current=F,this.dirty=!1}},z}(qt),ir=function(C,z,F,q){this.context=C,this.width=z,this.height=F;var ie=C.gl,ue=this.framebuffer=ie.createFramebuffer();this.colorAttachment=new er(C,ue),q&&(this.depthAttachment=new Jt(C,ue))};ir.prototype.destroy=function(){var C=this.context.gl,z=this.colorAttachment.get();if(z&&C.deleteTexture(z),this.depthAttachment){var F=this.depthAttachment.get();F&&C.deleteRenderbuffer(F)}C.deleteFramebuffer(this.framebuffer)};var Ht=function(C,z,F){this.func=C,this.mask=z,this.range=F};Ht.ReadOnly=!1,Ht.ReadWrite=!0,Ht.disabled=new Ht(519,Ht.ReadOnly,[0,1]);var Ue=function(C,z,F,q,ie,ue){this.test=C,this.ref=z,this.mask=F,this.fail=q,this.depthFail=ie,this.pass=ue};Ue.disabled=new Ue({func:519,mask:0},0,0,7680,7680,7680);var We=function(C,z,F){this.blendFunction=C,this.blendColor=z,this.mask=F};We.disabled=new We(We.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),We.unblended=new We(We.Replace,e.Color.transparent,[!0,!0,!0,!0]),We.alphaBlended=new We([1,771],e.Color.transparent,[!0,!0,!0,!0]);var he=function(C,z,F){this.enable=C,this.mode=z,this.frontFace=F};he.disabled=new he(!1,1029,2305),he.backCCW=new he(!0,1029,2305);var xe=function(C){this.gl=C,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new le(this),this.clearDepth=new oe(this),this.clearStencil=new de(this),this.colorMask=new se(this),this.depthMask=new me(this),this.stencilMask=new Te(this),this.stencilFunc=new _e(this),this.stencilOp=new be(this),this.stencilTest=new Ce(this),this.depthRange=new fe(this),this.depthTest=new ve(this),this.depthFunc=new Me(this),this.blend=new ke(this),this.blendFunc=new Le(this),this.blendColor=new ze(this),this.blendEquation=new Re(this),this.cullFace=new Oe(this),this.cullFaceSide=new Ze(this),this.frontFace=new Pe(this),this.program=new Ie(this),this.activeTexture=new Be(this),this.viewport=new Fe(this),this.bindFramebuffer=new $e(this),this.bindRenderbuffer=new ot(this),this.bindTexture=new pt(this),this.bindVertexBuffer=new _t(this),this.bindElementBuffer=new yt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new tt(this),this.pixelStoreUnpack=new Ke(this),this.pixelStoreUnpackPremultiplyAlpha=new vt(this),this.pixelStoreUnpackFlipY=new Nt(this),this.extTextureFilterAnisotropic=C.getExtension("EXT_texture_filter_anisotropic")||C.getExtension("MOZ_EXT_texture_filter_anisotropic")||C.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=C.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=C.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(C.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=C.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=C.getExtension("EXT_disjoint_timer_query")};xe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},xe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},xe.prototype.createIndexBuffer=function(C,z){return new Q(this,C,z)},xe.prototype.createVertexBuffer=function(C,z,F){return new re(this,C,z,F)},xe.prototype.createRenderbuffer=function(C,z,F){var q=this.gl,ie=q.createRenderbuffer();return this.bindRenderbuffer.set(ie),q.renderbufferStorage(q.RENDERBUFFER,C,z,F),this.bindRenderbuffer.set(null),ie},xe.prototype.createFramebuffer=function(C,z,F){return new ir(this,C,z,F)},xe.prototype.clear=function(C){var z=C.color,F=C.depth,q=this.gl,ie=0;z&&(ie|=q.COLOR_BUFFER_BIT,this.clearColor.set(z),this.colorMask.set([!0,!0,!0,!0])),F!==void 0&&(ie|=q.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(F),this.depthMask.set(!0)),q.clear(ie)},xe.prototype.setCullFace=function(C){C.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(C.mode),this.frontFace.set(C.frontFace))},xe.prototype.setDepthMode=function(C){C.func!==this.gl.ALWAYS||C.mask?(this.depthTest.set(!0),this.depthFunc.set(C.func),this.depthMask.set(C.mask),this.depthRange.set(C.range)):this.depthTest.set(!1)},xe.prototype.setStencilMode=function(C){C.test.func!==this.gl.ALWAYS||C.mask?(this.stencilTest.set(!0),this.stencilMask.set(C.mask),this.stencilOp.set([C.fail,C.depthFail,C.pass]),this.stencilFunc.set({func:C.test.func,ref:C.ref,mask:C.test.mask})):this.stencilTest.set(!1)},xe.prototype.setColorMode=function(C){e.deepEqual(C.blendFunction,We.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(C.blendFunction),this.blendColor.set(C.blendColor)),this.colorMask.set(C.mask)},xe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var De=function(C){function z(F,q,ie){var ue=this;C.call(this),this.id=F,this.dispatcher=ie,this.on("data",function(ge){ge.dataType==="source"&&ge.sourceDataType==="metadata"&&(ue._sourceLoaded=!0),ue._sourceLoaded&&!ue._paused&&ge.dataType==="source"&&ge.sourceDataType==="content"&&(ue.reload(),ue.transform&&ue.update(ue.transform))}),this.on("error",function(){ue._sourceErrored=!0}),this._source=function(ge,we,Se,Ve){var Je=new N[we.type](ge,we,Se,Ve);if(Je.id!==ge)throw new Error("Expected Source id to be "+ge+" instead of "+Je.id);return e.bindAll(["load","abort","unload","serialize","prepare"],Je),Je}(F,q,ie,this),this._tiles={},this._cache=new j(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.onAdd=function(F){this.map=F,this._maxTileCacheSize=F?F._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(F)},z.prototype.onRemove=function(F){this._source&&this._source.onRemove&&this._source.onRemove(F)},z.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var F in this._tiles){var q=this._tiles[F];if(q.state!=="loaded"&&q.state!=="errored")return!1}return!0},z.prototype.getSource=function(){return this._source},z.prototype.pause=function(){this._paused=!0},z.prototype.resume=function(){if(this._paused){var F=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,F&&this.reload(),this.transform&&this.update(this.transform)}},z.prototype._loadTile=function(F,q){return this._source.loadTile(F,q)},z.prototype._unloadTile=function(F){if(this._source.unloadTile)return this._source.unloadTile(F,function(){})},z.prototype._abortTile=function(F){if(this._source.abortTile)return this._source.abortTile(F,function(){})},z.prototype.serialize=function(){return this._source.serialize()},z.prototype.prepare=function(F){for(var q in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var ie=this._tiles[q];ie.upload(F),ie.prepare(this.map.style.imageManager)}},z.prototype.getIds=function(){return e.values(this._tiles).map(function(F){return F.tileID}).sort(qe).map(function(F){return F.key})},z.prototype.getRenderableIds=function(F){var q=this,ie=[];for(var ue in this._tiles)this._isIdRenderable(ue,F)&&ie.push(this._tiles[ue]);return F?ie.sort(function(ge,we){var Se=ge.tileID,Ve=we.tileID,Je=new e.Point(Se.canonical.x,Se.canonical.y)._rotate(q.transform.angle),at=new e.Point(Ve.canonical.x,Ve.canonical.y)._rotate(q.transform.angle);return Se.overscaledZ-Ve.overscaledZ||at.y-Je.y||at.x-Je.x}).map(function(ge){return ge.tileID.key}):ie.map(function(ge){return ge.tileID}).sort(qe).map(function(ge){return ge.key})},z.prototype.hasRenderableParent=function(F){var q=this.findLoadedParent(F,0);return!!q&&this._isIdRenderable(q.tileID.key)},z.prototype._isIdRenderable=function(F,q){return this._tiles[F]&&this._tiles[F].hasData()&&!this._coveredTiles[F]&&(q||!this._tiles[F].holdingForFade())},z.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var F in this._cache.reset(),this._tiles)this._tiles[F].state!=="errored"&&this._reloadTile(F,"reloading")},z.prototype._reloadTile=function(F,q){var ie=this._tiles[F];ie&&(ie.state!=="loading"&&(ie.state=q),this._loadTile(ie,this._tileLoaded.bind(this,ie,F,q)))},z.prototype._tileLoaded=function(F,q,ie,ue){if(ue)return F.state="errored",void(ue.status!==404?this._source.fire(new e.ErrorEvent(ue,{tile:F})):this.update(this.transform));F.timeAdded=e.browser.now(),ie==="expired"&&(F.refreshedUponExpiration=!0),this._setTileReloadTimer(q,F),this.getSource().type==="raster-dem"&&F.dem&&this._backfillDEM(F),this._state.initializeTileState(F,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:F,coord:F.tileID}))},z.prototype._backfillDEM=function(F){for(var q=this.getRenderableIds(),ie=0;ie<q.length;ie++){var ue=q[ie];if(F.neighboringTiles&&F.neighboringTiles[ue]){var ge=this.getTileByID(ue);we(F,ge),we(ge,F)}}function we(Se,Ve){Se.needsHillshadePrepare=!0;var Je=Ve.tileID.canonical.x-Se.tileID.canonical.x,at=Ve.tileID.canonical.y-Se.tileID.canonical.y,bt=Math.pow(2,Se.tileID.canonical.z),Et=Ve.tileID.key;Je===0&&at===0||Math.abs(at)>1||(Math.abs(Je)>1&&(Math.abs(Je+bt)===1?Je+=bt:Math.abs(Je-bt)===1&&(Je-=bt)),Ve.dem&&Se.dem&&(Se.dem.backfillBorder(Ve.dem,Je,at),Se.neighboringTiles&&Se.neighboringTiles[Et]&&(Se.neighboringTiles[Et].backfilled=!0)))}},z.prototype.getTile=function(F){return this.getTileByID(F.key)},z.prototype.getTileByID=function(F){return this._tiles[F]},z.prototype._retainLoadedChildren=function(F,q,ie,ue){for(var ge in this._tiles){var we=this._tiles[ge];if(!(ue[ge]||!we.hasData()||we.tileID.overscaledZ<=q||we.tileID.overscaledZ>ie)){for(var Se=we.tileID;we&&we.tileID.overscaledZ>q+1;){var Ve=we.tileID.scaledTo(we.tileID.overscaledZ-1);(we=this._tiles[Ve.key])&&we.hasData()&&(Se=Ve)}for(var Je=Se;Je.overscaledZ>q;)if(F[(Je=Je.scaledTo(Je.overscaledZ-1)).key]){ue[Se.key]=Se;break}}}},z.prototype.findLoadedParent=function(F,q){if(F.key in this._loadedParentTiles){var ie=this._loadedParentTiles[F.key];return ie&&ie.tileID.overscaledZ>=q?ie:null}for(var ue=F.overscaledZ-1;ue>=q;ue--){var ge=F.scaledTo(ue),we=this._getLoadedTile(ge);if(we)return we}},z.prototype._getLoadedTile=function(F){var q=this._tiles[F.key];return q&&q.hasData()?q:this._cache.getByKey(F.wrapped().key)},z.prototype.updateCacheSize=function(F){var q=(Math.ceil(F.width/this._source.tileSize)+1)*(Math.ceil(F.height/this._source.tileSize)+1),ie=Math.floor(5*q),ue=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ie):ie;this._cache.setMaxSize(ue)},z.prototype.handleWrapJump=function(F){var q=(F-(this._prevLng===void 0?F:this._prevLng))/360,ie=Math.round(q);if(this._prevLng=F,ie){var ue={};for(var ge in this._tiles){var we=this._tiles[ge];we.tileID=we.tileID.unwrapTo(we.tileID.wrap+ie),ue[we.tileID.key]=we}for(var Se in this._tiles=ue,this._timers)clearTimeout(this._timers[Se]),delete this._timers[Se];for(var Ve in this._tiles){var Je=this._tiles[Ve];this._setTileReloadTimer(Ve,Je)}}},z.prototype.update=function(F){var q=this;if(this.transform=F,this._sourceLoaded&&!this._paused){var ie;this.updateCacheSize(F),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?ie=F.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Sr){return new e.OverscaledTileID(Sr.canonical.z,Sr.wrap,Sr.canonical.z,Sr.canonical.x,Sr.canonical.y)}):(ie=F.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(ie=ie.filter(function(Sr){return q._source.hasTile(Sr)}))):ie=[];var ue=F.coveringZoomLevel(this._source),ge=Math.max(ue-z.maxOverzooming,this._source.minzoom),we=Math.max(ue+z.maxUnderzooming,this._source.minzoom),Se=this._updateRetainedTiles(ie,ue);if(Xe(this._source.type)){for(var Ve={},Je={},at=0,bt=Object.keys(Se);at<bt.length;at+=1){var Et=bt[at],kt=Se[Et],At=this._tiles[Et];if(At&&!(At.fadeEndTime&&At.fadeEndTime<=e.browser.now())){var xt=this.findLoadedParent(kt,ge);xt&&(this._addTile(xt.tileID),Ve[xt.tileID.key]=xt.tileID),Je[Et]=kt}}for(var zt in this._retainLoadedChildren(Je,ue,we,Se),Ve)Se[zt]||(this._coveredTiles[zt]=!0,Se[zt]=Ve[zt])}for(var It in Se)this._tiles[It].clearFadeHold();for(var Bt=0,nr=e.keysDifference(this._tiles,Se);Bt<nr.length;Bt+=1){var gr=nr[Bt],Lr=this._tiles[gr];Lr.hasSymbolBuckets&&!Lr.holdingForFade()?Lr.setHoldDuration(this.map._fadeDuration):Lr.hasSymbolBuckets&&!Lr.symbolFadeFinished()||this._removeTile(gr)}this._updateLoadedParentTileCache()}},z.prototype.releaseSymbolFadeTiles=function(){for(var F in this._tiles)this._tiles[F].holdingForFade()&&this._removeTile(F)},z.prototype._updateRetainedTiles=function(F,q){for(var ie={},ue={},ge=Math.max(q-z.maxOverzooming,this._source.minzoom),we=Math.max(q+z.maxUnderzooming,this._source.minzoom),Se={},Ve=0,Je=F;Ve<Je.length;Ve+=1){var at=Je[Ve],bt=this._addTile(at);ie[at.key]=at,bt.hasData()||q<this._source.maxzoom&&(Se[at.key]=at)}this._retainLoadedChildren(Se,q,we,ie);for(var Et=0,kt=F;Et<kt.length;Et+=1){var At=kt[Et],xt=this._tiles[At.key];if(!xt.hasData()){if(q+1>this._source.maxzoom){var zt=At.children(this._source.maxzoom)[0],It=this.getTile(zt);if(It&&It.hasData()){ie[zt.key]=zt;continue}}else{var Bt=At.children(this._source.maxzoom);if(ie[Bt[0].key]&&ie[Bt[1].key]&&ie[Bt[2].key]&&ie[Bt[3].key])continue}for(var nr=xt.wasRequested(),gr=At.overscaledZ-1;gr>=ge;--gr){var Lr=At.scaledTo(gr);if(ue[Lr.key]||(ue[Lr.key]=!0,!(xt=this.getTile(Lr))&&nr&&(xt=this._addTile(Lr)),xt&&(ie[Lr.key]=Lr,nr=xt.wasRequested(),xt.hasData())))break}}}return ie},z.prototype._updateLoadedParentTileCache=function(){for(var F in this._loadedParentTiles={},this._tiles){for(var q=[],ie=void 0,ue=this._tiles[F].tileID;ue.overscaledZ>0;){if(ue.key in this._loadedParentTiles){ie=this._loadedParentTiles[ue.key];break}q.push(ue.key);var ge=ue.scaledTo(ue.overscaledZ-1);if(ie=this._getLoadedTile(ge))break;ue=ge}for(var we=0,Se=q;we<Se.length;we+=1){var Ve=Se[we];this._loadedParentTiles[Ve]=ie}}},z.prototype._addTile=function(F){var q=this._tiles[F.key];if(q)return q;(q=this._cache.getAndRemove(F))&&(this._setTileReloadTimer(F.key,q),q.tileID=F,this._state.initializeTileState(q,this.map?this.map.painter:null),this._cacheTimers[F.key]&&(clearTimeout(this._cacheTimers[F.key]),delete this._cacheTimers[F.key],this._setTileReloadTimer(F.key,q)));var ie=Boolean(q);return ie||(q=new e.Tile(F,this._source.tileSize*F.overscaleFactor()),this._loadTile(q,this._tileLoaded.bind(this,q,F.key,q.state))),q?(q.uses++,this._tiles[F.key]=q,ie||this._source.fire(new e.Event("dataloading",{tile:q,coord:q.tileID,dataType:"source"})),q):null},z.prototype._setTileReloadTimer=function(F,q){var ie=this;F in this._timers&&(clearTimeout(this._timers[F]),delete this._timers[F]);var ue=q.getExpiryTimeout();ue&&(this._timers[F]=setTimeout(function(){ie._reloadTile(F,"expired"),delete ie._timers[F]},ue))},z.prototype._removeTile=function(F){var q=this._tiles[F];q&&(q.uses--,delete this._tiles[F],this._timers[F]&&(clearTimeout(this._timers[F]),delete this._timers[F]),q.uses>0||(q.hasData()&&q.state!=="reloading"?this._cache.add(q.tileID,q,q.getExpiryTimeout()):(q.aborted=!0,this._abortTile(q),this._unloadTile(q))))},z.prototype.clearTiles=function(){for(var F in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(F);this._cache.reset()},z.prototype.tilesIn=function(F,q,ie){var ue=this,ge=[],we=this.transform;if(!we)return ge;for(var Se=ie?we.getCameraQueryGeometry(F):F,Ve=F.map(function(gr){return we.pointCoordinate(gr)}),Je=Se.map(function(gr){return we.pointCoordinate(gr)}),at=this.getIds(),bt=1/0,Et=1/0,kt=-1/0,At=-1/0,xt=0,zt=Je;xt<zt.length;xt+=1){var It=zt[xt];bt=Math.min(bt,It.x),Et=Math.min(Et,It.y),kt=Math.max(kt,It.x),At=Math.max(At,It.y)}for(var Bt=function(gr){var Lr=ue._tiles[at[gr]];if(!Lr.holdingForFade()){var Sr=Lr.tileID,$r=Math.pow(2,we.zoom-Lr.tileID.overscaledZ),Qr=q*Lr.queryPadding*e.EXTENT/Lr.tileSize/$r,fn=[Sr.getTilePoint(new e.MercatorCoordinate(bt,Et)),Sr.getTilePoint(new e.MercatorCoordinate(kt,At))];if(fn[0].x-Qr<e.EXTENT&&fn[0].y-Qr<e.EXTENT&&fn[1].x+Qr>=0&&fn[1].y+Qr>=0){var sn=Ve.map(function(Jn){return Sr.getTilePoint(Jn)}),Vn=Je.map(function(Jn){return Sr.getTilePoint(Jn)});ge.push({tile:Lr,tileID:Sr,queryGeometry:sn,cameraQueryGeometry:Vn,scale:$r})}}},nr=0;nr<at.length;nr++)Bt(nr);return ge},z.prototype.getVisibleCoordinates=function(F){for(var q=this,ie=this.getRenderableIds(F).map(function(Se){return q._tiles[Se].tileID}),ue=0,ge=ie;ue<ge.length;ue+=1){var we=ge[ue];we.posMatrix=this.transform.calculatePosMatrix(we.toUnwrapped())}return ie},z.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Xe(this._source.type))for(var F in this._tiles){var q=this._tiles[F];if(q.fadeEndTime!==void 0&&q.fadeEndTime>=e.browser.now())return!0}return!1},z.prototype.setFeatureState=function(F,q,ie){F=F||"_geojsonTileLayer",this._state.updateState(F,q,ie)},z.prototype.removeFeatureState=function(F,q,ie){F=F||"_geojsonTileLayer",this._state.removeFeatureState(F,q,ie)},z.prototype.getFeatureState=function(F,q){return F=F||"_geojsonTileLayer",this._state.getState(F,q)},z.prototype.setDependencies=function(F,q,ie){var ue=this._tiles[F];ue&&ue.setDependencies(q,ie)},z.prototype.reloadTilesForDependencies=function(F,q){for(var ie in this._tiles)this._tiles[ie].hasDependency(F,q)&&this._reloadTile(ie,"reloading");this._cache.filter(function(ue){return!ue.hasDependency(F,q)})},z}(e.Evented);function qe(C,z){var F=Math.abs(2*C.wrap)-+(C.wrap<0),q=Math.abs(2*z.wrap)-+(z.wrap<0);return C.overscaledZ-z.overscaledZ||q-F||z.canonical.y-C.canonical.y||z.canonical.x-C.canonical.x}function Xe(C){return C==="raster"||C==="image"||C==="video"}function He(){return new e.window.Worker(ce.workerUrl)}De.maxOverzooming=10,De.maxUnderzooming=3;var st="mapboxgl_preloaded_worker_pool",it=function(){this.active={}};it.prototype.acquire=function(C){if(!this.workers)for(this.workers=[];this.workers.length<it.workerCount;)this.workers.push(new He);return this.active[C]=!0,this.workers.slice()},it.prototype.release=function(C){delete this.active[C],this.numActive()===0&&(this.workers.forEach(function(z){z.terminate()}),this.workers=null)},it.prototype.isPreloaded=function(){return!!this.active[st]},it.prototype.numActive=function(){return Object.keys(this.active).length};var Tt,Pt=Math.floor(e.browser.hardwareConcurrency/2);function rt(){return Tt||(Tt=new it),Tt}function ut(C,z){var F={};for(var q in C)q!=="ref"&&(F[q]=C[q]);return e.refProperties.forEach(function(ie){ie in z&&(F[ie]=z[ie])}),F}function Ft(C){C=C.slice();for(var z=Object.create(null),F=0;F<C.length;F++)z[C[F].id]=C[F];for(var q=0;q<C.length;q++)"ref"in C[q]&&(C[q]=ut(C[q],z[C[q].ref]));return C}it.workerCount=Math.max(Math.min(Pt,6),1);var wt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Lt(C,z,F){F.push({command:wt.addSource,args:[C,z[C]]})}function Ae(C,z,F){z.push({command:wt.removeSource,args:[C]}),F[C]=!0}function Ye(C,z,F,q){Ae(C,F,q),Lt(C,z,F)}function nt(C,z,F){var q;for(q in C[F])if(C[F].hasOwnProperty(q)&&q!=="data"&&!e.deepEqual(C[F][q],z[F][q]))return!1;for(q in z[F])if(z[F].hasOwnProperty(q)&&q!=="data"&&!e.deepEqual(C[F][q],z[F][q]))return!1;return!0}function ft(C,z,F,q,ie,ue){var ge;for(ge in z=z||{},C=C||{})C.hasOwnProperty(ge)&&(e.deepEqual(C[ge],z[ge])||F.push({command:ue,args:[q,ge,z[ge],ie]}));for(ge in z)z.hasOwnProperty(ge)&&!C.hasOwnProperty(ge)&&(e.deepEqual(C[ge],z[ge])||F.push({command:ue,args:[q,ge,z[ge],ie]}))}function Mt(C){return C.id}function Rt(C,z){return C[z.id]=z,C}function Gt(C,z){if(!C)return[{command:wt.setStyle,args:[z]}];var F=[];try{if(!e.deepEqual(C.version,z.version))return[{command:wt.setStyle,args:[z]}];e.deepEqual(C.center,z.center)||F.push({command:wt.setCenter,args:[z.center]}),e.deepEqual(C.zoom,z.zoom)||F.push({command:wt.setZoom,args:[z.zoom]}),e.deepEqual(C.bearing,z.bearing)||F.push({command:wt.setBearing,args:[z.bearing]}),e.deepEqual(C.pitch,z.pitch)||F.push({command:wt.setPitch,args:[z.pitch]}),e.deepEqual(C.sprite,z.sprite)||F.push({command:wt.setSprite,args:[z.sprite]}),e.deepEqual(C.glyphs,z.glyphs)||F.push({command:wt.setGlyphs,args:[z.glyphs]}),e.deepEqual(C.transition,z.transition)||F.push({command:wt.setTransition,args:[z.transition]}),e.deepEqual(C.light,z.light)||F.push({command:wt.setLight,args:[z.light]});var q={},ie=[];(function(ge,we,Se,Ve){var Je;for(Je in we=we||{},ge=ge||{})ge.hasOwnProperty(Je)&&(we.hasOwnProperty(Je)||Ae(Je,Se,Ve));for(Je in we)we.hasOwnProperty(Je)&&(ge.hasOwnProperty(Je)?e.deepEqual(ge[Je],we[Je])||(ge[Je].type==="geojson"&&we[Je].type==="geojson"&&nt(ge,we,Je)?Se.push({command:wt.setGeoJSONSourceData,args:[Je,we[Je].data]}):Ye(Je,we,Se,Ve)):Lt(Je,we,Se))})(C.sources,z.sources,ie,q);var ue=[];C.layers&&C.layers.forEach(function(ge){q[ge.source]?F.push({command:wt.removeLayer,args:[ge.id]}):ue.push(ge)}),F=F.concat(ie),function(ge,we,Se){we=we||[];var Ve,Je,at,bt,Et,kt,At,xt=(ge=ge||[]).map(Mt),zt=we.map(Mt),It=ge.reduce(Rt,{}),Bt=we.reduce(Rt,{}),nr=xt.slice(),gr=Object.create(null);for(Ve=0,Je=0;Ve<xt.length;Ve++)at=xt[Ve],Bt.hasOwnProperty(at)?Je++:(Se.push({command:wt.removeLayer,args:[at]}),nr.splice(nr.indexOf(at,Je),1));for(Ve=0,Je=0;Ve<zt.length;Ve++)at=zt[zt.length-1-Ve],nr[nr.length-1-Ve]!==at&&(It.hasOwnProperty(at)?(Se.push({command:wt.removeLayer,args:[at]}),nr.splice(nr.lastIndexOf(at,nr.length-Je),1)):Je++,kt=nr[nr.length-Ve],Se.push({command:wt.addLayer,args:[Bt[at],kt]}),nr.splice(nr.length-Ve,0,at),gr[at]=!0);for(Ve=0;Ve<zt.length;Ve++)if(bt=It[at=zt[Ve]],Et=Bt[at],!gr[at]&&!e.deepEqual(bt,Et))if(e.deepEqual(bt.source,Et.source)&&e.deepEqual(bt["source-layer"],Et["source-layer"])&&e.deepEqual(bt.type,Et.type)){for(At in ft(bt.layout,Et.layout,Se,at,null,wt.setLayoutProperty),ft(bt.paint,Et.paint,Se,at,null,wt.setPaintProperty),e.deepEqual(bt.filter,Et.filter)||Se.push({command:wt.setFilter,args:[at,Et.filter]}),e.deepEqual(bt.minzoom,Et.minzoom)&&e.deepEqual(bt.maxzoom,Et.maxzoom)||Se.push({command:wt.setLayerZoomRange,args:[at,Et.minzoom,Et.maxzoom]}),bt)bt.hasOwnProperty(At)&&At!=="layout"&&At!=="paint"&&At!=="filter"&&At!=="metadata"&&At!=="minzoom"&&At!=="maxzoom"&&(At.indexOf("paint.")===0?ft(bt[At],Et[At],Se,at,At.slice(6),wt.setPaintProperty):e.deepEqual(bt[At],Et[At])||Se.push({command:wt.setLayerProperty,args:[at,At,Et[At]]}));for(At in Et)Et.hasOwnProperty(At)&&!bt.hasOwnProperty(At)&&At!=="layout"&&At!=="paint"&&At!=="filter"&&At!=="metadata"&&At!=="minzoom"&&At!=="maxzoom"&&(At.indexOf("paint.")===0?ft(bt[At],Et[At],Se,at,At.slice(6),wt.setPaintProperty):e.deepEqual(bt[At],Et[At])||Se.push({command:wt.setLayerProperty,args:[at,At,Et[At]]}))}else Se.push({command:wt.removeLayer,args:[at]}),kt=nr[nr.lastIndexOf(at)+1],Se.push({command:wt.addLayer,args:[Et,kt]})}(ue,z.layers,F)}catch(ge){console.warn("Unable to compute style diff:",ge),F=[{command:wt.setStyle,args:[z]}]}return F}var jt=function(C,z){this.reset(C,z)};jt.prototype.reset=function(C,z){this.points=C||[],this._distances=[0];for(var F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(z||0,.5*this.length),this.paddedLength=this.length-2*this.padding},jt.prototype.lerp=function(C){if(this.points.length===1)return this.points[0];C=e.clamp(C,0,1);for(var z=1,F=this._distances[z],q=C*this.paddedLength+this.padding;F<q&&z<this._distances.length;)F=this._distances[++z];var ie=z-1,ue=this._distances[ie],ge=F-ue,we=ge>0?(q-ue)/ge:0;return this.points[ie].mult(1-we).add(this.points[z].mult(we))};var pr=function(C,z,F){var q=this.boxCells=[],ie=this.circleCells=[];this.xCellCount=Math.ceil(C/F),this.yCellCount=Math.ceil(z/F);for(var ue=0;ue<this.xCellCount*this.yCellCount;ue++)q.push([]),ie.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=C,this.height=z,this.xScale=this.xCellCount/C,this.yScale=this.yCellCount/z,this.boxUid=0,this.circleUid=0};function Ar(C,z,F,q,ie){var ue=e.create();return z?(e.scale(ue,ue,[1/ie,1/ie,1]),F||e.rotateZ(ue,ue,q.angle)):e.multiply(ue,q.labelPlaneMatrix,C),ue}function fr(C,z,F,q,ie){if(z){var ue=e.clone(C);return e.scale(ue,ue,[ie,ie,1]),F||e.rotateZ(ue,ue,-q.angle),ue}return q.glCoordMatrix}function Zt(C,z){var F=[C.x,C.y,0,1];In(F,F,z);var q=F[3];return{point:new e.Point(F[0]/q,F[1]/q),signedDistanceFromCamera:q}}function Qt(C,z){return .5+C/z*.5}function $t(C,z){var F=C[0]/C[3],q=C[1]/C[3];return F>=-z[0]&&F<=z[0]&&q>=-z[1]&&q<=z[1]}function hr(C,z,F,q,ie,ue,ge,we){var Se=q?C.textSizeData:C.iconSizeData,Ve=e.evaluateSizeForZoom(Se,F.transform.zoom),Je=[256/F.width*2+1,256/F.height*2+1],at=q?C.text.dynamicLayoutVertexArray:C.icon.dynamicLayoutVertexArray;at.clear();for(var bt=C.lineVertexArray,Et=q?C.text.placedSymbolArray:C.icon.placedSymbolArray,kt=F.transform.width/F.transform.height,At=!1,xt=0;xt<Et.length;xt++){var zt=Et.get(xt);if(zt.hidden||zt.writingMode===e.WritingMode.vertical&&!At)en(zt.numGlyphs,at);else{At=!1;var It=[zt.anchorX,zt.anchorY,0,1];if(e.transformMat4(It,It,z),$t(It,Je)){var Bt=It[3],nr=Qt(F.transform.cameraToCenterDistance,Bt),gr=e.evaluateSizeForFeature(Se,Ve,zt),Lr=ge?gr/nr:gr*nr,Sr=new e.Point(zt.anchorX,zt.anchorY),$r=Zt(Sr,ie).point,Qr={},fn=Nr(zt,Lr,!1,we,z,ie,ue,C.glyphOffsetArray,bt,at,$r,Sr,Qr,kt);At=fn.useVertical,(fn.notEnoughRoom||At||fn.needsFlipping&&Nr(zt,Lr,!0,we,z,ie,ue,C.glyphOffsetArray,bt,at,$r,Sr,Qr,kt).notEnoughRoom)&&en(zt.numGlyphs,at)}else en(zt.numGlyphs,at)}}q?C.text.dynamicLayoutVertexBuffer.updateData(at):C.icon.dynamicLayoutVertexBuffer.updateData(at)}function vr(C,z,F,q,ie,ue,ge,we,Se,Ve,Je){var at=we.glyphStartIndex+we.numGlyphs,bt=we.lineStartIndex,Et=we.lineStartIndex+we.lineLength,kt=z.getoffsetX(we.glyphStartIndex),At=z.getoffsetX(at-1),xt=Jr(C*kt,F,q,ie,ue,ge,we.segment,bt,Et,Se,Ve,Je);if(!xt)return null;var zt=Jr(C*At,F,q,ie,ue,ge,we.segment,bt,Et,Se,Ve,Je);return zt?{first:xt,last:zt}:null}function Mr(C,z,F,q){return C===e.WritingMode.horizontal&&Math.abs(F.y-z.y)>Math.abs(F.x-z.x)*q?{useVertical:!0}:(C===e.WritingMode.vertical?z.y<F.y:z.x>F.x)?{needsFlipping:!0}:null}function Nr(C,z,F,q,ie,ue,ge,we,Se,Ve,Je,at,bt,Et){var kt,At=z/24,xt=C.lineOffsetX*At,zt=C.lineOffsetY*At;if(C.numGlyphs>1){var It=C.glyphStartIndex+C.numGlyphs,Bt=C.lineStartIndex,nr=C.lineStartIndex+C.lineLength,gr=vr(At,we,xt,zt,F,Je,at,C,Se,ue,bt);if(!gr)return{notEnoughRoom:!0};var Lr=Zt(gr.first.point,ge).point,Sr=Zt(gr.last.point,ge).point;if(q&&!F){var $r=Mr(C.writingMode,Lr,Sr,Et);if($r)return $r}kt=[gr.first];for(var Qr=C.glyphStartIndex+1;Qr<It-1;Qr++)kt.push(Jr(At*we.getoffsetX(Qr),xt,zt,F,Je,at,C.segment,Bt,nr,Se,ue,bt));kt.push(gr.last)}else{if(q&&!F){var fn=Zt(at,ie).point,sn=C.lineStartIndex+C.segment+1,Vn=new e.Point(Se.getx(sn),Se.gety(sn)),Jn=Zt(Vn,ie),ha=Jn.signedDistanceFromCamera>0?Jn.point:Ur(at,Vn,fn,1,ie),Wr=Mr(C.writingMode,fn,ha,Et);if(Wr)return Wr}var Mn=Jr(At*we.getoffsetX(C.glyphStartIndex),xt,zt,F,Je,at,C.segment,C.lineStartIndex,C.lineStartIndex+C.lineLength,Se,ue,bt);if(!Mn)return{notEnoughRoom:!0};kt=[Mn]}for(var Kn=0,Yn=kt;Kn<Yn.length;Kn+=1){var ia=Yn[Kn];e.addDynamicAttributes(Ve,ia.point,ia.angle)}return{}}function Ur(C,z,F,q,ie){var ue=Zt(C.add(C.sub(z)._unit()),ie).point,ge=F.sub(ue);return F.add(ge._mult(q/ge.mag()))}function Jr(C,z,F,q,ie,ue,ge,we,Se,Ve,Je,at){var bt=q?C-z:C+z,Et=bt>0?1:-1,kt=0;q&&(Et*=-1,kt=Math.PI),Et<0&&(kt+=Math.PI);for(var At=Et>0?we+ge:we+ge+1,xt=ie,zt=ie,It=0,Bt=0,nr=Math.abs(bt),gr=[];It+Bt<=nr;){if((At+=Et)<we||At>=Se)return null;if(zt=xt,gr.push(xt),(xt=at[At])===void 0){var Lr=new e.Point(Ve.getx(At),Ve.gety(At)),Sr=Zt(Lr,Je);if(Sr.signedDistanceFromCamera>0)xt=at[At]=Sr.point;else{var $r=At-Et;xt=Ur(It===0?ue:new e.Point(Ve.getx($r),Ve.gety($r)),Lr,zt,nr-It+1,Je)}}It+=Bt,Bt=zt.dist(xt)}var Qr=(nr-It)/Bt,fn=xt.sub(zt),sn=fn.mult(Qr)._add(zt);sn._add(fn._unit()._perp()._mult(F*Et));var Vn=kt+Math.atan2(xt.y-zt.y,xt.x-zt.x);return gr.push(sn),{point:sn,angle:Vn,path:gr}}pr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},pr.prototype.insert=function(C,z,F,q,ie){this._forEachCell(z,F,q,ie,this._insertBoxCell,this.boxUid++),this.boxKeys.push(C),this.bboxes.push(z),this.bboxes.push(F),this.bboxes.push(q),this.bboxes.push(ie)},pr.prototype.insertCircle=function(C,z,F,q){this._forEachCell(z-q,F-q,z+q,F+q,this._insertCircleCell,this.circleUid++),this.circleKeys.push(C),this.circles.push(z),this.circles.push(F),this.circles.push(q)},pr.prototype._insertBoxCell=function(C,z,F,q,ie,ue){this.boxCells[ie].push(ue)},pr.prototype._insertCircleCell=function(C,z,F,q,ie,ue){this.circleCells[ie].push(ue)},pr.prototype._query=function(C,z,F,q,ie,ue){if(F<0||C>this.width||q<0||z>this.height)return!ie&&[];var ge=[];if(C<=0&&z<=0&&this.width<=F&&this.height<=q){if(ie)return!0;for(var we=0;we<this.boxKeys.length;we++)ge.push({key:this.boxKeys[we],x1:this.bboxes[4*we],y1:this.bboxes[4*we+1],x2:this.bboxes[4*we+2],y2:this.bboxes[4*we+3]});for(var Se=0;Se<this.circleKeys.length;Se++){var Ve=this.circles[3*Se],Je=this.circles[3*Se+1],at=this.circles[3*Se+2];ge.push({key:this.circleKeys[Se],x1:Ve-at,y1:Je-at,x2:Ve+at,y2:Je+at})}return ue?ge.filter(ue):ge}var bt={hitTest:ie,seenUids:{box:{},circle:{}}};return this._forEachCell(C,z,F,q,this._queryCell,ge,bt,ue),ie?ge.length>0:ge},pr.prototype._queryCircle=function(C,z,F,q,ie){var ue=C-F,ge=C+F,we=z-F,Se=z+F;if(ge<0||ue>this.width||Se<0||we>this.height)return!q&&[];var Ve=[],Je={hitTest:q,circle:{x:C,y:z,radius:F},seenUids:{box:{},circle:{}}};return this._forEachCell(ue,we,ge,Se,this._queryCellCircle,Ve,Je,ie),q?Ve.length>0:Ve},pr.prototype.query=function(C,z,F,q,ie){return this._query(C,z,F,q,!1,ie)},pr.prototype.hitTest=function(C,z,F,q,ie){return this._query(C,z,F,q,!0,ie)},pr.prototype.hitTestCircle=function(C,z,F,q){return this._queryCircle(C,z,F,!0,q)},pr.prototype._queryCell=function(C,z,F,q,ie,ue,ge,we){var Se=ge.seenUids,Ve=this.boxCells[ie];if(Ve!==null)for(var Je=this.bboxes,at=0,bt=Ve;at<bt.length;at+=1){var Et=bt[at];if(!Se.box[Et]){Se.box[Et]=!0;var kt=4*Et;if(C<=Je[kt+2]&&z<=Je[kt+3]&&F>=Je[kt+0]&&q>=Je[kt+1]&&(!we||we(this.boxKeys[Et]))){if(ge.hitTest)return ue.push(!0),!0;ue.push({key:this.boxKeys[Et],x1:Je[kt],y1:Je[kt+1],x2:Je[kt+2],y2:Je[kt+3]})}}}var At=this.circleCells[ie];if(At!==null)for(var xt=this.circles,zt=0,It=At;zt<It.length;zt+=1){var Bt=It[zt];if(!Se.circle[Bt]){Se.circle[Bt]=!0;var nr=3*Bt;if(this._circleAndRectCollide(xt[nr],xt[nr+1],xt[nr+2],C,z,F,q)&&(!we||we(this.circleKeys[Bt]))){if(ge.hitTest)return ue.push(!0),!0;var gr=xt[nr],Lr=xt[nr+1],Sr=xt[nr+2];ue.push({key:this.circleKeys[Bt],x1:gr-Sr,y1:Lr-Sr,x2:gr+Sr,y2:Lr+Sr})}}}},pr.prototype._queryCellCircle=function(C,z,F,q,ie,ue,ge,we){var Se=ge.circle,Ve=ge.seenUids,Je=this.boxCells[ie];if(Je!==null)for(var at=this.bboxes,bt=0,Et=Je;bt<Et.length;bt+=1){var kt=Et[bt];if(!Ve.box[kt]){Ve.box[kt]=!0;var At=4*kt;if(this._circleAndRectCollide(Se.x,Se.y,Se.radius,at[At+0],at[At+1],at[At+2],at[At+3])&&(!we||we(this.boxKeys[kt])))return ue.push(!0),!0}}var xt=this.circleCells[ie];if(xt!==null)for(var zt=this.circles,It=0,Bt=xt;It<Bt.length;It+=1){var nr=Bt[It];if(!Ve.circle[nr]){Ve.circle[nr]=!0;var gr=3*nr;if(this._circlesCollide(zt[gr],zt[gr+1],zt[gr+2],Se.x,Se.y,Se.radius)&&(!we||we(this.circleKeys[nr])))return ue.push(!0),!0}}},pr.prototype._forEachCell=function(C,z,F,q,ie,ue,ge,we){for(var Se=this._convertToXCellCoord(C),Ve=this._convertToYCellCoord(z),Je=this._convertToXCellCoord(F),at=this._convertToYCellCoord(q),bt=Se;bt<=Je;bt++)for(var Et=Ve;Et<=at;Et++){var kt=this.xCellCount*Et+bt;if(ie.call(this,C,z,F,q,kt,ue,ge,we))return}},pr.prototype._convertToXCellCoord=function(C){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(C*this.xScale)))},pr.prototype._convertToYCellCoord=function(C){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(C*this.yScale)))},pr.prototype._circlesCollide=function(C,z,F,q,ie,ue){var ge=q-C,we=ie-z,Se=F+ue;return Se*Se>ge*ge+we*we},pr.prototype._circleAndRectCollide=function(C,z,F,q,ie,ue,ge){var we=(ue-q)/2,Se=Math.abs(C-(q+we));if(Se>we+F)return!1;var Ve=(ge-ie)/2,Je=Math.abs(z-(ie+Ve));if(Je>Ve+F)return!1;if(Se<=we||Je<=Ve)return!0;var at=Se-we,bt=Je-Ve;return at*at+bt*bt<=F*F};var mn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function en(C,z){for(var F=0;F<C;F++){var q=z.length;z.resize(q+4),z.float32.set(mn,3*q)}}function In(C,z,F){var q=z[0],ie=z[1];return C[0]=F[0]*q+F[4]*ie+F[12],C[1]=F[1]*q+F[5]*ie+F[13],C[3]=F[3]*q+F[7]*ie+F[15],C}var vn=function(C,z,F){z===void 0&&(z=new pr(C.width+200,C.height+200,25)),F===void 0&&(F=new pr(C.width+200,C.height+200,25)),this.transform=C,this.grid=z,this.ignoredGrid=F,this.pitchfactor=Math.cos(C._pitch)*C.cameraToCenterDistance,this.screenRightBoundary=C.width+100,this.screenBottomBoundary=C.height+100,this.gridRightBoundary=C.width+200,this.gridBottomBoundary=C.height+200};function gn(C,z,F){return z*(e.EXTENT/(C.tileSize*Math.pow(2,F-C.tileID.overscaledZ)))}vn.prototype.placeCollisionBox=function(C,z,F,q,ie){var ue=this.projectAndGetPerspectiveRatio(q,C.anchorPointX,C.anchorPointY),ge=F*ue.perspectiveRatio,we=C.x1*ge+ue.point.x,Se=C.y1*ge+ue.point.y,Ve=C.x2*ge+ue.point.x,Je=C.y2*ge+ue.point.y;return!this.isInsideGrid(we,Se,Ve,Je)||!z&&this.grid.hitTest(we,Se,Ve,Je,ie)?{box:[],offscreen:!1}:{box:[we,Se,Ve,Je],offscreen:this.isOffscreen(we,Se,Ve,Je)}},vn.prototype.placeCollisionCircles=function(C,z,F,q,ie,ue,ge,we,Se,Ve,Je,at,bt){var Et=[],kt=new e.Point(z.anchorX,z.anchorY),At=Zt(kt,ue),xt=Qt(this.transform.cameraToCenterDistance,At.signedDistanceFromCamera),zt=(Ve?ie/xt:ie*xt)/e.ONE_EM,It=Zt(kt,ge).point,Bt=vr(zt,q,z.lineOffsetX*zt,z.lineOffsetY*zt,!1,It,kt,z,F,ge,{}),nr=!1,gr=!1,Lr=!0;if(Bt){for(var Sr=.5*at*xt+bt,$r=new e.Point(-100,-100),Qr=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),fn=new jt,sn=Bt.first,Vn=Bt.last,Jn=[],ha=sn.path.length-1;ha>=1;ha--)Jn.push(sn.path[ha]);for(var Wr=1;Wr<Vn.path.length;Wr++)Jn.push(Vn.path[Wr]);var Mn=2.5*Sr;if(we){var Kn=Jn.map(function(Mo){return Zt(Mo,we)});Jn=Kn.some(function(Mo){return Mo.signedDistanceFromCamera<=0})?[]:Kn.map(function(Mo){return Mo.point})}var Yn=[];if(Jn.length>0){for(var ia=Jn[0].clone(),da=Jn[0].clone(),La=1;La<Jn.length;La++)ia.x=Math.min(ia.x,Jn[La].x),ia.y=Math.min(ia.y,Jn[La].y),da.x=Math.max(da.x,Jn[La].x),da.y=Math.max(da.y,Jn[La].y);Yn=ia.x>=$r.x&&da.x<=Qr.x&&ia.y>=$r.y&&da.y<=Qr.y?[Jn]:da.x<$r.x||ia.x>Qr.x||da.y<$r.y||ia.y>Qr.y?[]:e.clipLine([Jn],$r.x,$r.y,Qr.x,Qr.y)}for(var ta=0,_a=Yn;ta<_a.length;ta+=1){var ya=_a[ta];fn.reset(ya,.25*Sr);var Ia=0;Ia=fn.length<=.5*Sr?1:Math.ceil(fn.paddedLength/Mn)+1;for(var wa=0;wa<Ia;wa++){var Oa=wa/Math.max(Ia-1,1),Ha=fn.lerp(Oa),di=Ha.x+100,Di=Ha.y+100;Et.push(di,Di,Sr,0);var Ri=di-Sr,pi=Di-Sr,Ei=di+Sr,bi=Di+Sr;if(Lr=Lr&&this.isOffscreen(Ri,pi,Ei,bi),gr=gr||this.isInsideGrid(Ri,pi,Ei,bi),!C&&this.grid.hitTestCircle(di,Di,Sr,Je)&&(nr=!0,!Se))return{circles:[],offscreen:!1,collisionDetected:nr}}}}return{circles:!Se&&nr||!gr?[]:Et,offscreen:Lr,collisionDetected:nr}},vn.prototype.queryRenderedSymbols=function(C){if(C.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var z=[],F=1/0,q=1/0,ie=-1/0,ue=-1/0,ge=0,we=C;ge<we.length;ge+=1){var Se=we[ge],Ve=new e.Point(Se.x+100,Se.y+100);F=Math.min(F,Ve.x),q=Math.min(q,Ve.y),ie=Math.max(ie,Ve.x),ue=Math.max(ue,Ve.y),z.push(Ve)}for(var Je={},at={},bt=0,Et=this.grid.query(F,q,ie,ue).concat(this.ignoredGrid.query(F,q,ie,ue));bt<Et.length;bt+=1){var kt=Et[bt],At=kt.key;if(Je[At.bucketInstanceId]===void 0&&(Je[At.bucketInstanceId]={}),!Je[At.bucketInstanceId][At.featureIndex]){var xt=[new e.Point(kt.x1,kt.y1),new e.Point(kt.x2,kt.y1),new e.Point(kt.x2,kt.y2),new e.Point(kt.x1,kt.y2)];e.polygonIntersectsPolygon(z,xt)&&(Je[At.bucketInstanceId][At.featureIndex]=!0,at[At.bucketInstanceId]===void 0&&(at[At.bucketInstanceId]=[]),at[At.bucketInstanceId].push(At.featureIndex))}}return at},vn.prototype.insertCollisionBox=function(C,z,F,q,ie){var ue={bucketInstanceId:F,featureIndex:q,collisionGroupID:ie};(z?this.ignoredGrid:this.grid).insert(ue,C[0],C[1],C[2],C[3])},vn.prototype.insertCollisionCircles=function(C,z,F,q,ie){for(var ue=z?this.ignoredGrid:this.grid,ge={bucketInstanceId:F,featureIndex:q,collisionGroupID:ie},we=0;we<C.length;we+=4)ue.insertCircle(ge,C[we],C[we+1],C[we+2])},vn.prototype.projectAndGetPerspectiveRatio=function(C,z,F){var q=[z,F,0,1];return In(q,q,C),{point:new e.Point((q[0]/q[3]+1)/2*this.transform.width+100,(-q[1]/q[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/q[3]*.5}},vn.prototype.isOffscreen=function(C,z,F,q){return F<100||C>=this.screenRightBoundary||q<100||z>this.screenBottomBoundary},vn.prototype.isInsideGrid=function(C,z,F,q){return F>=0&&C<this.gridRightBoundary&&q>=0&&z<this.gridBottomBoundary},vn.prototype.getViewportMatrix=function(){var C=e.identity([]);return e.translate(C,C,[-100,-100,0]),C};var Sn=function(C,z,F,q){this.opacity=C?Math.max(0,Math.min(1,C.opacity+(C.placed?z:-z))):q&&F?1:0,this.placed=F};Sn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Xn=function(C,z,F,q,ie){this.text=new Sn(C?C.text:null,z,F,ie),this.icon=new Sn(C?C.icon:null,z,q,ie)};Xn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Br=function(C,z,F){this.text=C,this.icon=z,this.skipFade=F},pn=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},on=function(C,z,F,q,ie){this.bucketInstanceId=C,this.featureIndex=z,this.sourceLayerIndex=F,this.bucketIndex=q,this.tileID=ie},Yr=function(C){this.crossSourceCollisions=C,this.maxGroupID=0,this.collisionGroups={}};function Nn(C,z,F,q,ie){var ue=e.getAnchorAlignment(C),ge=-(ue.horizontalAlign-.5)*z,we=-(ue.verticalAlign-.5)*F,Se=e.evaluateVariableOffset(C,q);return new e.Point(ge+Se[0]*ie,we+Se[1]*ie)}function Hn(C,z,F,q,ie,ue){var ge=C.x1,we=C.x2,Se=C.y1,Ve=C.y2,Je=C.anchorPointX,at=C.anchorPointY,bt=new e.Point(z,F);return q&&bt._rotate(ie?ue:-ue),{x1:ge+bt.x,y1:Se+bt.y,x2:we+bt.x,y2:Ve+bt.y,anchorPointX:Je,anchorPointY:at}}Yr.prototype.get=function(C){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[C]){var z=++this.maxGroupID;this.collisionGroups[C]={ID:z,predicate:function(F){return F.collisionGroupID===z}}}return this.collisionGroups[C]};var xn=function(C,z,F,q){this.transform=C.clone(),this.collisionIndex=new vn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=z,this.retainedQueryData={},this.collisionGroups=new Yr(F),this.collisionCircleArrays={},this.prevPlacement=q,q&&(q.prevPlacement=void 0),this.placedOrientations={}};function On(C,z,F,q,ie){C.emplaceBack(z?1:0,F?1:0,q||0,ie||0),C.emplaceBack(z?1:0,F?1:0,q||0,ie||0),C.emplaceBack(z?1:0,F?1:0,q||0,ie||0),C.emplaceBack(z?1:0,F?1:0,q||0,ie||0)}xn.prototype.getBucketParts=function(C,z,F,q){var ie=F.getBucket(z),ue=F.latestFeatureIndex;if(ie&&ue&&z.id===ie.layerIds[0]){var ge=F.collisionBoxArray,we=ie.layers[0].layout,Se=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),Ve=F.tileSize/e.EXTENT,Je=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),at=we.get("text-pitch-alignment")==="map",bt=we.get("text-rotation-alignment")==="map",Et=gn(F,1,this.transform.zoom),kt=Ar(Je,at,bt,this.transform,Et),At=null;if(at){var xt=fr(Je,at,bt,this.transform,Et);At=e.multiply([],this.transform.labelPlaneMatrix,xt)}this.retainedQueryData[ie.bucketInstanceId]=new on(ie.bucketInstanceId,ue,ie.sourceLayerIndex,ie.index,F.tileID);var zt={bucket:ie,layout:we,posMatrix:Je,textLabelPlaneMatrix:kt,labelToScreenMatrix:At,scale:Se,textPixelRatio:Ve,holdingForFade:F.holdingForFade(),collisionBoxArray:ge,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(ie.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(ie.sourceID)};if(q)for(var It=0,Bt=ie.sortKeyRanges;It<Bt.length;It+=1){var nr=Bt[It],gr=nr.sortKey,Lr=nr.symbolInstanceStart,Sr=nr.symbolInstanceEnd;C.push({sortKey:gr,symbolInstanceStart:Lr,symbolInstanceEnd:Sr,parameters:zt})}else C.push({symbolInstanceStart:0,symbolInstanceEnd:ie.symbolInstances.length,parameters:zt})}},xn.prototype.attemptAnchorPlacement=function(C,z,F,q,ie,ue,ge,we,Se,Ve,Je,at,bt,Et,kt){var At,xt=[at.textOffset0,at.textOffset1],zt=Nn(C,F,q,xt,ie),It=this.collisionIndex.placeCollisionBox(Hn(z,zt.x,zt.y,ue,ge,this.transform.angle),Je,we,Se,Ve.predicate);if(!(kt&&this.collisionIndex.placeCollisionBox(Hn(kt,zt.x,zt.y,ue,ge,this.transform.angle),Je,we,Se,Ve.predicate).box.length===0)&&It.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[at.crossTileID]&&this.prevPlacement.placements[at.crossTileID]&&this.prevPlacement.placements[at.crossTileID].text&&(At=this.prevPlacement.variableOffsets[at.crossTileID].anchor),this.variableOffsets[at.crossTileID]={textOffset:xt,width:F,height:q,anchor:C,textBoxScale:ie,prevAnchor:At},this.markUsedJustification(bt,C,at,Et),bt.allowVerticalPlacement&&(this.markUsedOrientation(bt,Et,at),this.placedOrientations[at.crossTileID]=Et),{shift:zt,placedGlyphBoxes:It}},xn.prototype.placeLayerBucketPart=function(C,z,F){var q=this,ie=C.parameters,ue=ie.bucket,ge=ie.layout,we=ie.posMatrix,Se=ie.textLabelPlaneMatrix,Ve=ie.labelToScreenMatrix,Je=ie.textPixelRatio,at=ie.holdingForFade,bt=ie.collisionBoxArray,Et=ie.partiallyEvaluatedTextSize,kt=ie.collisionGroup,At=ge.get("text-optional"),xt=ge.get("icon-optional"),zt=ge.get("text-allow-overlap"),It=ge.get("icon-allow-overlap"),Bt=ge.get("text-rotation-alignment")==="map",nr=ge.get("text-pitch-alignment")==="map",gr=ge.get("icon-text-fit")!=="none",Lr=ge.get("symbol-z-order")==="viewport-y",Sr=zt&&(It||!ue.hasIconData()||xt),$r=It&&(zt||!ue.hasTextData()||At);!ue.collisionArrays&&bt&&ue.deserializeCollisionBoxes(bt);var Qr=function(Wr,Mn){if(!z[Wr.crossTileID])if(at)q.placements[Wr.crossTileID]=new Br(!1,!1,!1);else{var Kn,Yn=!1,ia=!1,da=!0,La=null,ta={box:null,offscreen:null},_a={box:null,offscreen:null},ya=null,Ia=null,wa=0,Oa=0,Ha=0;Mn.textFeatureIndex?wa=Mn.textFeatureIndex:Wr.useRuntimeCollisionCircles&&(wa=Wr.featureIndex),Mn.verticalTextFeatureIndex&&(Oa=Mn.verticalTextFeatureIndex);var di=Mn.textBox;if(di){var Di=function(Li){var Fo=e.WritingMode.horizontal;if(ue.allowVerticalPlacement&&!Li&&q.prevPlacement){var Bo=q.prevPlacement.placedOrientations[Wr.crossTileID];Bo&&(q.placedOrientations[Wr.crossTileID]=Bo,Fo=Bo,q.markUsedOrientation(ue,Fo,Wr))}return Fo},Ri=function(Li,Fo){if(ue.allowVerticalPlacement&&Wr.numVerticalGlyphVertices>0&&Mn.verticalTextBox)for(var Bo=0,Vl=ue.writingModes;Bo<Vl.length&&(Vl[Bo]===e.WritingMode.vertical?(ta=Fo(),_a=ta):ta=Li(),!(ta&&ta.box&&ta.box.length));Bo+=1);else ta=Li()};if(ge.get("text-variable-anchor")){var pi=ge.get("text-variable-anchor");if(q.prevPlacement&&q.prevPlacement.variableOffsets[Wr.crossTileID]){var Ei=q.prevPlacement.variableOffsets[Wr.crossTileID];pi.indexOf(Ei.anchor)>0&&(pi=pi.filter(function(Li){return Li!==Ei.anchor})).unshift(Ei.anchor)}var bi=function(Li,Fo,Bo){for(var Vl=Li.x2-Li.x1,Fu=Li.y2-Li.y1,$o=Wr.textBoxScale,yc=gr&&!It?Fo:null,Ll={box:[],offscreen:!1},Bu=zt?2*pi.length:pi.length,$s=0;$s<Bu;++$s){var Nu=pi[$s%pi.length],Hl=$s>=pi.length,xc=q.attemptAnchorPlacement(Nu,Li,Vl,Fu,$o,Bt,nr,Je,we,kt,Hl,Wr,ue,Bo,yc);if(xc&&(Ll=xc.placedGlyphBoxes)&&Ll.box&&Ll.box.length){Yn=!0,La=xc.shift;break}}return Ll};Ri(function(){return bi(di,Mn.iconBox,e.WritingMode.horizontal)},function(){var Li=Mn.verticalTextBox,Fo=ta&&ta.box&&ta.box.length;return ue.allowVerticalPlacement&&!Fo&&Wr.numVerticalGlyphVertices>0&&Li?bi(Li,Mn.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),ta&&(Yn=ta.box,da=ta.offscreen);var Mo=Di(ta&&ta.box);if(!Yn&&q.prevPlacement){var Zi=q.prevPlacement.variableOffsets[Wr.crossTileID];Zi&&(q.variableOffsets[Wr.crossTileID]=Zi,q.markUsedJustification(ue,Zi.anchor,Wr,Mo))}}else{var Uo=function(Li,Fo){var Bo=q.collisionIndex.placeCollisionBox(Li,zt,Je,we,kt.predicate);return Bo&&Bo.box&&Bo.box.length&&(q.markUsedOrientation(ue,Fo,Wr),q.placedOrientations[Wr.crossTileID]=Fo),Bo};Ri(function(){return Uo(di,e.WritingMode.horizontal)},function(){var Li=Mn.verticalTextBox;return ue.allowVerticalPlacement&&Wr.numVerticalGlyphVertices>0&&Li?Uo(Li,e.WritingMode.vertical):{box:null,offscreen:null}}),Di(ta&&ta.box&&ta.box.length)}}if(Yn=(Kn=ta)&&Kn.box&&Kn.box.length>0,da=Kn&&Kn.offscreen,Wr.useRuntimeCollisionCircles){var As=ue.text.placedSymbolArray.get(Wr.centerJustifiedTextSymbolIndex),Xs=e.evaluateSizeForFeature(ue.textSizeData,Et,As),Al=ge.get("text-padding"),fl=Wr.collisionCircleDiameter;ya=q.collisionIndex.placeCollisionCircles(zt,As,ue.lineVertexArray,ue.glyphOffsetArray,Xs,we,Se,Ve,F,nr,kt.predicate,fl,Al),Yn=zt||ya.circles.length>0&&!ya.collisionDetected,da=da&&ya.offscreen}if(Mn.iconFeatureIndex&&(Ha=Mn.iconFeatureIndex),Mn.iconBox){var hl=function(Li){var Fo=gr&&La?Hn(Li,La.x,La.y,Bt,nr,q.transform.angle):Li;return q.collisionIndex.placeCollisionBox(Fo,It,Je,we,kt.predicate)};ia=_a&&_a.box&&_a.box.length&&Mn.verticalIconBox?(Ia=hl(Mn.verticalIconBox)).box.length>0:(Ia=hl(Mn.iconBox)).box.length>0,da=da&&Ia.offscreen}var Ao=At||Wr.numHorizontalGlyphVertices===0&&Wr.numVerticalGlyphVertices===0,Qs=xt||Wr.numIconVertices===0;if(Ao||Qs?Qs?Ao||(ia=ia&&Yn):Yn=ia&&Yn:ia=Yn=ia&&Yn,Yn&&Kn&&Kn.box&&(_a&&_a.box&&Oa?q.collisionIndex.insertCollisionBox(Kn.box,ge.get("text-ignore-placement"),ue.bucketInstanceId,Oa,kt.ID):q.collisionIndex.insertCollisionBox(Kn.box,ge.get("text-ignore-placement"),ue.bucketInstanceId,wa,kt.ID)),ia&&Ia&&q.collisionIndex.insertCollisionBox(Ia.box,ge.get("icon-ignore-placement"),ue.bucketInstanceId,Ha,kt.ID),ya&&(Yn&&q.collisionIndex.insertCollisionCircles(ya.circles,ge.get("text-ignore-placement"),ue.bucketInstanceId,wa,kt.ID),F)){var Sl=ue.bucketInstanceId,ss=q.collisionCircleArrays[Sl];ss===void 0&&(ss=q.collisionCircleArrays[Sl]=new pn);for(var El=0;El<ya.circles.length;El+=4)ss.circles.push(ya.circles[El+0]),ss.circles.push(ya.circles[El+1]),ss.circles.push(ya.circles[El+2]),ss.circles.push(ya.collisionDetected?1:0)}q.placements[Wr.crossTileID]=new Br(Yn||Sr,ia||$r,da||ue.justReloaded),z[Wr.crossTileID]=!0}};if(Lr)for(var fn=ue.getSortedSymbolIndexes(this.transform.angle),sn=fn.length-1;sn>=0;--sn){var Vn=fn[sn];Qr(ue.symbolInstances.get(Vn),ue.collisionArrays[Vn])}else for(var Jn=C.symbolInstanceStart;Jn<C.symbolInstanceEnd;Jn++)Qr(ue.symbolInstances.get(Jn),ue.collisionArrays[Jn]);if(F&&ue.bucketInstanceId in this.collisionCircleArrays){var ha=this.collisionCircleArrays[ue.bucketInstanceId];e.invert(ha.invProjMatrix,we),ha.viewportMatrix=this.collisionIndex.getViewportMatrix()}ue.justReloaded=!1},xn.prototype.markUsedJustification=function(C,z,F,q){var ie,ue={left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex};ie=q===e.WritingMode.vertical?F.verticalPlacedTextSymbolIndex:ue[e.getAnchorJustification(z)];for(var ge=0,we=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];ge<we.length;ge+=1){var Se=we[ge];Se>=0&&(C.text.placedSymbolArray.get(Se).crossTileID=ie>=0&&Se!==ie?0:F.crossTileID)}},xn.prototype.markUsedOrientation=function(C,z,F){for(var q=z===e.WritingMode.horizontal||z===e.WritingMode.horizontalOnly?z:0,ie=z===e.WritingMode.vertical?z:0,ue=0,ge=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];ue<ge.length;ue+=1){var we=ge[ue];C.text.placedSymbolArray.get(we).placedOrientation=q}F.verticalPlacedTextSymbolIndex&&(C.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=ie)},xn.prototype.commit=function(C){this.commitTime=C,this.zoomAtLastRecencyCheck=this.transform.zoom;var z=this.prevPlacement,F=!1;this.prevZoomAdjustment=z?z.zoomAdjustment(this.transform.zoom):0;var q=z?z.symbolFadeChange(C):1,ie=z?z.opacities:{},ue=z?z.variableOffsets:{},ge=z?z.placedOrientations:{};for(var we in this.placements){var Se=this.placements[we],Ve=ie[we];Ve?(this.opacities[we]=new Xn(Ve,q,Se.text,Se.icon),F=F||Se.text!==Ve.text.placed||Se.icon!==Ve.icon.placed):(this.opacities[we]=new Xn(null,q,Se.text,Se.icon,Se.skipFade),F=F||Se.text||Se.icon)}for(var Je in ie){var at=ie[Je];if(!this.opacities[Je]){var bt=new Xn(at,q,!1,!1);bt.isHidden()||(this.opacities[Je]=bt,F=F||at.text.placed||at.icon.placed)}}for(var Et in ue)this.variableOffsets[Et]||!this.opacities[Et]||this.opacities[Et].isHidden()||(this.variableOffsets[Et]=ue[Et]);for(var kt in ge)this.placedOrientations[kt]||!this.opacities[kt]||this.opacities[kt].isHidden()||(this.placedOrientations[kt]=ge[kt]);F?this.lastPlacementChangeTime=C:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=z?z.lastPlacementChangeTime:C)},xn.prototype.updateLayerOpacities=function(C,z){for(var F={},q=0,ie=z;q<ie.length;q+=1){var ue=ie[q],ge=ue.getBucket(C);ge&&ue.latestFeatureIndex&&C.id===ge.layerIds[0]&&this.updateBucketOpacities(ge,F,ue.collisionBoxArray)}},xn.prototype.updateBucketOpacities=function(C,z,F){var q=this;C.hasTextData()&&C.text.opacityVertexArray.clear(),C.hasIconData()&&C.icon.opacityVertexArray.clear(),C.hasIconCollisionBoxData()&&C.iconCollisionBox.collisionVertexArray.clear(),C.hasTextCollisionBoxData()&&C.textCollisionBox.collisionVertexArray.clear();var ie=C.layers[0].layout,ue=new Xn(null,0,!1,!1,!0),ge=ie.get("text-allow-overlap"),we=ie.get("icon-allow-overlap"),Se=ie.get("text-variable-anchor"),Ve=ie.get("text-rotation-alignment")==="map",Je=ie.get("text-pitch-alignment")==="map",at=ie.get("icon-text-fit")!=="none",bt=new Xn(null,0,ge&&(we||!C.hasIconData()||ie.get("icon-optional")),we&&(ge||!C.hasTextData()||ie.get("text-optional")),!0);!C.collisionArrays&&F&&(C.hasIconCollisionBoxData()||C.hasTextCollisionBoxData())&&C.deserializeCollisionBoxes(F);for(var Et=function(zt,It,Bt){for(var nr=0;nr<It/4;nr++)zt.opacityVertexArray.emplaceBack(Bt)},kt=function(zt){var It=C.symbolInstances.get(zt),Bt=It.numHorizontalGlyphVertices,nr=It.numVerticalGlyphVertices,gr=It.crossTileID,Lr=z[gr],Sr=q.opacities[gr];Lr?Sr=ue:Sr||(Sr=bt,q.opacities[gr]=Sr),z[gr]=!0;var $r=Bt>0||nr>0,Qr=It.numIconVertices>0,fn=q.placedOrientations[It.crossTileID],sn=fn===e.WritingMode.vertical,Vn=fn===e.WritingMode.horizontal||fn===e.WritingMode.horizontalOnly;if($r){var Jn=Rr(Sr.text),ha=sn?zr:Jn;Et(C.text,Bt,ha);var Wr=Vn?zr:Jn;Et(C.text,nr,Wr);var Mn=Sr.text.isHidden();[It.rightJustifiedTextSymbolIndex,It.centerJustifiedTextSymbolIndex,It.leftJustifiedTextSymbolIndex].forEach(function(Ha){Ha>=0&&(C.text.placedSymbolArray.get(Ha).hidden=Mn||sn?1:0)}),It.verticalPlacedTextSymbolIndex>=0&&(C.text.placedSymbolArray.get(It.verticalPlacedTextSymbolIndex).hidden=Mn||Vn?1:0);var Kn=q.variableOffsets[It.crossTileID];Kn&&q.markUsedJustification(C,Kn.anchor,It,fn);var Yn=q.placedOrientations[It.crossTileID];Yn&&(q.markUsedJustification(C,"left",It,Yn),q.markUsedOrientation(C,Yn,It))}if(Qr){var ia=Rr(Sr.icon),da=!(at&&It.verticalPlacedIconSymbolIndex&&sn);if(It.placedIconSymbolIndex>=0){var La=da?ia:zr;Et(C.icon,It.numIconVertices,La),C.icon.placedSymbolArray.get(It.placedIconSymbolIndex).hidden=Sr.icon.isHidden()}if(It.verticalPlacedIconSymbolIndex>=0){var ta=da?zr:ia;Et(C.icon,It.numVerticalIconVertices,ta),C.icon.placedSymbolArray.get(It.verticalPlacedIconSymbolIndex).hidden=Sr.icon.isHidden()}}if(C.hasIconCollisionBoxData()||C.hasTextCollisionBoxData()){var _a=C.collisionArrays[zt];if(_a){var ya=new e.Point(0,0);if(_a.textBox||_a.verticalTextBox){var Ia=!0;if(Se){var wa=q.variableOffsets[gr];wa?(ya=Nn(wa.anchor,wa.width,wa.height,wa.textOffset,wa.textBoxScale),Ve&&ya._rotate(Je?q.transform.angle:-q.transform.angle)):Ia=!1}_a.textBox&&On(C.textCollisionBox.collisionVertexArray,Sr.text.placed,!Ia||sn,ya.x,ya.y),_a.verticalTextBox&&On(C.textCollisionBox.collisionVertexArray,Sr.text.placed,!Ia||Vn,ya.x,ya.y)}var Oa=Boolean(!Vn&&_a.verticalIconBox);_a.iconBox&&On(C.iconCollisionBox.collisionVertexArray,Sr.icon.placed,Oa,at?ya.x:0,at?ya.y:0),_a.verticalIconBox&&On(C.iconCollisionBox.collisionVertexArray,Sr.icon.placed,!Oa,at?ya.x:0,at?ya.y:0)}}},At=0;At<C.symbolInstances.length;At++)kt(At);if(C.sortFeatures(this.transform.angle),this.retainedQueryData[C.bucketInstanceId]&&(this.retainedQueryData[C.bucketInstanceId].featureSortOrder=C.featureSortOrder),C.hasTextData()&&C.text.opacityVertexBuffer&&C.text.opacityVertexBuffer.updateData(C.text.opacityVertexArray),C.hasIconData()&&C.icon.opacityVertexBuffer&&C.icon.opacityVertexBuffer.updateData(C.icon.opacityVertexArray),C.hasIconCollisionBoxData()&&C.iconCollisionBox.collisionVertexBuffer&&C.iconCollisionBox.collisionVertexBuffer.updateData(C.iconCollisionBox.collisionVertexArray),C.hasTextCollisionBoxData()&&C.textCollisionBox.collisionVertexBuffer&&C.textCollisionBox.collisionVertexBuffer.updateData(C.textCollisionBox.collisionVertexArray),C.bucketInstanceId in this.collisionCircleArrays){var xt=this.collisionCircleArrays[C.bucketInstanceId];C.placementInvProjMatrix=xt.invProjMatrix,C.placementViewportMatrix=xt.viewportMatrix,C.collisionCircleArray=xt.circles,delete this.collisionCircleArrays[C.bucketInstanceId]}},xn.prototype.symbolFadeChange=function(C){return this.fadeDuration===0?1:(C-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},xn.prototype.zoomAdjustment=function(C){return Math.max(0,(this.transform.zoom-C)/1.5)},xn.prototype.hasTransitions=function(C){return this.stale||C-this.lastPlacementChangeTime<this.fadeDuration},xn.prototype.stillRecent=function(C,z){var F=this.zoomAtLastRecencyCheck===z?1-this.zoomAdjustment(z):1;return this.zoomAtLastRecencyCheck=z,this.commitTime+this.fadeDuration*F>C},xn.prototype.setStale=function(){this.stale=!0};var ua=Math.pow(2,25),tr=Math.pow(2,24),yr=Math.pow(2,17),Ct=Math.pow(2,16),lr=Math.pow(2,9),dr=Math.pow(2,8),Fr=Math.pow(2,1);function Rr(C){if(C.opacity===0&&!C.placed)return 0;if(C.opacity===1&&C.placed)return 4294967295;var z=C.placed?1:0,F=Math.floor(127*C.opacity);return F*ua+z*tr+F*yr+z*Ct+F*lr+z*dr+F*Fr+z}var zr=0,Er=function(C){this._sortAcrossTiles=C.layout.get("symbol-z-order")!=="viewport-y"&&C.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Er.prototype.continuePlacement=function(C,z,F,q,ie){for(var ue=this._bucketParts;this._currentTileIndex<C.length;){var ge=C[this._currentTileIndex];if(z.getBucketParts(ue,q,ge,this._sortAcrossTiles),this._currentTileIndex++,ie())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,ue.sort(function(Se,Ve){return Se.sortKey-Ve.sortKey}));this._currentPartIndex<ue.length;){var we=ue[this._currentPartIndex];if(z.placeLayerBucketPart(we,this._seenCrossTileIDs,F),this._currentPartIndex++,ie())return!0}return!1};var xr=function(C,z,F,q,ie,ue,ge){this.placement=new xn(C,ie,ue,ge),this._currentPlacementIndex=z.length-1,this._forceFullPlacement=F,this._showCollisionBoxes=q,this._done=!1};xr.prototype.isDone=function(){return this._done},xr.prototype.continuePlacement=function(C,z,F){for(var q=this,ie=e.browser.now(),ue=function(){var Se=e.browser.now()-ie;return!q._forceFullPlacement&&Se>2};this._currentPlacementIndex>=0;){var ge=z[C[this._currentPlacementIndex]],we=this.placement.collisionIndex.transform.zoom;if(ge.type==="symbol"&&(!ge.minzoom||ge.minzoom<=we)&&(!ge.maxzoom||ge.maxzoom>we)){if(this._inProgressLayer||(this._inProgressLayer=new Er(ge)),this._inProgressLayer.continuePlacement(F[ge.source],this.placement,this._showCollisionBoxes,ge,ue))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},xr.prototype.commit=function(C){return this.placement.commit(C),this.placement};var _r=512/e.EXTENT/2,kr=function(C,z,F){this.tileID=C,this.indexedSymbolInstances={},this.bucketInstanceId=F;for(var q=0;q<z.length;q++){var ie=z.get(q),ue=ie.key;this.indexedSymbolInstances[ue]||(this.indexedSymbolInstances[ue]=[]),this.indexedSymbolInstances[ue].push({crossTileID:ie.crossTileID,coord:this.getScaledCoordinates(ie,C)})}};kr.prototype.getScaledCoordinates=function(C,z){var F=z.canonical.z-this.tileID.canonical.z,q=_r/Math.pow(2,F);return{x:Math.floor((z.canonical.x*e.EXTENT+C.anchorX)*q),y:Math.floor((z.canonical.y*e.EXTENT+C.anchorY)*q)}},kr.prototype.findMatches=function(C,z,F){for(var q=this.tileID.canonical.z<z.canonical.z?1:Math.pow(2,this.tileID.canonical.z-z.canonical.z),ie=0;ie<C.length;ie++){var ue=C.get(ie);if(!ue.crossTileID){var ge=this.indexedSymbolInstances[ue.key];if(ge)for(var we=this.getScaledCoordinates(ue,z),Se=0,Ve=ge;Se<Ve.length;Se+=1){var Je=Ve[Se];if(Math.abs(Je.coord.x-we.x)<=q&&Math.abs(Je.coord.y-we.y)<=q&&!F[Je.crossTileID]){F[Je.crossTileID]=!0,ue.crossTileID=Je.crossTileID;break}}}}};var Cr=function(){this.maxCrossTileID=0};Cr.prototype.generate=function(){return++this.maxCrossTileID};var Gr=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Gr.prototype.handleWrapJump=function(C){var z=Math.round((C-this.lng)/360);if(z!==0)for(var F in this.indexes){var q=this.indexes[F],ie={};for(var ue in q){var ge=q[ue];ge.tileID=ge.tileID.unwrapTo(ge.tileID.wrap+z),ie[ge.tileID.key]=ge}this.indexes[F]=ie}this.lng=C},Gr.prototype.addBucket=function(C,z,F){if(this.indexes[C.overscaledZ]&&this.indexes[C.overscaledZ][C.key]){if(this.indexes[C.overscaledZ][C.key].bucketInstanceId===z.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(C.overscaledZ,this.indexes[C.overscaledZ][C.key])}for(var q=0;q<z.symbolInstances.length;q++)z.symbolInstances.get(q).crossTileID=0;this.usedCrossTileIDs[C.overscaledZ]||(this.usedCrossTileIDs[C.overscaledZ]={});var ie=this.usedCrossTileIDs[C.overscaledZ];for(var ue in this.indexes){var ge=this.indexes[ue];if(Number(ue)>C.overscaledZ)for(var we in ge){var Se=ge[we];Se.tileID.isChildOf(C)&&Se.findMatches(z.symbolInstances,C,ie)}else{var Ve=ge[C.scaledTo(Number(ue)).key];Ve&&Ve.findMatches(z.symbolInstances,C,ie)}}for(var Je=0;Je<z.symbolInstances.length;Je++){var at=z.symbolInstances.get(Je);at.crossTileID||(at.crossTileID=F.generate(),ie[at.crossTileID]=!0)}return this.indexes[C.overscaledZ]===void 0&&(this.indexes[C.overscaledZ]={}),this.indexes[C.overscaledZ][C.key]=new kr(C,z.symbolInstances,z.bucketInstanceId),!0},Gr.prototype.removeBucketCrossTileIDs=function(C,z){for(var F in z.indexedSymbolInstances)for(var q=0,ie=z.indexedSymbolInstances[F];q<ie.length;q+=1){var ue=ie[q];delete this.usedCrossTileIDs[C][ue.crossTileID]}},Gr.prototype.removeStaleBuckets=function(C){var z=!1;for(var F in this.indexes){var q=this.indexes[F];for(var ie in q)C[q[ie].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,q[ie]),delete q[ie],z=!0)}return z};var qr=function(){this.layerIndexes={},this.crossTileIDs=new Cr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};qr.prototype.addLayer=function(C,z,F){var q=this.layerIndexes[C.id];q===void 0&&(q=this.layerIndexes[C.id]=new Gr);var ie=!1,ue={};q.handleWrapJump(F);for(var ge=0,we=z;ge<we.length;ge+=1){var Se=we[ge],Ve=Se.getBucket(C);Ve&&C.id===Ve.layerIds[0]&&(Ve.bucketInstanceId||(Ve.bucketInstanceId=++this.maxBucketInstanceId),q.addBucket(Se.tileID,Ve,this.crossTileIDs)&&(ie=!0),ue[Ve.bucketInstanceId]=!0)}return q.removeStaleBuckets(ue)&&(ie=!0),ie},qr.prototype.pruneUnusedLayers=function(C){var z={};for(var F in C.forEach(function(q){z[q]=!0}),this.layerIndexes)z[F]||delete this.layerIndexes[F]};var tn=function(C,z){return e.emitValidationErrors(C,z&&z.filter(function(F){return F.identifier!=="source.canvas"}))},rn=e.pick(wt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),yn=e.pick(wt,["setCenter","setZoom","setBearing","setPitch"]),_n=function(){var C={},z=e.styleSpec.$version;for(var F in e.styleSpec.$root){var q=e.styleSpec.$root[F];if(q.required){var ie=null;(ie=F==="version"?z:q.type==="array"?[]:{})!=null&&(C[F]=ie)}}return C}(),wn=function(C){function z(F,q){var ie=this;q===void 0&&(q={}),C.call(this),this.map=F,this.dispatcher=new S(rt(),this),this.imageManager=new d,this.imageManager.setEventedParent(this),this.glyphManager=new k(F._requestManager,q.localIdeographFontFamily),this.lineAtlas=new P(256,512),this.crossTileSymbolIndex=new qr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var ue=this;this._rtlTextPluginCallback=z.registerForPluginStateChange(function(ge){var we={pluginStatus:ge.pluginStatus,pluginURL:ge.pluginURL};ue.dispatcher.broadcast("syncRTLPluginState",we,function(Se,Ve){if(e.triggerPluginCompletionEvent(Se),Ve&&Ve.every(function(at){return at}))for(var Je in ue.sourceCaches)ue.sourceCaches[Je].reload()})}),this.on("data",function(ge){if(ge.dataType==="source"&&ge.sourceDataType==="metadata"){var we=ie.sourceCaches[ge.sourceId];if(we){var Se=we.getSource();if(Se&&Se.vectorLayerIds)for(var Ve in ie._layers){var Je=ie._layers[Ve];Je.source===Se.id&&ie._validateLayer(Je)}}}})}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.loadURL=function(F,q){var ie=this;q===void 0&&(q={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var ue=typeof q.validate=="boolean"?q.validate:!e.isMapboxURL(F);F=this.map._requestManager.normalizeStyleURL(F,q.accessToken);var ge=this.map._requestManager.transformRequest(F,e.ResourceType.Style);this._request=e.getJSON(ge,function(we,Se){ie._request=null,we?ie.fire(new e.ErrorEvent(we)):Se&&ie._load(Se,ue)})},z.prototype.loadJSON=function(F,q){var ie=this;q===void 0&&(q={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){ie._request=null,ie._load(F,q.validate!==!1)})},z.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(_n,!1)},z.prototype._load=function(F,q){if(!q||!tn(this,e.validateStyle(F))){for(var ie in this._loaded=!0,this.stylesheet=F,F.sources)this.addSource(ie,F.sources[ie],{validate:!1});F.sprite?this._loadSprite(F.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(F.glyphs);var ue=Ft(this.stylesheet.layers);this._order=ue.map(function(Ve){return Ve.id}),this._layers={},this._serializedLayers={};for(var ge=0,we=ue;ge<we.length;ge+=1){var Se=we[ge];(Se=e.createStyleLayer(Se)).setEventedParent(this,{layer:{id:Se.id}}),this._layers[Se.id]=Se,this._serializedLayers[Se.id]=Se.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new I(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},z.prototype._loadSprite=function(F){var q=this;this._spriteRequest=function(ie,ue,ge){var we,Se,Ve,Je=e.browser.devicePixelRatio>1?"@2x":"",at=e.getJSON(ue.transformRequest(ue.normalizeSpriteURL(ie,Je,".json"),e.ResourceType.SpriteJSON),function(kt,At){at=null,Ve||(Ve=kt,we=At,Et())}),bt=e.getImage(ue.transformRequest(ue.normalizeSpriteURL(ie,Je,".png"),e.ResourceType.SpriteImage),function(kt,At){bt=null,Ve||(Ve=kt,Se=At,Et())});function Et(){if(Ve)ge(Ve);else if(we&&Se){var kt=e.browser.getImageData(Se),At={};for(var xt in we){var zt=we[xt],It=zt.width,Bt=zt.height,nr=zt.x,gr=zt.y,Lr=zt.sdf,Sr=zt.pixelRatio,$r=zt.stretchX,Qr=zt.stretchY,fn=zt.content,sn=new e.RGBAImage({width:It,height:Bt});e.RGBAImage.copy(kt,sn,{x:nr,y:gr},{x:0,y:0},{width:It,height:Bt}),At[xt]={data:sn,pixelRatio:Sr,sdf:Lr,stretchX:$r,stretchY:Qr,content:fn}}ge(null,At)}}return{cancel:function(){at&&(at.cancel(),at=null),bt&&(bt.cancel(),bt=null)}}}(F,this.map._requestManager,function(ie,ue){if(q._spriteRequest=null,ie)q.fire(new e.ErrorEvent(ie));else if(ue)for(var ge in ue)q.imageManager.addImage(ge,ue[ge]);q.imageManager.setLoaded(!0),q._availableImages=q.imageManager.listImages(),q.dispatcher.broadcast("setImages",q._availableImages),q.fire(new e.Event("data",{dataType:"style"}))})},z.prototype._validateLayer=function(F){var q=this.sourceCaches[F.source];if(q){var ie=F.sourceLayer;if(ie){var ue=q.getSource();(ue.type==="geojson"||ue.vectorLayerIds&&ue.vectorLayerIds.indexOf(ie)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+ie+'" does not exist on source "'+ue.id+'" as specified by style layer "'+F.id+'"')))}}},z.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var F in this.sourceCaches)if(!this.sourceCaches[F].loaded())return!1;return!!this.imageManager.isLoaded()},z.prototype._serializeLayers=function(F){for(var q=[],ie=0,ue=F;ie<ue.length;ie+=1){var ge=ue[ie],we=this._layers[ge];we.type!=="custom"&&q.push(we.serialize())}return q},z.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var F in this.sourceCaches)if(this.sourceCaches[F].hasTransition())return!0;for(var q in this._layers)if(this._layers[q].hasTransition())return!0;return!1},z.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},z.prototype.update=function(F){if(this._loaded){var q=this._changed;if(this._changed){var ie=Object.keys(this._updatedLayers),ue=Object.keys(this._removedLayers);for(var ge in(ie.length||ue.length)&&this._updateWorkerLayers(ie,ue),this._updatedSources){var we=this._updatedSources[ge];we==="reload"?this._reloadSource(ge):we==="clear"&&this._clearSource(ge)}for(var Se in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Se].updateTransitions(F);this.light.updateTransitions(F),this._resetUpdates()}for(var Ve in this.sourceCaches)this.sourceCaches[Ve].used=!1;for(var Je=0,at=this._order;Je<at.length;Je+=1){var bt=at[Je],Et=this._layers[bt];Et.recalculate(F,this._availableImages),!Et.isHidden(F.zoom)&&Et.source&&(this.sourceCaches[Et.source].used=!0)}this.light.recalculate(F),this.z=F.zoom,q&&this.fire(new e.Event("data",{dataType:"style"}))}},z.prototype._updateTilesForChangedImages=function(){var F=Object.keys(this._changedImages);if(F.length){for(var q in this.sourceCaches)this.sourceCaches[q].reloadTilesForDependencies(["icons","patterns"],F);this._changedImages={}}},z.prototype._updateWorkerLayers=function(F,q){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(F),removedIds:q})},z.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},z.prototype.setState=function(F){var q=this;if(this._checkLoaded(),tn(this,e.validateStyle(F)))return!1;(F=e.clone$1(F)).layers=Ft(F.layers);var ie=Gt(this.serialize(),F).filter(function(ge){return!(ge.command in yn)});if(ie.length===0)return!1;var ue=ie.filter(function(ge){return!(ge.command in rn)});if(ue.length>0)throw new Error("Unimplemented: "+ue.map(function(ge){return ge.command}).join(", ")+".");return ie.forEach(function(ge){ge.command!=="setTransition"&&q[ge.command].apply(q,ge.args)}),this.stylesheet=F,!0},z.prototype.addImage=function(F,q){if(this.getImage(F))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(F,q),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},z.prototype.updateImage=function(F,q){this.imageManager.updateImage(F,q)},z.prototype.getImage=function(F){return this.imageManager.getImage(F)},z.prototype.removeImage=function(F){if(!this.getImage(F))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(F),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},z.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},z.prototype.addSource=function(F,q,ie){var ue=this;if(ie===void 0&&(ie={}),this._checkLoaded(),this.sourceCaches[F]!==void 0)throw new Error("There is already a source with this ID");if(!q.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(q).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(q.type)>=0)||!this._validate(e.validateStyle.source,"sources."+F,q,null,ie)){this.map&&this.map._collectResourceTiming&&(q.collectResourceTiming=!0);var ge=this.sourceCaches[F]=new De(F,q,this.dispatcher);ge.style=this,ge.setEventedParent(this,function(){return{isSourceLoaded:ue.loaded(),source:ge.serialize(),sourceId:F}}),ge.onAdd(this.map),this._changed=!0}},z.prototype.removeSource=function(F){if(this._checkLoaded(),this.sourceCaches[F]===void 0)throw new Error("There is no source with this ID");for(var q in this._layers)if(this._layers[q].source===F)return this.fire(new e.ErrorEvent(new Error('Source "'+F+'" cannot be removed while layer "'+q+'" is using it.')));var ie=this.sourceCaches[F];delete this.sourceCaches[F],delete this._updatedSources[F],ie.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:F})),ie.setEventedParent(null),ie.clearTiles(),ie.onRemove&&ie.onRemove(this.map),this._changed=!0},z.prototype.setGeoJSONSourceData=function(F,q){this._checkLoaded(),this.sourceCaches[F].getSource().setData(q),this._changed=!0},z.prototype.getSource=function(F){return this.sourceCaches[F]&&this.sourceCaches[F].getSource()},z.prototype.addLayer=function(F,q,ie){ie===void 0&&(ie={}),this._checkLoaded();var ue=F.id;if(this.getLayer(ue))this.fire(new e.ErrorEvent(new Error('Layer with id "'+ue+'" already exists on this map')));else{var ge;if(F.type==="custom"){if(tn(this,e.validateCustomStyleLayer(F)))return;ge=e.createStyleLayer(F)}else{if(typeof F.source=="object"&&(this.addSource(ue,F.source),F=e.clone$1(F),F=e.extend(F,{source:ue})),this._validate(e.validateStyle.layer,"layers."+ue,F,{arrayIndex:-1},ie))return;ge=e.createStyleLayer(F),this._validateLayer(ge),ge.setEventedParent(this,{layer:{id:ue}}),this._serializedLayers[ge.id]=ge.serialize()}var we=q?this._order.indexOf(q):this._order.length;if(q&&we===-1)this.fire(new e.ErrorEvent(new Error('Layer with id "'+q+'" does not exist on this map.')));else{if(this._order.splice(we,0,ue),this._layerOrderChanged=!0,this._layers[ue]=ge,this._removedLayers[ue]&&ge.source&&ge.type!=="custom"){var Se=this._removedLayers[ue];delete this._removedLayers[ue],Se.type!==ge.type?this._updatedSources[ge.source]="clear":(this._updatedSources[ge.source]="reload",this.sourceCaches[ge.source].pause())}this._updateLayer(ge),ge.onAdd&&ge.onAdd(this.map)}}},z.prototype.moveLayer=function(F,q){if(this._checkLoaded(),this._changed=!0,this._layers[F]){if(F!==q){var ie=this._order.indexOf(F);this._order.splice(ie,1);var ue=q?this._order.indexOf(q):this._order.length;q&&ue===-1?this.fire(new e.ErrorEvent(new Error('Layer with id "'+q+'" does not exist on this map.'))):(this._order.splice(ue,0,F),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be moved.")))},z.prototype.removeLayer=function(F){this._checkLoaded();var q=this._layers[F];if(q){q.setEventedParent(null);var ie=this._order.indexOf(F);this._order.splice(ie,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[F]=q,delete this._layers[F],delete this._serializedLayers[F],delete this._updatedLayers[F],delete this._updatedPaintProps[F],q.onRemove&&q.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be removed.")))},z.prototype.getLayer=function(F){return this._layers[F]},z.prototype.hasLayer=function(F){return F in this._layers},z.prototype.setLayerZoomRange=function(F,q,ie){this._checkLoaded();var ue=this.getLayer(F);ue?ue.minzoom===q&&ue.maxzoom===ie||(q!=null&&(ue.minzoom=q),ie!=null&&(ue.maxzoom=ie),this._updateLayer(ue)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot have zoom extent.")))},z.prototype.setFilter=function(F,q,ie){ie===void 0&&(ie={}),this._checkLoaded();var ue=this.getLayer(F);if(ue){if(!e.deepEqual(ue.filter,q))return q==null?(ue.filter=void 0,void this._updateLayer(ue)):void(this._validate(e.validateStyle.filter,"layers."+ue.id+".filter",q,null,ie)||(ue.filter=e.clone$1(q),this._updateLayer(ue)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be filtered.")))},z.prototype.getFilter=function(F){return e.clone$1(this.getLayer(F).filter)},z.prototype.setLayoutProperty=function(F,q,ie,ue){ue===void 0&&(ue={}),this._checkLoaded();var ge=this.getLayer(F);ge?e.deepEqual(ge.getLayoutProperty(q),ie)||(ge.setLayoutProperty(q,ie,ue),this._updateLayer(ge)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},z.prototype.getLayoutProperty=function(F,q){var ie=this.getLayer(F);if(ie)return ie.getLayoutProperty(q);this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style.")))},z.prototype.setPaintProperty=function(F,q,ie,ue){ue===void 0&&(ue={}),this._checkLoaded();var ge=this.getLayer(F);ge?e.deepEqual(ge.getPaintProperty(q),ie)||(ge.setPaintProperty(q,ie,ue)&&this._updateLayer(ge),this._changed=!0,this._updatedPaintProps[F]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},z.prototype.getPaintProperty=function(F,q){return this.getLayer(F).getPaintProperty(q)},z.prototype.setFeatureState=function(F,q){this._checkLoaded();var ie=F.source,ue=F.sourceLayer,ge=this.sourceCaches[ie];if(ge!==void 0){var we=ge.getSource().type;we==="geojson"&&ue?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):we!=="vector"||ue?(F.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),ge.setFeatureState(ue,F.id,q)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ie+"' does not exist in the map's style.")))},z.prototype.removeFeatureState=function(F,q){this._checkLoaded();var ie=F.source,ue=this.sourceCaches[ie];if(ue!==void 0){var ge=ue.getSource().type,we=ge==="vector"?F.sourceLayer:void 0;ge!=="vector"||we?q&&typeof F.id!="string"&&typeof F.id!="number"?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):ue.removeFeatureState(we,F.id,q):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ie+"' does not exist in the map's style.")))},z.prototype.getFeatureState=function(F){this._checkLoaded();var q=F.source,ie=F.sourceLayer,ue=this.sourceCaches[q];if(ue!==void 0){if(ue.getSource().type!=="vector"||ie)return F.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),ue.getFeatureState(ie,F.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+q+"' does not exist in the map's style.")))},z.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},z.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(F){return F.serialize()}),layers:this._serializeLayers(this._order)},function(F){return F!==void 0})},z.prototype._updateLayer=function(F){this._updatedLayers[F.id]=!0,F.source&&!this._updatedSources[F.source]&&this.sourceCaches[F.source].getSource().type!=="raster"&&(this._updatedSources[F.source]="reload",this.sourceCaches[F.source].pause()),this._changed=!0},z.prototype._flattenAndSortRenderedFeatures=function(F){for(var q=this,ie=function(fn){return q._layers[fn].type==="fill-extrusion"},ue={},ge=[],we=this._order.length-1;we>=0;we--){var Se=this._order[we];if(ie(Se)){ue[Se]=we;for(var Ve=0,Je=F;Ve<Je.length;Ve+=1){var at=Je[Ve][Se];if(at)for(var bt=0,Et=at;bt<Et.length;bt+=1){var kt=Et[bt];ge.push(kt)}}}}ge.sort(function(fn,sn){return sn.intersectionZ-fn.intersectionZ});for(var At=[],xt=this._order.length-1;xt>=0;xt--){var zt=this._order[xt];if(ie(zt))for(var It=ge.length-1;It>=0;It--){var Bt=ge[It].feature;if(ue[Bt.layer.id]<xt)break;At.push(Bt),ge.pop()}else for(var nr=0,gr=F;nr<gr.length;nr+=1){var Lr=gr[nr][zt];if(Lr)for(var Sr=0,$r=Lr;Sr<$r.length;Sr+=1){var Qr=$r[Sr];At.push(Qr.feature)}}}return At},z.prototype.queryRenderedFeatures=function(F,q,ie){q&&q.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",q.filter,null,q);var ue={};if(q&&q.layers){if(!Array.isArray(q.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var ge=0,we=q.layers;ge<we.length;ge+=1){var Se=we[ge],Ve=this._layers[Se];if(!Ve)return this.fire(new e.ErrorEvent(new Error("The layer '"+Se+"' does not exist in the map's style and cannot be queried for features."))),[];ue[Ve.source]=!0}}var Je=[];for(var at in q.availableImages=this._availableImages,this.sourceCaches)q.layers&&!ue[at]||Je.push(U(this.sourceCaches[at],this._layers,this._serializedLayers,F,q,ie));return this.placement&&Je.push(function(bt,Et,kt,At,xt,zt,It){for(var Bt={},nr=zt.queryRenderedSymbols(At),gr=[],Lr=0,Sr=Object.keys(nr).map(Number);Lr<Sr.length;Lr+=1){var $r=Sr[Lr];gr.push(It[$r])}gr.sort(ee);for(var Qr=function(){var ha=sn[fn],Wr=ha.featureIndex.lookupSymbolFeatures(nr[ha.bucketInstanceId],Et,ha.bucketIndex,ha.sourceLayerIndex,xt.filter,xt.layers,xt.availableImages,bt);for(var Mn in Wr){var Kn=Bt[Mn]=Bt[Mn]||[],Yn=Wr[Mn];Yn.sort(function(ta,_a){var ya=ha.featureSortOrder;if(ya){var Ia=ya.indexOf(ta.featureIndex);return ya.indexOf(_a.featureIndex)-Ia}return _a.featureIndex-ta.featureIndex});for(var ia=0,da=Yn;ia<da.length;ia+=1){var La=da[ia];Kn.push(La)}}},fn=0,sn=gr;fn<sn.length;fn+=1)Qr();var Vn=function(ha){Bt[ha].forEach(function(Wr){var Mn=Wr.feature,Kn=bt[ha],Yn=kt[Kn.source].getFeatureState(Mn.layer["source-layer"],Mn.id);Mn.source=Mn.layer.source,Mn.layer["source-layer"]&&(Mn.sourceLayer=Mn.layer["source-layer"]),Mn.state=Yn})};for(var Jn in Bt)Vn(Jn);return Bt}(this._layers,this._serializedLayers,this.sourceCaches,F,q,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Je)},z.prototype.querySourceFeatures=function(F,q){q&&q.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",q.filter,null,q);var ie=this.sourceCaches[F];return ie?function(ue,ge){for(var we=ue.getRenderableIds().map(function(Et){return ue.getTileByID(Et)}),Se=[],Ve={},Je=0;Je<we.length;Je++){var at=we[Je],bt=at.tileID.canonical.key;Ve[bt]||(Ve[bt]=!0,at.querySourceFeatures(Se,ge))}return Se}(ie,q):[]},z.prototype.addSourceType=function(F,q,ie){return z.getSourceType(F)?ie(new Error('A source type called "'+F+'" already exists.')):(z.setSourceType(F,q),q.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:F,url:q.workerSourceURL},ie):ie(null,null))},z.prototype.getLight=function(){return this.light.getLight()},z.prototype.setLight=function(F,q){q===void 0&&(q={}),this._checkLoaded();var ie=this.light.getLight(),ue=!1;for(var ge in F)if(!e.deepEqual(F[ge],ie[ge])){ue=!0;break}if(ue){var we={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(F,q),this.light.updateTransitions(we)}},z.prototype._validate=function(F,q,ie,ue,ge){return ge===void 0&&(ge={}),(!ge||ge.validate!==!1)&&tn(this,F.call(e.validateStyle,e.extend({key:q,style:this.serialize(),value:ie,styleSpec:e.styleSpec},ue)))},z.prototype._remove=function(){for(var F in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[F].setEventedParent(null);for(var q in this.sourceCaches)this.sourceCaches[q].clearTiles(),this.sourceCaches[q].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},z.prototype._clearSource=function(F){this.sourceCaches[F].clearTiles()},z.prototype._reloadSource=function(F){this.sourceCaches[F].resume(),this.sourceCaches[F].reload()},z.prototype._updateSources=function(F){for(var q in this.sourceCaches)this.sourceCaches[q].update(F)},z.prototype._generateCollisionBoxes=function(){for(var F in this.sourceCaches)this._reloadSource(F)},z.prototype._updatePlacement=function(F,q,ie,ue,ge){ge===void 0&&(ge=!1);for(var we=!1,Se=!1,Ve={},Je=0,at=this._order;Je<at.length;Je+=1){var bt=at[Je],Et=this._layers[bt];if(Et.type==="symbol"){if(!Ve[Et.source]){var kt=this.sourceCaches[Et.source];Ve[Et.source]=kt.getRenderableIds(!0).map(function(nr){return kt.getTileByID(nr)}).sort(function(nr,gr){return gr.tileID.overscaledZ-nr.tileID.overscaledZ||(nr.tileID.isLessThan(gr.tileID)?-1:1)})}var At=this.crossTileSymbolIndex.addLayer(Et,Ve[Et.source],F.center.lng);we=we||At}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((ge=ge||this._layerOrderChanged||ie===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),F.zoom))&&(this.pauseablePlacement=new xr(F,this._order,ge,q,ie,ue,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ve),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Se=!0),we&&this.pauseablePlacement.placement.setStale()),Se||we)for(var xt=0,zt=this._order;xt<zt.length;xt+=1){var It=zt[xt],Bt=this._layers[It];Bt.type==="symbol"&&this.placement.updateLayerOpacities(Bt,Ve[Bt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},z.prototype._releaseSymbolFadeTiles=function(){for(var F in this.sourceCaches)this.sourceCaches[F].releaseSymbolFadeTiles()},z.prototype.getImages=function(F,q,ie){this.imageManager.getImages(q.icons,ie),this._updateTilesForChangedImages();var ue=this.sourceCaches[q.source];ue&&ue.setDependencies(q.tileID.key,q.type,q.icons)},z.prototype.getGlyphs=function(F,q,ie){this.glyphManager.getGlyphs(q.stacks,ie)},z.prototype.getResource=function(F,q,ie){return e.makeRequest(q,ie)},z}(e.Evented);wn.getSourceType=function(C){return N[C]},wn.setSourceType=function(C,z){N[C]=z},wn.registerForPluginStateChange=e.registerForPluginStateChange;var Ln=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),zn=Ja(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Zn=Ja(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Aa=Ja(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ma=Ja(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),An=Ja("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ea=Ja(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Qn=Ja(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),za=Ja("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),vi=Ja("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Fi=Ja("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),po=Ja(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Xa=Ja(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Za=Ja(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),eo=Ja(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Na=Ja(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),mo=Ja(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),bo=Ja(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Mi=Ja(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),to=Ja(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),_o=Ja(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Co=Ja(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Ui=Ja(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),yi=Ja(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ki=Ja(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Ts=Ja(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Es=Ja(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Ja(C,z){var F=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,q={};return{fragmentSource:C=C.replace(F,function(ie,ue,ge,we,Se){return q[Se]=!0,ue==="define"?`
#ifndef HAS_UNIFORM_u_`+Se+`
varying `+ge+" "+we+" "+Se+`;
#else
uniform `+ge+" "+we+" u_"+Se+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Se+`
    `+ge+" "+we+" "+Se+" = u_"+Se+`;
#endif
`}),vertexSource:z=z.replace(F,function(ie,ue,ge,we,Se){var Ve=we==="float"?"vec2":"vec4",Je=Se.match(/color/)?"color":Ve;return q[Se]?ue==="define"?`
#ifndef HAS_UNIFORM_u_`+Se+`
uniform lowp float u_`+Se+`_t;
attribute `+ge+" "+Ve+" a_"+Se+`;
varying `+ge+" "+we+" "+Se+`;
#else
uniform `+ge+" "+we+" u_"+Se+`;
#endif
`:Je==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Se+`
    `+Se+" = a_"+Se+`;
#else
    `+ge+" "+we+" "+Se+" = u_"+Se+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Se+`
    `+Se+" = unpack_mix_"+Je+"(a_"+Se+", u_"+Se+`_t);
#else
    `+ge+" "+we+" "+Se+" = u_"+Se+`;
#endif
`:ue==="define"?`
#ifndef HAS_UNIFORM_u_`+Se+`
uniform lowp float u_`+Se+`_t;
attribute `+ge+" "+Ve+" a_"+Se+`;
#else
uniform `+ge+" "+we+" u_"+Se+`;
#endif
`:Je==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Se+`
    `+ge+" "+we+" "+Se+" = a_"+Se+`;
#else
    `+ge+" "+we+" "+Se+" = u_"+Se+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Se+`
    `+ge+" "+we+" "+Se+" = unpack_mix_"+Je+"(a_"+Se+", u_"+Se+`_t);
#else
    `+ge+" "+we+" "+Se+" = u_"+Se+`;
#endif
`})}}var vs=Object.freeze({__proto__:null,prelude:zn,background:Zn,backgroundPattern:Aa,circle:Ma,clippingMask:An,heatmap:ea,heatmapTexture:Qn,collisionBox:za,collisionCircle:vi,debug:Fi,fill:po,fillOutline:Xa,fillOutlinePattern:Za,fillPattern:eo,fillExtrusion:Na,fillExtrusionPattern:mo,hillshadePrepare:bo,hillshade:Mi,line:to,lineGradient:_o,linePattern:Co,lineSDF:Ui,raster:yi,symbolIcon:Ki,symbolSDF:Ts,symbolTextAndIcon:Es}),rs=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};rs.prototype.bind=function(C,z,F,q,ie,ue,ge,we){this.context=C;for(var Se=this.boundPaintVertexBuffers.length!==q.length,Ve=0;!Se&&Ve<q.length;Ve++)this.boundPaintVertexBuffers[Ve]!==q[Ve]&&(Se=!0);var Je=!this.vao||this.boundProgram!==z||this.boundLayoutVertexBuffer!==F||Se||this.boundIndexBuffer!==ie||this.boundVertexOffset!==ue||this.boundDynamicVertexBuffer!==ge||this.boundDynamicVertexBuffer2!==we;!C.extVertexArrayObject||Je?this.freshBind(z,F,q,ie,ue,ge,we):(C.bindVertexArrayOES.set(this.vao),ge&&ge.bind(),ie&&ie.dynamicDraw&&ie.bind(),we&&we.bind())},rs.prototype.freshBind=function(C,z,F,q,ie,ue,ge){var we,Se=C.numAttributes,Ve=this.context,Je=Ve.gl;if(Ve.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ve.extVertexArrayObject.createVertexArrayOES(),Ve.bindVertexArrayOES.set(this.vao),we=0,this.boundProgram=C,this.boundLayoutVertexBuffer=z,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=q,this.boundVertexOffset=ie,this.boundDynamicVertexBuffer=ue,this.boundDynamicVertexBuffer2=ge;else{we=Ve.currentNumAttributes||0;for(var at=Se;at<we;at++)Je.disableVertexAttribArray(at)}z.enableAttributes(Je,C);for(var bt=0,Et=F;bt<Et.length;bt+=1)Et[bt].enableAttributes(Je,C);ue&&ue.enableAttributes(Je,C),ge&&ge.enableAttributes(Je,C),z.bind(),z.setVertexAttribPointers(Je,C,ie);for(var kt=0,At=F;kt<At.length;kt+=1){var xt=At[kt];xt.bind(),xt.setVertexAttribPointers(Je,C,ie)}ue&&(ue.bind(),ue.setVertexAttribPointers(Je,C,ie)),q&&q.bind(),ge&&(ge.bind(),ge.setVertexAttribPointers(Je,C,ie)),Ve.currentNumAttributes=Se},rs.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Ls=function(C,z,F,q,ie){var ue=C.gl;this.program=ue.createProgram();var ge=F?F.defines():[];ie&&ge.push("#define OVERDRAW_INSPECTOR;");var we=ge.concat(zn.fragmentSource,z.fragmentSource).join(`
`),Se=ge.concat(zn.vertexSource,z.vertexSource).join(`
`),Ve=ue.createShader(ue.FRAGMENT_SHADER);if(ue.isContextLost())this.failedToCreate=!0;else{ue.shaderSource(Ve,we),ue.compileShader(Ve),ue.attachShader(this.program,Ve);var Je=ue.createShader(ue.VERTEX_SHADER);if(ue.isContextLost())this.failedToCreate=!0;else{ue.shaderSource(Je,Se),ue.compileShader(Je),ue.attachShader(this.program,Je);for(var at=F?F.layoutAttributes:[],bt=0;bt<at.length;bt++)ue.bindAttribLocation(this.program,bt,at[bt].name);ue.linkProgram(this.program),ue.deleteShader(Je),ue.deleteShader(Ve),this.numAttributes=ue.getProgramParameter(this.program,ue.ACTIVE_ATTRIBUTES),this.attributes={};for(var Et={},kt=0;kt<this.numAttributes;kt++){var At=ue.getActiveAttrib(this.program,kt);At&&(this.attributes[At.name]=ue.getAttribLocation(this.program,At.name))}for(var xt=ue.getProgramParameter(this.program,ue.ACTIVE_UNIFORMS),zt=0;zt<xt;zt++){var It=ue.getActiveUniform(this.program,zt);It&&(Et[It.name]=ue.getUniformLocation(this.program,It.name))}this.fixedUniforms=q(C,Et),this.binderUniforms=F?F.getUniforms(C,Et):[]}}};function Cs(C,z,F){var q=1/gn(F,1,z.transform.tileZoom),ie=Math.pow(2,F.tileID.overscaledZ),ue=F.tileSize*Math.pow(2,z.transform.tileZoom)/ie,ge=ue*(F.tileID.canonical.x+F.tileID.wrap*ie),we=ue*F.tileID.canonical.y;return{u_image:0,u_texsize:F.imageAtlasTexture.size,u_scale:[q,C.fromScale,C.toScale],u_fade:C.t,u_pixel_coord_upper:[ge>>16,we>>16],u_pixel_coord_lower:[65535&ge,65535&we]}}Ls.prototype.draw=function(C,z,F,q,ie,ue,ge,we,Se,Ve,Je,at,bt,Et,kt,At){var xt,zt=C.gl;if(!this.failedToCreate){for(var It in C.program.set(this.program),C.setDepthMode(F),C.setStencilMode(q),C.setColorMode(ie),C.setCullFace(ue),this.fixedUniforms)this.fixedUniforms[It].set(ge[It]);Et&&Et.setUniforms(C,this.binderUniforms,at,{zoom:bt});for(var Bt=(xt={},xt[zt.LINES]=2,xt[zt.TRIANGLES]=3,xt[zt.LINE_STRIP]=1,xt)[z],nr=0,gr=Je.get();nr<gr.length;nr+=1){var Lr=gr[nr],Sr=Lr.vaos||(Lr.vaos={});(Sr[we]||(Sr[we]=new rs)).bind(C,this,Se,Et?Et.getPaintVertexBuffers():[],Ve,Lr.vertexOffset,kt,At),zt.drawElements(z,Lr.primitiveLength*Bt,zt.UNSIGNED_SHORT,Lr.primitiveOffset*Bt*2)}}};var ks=function(C,z,F,q){var ie=z.style.light,ue=ie.properties.get("position"),ge=[ue.x,ue.y,ue.z],we=e.create$1();ie.properties.get("anchor")==="viewport"&&e.fromRotation(we,-z.transform.angle),e.transformMat3(ge,ge,we);var Se=ie.properties.get("color");return{u_matrix:C,u_lightpos:ge,u_lightintensity:ie.properties.get("intensity"),u_lightcolor:[Se.r,Se.g,Se.b],u_vertical_gradient:+F,u_opacity:q}},Ps=function(C,z,F,q,ie,ue,ge){return e.extend(ks(C,z,F,q),Cs(ue,z,ge),{u_height_factor:-Math.pow(2,ie.overscaledZ)/ge.tileSize/8})},Oo=function(C){return{u_matrix:C}},zo=function(C,z,F,q){return e.extend(Oo(C),Cs(F,z,q))},Go=function(C,z){return{u_matrix:C,u_world:z}},Yo=function(C,z,F,q,ie){return e.extend(zo(C,z,F,q),{u_world:ie})},Wo=function(C,z,F,q){var ie,ue,ge=C.transform;if(q.paint.get("circle-pitch-alignment")==="map"){var we=gn(F,1,ge.zoom);ie=!0,ue=[we,we]}else ie=!1,ue=ge.pixelsToGLUnits;return{u_camera_to_center_distance:ge.cameraToCenterDistance,u_scale_with_map:+(q.paint.get("circle-pitch-scale")==="map"),u_matrix:C.translatePosMatrix(z.posMatrix,F,q.paint.get("circle-translate"),q.paint.get("circle-translate-anchor")),u_pitch_with_map:+ie,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:ue}},ns=function(C,z,F){var q=gn(F,1,z.zoom),ie=Math.pow(2,z.zoom-F.tileID.overscaledZ),ue=F.tileID.overscaleFactor();return{u_matrix:C,u_camera_to_center_distance:z.cameraToCenterDistance,u_pixels_to_tile_units:q,u_extrude_scale:[z.pixelsToGLUnits[0]/(q*ie),z.pixelsToGLUnits[1]/(q*ie)],u_overscale_factor:ue}},wo=function(C,z,F){return{u_matrix:C,u_inv_matrix:z,u_camera_to_center_distance:F.cameraToCenterDistance,u_viewport_size:[F.width,F.height]}},ys=function(C,z,F){return F===void 0&&(F=1),{u_matrix:C,u_color:z,u_overlay:0,u_overlay_scale:F}},go=function(C){return{u_matrix:C}},Xo=function(C,z,F,q){return{u_matrix:C,u_extrude_scale:gn(z,1,F),u_intensity:q}};function xs(C,z){var F=Math.pow(2,z.canonical.z),q=z.canonical.y;return[new e.MercatorCoordinate(0,q/F).toLngLat().lat,new e.MercatorCoordinate(0,(q+1)/F).toLngLat().lat]}var Do=function(C,z,F){var q=C.transform;return{u_matrix:lt(C,z,F),u_ratio:1/gn(z,1,q.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/q.pixelsToGLUnits[0],1/q.pixelsToGLUnits[1]]}},Ya=function(C,z,F){return e.extend(Do(C,z,F),{u_image:0})},je=function(C,z,F,q){var ie=C.transform,ue=et(z,ie);return{u_matrix:lt(C,z,F),u_texsize:z.imageAtlasTexture.size,u_ratio:1/gn(z,1,ie.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[ue,q.fromScale,q.toScale],u_fade:q.t,u_units_to_pixels:[1/ie.pixelsToGLUnits[0],1/ie.pixelsToGLUnits[1]]}},Ge=function(C,z,F,q,ie){var ue=C.transform,ge=C.lineAtlas,we=et(z,ue),Se=F.layout.get("line-cap")==="round",Ve=ge.getDash(q.from,Se),Je=ge.getDash(q.to,Se),at=Ve.width*ie.fromScale,bt=Je.width*ie.toScale;return e.extend(Do(C,z,F),{u_patternscale_a:[we/at,-Ve.height/2],u_patternscale_b:[we/bt,-Je.height/2],u_sdfgamma:ge.width/(256*Math.min(at,bt)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ve.y,u_tex_y_b:Je.y,u_mix:ie.t})};function et(C,z){return 1/gn(C,1,z.tileZoom)}function lt(C,z,F){return C.translatePosMatrix(z.tileID.posMatrix,z,F.paint.get("line-translate"),F.paint.get("line-translate-anchor"))}var gt=function(C,z,F,q,ie){return{u_matrix:C,u_tl_parent:z,u_scale_parent:F,u_buffer_scale:1,u_fade_t:q.mix,u_opacity:q.opacity*ie.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ie.paint.get("raster-brightness-min"),u_brightness_high:ie.paint.get("raster-brightness-max"),u_saturation_factor:(ge=ie.paint.get("raster-saturation"),ge>0?1-1/(1.001-ge):-ge),u_contrast_factor:(ue=ie.paint.get("raster-contrast"),ue>0?1/(1-ue):1+ue),u_spin_weights:dt(ie.paint.get("raster-hue-rotate"))};var ue,ge};function dt(C){C*=Math.PI/180;var z=Math.sin(C),F=Math.cos(C);return[(2*F+1)/3,(-Math.sqrt(3)*z-F+1)/3,(Math.sqrt(3)*z-F+1)/3]}var St,Xt=function(C,z,F,q,ie,ue,ge,we,Se,Ve){var Je=ie.transform;return{u_is_size_zoom_constant:+(C==="constant"||C==="source"),u_is_size_feature_constant:+(C==="constant"||C==="camera"),u_size_t:z?z.uSizeT:0,u_size:z?z.uSize:0,u_camera_to_center_distance:Je.cameraToCenterDistance,u_pitch:Je.pitch/360*2*Math.PI,u_rotate_symbol:+F,u_aspect_ratio:Je.width/Je.height,u_fade_change:ie.options.fadeDuration?ie.symbolFadeChange:1,u_matrix:ue,u_label_plane_matrix:ge,u_coord_matrix:we,u_is_text:+Se,u_pitch_with_map:+q,u_texsize:Ve,u_texture:0}},Kt=function(C,z,F,q,ie,ue,ge,we,Se,Ve,Je){var at=ie.transform;return e.extend(Xt(C,z,F,q,ie,ue,ge,we,Se,Ve),{u_gamma_scale:q?Math.cos(at._pitch)*at.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+Je})},Yt=function(C,z,F,q,ie,ue,ge,we,Se,Ve){return e.extend(Kt(C,z,F,q,ie,ue,ge,we,!0,Se,!0),{u_texsize_icon:Ve,u_texture_icon:1})},or=function(C,z,F){return{u_matrix:C,u_opacity:z,u_color:F}},mr=function(C,z,F,q,ie,ue){return e.extend(function(ge,we,Se,Ve){var Je=Se.imageManager.getPattern(ge.from.toString()),at=Se.imageManager.getPattern(ge.to.toString()),bt=Se.imageManager.getPixelSize(),Et=bt.width,kt=bt.height,At=Math.pow(2,Ve.tileID.overscaledZ),xt=Ve.tileSize*Math.pow(2,Se.transform.tileZoom)/At,zt=xt*(Ve.tileID.canonical.x+Ve.tileID.wrap*At),It=xt*Ve.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Je.tl,u_pattern_br_a:Je.br,u_pattern_tl_b:at.tl,u_pattern_br_b:at.br,u_texsize:[Et,kt],u_mix:we.t,u_pattern_size_a:Je.displaySize,u_pattern_size_b:at.displaySize,u_scale_a:we.fromScale,u_scale_b:we.toScale,u_tile_units_to_pixels:1/gn(Ve,1,Se.transform.tileZoom),u_pixel_coord_upper:[zt>>16,It>>16],u_pixel_coord_lower:[65535&zt,65535&It]}}(q,ue,F,ie),{u_matrix:C,u_opacity:z})},wr={fillExtrusion:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_lightpos:new e.Uniform3f(C,z.u_lightpos),u_lightintensity:new e.Uniform1f(C,z.u_lightintensity),u_lightcolor:new e.Uniform3f(C,z.u_lightcolor),u_vertical_gradient:new e.Uniform1f(C,z.u_vertical_gradient),u_opacity:new e.Uniform1f(C,z.u_opacity)}},fillExtrusionPattern:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_lightpos:new e.Uniform3f(C,z.u_lightpos),u_lightintensity:new e.Uniform1f(C,z.u_lightintensity),u_lightcolor:new e.Uniform3f(C,z.u_lightcolor),u_vertical_gradient:new e.Uniform1f(C,z.u_vertical_gradient),u_height_factor:new e.Uniform1f(C,z.u_height_factor),u_image:new e.Uniform1i(C,z.u_image),u_texsize:new e.Uniform2f(C,z.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,z.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,z.u_scale),u_fade:new e.Uniform1f(C,z.u_fade),u_opacity:new e.Uniform1f(C,z.u_opacity)}},fill:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix)}},fillPattern:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_image:new e.Uniform1i(C,z.u_image),u_texsize:new e.Uniform2f(C,z.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,z.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,z.u_scale),u_fade:new e.Uniform1f(C,z.u_fade)}},fillOutline:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_world:new e.Uniform2f(C,z.u_world)}},fillOutlinePattern:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_world:new e.Uniform2f(C,z.u_world),u_image:new e.Uniform1i(C,z.u_image),u_texsize:new e.Uniform2f(C,z.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,z.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,z.u_scale),u_fade:new e.Uniform1f(C,z.u_fade)}},circle:function(C,z){return{u_camera_to_center_distance:new e.Uniform1f(C,z.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(C,z.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(C,z.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(C,z.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(C,z.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(C,z.u_matrix)}},collisionBox:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_camera_to_center_distance:new e.Uniform1f(C,z.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(C,z.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(C,z.u_extrude_scale),u_overscale_factor:new e.Uniform1f(C,z.u_overscale_factor)}},collisionCircle:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_inv_matrix:new e.UniformMatrix4f(C,z.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(C,z.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(C,z.u_viewport_size)}},debug:function(C,z){return{u_color:new e.UniformColor(C,z.u_color),u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_overlay:new e.Uniform1i(C,z.u_overlay),u_overlay_scale:new e.Uniform1f(C,z.u_overlay_scale)}},clippingMask:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix)}},heatmap:function(C,z){return{u_extrude_scale:new e.Uniform1f(C,z.u_extrude_scale),u_intensity:new e.Uniform1f(C,z.u_intensity),u_matrix:new e.UniformMatrix4f(C,z.u_matrix)}},heatmapTexture:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_world:new e.Uniform2f(C,z.u_world),u_image:new e.Uniform1i(C,z.u_image),u_color_ramp:new e.Uniform1i(C,z.u_color_ramp),u_opacity:new e.Uniform1f(C,z.u_opacity)}},hillshade:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_image:new e.Uniform1i(C,z.u_image),u_latrange:new e.Uniform2f(C,z.u_latrange),u_light:new e.Uniform2f(C,z.u_light),u_shadow:new e.UniformColor(C,z.u_shadow),u_highlight:new e.UniformColor(C,z.u_highlight),u_accent:new e.UniformColor(C,z.u_accent)}},hillshadePrepare:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_image:new e.Uniform1i(C,z.u_image),u_dimension:new e.Uniform2f(C,z.u_dimension),u_zoom:new e.Uniform1f(C,z.u_zoom),u_maxzoom:new e.Uniform1f(C,z.u_maxzoom),u_unpack:new e.Uniform4f(C,z.u_unpack)}},line:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_ratio:new e.Uniform1f(C,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,z.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,z.u_units_to_pixels)}},lineGradient:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_ratio:new e.Uniform1f(C,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,z.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,z.u_units_to_pixels),u_image:new e.Uniform1i(C,z.u_image)}},linePattern:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_texsize:new e.Uniform2f(C,z.u_texsize),u_ratio:new e.Uniform1f(C,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,z.u_device_pixel_ratio),u_image:new e.Uniform1i(C,z.u_image),u_units_to_pixels:new e.Uniform2f(C,z.u_units_to_pixels),u_scale:new e.Uniform3f(C,z.u_scale),u_fade:new e.Uniform1f(C,z.u_fade)}},lineSDF:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_ratio:new e.Uniform1f(C,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,z.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,z.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(C,z.u_patternscale_a),u_patternscale_b:new e.Uniform2f(C,z.u_patternscale_b),u_sdfgamma:new e.Uniform1f(C,z.u_sdfgamma),u_image:new e.Uniform1i(C,z.u_image),u_tex_y_a:new e.Uniform1f(C,z.u_tex_y_a),u_tex_y_b:new e.Uniform1f(C,z.u_tex_y_b),u_mix:new e.Uniform1f(C,z.u_mix)}},raster:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_tl_parent:new e.Uniform2f(C,z.u_tl_parent),u_scale_parent:new e.Uniform1f(C,z.u_scale_parent),u_buffer_scale:new e.Uniform1f(C,z.u_buffer_scale),u_fade_t:new e.Uniform1f(C,z.u_fade_t),u_opacity:new e.Uniform1f(C,z.u_opacity),u_image0:new e.Uniform1i(C,z.u_image0),u_image1:new e.Uniform1i(C,z.u_image1),u_brightness_low:new e.Uniform1f(C,z.u_brightness_low),u_brightness_high:new e.Uniform1f(C,z.u_brightness_high),u_saturation_factor:new e.Uniform1f(C,z.u_saturation_factor),u_contrast_factor:new e.Uniform1f(C,z.u_contrast_factor),u_spin_weights:new e.Uniform3f(C,z.u_spin_weights)}},symbolIcon:function(C,z){return{u_is_size_zoom_constant:new e.Uniform1i(C,z.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,z.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,z.u_size_t),u_size:new e.Uniform1f(C,z.u_size),u_camera_to_center_distance:new e.Uniform1f(C,z.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,z.u_pitch),u_rotate_symbol:new e.Uniform1i(C,z.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,z.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,z.u_fade_change),u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,z.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,z.u_coord_matrix),u_is_text:new e.Uniform1i(C,z.u_is_text),u_pitch_with_map:new e.Uniform1i(C,z.u_pitch_with_map),u_texsize:new e.Uniform2f(C,z.u_texsize),u_texture:new e.Uniform1i(C,z.u_texture)}},symbolSDF:function(C,z){return{u_is_size_zoom_constant:new e.Uniform1i(C,z.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,z.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,z.u_size_t),u_size:new e.Uniform1f(C,z.u_size),u_camera_to_center_distance:new e.Uniform1f(C,z.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,z.u_pitch),u_rotate_symbol:new e.Uniform1i(C,z.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,z.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,z.u_fade_change),u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,z.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,z.u_coord_matrix),u_is_text:new e.Uniform1i(C,z.u_is_text),u_pitch_with_map:new e.Uniform1i(C,z.u_pitch_with_map),u_texsize:new e.Uniform2f(C,z.u_texsize),u_texture:new e.Uniform1i(C,z.u_texture),u_gamma_scale:new e.Uniform1f(C,z.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(C,z.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(C,z.u_is_halo)}},symbolTextAndIcon:function(C,z){return{u_is_size_zoom_constant:new e.Uniform1i(C,z.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,z.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,z.u_size_t),u_size:new e.Uniform1f(C,z.u_size),u_camera_to_center_distance:new e.Uniform1f(C,z.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,z.u_pitch),u_rotate_symbol:new e.Uniform1i(C,z.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,z.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,z.u_fade_change),u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,z.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,z.u_coord_matrix),u_is_text:new e.Uniform1i(C,z.u_is_text),u_pitch_with_map:new e.Uniform1i(C,z.u_pitch_with_map),u_texsize:new e.Uniform2f(C,z.u_texsize),u_texsize_icon:new e.Uniform2f(C,z.u_texsize_icon),u_texture:new e.Uniform1i(C,z.u_texture),u_texture_icon:new e.Uniform1i(C,z.u_texture_icon),u_gamma_scale:new e.Uniform1f(C,z.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(C,z.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(C,z.u_is_halo)}},background:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_opacity:new e.Uniform1f(C,z.u_opacity),u_color:new e.UniformColor(C,z.u_color)}},backgroundPattern:function(C,z){return{u_matrix:new e.UniformMatrix4f(C,z.u_matrix),u_opacity:new e.Uniform1f(C,z.u_opacity),u_image:new e.Uniform1i(C,z.u_image),u_pattern_tl_a:new e.Uniform2f(C,z.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(C,z.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(C,z.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(C,z.u_pattern_br_b),u_texsize:new e.Uniform2f(C,z.u_texsize),u_mix:new e.Uniform1f(C,z.u_mix),u_pattern_size_a:new e.Uniform2f(C,z.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(C,z.u_pattern_size_b),u_scale_a:new e.Uniform1f(C,z.u_scale_a),u_scale_b:new e.Uniform1f(C,z.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(C,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,z.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(C,z.u_tile_units_to_pixels)}}};function Tr(C,z,F,q,ie,ue,ge){for(var we=C.context,Se=we.gl,Ve=C.useProgram("collisionBox"),Je=[],at=0,bt=0,Et=0;Et<q.length;Et++){var kt=q[Et],At=z.getTile(kt),xt=At.getBucket(F);if(xt){var zt=kt.posMatrix;ie[0]===0&&ie[1]===0||(zt=C.translatePosMatrix(kt.posMatrix,At,ie,ue));var It=ge?xt.textCollisionBox:xt.iconCollisionBox,Bt=xt.collisionCircleArray;if(Bt.length>0){var nr=e.create(),gr=zt;e.mul(nr,xt.placementInvProjMatrix,C.transform.glCoordMatrix),e.mul(nr,nr,xt.placementViewportMatrix),Je.push({circleArray:Bt,circleOffset:bt,transform:gr,invTransform:nr}),bt=at+=Bt.length/4}It&&Ve.draw(we,Se.LINES,Ht.disabled,Ue.disabled,C.colorModeForRenderPass(),he.disabled,ns(zt,C.transform,At),F.id,It.layoutVertexBuffer,It.indexBuffer,It.segments,null,C.transform.zoom,null,null,It.collisionVertexBuffer)}}if(ge&&Je.length){var Lr=C.useProgram("collisionCircle"),Sr=new e.StructArrayLayout2f1f2i16;Sr.resize(4*at),Sr._trim();for(var $r=0,Qr=0,fn=Je;Qr<fn.length;Qr+=1)for(var sn=fn[Qr],Vn=0;Vn<sn.circleArray.length/4;Vn++){var Jn=4*Vn,ha=sn.circleArray[Jn+0],Wr=sn.circleArray[Jn+1],Mn=sn.circleArray[Jn+2],Kn=sn.circleArray[Jn+3];Sr.emplace($r++,ha,Wr,Mn,Kn,0),Sr.emplace($r++,ha,Wr,Mn,Kn,1),Sr.emplace($r++,ha,Wr,Mn,Kn,2),Sr.emplace($r++,ha,Wr,Mn,Kn,3)}(!St||St.length<2*at)&&(St=function(ya){var Ia=2*ya,wa=new e.StructArrayLayout3ui6;wa.resize(Ia),wa._trim();for(var Oa=0;Oa<Ia;Oa++){var Ha=6*Oa;wa.uint16[Ha+0]=4*Oa+0,wa.uint16[Ha+1]=4*Oa+1,wa.uint16[Ha+2]=4*Oa+2,wa.uint16[Ha+3]=4*Oa+2,wa.uint16[Ha+4]=4*Oa+3,wa.uint16[Ha+5]=4*Oa+0}return wa}(at));for(var Yn=we.createIndexBuffer(St,!0),ia=we.createVertexBuffer(Sr,e.collisionCircleLayout.members,!0),da=0,La=Je;da<La.length;da+=1){var ta=La[da],_a=wo(ta.transform,ta.invTransform,C.transform);Lr.draw(we,Se.TRIANGLES,Ht.disabled,Ue.disabled,C.colorModeForRenderPass(),he.disabled,_a,F.id,ia,Yn,e.SegmentVector.simpleSegment(0,2*ta.circleOffset,ta.circleArray.length,ta.circleArray.length/2),null,C.transform.zoom,null,null,null)}ia.destroy(),Yn.destroy()}}var Dr=e.identity(new Float32Array(16));function nn(C,z,F,q,ie,ue){var ge=e.getAnchorAlignment(C),we=-(ge.horizontalAlign-.5)*z,Se=-(ge.verticalAlign-.5)*F,Ve=e.evaluateVariableOffset(C,q);return new e.Point((we/ie+Ve[0])*ue,(Se/ie+Ve[1])*ue)}function hn(C,z,F,q,ie,ue,ge,we,Se,Ve,Je){var at=C.text.placedSymbolArray,bt=C.text.dynamicLayoutVertexArray,Et=C.icon.dynamicLayoutVertexArray,kt={};bt.clear();for(var At=0;At<at.length;At++){var xt=at.get(At),zt=C.allowVerticalPlacement&&!xt.placedOrientation,It=xt.hidden||!xt.crossTileID||zt?null:q[xt.crossTileID];if(It){var Bt=new e.Point(xt.anchorX,xt.anchorY),nr=Zt(Bt,F?we:ge),gr=Qt(ue.cameraToCenterDistance,nr.signedDistanceFromCamera),Lr=ie.evaluateSizeForFeature(C.textSizeData,Ve,xt)*gr/e.ONE_EM;F&&(Lr*=C.tilePixelRatio/Se);for(var Sr=It.width,$r=It.height,Qr=nn(It.anchor,Sr,$r,It.textOffset,It.textBoxScale,Lr),fn=F?Zt(Bt.add(Qr),ge).point:nr.point.add(z?Qr.rotate(-ue.angle):Qr),sn=C.allowVerticalPlacement&&xt.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Vn=0;Vn<xt.numGlyphs;Vn++)e.addDynamicAttributes(bt,fn,sn);Je&&xt.associatedIconIndex>=0&&(kt[xt.associatedIconIndex]={shiftedAnchor:fn,angle:sn})}else en(xt.numGlyphs,bt)}if(Je){Et.clear();for(var Jn=C.icon.placedSymbolArray,ha=0;ha<Jn.length;ha++){var Wr=Jn.get(ha);if(Wr.hidden)en(Wr.numGlyphs,Et);else{var Mn=kt[ha];if(Mn)for(var Kn=0;Kn<Wr.numGlyphs;Kn++)e.addDynamicAttributes(Et,Mn.shiftedAnchor,Mn.angle);else en(Wr.numGlyphs,Et)}}C.icon.dynamicLayoutVertexBuffer.updateData(Et)}C.text.dynamicLayoutVertexBuffer.updateData(bt)}function Cn(C,z,F){return F.iconsInText&&z?"symbolTextAndIcon":C?"symbolSDF":"symbolIcon"}function Dn(C,z,F,q,ie,ue,ge,we,Se,Ve,Je,at){for(var bt=C.context,Et=bt.gl,kt=C.transform,At=we==="map",xt=Se==="map",zt=At&&F.layout.get("symbol-placement")!=="point",It=At&&!xt&&!zt,Bt=F.layout.get("symbol-sort-key").constantOr(1)!==void 0,nr=C.depthModeForSublayer(0,Ht.ReadOnly),gr=F.layout.get("text-variable-anchor"),Lr=[],Sr=0,$r=q;Sr<$r.length;Sr+=1){var Qr=$r[Sr],fn=z.getTile(Qr),sn=fn.getBucket(F);if(sn){var Vn=ie?sn.text:sn.icon;if(Vn&&Vn.segments.get().length){var Jn=Vn.programConfigurations.get(F.id),ha=ie||sn.sdfIcons,Wr=ie?sn.textSizeData:sn.iconSizeData,Mn=xt||kt.pitch!==0,Kn=C.useProgram(Cn(ha,ie,sn),Jn),Yn=e.evaluateSizeForZoom(Wr,kt.zoom),ia=void 0,da=[0,0],La=void 0,ta=void 0,_a=null,ya=void 0;if(ie){if(La=fn.glyphAtlasTexture,ta=Et.LINEAR,ia=fn.glyphAtlasTexture.size,sn.iconsInText){da=fn.imageAtlasTexture.size,_a=fn.imageAtlasTexture;var Ia=Wr.kind==="composite"||Wr.kind==="camera";ya=Mn||C.options.rotating||C.options.zooming||Ia?Et.LINEAR:Et.NEAREST}}else{var wa=F.layout.get("icon-size").constantOr(0)!==1||sn.iconsNeedLinear;La=fn.imageAtlasTexture,ta=ha||C.options.rotating||C.options.zooming||wa||Mn?Et.LINEAR:Et.NEAREST,ia=fn.imageAtlasTexture.size}var Oa=gn(fn,1,C.transform.zoom),Ha=Ar(Qr.posMatrix,xt,At,C.transform,Oa),di=fr(Qr.posMatrix,xt,At,C.transform,Oa),Di=gr&&sn.hasTextData(),Ri=F.layout.get("icon-text-fit")!=="none"&&Di&&sn.hasIconData();zt&&hr(sn,Qr.posMatrix,C,ie,Ha,di,xt,Ve);var pi=C.translatePosMatrix(Qr.posMatrix,fn,ue,ge),Ei=zt||ie&&gr||Ri?Dr:Ha,bi=C.translatePosMatrix(di,fn,ue,ge,!0),Mo=ha&&F.paint.get(ie?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Zi={program:Kn,buffers:Vn,uniformValues:ha?sn.iconsInText?Yt(Wr.kind,Yn,It,xt,C,pi,Ei,bi,ia,da):Kt(Wr.kind,Yn,It,xt,C,pi,Ei,bi,ie,ia,!0):Xt(Wr.kind,Yn,It,xt,C,pi,Ei,bi,ie,ia),atlasTexture:La,atlasTextureIcon:_a,atlasInterpolation:ta,atlasInterpolationIcon:ya,isSDF:ha,hasHalo:Mo};if(Bt)for(var Uo=0,As=Vn.segments.get();Uo<As.length;Uo+=1){var Xs=As[Uo];Lr.push({segments:new e.SegmentVector([Xs]),sortKey:Xs.sortKey,state:Zi})}else Lr.push({segments:Vn.segments,sortKey:0,state:Zi})}}}Bt&&Lr.sort(function(Sl,ss){return Sl.sortKey-ss.sortKey});for(var Al=0,fl=Lr;Al<fl.length;Al+=1){var hl=fl[Al],Ao=hl.state;if(bt.activeTexture.set(Et.TEXTURE0),Ao.atlasTexture.bind(Ao.atlasInterpolation,Et.CLAMP_TO_EDGE),Ao.atlasTextureIcon&&(bt.activeTexture.set(Et.TEXTURE1),Ao.atlasTextureIcon&&Ao.atlasTextureIcon.bind(Ao.atlasInterpolationIcon,Et.CLAMP_TO_EDGE)),Ao.isSDF){var Qs=Ao.uniformValues;Ao.hasHalo&&(Qs.u_is_halo=1,Gn(Ao.buffers,hl.segments,F,C,Ao.program,nr,Je,at,Qs)),Qs.u_is_halo=0}Gn(Ao.buffers,hl.segments,F,C,Ao.program,nr,Je,at,Ao.uniformValues)}}function Gn(C,z,F,q,ie,ue,ge,we,Se){var Ve=q.context,Je=Ve.gl;ie.draw(Ve,Je.TRIANGLES,ue,ge,we,he.disabled,Se,F.id,C.layoutVertexBuffer,C.indexBuffer,z,F.paint,q.transform.zoom,C.programConfigurations.get(F.id),C.dynamicLayoutVertexBuffer,C.opacityVertexBuffer)}function Rn(C,z,F,q,ie,ue,ge){var we,Se,Ve,Je,at,bt=C.context.gl,Et=F.paint.get("fill-pattern"),kt=Et&&Et.constantOr(1),At=F.getCrossfadeParameters();ge?(Se=kt&&!F.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",we=bt.LINES):(Se=kt?"fillPattern":"fill",we=bt.TRIANGLES);for(var xt=0,zt=q;xt<zt.length;xt+=1){var It=zt[xt],Bt=z.getTile(It);if(!kt||Bt.patternsLoaded()){var nr=Bt.getBucket(F);if(nr){var gr=nr.programConfigurations.get(F.id),Lr=C.useProgram(Se,gr);kt&&(C.context.activeTexture.set(bt.TEXTURE0),Bt.imageAtlasTexture.bind(bt.LINEAR,bt.CLAMP_TO_EDGE),gr.updatePaintBuffers(At));var Sr=Et.constantOr(null);if(Sr&&Bt.imageAtlas){var $r=Bt.imageAtlas,Qr=$r.patternPositions[Sr.to.toString()],fn=$r.patternPositions[Sr.from.toString()];Qr&&fn&&gr.setConstantPatternPositions(Qr,fn)}var sn=C.translatePosMatrix(It.posMatrix,Bt,F.paint.get("fill-translate"),F.paint.get("fill-translate-anchor"));if(ge){Je=nr.indexBuffer2,at=nr.segments2;var Vn=[bt.drawingBufferWidth,bt.drawingBufferHeight];Ve=Se==="fillOutlinePattern"&&kt?Yo(sn,C,At,Bt,Vn):Go(sn,Vn)}else Je=nr.indexBuffer,at=nr.segments,Ve=kt?zo(sn,C,At,Bt):Oo(sn);Lr.draw(C.context,we,ie,C.stencilModeForClipping(It),ue,he.disabled,Ve,F.id,nr.layoutVertexBuffer,Je,at,F.paint,C.transform.zoom,gr)}}}}function va(C,z,F,q,ie,ue,ge){for(var we=C.context,Se=we.gl,Ve=F.paint.get("fill-extrusion-pattern"),Je=Ve.constantOr(1),at=F.getCrossfadeParameters(),bt=F.paint.get("fill-extrusion-opacity"),Et=0,kt=q;Et<kt.length;Et+=1){var At=kt[Et],xt=z.getTile(At),zt=xt.getBucket(F);if(zt){var It=zt.programConfigurations.get(F.id),Bt=C.useProgram(Je?"fillExtrusionPattern":"fillExtrusion",It);Je&&(C.context.activeTexture.set(Se.TEXTURE0),xt.imageAtlasTexture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE),It.updatePaintBuffers(at));var nr=Ve.constantOr(null);if(nr&&xt.imageAtlas){var gr=xt.imageAtlas,Lr=gr.patternPositions[nr.to.toString()],Sr=gr.patternPositions[nr.from.toString()];Lr&&Sr&&It.setConstantPatternPositions(Lr,Sr)}var $r=C.translatePosMatrix(At.posMatrix,xt,F.paint.get("fill-extrusion-translate"),F.paint.get("fill-extrusion-translate-anchor")),Qr=F.paint.get("fill-extrusion-vertical-gradient"),fn=Je?Ps($r,C,Qr,bt,At,at,xt):ks($r,C,Qr,bt);Bt.draw(we,we.gl.TRIANGLES,ie,ue,ge,he.backCCW,fn,F.id,zt.layoutVertexBuffer,zt.indexBuffer,zt.segments,F.paint,C.transform.zoom,It)}}}function Sa(C,z,F,q,ie,ue){var ge=C.context,we=ge.gl,Se=z.fbo;if(Se){var Ve=C.useProgram("hillshade");ge.activeTexture.set(we.TEXTURE0),we.bindTexture(we.TEXTURE_2D,Se.colorAttachment.get());var Je=function(at,bt,Et){var kt=Et.paint.get("hillshade-shadow-color"),At=Et.paint.get("hillshade-highlight-color"),xt=Et.paint.get("hillshade-accent-color"),zt=Et.paint.get("hillshade-illumination-direction")*(Math.PI/180);Et.paint.get("hillshade-illumination-anchor")==="viewport"&&(zt-=at.transform.angle);var It=!at.options.moving;return{u_matrix:at.transform.calculatePosMatrix(bt.tileID.toUnwrapped(),It),u_image:0,u_latrange:xs(at,bt.tileID),u_light:[Et.paint.get("hillshade-exaggeration"),zt],u_shadow:kt,u_highlight:At,u_accent:xt}}(C,z,F);Ve.draw(ge,we.TRIANGLES,q,ie,ue,he.disabled,Je,F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}}function Ua(C,z,F,q,ie,ue,ge){var we=C.context,Se=we.gl,Ve=z.dem;if(Ve&&Ve.data){var Je=Ve.dim,at=Ve.stride,bt=Ve.getPixels();if(we.activeTexture.set(Se.TEXTURE1),we.pixelStoreUnpackPremultiplyAlpha.set(!1),z.demTexture=z.demTexture||C.getTileTexture(at),z.demTexture){var Et=z.demTexture;Et.update(bt,{premultiply:!1}),Et.bind(Se.NEAREST,Se.CLAMP_TO_EDGE)}else z.demTexture=new e.Texture(we,bt,Se.RGBA,{premultiply:!1}),z.demTexture.bind(Se.NEAREST,Se.CLAMP_TO_EDGE);we.activeTexture.set(Se.TEXTURE0);var kt=z.fbo;if(!kt){var At=new e.Texture(we,{width:Je,height:Je,data:null},Se.RGBA);At.bind(Se.LINEAR,Se.CLAMP_TO_EDGE),(kt=z.fbo=we.createFramebuffer(Je,Je,!0)).colorAttachment.set(At.texture)}we.bindFramebuffer.set(kt.framebuffer),we.viewport.set([0,0,Je,Je]),C.useProgram("hillshadePrepare").draw(we,Se.TRIANGLES,ie,ue,ge,he.disabled,function(xt,zt,It){var Bt=zt.stride,nr=e.create();return e.ortho(nr,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(nr,nr,[0,-e.EXTENT,0]),{u_matrix:nr,u_image:1,u_dimension:[Bt,Bt],u_zoom:xt.overscaledZ,u_maxzoom:It,u_unpack:zt.getUnpackVector()}}(z.tileID,Ve,q),F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments),z.needsHillshadePrepare=!1}}function ja(C,z,F,q,ie){var ue=q.paint.get("raster-fade-duration");if(ue>0){var ge=e.browser.now(),we=(ge-C.timeAdded)/ue,Se=z?(ge-z.timeAdded)/ue:-1,Ve=F.getSource(),Je=ie.coveringZoomLevel({tileSize:Ve.tileSize,roundZoom:Ve.roundZoom}),at=!z||Math.abs(z.tileID.overscaledZ-Je)>Math.abs(C.tileID.overscaledZ-Je),bt=at&&C.refreshedUponExpiration?1:e.clamp(at?we:1-Se,0,1);return C.refreshedUponExpiration&&we>=1&&(C.refreshedUponExpiration=!1),z?{opacity:1,mix:1-bt}:{opacity:bt,mix:0}}return{opacity:1,mix:0}}var Va=new e.Color(1,0,0,1),Ai=new e.Color(0,1,0,1),Ti=new e.Color(0,0,1,1),ci=new e.Color(1,0,1,1),ui=new e.Color(0,1,1,1);function ki(C){var z=C.transform.padding;Vi(C,C.transform.height-(z.top||0),3,Va),Vi(C,z.bottom||0,3,Ai),ro(C,z.left||0,3,Ti),ro(C,C.transform.width-(z.right||0),3,ci);var F=C.transform.centerPoint;(function(q,ie,ue,ge){no(q,ie-1,ue-10,2,20,ge),no(q,ie-10,ue-1,20,2,ge)})(C,F.x,C.transform.height-F.y,ui)}function Vi(C,z,F,q){no(C,0,z+F/2,C.transform.width,F,q)}function ro(C,z,F,q){no(C,z-F/2,0,F,C.transform.height,q)}function no(C,z,F,q,ie,ue){var ge=C.context,we=ge.gl;we.enable(we.SCISSOR_TEST),we.scissor(z*e.browser.devicePixelRatio,F*e.browser.devicePixelRatio,q*e.browser.devicePixelRatio,ie*e.browser.devicePixelRatio),ge.clear({color:ue}),we.disable(we.SCISSOR_TEST)}function ao(C,z,F){var q=C.context,ie=q.gl,ue=F.posMatrix,ge=C.useProgram("debug"),we=Ht.disabled,Se=Ue.disabled,Ve=C.colorModeForRenderPass();q.activeTexture.set(ie.TEXTURE0),C.emptyTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),ge.draw(q,ie.LINE_STRIP,we,Se,Ve,he.disabled,ys(ue,e.Color.red),"$debug",C.debugBuffer,C.tileBorderIndexBuffer,C.debugSegments);var Je=z.getTileByID(F.key).latestRawTileData,at=Je&&Je.byteLength||0,bt=Math.floor(at/1024),Et=z.getTile(F).tileSize,kt=512/Math.min(Et,512)*(F.overscaledZ/C.transform.zoom)*.5,At=F.canonical.toString();F.overscaledZ!==F.canonical.z&&(At+=" => "+F.overscaledZ),function(xt,zt){xt.initDebugOverlayCanvas();var It=xt.debugOverlayCanvas,Bt=xt.context.gl,nr=xt.debugOverlayCanvas.getContext("2d");nr.clearRect(0,0,It.width,It.height),nr.shadowColor="white",nr.shadowBlur=2,nr.lineWidth=1.5,nr.strokeStyle="white",nr.textBaseline="top",nr.font="bold 36px Open Sans, sans-serif",nr.fillText(zt,5,5),nr.strokeText(zt,5,5),xt.debugOverlayTexture.update(It),xt.debugOverlayTexture.bind(Bt.LINEAR,Bt.CLAMP_TO_EDGE)}(C,At+" "+bt+"kb"),ge.draw(q,ie.TRIANGLES,we,Se,We.alphaBlended,he.disabled,ys(ue,e.Color.transparent,kt),"$debug",C.debugBuffer,C.quadTriangleIndexBuffer,C.debugSegments)}var io={symbol:function(C,z,F,q,ie){if(C.renderPass==="translucent"){var ue=Ue.disabled,ge=C.colorModeForRenderPass();F.layout.get("text-variable-anchor")&&function(we,Se,Ve,Je,at,bt,Et){for(var kt=Se.transform,At=at==="map",xt=bt==="map",zt=0,It=we;zt<It.length;zt+=1){var Bt=It[zt],nr=Je.getTile(Bt),gr=nr.getBucket(Ve);if(gr&&gr.text&&gr.text.segments.get().length){var Lr=gr.textSizeData,Sr=e.evaluateSizeForZoom(Lr,kt.zoom),$r=gn(nr,1,Se.transform.zoom),Qr=Ar(Bt.posMatrix,xt,At,Se.transform,$r),fn=Ve.layout.get("icon-text-fit")!=="none"&&gr.hasIconData();if(Sr){var sn=Math.pow(2,kt.zoom-nr.tileID.overscaledZ);hn(gr,At,xt,Et,e.symbolSize,kt,Qr,Bt.posMatrix,sn,Sr,fn)}}}}(q,C,F,z,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),ie),F.paint.get("icon-opacity").constantOr(1)!==0&&Dn(C,z,F,q,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),ue,ge),F.paint.get("text-opacity").constantOr(1)!==0&&Dn(C,z,F,q,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),ue,ge),z.map.showCollisionBoxes&&(Tr(C,z,F,q,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),!0),Tr(C,z,F,q,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),!1))}},circle:function(C,z,F,q){if(C.renderPass==="translucent"){var ie=F.paint.get("circle-opacity"),ue=F.paint.get("circle-stroke-width"),ge=F.paint.get("circle-stroke-opacity"),we=F.layout.get("circle-sort-key").constantOr(1)!==void 0;if(ie.constantOr(1)!==0||ue.constantOr(1)!==0&&ge.constantOr(1)!==0){for(var Se=C.context,Ve=Se.gl,Je=C.depthModeForSublayer(0,Ht.ReadOnly),at=Ue.disabled,bt=C.colorModeForRenderPass(),Et=[],kt=0;kt<q.length;kt++){var At=q[kt],xt=z.getTile(At),zt=xt.getBucket(F);if(zt){var It=zt.programConfigurations.get(F.id),Bt={programConfiguration:It,program:C.useProgram("circle",It),layoutVertexBuffer:zt.layoutVertexBuffer,indexBuffer:zt.indexBuffer,uniformValues:Wo(C,At,xt,F)};if(we)for(var nr=0,gr=zt.segments.get();nr<gr.length;nr+=1){var Lr=gr[nr];Et.push({segments:new e.SegmentVector([Lr]),sortKey:Lr.sortKey,state:Bt})}else Et.push({segments:zt.segments,sortKey:0,state:Bt})}}we&&Et.sort(function(Kn,Yn){return Kn.sortKey-Yn.sortKey});for(var Sr=0,$r=Et;Sr<$r.length;Sr+=1){var Qr=$r[Sr],fn=Qr.state,sn=fn.programConfiguration,Vn=fn.program,Jn=fn.layoutVertexBuffer,ha=fn.indexBuffer,Wr=fn.uniformValues,Mn=Qr.segments;Vn.draw(Se,Ve.TRIANGLES,Je,at,bt,he.disabled,Wr,F.id,Jn,ha,Mn,F.paint,C.transform.zoom,sn)}}}},heatmap:function(C,z,F,q){if(F.paint.get("heatmap-opacity")!==0)if(C.renderPass==="offscreen"){var ie=C.context,ue=ie.gl,ge=Ue.disabled,we=new We([ue.ONE,ue.ONE],e.Color.transparent,[!0,!0,!0,!0]);(function(At,xt,zt){var It=At.gl;At.activeTexture.set(It.TEXTURE1),At.viewport.set([0,0,xt.width/4,xt.height/4]);var Bt=zt.heatmapFbo;if(Bt)It.bindTexture(It.TEXTURE_2D,Bt.colorAttachment.get()),At.bindFramebuffer.set(Bt.framebuffer);else{var nr=It.createTexture();It.bindTexture(It.TEXTURE_2D,nr),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_WRAP_S,It.CLAMP_TO_EDGE),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_WRAP_T,It.CLAMP_TO_EDGE),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_MIN_FILTER,It.LINEAR),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_MAG_FILTER,It.LINEAR),Bt=zt.heatmapFbo=At.createFramebuffer(xt.width/4,xt.height/4,!1),function(gr,Lr,Sr,$r){var Qr=gr.gl,fn=gr.extRenderToTextureHalfFloat?gr.extTextureHalfFloat.HALF_FLOAT_OES:Qr.UNSIGNED_BYTE;Qr.texImage2D(Qr.TEXTURE_2D,0,Qr.RGBA,Lr.width/4,Lr.height/4,0,Qr.RGBA,fn,null),$r.colorAttachment.set(Sr)}(At,xt,nr,Bt)}})(ie,C,F),ie.clear({color:e.Color.transparent});for(var Se=0;Se<q.length;Se++){var Ve=q[Se];if(!z.hasRenderableParent(Ve)){var Je=z.getTile(Ve),at=Je.getBucket(F);if(at){var bt=at.programConfigurations.get(F.id),Et=C.useProgram("heatmap",bt),kt=C.transform.zoom;Et.draw(ie,ue.TRIANGLES,Ht.disabled,ge,we,he.disabled,Xo(Ve.posMatrix,Je,kt,F.paint.get("heatmap-intensity")),F.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,F.paint,C.transform.zoom,bt)}}}ie.viewport.set([0,0,C.width,C.height])}else C.renderPass==="translucent"&&(C.context.setColorMode(C.colorModeForRenderPass()),function(At,xt){var zt=At.context,It=zt.gl,Bt=xt.heatmapFbo;if(!!Bt){zt.activeTexture.set(It.TEXTURE0),It.bindTexture(It.TEXTURE_2D,Bt.colorAttachment.get()),zt.activeTexture.set(It.TEXTURE1);var nr=xt.colorRampTexture;nr||(nr=xt.colorRampTexture=new e.Texture(zt,xt.colorRamp,It.RGBA)),nr.bind(It.LINEAR,It.CLAMP_TO_EDGE),At.useProgram("heatmapTexture").draw(zt,It.TRIANGLES,Ht.disabled,Ue.disabled,At.colorModeForRenderPass(),he.disabled,function(gr,Lr,Sr,$r){var Qr=e.create();e.ortho(Qr,0,gr.width,gr.height,0,0,1);var fn=gr.context.gl;return{u_matrix:Qr,u_world:[fn.drawingBufferWidth,fn.drawingBufferHeight],u_image:Sr,u_color_ramp:$r,u_opacity:Lr.paint.get("heatmap-opacity")}}(At,xt,0,1),xt.id,At.viewportBuffer,At.quadTriangleIndexBuffer,At.viewportSegments,xt.paint,At.transform.zoom)}}(C,F))},line:function(C,z,F,q){if(C.renderPass==="translucent"){var ie=F.paint.get("line-opacity"),ue=F.paint.get("line-width");if(ie.constantOr(1)!==0&&ue.constantOr(1)!==0){var ge=C.depthModeForSublayer(0,Ht.ReadOnly),we=C.colorModeForRenderPass(),Se=F.paint.get("line-dasharray"),Ve=F.paint.get("line-pattern"),Je=Ve.constantOr(1),at=F.paint.get("line-gradient"),bt=F.getCrossfadeParameters(),Et=Je?"linePattern":Se?"lineSDF":at?"lineGradient":"line",kt=C.context,At=kt.gl,xt=!0;if(at){kt.activeTexture.set(At.TEXTURE0);var zt=F.gradientTexture;if(!F.gradient)return;zt||(zt=F.gradientTexture=new e.Texture(kt,F.gradient,At.RGBA)),zt.bind(At.LINEAR,At.CLAMP_TO_EDGE)}for(var It=0,Bt=q;It<Bt.length;It+=1){var nr=Bt[It],gr=z.getTile(nr);if(!Je||gr.patternsLoaded()){var Lr=gr.getBucket(F);if(Lr){var Sr=Lr.programConfigurations.get(F.id),$r=C.context.program.get(),Qr=C.useProgram(Et,Sr),fn=xt||Qr.program!==$r,sn=Ve.constantOr(null);if(sn&&gr.imageAtlas){var Vn=gr.imageAtlas,Jn=Vn.patternPositions[sn.to.toString()],ha=Vn.patternPositions[sn.from.toString()];Jn&&ha&&Sr.setConstantPatternPositions(Jn,ha)}var Wr=Je?je(C,gr,F,bt):Se?Ge(C,gr,F,Se,bt):at?Ya(C,gr,F):Do(C,gr,F);Je?(kt.activeTexture.set(At.TEXTURE0),gr.imageAtlasTexture.bind(At.LINEAR,At.CLAMP_TO_EDGE),Sr.updatePaintBuffers(bt)):Se&&(fn||C.lineAtlas.dirty)&&(kt.activeTexture.set(At.TEXTURE0),C.lineAtlas.bind(kt)),Qr.draw(kt,At.TRIANGLES,ge,C.stencilModeForClipping(nr),we,he.disabled,Wr,F.id,Lr.layoutVertexBuffer,Lr.indexBuffer,Lr.segments,F.paint,C.transform.zoom,Sr),xt=!1}}}}}},fill:function(C,z,F,q){var ie=F.paint.get("fill-color"),ue=F.paint.get("fill-opacity");if(ue.constantOr(1)!==0){var ge=C.colorModeForRenderPass(),we=F.paint.get("fill-pattern"),Se=C.opaquePassEnabledForLayer()&&!we.constantOr(1)&&ie.constantOr(e.Color.transparent).a===1&&ue.constantOr(0)===1?"opaque":"translucent";if(C.renderPass===Se){var Ve=C.depthModeForSublayer(1,C.renderPass==="opaque"?Ht.ReadWrite:Ht.ReadOnly);Rn(C,z,F,q,Ve,ge,!1)}if(C.renderPass==="translucent"&&F.paint.get("fill-antialias")){var Je=C.depthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,Ht.ReadOnly);Rn(C,z,F,q,Je,ge,!0)}}},"fill-extrusion":function(C,z,F,q){var ie=F.paint.get("fill-extrusion-opacity");if(ie!==0&&C.renderPass==="translucent"){var ue=new Ht(C.context.gl.LEQUAL,Ht.ReadWrite,C.depthRangeFor3D);if(ie!==1||F.paint.get("fill-extrusion-pattern").constantOr(1))va(C,z,F,q,ue,Ue.disabled,We.disabled),va(C,z,F,q,ue,C.stencilModeFor3D(),C.colorModeForRenderPass());else{var ge=C.colorModeForRenderPass();va(C,z,F,q,ue,Ue.disabled,ge)}}},hillshade:function(C,z,F,q){if(C.renderPass==="offscreen"||C.renderPass==="translucent"){for(var ie=C.context,ue=z.getSource().maxzoom,ge=C.depthModeForSublayer(0,Ht.ReadOnly),we=C.colorModeForRenderPass(),Se=C.renderPass==="translucent"?C.stencilConfigForOverlap(q):[{},q],Ve=Se[0],Je=0,at=Se[1];Je<at.length;Je+=1){var bt=at[Je],Et=z.getTile(bt);Et.needsHillshadePrepare&&C.renderPass==="offscreen"?Ua(C,Et,F,ue,ge,Ue.disabled,we):C.renderPass==="translucent"&&Sa(C,Et,F,ge,Ve[bt.overscaledZ],we)}ie.viewport.set([0,0,C.width,C.height])}},raster:function(C,z,F,q){if(C.renderPass==="translucent"&&F.paint.get("raster-opacity")!==0&&q.length)for(var ie=C.context,ue=ie.gl,ge=z.getSource(),we=C.useProgram("raster"),Se=C.colorModeForRenderPass(),Ve=ge instanceof G?[{},q]:C.stencilConfigForOverlap(q),Je=Ve[0],at=Ve[1],bt=at[at.length-1].overscaledZ,Et=!C.options.moving,kt=0,At=at;kt<At.length;kt+=1){var xt=At[kt],zt=C.depthModeForSublayer(xt.overscaledZ-bt,F.paint.get("raster-opacity")===1?Ht.ReadWrite:Ht.ReadOnly,ue.LESS),It=z.getTile(xt),Bt=C.transform.calculatePosMatrix(xt.toUnwrapped(),Et);It.registerFadeDuration(F.paint.get("raster-fade-duration"));var nr=z.findLoadedParent(xt,0),gr=ja(It,nr,z,F,C.transform),Lr=void 0,Sr=void 0,$r=F.paint.get("raster-resampling")==="nearest"?ue.NEAREST:ue.LINEAR;ie.activeTexture.set(ue.TEXTURE0),It.texture.bind($r,ue.CLAMP_TO_EDGE,ue.LINEAR_MIPMAP_NEAREST),ie.activeTexture.set(ue.TEXTURE1),nr?(nr.texture.bind($r,ue.CLAMP_TO_EDGE,ue.LINEAR_MIPMAP_NEAREST),Lr=Math.pow(2,nr.tileID.overscaledZ-It.tileID.overscaledZ),Sr=[It.tileID.canonical.x*Lr%1,It.tileID.canonical.y*Lr%1]):It.texture.bind($r,ue.CLAMP_TO_EDGE,ue.LINEAR_MIPMAP_NEAREST);var Qr=gt(Bt,Sr||[0,0],Lr||1,gr,F);ge instanceof G?we.draw(ie,ue.TRIANGLES,zt,Ue.disabled,Se,he.disabled,Qr,F.id,ge.boundsBuffer,C.quadTriangleIndexBuffer,ge.boundsSegments):we.draw(ie,ue.TRIANGLES,zt,Je[xt.overscaledZ],Se,he.disabled,Qr,F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}},background:function(C,z,F){var q=F.paint.get("background-color"),ie=F.paint.get("background-opacity");if(ie!==0){var ue=C.context,ge=ue.gl,we=C.transform,Se=we.tileSize,Ve=F.paint.get("background-pattern");if(!C.isPatternMissing(Ve)){var Je=!Ve&&q.a===1&&ie===1&&C.opaquePassEnabledForLayer()?"opaque":"translucent";if(C.renderPass===Je){var at=Ue.disabled,bt=C.depthModeForSublayer(0,Je==="opaque"?Ht.ReadWrite:Ht.ReadOnly),Et=C.colorModeForRenderPass(),kt=C.useProgram(Ve?"backgroundPattern":"background"),At=we.coveringTiles({tileSize:Se});Ve&&(ue.activeTexture.set(ge.TEXTURE0),C.imageManager.bind(C.context));for(var xt=F.getCrossfadeParameters(),zt=0,It=At;zt<It.length;zt+=1){var Bt=It[zt],nr=C.transform.calculatePosMatrix(Bt.toUnwrapped()),gr=Ve?mr(nr,ie,C,Ve,{tileID:Bt,tileSize:Se},xt):or(nr,ie,q);kt.draw(ue,ge.TRIANGLES,bt,at,Et,he.disabled,gr,F.id,C.tileExtentBuffer,C.quadTriangleIndexBuffer,C.tileExtentSegments)}}}}},debug:function(C,z,F){for(var q=0;q<F.length;q++)ao(C,z,F[q])},custom:function(C,z,F){var q=C.context,ie=F.implementation;if(C.renderPass==="offscreen"){var ue=ie.prerender;ue&&(C.setCustomLayerDefaults(),q.setColorMode(C.colorModeForRenderPass()),ue.call(ie,q.gl,C.transform.customLayerMatrix()),q.setDirty(),C.setBaseState())}else if(C.renderPass==="translucent"){C.setCustomLayerDefaults(),q.setColorMode(C.colorModeForRenderPass()),q.setStencilMode(Ue.disabled);var ge=ie.renderingMode==="3d"?new Ht(C.context.gl.LEQUAL,Ht.ReadWrite,C.depthRangeFor3D):C.depthModeForSublayer(0,Ht.ReadOnly);q.setDepthMode(ge),ie.render(q.gl,C.transform.customLayerMatrix()),q.setDirty(),C.setBaseState(),q.bindFramebuffer.set(null)}}},Da=function(C,z){this.context=new xe(C),this.transform=z,this._tileTextures={},this.setup(),this.numSublayers=De.maxUnderzooming+De.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new qr,this.gpuTimers={}};Da.prototype.resize=function(C,z){if(this.width=C*e.browser.devicePixelRatio,this.height=z*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var F=0,q=this.style._order;F<q.length;F+=1){var ie=q[F];this.style._layers[ie].resize()}},Da.prototype.setup=function(){var C=this.context,z=new e.StructArrayLayout2i4;z.emplaceBack(0,0),z.emplaceBack(e.EXTENT,0),z.emplaceBack(0,e.EXTENT),z.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=C.createVertexBuffer(z,Ln.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var F=new e.StructArrayLayout2i4;F.emplaceBack(0,0),F.emplaceBack(e.EXTENT,0),F.emplaceBack(0,e.EXTENT),F.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=C.createVertexBuffer(F,Ln.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var q=new e.StructArrayLayout4i8;q.emplaceBack(0,0,0,0),q.emplaceBack(e.EXTENT,0,e.EXTENT,0),q.emplaceBack(0,e.EXTENT,0,e.EXTENT),q.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=C.createVertexBuffer(q,$.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ie=new e.StructArrayLayout2i4;ie.emplaceBack(0,0),ie.emplaceBack(1,0),ie.emplaceBack(0,1),ie.emplaceBack(1,1),this.viewportBuffer=C.createVertexBuffer(ie,Ln.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ue=new e.StructArrayLayout1ui2;ue.emplaceBack(0),ue.emplaceBack(1),ue.emplaceBack(3),ue.emplaceBack(2),ue.emplaceBack(0),this.tileBorderIndexBuffer=C.createIndexBuffer(ue);var ge=new e.StructArrayLayout3ui6;ge.emplaceBack(0,1,2),ge.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=C.createIndexBuffer(ge),this.emptyTexture=new e.Texture(C,{width:1,height:1,data:new Uint8Array([0,0,0,0])},C.gl.RGBA);var we=this.context.gl;this.stencilClearMode=new Ue({func:we.ALWAYS,mask:0},0,255,we.ZERO,we.ZERO,we.ZERO)},Da.prototype.clearStencil=function(){var C=this.context,z=C.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var F=e.create();e.ortho(F,0,this.width,this.height,0,0,1),e.scale(F,F,[z.drawingBufferWidth,z.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(C,z.TRIANGLES,Ht.disabled,this.stencilClearMode,We.disabled,he.disabled,go(F),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Da.prototype._renderTileClippingMasks=function(C,z){if(this.currentStencilSource!==C.source&&C.isTileClipped()&&z&&z.length){this.currentStencilSource=C.source;var F=this.context,q=F.gl;this.nextStencilID+z.length>256&&this.clearStencil(),F.setColorMode(We.disabled),F.setDepthMode(Ht.disabled);var ie=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var ue=0,ge=z;ue<ge.length;ue+=1){var we=ge[ue],Se=this._tileClippingMaskIDs[we.key]=this.nextStencilID++;ie.draw(F,q.TRIANGLES,Ht.disabled,new Ue({func:q.ALWAYS,mask:0},Se,255,q.KEEP,q.KEEP,q.REPLACE),We.disabled,he.disabled,go(we.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Da.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var C=this.nextStencilID++,z=this.context.gl;return new Ue({func:z.NOTEQUAL,mask:255},C,255,z.KEEP,z.KEEP,z.REPLACE)},Da.prototype.stencilModeForClipping=function(C){var z=this.context.gl;return new Ue({func:z.EQUAL,mask:255},this._tileClippingMaskIDs[C.key],0,z.KEEP,z.KEEP,z.REPLACE)},Da.prototype.stencilConfigForOverlap=function(C){var z,F=this.context.gl,q=C.sort(function(Se,Ve){return Ve.overscaledZ-Se.overscaledZ}),ie=q[q.length-1].overscaledZ,ue=q[0].overscaledZ-ie+1;if(ue>1){this.currentStencilSource=void 0,this.nextStencilID+ue>256&&this.clearStencil();for(var ge={},we=0;we<ue;we++)ge[we+ie]=new Ue({func:F.GEQUAL,mask:255},we+this.nextStencilID,255,F.KEEP,F.KEEP,F.REPLACE);return this.nextStencilID+=ue,[ge,q]}return[(z={},z[ie]=Ue.disabled,z),q]},Da.prototype.colorModeForRenderPass=function(){var C=this.context.gl;return this._showOverdrawInspector?new We([C.CONSTANT_COLOR,C.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?We.unblended:We.alphaBlended},Da.prototype.depthModeForSublayer=function(C,z,F){if(!this.opaquePassEnabledForLayer())return Ht.disabled;var q=1-((1+this.currentLayer)*this.numSublayers+C)*this.depthEpsilon;return new Ht(F||this.context.gl.LEQUAL,z,[q,q])},Da.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Da.prototype.render=function(C,z){var F=this;this.style=C,this.options=z,this.lineAtlas=C.lineAtlas,this.imageManager=C.imageManager,this.glyphManager=C.glyphManager,this.symbolFadeChange=C.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var q=this.style._order,ie=this.style.sourceCaches;for(var ue in ie){var ge=ie[ue];ge.used&&ge.prepare(this.context)}var we,Se,Ve={},Je={},at={};for(var bt in ie){var Et=ie[bt];Ve[bt]=Et.getVisibleCoordinates(),Je[bt]=Ve[bt].slice().reverse(),at[bt]=Et.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var kt=0;kt<q.length;kt++){var At=q[kt];if(this.style._layers[At].is3D()){this.opaquePassCutoff=kt;break}}this.renderPass="offscreen";for(var xt=0,zt=q;xt<zt.length;xt+=1){var It=zt[xt],Bt=this.style._layers[It];if(Bt.hasOffscreenPass()&&!Bt.isHidden(this.transform.zoom)){var nr=Je[Bt.source];(Bt.type==="custom"||nr.length)&&this.renderLayer(this,ie[Bt.source],Bt,nr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:z.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=z.showOverdrawInspector,this.depthRangeFor3D=[0,1-(C._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=q.length-1;this.currentLayer>=0;this.currentLayer--){var gr=this.style._layers[q[this.currentLayer]],Lr=ie[gr.source],Sr=Ve[gr.source];this._renderTileClippingMasks(gr,Sr),this.renderLayer(this,Lr,gr,Sr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<q.length;this.currentLayer++){var $r=this.style._layers[q[this.currentLayer]],Qr=ie[$r.source],fn=($r.type==="symbol"?at:Je)[$r.source];this._renderTileClippingMasks($r,Ve[$r.source]),this.renderLayer(this,Qr,$r,fn)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function(sn){sn.source&&!sn.isHidden(F.transform.zoom)&&(sn.source!==(Se&&Se.id)&&(Se=F.style.sourceCaches[sn.source]),(!we||we.getSource().maxzoom<Se.getSource().maxzoom)&&(we=Se))}),we&&io.debug(this,we,we.getVisibleCoordinates())),this.options.showPadding&&ki(this),this.context.setDefault()},Da.prototype.renderLayer=function(C,z,F,q){F.isHidden(this.transform.zoom)||(F.type==="background"||F.type==="custom"||q.length)&&(this.id=F.id,this.gpuTimingStart(F),io[F.type](C,z,F,q,this.style.placement.variableOffsets),this.gpuTimingEnd())},Da.prototype.gpuTimingStart=function(C){if(this.options.gpuTiming){var z=this.context.extTimerQuery,F=this.gpuTimers[C.id];F||(F=this.gpuTimers[C.id]={calls:0,cpuTime:0,query:z.createQueryEXT()}),F.calls++,z.beginQueryEXT(z.TIME_ELAPSED_EXT,F.query)}},Da.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var C=this.context.extTimerQuery;C.endQueryEXT(C.TIME_ELAPSED_EXT)}},Da.prototype.collectGpuTimers=function(){var C=this.gpuTimers;return this.gpuTimers={},C},Da.prototype.queryGpuTimers=function(C){var z={};for(var F in C){var q=C[F],ie=this.context.extTimerQuery,ue=ie.getQueryObjectEXT(q.query,ie.QUERY_RESULT_EXT)/1e6;ie.deleteQueryEXT(q.query),z[F]=ue}return z},Da.prototype.translatePosMatrix=function(C,z,F,q,ie){if(!F[0]&&!F[1])return C;var ue=ie?q==="map"?this.transform.angle:0:q==="viewport"?-this.transform.angle:0;if(ue){var ge=Math.sin(ue),we=Math.cos(ue);F=[F[0]*we-F[1]*ge,F[0]*ge+F[1]*we]}var Se=[ie?F[0]:gn(z,F[0],this.transform.zoom),ie?F[1]:gn(z,F[1],this.transform.zoom),0],Ve=new Float32Array(16);return e.translate(Ve,C,Se),Ve},Da.prototype.saveTileTexture=function(C){var z=this._tileTextures[C.size[0]];z?z.push(C):this._tileTextures[C.size[0]]=[C]},Da.prototype.getTileTexture=function(C){var z=this._tileTextures[C];return z&&z.length>0?z.pop():null},Da.prototype.isPatternMissing=function(C){if(!C)return!1;if(!C.from||!C.to)return!0;var z=this.imageManager.getPattern(C.from.toString()),F=this.imageManager.getPattern(C.to.toString());return!z||!F},Da.prototype.useProgram=function(C,z){this.cache=this.cache||{};var F=""+C+(z?z.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[F]||(this.cache[F]=new Ls(this.context,vs[C],z,wr[C],this._showOverdrawInspector)),this.cache[F]},Da.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Da.prototype.setBaseState=function(){var C=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(C.FUNC_ADD)},Da.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var C=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,C.RGBA)}},Da.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ht=function(C,z){this.points=C,this.planes=z};ht.fromInvProjectionMatrix=function(C,z,F){var q=Math.pow(2,F),ie=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(ge){return e.transformMat4([],ge,C)}).map(function(ge){return e.scale$1([],ge,1/ge[3]/z*q)}),ue=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(ge){var we=e.sub([],ie[ge[0]],ie[ge[1]]),Se=e.sub([],ie[ge[2]],ie[ge[1]]),Ve=e.normalize([],e.cross([],we,Se)),Je=-e.dot(Ve,ie[ge[1]]);return Ve.concat(Je)});return new ht(ie,ue)};var Ot=function(C,z){this.min=C,this.max=z,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Ot.prototype.quadrant=function(C){for(var z=[C%2==0,C<2],F=e.clone$2(this.min),q=e.clone$2(this.max),ie=0;ie<z.length;ie++)F[ie]=z[ie]?this.min[ie]:this.center[ie],q[ie]=z[ie]?this.center[ie]:this.max[ie];return q[2]=this.max[2],new Ot(F,q)},Ot.prototype.distanceX=function(C){return Math.max(Math.min(this.max[0],C[0]),this.min[0])-C[0]},Ot.prototype.distanceY=function(C){return Math.max(Math.min(this.max[1],C[1]),this.min[1])-C[1]},Ot.prototype.intersects=function(C){for(var z=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],F=!0,q=0;q<C.planes.length;q++){for(var ie=C.planes[q],ue=0,ge=0;ge<z.length;ge++)ue+=e.dot$1(ie,z[ge])>=0;if(ue===0)return 0;ue!==z.length&&(F=!1)}if(F)return 2;for(var we=0;we<3;we++){for(var Se=Number.MAX_VALUE,Ve=-Number.MAX_VALUE,Je=0;Je<C.points.length;Je++){var at=C.points[Je][we]-this.min[we];Se=Math.min(Se,at),Ve=Math.max(Ve,at)}if(Ve<0||Se>this.max[we]-this.min[we])return 0}return 1};var cr=function(C,z,F,q){if(C===void 0&&(C=0),z===void 0&&(z=0),F===void 0&&(F=0),q===void 0&&(q=0),isNaN(C)||C<0||isNaN(z)||z<0||isNaN(F)||F<0||isNaN(q)||q<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=C,this.bottom=z,this.left=F,this.right=q};cr.prototype.interpolate=function(C,z,F){return z.top!=null&&C.top!=null&&(this.top=e.number(C.top,z.top,F)),z.bottom!=null&&C.bottom!=null&&(this.bottom=e.number(C.bottom,z.bottom,F)),z.left!=null&&C.left!=null&&(this.left=e.number(C.left,z.left,F)),z.right!=null&&C.right!=null&&(this.right=e.number(C.right,z.right,F)),this},cr.prototype.getCenter=function(C,z){var F=e.clamp((this.left+C-this.right)/2,0,C),q=e.clamp((this.top+z-this.bottom)/2,0,z);return new e.Point(F,q)},cr.prototype.equals=function(C){return this.top===C.top&&this.bottom===C.bottom&&this.left===C.left&&this.right===C.right},cr.prototype.clone=function(){return new cr(this.top,this.bottom,this.left,this.right)},cr.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ut=function(C,z,F,q,ie){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=ie===void 0||ie,this._minZoom=C||0,this._maxZoom=z||22,this._minPitch=F==null?0:F,this._maxPitch=q==null?60:q,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new cr,this._posMatrixCache={},this._alignedPosMatrixCache={}},ur={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ut.prototype.clone=function(){var C=new Ut(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return C.tileSize=this.tileSize,C.latRange=this.latRange,C.width=this.width,C.height=this.height,C._center=this._center,C.zoom=this.zoom,C.angle=this.angle,C._fov=this._fov,C._pitch=this._pitch,C._unmodified=this._unmodified,C._edgeInsets=this._edgeInsets.clone(),C._calcMatrices(),C},ur.minZoom.get=function(){return this._minZoom},ur.minZoom.set=function(C){this._minZoom!==C&&(this._minZoom=C,this.zoom=Math.max(this.zoom,C))},ur.maxZoom.get=function(){return this._maxZoom},ur.maxZoom.set=function(C){this._maxZoom!==C&&(this._maxZoom=C,this.zoom=Math.min(this.zoom,C))},ur.minPitch.get=function(){return this._minPitch},ur.minPitch.set=function(C){this._minPitch!==C&&(this._minPitch=C,this.pitch=Math.max(this.pitch,C))},ur.maxPitch.get=function(){return this._maxPitch},ur.maxPitch.set=function(C){this._maxPitch!==C&&(this._maxPitch=C,this.pitch=Math.min(this.pitch,C))},ur.renderWorldCopies.get=function(){return this._renderWorldCopies},ur.renderWorldCopies.set=function(C){C===void 0?C=!0:C===null&&(C=!1),this._renderWorldCopies=C},ur.worldSize.get=function(){return this.tileSize*this.scale},ur.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},ur.size.get=function(){return new e.Point(this.width,this.height)},ur.bearing.get=function(){return-this.angle/Math.PI*180},ur.bearing.set=function(C){var z=-e.wrap(C,-180,180)*Math.PI/180;this.angle!==z&&(this._unmodified=!1,this.angle=z,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ur.pitch.get=function(){return this._pitch/Math.PI*180},ur.pitch.set=function(C){var z=e.clamp(C,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==z&&(this._unmodified=!1,this._pitch=z,this._calcMatrices())},ur.fov.get=function(){return this._fov/Math.PI*180},ur.fov.set=function(C){C=Math.max(.01,Math.min(60,C)),this._fov!==C&&(this._unmodified=!1,this._fov=C/180*Math.PI,this._calcMatrices())},ur.zoom.get=function(){return this._zoom},ur.zoom.set=function(C){var z=Math.min(Math.max(C,this.minZoom),this.maxZoom);this._zoom!==z&&(this._unmodified=!1,this._zoom=z,this.scale=this.zoomScale(z),this.tileZoom=Math.floor(z),this.zoomFraction=z-this.tileZoom,this._constrain(),this._calcMatrices())},ur.center.get=function(){return this._center},ur.center.set=function(C){C.lat===this._center.lat&&C.lng===this._center.lng||(this._unmodified=!1,this._center=C,this._constrain(),this._calcMatrices())},ur.padding.get=function(){return this._edgeInsets.toJSON()},ur.padding.set=function(C){this._edgeInsets.equals(C)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,C,1),this._calcMatrices())},ur.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ut.prototype.isPaddingEqual=function(C){return this._edgeInsets.equals(C)},Ut.prototype.interpolatePadding=function(C,z,F){this._unmodified=!1,this._edgeInsets.interpolate(C,z,F),this._constrain(),this._calcMatrices()},Ut.prototype.coveringZoomLevel=function(C){var z=(C.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/C.tileSize));return Math.max(0,z)},Ut.prototype.getVisibleUnwrappedCoordinates=function(C){var z=[new e.UnwrappedTileID(0,C)];if(this._renderWorldCopies)for(var F=this.pointCoordinate(new e.Point(0,0)),q=this.pointCoordinate(new e.Point(this.width,0)),ie=this.pointCoordinate(new e.Point(this.width,this.height)),ue=this.pointCoordinate(new e.Point(0,this.height)),ge=Math.floor(Math.min(F.x,q.x,ie.x,ue.x)),we=Math.floor(Math.max(F.x,q.x,ie.x,ue.x)),Se=ge-1;Se<=we+1;Se++)Se!==0&&z.push(new e.UnwrappedTileID(Se,C));return z},Ut.prototype.coveringTiles=function(C){var z=this.coveringZoomLevel(C),F=z;if(C.minzoom!==void 0&&z<C.minzoom)return[];C.maxzoom!==void 0&&z>C.maxzoom&&(z=C.maxzoom);var q=e.MercatorCoordinate.fromLngLat(this.center),ie=Math.pow(2,z),ue=[ie*q.x,ie*q.y,0],ge=ht.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,z),we=C.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(we=z);var Se=function(fn){return{aabb:new Ot([fn*ie,0,0],[(fn+1)*ie,ie,0]),zoom:0,x:0,y:0,wrap:fn,fullyVisible:!1}},Ve=[],Je=[],at=z,bt=C.reparseOverscaled?F:z;if(this._renderWorldCopies)for(var Et=1;Et<=3;Et++)Ve.push(Se(-Et)),Ve.push(Se(Et));for(Ve.push(Se(0));Ve.length>0;){var kt=Ve.pop(),At=kt.x,xt=kt.y,zt=kt.fullyVisible;if(!zt){var It=kt.aabb.intersects(ge);if(It===0)continue;zt=It===2}var Bt=kt.aabb.distanceX(ue),nr=kt.aabb.distanceY(ue),gr=Math.max(Math.abs(Bt),Math.abs(nr)),Lr=3+(1<<at-kt.zoom)-2;if(kt.zoom===at||gr>Lr&&kt.zoom>=we)Je.push({tileID:new e.OverscaledTileID(kt.zoom===at?bt:kt.zoom,kt.wrap,kt.zoom,At,xt),distanceSq:e.sqrLen([ue[0]-.5-At,ue[1]-.5-xt])});else for(var Sr=0;Sr<4;Sr++){var $r=(At<<1)+Sr%2,Qr=(xt<<1)+(Sr>>1);Ve.push({aabb:kt.aabb.quadrant(Sr),zoom:kt.zoom+1,x:$r,y:Qr,wrap:kt.wrap,fullyVisible:zt})}}return Je.sort(function(fn,sn){return fn.distanceSq-sn.distanceSq}).map(function(fn){return fn.tileID})},Ut.prototype.resize=function(C,z){this.width=C,this.height=z,this.pixelsToGLUnits=[2/C,-2/z],this._constrain(),this._calcMatrices()},ur.unmodified.get=function(){return this._unmodified},Ut.prototype.zoomScale=function(C){return Math.pow(2,C)},Ut.prototype.scaleZoom=function(C){return Math.log(C)/Math.LN2},Ut.prototype.project=function(C){var z=e.clamp(C.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(C.lng)*this.worldSize,e.mercatorYfromLat(z)*this.worldSize)},Ut.prototype.unproject=function(C){return new e.MercatorCoordinate(C.x/this.worldSize,C.y/this.worldSize).toLngLat()},ur.point.get=function(){return this.project(this.center)},Ut.prototype.setLocationAtPoint=function(C,z){var F=this.pointCoordinate(z),q=this.pointCoordinate(this.centerPoint),ie=this.locationCoordinate(C),ue=new e.MercatorCoordinate(ie.x-(F.x-q.x),ie.y-(F.y-q.y));this.center=this.coordinateLocation(ue),this._renderWorldCopies&&(this.center=this.center.wrap())},Ut.prototype.locationPoint=function(C){return this.coordinatePoint(this.locationCoordinate(C))},Ut.prototype.pointLocation=function(C){return this.coordinateLocation(this.pointCoordinate(C))},Ut.prototype.locationCoordinate=function(C){return e.MercatorCoordinate.fromLngLat(C)},Ut.prototype.coordinateLocation=function(C){return C.toLngLat()},Ut.prototype.pointCoordinate=function(C){var z=[C.x,C.y,0,1],F=[C.x,C.y,1,1];e.transformMat4(z,z,this.pixelMatrixInverse),e.transformMat4(F,F,this.pixelMatrixInverse);var q=z[3],ie=F[3],ue=z[0]/q,ge=F[0]/ie,we=z[1]/q,Se=F[1]/ie,Ve=z[2]/q,Je=F[2]/ie,at=Ve===Je?0:(0-Ve)/(Je-Ve);return new e.MercatorCoordinate(e.number(ue,ge,at)/this.worldSize,e.number(we,Se,at)/this.worldSize)},Ut.prototype.coordinatePoint=function(C){var z=[C.x*this.worldSize,C.y*this.worldSize,0,1];return e.transformMat4(z,z,this.pixelMatrix),new e.Point(z[0]/z[3],z[1]/z[3])},Ut.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},Ut.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ut.prototype.setMaxBounds=function(C){C?(this.lngRange=[C.getWest(),C.getEast()],this.latRange=[C.getSouth(),C.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ut.prototype.calculatePosMatrix=function(C,z){z===void 0&&(z=!1);var F=C.key,q=z?this._alignedPosMatrixCache:this._posMatrixCache;if(q[F])return q[F];var ie=C.canonical,ue=this.worldSize/this.zoomScale(ie.z),ge=ie.x+Math.pow(2,ie.z)*C.wrap,we=e.identity(new Float64Array(16));return e.translate(we,we,[ge*ue,ie.y*ue,0]),e.scale(we,we,[ue/e.EXTENT,ue/e.EXTENT,1]),e.multiply(we,z?this.alignedProjMatrix:this.projMatrix,we),q[F]=new Float32Array(we),q[F]},Ut.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ut.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var C,z,F,q,ie=-90,ue=90,ge=-180,we=180,Se=this.size,Ve=this._unmodified;if(this.latRange){var Je=this.latRange;ie=e.mercatorYfromLat(Je[1])*this.worldSize,C=(ue=e.mercatorYfromLat(Je[0])*this.worldSize)-ie<Se.y?Se.y/(ue-ie):0}if(this.lngRange){var at=this.lngRange;ge=e.mercatorXfromLng(at[0])*this.worldSize,z=(we=e.mercatorXfromLng(at[1])*this.worldSize)-ge<Se.x?Se.x/(we-ge):0}var bt=this.point,Et=Math.max(z||0,C||0);if(Et)return this.center=this.unproject(new e.Point(z?(we+ge)/2:bt.x,C?(ue+ie)/2:bt.y)),this.zoom+=this.scaleZoom(Et),this._unmodified=Ve,void(this._constraining=!1);if(this.latRange){var kt=bt.y,At=Se.y/2;kt-At<ie&&(q=ie+At),kt+At>ue&&(q=ue-At)}if(this.lngRange){var xt=bt.x,zt=Se.x/2;xt-zt<ge&&(F=ge+zt),xt+zt>we&&(F=we-zt)}F===void 0&&q===void 0||(this.center=this.unproject(new e.Point(F!==void 0?F:bt.x,q!==void 0?q:bt.y))),this._unmodified=Ve,this._constraining=!1}},Ut.prototype._calcMatrices=function(){if(this.height){var C=this._fov/2,z=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(C)*this.height;var F=Math.PI/2+this._pitch,q=this._fov*(.5+z.y/this.height),ie=Math.sin(q)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-F-q,.01,Math.PI-.01)),ue=this.point,ge=ue.x,we=ue.y,Se=1.01*(Math.cos(Math.PI/2-this._pitch)*ie+this.cameraToCenterDistance),Ve=this.height/50,Je=new Float64Array(16);e.perspective(Je,this._fov,this.width/this.height,Ve,Se),Je[8]=2*-z.x/this.width,Je[9]=2*z.y/this.height,e.scale(Je,Je,[1,-1,1]),e.translate(Je,Je,[0,0,-this.cameraToCenterDistance]),e.rotateX(Je,Je,this._pitch),e.rotateZ(Je,Je,this.angle),e.translate(Je,Je,[-ge,-we,0]),this.mercatorMatrix=e.scale([],Je,[this.worldSize,this.worldSize,this.worldSize]),e.scale(Je,Je,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Je,this.invProjMatrix=e.invert([],this.projMatrix);var at=this.width%2/2,bt=this.height%2/2,Et=Math.cos(this.angle),kt=Math.sin(this.angle),At=ge-Math.round(ge)+Et*at+kt*bt,xt=we-Math.round(we)+Et*bt+kt*at,zt=new Float64Array(Je);if(e.translate(zt,zt,[At>.5?At-1:At,xt>.5?xt-1:xt,0]),this.alignedProjMatrix=zt,Je=e.create(),e.scale(Je,Je,[this.width/2,-this.height/2,1]),e.translate(Je,Je,[1,-1,0]),this.labelPlaneMatrix=Je,Je=e.create(),e.scale(Je,Je,[1,-1,1]),e.translate(Je,Je,[-1,-1,0]),e.scale(Je,Je,[2/this.width,2/this.height,1]),this.glCoordMatrix=Je,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Je=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Je,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ut.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var C=this.pointCoordinate(new e.Point(0,0)),z=[C.x*this.worldSize,C.y*this.worldSize,0,1];return e.transformMat4(z,z,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ut.prototype.getCameraPoint=function(){var C=this._pitch,z=Math.tan(C)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,z))},Ut.prototype.getCameraQueryGeometry=function(C){var z=this.getCameraPoint();if(C.length===1)return[C[0],z];for(var F=z.x,q=z.y,ie=z.x,ue=z.y,ge=0,we=C;ge<we.length;ge+=1){var Se=we[ge];F=Math.min(F,Se.x),q=Math.min(q,Se.y),ie=Math.max(ie,Se.x),ue=Math.max(ue,Se.y)}return[new e.Point(F,q),new e.Point(ie,q),new e.Point(ie,ue),new e.Point(F,ue),new e.Point(F,q)]},Object.defineProperties(Ut.prototype,ur);var Or=function(C){var z,F,q,ie,ue;this._hashName=C&&encodeURIComponent(C),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(z=this._updateHashUnthrottled.bind(this),F=300,q=!1,ie=null,ue=function(){ie=null,q&&(z(),ie=setTimeout(ue,F),q=!1)},function(){return q=!0,ie||ue(),ie})};Or.prototype.addTo=function(C){return this._map=C,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Or.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Or.prototype.getHashString=function(C){var z=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,q=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),ie=Math.pow(10,q),ue=Math.round(z.lng*ie)/ie,ge=Math.round(z.lat*ie)/ie,we=this._map.getBearing(),Se=this._map.getPitch(),Ve="";if(Ve+=C?"/"+ue+"/"+ge+"/"+F:F+"/"+ge+"/"+ue,(we||Se)&&(Ve+="/"+Math.round(10*we)/10),Se&&(Ve+="/"+Math.round(Se)),this._hashName){var Je=this._hashName,at=!1,bt=e.window.location.hash.slice(1).split("&").map(function(Et){var kt=Et.split("=")[0];return kt===Je?(at=!0,kt+"="+Ve):Et}).filter(function(Et){return Et});return at||bt.push(Je+"="+Ve),"#"+bt.join("&")}return"#"+Ve},Or.prototype._getCurrentHash=function(){var C,z=this,F=e.window.location.hash.replace("#","");return this._hashName?(F.split("&").map(function(q){return q.split("=")}).forEach(function(q){q[0]===z._hashName&&(C=q)}),(C&&C[1]||"").split("/")):F.split("/")},Or.prototype._onHashChange=function(){var C=this._getCurrentHash();if(C.length>=3&&!C.some(function(F){return isNaN(F)})){var z=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(C[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+C[2],+C[1]],zoom:+C[0],bearing:z,pitch:+(C[4]||0)}),!0}return!1},Or.prototype._updateHashUnthrottled=function(){var C=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",C)}catch{}};var jr={linearity:.3,easing:e.bezier(0,0,.3,1)},Zr=e.extend({deceleration:2500,maxSpeed:1400},jr),ln=e.extend({deceleration:20,maxSpeed:1400},jr),an=e.extend({deceleration:1e3,maxSpeed:360},jr),dn=e.extend({deceleration:1e3,maxSpeed:90},jr),Tn=function(C){this._map=C,this.clear()};function cn(C,z){(!C.duration||C.duration<z.duration)&&(C.duration=z.duration,C.easing=z.easing)}function kn(C,z,F){var q=F.maxSpeed,ie=F.linearity,ue=F.deceleration,ge=e.clamp(C*ie/(z/1e3),-q,q),we=Math.abs(ge)/(ue*ie);return{easing:F.easing,duration:1e3*we,amount:ge*(we/2)}}Tn.prototype.clear=function(){this._inertiaBuffer=[]},Tn.prototype.record=function(C){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:C})},Tn.prototype._drainInertiaBuffer=function(){for(var C=this._inertiaBuffer,z=e.browser.now();C.length>0&&z-C[0].time>160;)C.shift()},Tn.prototype._onMoveEnd=function(C){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var z={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},F=0,q=this._inertiaBuffer;F<q.length;F+=1){var ie=q[F].settings;z.zoom+=ie.zoomDelta||0,z.bearing+=ie.bearingDelta||0,z.pitch+=ie.pitchDelta||0,ie.panDelta&&z.pan._add(ie.panDelta),ie.around&&(z.around=ie.around),ie.pinchAround&&(z.pinchAround=ie.pinchAround)}var ue=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,ge={};if(z.pan.mag()){var we=kn(z.pan.mag(),ue,e.extend({},Zr,C||{}));ge.offset=z.pan.mult(we.amount/z.pan.mag()),ge.center=this._map.transform.center,cn(ge,we)}if(z.zoom){var Se=kn(z.zoom,ue,ln);ge.zoom=this._map.transform.zoom+Se.amount,cn(ge,Se)}if(z.bearing){var Ve=kn(z.bearing,ue,an);ge.bearing=this._map.transform.bearing+e.clamp(Ve.amount,-179,179),cn(ge,Ve)}if(z.pitch){var Je=kn(z.pitch,ue,dn);ge.pitch=this._map.transform.pitch+Je.amount,cn(ge,Je)}if(ge.zoom||ge.bearing){var at=z.pinchAround===void 0?z.around:z.pinchAround;ge.around=at?this._map.unproject(at):this._map.getCenter()}return this.clear(),e.extend(ge,{noMoveStart:!0})}};var Fn=function(C){function z(q,ie,ue,ge){ge===void 0&&(ge={});var we=t.mousePos(ie.getCanvasContainer(),ue),Se=ie.unproject(we);C.call(this,q,e.extend({point:we,lngLat:Se,originalEvent:ue},ge)),this._defaultPrevented=!1,this.target=ie}C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z;var F={defaultPrevented:{configurable:!0}};return z.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(z.prototype,F),z}(e.Event),qn=function(C){function z(q,ie,ue){var ge=q==="touchend"?ue.changedTouches:ue.touches,we=t.touchPos(ie.getCanvasContainer(),ge),Se=we.map(function(at){return ie.unproject(at)}),Ve=we.reduce(function(at,bt,Et,kt){return at.add(bt.div(kt.length))},new e.Point(0,0)),Je=ie.unproject(Ve);C.call(this,q,{points:we,point:Ve,lngLats:Se,lngLat:Je,originalEvent:ue}),this._defaultPrevented=!1}C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z;var F={defaultPrevented:{configurable:!0}};return z.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(z.prototype,F),z}(e.Event),oa=function(C){function z(q,ie,ue){C.call(this,q,{originalEvent:ue}),this._defaultPrevented=!1}C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z;var F={defaultPrevented:{configurable:!0}};return z.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(z.prototype,F),z}(e.Event),Kr=function(C,z){this._map=C,this._clickTolerance=z.clickTolerance};Kr.prototype.reset=function(){delete this._mousedownPos},Kr.prototype.wheel=function(C){return this._firePreventable(new oa(C.type,this._map,C))},Kr.prototype.mousedown=function(C,z){return this._mousedownPos=z,this._firePreventable(new Fn(C.type,this._map,C))},Kr.prototype.mouseup=function(C){this._map.fire(new Fn(C.type,this._map,C))},Kr.prototype.click=function(C,z){this._mousedownPos&&this._mousedownPos.dist(z)>=this._clickTolerance||this._map.fire(new Fn(C.type,this._map,C))},Kr.prototype.dblclick=function(C){return this._firePreventable(new Fn(C.type,this._map,C))},Kr.prototype.mouseover=function(C){this._map.fire(new Fn(C.type,this._map,C))},Kr.prototype.mouseout=function(C){this._map.fire(new Fn(C.type,this._map,C))},Kr.prototype.touchstart=function(C){return this._firePreventable(new qn(C.type,this._map,C))},Kr.prototype.touchmove=function(C){this._map.fire(new qn(C.type,this._map,C))},Kr.prototype.touchend=function(C){this._map.fire(new qn(C.type,this._map,C))},Kr.prototype.touchcancel=function(C){this._map.fire(new qn(C.type,this._map,C))},Kr.prototype._firePreventable=function(C){if(this._map.fire(C),C.defaultPrevented)return{}},Kr.prototype.isEnabled=function(){return!0},Kr.prototype.isActive=function(){return!1},Kr.prototype.enable=function(){},Kr.prototype.disable=function(){};var na=function(C){this._map=C};na.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},na.prototype.mousemove=function(C){this._map.fire(new Fn(C.type,this._map,C))},na.prototype.mousedown=function(){this._delayContextMenu=!0},na.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Fn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},na.prototype.contextmenu=function(C){this._delayContextMenu?this._contextMenuEvent=C:this._map.fire(new Fn(C.type,this._map,C)),this._map.listens("contextmenu")&&C.preventDefault()},na.prototype.isEnabled=function(){return!0},na.prototype.isActive=function(){return!1},na.prototype.enable=function(){},na.prototype.disable=function(){};var Pn=function(C,z){this._map=C,this._el=C.getCanvasContainer(),this._container=C.getContainer(),this._clickTolerance=z.clickTolerance||1};function Un(C,z){for(var F={},q=0;q<C.length;q++)F[C[q].identifier]=z[q];return F}Pn.prototype.isEnabled=function(){return!!this._enabled},Pn.prototype.isActive=function(){return!!this._active},Pn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Pn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Pn.prototype.mousedown=function(C,z){this.isEnabled()&&C.shiftKey&&C.button===0&&(t.disableDrag(),this._startPos=this._lastPos=z,this._active=!0)},Pn.prototype.mousemoveWindow=function(C,z){if(this._active){var F=z;if(!(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)){var q=this._startPos;this._lastPos=F,this._box||(this._box=t.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",C));var ie=Math.min(q.x,F.x),ue=Math.max(q.x,F.x),ge=Math.min(q.y,F.y),we=Math.max(q.y,F.y);t.setTransform(this._box,"translate("+ie+"px,"+ge+"px)"),this._box.style.width=ue-ie+"px",this._box.style.height=we-ge+"px"}}},Pn.prototype.mouseupWindow=function(C,z){var F=this;if(this._active&&C.button===0){var q=this._startPos,ie=z;if(this.reset(),t.suppressClick(),q.x!==ie.x||q.y!==ie.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:C})),{cameraAnimation:function(ue){return ue.fitScreenCoordinates(q,ie,F._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",C)}},Pn.prototype.keydown=function(C){this._active&&C.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",C))},Pn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(t.remove(this._box),this._box=null),t.enableDrag(),delete this._startPos,delete this._lastPos},Pn.prototype._fireEvent=function(C,z){return this._map.fire(new e.Event(C,{originalEvent:z}))};var ra=function(C){this.reset(),this.numTouches=C.numTouches};ra.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},ra.prototype.touchstart=function(C,z,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=C.timeStamp),F.length===this.numTouches&&(this.centroid=function(q){for(var ie=new e.Point(0,0),ue=0,ge=q;ue<ge.length;ue+=1){var we=ge[ue];ie._add(we)}return ie.div(q.length)}(z),this.touches=Un(F,z)))},ra.prototype.touchmove=function(C,z,F){if(!this.aborted&&this.centroid){var q=Un(F,z);for(var ie in this.touches){var ue=this.touches[ie],ge=q[ie];(!ge||ge.dist(ue)>30)&&(this.aborted=!0)}}},ra.prototype.touchend=function(C,z,F){if((!this.centroid||C.timeStamp-this.startTime>500)&&(this.aborted=!0),F.length===0){var q=!this.aborted&&this.centroid;if(this.reset(),q)return q}};var ka=function(C){this.singleTap=new ra(C),this.numTaps=C.numTaps,this.reset()};ka.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ka.prototype.touchstart=function(C,z,F){this.singleTap.touchstart(C,z,F)},ka.prototype.touchmove=function(C,z,F){this.singleTap.touchmove(C,z,F)},ka.prototype.touchend=function(C,z,F){var q=this.singleTap.touchend(C,z,F);if(q){var ie=C.timeStamp-this.lastTime<500,ue=!this.lastTap||this.lastTap.dist(q)<30;if(ie&&ue||this.reset(),this.count++,this.lastTime=C.timeStamp,this.lastTap=q,this.count===this.numTaps)return this.reset(),q}};var Pa=function(){this._zoomIn=new ka({numTouches:1,numTaps:2}),this._zoomOut=new ka({numTouches:2,numTaps:1}),this.reset()};Pa.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Pa.prototype.touchstart=function(C,z,F){this._zoomIn.touchstart(C,z,F),this._zoomOut.touchstart(C,z,F)},Pa.prototype.touchmove=function(C,z,F){this._zoomIn.touchmove(C,z,F),this._zoomOut.touchmove(C,z,F)},Pa.prototype.touchend=function(C,z,F){var q=this,ie=this._zoomIn.touchend(C,z,F),ue=this._zoomOut.touchend(C,z,F);return ie?(this._active=!0,C.preventDefault(),setTimeout(function(){return q.reset()},0),{cameraAnimation:function(ge){return ge.easeTo({duration:300,zoom:ge.getZoom()+1,around:ge.unproject(ie)},{originalEvent:C})}}):ue?(this._active=!0,C.preventDefault(),setTimeout(function(){return q.reset()},0),{cameraAnimation:function(ge){return ge.easeTo({duration:300,zoom:ge.getZoom()-1,around:ge.unproject(ue)},{originalEvent:C})}}):void 0},Pa.prototype.touchcancel=function(){this.reset()},Pa.prototype.enable=function(){this._enabled=!0},Pa.prototype.disable=function(){this._enabled=!1,this.reset()},Pa.prototype.isEnabled=function(){return this._enabled},Pa.prototype.isActive=function(){return this._active};var En=function(C){this.reset(),this._clickTolerance=C.clickTolerance||1};En.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},En.prototype._correctButton=function(C,z){return!1},En.prototype._move=function(C,z){return{}},En.prototype.mousedown=function(C,z){if(!this._lastPoint){var F=t.mouseButton(C);this._correctButton(C,F)&&(this._lastPoint=z,this._eventButton=F)}},En.prototype.mousemoveWindow=function(C,z){var F=this._lastPoint;if(F&&(C.preventDefault(),this._moved||!(z.dist(F)<this._clickTolerance)))return this._moved=!0,this._lastPoint=z,this._move(F,z)},En.prototype.mouseupWindow=function(C){t.mouseButton(C)===this._eventButton&&(this._moved&&t.suppressClick(),this.reset())},En.prototype.enable=function(){this._enabled=!0},En.prototype.disable=function(){this._enabled=!1,this.reset()},En.prototype.isEnabled=function(){return this._enabled},En.prototype.isActive=function(){return this._active};var Ra=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.mousedown=function(F,q){C.prototype.mousedown.call(this,F,q),this._lastPoint&&(this._active=!0)},z.prototype._correctButton=function(F,q){return q===0&&!F.ctrlKey},z.prototype._move=function(F,q){return{around:q,panDelta:q.sub(F)}},z}(En),Ca=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype._correctButton=function(F,q){return q===0&&F.ctrlKey||q===2},z.prototype._move=function(F,q){var ie=.8*(q.x-F.x);if(ie)return this._active=!0,{bearingDelta:ie}},z.prototype.contextmenu=function(F){F.preventDefault()},z}(En),ga=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype._correctButton=function(F,q){return q===0&&F.ctrlKey||q===2},z.prototype._move=function(F,q){var ie=-.5*(q.y-F.y);if(ie)return this._active=!0,{pitchDelta:ie}},z.prototype.contextmenu=function(F){F.preventDefault()},z}(En),Fa=function(C){this._minTouches=1,this._clickTolerance=C.clickTolerance||1,this.reset()};Fa.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},Fa.prototype.touchstart=function(C,z,F){return this._calculateTransform(C,z,F)},Fa.prototype.touchmove=function(C,z,F){if(this._active)return C.preventDefault(),this._calculateTransform(C,z,F)},Fa.prototype.touchend=function(C,z,F){this._calculateTransform(C,z,F),this._active&&F.length<this._minTouches&&this.reset()},Fa.prototype.touchcancel=function(){this.reset()},Fa.prototype._calculateTransform=function(C,z,F){F.length>0&&(this._active=!0);var q=Un(F,z),ie=new e.Point(0,0),ue=new e.Point(0,0),ge=0;for(var we in q){var Se=q[we],Ve=this._touches[we];Ve&&(ie._add(Se),ue._add(Se.sub(Ve)),ge++,q[we]=Se)}if(this._touches=q,!(ge<this._minTouches)&&ue.mag()){var Je=ue.div(ge);if(this._sum._add(Je),!(this._sum.mag()<this._clickTolerance))return{around:ie.div(ge),panDelta:Je}}},Fa.prototype.enable=function(){this._enabled=!0},Fa.prototype.disable=function(){this._enabled=!1,this.reset()},Fa.prototype.isEnabled=function(){return this._enabled},Fa.prototype.isActive=function(){return this._active};var Ea=function(){this.reset()};function ri(C,z,F){for(var q=0;q<C.length;q++)if(C[q].identifier===F)return z[q]}Ea.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ea.prototype._start=function(C){},Ea.prototype._move=function(C,z,F){return{}},Ea.prototype.touchstart=function(C,z,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([z[0],z[1]]))},Ea.prototype.touchmove=function(C,z,F){if(this._firstTwoTouches){C.preventDefault();var q=this._firstTwoTouches,ie=q[0],ue=q[1],ge=ri(F,z,ie),we=ri(F,z,ue);if(ge&&we){var Se=this._aroundCenter?null:ge.add(we).div(2);return this._move([ge,we],Se,C)}}},Ea.prototype.touchend=function(C,z,F){if(this._firstTwoTouches){var q=this._firstTwoTouches,ie=q[0],ue=q[1],ge=ri(F,z,ie),we=ri(F,z,ue);ge&&we||(this._active&&t.suppressClick(),this.reset())}},Ea.prototype.touchcancel=function(){this.reset()},Ea.prototype.enable=function(C){this._enabled=!0,this._aroundCenter=!!C&&C.around==="center"},Ea.prototype.disable=function(){this._enabled=!1,this.reset()},Ea.prototype.isEnabled=function(){return this._enabled},Ea.prototype.isActive=function(){return this._active};function aa(C,z){return Math.log(C/z)/Math.LN2}var Ka=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.reset=function(){C.prototype.reset.call(this),delete this._distance,delete this._startDistance},z.prototype._start=function(F){this._startDistance=this._distance=F[0].dist(F[1])},z.prototype._move=function(F,q){var ie=this._distance;if(this._distance=F[0].dist(F[1]),this._active||!(Math.abs(aa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:aa(this._distance,ie),pinchAround:q}},z}(Ea);function Hi(C,z){return 180*C.angleWith(z)/Math.PI}var Qo=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.reset=function(){C.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},z.prototype._start=function(F){this._startVector=this._vector=F[0].sub(F[1]),this._minDiameter=F[0].dist(F[1])},z.prototype._move=function(F,q){var ie=this._vector;if(this._vector=F[0].sub(F[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Hi(this._vector,ie),pinchAround:q}},z.prototype._isBelowThreshold=function(F){this._minDiameter=Math.min(this._minDiameter,F.mag());var q=25/(Math.PI*this._minDiameter)*360,ie=Hi(F,this._startVector);return Math.abs(ie)<q},z}(Ea);function jo(C){return Math.abs(C.y)>Math.abs(C.x)}var To=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.reset=function(){C.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},z.prototype._start=function(F){this._lastPoints=F,jo(F[0].sub(F[1]))&&(this._valid=!1)},z.prototype._move=function(F,q,ie){var ue=F[0].sub(this._lastPoints[0]),ge=F[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(ue,ge,ie.timeStamp),this._valid)return this._lastPoints=F,this._active=!0,{pitchDelta:-.5*((ue.y+ge.y)/2)}},z.prototype.gestureBeginsVertically=function(F,q,ie){if(this._valid!==void 0)return this._valid;var ue=F.mag()>=2,ge=q.mag()>=2;if(ue||ge){if(!ue||!ge)return this._firstMove===void 0&&(this._firstMove=ie),ie-this._firstMove<100&&void 0;var we=F.y>0==q.y>0;return jo(F)&&jo(q)&&we}},z}(Ea),xa={panStep:100,bearingStep:15,pitchStep:10},xi=function(){var C=xa;this._panStep=C.panStep,this._bearingStep=C.bearingStep,this._pitchStep=C.pitchStep};function ko(C){return C*(2-C)}xi.prototype.reset=function(){this._active=!1},xi.prototype.keydown=function(C){var z=this;if(!(C.altKey||C.ctrlKey||C.metaKey)){var F=0,q=0,ie=0,ue=0,ge=0;switch(C.keyCode){case 61:case 107:case 171:case 187:F=1;break;case 189:case 109:case 173:F=-1;break;case 37:C.shiftKey?q=-1:(C.preventDefault(),ue=-1);break;case 39:C.shiftKey?q=1:(C.preventDefault(),ue=1);break;case 38:C.shiftKey?ie=1:(C.preventDefault(),ge=-1);break;case 40:C.shiftKey?ie=-1:(C.preventDefault(),ge=1);break;default:return}return{cameraAnimation:function(we){var Se=we.getZoom();we.easeTo({duration:300,easeId:"keyboardHandler",easing:ko,zoom:F?Math.round(Se)+F*(C.shiftKey?2:1):Se,bearing:we.getBearing()+q*z._bearingStep,pitch:we.getPitch()+ie*z._pitchStep,offset:[-ue*z._panStep,-ge*z._panStep],center:we.getCenter()},{originalEvent:C})}}}},xi.prototype.enable=function(){this._enabled=!0},xi.prototype.disable=function(){this._enabled=!1,this.reset()},xi.prototype.isEnabled=function(){return this._enabled},xi.prototype.isActive=function(){return this._active};var Qa=function(C,z){this._map=C,this._el=C.getCanvasContainer(),this._handler=z,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Qa.prototype.setZoomRate=function(C){this._defaultZoomRate=C},Qa.prototype.setWheelZoomRate=function(C){this._wheelZoomRate=C},Qa.prototype.isEnabled=function(){return!!this._enabled},Qa.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Qa.prototype.isZooming=function(){return!!this._zooming},Qa.prototype.enable=function(C){this.isEnabled()||(this._enabled=!0,this._aroundCenter=C&&C.around==="center")},Qa.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Qa.prototype.wheel=function(C){if(this.isEnabled()){var z=C.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*C.deltaY:C.deltaY,F=e.browser.now(),q=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,z!==0&&z%4.000244140625==0?this._type="wheel":z!==0&&Math.abs(z)<4?this._type="trackpad":q>400?(this._type=null,this._lastValue=z,this._timeout=setTimeout(this._onTimeout,40,C)):this._type||(this._type=Math.abs(q*z)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,z+=this._lastValue)),C.shiftKey&&z&&(z/=4),this._type&&(this._lastWheelEvent=C,this._delta-=z,this._active||this._start(C)),C.preventDefault()}},Qa.prototype._onTimeout=function(C){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(C)},Qa.prototype._start=function(C){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var z=t.mousePos(this._el,C);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(z)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Qa.prototype.renderFrame=function(){return this._onScrollFrame()},Qa.prototype._onScrollFrame=function(){var C=this;if(this._frameId&&(this._frameId=null,this.isActive())){var z=this._map.transform;if(this._delta!==0){var F=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,q=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&q!==0&&(q=1/q);var ie=typeof this._targetZoom=="number"?z.zoomScale(this._targetZoom):z.scale;this._targetZoom=Math.min(z.maxZoom,Math.max(z.minZoom,z.scaleZoom(ie*q))),this._type==="wheel"&&(this._startZoom=z.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var ue,ge=typeof this._targetZoom=="number"?this._targetZoom:z.zoom,we=this._startZoom,Se=this._easing,Ve=!1;if(this._type==="wheel"&&we&&Se){var Je=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),at=Se(Je);ue=e.number(we,ge,at),Je<1?this._frameId||(this._frameId=!0):Ve=!0}else ue=ge,Ve=!0;return this._active=!0,Ve&&(this._active=!1,this._finishTimeout=setTimeout(function(){C._zooming=!1,C._handler._triggerRenderFrame(),delete C._targetZoom,delete C._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ve,zoomDelta:ue-z.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Qa.prototype._smoothOutEasing=function(C){var z=e.ease;if(this._prevEase){var F=this._prevEase,q=(e.browser.now()-F.start)/F.duration,ie=F.easing(q+.01)-F.easing(q),ue=.27/Math.sqrt(ie*ie+1e-4)*.01,ge=Math.sqrt(.0729-ue*ue);z=e.bezier(ue,ge,.25,1)}return this._prevEase={start:e.browser.now(),duration:C,easing:z},z},Qa.prototype.reset=function(){this._active=!1};var Si=function(C,z){this._clickZoom=C,this._tapZoom=z};Si.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Si.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Si.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Si.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Xi=function(){this.reset()};Xi.prototype.reset=function(){this._active=!1},Xi.prototype.dblclick=function(C,z){return C.preventDefault(),{cameraAnimation:function(F){F.easeTo({duration:300,zoom:F.getZoom()+(C.shiftKey?-1:1),around:F.unproject(z)},{originalEvent:C})}}},Xi.prototype.enable=function(){this._enabled=!0},Xi.prototype.disable=function(){this._enabled=!1,this.reset()},Xi.prototype.isEnabled=function(){return this._enabled},Xi.prototype.isActive=function(){return this._active};var ai=function(){this._tap=new ka({numTouches:1,numTaps:1}),this.reset()};ai.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ai.prototype.touchstart=function(C,z,F){this._swipePoint||(this._tapTime&&C.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?F.length>0&&(this._swipePoint=z[0],this._swipeTouch=F[0].identifier):this._tap.touchstart(C,z,F))},ai.prototype.touchmove=function(C,z,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;var q=z[0],ie=q.y-this._swipePoint.y;return this._swipePoint=q,C.preventDefault(),this._active=!0,{zoomDelta:ie/128}}}else this._tap.touchmove(C,z,F)},ai.prototype.touchend=function(C,z,F){this._tapTime?this._swipePoint&&F.length===0&&this.reset():this._tap.touchend(C,z,F)&&(this._tapTime=C.timeStamp)},ai.prototype.touchcancel=function(){this.reset()},ai.prototype.enable=function(){this._enabled=!0},ai.prototype.disable=function(){this._enabled=!1,this.reset()},ai.prototype.isEnabled=function(){return this._enabled},ai.prototype.isActive=function(){return this._active};var vo=function(C,z,F){this._el=C,this._mousePan=z,this._touchPan=F};vo.prototype.enable=function(C){this._inertiaOptions=C||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},vo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},vo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},vo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ii=function(C,z,F){this._pitchWithRotate=C.pitchWithRotate,this._mouseRotate=z,this._mousePitch=F};ii.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ii.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ii.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ii.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var oo=function(C,z,F,q){this._el=C,this._touchZoom=z,this._touchRotate=F,this._tapDragZoom=q,this._rotationDisabled=!1,this._enabled=!0};oo.prototype.enable=function(C){this._touchZoom.enable(C),this._rotationDisabled||this._touchRotate.enable(C),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},oo.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},oo.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},oo.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},oo.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},oo.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var fs=function(C){return C.zoom||C.drag||C.pitch||C.rotate},as=function(C){function z(){C.apply(this,arguments)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z}(e.Event);function qs(C){return C.panDelta&&C.panDelta.mag()||C.zoomDelta||C.bearingDelta||C.pitchDelta}var Bi=function(C,z){this._map=C,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Tn(C),this._bearingSnap=z.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(z),e.bindAll(["handleEvent","handleWindowEvent"],this);var F=this._el;this._listeners=[[F,"touchstart",{passive:!1}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[e.window,"blur",void 0]];for(var q=0,ie=this._listeners;q<ie.length;q+=1){var ue=ie[q],ge=ue[0],we=ue[1],Se=ue[2];t.addEventListener(ge,we,ge===e.window.document?this.handleWindowEvent:this.handleEvent,Se)}};Bi.prototype.destroy=function(){for(var C=0,z=this._listeners;C<z.length;C+=1){var F=z[C],q=F[0],ie=F[1],ue=F[2];t.removeEventListener(q,ie,q===e.window.document?this.handleWindowEvent:this.handleEvent,ue)}},Bi.prototype._addDefaultHandlers=function(C){var z=this._map,F=z.getCanvasContainer();this._add("mapEvent",new Kr(z,C));var q=z.boxZoom=new Pn(z,C);this._add("boxZoom",q);var ie=new Pa,ue=new Xi;z.doubleClickZoom=new Si(ue,ie),this._add("tapZoom",ie),this._add("clickZoom",ue);var ge=new ai;this._add("tapDragZoom",ge);var we=z.touchPitch=new To;this._add("touchPitch",we);var Se=new Ca(C),Ve=new ga(C);z.dragRotate=new ii(C,Se,Ve),this._add("mouseRotate",Se,["mousePitch"]),this._add("mousePitch",Ve,["mouseRotate"]);var Je=new Ra(C),at=new Fa(C);z.dragPan=new vo(F,Je,at),this._add("mousePan",Je),this._add("touchPan",at,["touchZoom","touchRotate"]);var bt=new Qo,Et=new Ka;z.touchZoomRotate=new oo(F,Et,bt,ge),this._add("touchRotate",bt,["touchPan","touchZoom"]),this._add("touchZoom",Et,["touchPan","touchRotate"]);var kt=z.scrollZoom=new Qa(z,this);this._add("scrollZoom",kt,["mousePan"]);var At=z.keyboard=new xi;this._add("keyboard",At),this._add("blockableMapEvent",new na(z));for(var xt=0,zt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];xt<zt.length;xt+=1){var It=zt[xt];C.interactive&&C[It]&&z[It].enable(C[It])}},Bi.prototype._add=function(C,z,F){this._handlers.push({handlerName:C,handler:z,allowed:F}),this._handlersById[C]=z},Bi.prototype.stop=function(){if(!this._updatingCamera){for(var C=0,z=this._handlers;C<z.length;C+=1)z[C].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Bi.prototype.isActive=function(){for(var C=0,z=this._handlers;C<z.length;C+=1)if(z[C].handler.isActive())return!0;return!1},Bi.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Bi.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Bi.prototype.isMoving=function(){return Boolean(fs(this._eventsInProgress))||this.isZooming()},Bi.prototype._blockedByActive=function(C,z,F){for(var q in C)if(q!==F&&(!z||z.indexOf(q)<0))return!0;return!1},Bi.prototype.handleWindowEvent=function(C){this.handleEvent(C,C.type+"Window")},Bi.prototype._getMapTouches=function(C){for(var z=[],F=0,q=C;F<q.length;F+=1){var ie=q[F],ue=ie.target;this._el.contains(ue)&&z.push(ie)}return z},Bi.prototype.handleEvent=function(C,z){if(C.type!=="blur"){this._updatingCamera=!0;for(var F=C.type==="renderFrame"?void 0:C,q={needsRenderFrame:!1},ie={},ue={},ge=C.touches?this._getMapTouches(C.touches):void 0,we=ge?t.touchPos(this._el,ge):t.mousePos(this._el,C),Se=0,Ve=this._handlers;Se<Ve.length;Se+=1){var Je=Ve[Se],at=Je.handlerName,bt=Je.handler,Et=Je.allowed;if(bt.isEnabled()){var kt=void 0;this._blockedByActive(ue,Et,at)?bt.reset():bt[z||C.type]&&(kt=bt[z||C.type](C,we,ge),this.mergeHandlerResult(q,ie,kt,at,F),kt&&kt.needsRenderFrame&&this._triggerRenderFrame()),(kt||bt.isActive())&&(ue[at]=bt)}}var At={};for(var xt in this._previousActiveHandlers)ue[xt]||(At[xt]=F);this._previousActiveHandlers=ue,(Object.keys(At).length||qs(q))&&(this._changes.push([q,ie,At]),this._triggerRenderFrame()),(Object.keys(ue).length||qs(q))&&this._map._stop(!0),this._updatingCamera=!1;var zt=q.cameraAnimation;zt&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],zt(this._map))}else this.stop()},Bi.prototype.mergeHandlerResult=function(C,z,F,q,ie){if(F){e.extend(C,F);var ue={handlerName:q,originalEvent:F.originalEvent||ie};F.zoomDelta!==void 0&&(z.zoom=ue),F.panDelta!==void 0&&(z.drag=ue),F.pitchDelta!==void 0&&(z.pitch=ue),F.bearingDelta!==void 0&&(z.rotate=ue)}},Bi.prototype._applyChanges=function(){for(var C={},z={},F={},q=0,ie=this._changes;q<ie.length;q+=1){var ue=ie[q],ge=ue[0],we=ue[1],Se=ue[2];ge.panDelta&&(C.panDelta=(C.panDelta||new e.Point(0,0))._add(ge.panDelta)),ge.zoomDelta&&(C.zoomDelta=(C.zoomDelta||0)+ge.zoomDelta),ge.bearingDelta&&(C.bearingDelta=(C.bearingDelta||0)+ge.bearingDelta),ge.pitchDelta&&(C.pitchDelta=(C.pitchDelta||0)+ge.pitchDelta),ge.around!==void 0&&(C.around=ge.around),ge.pinchAround!==void 0&&(C.pinchAround=ge.pinchAround),ge.noInertia&&(C.noInertia=ge.noInertia),e.extend(z,we),e.extend(F,Se)}this._updateMapTransform(C,z,F),this._changes=[]},Bi.prototype._updateMapTransform=function(C,z,F){var q=this._map,ie=q.transform;if(!qs(C))return this._fireEvents(z,F);var ue=C.panDelta,ge=C.zoomDelta,we=C.bearingDelta,Se=C.pitchDelta,Ve=C.around,Je=C.pinchAround;Je!==void 0&&(Ve=Je),q._stop(!0),Ve=Ve||q.transform.centerPoint;var at=ie.pointLocation(ue?Ve.sub(ue):Ve);we&&(ie.bearing+=we),Se&&(ie.pitch+=Se),ge&&(ie.zoom+=ge),ie.setLocationAtPoint(at,Ve),this._map._update(),C.noInertia||this._inertia.record(C),this._fireEvents(z,F)},Bi.prototype._fireEvents=function(C,z){var F=this,q=fs(this._eventsInProgress),ie=fs(C),ue={};for(var ge in C){var we=C[ge].originalEvent;this._eventsInProgress[ge]||(ue[ge+"start"]=we),this._eventsInProgress[ge]=C[ge]}for(var Se in!q&&ie&&this._fireEvent("movestart",ie.originalEvent),ue)this._fireEvent(Se,ue[Se]);for(var Ve in C.rotate&&(this._bearingChanged=!0),ie&&this._fireEvent("move",ie.originalEvent),C){var Je=C[Ve].originalEvent;this._fireEvent(Ve,Je)}var at,bt={};for(var Et in this._eventsInProgress){var kt=this._eventsInProgress[Et],At=kt.handlerName,xt=kt.originalEvent;this._handlersById[At].isActive()||(delete this._eventsInProgress[Et],at=z[At]||xt,bt[Et+"end"]=at)}for(var zt in bt)this._fireEvent(zt,bt[zt]);var It=fs(this._eventsInProgress);if((q||ie)&&!It){this._updatingCamera=!0;var Bt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),nr=function(gr){return gr!==0&&-F._bearingSnap<gr&&gr<F._bearingSnap};Bt?(nr(Bt.bearing||this._map.getBearing())&&(Bt.bearing=0),this._map.easeTo(Bt,{originalEvent:at})):(this._map.fire(new e.Event("moveend",{originalEvent:at})),nr(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Bi.prototype._fireEvent=function(C,z){this._map.fire(new e.Event(C,z?{originalEvent:z}:{}))},Bi.prototype._triggerRenderFrame=function(){var C=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(z){delete C._frameId,C.handleEvent(new as("renderFrame",{timeStamp:z})),C._applyChanges()}))};var Gs=function(C){function z(F,q){C.call(this),this._moving=!1,this._zooming=!1,this.transform=F,this._bearingSnap=q.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},z.prototype.setCenter=function(F,q){return this.jumpTo({center:F},q)},z.prototype.panBy=function(F,q,ie){return F=e.Point.convert(F).mult(-1),this.panTo(this.transform.center,e.extend({offset:F},q),ie)},z.prototype.panTo=function(F,q,ie){return this.easeTo(e.extend({center:F},q),ie)},z.prototype.getZoom=function(){return this.transform.zoom},z.prototype.setZoom=function(F,q){return this.jumpTo({zoom:F},q),this},z.prototype.zoomTo=function(F,q,ie){return this.easeTo(e.extend({zoom:F},q),ie)},z.prototype.zoomIn=function(F,q){return this.zoomTo(this.getZoom()+1,F,q),this},z.prototype.zoomOut=function(F,q){return this.zoomTo(this.getZoom()-1,F,q),this},z.prototype.getBearing=function(){return this.transform.bearing},z.prototype.setBearing=function(F,q){return this.jumpTo({bearing:F},q),this},z.prototype.getPadding=function(){return this.transform.padding},z.prototype.setPadding=function(F,q){return this.jumpTo({padding:F},q),this},z.prototype.rotateTo=function(F,q,ie){return this.easeTo(e.extend({bearing:F},q),ie)},z.prototype.resetNorth=function(F,q){return this.rotateTo(0,e.extend({duration:1e3},F),q),this},z.prototype.resetNorthPitch=function(F,q){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},F),q),this},z.prototype.snapToNorth=function(F,q){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(F,q):this},z.prototype.getPitch=function(){return this.transform.pitch},z.prototype.setPitch=function(F,q){return this.jumpTo({pitch:F},q),this},z.prototype.cameraForBounds=function(F,q){return F=e.LngLatBounds.convert(F),this._cameraForBoxAndBearing(F.getNorthWest(),F.getSouthEast(),0,q)},z.prototype._cameraForBoxAndBearing=function(F,q,ie,ue){var ge={top:0,bottom:0,right:0,left:0};if(typeof(ue=e.extend({padding:ge,offset:[0,0],maxZoom:this.transform.maxZoom},ue)).padding=="number"){var we=ue.padding;ue.padding={top:we,bottom:we,right:we,left:we}}ue.padding=e.extend(ge,ue.padding);var Se=this.transform,Ve=Se.padding,Je=Se.project(e.LngLat.convert(F)),at=Se.project(e.LngLat.convert(q)),bt=Je.rotate(-ie*Math.PI/180),Et=at.rotate(-ie*Math.PI/180),kt=new e.Point(Math.max(bt.x,Et.x),Math.max(bt.y,Et.y)),At=new e.Point(Math.min(bt.x,Et.x),Math.min(bt.y,Et.y)),xt=kt.sub(At),zt=(Se.width-(Ve.left+Ve.right+ue.padding.left+ue.padding.right))/xt.x,It=(Se.height-(Ve.top+Ve.bottom+ue.padding.top+ue.padding.bottom))/xt.y;if(!(It<0||zt<0)){var Bt=Math.min(Se.scaleZoom(Se.scale*Math.min(zt,It)),ue.maxZoom),nr=e.Point.convert(ue.offset),gr=(ue.padding.left-ue.padding.right)/2,Lr=(ue.padding.top-ue.padding.bottom)/2,Sr=new e.Point(nr.x+gr,nr.y+Lr).mult(Se.scale/Se.zoomScale(Bt));return{center:Se.unproject(Je.add(at).div(2).sub(Sr)),zoom:Bt,bearing:ie}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},z.prototype.fitBounds=function(F,q,ie){return this._fitInternal(this.cameraForBounds(F,q),q,ie)},z.prototype.fitScreenCoordinates=function(F,q,ie,ue,ge){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(F)),this.transform.pointLocation(e.Point.convert(q)),ie,ue),ue,ge)},z.prototype._fitInternal=function(F,q,ie){return F?(delete(q=e.extend(F,q)).padding,q.linear?this.easeTo(q,ie):this.flyTo(q,ie)):this},z.prototype.jumpTo=function(F,q){this.stop();var ie=this.transform,ue=!1,ge=!1,we=!1;return"zoom"in F&&ie.zoom!==+F.zoom&&(ue=!0,ie.zoom=+F.zoom),F.center!==void 0&&(ie.center=e.LngLat.convert(F.center)),"bearing"in F&&ie.bearing!==+F.bearing&&(ge=!0,ie.bearing=+F.bearing),"pitch"in F&&ie.pitch!==+F.pitch&&(we=!0,ie.pitch=+F.pitch),F.padding==null||ie.isPaddingEqual(F.padding)||(ie.padding=F.padding),this.fire(new e.Event("movestart",q)).fire(new e.Event("move",q)),ue&&this.fire(new e.Event("zoomstart",q)).fire(new e.Event("zoom",q)).fire(new e.Event("zoomend",q)),ge&&this.fire(new e.Event("rotatestart",q)).fire(new e.Event("rotate",q)).fire(new e.Event("rotateend",q)),we&&this.fire(new e.Event("pitchstart",q)).fire(new e.Event("pitch",q)).fire(new e.Event("pitchend",q)),this.fire(new e.Event("moveend",q))},z.prototype.easeTo=function(F,q){var ie=this;this._stop(!1,F.easeId),((F=e.extend({offset:[0,0],duration:500,easing:e.ease},F)).animate===!1||!F.essential&&e.browser.prefersReducedMotion)&&(F.duration=0);var ue=this.transform,ge=this.getZoom(),we=this.getBearing(),Se=this.getPitch(),Ve=this.getPadding(),Je="zoom"in F?+F.zoom:ge,at="bearing"in F?this._normalizeBearing(F.bearing,we):we,bt="pitch"in F?+F.pitch:Se,Et="padding"in F?F.padding:ue.padding,kt=e.Point.convert(F.offset),At=ue.centerPoint.add(kt),xt=ue.pointLocation(At),zt=e.LngLat.convert(F.center||xt);this._normalizeCenter(zt);var It,Bt,nr=ue.project(xt),gr=ue.project(zt).sub(nr),Lr=ue.zoomScale(Je-ge);F.around&&(It=e.LngLat.convert(F.around),Bt=ue.locationPoint(It));var Sr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Je!==ge,this._rotating=this._rotating||we!==at,this._pitching=this._pitching||bt!==Se,this._padding=!ue.isPaddingEqual(Et),this._easeId=F.easeId,this._prepareEase(q,F.noMoveStart,Sr),clearTimeout(this._easeEndTimeoutID),this._ease(function($r){if(ie._zooming&&(ue.zoom=e.number(ge,Je,$r)),ie._rotating&&(ue.bearing=e.number(we,at,$r)),ie._pitching&&(ue.pitch=e.number(Se,bt,$r)),ie._padding&&(ue.interpolatePadding(Ve,Et,$r),At=ue.centerPoint.add(kt)),It)ue.setLocationAtPoint(It,Bt);else{var Qr=ue.zoomScale(ue.zoom-ge),fn=Je>ge?Math.min(2,Lr):Math.max(.5,Lr),sn=Math.pow(fn,1-$r),Vn=ue.unproject(nr.add(gr.mult($r*sn)).mult(Qr));ue.setLocationAtPoint(ue.renderWorldCopies?Vn.wrap():Vn,At)}ie._fireMoveEvents(q)},function($r){ie._afterEase(q,$r)},F),this},z.prototype._prepareEase=function(F,q,ie){ie===void 0&&(ie={}),this._moving=!0,q||ie.moving||this.fire(new e.Event("movestart",F)),this._zooming&&!ie.zooming&&this.fire(new e.Event("zoomstart",F)),this._rotating&&!ie.rotating&&this.fire(new e.Event("rotatestart",F)),this._pitching&&!ie.pitching&&this.fire(new e.Event("pitchstart",F))},z.prototype._fireMoveEvents=function(F){this.fire(new e.Event("move",F)),this._zooming&&this.fire(new e.Event("zoom",F)),this._rotating&&this.fire(new e.Event("rotate",F)),this._pitching&&this.fire(new e.Event("pitch",F))},z.prototype._afterEase=function(F,q){if(!this._easeId||!q||this._easeId!==q){delete this._easeId;var ie=this._zooming,ue=this._rotating,ge=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,ie&&this.fire(new e.Event("zoomend",F)),ue&&this.fire(new e.Event("rotateend",F)),ge&&this.fire(new e.Event("pitchend",F)),this.fire(new e.Event("moveend",F))}},z.prototype.flyTo=function(F,q){var ie=this;if(!F.essential&&e.browser.prefersReducedMotion){var ue=e.pick(F,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ue,q)}this.stop(),F=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},F);var ge=this.transform,we=this.getZoom(),Se=this.getBearing(),Ve=this.getPitch(),Je=this.getPadding(),at="zoom"in F?e.clamp(+F.zoom,ge.minZoom,ge.maxZoom):we,bt="bearing"in F?this._normalizeBearing(F.bearing,Se):Se,Et="pitch"in F?+F.pitch:Ve,kt="padding"in F?F.padding:ge.padding,At=ge.zoomScale(at-we),xt=e.Point.convert(F.offset),zt=ge.centerPoint.add(xt),It=ge.pointLocation(zt),Bt=e.LngLat.convert(F.center||It);this._normalizeCenter(Bt);var nr=ge.project(It),gr=ge.project(Bt).sub(nr),Lr=F.curve,Sr=Math.max(ge.width,ge.height),$r=Sr/At,Qr=gr.mag();if("minZoom"in F){var fn=e.clamp(Math.min(F.minZoom,we,at),ge.minZoom,ge.maxZoom),sn=Sr/ge.zoomScale(fn-we);Lr=Math.sqrt(sn/Qr*2)}var Vn=Lr*Lr;function Jn(ta){var _a=($r*$r-Sr*Sr+(ta?-1:1)*Vn*Vn*Qr*Qr)/(2*(ta?$r:Sr)*Vn*Qr);return Math.log(Math.sqrt(_a*_a+1)-_a)}function ha(ta){return(Math.exp(ta)-Math.exp(-ta))/2}function Wr(ta){return(Math.exp(ta)+Math.exp(-ta))/2}var Mn=Jn(0),Kn=function(ta){return Wr(Mn)/Wr(Mn+Lr*ta)},Yn=function(ta){return Sr*((Wr(Mn)*(ha(_a=Mn+Lr*ta)/Wr(_a))-ha(Mn))/Vn)/Qr;var _a},ia=(Jn(1)-Mn)/Lr;if(Math.abs(Qr)<1e-6||!isFinite(ia)){if(Math.abs(Sr-$r)<1e-6)return this.easeTo(F,q);var da=$r<Sr?-1:1;ia=Math.abs(Math.log($r/Sr))/Lr,Yn=function(){return 0},Kn=function(ta){return Math.exp(da*Lr*ta)}}if("duration"in F)F.duration=+F.duration;else{var La="screenSpeed"in F?+F.screenSpeed/Lr:+F.speed;F.duration=1e3*ia/La}return F.maxDuration&&F.duration>F.maxDuration&&(F.duration=0),this._zooming=!0,this._rotating=Se!==bt,this._pitching=Et!==Ve,this._padding=!ge.isPaddingEqual(kt),this._prepareEase(q,!1),this._ease(function(ta){var _a=ta*ia,ya=1/Kn(_a);ge.zoom=ta===1?at:we+ge.scaleZoom(ya),ie._rotating&&(ge.bearing=e.number(Se,bt,ta)),ie._pitching&&(ge.pitch=e.number(Ve,Et,ta)),ie._padding&&(ge.interpolatePadding(Je,kt,ta),zt=ge.centerPoint.add(xt));var Ia=ta===1?Bt:ge.unproject(nr.add(gr.mult(Yn(_a))).mult(ya));ge.setLocationAtPoint(ge.renderWorldCopies?Ia.wrap():Ia,zt),ie._fireMoveEvents(q)},function(){return ie._afterEase(q)},F),this},z.prototype.isEasing=function(){return!!this._easeFrameId},z.prototype.stop=function(){return this._stop()},z.prototype._stop=function(F,q){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var ie=this._onEaseEnd;delete this._onEaseEnd,ie.call(this,q)}if(!F){var ue=this.handlers;ue&&ue.stop()}return this},z.prototype._ease=function(F,q,ie){ie.animate===!1||ie.duration===0?(F(1),q()):(this._easeStart=e.browser.now(),this._easeOptions=ie,this._onEaseFrame=F,this._onEaseEnd=q,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},z.prototype._renderFrameCallback=function(){var F=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},z.prototype._normalizeBearing=function(F,q){F=e.wrap(F,-180,180);var ie=Math.abs(F-q);return Math.abs(F-360-q)<ie&&(F-=360),Math.abs(F+360-q)<ie&&(F+=360),F},z.prototype._normalizeCenter=function(F){var q=this.transform;if(q.renderWorldCopies&&!q.lngRange){var ie=F.lng-q.center.lng;F.lng+=ie>180?-360:ie<-180?360:0}},z}(e.Evented),Ni=function(C){C===void 0&&(C={}),this.options=C,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Ni.prototype.getDefaultPosition=function(){return"bottom-right"},Ni.prototype.onAdd=function(C){var z=this.options&&this.options.compact;return this._map=C,this._container=t.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=t.create("div","mapboxgl-ctrl-attrib-inner",this._container),z&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),z===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ni.prototype.onRemove=function(){t.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ni.prototype._updateEditLink=function(){var C=this._editLink;C||(C=this._editLink=this._container.querySelector(".mapbox-improve-map"));var z=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(C){var F=z.reduce(function(q,ie,ue){return ie.value&&(q+=ie.key+"="+ie.value+(ue<z.length-1?"&":"")),q},"?");C.href=e.config.FEEDBACK_URL+"/"+F+(this._map._hash?this._map._hash.getHashString(!0):""),C.rel="noopener nofollow"}},Ni.prototype._updateData=function(C){!C||C.sourceDataType!=="metadata"&&C.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Ni.prototype._updateAttributions=function(){if(this._map.style){var C=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?C=C.concat(this.options.customAttribution.map(function(we){return typeof we!="string"?"":we})):typeof this.options.customAttribution=="string"&&C.push(this.options.customAttribution)),this._map.style.stylesheet){var z=this._map.style.stylesheet;this.styleOwner=z.owner,this.styleId=z.id}var F=this._map.style.sourceCaches;for(var q in F){var ie=F[q];if(ie.used){var ue=ie.getSource();ue.attribution&&C.indexOf(ue.attribution)<0&&C.push(ue.attribution)}}C.sort(function(we,Se){return we.length-Se.length});var ge=(C=C.filter(function(we,Se){for(var Ve=Se+1;Ve<C.length;Ve++)if(C[Ve].indexOf(we)>=0)return!1;return!0})).join(" | ");ge!==this._attribHTML&&(this._attribHTML=ge,C.length?(this._innerContainer.innerHTML=ge,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ni.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var is=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};is.prototype.onAdd=function(C){this._map=C,this._container=t.create("div","mapboxgl-ctrl");var z=t.create("a","mapboxgl-ctrl-logo");return z.target="_blank",z.rel="noopener nofollow",z.href="https://www.mapbox.com/",z.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),z.setAttribute("rel","noopener nofollow"),this._container.appendChild(z),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},is.prototype.onRemove=function(){t.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},is.prototype.getDefaultPosition=function(){return"bottom-left"},is.prototype._updateLogo=function(C){C&&C.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},is.prototype._logoRequired=function(){if(this._map.style){var C=this._map.style.sourceCaches;for(var z in C)if(C[z].getSource().mapbox_logo)return!0;return!1}},is.prototype._updateCompact=function(){var C=this._container.children;if(C.length){var z=C[0];this._map.getCanvasContainer().offsetWidth<250?z.classList.add("mapboxgl-compact"):z.classList.remove("mapboxgl-compact")}};var fa=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};fa.prototype.add=function(C){var z=++this._id;return this._queue.push({callback:C,id:z,cancelled:!1}),z},fa.prototype.remove=function(C){for(var z=this._currentlyRunning,F=0,q=z?this._queue.concat(z):this._queue;F<q.length;F+=1){var ie=q[F];if(ie.id===C)return void(ie.cancelled=!0)}},fa.prototype.run=function(C){C===void 0&&(C=0);var z=this._currentlyRunning=this._queue;this._queue=[];for(var F=0,q=z;F<q.length;F+=1){var ie=q[F];if(!ie.cancelled&&(ie.callback(C),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},fa.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ba={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Ys=e.window.HTMLImageElement,Ws=e.window.HTMLElement,os=e.window.ImageBitmap,Ro={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Zo=function(C){function z(q){var ie=this;if((q=e.extend({},Ro,q)).minZoom!=null&&q.maxZoom!=null&&q.minZoom>q.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(q.minPitch!=null&&q.maxPitch!=null&&q.minPitch>q.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(q.minPitch!=null&&q.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(q.maxPitch!=null&&q.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var ue=new Ut(q.minZoom,q.maxZoom,q.minPitch,q.maxPitch,q.renderWorldCopies);if(C.call(this,ue,q),this._interactive=q.interactive,this._maxTileCacheSize=q.maxTileCacheSize,this._failIfMajorPerformanceCaveat=q.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=q.preserveDrawingBuffer,this._antialias=q.antialias,this._trackResize=q.trackResize,this._bearingSnap=q.bearingSnap,this._refreshExpiredTiles=q.refreshExpiredTiles,this._fadeDuration=q.fadeDuration,this._crossSourceCollisions=q.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=q.collectResourceTiming,this._renderTaskQueue=new fa,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},ba,q.locale),this._requestManager=new e.RequestManager(q.transformRequest,q.accessToken),typeof q.container=="string"){if(this._container=e.window.document.getElementById(q.container),!this._container)throw new Error("Container '"+q.container+"' not found.")}else{if(!(q.container instanceof Ws))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=q.container}if(q.maxBounds&&this.setMaxBounds(q.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return ie._update(!1)}),this.on("moveend",function(){return ie._update(!1)}),this.on("zoom",function(){return ie._update(!0)}),e.window!==void 0&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Bi(this,q);var ge=typeof q.hash=="string"&&q.hash||void 0;this._hash=q.hash&&new Or(ge).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:q.center,zoom:q.zoom,bearing:q.bearing,pitch:q.pitch}),q.bounds&&(this.resize(),this.fitBounds(q.bounds,e.extend({},q.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=q.localIdeographFontFamily,q.style&&this.setStyle(q.style,{localIdeographFontFamily:q.localIdeographFontFamily}),q.attributionControl&&this.addControl(new Ni({customAttribution:q.customAttribution})),this.addControl(new is,q.logoPosition),this.on("style.load",function(){ie.transform.unmodified&&ie.jumpTo(ie.style.stylesheet)}),this.on("data",function(we){ie._update(we.dataType==="style"),ie.fire(new e.Event(we.dataType+"data",we))}),this.on("dataloading",function(we){ie.fire(new e.Event(we.dataType+"dataloading",we))})}C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z;var F={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return z.prototype._getMapId=function(){return this._mapId},z.prototype.addControl=function(q,ie){if(ie===void 0&&q.getDefaultPosition&&(ie=q.getDefaultPosition()),ie===void 0&&(ie="top-right"),!q||!q.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var ue=q.onAdd(this);this._controls.push(q);var ge=this._controlPositions[ie];return ie.indexOf("bottom")!==-1?ge.insertBefore(ue,ge.firstChild):ge.appendChild(ue),this},z.prototype.removeControl=function(q){if(!q||!q.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var ie=this._controls.indexOf(q);return ie>-1&&this._controls.splice(ie,1),q.onRemove(this),this},z.prototype.resize=function(q){var ie=this._containerDimensions(),ue=ie[0],ge=ie[1];this._resizeCanvas(ue,ge),this.transform.resize(ue,ge),this.painter.resize(ue,ge);var we=!this._moving;return we&&(this.stop(),this.fire(new e.Event("movestart",q)).fire(new e.Event("move",q))),this.fire(new e.Event("resize",q)),we&&this.fire(new e.Event("moveend",q)),this},z.prototype.getBounds=function(){return this.transform.getBounds()},z.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},z.prototype.setMaxBounds=function(q){return this.transform.setMaxBounds(e.LngLatBounds.convert(q)),this._update()},z.prototype.setMinZoom=function(q){if((q=q==null?-2:q)>=-2&&q<=this.transform.maxZoom)return this.transform.minZoom=q,this._update(),this.getZoom()<q&&this.setZoom(q),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},z.prototype.getMinZoom=function(){return this.transform.minZoom},z.prototype.setMaxZoom=function(q){if((q=q==null?22:q)>=this.transform.minZoom)return this.transform.maxZoom=q,this._update(),this.getZoom()>q&&this.setZoom(q),this;throw new Error("maxZoom must be greater than the current minZoom")},z.prototype.getMaxZoom=function(){return this.transform.maxZoom},z.prototype.setMinPitch=function(q){if((q=q==null?0:q)<0)throw new Error("minPitch must be greater than or equal to 0");if(q>=0&&q<=this.transform.maxPitch)return this.transform.minPitch=q,this._update(),this.getPitch()<q&&this.setPitch(q),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},z.prototype.getMinPitch=function(){return this.transform.minPitch},z.prototype.setMaxPitch=function(q){if((q=q==null?60:q)>60)throw new Error("maxPitch must be less than or equal to 60");if(q>=this.transform.minPitch)return this.transform.maxPitch=q,this._update(),this.getPitch()>q&&this.setPitch(q),this;throw new Error("maxPitch must be greater than the current minPitch")},z.prototype.getMaxPitch=function(){return this.transform.maxPitch},z.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},z.prototype.setRenderWorldCopies=function(q){return this.transform.renderWorldCopies=q,this._update()},z.prototype.project=function(q){return this.transform.locationPoint(e.LngLat.convert(q))},z.prototype.unproject=function(q){return this.transform.pointLocation(e.Point.convert(q))},z.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},z.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},z.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},z.prototype._createDelegatedListener=function(q,ie,ue){var ge,we=this;if(q==="mouseenter"||q==="mouseover"){var Se=!1;return{layer:ie,listener:ue,delegates:{mousemove:function(Je){var at=we.getLayer(ie)?we.queryRenderedFeatures(Je.point,{layers:[ie]}):[];at.length?Se||(Se=!0,ue.call(we,new Fn(q,we,Je.originalEvent,{features:at}))):Se=!1},mouseout:function(){Se=!1}}}}if(q==="mouseleave"||q==="mouseout"){var Ve=!1;return{layer:ie,listener:ue,delegates:{mousemove:function(Je){(we.getLayer(ie)?we.queryRenderedFeatures(Je.point,{layers:[ie]}):[]).length?Ve=!0:Ve&&(Ve=!1,ue.call(we,new Fn(q,we,Je.originalEvent)))},mouseout:function(Je){Ve&&(Ve=!1,ue.call(we,new Fn(q,we,Je.originalEvent)))}}}}return{layer:ie,listener:ue,delegates:(ge={},ge[q]=function(Je){var at=we.getLayer(ie)?we.queryRenderedFeatures(Je.point,{layers:[ie]}):[];at.length&&(Je.features=at,ue.call(we,Je),delete Je.features)},ge)}},z.prototype.on=function(q,ie,ue){if(ue===void 0)return C.prototype.on.call(this,q,ie);var ge=this._createDelegatedListener(q,ie,ue);for(var we in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[q]=this._delegatedListeners[q]||[],this._delegatedListeners[q].push(ge),ge.delegates)this.on(we,ge.delegates[we]);return this},z.prototype.once=function(q,ie,ue){if(ue===void 0)return C.prototype.once.call(this,q,ie);var ge=this._createDelegatedListener(q,ie,ue);for(var we in ge.delegates)this.once(we,ge.delegates[we]);return this},z.prototype.off=function(q,ie,ue){var ge=this;return ue===void 0?C.prototype.off.call(this,q,ie):(this._delegatedListeners&&this._delegatedListeners[q]&&function(we){for(var Se=we[q],Ve=0;Ve<Se.length;Ve++){var Je=Se[Ve];if(Je.layer===ie&&Je.listener===ue){for(var at in Je.delegates)ge.off(at,Je.delegates[at]);return Se.splice(Ve,1),ge}}}(this._delegatedListeners),this)},z.prototype.queryRenderedFeatures=function(q,ie){if(!this.style)return[];var ue;if(ie!==void 0||q===void 0||q instanceof e.Point||Array.isArray(q)||(ie=q,q=void 0),ie=ie||{},(q=q||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||typeof q[0]=="number")ue=[e.Point.convert(q)];else{var ge=e.Point.convert(q[0]),we=e.Point.convert(q[1]);ue=[ge,new e.Point(we.x,ge.y),we,new e.Point(ge.x,we.y),ge]}return this.style.queryRenderedFeatures(ue,ie,this.transform)},z.prototype.querySourceFeatures=function(q,ie){return this.style.querySourceFeatures(q,ie)},z.prototype.setStyle=function(q,ie){return(ie=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},ie)).diff!==!1&&ie.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&q?(this._diffStyle(q,ie),this):(this._localIdeographFontFamily=ie.localIdeographFontFamily,this._updateStyle(q,ie))},z.prototype._getUIString=function(q){var ie=this._locale[q];if(ie==null)throw new Error("Missing UI string '"+q+"'");return ie},z.prototype._updateStyle=function(q,ie){return this.style&&(this.style.setEventedParent(null),this.style._remove()),q?(this.style=new wn(this,ie||{}),this.style.setEventedParent(this,{style:this.style}),typeof q=="string"?this.style.loadURL(q):this.style.loadJSON(q),this):(delete this.style,this)},z.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new wn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},z.prototype._diffStyle=function(q,ie){var ue=this;if(typeof q=="string"){var ge=this._requestManager.normalizeStyleURL(q),we=this._requestManager.transformRequest(ge,e.ResourceType.Style);e.getJSON(we,function(Se,Ve){Se?ue.fire(new e.ErrorEvent(Se)):Ve&&ue._updateDiff(Ve,ie)})}else typeof q=="object"&&this._updateDiff(q,ie)},z.prototype._updateDiff=function(q,ie){try{this.style.setState(q)&&this._update(!0)}catch(ue){e.warnOnce("Unable to perform style diff: "+(ue.message||ue.error||ue)+".  Rebuilding the style from scratch."),this._updateStyle(q,ie)}},z.prototype.getStyle=function(){if(this.style)return this.style.serialize()},z.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},z.prototype.addSource=function(q,ie){return this._lazyInitEmptyStyle(),this.style.addSource(q,ie),this._update(!0)},z.prototype.isSourceLoaded=function(q){var ie=this.style&&this.style.sourceCaches[q];if(ie!==void 0)return ie.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+q+"'")))},z.prototype.areTilesLoaded=function(){var q=this.style&&this.style.sourceCaches;for(var ie in q){var ue=q[ie]._tiles;for(var ge in ue){var we=ue[ge];if(we.state!=="loaded"&&we.state!=="errored")return!1}}return!0},z.prototype.addSourceType=function(q,ie,ue){return this._lazyInitEmptyStyle(),this.style.addSourceType(q,ie,ue)},z.prototype.removeSource=function(q){return this.style.removeSource(q),this._update(!0)},z.prototype.getSource=function(q){return this.style.getSource(q)},z.prototype.addImage=function(q,ie,ue){ue===void 0&&(ue={});var ge=ue.pixelRatio;ge===void 0&&(ge=1);var we=ue.sdf;we===void 0&&(we=!1);var Se=ue.stretchX,Ve=ue.stretchY,Je=ue.content;if(this._lazyInitEmptyStyle(),ie instanceof Ys||os&&ie instanceof os){var at=e.browser.getImageData(ie),bt=at.width,Et=at.height,kt=at.data;this.style.addImage(q,{data:new e.RGBAImage({width:bt,height:Et},kt),pixelRatio:ge,stretchX:Se,stretchY:Ve,content:Je,sdf:we,version:0})}else{if(ie.width===void 0||ie.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var At=ie.width,xt=ie.height,zt=ie.data,It=ie;this.style.addImage(q,{data:new e.RGBAImage({width:At,height:xt},new Uint8Array(zt)),pixelRatio:ge,stretchX:Se,stretchY:Ve,content:Je,sdf:we,version:0,userImage:It}),It.onAdd&&It.onAdd(this,q)}},z.prototype.updateImage=function(q,ie){var ue=this.style.getImage(q);if(!ue)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var ge=ie instanceof Ys||os&&ie instanceof os?e.browser.getImageData(ie):ie,we=ge.width,Se=ge.height,Ve=ge.data;if(we===void 0||Se===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(we!==ue.data.width||Se!==ue.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var Je=!(ie instanceof Ys||os&&ie instanceof os);ue.data.replace(Ve,Je),this.style.updateImage(q,ue)},z.prototype.hasImage=function(q){return q?!!this.style.getImage(q):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},z.prototype.removeImage=function(q){this.style.removeImage(q)},z.prototype.loadImage=function(q,ie){e.getImage(this._requestManager.transformRequest(q,e.ResourceType.Image),ie)},z.prototype.listImages=function(){return this.style.listImages()},z.prototype.addLayer=function(q,ie){return this._lazyInitEmptyStyle(),this.style.addLayer(q,ie),this._update(!0)},z.prototype.moveLayer=function(q,ie){return this.style.moveLayer(q,ie),this._update(!0)},z.prototype.removeLayer=function(q){return this.style.removeLayer(q),this._update(!0)},z.prototype.getLayer=function(q){return this.style.getLayer(q)},z.prototype.setLayerZoomRange=function(q,ie,ue){return this.style.setLayerZoomRange(q,ie,ue),this._update(!0)},z.prototype.setFilter=function(q,ie,ue){return ue===void 0&&(ue={}),this.style.setFilter(q,ie,ue),this._update(!0)},z.prototype.getFilter=function(q){return this.style.getFilter(q)},z.prototype.setPaintProperty=function(q,ie,ue,ge){return ge===void 0&&(ge={}),this.style.setPaintProperty(q,ie,ue,ge),this._update(!0)},z.prototype.getPaintProperty=function(q,ie){return this.style.getPaintProperty(q,ie)},z.prototype.setLayoutProperty=function(q,ie,ue,ge){return ge===void 0&&(ge={}),this.style.setLayoutProperty(q,ie,ue,ge),this._update(!0)},z.prototype.getLayoutProperty=function(q,ie){return this.style.getLayoutProperty(q,ie)},z.prototype.setLight=function(q,ie){return ie===void 0&&(ie={}),this._lazyInitEmptyStyle(),this.style.setLight(q,ie),this._update(!0)},z.prototype.getLight=function(){return this.style.getLight()},z.prototype.setFeatureState=function(q,ie){return this.style.setFeatureState(q,ie),this._update()},z.prototype.removeFeatureState=function(q,ie){return this.style.removeFeatureState(q,ie),this._update()},z.prototype.getFeatureState=function(q){return this.style.getFeatureState(q)},z.prototype.getContainer=function(){return this._container},z.prototype.getCanvasContainer=function(){return this._canvasContainer},z.prototype.getCanvas=function(){return this._canvas},z.prototype._containerDimensions=function(){var q=0,ie=0;return this._container&&(q=this._container.clientWidth||400,ie=this._container.clientHeight||300),[q,ie]},z.prototype._detectMissingCSS=function(){e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},z.prototype._setupContainer=function(){var q=this._container;q.classList.add("mapboxgl-map"),(this._missingCSSCanary=t.create("div","mapboxgl-canary",q)).style.visibility="hidden",this._detectMissingCSS();var ie=this._canvasContainer=t.create("div","mapboxgl-canvas-container",q);this._interactive&&ie.classList.add("mapboxgl-interactive"),this._canvas=t.create("canvas","mapboxgl-canvas",ie),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var ue=this._containerDimensions();this._resizeCanvas(ue[0],ue[1]);var ge=this._controlContainer=t.create("div","mapboxgl-control-container",q),we=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Se){we[Se]=t.create("div","mapboxgl-ctrl-"+Se,ge)})},z.prototype._resizeCanvas=function(q,ie){var ue=e.browser.devicePixelRatio||1;this._canvas.width=ue*q,this._canvas.height=ue*ie,this._canvas.style.width=q+"px",this._canvas.style.height=ie+"px"},z.prototype._setupPainter=function(){var q=e.extend({},n.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),ie=this._canvas.getContext("webgl",q)||this._canvas.getContext("experimental-webgl",q);ie?(this.painter=new Da(ie,this.transform),e.webpSupported.testSupport(ie)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},z.prototype._contextLost=function(q){q.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:q}))},z.prototype._contextRestored=function(q){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:q}))},z.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},z.prototype._update=function(q){return this.style?(this._styleDirty=this._styleDirty||q,this._sourcesDirty=!0,this.triggerRepaint(),this):this},z.prototype._requestRenderFrame=function(q){return this._update(),this._renderTaskQueue.add(q)},z.prototype._cancelRenderFrame=function(q){this._renderTaskQueue.remove(q)},z.prototype._render=function(q){var ie,ue=this,ge=0,we=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(ie=we.createQueryEXT(),we.beginQueryEXT(we.TIME_ELAPSED_EXT,ie),ge=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(q),!this._removed){var Se=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ve=this.transform.zoom,Je=e.browser.now();this.style.zoomHistory.update(Ve,Je);var at=new e.EvaluationParameters(Ve,{now:Je,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),bt=at.crossFadingFactor();bt===1&&bt===this._crossFadingFactor||(Se=!0,this._crossFadingFactor=bt),this.style.update(at)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Se)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Et=e.browser.now()-ge;we.endQueryEXT(we.TIME_ELAPSED_EXT,ie),setTimeout(function(){var At=we.getQueryObjectEXT(ie,we.QUERY_RESULT_EXT)/1e6;we.deleteQueryEXT(ie),ue.fire(new e.Event("gpu-timing-frame",{cpuTime:Et,gpuTime:At}))},50)}if(this.listens("gpu-timing-layer")){var kt=this.painter.collectGpuTimers();setTimeout(function(){var At=ue.painter.queryGpuTimers(kt);ue.fire(new e.Event("gpu-timing-layer",{layerTimes:At}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},z.prototype.remove=function(){this._hash&&this._hash.remove();for(var q=0,ie=this._controls;q<ie.length;q+=1)ie[q].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),e.window!==void 0&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var ue=this.painter.context.gl.getExtension("WEBGL_lose_context");ue&&ue.loseContext(),ll(this._canvasContainer),ll(this._controlContainer),ll(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},z.prototype.triggerRepaint=function(){var q=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(ie){q._frame=null,q._render(ie)}))},z.prototype._onWindowOnline=function(){this._update()},z.prototype._onWindowResize=function(q){this._trackResize&&this.resize({originalEvent:q})._update()},F.showTileBoundaries.get=function(){return!!this._showTileBoundaries},F.showTileBoundaries.set=function(q){this._showTileBoundaries!==q&&(this._showTileBoundaries=q,this._update())},F.showPadding.get=function(){return!!this._showPadding},F.showPadding.set=function(q){this._showPadding!==q&&(this._showPadding=q,this._update())},F.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},F.showCollisionBoxes.set=function(q){this._showCollisionBoxes!==q&&(this._showCollisionBoxes=q,q?this.style._generateCollisionBoxes():this._update())},F.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},F.showOverdrawInspector.set=function(q){this._showOverdrawInspector!==q&&(this._showOverdrawInspector=q,this._update())},F.repaint.get=function(){return!!this._repaint},F.repaint.set=function(q){this._repaint!==q&&(this._repaint=q,this.triggerRepaint())},F.vertices.get=function(){return!!this._vertices},F.vertices.set=function(q){this._vertices=q,this._update()},z.prototype._setCacheLimits=function(q,ie){e.setCacheLimits(q,ie)},F.version.get=function(){return e.version},Object.defineProperties(z.prototype,F),z}(Gs);function ll(C){C.parentNode&&C.parentNode.removeChild(C)}var Is={showCompass:!0,showZoom:!0,visualizePitch:!1},$a=function(C){var z=this;this.options=e.extend({},Is,C),this._container=t.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(F){return F.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(F){return z._map.zoomIn({},{originalEvent:F})}),t.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(F){return z._map.zoomOut({},{originalEvent:F})}),t.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(F){z.options.visualizePitch?z._map.resetNorthPitch({},{originalEvent:F}):z._map.resetNorth({},{originalEvent:F})}),this._compassIcon=t.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};$a.prototype._updateZoomButtons=function(){var C=this._map.getZoom();this._zoomInButton.disabled=C===this._map.getMaxZoom(),this._zoomOutButton.disabled=C===this._map.getMinZoom()},$a.prototype._rotateCompassArrow=function(){var C=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=C},$a.prototype.onAdd=function(C){return this._map=C,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new oi(this._map,this._compass,this.options.visualizePitch)),this._container},$a.prototype.onRemove=function(){t.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},$a.prototype._createButton=function(C,z){var F=t.create("button",C,this._container);return F.type="button",F.addEventListener("click",z),F},$a.prototype._setButtonTitle=function(C,z){var F=this._map._getUIString("NavigationControl."+z);C.title=F,C.setAttribute("aria-label",F)};var oi=function(C,z,F){F===void 0&&(F=!1),this._clickTolerance=10,this.element=z,this.mouseRotate=new Ca({clickTolerance:C.dragRotate._mouseRotate._clickTolerance}),this.map=C,F&&(this.mousePitch=new ga({clickTolerance:C.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),t.addEventListener(z,"mousedown",this.mousedown),t.addEventListener(z,"touchstart",this.touchstart,{passive:!1}),t.addEventListener(z,"touchmove",this.touchmove),t.addEventListener(z,"touchend",this.touchend),t.addEventListener(z,"touchcancel",this.reset)};function bs(C,z,F){if(C=new e.LngLat(C.lng,C.lat),z){var q=new e.LngLat(C.lng-360,C.lat),ie=new e.LngLat(C.lng+360,C.lat),ue=F.locationPoint(C).distSqr(z);F.locationPoint(q).distSqr(z)<ue?C=q:F.locationPoint(ie).distSqr(z)<ue&&(C=ie)}for(;Math.abs(C.lng-F.center.lng)>180;){var ge=F.locationPoint(C);if(ge.x>=0&&ge.y>=0&&ge.x<=F.width&&ge.y<=F.height)break;C.lng>F.center.lng?C.lng-=360:C.lng+=360}return C}oi.prototype.down=function(C,z){this.mouseRotate.mousedown(C,z),this.mousePitch&&this.mousePitch.mousedown(C,z),t.disableDrag()},oi.prototype.move=function(C,z){var F=this.map,q=this.mouseRotate.mousemoveWindow(C,z);if(q&&q.bearingDelta&&F.setBearing(F.getBearing()+q.bearingDelta),this.mousePitch){var ie=this.mousePitch.mousemoveWindow(C,z);ie&&ie.pitchDelta&&F.setPitch(F.getPitch()+ie.pitchDelta)}},oi.prototype.off=function(){var C=this.element;t.removeEventListener(C,"mousedown",this.mousedown),t.removeEventListener(C,"touchstart",this.touchstart,{passive:!1}),t.removeEventListener(C,"touchmove",this.touchmove),t.removeEventListener(C,"touchend",this.touchend),t.removeEventListener(C,"touchcancel",this.reset),this.offTemp()},oi.prototype.offTemp=function(){t.enableDrag(),t.removeEventListener(e.window,"mousemove",this.mousemove),t.removeEventListener(e.window,"mouseup",this.mouseup)},oi.prototype.mousedown=function(C){this.down(e.extend({},C,{ctrlKey:!0,preventDefault:function(){return C.preventDefault()}}),t.mousePos(this.element,C)),t.addEventListener(e.window,"mousemove",this.mousemove),t.addEventListener(e.window,"mouseup",this.mouseup)},oi.prototype.mousemove=function(C){this.move(C,t.mousePos(this.element,C))},oi.prototype.mouseup=function(C){this.mouseRotate.mouseupWindow(C),this.mousePitch&&this.mousePitch.mouseupWindow(C),this.offTemp()},oi.prototype.touchstart=function(C){C.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=t.touchPos(this.element,C.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return C.preventDefault()}},this._startPos))},oi.prototype.touchmove=function(C){C.targetTouches.length!==1?this.reset():(this._lastPos=t.touchPos(this.element,C.targetTouches)[0],this.move({preventDefault:function(){return C.preventDefault()}},this._lastPos))},oi.prototype.touchend=function(C){C.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},oi.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var hs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function zi(C,z,F){var q=C.classList;for(var ie in hs)q.remove("mapboxgl-"+F+"-anchor-"+ie);q.add("mapboxgl-"+F+"-anchor-"+z)}var _s,Os=function(C){function z(F,q){var ie=this;if(C.call(this),(F instanceof e.window.HTMLElement||q)&&(F=e.extend({element:F},q)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=F&&F.anchor||"center",this._color=F&&F.color||"#3FB1CE",this._draggable=F&&F.draggable||!1,this._state="inactive",this._rotation=F&&F.rotation||0,this._rotationAlignment=F&&F.rotationAlignment||"auto",this._pitchAlignment=F&&F.pitchAlignment&&F.pitchAlignment!=="auto"?F.pitchAlignment:this._rotationAlignment,F&&F.element)this._element=F.element,this._offset=e.Point.convert(F&&F.offset||[0,0]);else{this._defaultMarker=!0,this._element=t.create("div"),this._element.setAttribute("aria-label","Map marker");var ue=t.createNS("http://www.w3.org/2000/svg","svg");ue.setAttributeNS(null,"display","block"),ue.setAttributeNS(null,"height","41px"),ue.setAttributeNS(null,"width","27px"),ue.setAttributeNS(null,"viewBox","0 0 27 41");var ge=t.createNS("http://www.w3.org/2000/svg","g");ge.setAttributeNS(null,"stroke","none"),ge.setAttributeNS(null,"stroke-width","1"),ge.setAttributeNS(null,"fill","none"),ge.setAttributeNS(null,"fill-rule","evenodd");var we=t.createNS("http://www.w3.org/2000/svg","g");we.setAttributeNS(null,"fill-rule","nonzero");var Se=t.createNS("http://www.w3.org/2000/svg","g");Se.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Se.setAttributeNS(null,"fill","#000000");for(var Ve=0,Je=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Ve<Je.length;Ve+=1){var at=Je[Ve],bt=t.createNS("http://www.w3.org/2000/svg","ellipse");bt.setAttributeNS(null,"opacity","0.04"),bt.setAttributeNS(null,"cx","10.5"),bt.setAttributeNS(null,"cy","5.80029008"),bt.setAttributeNS(null,"rx",at.rx),bt.setAttributeNS(null,"ry",at.ry),Se.appendChild(bt)}var Et=t.createNS("http://www.w3.org/2000/svg","g");Et.setAttributeNS(null,"fill",this._color);var kt=t.createNS("http://www.w3.org/2000/svg","path");kt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Et.appendChild(kt);var At=t.createNS("http://www.w3.org/2000/svg","g");At.setAttributeNS(null,"opacity","0.25"),At.setAttributeNS(null,"fill","#000000");var xt=t.createNS("http://www.w3.org/2000/svg","path");xt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),At.appendChild(xt);var zt=t.createNS("http://www.w3.org/2000/svg","g");zt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),zt.setAttributeNS(null,"fill","#FFFFFF");var It=t.createNS("http://www.w3.org/2000/svg","g");It.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Bt=t.createNS("http://www.w3.org/2000/svg","circle");Bt.setAttributeNS(null,"fill","#000000"),Bt.setAttributeNS(null,"opacity","0.25"),Bt.setAttributeNS(null,"cx","5.5"),Bt.setAttributeNS(null,"cy","5.5"),Bt.setAttributeNS(null,"r","5.4999962");var nr=t.createNS("http://www.w3.org/2000/svg","circle");nr.setAttributeNS(null,"fill","#FFFFFF"),nr.setAttributeNS(null,"cx","5.5"),nr.setAttributeNS(null,"cy","5.5"),nr.setAttributeNS(null,"r","5.4999962"),It.appendChild(Bt),It.appendChild(nr),we.appendChild(Se),we.appendChild(Et),we.appendChild(At),we.appendChild(zt),we.appendChild(It),ue.appendChild(we),this._element.appendChild(ue),this._offset=e.Point.convert(F&&F.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(gr){gr.preventDefault()}),this._element.addEventListener("mousedown",function(gr){gr.preventDefault()}),this._element.addEventListener("focus",function(){var gr=ie._map.getContainer();gr.scrollTop=0,gr.scrollLeft=0}),zi(this._element,this._anchor,"marker"),this._popup=null}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.addTo=function(F){return this.remove(),this._map=F,F.getCanvasContainer().appendChild(this._element),F.on("move",this._update),F.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},z.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),t.remove(this._element),this._popup&&this._popup.remove(),this},z.prototype.getLngLat=function(){return this._lngLat},z.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},z.prototype.getElement=function(){return this._element},z.prototype.setPopup=function(F){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),F){if(!("offset"in F.options)){var q=Math.sqrt(Math.pow(13.5,2)/2);F.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[q,-1*(24.6+q)],"bottom-right":[-q,-1*(24.6+q)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=F,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},z.prototype._onKeyPress=function(F){var q=F.code,ie=F.charCode||F.keyCode;q!=="Space"&&q!=="Enter"&&ie!==32&&ie!==13||this.togglePopup()},z.prototype._onMapClick=function(F){var q=F.originalEvent.target,ie=this._element;this._popup&&(q===ie||ie.contains(q))&&this.togglePopup()},z.prototype.getPopup=function(){return this._popup},z.prototype.togglePopup=function(){var F=this._popup;return F?(F.isOpen()?F.remove():F.addTo(this._map),this):this},z.prototype._update=function(F){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=bs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var q="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?q="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(q="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var ie="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?ie="rotateX(0deg)":this._pitchAlignment==="map"&&(ie="rotateX("+this._map.getPitch()+"deg)"),F&&F.type!=="moveend"||(this._pos=this._pos.round()),t.setTransform(this._element,hs[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+ie+" "+q)}},z.prototype.getOffset=function(){return this._offset},z.prototype.setOffset=function(F){return this._offset=e.Point.convert(F),this._update(),this},z.prototype._onMove=function(F){this._pos=F.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},z.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},z.prototype._addDragHandler=function(F){this._element.contains(F.originalEvent.target)&&(F.preventDefault(),this._positionDelta=F.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},z.prototype.setDraggable=function(F){return this._draggable=!!F,this._map&&(F?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},z.prototype.isDraggable=function(){return this._draggable},z.prototype.setRotation=function(F){return this._rotation=F||0,this._update(),this},z.prototype.getRotation=function(){return this._rotation},z.prototype.setRotationAlignment=function(F){return this._rotationAlignment=F||"auto",this._update(),this},z.prototype.getRotationAlignment=function(){return this._rotationAlignment},z.prototype.setPitchAlignment=function(F){return this._pitchAlignment=F&&F!=="auto"?F:this._rotationAlignment,this._update(),this},z.prototype.getPitchAlignment=function(){return this._pitchAlignment},z}(e.Evented),Ms={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},zs=0,ps=!1,cl=function(C){function z(F){C.call(this),this.options=e.extend({},Ms,F),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.onAdd=function(F){var q;return this._map=F,this._container=t.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),q=this._setupUI,_s!==void 0?q(_s):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(ie){_s=ie.state!=="denied",q(_s)}):(_s=!!e.window.navigator.geolocation,q(_s)),this._container},z.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),t.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,zs=0,ps=!1},z.prototype._isOutOfMapMaxBounds=function(F){var q=this._map.getMaxBounds(),ie=F.coords;return q&&(ie.longitude<q.getWest()||ie.longitude>q.getEast()||ie.latitude<q.getSouth()||ie.latitude>q.getNorth())},z.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},z.prototype._onSuccess=function(F){if(this._map){if(this._isOutOfMapMaxBounds(F))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",F)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=F,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(F),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(F),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",F)),this._finish()}},z.prototype._updateCamera=function(F){var q=new e.LngLat(F.coords.longitude,F.coords.latitude),ie=F.coords.accuracy,ue=this._map.getBearing(),ge=e.extend({bearing:ue},this.options.fitBoundsOptions);this._map.fitBounds(q.toBounds(ie),ge,{geolocateSource:!0})},z.prototype._updateMarker=function(F){if(F){var q=new e.LngLat(F.coords.longitude,F.coords.latitude);this._accuracyCircleMarker.setLngLat(q).addTo(this._map),this._userLocationDotMarker.setLngLat(q).addTo(this._map),this._accuracy=F.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},z.prototype._updateCircleRadius=function(){var F=this._map._container.clientHeight/2,q=this._map.unproject([0,F]),ie=this._map.unproject([1,F]),ue=q.distanceTo(ie),ge=Math.ceil(2*this._accuracy/ue);this._circleElement.style.width=ge+"px",this._circleElement.style.height=ge+"px"},z.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},z.prototype._onError=function(F){if(this._map){if(this.options.trackUserLocation)if(F.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var q=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=q,this._geolocateButton.setAttribute("aria-label",q),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(F.code===3&&ps)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",F)),this._finish()}},z.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},z.prototype._setupUI=function(F){var q=this;if(this._container.addEventListener("contextmenu",function(ge){return ge.preventDefault()}),this._geolocateButton=t.create("button","mapboxgl-ctrl-geolocate",this._container),t.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",F===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var ie=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=ie,this._geolocateButton.setAttribute("aria-label",ie)}else{var ue=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=ue,this._geolocateButton.setAttribute("aria-label",ue)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=t.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Os(this._dotElement),this._circleElement=t.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Os({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(ge){var we=ge.originalEvent&&ge.originalEvent.type==="resize";ge.geolocateSource||q._watchState!=="ACTIVE_LOCK"||we||(q._watchState="BACKGROUND",q._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),q._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),q.fire(new e.Event("trackuserlocationend")))})},z.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":zs--,ps=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var F;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++zs>1?(F={maximumAge:6e5,timeout:0},ps=!0):(F=this.options.positionOptions,ps=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,F)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},z.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},z}(e.Evented),Tl={maxWidth:100,unit:"metric"},ws=function(C){this.options=e.extend({},Tl,C),e.bindAll(["_onMove","setUnit"],this)};function ul(C,z,F){var q=F&&F.maxWidth||100,ie=C._container.clientHeight/2,ue=C.unproject([0,ie]),ge=C.unproject([q,ie]),we=ue.distanceTo(ge);if(F&&F.unit==="imperial"){var Se=3.2808*we;Se>5280?Ds(z,q,Se/5280,C._getUIString("ScaleControl.Miles")):Ds(z,q,Se,C._getUIString("ScaleControl.Feet"))}else F&&F.unit==="nautical"?Ds(z,q,we/1852,C._getUIString("ScaleControl.NauticalMiles")):we>=1e3?Ds(z,q,we/1e3,C._getUIString("ScaleControl.Kilometers")):Ds(z,q,we,C._getUIString("ScaleControl.Meters"))}function Ds(C,z,F,q){var ie,ue,ge,we=(ie=F,ue=Math.pow(10,(""+Math.floor(ie)).length-1),ge=(ge=ie/ue)>=10?10:ge>=5?5:ge>=3?3:ge>=2?2:ge>=1?1:function(Ve){var Je=Math.pow(10,Math.ceil(-Math.log(Ve)/Math.LN10));return Math.round(Ve*Je)/Je}(ge),ue*ge),Se=we/F;C.style.width=z*Se+"px",C.innerHTML=we+"&nbsp;"+q}ws.prototype.getDefaultPosition=function(){return"bottom-left"},ws.prototype._onMove=function(){ul(this._map,this._container,this.options)},ws.prototype.onAdd=function(C){return this._map=C,this._container=t.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",C.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ws.prototype.onRemove=function(){t.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ws.prototype.setUnit=function(C){this.options.unit=C,ul(this._map,this._container,this.options)};var so=function(C){this._fullscreen=!1,C&&C.container&&(C.container instanceof e.window.HTMLElement?this._container=C.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};so.prototype.onAdd=function(C){return this._map=C,this._container||(this._container=this._map.getContainer()),this._controlContainer=t.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},so.prototype.onRemove=function(){t.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},so.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},so.prototype._setupUI=function(){var C=this._fullscreenButton=t.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);t.create("span","mapboxgl-ctrl-icon",C).setAttribute("aria-hidden",!0),C.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},so.prototype._updateTitle=function(){var C=this._getTitle();this._fullscreenButton.setAttribute("aria-label",C),this._fullscreenButton.title=C},so.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},so.prototype._isFullscreen=function(){return this._fullscreen},so.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},so.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var kl={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Ml=function(C){function z(F){C.call(this),this.options=e.extend(Object.create(kl),F),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return C&&(z.__proto__=C),z.prototype=Object.create(C&&C.prototype),z.prototype.constructor=z,z.prototype.addTo=function(F){return this._map&&this.remove(),this._map=F,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},z.prototype.isOpen=function(){return!!this._map},z.prototype.remove=function(){return this._content&&t.remove(this._content),this._container&&(t.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},z.prototype.getLngLat=function(){return this._lngLat},z.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},z.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},z.prototype.getElement=function(){return this._container},z.prototype.setText=function(F){return this.setDOMContent(e.window.document.createTextNode(F))},z.prototype.setHTML=function(F){var q,ie=e.window.document.createDocumentFragment(),ue=e.window.document.createElement("body");for(ue.innerHTML=F;q=ue.firstChild;)ie.appendChild(q);return this.setDOMContent(ie)},z.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},z.prototype.setMaxWidth=function(F){return this.options.maxWidth=F,this._update(),this},z.prototype.setDOMContent=function(F){return this._createContent(),this._content.appendChild(F),this._update(),this},z.prototype.addClassName=function(F){this._container&&this._container.classList.add(F)},z.prototype.removeClassName=function(F){this._container&&this._container.classList.remove(F)},z.prototype.toggleClassName=function(F){if(this._container)return this._container.classList.toggle(F)},z.prototype._createContent=function(){this._content&&t.remove(this._content),this._content=t.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=t.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},z.prototype._onMouseUp=function(F){this._update(F.point)},z.prototype._onMouseMove=function(F){this._update(F.point)},z.prototype._onDrag=function(F){this._update(F.point)},z.prototype._update=function(F){var q=this,ie=this._lngLat||this._trackPointer;if(this._map&&ie&&this._content&&(this._container||(this._container=t.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=t.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(bt){return q._container.classList.add(bt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=bs(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||F)){var ue=this._pos=this._trackPointer&&F?F:this._map.project(this._lngLat),ge=this.options.anchor,we=function bt(Et){if(Et){if(typeof Et=="number"){var kt=Math.round(Math.sqrt(.5*Math.pow(Et,2)));return{center:new e.Point(0,0),top:new e.Point(0,Et),"top-left":new e.Point(kt,kt),"top-right":new e.Point(-kt,kt),bottom:new e.Point(0,-Et),"bottom-left":new e.Point(kt,-kt),"bottom-right":new e.Point(-kt,-kt),left:new e.Point(Et,0),right:new e.Point(-Et,0)}}if(Et instanceof e.Point||Array.isArray(Et)){var At=e.Point.convert(Et);return{center:At,top:At,"top-left":At,"top-right":At,bottom:At,"bottom-left":At,"bottom-right":At,left:At,right:At}}return{center:e.Point.convert(Et.center||[0,0]),top:e.Point.convert(Et.top||[0,0]),"top-left":e.Point.convert(Et["top-left"]||[0,0]),"top-right":e.Point.convert(Et["top-right"]||[0,0]),bottom:e.Point.convert(Et.bottom||[0,0]),"bottom-left":e.Point.convert(Et["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(Et["bottom-right"]||[0,0]),left:e.Point.convert(Et.left||[0,0]),right:e.Point.convert(Et.right||[0,0])}}return bt(new e.Point(0,0))}(this.options.offset);if(!ge){var Se,Ve=this._container.offsetWidth,Je=this._container.offsetHeight;Se=ue.y+we.bottom.y<Je?["top"]:ue.y>this._map.transform.height-Je?["bottom"]:[],ue.x<Ve/2?Se.push("left"):ue.x>this._map.transform.width-Ve/2&&Se.push("right"),ge=Se.length===0?"bottom":Se.join("-")}var at=ue.add(we[ge]).round();t.setTransform(this._container,hs[ge]+" translate("+at.x+"px,"+at.y+"px)"),zi(this._container,ge,"popup")}},z.prototype._onClose=function(){this.remove()},z}(e.Evented),ce={version:e.version,supported:n,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:Zo,NavigationControl:$a,GeolocateControl:cl,AttributionControl:Ni,ScaleControl:ws,FullscreenControl:so,Popup:Ml,Marker:Os,Style:wn,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){rt().acquire(st)},clearPrewarmedResources:function(){var C=Tt;C&&(C.isPreloaded()&&C.numActive()===1?(C.release(st),Tt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(C){e.config.ACCESS_TOKEN=C},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(C){e.config.API_URL=C},get workerCount(){return it.workerCount},set workerCount(C){it.workerCount=C},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(C){e.config.MAX_PARALLEL_IMAGE_REQUESTS=C},clearStorage:function(C){e.clearTileCache(C)},workerUrl:""};return ce}),b})},{}],240:[function(v,J,Z){J.exports=Math.log2||function(p){return Math.log(p)*Math.LOG2E}},{}],241:[function(v,J,Z){J.exports=function(g,b){b||(b=g,g=window);var y=0,e=0,n=0,t={shift:!1,alt:!1,control:!1,meta:!1},a=!1;function r(x){var c=!1;return"altKey"in x&&(c=c||x.altKey!==t.alt,t.alt=!!x.altKey),"shiftKey"in x&&(c=c||x.shiftKey!==t.shift,t.shift=!!x.shiftKey),"ctrlKey"in x&&(c=c||x.ctrlKey!==t.control,t.control=!!x.ctrlKey),"metaKey"in x&&(c=c||x.metaKey!==t.meta,t.meta=!!x.metaKey),c}function m(x,c){var T=p.x(c),_=p.y(c);"buttons"in c&&(x=0|c.buttons),(x!==y||T!==e||_!==n||r(c))&&(y=0|x,e=T||0,n=_||0,b&&b(y,e,n,t))}function o(x){m(0,x)}function i(){(y||e||n||t.shift||t.alt||t.meta||t.control)&&(e=n=0,y=0,t.shift=t.alt=t.control=t.meta=!1,b&&b(0,0,0,t))}function u(x){r(x)&&b&&b(y,e,n,t)}function f(x){p.buttons(x)===0?m(0,x):m(y,x)}function l(x){m(y|p.buttons(x),x)}function h(x){m(y&~p.buttons(x),x)}function d(){a||(a=!0,g.addEventListener("mousemove",f),g.addEventListener("mousedown",l),g.addEventListener("mouseup",h),g.addEventListener("mouseleave",o),g.addEventListener("mouseenter",o),g.addEventListener("mouseout",o),g.addEventListener("mouseover",o),g.addEventListener("blur",i),g.addEventListener("keyup",u),g.addEventListener("keydown",u),g.addEventListener("keypress",u),g!==window&&(window.addEventListener("blur",i),window.addEventListener("keyup",u),window.addEventListener("keydown",u),window.addEventListener("keypress",u)))}d();var s={element:g};return Object.defineProperties(s,{enabled:{get:function(){return a},set:function(x){x?d():function(){!a||(a=!1,g.removeEventListener("mousemove",f),g.removeEventListener("mousedown",l),g.removeEventListener("mouseup",h),g.removeEventListener("mouseleave",o),g.removeEventListener("mouseenter",o),g.removeEventListener("mouseout",o),g.removeEventListener("mouseover",o),g.removeEventListener("blur",i),g.removeEventListener("keyup",u),g.removeEventListener("keydown",u),g.removeEventListener("keypress",u),g!==window&&(window.removeEventListener("blur",i),window.removeEventListener("keyup",u),window.removeEventListener("keydown",u),window.removeEventListener("keypress",u)))}()},enumerable:!0},buttons:{get:function(){return y},enumerable:!0},x:{get:function(){return e},enumerable:!0},y:{get:function(){return n},enumerable:!0},mods:{get:function(){return t},enumerable:!0}}),s};var p=v("mouse-event")},{"mouse-event":243}],242:[function(v,J,Z){var p={left:0,top:0};J.exports=function(g,b,y){b=b||g.currentTarget||g.srcElement,Array.isArray(y)||(y=[0,0]);var e=g.clientX||0,n=g.clientY||0,t=(a=b,a===window||a===document||a===document.body?p:a.getBoundingClientRect()),a;return y[0]=e-t.left,y[1]=n-t.top,y}},{}],243:[function(v,J,Z){function p(g){return g.target||g.srcElement||window}Z.buttons=function(g){if(typeof g=="object"){if("buttons"in g)return g.buttons;if("which"in g){if((b=g.which)===2)return 4;if(b===3)return 2;if(b>0)return 1<<b-1}else if("button"in g){var b;if((b=g.button)===1)return 4;if(b===2)return 2;if(b>=0)return 1<<b}}return 0},Z.element=p,Z.x=function(g){if(typeof g=="object"){if("offsetX"in g)return g.offsetX;var b=p(g).getBoundingClientRect();return g.clientX-b.left}return 0},Z.y=function(g){if(typeof g=="object"){if("offsetY"in g)return g.offsetY;var b=p(g).getBoundingClientRect();return g.clientY-b.top}return 0}},{}],244:[function(v,J,Z){var p=v("to-px");J.exports=function(g,b,y){typeof g=="function"&&(y=!!b,b=g,g=window);var e=p("ex",g),n=function(t){y&&t.preventDefault();var a=t.deltaX||0,r=t.deltaY||0,m=t.deltaZ||0,o=1;switch(t.deltaMode){case 1:o=e;break;case 2:o=window.innerHeight}if(r*=o,m*=o,(a*=o)||r||m)return b(a,r,m,t)};return g.addEventListener("wheel",n),n}},{"to-px":315}],245:[function(v,J,Z){(function(p,g){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(b,y,e){y[b]=y[b]||e(),J!==void 0&&J.exports&&(J.exports=y[b])})("Promise",p!==void 0?p:this,function(){var b,y,e,n=Object.prototype.toString,t=g!==void 0?function(x){return g(x)}:setTimeout;try{Object.defineProperty({},"x",{}),b=function(x,c,T,_){return Object.defineProperty(x,c,{value:T,writable:!0,configurable:_!==!1})}}catch{b=function(c,T,_){return c[T]=_,c}}function a(x,c){e.add(x,c),y||(y=t(e.drain))}function r(x){var c,T=typeof x;return x==null||T!="object"&&T!="function"||(c=x.then),typeof c=="function"&&c}function m(){for(var x=0;x<this.chain.length;x++)o(this,this.state===1?this.chain[x].success:this.chain[x].failure,this.chain[x]);this.chain.length=0}function o(x,c,T){var _,w;try{c===!1?T.reject(x.msg):(_=c===!0?x.msg:c.call(void 0,x.msg))===T.promise?T.reject(TypeError("Promise-chain cycle")):(w=r(_))?w.call(_,T.resolve,T.reject):T.resolve(_)}catch(k){T.reject(k)}}function i(x){var c,T=this;if(!T.triggered){T.triggered=!0,T.def&&(T=T.def);try{(c=r(x))?a(function(){var _=new l(T);try{c.call(x,function(){i.apply(_,arguments)},function(){u.apply(_,arguments)})}catch(w){u.call(_,w)}}):(T.msg=x,T.state=1,T.chain.length>0&&a(m,T))}catch(_){u.call(new l(T),_)}}}function u(x){var c=this;c.triggered||(c.triggered=!0,c.def&&(c=c.def),c.msg=x,c.state=2,c.chain.length>0&&a(m,c))}function f(x,c,T,_){for(var w=0;w<c.length;w++)(function(k){x.resolve(c[k]).then(function(L){T(k,L)},_)})(w)}function l(x){this.def=x,this.triggered=!1}function h(x){this.promise=x,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function d(x){if(typeof x!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var c=new h(this);this.then=function(T,_){var w={success:typeof T!="function"||T,failure:typeof _=="function"&&_};return w.promise=new this.constructor(function(k,L){if(typeof k!="function"||typeof L!="function")throw TypeError("Not a function");w.resolve=k,w.reject=L}),c.chain.push(w),c.state!==0&&a(m,c),w.promise},this.catch=function(T){return this.then(void 0,T)};try{x.call(void 0,function(T){i.call(c,T)},function(T){u.call(c,T)})}catch(T){u.call(c,T)}}e=function(){var x,c,T;function _(w,k){this.fn=w,this.self=k,this.next=void 0}return{add:function(w,k){T=new _(w,k),c?c.next=T:x=T,c=T,T=void 0},drain:function(){var w=x;for(x=c=y=void 0;w;)w.fn.call(w.self),w=w.next}}}();var s=b({},"constructor",d,!1);return d.prototype=s,b(s,"__NPO__",0,!1),b(d,"resolve",function(x){return x&&typeof x=="object"&&x.__NPO__===1?x:new this(function(c,T){if(typeof c!="function"||typeof T!="function")throw TypeError("Not a function");c(x)})}),b(d,"reject",function(x){return new this(function(c,T){if(typeof c!="function"||typeof T!="function")throw TypeError("Not a function");T(x)})}),b(d,"all",function(x){var c=this;return n.call(x)!="[object Array]"?c.reject(TypeError("Not an array")):x.length===0?c.resolve([]):new c(function(T,_){if(typeof T!="function"||typeof _!="function")throw TypeError("Not a function");var w=x.length,k=Array(w),L=0;f(c,x,function(A,I){k[A]=I,++L===w&&T(k)},_)})}),b(d,"race",function(x){var c=this;return n.call(x)!="[object Array]"?c.reject(TypeError("Not an array")):new c(function(T,_){if(typeof T!="function"||typeof _!="function")throw TypeError("Not a function");f(c,x,function(w,k){T(k)},_)})}),d})}).call(this)}).call(this,typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{},v("timers").setImmediate)},{timers:312}],246:[function(v,J,Z){var p=Math.PI,g=t(120);function b(a,r,m,o){return["C",a,r,m,o,m,o]}function y(a,r,m,o,i,u){return["C",a/3+2/3*m,r/3+2/3*o,i/3+2/3*m,u/3+2/3*o,i,u]}function e(a,r,m,o,i,u,f,l,h,d){if(d)I=d[0],P=d[1],L=d[2],A=d[3];else{var s=n(a,r,-i);a=s.x,r=s.y;var x=(a-(l=(s=n(l,h,-i)).x))/2,c=(r-(h=s.y))/2,T=x*x/(m*m)+c*c/(o*o);T>1&&(m*=T=Math.sqrt(T),o*=T);var _=m*m,w=o*o,k=(u==f?-1:1)*Math.sqrt(Math.abs((_*w-_*c*c-w*x*x)/(_*c*c+w*x*x)));k==1/0&&(k=1);var L=k*m*c/o+(a+l)/2,A=k*-o*x/m+(r+h)/2,I=Math.asin(((r-A)/o).toFixed(9)),P=Math.asin(((h-A)/o).toFixed(9));(I=a<L?p-I:I)<0&&(I=2*p+I),(P=l<L?p-P:P)<0&&(P=2*p+P),f&&I>P&&(I-=2*p),!f&&P>I&&(P-=2*p)}if(Math.abs(P-I)>g){var S=P,E=l,D=h;P=I+g*(f&&P>I?1:-1);var R=e(l=L+m*Math.cos(P),h=A+o*Math.sin(P),m,o,i,0,f,E,D,[P,S,L,A])}var H=Math.tan((P-I)/4),V=4/3*m*H,X=4/3*o*H,$=[2*a-(a+V*Math.sin(I)),2*r-(r-X*Math.cos(I)),l+V*Math.sin(P),h-X*Math.cos(P),l,h];if(d)return $;R&&($=$.concat(R));for(var G=0;G<$.length;){var W=n($[G],$[G+1],i);$[G++]=W.x,$[G++]=W.y}return $}function n(a,r,m){return{x:a*Math.cos(m)-r*Math.sin(m),y:a*Math.sin(m)+r*Math.cos(m)}}function t(a){return a*(p/180)}J.exports=function(a){for(var r,m=[],o=0,i=0,u=0,f=0,l=null,h=null,d=0,s=0,x=0,c=a.length;x<c;x++){var T=a[x],_=T[0];switch(_){case"M":u=T[1],f=T[2];break;case"A":(T=e(d,s,T[1],T[2],t(T[3]),T[4],T[5],T[6],T[7])).unshift("C"),T.length>7&&(m.push(T.splice(0,7)),T.unshift("C"));break;case"S":var w=d,k=s;r!="C"&&r!="S"||(w+=w-o,k+=k-i),T=["C",w,k,T[1],T[2],T[3],T[4]];break;case"T":r=="Q"||r=="T"?(l=2*d-l,h=2*s-h):(l=d,h=s),T=y(d,s,l,h,T[1],T[2]);break;case"Q":l=T[1],h=T[2],T=y(d,s,T[1],T[2],T[3],T[4]);break;case"L":T=b(d,s,T[1],T[2]);break;case"H":T=b(d,s,T[1],s);break;case"V":T=b(d,s,d,T[1]);break;case"Z":T=b(d,s,u,f)}r=_,d=T[T.length-2],s=T[T.length-1],T.length>4?(o=T[T.length-4],i=T[T.length-3]):(o=d,i=s),m.push(T)}return m}},{}],247:[function(v,J,Z){var p=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable;function y(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}J.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var n={},t=0;t<10;t++)n["_"+String.fromCharCode(t)]=t;if(Object.getOwnPropertyNames(n).map(function(r){return n[r]}).join("")!=="0123456789")return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(r){a[r]=r}),Object.keys(Object.assign({},a)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(e,n){for(var t,a,r=y(e),m=1;m<arguments.length;m++){for(var o in t=Object(arguments[m]))g.call(t,o)&&(r[o]=t[o]);if(p){a=p(t);for(var i=0;i<a.length;i++)b.call(t,a[i])&&(r[a[i]]=t[a[i]])}}return r}},{}],248:[function(v,J,Z){function p(y,e){if(typeof y!="string")return[y];var n=[y];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var t=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],a=e.escape||"___",r=!!e.flat;t.forEach(function(o){var i=new RegExp(["\\",o[0],"[^\\",o[0],"\\",o[1],"]*\\",o[1]].join("")),u=[];function f(l,h,d){var s=n.push(l.slice(o[0].length,-o[1].length))-1;return u.push(s),a+s+a}n.forEach(function(l,h){for(var d,s=0;l!=d;)if(d=l,l=l.replace(i,f),s++>1e4)throw Error("References have circular dependency. Please, check them.");n[h]=l}),u=u.reverse(),n=n.map(function(l){return u.forEach(function(h){l=l.replace(new RegExp("(\\"+a+h+"\\"+a+")","g"),o[0]+"$1"+o[1])}),l})});var m=new RegExp("\\"+a+"([0-9]+)\\"+a);return r?n:function o(i,u,f){for(var l,h=[],d=0;l=m.exec(i);){if(d++>1e4)throw Error("Circular references in parenthesis");h.push(i.slice(0,l.index)),h.push(o(u[l[1]],u)),i=i.slice(l.index+l[0].length)}return h.push(i),h}(n[0],n)}function g(y,e){if(e&&e.flat){var n,t=e&&e.escape||"___",a=y[0];if(!a)return"";for(var r=new RegExp("\\"+t+"([0-9]+)\\"+t),m=0;a!=n;){if(m++>1e4)throw Error("Circular references in "+y);n=a,a=a.replace(r,o)}return a}return y.reduce(function i(u,f){return Array.isArray(f)&&(f=f.reduce(i,"")),u+f},"");function o(i,u){if(y[u]==null)throw Error("Reference "+u+"is undefined");return y[u]}}function b(y,e){return Array.isArray(y)?g(y,e):p(y,e)}b.parse=p,b.stringify=g,J.exports=b},{}],249:[function(v,J,Z){var p=v("pick-by-alias");J.exports=function(g){var b;return arguments.length>1&&(g=arguments),typeof g=="string"?g=g.split(/\s/).map(parseFloat):typeof g=="number"&&(g=[g]),g.length&&typeof g[0]=="number"?b=g.length===1?{width:g[0],height:g[0],x:0,y:0}:g.length===2?{width:g[0],height:g[1],x:0,y:0}:{x:g[0],y:g[1],width:g[2]-g[0]||0,height:g[3]-g[1]||0}:g&&(g=p(g,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),b={x:g.left||0,y:g.top||0},g.width==null?g.right?b.width=g.right-b.x:b.width=0:b.width=g.width,g.height==null?g.bottom?b.height=g.bottom-b.y:b.height=0:b.height=g.height),b}},{"pick-by-alias":253}],250:[function(v,J,Z){J.exports=function(y){var e=[];return y.replace(g,function(n,t,a){var r=t.toLowerCase();for(a=function(m){var o=m.match(b);return o?o.map(Number):[]}(a),r=="m"&&a.length>2&&(e.push([t].concat(a.splice(0,2))),r="l",t=t=="m"?"l":"L");;){if(a.length==p[r])return a.unshift(t),e.push(a);if(a.length<p[r])throw new Error("malformed path data");e.push([t].concat(a.splice(0,p[r])))}}),e};var p={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},g=/([astvzqmhlc])([^astvzqmhlc]*)/gi,b=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],251:[function(v,J,Z){J.exports=function(p,g){g||(g=[0,""]),p=String(p);var b=parseFloat(p,10);return g[0]=b,g[1]=p.match(/[\d.\-\+]*\s*(.*)/)[1]||"",g}},{}],252:[function(v,J,Z){(function(p){(function(){(function(){var g,b,y,e,n,t;typeof performance<"u"&&performance!==null&&performance.now?J.exports=function(){return performance.now()}:p!=null&&p.hrtime?(J.exports=function(){return(g()-n)/1e6},b=p.hrtime,e=(g=function(){var a;return 1e9*(a=b())[0]+a[1]})(),t=1e9*p.uptime(),n=e-t):Date.now?(J.exports=function(){return Date.now()-y},y=Date.now()):(J.exports=function(){return new Date().getTime()-y},y=new Date().getTime())}).call(this)}).call(this)}).call(this,v("_process"))},{_process:278}],253:[function(v,J,Z){J.exports=function(b,y,e){var n,t,a={};if(typeof y=="string"&&(y=g(y)),Array.isArray(y)){var r={};for(t=0;t<y.length;t++)r[y[t]]=!0;y=r}for(n in y)y[n]=g(y[n]);var m={};for(n in y){var o=y[n];if(Array.isArray(o))for(t=0;t<o.length;t++){var i=o[t];if(e&&(m[i]=!0),i in b){if(a[n]=b[i],e)for(var u=t;u<o.length;u++)m[o[u]]=!0;break}}else n in b&&(y[n]&&(a[n]=b[n]),e&&(m[n]=!0))}if(e)for(n in b)m[n]||(a[n]=b[n]);return a};var p={};function g(b){return p[b]?p[b]:(typeof b=="string"&&(b=p[b]=b.split(/\s*,\s*|\s+/)),b)}},{}],254:[function(v,J,Z){J.exports=function(p,g,b,y){var e=p[0],n=p[1],t=!1;b===void 0&&(b=0),y===void 0&&(y=g.length);for(var a=y-b,r=0,m=a-1;r<a;m=r++){var o=g[r+b][0],i=g[r+b][1],u=g[m+b][0],f=g[m+b][1];i>n!=f>n&&e<(u-o)*(n-i)/(f-i)+o&&(t=!t)}return t}},{}],255:[function(v,J,Z){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var p,g=v("./lib/build-log"),b=v("./lib/epsilon"),y=v("./lib/intersecter"),e=v("./lib/segment-chainer"),n=v("./lib/segment-selector"),t=v("./lib/geojson"),a=!1,r=b();function m(o,i,u){var f=p.segments(o),l=p.segments(i),h=u(p.combine(f,l));return p.polygon(h)}p={buildLog:function(o){return o===!0?a=g():o===!1&&(a=!1),a!==!1&&a.list},epsilon:function(o){return r.epsilon(o)},segments:function(o){var i=y(!0,r,a);return o.regions.forEach(i.addRegion),{segments:i.calculate(o.inverted),inverted:o.inverted}},combine:function(o,i){return{combined:y(!1,r,a).calculate(o.segments,o.inverted,i.segments,i.inverted),inverted1:o.inverted,inverted2:i.inverted}},selectUnion:function(o){return{segments:n.union(o.combined,a),inverted:o.inverted1||o.inverted2}},selectIntersect:function(o){return{segments:n.intersect(o.combined,a),inverted:o.inverted1&&o.inverted2}},selectDifference:function(o){return{segments:n.difference(o.combined,a),inverted:o.inverted1&&!o.inverted2}},selectDifferenceRev:function(o){return{segments:n.differenceRev(o.combined,a),inverted:!o.inverted1&&o.inverted2}},selectXor:function(o){return{segments:n.xor(o.combined,a),inverted:o.inverted1!==o.inverted2}},polygon:function(o){return{regions:e(o.segments,r,a),inverted:o.inverted}},polygonFromGeoJSON:function(o){return t.toPolygon(p,o)},polygonToGeoJSON:function(o){return t.fromPolygon(p,r,o)},union:function(o,i){return m(o,i,p.selectUnion)},intersect:function(o,i){return m(o,i,p.selectIntersect)},difference:function(o,i){return m(o,i,p.selectDifference)},differenceRev:function(o,i){return m(o,i,p.selectDifferenceRev)},xor:function(o,i){return m(o,i,p.selectXor)}},typeof window=="object"&&(window.PolyBool=p),J.exports=p},{"./lib/build-log":256,"./lib/epsilon":257,"./lib/geojson":258,"./lib/intersecter":259,"./lib/segment-chainer":261,"./lib/segment-selector":262}],256:[function(v,J,Z){J.exports=function(){var p,g=0,b=!1;function y(e,n){return p.list.push({type:e,data:n?JSON.parse(JSON.stringify(n)):void 0}),p}return p={list:[],segmentId:function(){return g++},checkIntersection:function(e,n){return y("check",{seg1:e,seg2:n})},segmentChop:function(e,n){return y("div_seg",{seg:e,pt:n}),y("chop",{seg:e,pt:n})},statusRemove:function(e){return y("pop_seg",{seg:e})},segmentUpdate:function(e){return y("seg_update",{seg:e})},segmentNew:function(e,n){return y("new_seg",{seg:e,primary:n})},segmentRemove:function(e){return y("rem_seg",{seg:e})},tempStatus:function(e,n,t){return y("temp_status",{seg:e,above:n,below:t})},rewind:function(e){return y("rewind",{seg:e})},status:function(e,n,t){return y("status",{seg:e,above:n,below:t})},vert:function(e){return e===b?p:(b=e,y("vert",{x:e}))},log:function(e){return typeof e!="string"&&(e=JSON.stringify(e,!1,"  ")),y("log",{txt:e})},reset:function(){return y("reset")},selected:function(e){return y("selected",{segs:e})},chainStart:function(e){return y("chain_start",{seg:e})},chainRemoveHead:function(e,n){return y("chain_rem_head",{index:e,pt:n})},chainRemoveTail:function(e,n){return y("chain_rem_tail",{index:e,pt:n})},chainNew:function(e,n){return y("chain_new",{pt1:e,pt2:n})},chainMatch:function(e){return y("chain_match",{index:e})},chainClose:function(e){return y("chain_close",{index:e})},chainAddHead:function(e,n){return y("chain_add_head",{index:e,pt:n})},chainAddTail:function(e,n){return y("chain_add_tail",{index:e,pt:n})},chainConnect:function(e,n){return y("chain_con",{index1:e,index2:n})},chainReverse:function(e){return y("chain_rev",{index:e})},chainJoin:function(e,n){return y("chain_join",{index1:e,index2:n})},done:function(){return y("done")}}}},{}],257:[function(v,J,Z){J.exports=function(p){typeof p!="number"&&(p=1e-10);var g={epsilon:function(b){return typeof b=="number"&&(p=b),p},pointAboveOrOnLine:function(b,y,e){var n=y[0],t=y[1],a=e[0],r=e[1],m=b[0];return(a-n)*(b[1]-t)-(r-t)*(m-n)>=-p},pointBetween:function(b,y,e){var n=b[1]-y[1],t=e[0]-y[0],a=b[0]-y[0],r=e[1]-y[1],m=a*t+n*r;return!(m<p)&&!(m-(t*t+r*r)>-p)},pointsSameX:function(b,y){return Math.abs(b[0]-y[0])<p},pointsSameY:function(b,y){return Math.abs(b[1]-y[1])<p},pointsSame:function(b,y){return g.pointsSameX(b,y)&&g.pointsSameY(b,y)},pointsCompare:function(b,y){return g.pointsSameX(b,y)?g.pointsSameY(b,y)?0:b[1]<y[1]?-1:1:b[0]<y[0]?-1:1},pointsCollinear:function(b,y,e){var n=b[0]-y[0],t=b[1]-y[1],a=y[0]-e[0],r=y[1]-e[1];return Math.abs(n*r-a*t)<p},linesIntersect:function(b,y,e,n){var t=y[0]-b[0],a=y[1]-b[1],r=n[0]-e[0],m=n[1]-e[1],o=t*m-a*r;if(Math.abs(o)<p)return!1;var i=b[0]-e[0],u=b[1]-e[1],f=(r*u-m*i)/o,l=(t*u-a*i)/o,h={alongA:0,alongB:0,pt:[b[0]+f*t,b[1]+f*a]};return h.alongA=f<=-p?-2:f<p?-1:f-1<=-p?0:f-1<p?1:2,h.alongB=l<=-p?-2:l<p?-1:l-1<=-p?0:l-1<p?1:2,h},pointInsideRegion:function(b,y){for(var e=b[0],n=b[1],t=y[y.length-1][0],a=y[y.length-1][1],r=!1,m=0;m<y.length;m++){var o=y[m][0],i=y[m][1];i-n>p!=a-n>p&&(t-o)*(n-i)/(a-i)+o-e>p&&(r=!r),t=o,a=i}return r}};return g}},{}],258:[function(v,J,Z){var p={toPolygon:function(g,b){function y(t){if(t.length<=0)return g.segments({inverted:!1,regions:[]});function a(o){var i=o.slice(0,o.length-1);return g.segments({inverted:!1,regions:[i]})}for(var r=a(t[0]),m=1;m<t.length;m++)r=g.selectDifference(g.combine(r,a(t[m])));return r}if(b.type==="Polygon")return g.polygon(y(b.coordinates));if(b.type==="MultiPolygon"){for(var e=g.segments({inverted:!1,regions:[]}),n=0;n<b.coordinates.length;n++)e=g.selectUnion(g.combine(e,y(b.coordinates[n])));return g.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(g,b,y){function e(l,h){return b.pointInsideRegion([.5*(l[0][0]+l[1][0]),.5*(l[0][1]+l[1][1])],h)}function n(l){return{region:l,children:[]}}y=g.polygon(g.segments(y));var t=n(null);function a(l,h){for(var d=0;d<l.children.length;d++)if(e(h,(x=l.children[d]).region))return void a(x,h);var s=n(h);for(d=0;d<l.children.length;d++){var x;e((x=l.children[d]).region,h)&&(s.children.push(x),l.children.splice(d,1),d--)}l.children.push(s)}for(var r=0;r<y.regions.length;r++){var m=y.regions[r];m.length<3||a(t,m)}function o(l,h){for(var d=0,s=l[l.length-1][0],x=l[l.length-1][1],c=[],T=0;T<l.length;T++){var _=l[T][0],w=l[T][1];c.push([_,w]),d+=w*s-_*x,s=_,x=w}return d<0!==h&&c.reverse(),c.push([c[0][0],c[0][1]]),c}var i=[];function u(l){var h=[o(l.region,!1)];i.push(h);for(var d=0;d<l.children.length;d++)h.push(f(l.children[d]))}function f(l){for(var h=0;h<l.children.length;h++)u(l.children[h]);return o(l.region,!0)}for(r=0;r<t.children.length;r++)u(t.children[r]);return i.length<=0?{type:"Polygon",coordinates:[]}:i.length==1?{type:"Polygon",coordinates:i[0]}:{type:"MultiPolygon",coordinates:i}}};J.exports=p},{}],259:[function(v,J,Z){var p=v("./linked-list");J.exports=function(g,b,y){function e(o,i,u){return{id:y?y.segmentId():-1,start:o,end:i,myFill:{above:u.myFill.above,below:u.myFill.below},otherFill:null}}var n=p.create();function t(o,i){n.insertBefore(o,function(u){return function(f,l,h,d,s,x){var c=b.pointsCompare(l,s);return c!==0?c:b.pointsSame(h,x)?0:f!==d?f?1:-1:b.pointAboveOrOnLine(h,d?s:x,d?x:s)?1:-1}(o.isStart,o.pt,i,u.isStart,u.pt,u.other.pt)<0})}function a(o,i){var u=function(f,l){var h=p.node({isStart:!0,pt:f.start,seg:f,primary:l,other:null,status:null});return t(h,f.end),h}(o,i);return function(f,l,h){var d=p.node({isStart:!1,pt:l.end,seg:l,primary:h,other:f,status:null});f.other=d,t(d,f.pt)}(u,o,i),u}function r(o,i){var u=e(i,o.seg.end,o.seg);return function(f,l){y&&y.segmentChop(f.seg,l),f.other.remove(),f.seg.end=l,f.other.pt=l,t(f.other,f.pt)}(o,i),a(u,o.primary)}function m(o,i){var u=p.create();function f(I){return u.findTransition(function(P){var S,E,D,R,H,V;return S=I,E=P.ev,D=S.seg.start,R=S.seg.end,H=E.seg.start,V=E.seg.end,(b.pointsCollinear(D,H,V)?b.pointsCollinear(R,H,V)||b.pointAboveOrOnLine(R,H,V)?1:-1:b.pointAboveOrOnLine(D,H,V)?1:-1)>0})}function l(I,P){var S=I.seg,E=P.seg,D=S.start,R=S.end,H=E.start,V=E.end;y&&y.checkIntersection(S,E);var X=b.linesIntersect(D,R,H,V);if(X===!1){if(!b.pointsCollinear(D,R,H)||b.pointsSame(D,V)||b.pointsSame(R,H))return!1;var $=b.pointsSame(D,H),G=b.pointsSame(R,V);if($&&G)return P;var W=!$&&b.pointBetween(D,H,V),te=!G&&b.pointBetween(R,H,V);if($)return te?r(P,R):r(I,V),P;W&&(G||(te?r(P,R):r(I,V)),r(P,D))}else X.alongA===0&&(X.alongB===-1?r(I,H):X.alongB===0?r(I,X.pt):X.alongB===1&&r(I,V)),X.alongB===0&&(X.alongA===-1?r(P,D):X.alongA===0?r(P,X.pt):X.alongA===1&&r(P,R));return!1}for(var h=[];!n.isEmpty();){var d=n.getHead();if(y&&y.vert(d.pt[0]),d.isStart){let I=function(){if(x){var P=l(d,x);if(P)return P}return!!c&&l(d,c)};var A=I;y&&y.segmentNew(d.seg,d.primary);var s=f(d),x=s.before?s.before.ev:null,c=s.after?s.after.ev:null;y&&y.tempStatus(d.seg,!!x&&x.seg,!!c&&c.seg);var T,_=I();if(_){var w;g?(w=d.seg.myFill.below===null||d.seg.myFill.above!==d.seg.myFill.below)&&(_.seg.myFill.above=!_.seg.myFill.above):_.seg.otherFill=d.seg.myFill,y&&y.segmentUpdate(_.seg),d.other.remove(),d.remove()}if(n.getHead()!==d){y&&y.rewind(d.seg);continue}g?(w=d.seg.myFill.below===null||d.seg.myFill.above!==d.seg.myFill.below,d.seg.myFill.below=c?c.seg.myFill.above:o,d.seg.myFill.above=w?!d.seg.myFill.below:d.seg.myFill.below):d.seg.otherFill===null&&(T=c?d.primary===c.primary?c.seg.otherFill.above:c.seg.myFill.above:d.primary?i:o,d.seg.otherFill={above:T,below:T}),y&&y.status(d.seg,!!x&&x.seg,!!c&&c.seg),d.other.status=s.insert(p.node({ev:d}))}else{var k=d.status;if(k===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(u.exists(k.prev)&&u.exists(k.next)&&l(k.prev.ev,k.next.ev),y&&y.statusRemove(k.ev.seg),k.remove(),!d.primary){var L=d.seg.myFill;d.seg.myFill=d.seg.otherFill,d.seg.otherFill=L}h.push(d.seg)}n.getHead().remove()}return y&&y.done(),h}return g?{addRegion:function(o){for(var i,u,f,l=o[o.length-1],h=0;h<o.length;h++){i=l,l=o[h];var d=b.pointsCompare(i,l);d!==0&&a((u=d<0?i:l,f=d<0?l:i,{id:y?y.segmentId():-1,start:u,end:f,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(o){return m(o,!1)}}:{calculate:function(o,i,u,f){return o.forEach(function(l){a(e(l.start,l.end,l),!0)}),u.forEach(function(l){a(e(l.start,l.end,l),!1)}),m(i,f)}}}},{"./linked-list":260}],260:[function(v,J,Z){J.exports={create:function(){var p={root:{root:!0,next:null},exists:function(g){return g!==null&&g!==p.root},isEmpty:function(){return p.root.next===null},getHead:function(){return p.root.next},insertBefore:function(g,b){for(var y=p.root,e=p.root.next;e!==null;){if(b(e))return g.prev=e.prev,g.next=e,e.prev.next=g,void(e.prev=g);y=e,e=e.next}y.next=g,g.prev=y,g.next=null},findTransition:function(g){for(var b=p.root,y=p.root.next;y!==null&&!g(y);)b=y,y=y.next;return{before:b===p.root?null:b,after:y,insert:function(e){return e.prev=b,e.next=y,b.next=e,y!==null&&(y.prev=e),e}}}};return p},node:function(p){return p.prev=null,p.next=null,p.remove=function(){p.prev.next=p.next,p.next&&(p.next.prev=p.prev),p.prev=null,p.next=null},p}}},{}],261:[function(v,J,Z){J.exports=function(p,g,b){var y=[],e=[];return p.forEach(function(n){var t=n.start,a=n.end;if(g.pointsSame(t,a))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{b&&b.chainStart(n);for(var r={index:0,matches_head:!1,matches_pt1:!1},m={index:0,matches_head:!1,matches_pt1:!1},o=r,i=0;i<y.length;i++){var u=(s=y[i])[0],f=(s[1],s[s.length-1]);if(s[s.length-2],g.pointsSame(u,t)){if(A(i,!0,!0))break}else if(g.pointsSame(u,a)){if(A(i,!0,!1))break}else if(g.pointsSame(f,t)){if(A(i,!1,!0))break}else if(g.pointsSame(f,a)&&A(i,!1,!1))break}if(o===r)return y.push([t,a]),void(b&&b.chainNew(t,a));if(o===m){b&&b.chainMatch(r.index);var l=r.index,h=r.matches_pt1?a:t,d=r.matches_head,s=y[l],x=d?s[0]:s[s.length-1],c=d?s[1]:s[s.length-2],T=d?s[s.length-1]:s[0],_=d?s[s.length-2]:s[1];return g.pointsCollinear(c,x,h)&&(d?(b&&b.chainRemoveHead(r.index,h),s.shift()):(b&&b.chainRemoveTail(r.index,h),s.pop()),x=c),g.pointsSame(T,h)?(y.splice(l,1),g.pointsCollinear(_,T,x)&&(d?(b&&b.chainRemoveTail(r.index,x),s.pop()):(b&&b.chainRemoveHead(r.index,x),s.shift())),b&&b.chainClose(r.index),void e.push(s)):void(d?(b&&b.chainAddHead(r.index,h),s.unshift(h)):(b&&b.chainAddTail(r.index,h),s.push(h)))}var w=r.index,k=m.index;b&&b.chainConnect(w,k);var L=y[w].length<y[k].length;r.matches_head?m.matches_head?L?(I(w),P(w,k)):(I(k),P(k,w)):P(k,w):m.matches_head?P(w,k):L?(I(w),P(k,w)):(I(k),P(w,k))}function A(S,E,D){return o.index=S,o.matches_head=E,o.matches_pt1=D,o===r?(o=m,!1):(o=null,!0)}function I(S){b&&b.chainReverse(S),y[S].reverse()}function P(S,E){var D=y[S],R=y[E],H=D[D.length-1],V=D[D.length-2],X=R[0],$=R[1];g.pointsCollinear(V,H,X)&&(b&&b.chainRemoveTail(S,H),D.pop(),H=V),g.pointsCollinear(H,X,$)&&(b&&b.chainRemoveHead(E,X),R.shift()),b&&b.chainJoin(S,E),y[S]=D.concat(R),y.splice(E,1)}}),e}},{}],262:[function(v,J,Z){function p(b,y,e){var n=[];return b.forEach(function(t){var a=(t.myFill.above?8:0)+(t.myFill.below?4:0)+(t.otherFill&&t.otherFill.above?2:0)+(t.otherFill&&t.otherFill.below?1:0);y[a]!==0&&n.push({id:e?e.segmentId():-1,start:t.start,end:t.end,myFill:{above:y[a]===1,below:y[a]===2},otherFill:null})}),e&&e.selected(n),n}var g={union:function(b,y){return p(b,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],y)},intersect:function(b,y){return p(b,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],y)},difference:function(b,y){return p(b,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],y)},differenceRev:function(b,y){return p(b,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],y)},xor:function(b,y){return p(b,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],y)}};J.exports=g},{}],263:[function(v,J,Z){var p=v("stream").Transform,g=v("stream-parser");function b(){p.call(this,{readableObjectMode:!0})}function y(e,n,t){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||"",this.name=this.constructor.name,this.message=e,n&&(this.code=n),t&&(this.statusCode=t)}b.prototype=Object.create(p.prototype),b.prototype.constructor=b,g(b.prototype),Z.ParserStream=b,Z.sliceEq=function(e,n,t){for(var a=n,r=0;r<t.length;)if(e[a++]!==t[r++])return!1;return!0},Z.str2arr=function(e,n){var t=[],a=0;if(n&&n==="hex")for(;a<e.length;)t.push(parseInt(e.slice(a,a+2),16)),a+=2;else for(;a<e.length;a++)t.push(255&e.charCodeAt(a));return t},Z.readUInt16LE=function(e,n){return e[n]|e[n+1]<<8},Z.readUInt16BE=function(e,n){return e[n+1]|e[n]<<8},Z.readUInt32LE=function(e,n){return e[n]|e[n+1]<<8|e[n+2]<<16|16777216*e[n+3]},Z.readUInt32BE=function(e,n){return e[n+3]|e[n+2]<<8|e[n+1]<<16|16777216*e[n]},y.prototype=Object.create(Error.prototype),y.prototype.constructor=y,Z.ProbeError=y},{stream:286,"stream-parser":302}],264:[function(v,J,Z){function p(y,e){var n=new Error(y);return n.code=e,n}function g(y){try{return decodeURIComponent(escape(y))}catch{return y}}function b(y,e,n){this.input=y.subarray(e,n),this.start=e;var t=String.fromCharCode.apply(null,this.input.subarray(0,4));if(t!=="II*\0"&&t!=="MM\0*")throw p("invalid TIFF signature","EBADDATA");this.big_endian=t[0]==="M"}b.prototype.each=function(y){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var n=this.ifds_to_read.shift();n.offset&&this.scan_ifd(n.id,n.offset,y)}},b.prototype.read_uint16=function(y){var e=this.input;if(y+2>e.length)throw p("unexpected EOF","EBADDATA");return this.big_endian?256*e[y]+e[y+1]:e[y]+256*e[y+1]},b.prototype.read_uint32=function(y){var e=this.input;if(y+4>e.length)throw p("unexpected EOF","EBADDATA");return this.big_endian?16777216*e[y]+65536*e[y+1]+256*e[y+2]+e[y+3]:e[y]+256*e[y+1]+65536*e[y+2]+16777216*e[y+3]},b.prototype.is_subifd_link=function(y,e){return y===0&&e===34665||y===0&&e===34853||y===34665&&e===40965},b.prototype.exif_format_length=function(y){switch(y){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},b.prototype.exif_format_read=function(y,e){var n;switch(y){case 1:case 2:return n=this.input[e];case 6:return(n=this.input[e])|33554430*(128&n);case 3:return n=this.read_uint16(e);case 8:return(n=this.read_uint16(e))|131070*(32768&n);case 4:return n=this.read_uint32(e);case 9:return 0|(n=this.read_uint32(e));case 5:case 10:case 11:case 12:case 7:default:return null}},b.prototype.scan_ifd=function(y,e,n){var t=this.read_uint16(e);e+=2;for(var a=0;a<t;a++){var r=this.read_uint16(e),m=this.read_uint16(e+2),o=this.read_uint32(e+4),i=this.exif_format_length(m),u=o*i,f=u<=4?e+8:this.read_uint32(e+8),l=!1;if(f+u>this.input.length)throw p("unexpected EOF","EBADDATA");for(var h=[],d=f,s=0;s<o;s++,d+=i){var x=this.exif_format_read(m,d);if(x===null){h=null;break}h.push(x)}if(Array.isArray(h)&&m===2&&(h=g(String.fromCharCode.apply(null,h)))&&h[h.length-1]==="\0"&&(h=h.slice(0,-1)),this.is_subifd_link(y,r)&&Array.isArray(h)&&Number.isInteger(h[0])&&h[0]>0&&(this.ifds_to_read.push({id:r,offset:h[0]}),l=!0),n({is_big_endian:this.big_endian,ifd:y,tag:r,format:m,count:o,entry_offset:e+this.start,data_length:u,data_offset:f+this.start,value:h,is_subifd_link:l})===!1)return void(this.aborted=!0);e+=12}y===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},J.exports.ExifParser=b,J.exports.get_orientation=function(y){var e=0;try{return new b(y,0,y.length).each(function(n){if(n.ifd===0&&n.tag===274&&Array.isArray(n.value))return e=n.value[0],!1}),e}catch{return-1}}},{}],265:[function(v,J,Z){var p=v("./common").readUInt16BE,g=v("./common").readUInt32BE;function b(r,m){if(r.length<4+m)return null;var o=g(r,m);return r.length<o+m||o<8?null:{boxtype:String.fromCharCode.apply(null,r.slice(m+4,m+8)),data:r.slice(m+8,m+o),end:m+o}}function y(r,m){for(var o=0;;){var i=b(r,o);if(!i)break;switch(i.boxtype){case"ispe":m.sizes.push({width:g(i.data,4),height:g(i.data,8)});break;case"irot":m.transforms.push({type:"irot",value:3&i.data[0]});break;case"imir":m.transforms.push({type:"imir",value:1&i.data[0]})}o=i.end}}function e(r,m,o){for(var i=0,u=0;u<o;u++)i=256*i+(r[m+u]||0);return i}function n(r,m){for(var o=r[4]>>4&15,i=15&r[4],u=r[5]>>4&15,f=p(r,6),l=8,h=0;h<f;h++){var d=p(r,l),s=p(r,l+=2),x=e(r,l+=2,u),c=p(r,l+=u);if(l+=2,s===0&&c===1){var T=e(r,l,o),_=e(r,l+o,i);m.item_loc[d]={length:_,offset:T+x}}l+=c*(o+i)}}function t(r,m){for(var o=p(r,4),i=6,u=0;u<o;u++){var f=b(r,i);if(!f)break;if(f.boxtype==="infe"){for(var l=p(f.data,4),h="",d=8;d<f.data.length&&f.data[d];d++)h+=String.fromCharCode(f.data[d]);m.item_inf[h]=l}i=f.end}}function a(r,m){for(var o=0;;){var i=b(r,o);if(!i)break;i.boxtype==="ipco"&&y(i.data,m),o=i.end}}J.exports.unbox=b,J.exports.readSizeFromMeta=function(r){var m={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(d,s){for(var x=4;;){var c=b(d,x);if(!c)break;c.boxtype==="iprp"&&a(c.data,s),c.boxtype==="iloc"&&n(c.data,s),c.boxtype==="iinf"&&t(c.data,s),x=c.end}}(r,m),m.sizes.length){var o,i,u,f=(o=m.sizes,i=o.reduce(function(d,s){return d.width>s.width||d.width===s.width&&d.height>s.height?d:s}),u=o.reduce(function(d,s){return d.height>s.height||d.height===s.height&&d.width>s.width?d:s}),i.width>u.height||i.width===u.height&&i.height>u.width?i:u),l=1;m.transforms.forEach(function(d){var s={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},x={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(d.type==="imir"&&(l=d.value===0?x[l]:s[l=s[l=x[l]]]),d.type==="irot")for(var c=0;c<d.value;c++)l=s[l]});var h=null;return m.item_inf.Exif&&(h=m.item_loc[m.item_inf.Exif]),{width:f.width,height:f.height,orientation:m.transforms.length?l:null,variants:m.sizes,exif_location:h}}},J.exports.getMimeType=function(r){var m=String.fromCharCode.apply(null,r.slice(0,4)),o={};o[m]=!0;for(var i=8;i<r.length;i+=4)o[String.fromCharCode.apply(null,r.slice(i,i+4))]=!0;if(o.mif1||o.msf1||o.miaf)return m==="avif"||m==="avis"||m==="avio"?{type:"avif",mime:"image/avif"}:m==="heic"||m==="heix"?{type:"heic",mime:"image/heic"}:m==="hevc"||m==="hevx"?{type:"heic",mime:"image/heic-sequence"}:o.avif||o.avis?{type:"avif",mime:"image/avif"}:o.heic||o.heix||o.hevc||o.hevx||o.heis?o.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":263}],266:[function(v,J,Z){var p=v("../common").str2arr,g=v("../common").sliceEq,b=v("../common").readUInt32BE,y=v("../miaf_utils"),e=v("../exif_utils"),n=p("ftyp");J.exports=function(t){if(g(t,4,n)){var a=y.unbox(t,0);if(a){var r=y.getMimeType(a.data);if(r){for(var m,o=a.end;;){var i=y.unbox(t,o);if(!i)break;if(o=i.end,i.boxtype==="mdat")return;if(i.boxtype==="meta"){m=i.data;break}}if(m){var u=y.readSizeFromMeta(m);if(u){var f={width:u.width,height:u.height,type:r.type,mime:r.mime,wUnits:"px",hUnits:"px"};if(u.variants.length>1&&(f.variants=u.variants),u.orientation&&(f.orientation=u.orientation),u.exif_location&&u.exif_location.offset+u.exif_location.length<=t.length){var l=b(t,u.exif_location.offset),h=t.slice(u.exif_location.offset+l+4,u.exif_location.offset+u.exif_location.length),d=e.get_orientation(h);d>0&&(f.orientation=d)}return f}}}}}}},{"../common":263,"../exif_utils":264,"../miaf_utils":265}],267:[function(v,J,Z){var p=v("../common").str2arr,g=v("../common").sliceEq,b=v("../common").readUInt16LE,y=p("BM");J.exports=function(e){if(!(e.length<26)&&g(e,0,y))return{width:b(e,18),height:b(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":263}],268:[function(v,J,Z){var p=v("../common").str2arr,g=v("../common").sliceEq,b=v("../common").readUInt16LE,y=p("GIF87a"),e=p("GIF89a");J.exports=function(n){if(!(n.length<10)&&(g(n,0,y)||g(n,0,e)))return{width:b(n,6),height:b(n,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":263}],269:[function(v,J,Z){var p=v("../common").readUInt16LE;J.exports=function(g){var b=p(g,0),y=p(g,2),e=p(g,4);if(b===0&&y===1&&e){for(var n=[],t={width:0,height:0},a=0;a<e;a++){var r=g[6+16*a]||256,m=g[6+16*a+1]||256,o={width:r,height:m};n.push(o),(r>t.width||m>t.height)&&(t=o)}return{width:t.width,height:t.height,variants:n,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":263}],270:[function(v,J,Z){var p=v("../common").readUInt16BE,g=v("../common").str2arr,b=v("../common").sliceEq,y=v("../exif_utils"),e=g("Exif\0\0");J.exports=function(n){if(!(n.length<2)&&n[0]===255&&n[1]===216&&n[2]===255)for(var t=2;;){for(;;){if(n.length-t<2)return;if(n[t++]===255)break}for(var a,r,m=n[t++];m===255;)m=n[t++];if(208<=m&&m<=217||m===1)a=0;else{if(!(192<=m&&m<=254)||n.length-t<2)return;a=p(n,t)-2,t+=2}if(m===217||m===218)return;if(m===225&&a>=10&&b(n,t,e)&&(r=y.get_orientation(n.slice(t+6,t+a))),a>=5&&192<=m&&m<=207&&m!==196&&m!==200&&m!==204){if(n.length-t<a)return;var o={width:p(n,t+3),height:p(n,t+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return r>0&&(o.orientation=r),o}t+=a}}},{"../common":263,"../exif_utils":264}],271:[function(v,J,Z){var p=v("../common").str2arr,g=v("../common").sliceEq,b=v("../common").readUInt32BE,y=p(`\x89PNG\r

`),e=p("IHDR");J.exports=function(n){if(!(n.length<24)&&g(n,0,y)&&g(n,12,e))return{width:b(n,16),height:b(n,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":263}],272:[function(v,J,Z){var p=v("../common").str2arr,g=v("../common").sliceEq,b=v("../common").readUInt32BE,y=p("8BPS\0");J.exports=function(e){if(!(e.length<22)&&g(e,0,y))return{width:b(e,18),height:b(e,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":263}],273:[function(v,J,Z){function p(r){return typeof r=="number"&&isFinite(r)&&r>0}var g=/<[-_.:a-zA-Z0-9][^>]*>/,b=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,y=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,e=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,n=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,t=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function a(r){return t.test(r)?r.match(t)[0]:"px"}J.exports=function(r){if(function(T){var _,w=0,k=T.length;for(T[0]===239&&T[1]===187&&T[2]===191&&(w=3);w<k&&((_=T[w])===32||_===9||_===13||_===10);)w++;return w!==k&&T[w]===60}(r)){for(var m="",o=0;o<r.length;o++)m+=String.fromCharCode(r[o]);var i=(m.match(g)||[""])[0];if(b.test(i)){var u=function(T){var _=T.match(y),w=T.match(e),k=T.match(n);return{width:_&&(_[1]||_[2]),height:w&&(w[1]||w[2]),viewbox:k&&(k[1]||k[2])}}(i),f=parseFloat(u.width),l=parseFloat(u.height);if(u.width&&u.height)return!p(f)||!p(l)?void 0:{width:f,height:l,type:"svg",mime:"image/svg+xml",wUnits:a(u.width),hUnits:a(u.height)};var h=(u.viewbox||"").split(" "),d={width:h[2],height:h[3]},s=parseFloat(d.width),x=parseFloat(d.height);if(p(s)&&p(x)&&a(d.width)===a(d.height)){var c=s/x;return u.width?p(f)?{width:f,height:f/c,type:"svg",mime:"image/svg+xml",wUnits:a(u.width),hUnits:a(u.width)}:void 0:u.height?p(l)?{width:l*c,height:l,type:"svg",mime:"image/svg+xml",wUnits:a(u.height),hUnits:a(u.height)}:void 0:{width:s,height:x,type:"svg",mime:"image/svg+xml",wUnits:a(d.width),hUnits:a(d.height)}}}}}},{}],274:[function(v,J,Z){var p=v("../common").str2arr,g=v("../common").sliceEq,b=v("../common").readUInt16LE,y=v("../common").readUInt16BE,e=v("../common").readUInt32LE,n=v("../common").readUInt32BE,t=p("II*\0"),a=p("MM\0*");function r(i,u,f){return f?y(i,u):b(i,u)}function m(i,u,f){return f?n(i,u):e(i,u)}function o(i,u,f){var l=r(i,u+2,f);return m(i,u+4,f)!==1||l!==3&&l!==4?null:l===3?r(i,u+8,f):m(i,u+8,f)}J.exports=function(i){if(!(i.length<8)&&(g(i,0,t)||g(i,0,a))){var u=i[0]===77,f=m(i,4,u)-8;if(!(f<0)){var l=f+8;if(!(i.length-l<2)){var h=12*r(i,l+0,u);if(!(h<=0||(l+=2,i.length-l<h))){var d,s,x,c;for(d=0;d<h;d+=12)(c=r(i,l+d,u))===256?s=o(i,l+d,u):c===257&&(x=o(i,l+d,u));return s&&x?{width:s,height:x,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}:void 0}}}}}},{"../common":263}],275:[function(v,J,Z){var p=v("../common").str2arr,g=v("../common").sliceEq,b=v("../common").readUInt16LE,y=v("../common").readUInt32LE,e=v("../exif_utils"),n=p("RIFF"),t=p("WEBP");function a(o,i){if(o[i+3]===157&&o[i+4]===1&&o[i+5]===42)return{width:16383&b(o,i+6),height:16383&b(o,i+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function r(o,i){if(o[i]===47){var u=y(o,i+1);return{width:1+(16383&u),height:1+(u>>14&16383),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function m(o,i){return{width:1+(o[i+6]<<16|o[i+5]<<8|o[i+4]),height:1+(o[i+9]<<i|o[i+8]<<8|o[i+7]),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}J.exports=function(o){if(!(o.length<16)&&(g(o,0,n)||g(o,8,t))){var i=12,u=null,f=0,l=y(o,4)+8;if(!(l>o.length)){for(;i+8<l;)if(o[i]!==0){var h=String.fromCharCode.apply(null,o.slice(i,i+4)),d=y(o,i+4);h==="VP8 "&&d>=10?u=u||a(o,i+8):h==="VP8L"&&d>=9?u=u||r(o,i+8):h==="VP8X"&&d>=10?u=u||m(o,i+8):h==="EXIF"&&(f=e.get_orientation(o.slice(i+8,i+8+d)),i=1/0),i+=8+d}else i++;if(u)return f>0&&(u.orientation=f),u}}}},{"../common":263,"../exif_utils":264}],276:[function(v,J,Z){J.exports={avif:v("./parse_sync/avif"),bmp:v("./parse_sync/bmp"),gif:v("./parse_sync/gif"),ico:v("./parse_sync/ico"),jpeg:v("./parse_sync/jpeg"),png:v("./parse_sync/png"),psd:v("./parse_sync/psd"),svg:v("./parse_sync/svg"),tiff:v("./parse_sync/tiff"),webp:v("./parse_sync/webp")}},{"./parse_sync/avif":266,"./parse_sync/bmp":267,"./parse_sync/gif":268,"./parse_sync/ico":269,"./parse_sync/jpeg":270,"./parse_sync/png":271,"./parse_sync/psd":272,"./parse_sync/svg":273,"./parse_sync/tiff":274,"./parse_sync/webp":275}],277:[function(v,J,Z){var p=v("./lib/parsers_sync");J.exports=function(g){return function(b){for(var y=Object.keys(p),e=0;e<y.length;e++){var n=p[y[e]](b);if(n)return n}return null}(g)},J.exports.parsers=p},{"./lib/parsers_sync":276}],278:[function(v,J,Z){var p,g,b=J.exports={};function y(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function n(l){if(p===setTimeout)return setTimeout(l,0);if((p===y||!p)&&setTimeout)return p=setTimeout,setTimeout(l,0);try{return p(l,0)}catch{try{return p.call(null,l,0)}catch{return p.call(this,l,0)}}}(function(){try{p=typeof setTimeout=="function"?setTimeout:y}catch{p=y}try{g=typeof clearTimeout=="function"?clearTimeout:e}catch{g=e}})();var t,a=[],r=!1,m=-1;function o(){r&&t&&(r=!1,t.length?a=t.concat(a):m=-1,a.length&&i())}function i(){if(!r){var l=n(o);r=!0;for(var h=a.length;h;){for(t=a,a=[];++m<h;)t&&t[m].run();m=-1,h=a.length}t=null,r=!1,function(d){if(g===clearTimeout)return clearTimeout(d);if((g===e||!g)&&clearTimeout)return g=clearTimeout,clearTimeout(d);try{g(d)}catch{try{return g.call(null,d)}catch{return g.call(this,d)}}}(l)}}function u(l,h){this.fun=l,this.array=h}function f(){}b.nextTick=function(l){var h=new Array(arguments.length-1);if(arguments.length>1)for(var d=1;d<arguments.length;d++)h[d-1]=arguments[d];a.push(new u(l,h)),a.length!==1||r||n(i)},u.prototype.run=function(){this.fun.apply(null,this.array)},b.title="browser",b.browser=!0,b.env={},b.argv=[],b.version="",b.versions={},b.on=f,b.addListener=f,b.once=f,b.off=f,b.removeListener=f,b.removeAllListeners=f,b.emit=f,b.prependListener=f,b.prependOnceListener=f,b.listeners=function(l){return[]},b.binding=function(l){throw new Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(l){throw new Error("process.chdir is not supported")},b.umask=function(){return 0}},{}],279:[function(v,J,Z){(function(p){(function(){for(var g=v("performance-now"),b=typeof window>"u"?p:window,y=["moz","webkit"],e="AnimationFrame",n=b["request"+e],t=b["cancel"+e]||b["cancelRequest"+e],a=0;!n&&a<y.length;a++)n=b[y[a]+"Request"+e],t=b[y[a]+"Cancel"+e]||b[y[a]+"CancelRequest"+e];if(!n||!t){var r=0,m=0,o=[];n=function(i){if(o.length===0){var u=g(),f=Math.max(0,1e3/60-(u-r));r=f+u,setTimeout(function(){var l=o.slice(0);o.length=0;for(var h=0;h<l.length;h++)if(!l[h].cancelled)try{l[h].callback(r)}catch(d){setTimeout(function(){throw d},0)}},Math.round(f))}return o.push({handle:++m,callback:i,cancelled:!1}),m},t=function(i){for(var u=0;u<o.length;u++)o[u].handle===i&&(o[u].cancelled=!0)}}J.exports=function(i){return n.call(b,i)},J.exports.cancel=function(){t.apply(b,arguments)},J.exports.polyfill=function(i){i||(i=b),i.requestAnimationFrame=n,i.cancelAnimationFrame=t}}).call(this)}).call(this,typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":252}],280:[function(v,J,Z){var p=v("array-bounds"),g=v("color-normalize"),b=v("update-diff"),y=v("pick-by-alias"),e=v("object-assign"),n=v("flatten-vertex-data"),t=v("to-float32"),a=t.float32,r=t.fract32;J.exports=function(o,i){if(typeof o=="function"?(i||(i={}),i.regl=o):i=o,i.length&&(i.positions=i),!(o=i.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var u,f,l,h,d,s,x=o._gl,c={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},T=[];return h=o.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),f=o.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),l=o.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),d=o.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),s=o.buffer({usage:"static",type:"float",data:m}),L(i),u=o({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:o.prop("range"),lineWidth:o.prop("lineWidth"),capSize:o.prop("capSize"),opacity:o.prop("opacity"),scale:o.prop("scale"),translate:o.prop("translate"),scaleFract:o.prop("scaleFract"),translateFract:o.prop("translateFract"),viewport:function(I,P){return[P.viewport.x,P.viewport.y,I.viewportWidth,I.viewportHeight]}},attributes:{color:{buffer:h,offset:function(I,P){return 4*P.offset},divisor:1},position:{buffer:f,offset:function(I,P){return 8*P.offset},divisor:1},positionFract:{buffer:l,offset:function(I,P){return 8*P.offset},divisor:1},error:{buffer:d,offset:function(I,P){return 16*P.offset},divisor:1},direction:{buffer:s,stride:24,offset:0},lineOffset:{buffer:s,stride:24,offset:8},capOffset:{buffer:s,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:o.prop("viewport")},viewport:o.prop("viewport"),stencil:!1,instances:o.prop("count"),count:m.length}),e(_,{update:L,draw:w,destroy:A,regl:o,gl:x,canvas:x.canvas,groups:T}),_;function _(I){I?L(I):I===null&&A(),w()}function w(I){if(typeof I=="number")return k(I);I&&!Array.isArray(I)&&(I=[I]),o._refresh(),T.forEach(function(P,S){P&&(I&&(I[S]?P.draw=!0:P.draw=!1),P.draw?k(S):P.draw=!0)})}function k(I){typeof I=="number"&&(I=T[I]),I!=null&&I&&I.count&&I.color&&I.opacity&&I.positions&&I.positions.length>1&&(I.scaleRatio=[I.scale[0]*I.viewport.width,I.scale[1]*I.viewport.height],u(I),I.after&&I.after(I))}function L(I){if(I){I.length!=null?typeof I[0]=="number"&&(I=[{positions:I}]):Array.isArray(I)||(I=[I]);var P=0,S=0;if(_.groups=T=I.map(function($,G){var W=T[G];return $&&(typeof $=="function"?$={after:$}:typeof $[0]=="number"&&($={positions:$}),$=y($,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),W||(T[G]=W={id:G,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},$=e({},c,$)),b(W,$,[{lineWidth:function(te){return .5*+te},capSize:function(te){return .5*+te},opacity:parseFloat,errors:function(te){return te=n(te),S+=te.length,te},positions:function(te,N){return te=n(te,"float64"),N.count=Math.floor(te.length/2),N.bounds=p(te,2),N.offset=P,P+=N.count,te}},{color:function(te,N){var B=N.count;if(te||(te="transparent"),!Array.isArray(te)||typeof te[0]=="number"){var U=te;te=Array(B);for(var ee=0;ee<B;ee++)te[ee]=U}if(te.length<B)throw Error("Not enough colors");for(var j=new Uint8Array(4*B),Q=0;Q<B;Q++){var K=g(te[Q],"uint8");j.set(K,4*Q)}return j},range:function(te,N,B){var U=N.bounds;return te||(te=U),N.scale=[1/(te[2]-te[0]),1/(te[3]-te[1])],N.translate=[-te[0],-te[1]],N.scaleFract=r(N.scale),N.translateFract=r(N.translate),te},viewport:function(te){var N;return Array.isArray(te)?N={x:te[0],y:te[1],width:te[2]-te[0],height:te[3]-te[1]}:te?(N={x:te.x||te.left||0,y:te.y||te.top||0},te.right?N.width=te.right-N.x:N.width=te.w||te.width||0,te.bottom?N.height=te.bottom-N.y:N.height=te.h||te.height||0):N={x:0,y:0,width:x.drawingBufferWidth,height:x.drawingBufferHeight},N}}])),W}),P||S){var E=T.reduce(function($,G,W){return $+(G?G.count:0)},0),D=new Float64Array(2*E),R=new Uint8Array(4*E),H=new Float32Array(4*E);T.forEach(function($,G){if($){var W=$.positions,te=$.count,N=$.offset,B=$.color,U=$.errors;te&&(R.set(B,4*N),H.set(U,4*N),D.set(W,2*N))}});var V=a(D);f(V);var X=r(D,V);l(X),h(R),d(H)}}}function A(){f.destroy(),l.destroy(),h.destroy(),d.destroy(),s.destroy()}};var m=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":314,"update-diff":330}],281:[function(v,J,Z){var p=v("color-normalize"),g=v("array-bounds"),b=v("object-assign"),y=v("glslify"),e=v("pick-by-alias"),n=v("flatten-vertex-data"),t=v("earcut"),a=v("array-normalize"),r=v("to-float32"),m=r.float32,o=r.fract32,i=v("es6-weak-map"),u=v("parse-rect"),f=v("array-find-index");function l(h,d){if(!(this instanceof l))return new l(h,d);if(typeof h=="function"?(d||(d={}),d.regl=h):d=h,d.length&&(d.positions=d),!(h=d.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=h._gl,this.regl=h,this.passes=[],this.shaders=l.shaders.has(h)?l.shaders.get(h):l.shaders.set(h,l.createShaders(h)).get(h),this.update(d)}J.exports=l,l.dashMult=2,l.maxPatternLength=256,l.precisionThreshold=3e6,l.maxPoints=1e4,l.maxLines=2048,l.shaders=new i,l.createShaders=function(h){var d,s=h.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),x={primitive:"triangle strip",instances:h.prop("count"),count:4,offset:0,uniforms:{miterMode:function(T,_){return _.join==="round"?2:1},miterLimit:h.prop("miterLimit"),scale:h.prop("scale"),scaleFract:h.prop("scaleFract"),translateFract:h.prop("translateFract"),translate:h.prop("translate"),thickness:h.prop("thickness"),dashTexture:h.prop("dashTexture"),opacity:h.prop("opacity"),pixelRatio:h.context("pixelRatio"),id:h.prop("id"),dashLength:h.prop("dashLength"),viewport:function(T,_){return[_.viewport.x,_.viewport.y,T.viewportWidth,T.viewportHeight]},depth:h.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(T,_){return!_.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:h.prop("viewport")},viewport:h.prop("viewport")},c=h(b({vert:y([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:y([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:s,divisor:0,stride:8,offset:0},lineTop:{buffer:s,divisor:0,stride:8,offset:4},aCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:h.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},x));try{d=h(b({cull:{enable:!0,face:"back"},vert:y([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:y([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:s,divisor:0,stride:8,offset:0},lineTop:{buffer:s,divisor:0,stride:8,offset:4},aColor:{buffer:h.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:h.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},x))}catch{d=c}return{fill:h({primitive:"triangle",elements:function(T,_){return _.triangles},offset:0,vert:y([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:y([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:h.prop("scale"),color:h.prop("fill"),scaleFract:h.prop("scaleFract"),translateFract:h.prop("translateFract"),translate:h.prop("translate"),opacity:h.prop("opacity"),pixelRatio:h.context("pixelRatio"),id:h.prop("id"),viewport:function(T,_){return[_.viewport.x,_.viewport.y,T.viewportWidth,T.viewportHeight]}},attributes:{position:{buffer:h.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:8}},blend:x.blend,depth:{enable:!1},scissor:x.scissor,stencil:x.stencil,viewport:x.viewport}),rect:c,miter:d}},l.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},l.prototype.render=function(){for(var h,d=[],s=arguments.length;s--;)d[s]=arguments[s];d.length&&(h=this).update.apply(h,d),this.draw()},l.prototype.draw=function(){for(var h=this,d=[],s=arguments.length;s--;)d[s]=arguments[s];return(d.length?d:this.passes).forEach(function(x,c){var T;if(x&&Array.isArray(x))return(T=h).draw.apply(T,x);typeof x=="number"&&(x=h.passes[x]),x&&x.count>1&&x.opacity&&(h.regl._refresh(),x.fill&&x.triangles&&x.triangles.length>2&&h.shaders.fill(x),x.thickness&&(x.scale[0]*x.viewport.width>l.precisionThreshold||x.scale[1]*x.viewport.height>l.precisionThreshold||x.join==="rect"||!x.join&&(x.thickness<=2||x.count>=l.maxPoints)?h.shaders.rect(x):h.shaders.miter(x)))}),this},l.prototype.update=function(h){var d=this;if(h){h.length!=null?typeof h[0]=="number"&&(h=[{positions:h}]):Array.isArray(h)||(h=[h]);var s=this.regl,x=this.gl;if(h.forEach(function(k,L){var A=d.passes[L];if(k!==void 0)if(k!==null){if(typeof k[0]=="number"&&(k={positions:k}),k=e(k,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),A||(d.passes[L]=A={id:L,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:s.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:s.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:s.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:s.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},k=b({},l.defaults,k)),k.thickness!=null&&(A.thickness=parseFloat(k.thickness)),k.opacity!=null&&(A.opacity=parseFloat(k.opacity)),k.miterLimit!=null&&(A.miterLimit=parseFloat(k.miterLimit)),k.overlay!=null&&(A.overlay=!!k.overlay,L<l.maxLines&&(A.depth=2*(l.maxLines-1-L%l.maxLines)/l.maxLines-1)),k.join!=null&&(A.join=k.join),k.hole!=null&&(A.hole=k.hole),k.fill!=null&&(A.fill=k.fill?p(k.fill,"uint8"):null),k.viewport!=null&&(A.viewport=u(k.viewport)),A.viewport||(A.viewport=u([x.drawingBufferWidth,x.drawingBufferHeight])),k.close!=null&&(A.close=k.close),k.positions===null&&(k.positions=[]),k.positions){var I,P;if(k.positions.x&&k.positions.y){var S=k.positions.x,E=k.positions.y;P=A.count=Math.max(S.length,E.length),I=new Float64Array(2*P);for(var D=0;D<P;D++)I[2*D]=S[D],I[2*D+1]=E[D]}else I=n(k.positions,"float64"),P=A.count=Math.floor(I.length/2);var R=A.bounds=g(I,2);if(A.fill){for(var H=[],V={},X=0,$=0,G=0,W=A.count;$<W;$++){var te=I[2*$],N=I[2*$+1];isNaN(te)||isNaN(N)||te==null||N==null?(te=I[2*X],N=I[2*X+1],V[$]=X):X=$,H[G++]=te,H[G++]=N}if(k.splitNull){A.count-1 in V||(V[A.count]=A.count-1);var B=Object.keys(V).map(Number).sort(function(vt,Nt){return vt-Nt}),U=[],ee=0,j=A.hole!=null?A.hole[0]:null;if(j!=null){var Q=f(B,function(vt){return vt>=j});(B=B.slice(0,Q)).push(j)}for(var K=function(vt){var Nt=H.slice(2*ee,2*B[vt]).concat(j?H.slice(2*j):[]),qt=(A.hole||[]).map(function(Jt){return Jt-j+(B[vt]-ee)}),er=t(Nt,qt);er=er.map(function(Jt){return Jt+ee+(Jt+ee<B[vt]?0:j-B[vt])}),U.push.apply(U,er),ee=B[vt]+1},re=0;re<B.length;re++)K(re);for(var ne=0,le=U.length;ne<le;ne++)V[U[ne]]!=null&&(U[ne]=V[U[ne]]);A.triangles=U}else{for(var oe=t(H,A.hole||[]),de=0,se=oe.length;de<se;de++)V[oe[de]]!=null&&(oe[de]=V[oe[de]]);A.triangles=oe}}var me=new Float64Array(I);a(me,2,R);var Te=new Float64Array(2*P+6);A.close?I[0]===I[2*P-2]&&I[1]===I[2*P-1]?(Te[0]=me[2*P-4],Te[1]=me[2*P-3]):(Te[0]=me[2*P-2],Te[1]=me[2*P-1]):(Te[0]=me[0],Te[1]=me[1]),Te.set(me,2),A.close?I[0]===I[2*P-2]&&I[1]===I[2*P-1]?(Te[2*P+2]=me[2],Te[2*P+3]=me[3],A.count-=1):(Te[2*P+2]=me[0],Te[2*P+3]=me[1],Te[2*P+4]=me[2],Te[2*P+5]=me[3]):(Te[2*P+2]=me[2*P-2],Te[2*P+3]=me[2*P-1],Te[2*P+4]=me[2*P-2],Te[2*P+5]=me[2*P-1]);var _e=m(Te);A.positionBuffer(_e);var be=o(Te,_e);A.positionFractBuffer(be)}if(k.range?A.range=k.range:A.range||(A.range=A.bounds),(k.range||k.positions)&&A.count){var Ce=A.bounds,fe=Ce[2]-Ce[0],ve=Ce[3]-Ce[1],Me=A.range[2]-A.range[0],ke=A.range[3]-A.range[1];A.scale=[fe/Me,ve/ke],A.translate=[-A.range[0]/Me+Ce[0]/Me||0,-A.range[1]/ke+Ce[1]/ke||0],A.scaleFract=o(A.scale),A.translateFract=o(A.translate)}if(k.dashes){var Le,ze=0;if(!k.dashes||k.dashes.length<2)ze=1,Le=new Uint8Array([255,255,255,255,255,255,255,255]);else{ze=0;for(var Re=0;Re<k.dashes.length;++Re)ze+=k.dashes[Re];Le=new Uint8Array(ze*l.dashMult);for(var Oe=0,Ze=255,Pe=0;Pe<2;Pe++)for(var Ie=0;Ie<k.dashes.length;++Ie){for(var Be=0,Fe=k.dashes[Ie]*l.dashMult*.5;Be<Fe;++Be)Le[Oe++]=Ze;Ze^=255}}A.dashLength=ze,A.dashTexture({channels:1,data:Le,width:Le.length,height:1,mag:"linear",min:"linear"},0,0)}if(k.color){var $e=A.count,ot=k.color;ot||(ot="transparent");var pt=new Uint8Array(4*$e+4);if(Array.isArray(ot)&&typeof ot[0]!="number"){for(var _t=0;_t<$e;_t++){var yt=p(ot[_t],"uint8");pt.set(yt,4*_t)}pt.set(p(ot[0],"uint8"),4*$e)}else for(var tt=p(ot,"uint8"),Ke=0;Ke<$e+1;Ke++)pt.set(tt,4*Ke);A.colorBuffer({usage:"dynamic",type:"uint8",data:pt})}}else d.passes[L]=null}),h.length<this.passes.length){for(var c=h.length;c<this.passes.length;c++){var T=this.passes[c];T&&(T.colorBuffer.destroy(),T.positionBuffer.destroy(),T.dashTexture.destroy())}this.passes.length=h.length}for(var _=[],w=0;w<this.passes.length;w++)this.passes[w]!==null&&_.push(this.passes[w]);return this.passes=_,this}},l.prototype.destroy=function(){return this.passes.forEach(function(h){h.colorBuffer.destroy(),h.positionBuffer.destroy(),h.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314}],282:[function(v,J,Z){function p(c,T){return function(_){if(Array.isArray(_))return _}(c)||function(_,w){var k=_==null?null:typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(k!=null){var L,A,I=[],P=!0,S=!1;try{for(k=k.call(_);!(P=(L=k.next()).done)&&(I.push(L.value),!w||I.length!==w);P=!0);}catch(E){S=!0,A=E}finally{try{P||k.return==null||k.return()}finally{if(S)throw A}}return I}}(c,T)||b(c,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function g(c){return function(T){if(Array.isArray(T))return y(T)}(c)||function(T){if(typeof Symbol<"u"&&T[Symbol.iterator]!=null||T["@@iterator"]!=null)return Array.from(T)}(c)||b(c)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function b(c,T){if(c){if(typeof c=="string")return y(c,T);var _=Object.prototype.toString.call(c).slice(8,-1);return _==="Object"&&c.constructor&&(_=c.constructor.name),_==="Map"||_==="Set"?Array.from(c):_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?y(c,T):void 0}}function y(c,T){(T==null||T>c.length)&&(T=c.length);for(var _=0,w=new Array(T);_<T;_++)w[_]=c[_];return w}var e=v("color-normalize"),n=v("array-bounds"),t=v("color-id"),a=v("@plotly/point-cluster"),r=v("object-assign"),m=v("glslify"),o=v("pick-by-alias"),i=v("update-diff"),u=v("flatten-vertex-data"),f=v("is-iexplorer"),l=v("to-float32"),h=v("parse-rect"),d=s;function s(c,T){var _=this;if(!(this instanceof s))return new s(c,T);typeof c=="function"?(T||(T={}),T.regl=c):(T=c,c=null),T&&T.length&&(T.positions=T);var w,k=(c=T.regl)._gl,L=[];this.tooManyColors=f,w=c.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),r(this,{regl:c,gl:k,groups:[],markerCache:[null],markerTextures:[null],palette:L,paletteIds:{},paletteTexture:w,maxColors:255,maxSize:100,canvas:k.canvas}),this.update(T);var A={uniforms:{constPointSize:!!T.constPointSize,opacity:c.prop("opacity"),paletteSize:function(S,E){return[_.tooManyColors?0:255,w.height]},pixelRatio:c.context("pixelRatio"),scale:c.prop("scale"),scaleFract:c.prop("scaleFract"),translate:c.prop("translate"),translateFract:c.prop("translateFract"),markerTexture:c.prop("markerTexture"),paletteTexture:w},attributes:{x:function(S,E){return E.xAttr||{buffer:E.positionBuffer,stride:8,offset:0}},y:function(S,E){return E.yAttr||{buffer:E.positionBuffer,stride:8,offset:4}},xFract:function(S,E){return E.xAttr?{constant:[0,0]}:{buffer:E.positionFractBuffer,stride:8,offset:0}},yFract:function(S,E){return E.yAttr?{constant:[0,0]}:{buffer:E.positionFractBuffer,stride:8,offset:4}},size:function(S,E){return E.size.length?{buffer:E.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*E.size/_.maxSize)]}},borderSize:function(S,E){return E.borderSize.length?{buffer:E.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*E.borderSize/_.maxSize)]}},colorId:function(S,E){return E.color.length?{buffer:E.colorBuffer,stride:_.tooManyColors?8:4,offset:0}:{constant:_.tooManyColors?L.slice(4*E.color,4*E.color+4):[E.color]}},borderColorId:function(S,E){return E.borderColor.length?{buffer:E.colorBuffer,stride:_.tooManyColors?8:4,offset:_.tooManyColors?4:2}:{constant:_.tooManyColors?L.slice(4*E.borderColor,4*E.borderColor+4):[E.borderColor]}},isActive:function(S,E){return E.activation===!0?{constant:[1]}:E.activation?E.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:c.prop("viewport")},viewport:c.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:c.prop("elements"),count:c.prop("count"),offset:c.prop("offset"),primitive:"points"},I=r({},A);I.frag=m([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),I.vert=m([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=c(I);var P=r({},A);P.frag=m([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),P.vert=m([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),f&&(P.frag=P.frag.replace("smoothstep","smoothStep"),I.frag=I.frag.replace("smoothstep","smoothStep")),this.drawCircle=c(P)}s.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},s.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},s.prototype.draw=function(){for(var c=this,T=arguments.length,_=new Array(T),w=0;w<T;w++)_[w]=arguments[w];var k=this.groups;if(_.length===1&&Array.isArray(_[0])&&(_[0][0]===null||Array.isArray(_[0][0]))&&(_=_[0]),this.regl._refresh(),_.length)for(var L=0;L<_.length;L++)this.drawItem(L,_[L]);else k.forEach(function(A,I){c.drawItem(I)});return this},s.prototype.drawItem=function(c,T){var _=this.groups,w=_[c];if(typeof T=="number"&&(c=T,w=_[T],T=null),w&&w.count&&w.opacity){w.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,w,T));for(var k=[],L=1;L<w.activation.length;L++)w.activation[L]&&(w.activation[L]===!0||w.activation[L].data.length)&&k.push.apply(k,g(this.getMarkerDrawOptions(L,w,T)));k.length&&this.drawMarker(k)}},s.prototype.getMarkerDrawOptions=function(c,T,_){var w=T.range,k=T.tree,L=T.viewport,A=T.activation,I=T.selectionBuffer,P=T.count;if(this.regl,!k)return _?[r({},T,{markerTexture:this.markerTextures[c],activation:A[c],count:_.length,elements:_,offset:0})]:[r({},T,{markerTexture:this.markerTextures[c],activation:A[c],offset:0})];var S=[],E=k.range(w,{lod:!0,px:[(w[2]-w[0])/L.width,(w[3]-w[1])/L.height]});if(_){for(var D=A[c].data,R=new Uint8Array(P),H=0;H<_.length;H++){var V=_[H];R[V]=D?D[V]:1}I.subdata(R)}for(var X=E.length;X--;){var $=p(E[X],2),G=$[0],W=$[1];S.push(r({},T,{markerTexture:this.markerTextures[c],activation:_?I:A[c],offset:G,count:W-G}))}return S},s.prototype.update=function(){for(var c=this,T=arguments.length,_=new Array(T),w=0;w<T;w++)_[w]=arguments[w];if(_.length){_.length===1&&Array.isArray(_[0])&&(_=_[0]);var k=this.groups,L=this.gl,A=this.regl,I=this.maxSize,P=this.maxColors,S=this.palette;this.groups=k=_.map(function(E,D){var R=k[D];if(E===void 0)return R;E===null?E={positions:null}:typeof E=="function"?E={ondraw:E}:typeof E[0]=="number"&&(E={positions:E}),(E=o(E,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions===null&&(E.positions=[]),E.tooManyColors!=null&&(c.tooManyColors=E.tooManyColors),R||(k[D]=R={id:D,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:A.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},E=r({},s.defaults,E)),E.positions&&!("marker"in E)&&(E.marker=R.marker,delete R.marker),E.marker&&!("positions"in E)&&(E.positions=R.positions,delete R.positions);var H=0,V=0;if(i(R,E,[{snap:!0,size:function(se,me){return se==null&&(se=s.defaults.size),H+=se&&se.length?1:0,se},borderSize:function(se,me){return se==null&&(se=s.defaults.borderSize),H+=se&&se.length?1:0,se},opacity:parseFloat,color:function(se,me){return se==null&&(se=s.defaults.color),se=c.updateColor(se),V++,se},borderColor:function(se,me){return se==null&&(se=s.defaults.borderColor),se=c.updateColor(se),V++,se},bounds:function(se,me,Te){return"range"in Te||(Te.range=null),se},positions:function(se,me,Te){var _e=me.snap,be=me.positionBuffer,Ce=me.positionFractBuffer,fe=me.selectionBuffer;if(se.x||se.y)return se.x.length?me.xAttr={buffer:A.buffer(se.x),offset:0,stride:4,count:se.x.length}:me.xAttr={buffer:se.x.buffer,offset:4*se.x.offset||0,stride:4*(se.x.stride||1),count:se.x.count},se.y.length?me.yAttr={buffer:A.buffer(se.y),offset:0,stride:4,count:se.y.length}:me.yAttr={buffer:se.y.buffer,offset:4*se.y.offset||0,stride:4*(se.y.stride||1),count:se.y.count},me.count=Math.max(me.xAttr.count,me.yAttr.count),se;se=u(se,"float64");var ve=me.count=Math.floor(se.length/2),Me=me.bounds=ve?n(se,2):null;if(Te.range||me.range||(delete me.range,Te.range=Me),Te.marker||me.marker||(delete me.marker,Te.marker=null),_e&&(_e===!0||ve>_e)?me.tree=a(se,{bounds:Me}):_e&&_e.length&&(me.tree=_e),me.tree){var ke={primitive:"points",usage:"static",data:me.tree,type:"uint32"};me.elements?me.elements(ke):me.elements=A.elements(ke)}var Le=l.float32(se);return be({data:Le,usage:"dynamic"}),Ce({data:l.fract32(se,Le),usage:"dynamic"}),fe({data:new Uint8Array(ve),type:"uint8",usage:"stream"}),se}},{marker:function(se,me,Te){var _e=me.activation;if(_e.forEach(function(Le){return Le&&Le.destroy&&Le.destroy()}),_e.length=0,se&&typeof se[0]!="number"){for(var be=[],Ce=0,fe=Math.min(se.length,me.count);Ce<fe;Ce++){var ve=c.addMarker(se[Ce]);be[ve]||(be[ve]=new Uint8Array(me.count)),be[ve][Ce]=1}for(var Me=0;Me<be.length;Me++)if(be[Me]){var ke={data:be[Me],type:"uint8",usage:"static"};_e[Me]?_e[Me](ke):_e[Me]=A.buffer(ke),_e[Me].data=be[Me]}}else _e[c.addMarker(se)]=!0;return se},range:function(se,me,Te){var _e=me.bounds;if(_e)return se||(se=_e),me.scale=[1/(se[2]-se[0]),1/(se[3]-se[1])],me.translate=[-se[0],-se[1]],me.scaleFract=l.fract(me.scale),me.translateFract=l.fract(me.translate),se},viewport:function(se){return h(se||[L.drawingBufferWidth,L.drawingBufferHeight])}}]),H){var X=R,$=X.count,G=X.size,W=X.borderSize,te=X.sizeBuffer,N=new Uint8Array(2*$);if(G.length||W.length)for(var B=0;B<$;B++)N[2*B]=Math.round(255*(G[B]==null?G:G[B])/I),N[2*B+1]=Math.round(255*(W[B]==null?W:W[B])/I);te({data:N,usage:"dynamic"})}if(V){var U,ee=R,j=ee.count,Q=ee.color,K=ee.borderColor,re=ee.colorBuffer;if(c.tooManyColors){if(Q.length||K.length){U=new Uint8Array(8*j);for(var ne=0;ne<j;ne++){var le=Q[ne];U[8*ne]=S[4*le],U[8*ne+1]=S[4*le+1],U[8*ne+2]=S[4*le+2],U[8*ne+3]=S[4*le+3];var oe=K[ne];U[8*ne+4]=S[4*oe],U[8*ne+5]=S[4*oe+1],U[8*ne+6]=S[4*oe+2],U[8*ne+7]=S[4*oe+3]}}}else if(Q.length||K.length){U=new Uint8Array(4*j+2);for(var de=0;de<j;de++)Q[de]!=null&&(U[4*de]=Q[de]%P,U[4*de+1]=Math.floor(Q[de]/P)),K[de]!=null&&(U[4*de+2]=K[de]%P,U[4*de+3]=Math.floor(K[de]/P))}re({data:U||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return R})}},s.prototype.addMarker=function(c){var T,_=this.markerTextures,w=this.regl,k=this.markerCache,L=c==null?0:k.indexOf(c);if(L>=0)return L;if(c instanceof Uint8Array||c instanceof Uint8ClampedArray)T=c;else{T=new Uint8Array(c.length);for(var A=0,I=c.length;A<I;A++)T[A]=255*c[A]}var P=Math.floor(Math.sqrt(T.length));return L=_.length,k.push(c),_.push(w.texture({channels:1,data:T,radius:P,mag:"linear",min:"linear"})),L},s.prototype.updateColor=function(c){var T=this.paletteIds,_=this.palette,w=this.maxColors;Array.isArray(c)||(c=[c]);var k=[];if(typeof c[0]=="number"){var L=[];if(Array.isArray(c))for(var A=0;A<c.length;A+=4)L.push(c.slice(A,A+4));else for(var I=0;I<c.length;I+=4)L.push(c.subarray(I,I+4));c=L}for(var P=0;P<c.length;P++){var S=c[P];S=e(S,"uint8");var E=t(S,!1);if(T[E]==null){var D=_.length;T[E]=Math.floor(D/4),_[D]=S[0],_[D+1]=S[1],_[D+2]=S[2],_[D+3]=S[3]}k[P]=T[E]}return!this.tooManyColors&&_.length>4*w&&(this.tooManyColors=!0),this.updatePalette(_),k.length===1?k[0]:k},s.prototype.updatePalette=function(c){if(!this.tooManyColors){var T=this.maxColors,_=this.paletteTexture,w=Math.ceil(.25*c.length/T);if(w>1)for(var k=.25*(c=c.slice()).length%T;k<w*T;k++)c.push(0,0,0,0);_.height<w&&_.resize(T,w),_.subimage({width:Math.min(.25*c.length,T),height:w,data:c},0,0)}},s.prototype.destroy=function(){return this.groups.forEach(function(c){c.sizeBuffer.destroy(),c.positionBuffer.destroy(),c.positionFractBuffer.destroy(),c.colorBuffer.destroy(),c.activation.forEach(function(T){return T&&T.destroy&&T.destroy()}),c.selectionBuffer.destroy(),c.elements&&c.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(c){return c&&c.destroy&&c.destroy()}),this};var x=v("object-assign");J.exports=function(c,T){var _=new d(c,T),w=_.render.bind(_);return x(w,{render:w,update:_.update.bind(_),draw:_.draw.bind(_),destroy:_.destroy.bind(_),regl:_.regl,gl:_.gl,canvas:_.gl.canvas,groups:_.groups,markers:_.markerCache,palette:_.palette}),w}},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314,"update-diff":330}],283:[function(v,J,Z){var p=v("regl-scatter2d"),g=v("pick-by-alias"),b=v("array-bounds"),y=v("raf"),e=v("array-range"),n=v("parse-rect"),t=v("flatten-vertex-data");function a(i,u){if(!(this instanceof a))return new a(i);this.traces=[],this.passes={},this.regl=i,this.scatter=p(i),this.canvas=this.scatter.canvas}function r(i,u,f){return(i.id!=null?i.id:i)<<16|(255&u)<<8|255&f}function m(i,u,f){var l,h,d,s,x=i[u],c=i[f];return x.length>2?(x[0],x[2],l=x[1],h=x[3]):x.length?(l=x[0],h=x[1]):(x.x,l=x.y,x.x+x.width,h=x.y+x.height),c.length>2?(d=c[0],s=c[2],c[1],c[3]):c.length?(d=c[0],s=c[1]):(d=c.x,c.y,s=c.x+c.width,c.y+c.height),[d,l,s,h]}function o(i){if(typeof i=="number")return[i,i,i,i];if(i.length===2)return[i[0],i[1],i[0],i[1]];var u=n(i);return[u.x,u.y,u.x+u.width,u.y+u.height]}J.exports=a,a.prototype.render=function(){for(var i,u=this,f=[],l=arguments.length;l--;)f[l]=arguments[l];return f.length&&(i=this).update.apply(i,f),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=y(function(){u.draw(),u.dirty=!0,u.planned=null})):(this.draw(),this.dirty=!0,y(function(){u.dirty=!1})),this)},a.prototype.update=function(){for(var i,u=[],f=arguments.length;f--;)u[f]=arguments[f];if(u.length){for(var l=0;l<u.length;l++)this.updateItem(l,u[l]);this.traces=this.traces.filter(Boolean);for(var h=[],d=0,s=0;s<this.traces.length;s++){for(var x=this.traces[s],c=this.traces[s].passes,T=0;T<c.length;T++)h.push(this.passes[c[T]]);x.passOffset=d,d+=x.passes.length}return(i=this.scatter).update.apply(i,h),this}},a.prototype.updateItem=function(i,u){var f=this.regl;if(u===null)return this.traces[i]=null,this;if(!u)return this;var l,h=g(u,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),d=this.traces[i]||(this.traces[i]={id:i,buffer:f.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:n([f._gl.drawingBufferWidth,f._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(h.color!=null&&(d.color=h.color),h.size!=null&&(d.size=h.size),h.marker!=null&&(d.marker=h.marker),h.borderColor!=null&&(d.borderColor=h.borderColor),h.borderSize!=null&&(d.borderSize=h.borderSize),h.opacity!=null&&(d.opacity=h.opacity),h.viewport&&(d.viewport=n(h.viewport)),h.diagonal!=null&&(d.diagonal=h.diagonal),h.upper!=null&&(d.upper=h.upper),h.lower!=null&&(d.lower=h.lower),h.data){d.buffer(t(h.data)),d.columns=h.data.length,d.count=h.data[0].length,d.bounds=[];for(var s=0;s<d.columns;s++)d.bounds[s]=b(h.data[s],1)}h.range&&(d.range=h.range,l=d.range&&typeof d.range[0]!="number"),h.domain&&(d.domain=h.domain);var x=!1;h.padding!=null&&(Array.isArray(h.padding)&&h.padding.length===d.columns&&typeof h.padding[h.padding.length-1]=="number"?(d.padding=h.padding.map(o),x=!0):d.padding=o(h.padding));var c=d.columns,T=d.count,_=d.viewport.width,w=d.viewport.height,k=d.viewport.x,L=d.viewport.y,A=_/c,I=w/c;d.passes=[];for(var P=0;P<c;P++)for(var S=0;S<c;S++)if((d.diagonal||S!==P)&&(d.upper||!(P>S))&&(d.lower||!(P<S))){var E=r(d.id,P,S),D=this.passes[E]||(this.passes[E]={});if(h.data&&(h.transpose?D.positions={x:{buffer:d.buffer,offset:S,count:T,stride:c},y:{buffer:d.buffer,offset:P,count:T,stride:c}}:D.positions={x:{buffer:d.buffer,offset:S*T,count:T},y:{buffer:d.buffer,offset:P*T,count:T}},D.bounds=m(d.bounds,P,S)),h.domain||h.viewport||h.data){var R=x?m(d.padding,P,S):d.padding;if(d.domain){var H=m(d.domain,P,S),V=H[0],X=H[1],$=H[2],G=H[3];D.viewport=[k+V*_+R[0],L+X*w+R[1],k+$*_-R[2],L+G*w-R[3]]}else D.viewport=[k+S*A+A*R[0],L+P*I+I*R[1],k+(S+1)*A-A*R[2],L+(P+1)*I-I*R[3]]}h.color&&(D.color=d.color),h.size&&(D.size=d.size),h.marker&&(D.marker=d.marker),h.borderSize&&(D.borderSize=d.borderSize),h.borderColor&&(D.borderColor=d.borderColor),h.opacity&&(D.opacity=d.opacity),h.range&&(D.range=l?m(d.range,P,S):d.range||D.bounds),d.passes.push(E)}return this},a.prototype.draw=function(){for(var i,u=[],f=arguments.length;f--;)u[f]=arguments[f];if(u.length){for(var l=[],h=0;h<u.length;h++)if(typeof u[h]=="number"){var d=this.traces[u[h]],s=d.passes,x=d.passOffset;l.push.apply(l,e(x,x+s.length))}else if(u[h].length){var c=u[h],T=this.traces[h],_=T.passes,w=T.passOffset;_=_.map(function(k,L){l[w+L]=c})}(i=this.scatter).draw.apply(i,l)}else this.scatter.draw();return this},a.prototype.destroy=function(){return this.traces.forEach(function(i){i.buffer&&i.buffer.destroy&&i.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:279,"regl-scatter2d":282}],284:[function(v,J,Z){(function(p,g){typeof Z=="object"&&J!==void 0?J.exports=g():p.createREGL=g()})(this,function(){function p(he,xe){this.id=Q++,this.type=he,this.data=xe}function g(he){return"["+function xe(De){if(De.length===0)return[];var qe=De.charAt(0),Xe=De.charAt(De.length-1);if(1<De.length&&qe===Xe&&(qe==='"'||qe==="'"))return['"'+De.substr(1,De.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(qe=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(De))return xe(De.substr(0,qe.index)).concat(xe(qe[1])).concat(xe(De.substr(qe.index+qe[0].length)));if((qe=De.split(".")).length===1)return['"'+De.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(De=[],Xe=0;Xe<qe.length;++Xe)De=De.concat(xe(qe[Xe]));return De}(he).join("][")+"]"}function b(he){return typeof he=="string"?he.split():he}function y(he){return typeof he=="string"?document.querySelector(he):he}function e(he){var xe,De,qe,Xe,He=he||{};he={};var st=[],it=[],Tt=typeof window>"u"?1:window.devicePixelRatio,Pt=!1,rt={},ut=function(wt){},Ft=function(){};if(typeof He=="string"?xe=document.querySelector(He):typeof He=="object"&&(typeof He.nodeName=="string"&&typeof He.appendChild=="function"&&typeof He.getBoundingClientRect=="function"?xe=He:typeof He.drawArrays=="function"||typeof He.drawElements=="function"?qe=(Xe=He).canvas:("gl"in He?Xe=He.gl:"canvas"in He?qe=y(He.canvas):"container"in He&&(De=y(He.container)),"attributes"in He&&(he=He.attributes),"extensions"in He&&(st=b(He.extensions)),"optionalExtensions"in He&&(it=b(He.optionalExtensions)),"onDone"in He&&(ut=He.onDone),"profile"in He&&(Pt=!!He.profile),"pixelRatio"in He&&(Tt=+He.pixelRatio),"cachedCode"in He&&(rt=He.cachedCode))),xe&&(xe.nodeName.toLowerCase()==="canvas"?qe=xe:De=xe),!Xe){if(!qe){if(!(xe=function(wt,Lt,Ae){function Ye(){var Mt=window.innerWidth,Rt=window.innerHeight;wt!==document.body&&(Mt=(Rt=ft.getBoundingClientRect()).right-Rt.left,Rt=Rt.bottom-Rt.top),ft.width=Ae*Mt,ft.height=Ae*Rt}var nt,ft=document.createElement("canvas");return j(ft.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),wt.appendChild(ft),wt===document.body&&(ft.style.position="absolute",j(wt.style,{margin:0,padding:0})),wt!==document.body&&typeof ResizeObserver=="function"?(nt=new ResizeObserver(function(){setTimeout(Ye)})).observe(wt):window.addEventListener("resize",Ye,!1),Ye(),{canvas:ft,onDestroy:function(){nt?nt.disconnect():window.removeEventListener("resize",Ye),wt.removeChild(ft)}}}(De||document.body,0,Tt)))return null;qe=xe.canvas,Ft=xe.onDestroy}he.premultipliedAlpha===void 0&&(he.premultipliedAlpha=!0),Xe=function(wt,Lt){function Ae(Ye){try{return wt.getContext(Ye,Lt)}catch{return null}}return Ae("webgl")||Ae("experimental-webgl")||Ae("webgl-experimental")}(qe,he)}return Xe?{gl:Xe,canvas:qe,container:De,extensions:st,optionalExtensions:it,pixelRatio:Tt,profile:Pt,cachedCode:rt,onDone:ut,onDestroy:Ft}:(Ft(),ut("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function n(he,xe){for(var De=Array(he),qe=0;qe<he;++qe)De[qe]=xe(qe);return De}function t(he){var xe,De;return xe=(65535<he)<<4,xe|=De=(255<(he>>>=xe))<<3,(xe|=De=(15<(he>>>=De))<<2)|(De=(3<(he>>>=De))<<1)|he>>>De>>1}function a(){function he(qe){e:{for(var Xe=16;268435456>=Xe;Xe*=16)if(qe<=Xe){qe=Xe;break e}qe=0}return 0<(Xe=De[t(qe)>>2]).length?Xe.pop():new ArrayBuffer(qe)}function xe(qe){De[t(qe.byteLength)>>2].push(qe)}var De=n(8,function(){return[]});return{alloc:he,free:xe,allocType:function(qe,Xe){var He=null;switch(qe){case 5120:He=new Int8Array(he(Xe),0,Xe);break;case 5121:He=new Uint8Array(he(Xe),0,Xe);break;case 5122:He=new Int16Array(he(2*Xe),0,Xe);break;case 5123:He=new Uint16Array(he(2*Xe),0,Xe);break;case 5124:He=new Int32Array(he(4*Xe),0,Xe);break;case 5125:He=new Uint32Array(he(4*Xe),0,Xe);break;case 5126:He=new Float32Array(he(4*Xe),0,Xe);break;default:return null}return He.length!==Xe?He.subarray(0,Xe):He},freeType:function(qe){xe(qe.buffer)}}}function r(he){return!!he&&typeof he=="object"&&Array.isArray(he.shape)&&Array.isArray(he.stride)&&typeof he.offset=="number"&&he.shape.length===he.stride.length&&(Array.isArray(he.data)||de(he.data))}function m(he,xe,De,qe,Xe,He){for(var st=0;st<xe;++st)for(var it=he[st],Tt=0;Tt<De;++Tt)for(var Pt=it[Tt],rt=0;rt<qe;++rt)Xe[He++]=Pt[rt]}function o(he){return 0|Te[Object.prototype.toString.call(he)]}function i(he,xe){for(var De=0;De<xe.length;++De)he[De]=xe[De]}function u(he,xe,De,qe,Xe,He,st){for(var it=0,Tt=0;Tt<De;++Tt)for(var Pt=0;Pt<qe;++Pt)he[it++]=xe[Xe*Tt+He*Pt+st]}function f(he,xe,De,qe){function Xe(ut){this.id=Tt++,this.buffer=he.createBuffer(),this.type=ut,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,De.profile&&(this.stats={size:0})}function He(ut,Ft,wt){ut.byteLength=Ft.byteLength,he.bufferData(ut.type,Ft,wt)}function st(ut,Ft,wt,Lt,Ae,Ye){if(ut.usage=wt,Array.isArray(Ft)){if(ut.dtype=Lt||5126,0<Ft.length)if(Array.isArray(Ft[0])){Ae=fe(Ft);for(var nt=Lt=1;nt<Ae.length;++nt)Lt*=Ae[nt];ut.dimension=Lt,He(ut,Ft=Ce(Ft,Ae,ut.dtype),wt),Ye?ut.persistentData=Ft:le.freeType(Ft)}else typeof Ft[0]=="number"?(ut.dimension=Ae,i(Ae=le.allocType(ut.dtype,Ft.length),Ft),He(ut,Ae,wt),Ye?ut.persistentData=Ae:le.freeType(Ae)):de(Ft[0])&&(ut.dimension=Ft[0].length,ut.dtype=Lt||o(Ft[0])||5126,He(ut,Ft=Ce(Ft,[Ft.length,Ft[0].length],ut.dtype),wt),Ye?ut.persistentData=Ft:le.freeType(Ft))}else if(de(Ft))ut.dtype=Lt||o(Ft),ut.dimension=Ae,He(ut,Ft,wt),Ye&&(ut.persistentData=new Uint8Array(new Uint8Array(Ft.buffer)));else if(r(Ft)){Ae=Ft.shape;var ft=Ft.stride,Mt=(nt=Ft.offset,0),Rt=0,Gt=0,jt=0;Ae.length===1?(Mt=Ae[0],Rt=1,Gt=ft[0],jt=0):Ae.length===2&&(Mt=Ae[0],Rt=Ae[1],Gt=ft[0],jt=ft[1]),ut.dtype=Lt||o(Ft.data)||5126,ut.dimension=Rt,u(Ae=le.allocType(ut.dtype,Mt*Rt),Ft.data,Mt,Rt,Gt,jt,nt),He(ut,Ae,wt),Ye?ut.persistentData=Ae:le.freeType(Ae)}else Ft instanceof ArrayBuffer&&(ut.dtype=5121,ut.dimension=Ae,He(ut,Ft,wt),Ye&&(ut.persistentData=new Uint8Array(new Uint8Array(Ft))))}function it(ut){xe.bufferCount--,qe(ut),he.deleteBuffer(ut.buffer),ut.buffer=null,delete Pt[ut.id]}var Tt=0,Pt={};Xe.prototype.bind=function(){he.bindBuffer(this.type,this.buffer)},Xe.prototype.destroy=function(){it(this)};var rt=[];return De.profile&&(xe.getTotalBufferSize=function(){var ut=0;return Object.keys(Pt).forEach(function(Ft){ut+=Pt[Ft].stats.size}),ut}),{create:function(ut,Ft,wt,Lt){function Ae(nt){var ft=35044,Mt=null,Rt=0,Gt=0,jt=1;return Array.isArray(nt)||de(nt)||r(nt)||nt instanceof ArrayBuffer?Mt=nt:typeof nt=="number"?Rt=0|nt:nt&&("data"in nt&&(Mt=nt.data),"usage"in nt&&(ft=be[nt.usage]),"type"in nt&&(Gt=_e[nt.type]),"dimension"in nt&&(jt=0|nt.dimension),"length"in nt&&(Rt=0|nt.length)),Ye.bind(),Mt?st(Ye,Mt,ft,Gt,jt,Lt):(Rt&&he.bufferData(Ye.type,Rt,ft),Ye.dtype=Gt||5121,Ye.usage=ft,Ye.dimension=jt,Ye.byteLength=Rt),De.profile&&(Ye.stats.size=Ye.byteLength*ve[Ye.dtype]),Ae}xe.bufferCount++;var Ye=new Xe(Ft);return Pt[Ye.id]=Ye,wt||Ae(ut),Ae._reglType="buffer",Ae._buffer=Ye,Ae.subdata=function(nt,ft){var Mt,Rt=0|(ft||0);if(Ye.bind(),de(nt)||nt instanceof ArrayBuffer)he.bufferSubData(Ye.type,Rt,nt);else if(Array.isArray(nt)){if(0<nt.length)if(typeof nt[0]=="number"){var Gt=le.allocType(Ye.dtype,nt.length);i(Gt,nt),he.bufferSubData(Ye.type,Rt,Gt),le.freeType(Gt)}else(Array.isArray(nt[0])||de(nt[0]))&&(Mt=fe(nt),Gt=Ce(nt,Mt,Ye.dtype),he.bufferSubData(Ye.type,Rt,Gt),le.freeType(Gt))}else if(r(nt)){Mt=nt.shape;var jt=nt.stride,pr=Gt=0,Ar=0,fr=0;Mt.length===1?(Gt=Mt[0],pr=1,Ar=jt[0],fr=0):Mt.length===2&&(Gt=Mt[0],pr=Mt[1],Ar=jt[0],fr=jt[1]),Mt=Array.isArray(nt.data)?Ye.dtype:o(nt.data),u(Mt=le.allocType(Mt,Gt*pr),nt.data,Gt,pr,Ar,fr,nt.offset),he.bufferSubData(Ye.type,Rt,Mt),le.freeType(Mt)}return Ae},De.profile&&(Ae.stats=Ye.stats),Ae.destroy=function(){it(Ye)},Ae},createStream:function(ut,Ft){var wt=rt.pop();return wt||(wt=new Xe(ut)),wt.bind(),st(wt,Ft,35040,0,1,!1),wt},destroyStream:function(ut){rt.push(ut)},clear:function(){se(Pt).forEach(it),rt.forEach(it)},getBuffer:function(ut){return ut&&ut._buffer instanceof Xe?ut._buffer:null},restore:function(){se(Pt).forEach(function(ut){ut.buffer=he.createBuffer(),he.bindBuffer(ut.type,ut.buffer),he.bufferData(ut.type,ut.persistentData||ut.byteLength,ut.usage)})},_initBuffer:st}}function l(he,xe,De,qe){function Xe(ut){this.id=Tt++,it[this.id]=this,this.buffer=ut,this.primType=4,this.type=this.vertCount=0}function He(ut,Ft,wt,Lt,Ae,Ye,nt){var ft;if(ut.buffer.bind(),Ft?((ft=nt)||de(Ft)&&(!r(Ft)||de(Ft.data))||(ft=xe.oes_element_index_uint?5125:5123),De._initBuffer(ut.buffer,Ft,wt,ft,3)):(he.bufferData(34963,Ye,wt),ut.buffer.dtype=ft||5121,ut.buffer.usage=wt,ut.buffer.dimension=3,ut.buffer.byteLength=Ye),ft=nt,!nt){switch(ut.buffer.dtype){case 5121:case 5120:ft=5121;break;case 5123:case 5122:ft=5123;break;case 5125:case 5124:ft=5125}ut.buffer.dtype=ft}ut.type=ft,0>(Ft=Ae)&&(Ft=ut.buffer.byteLength,ft===5123?Ft>>=1:ft===5125&&(Ft>>=2)),ut.vertCount=Ft,Ft=Lt,0>Lt&&(Ft=4,(Lt=ut.buffer.dimension)===1&&(Ft=0),Lt===2&&(Ft=1),Lt===3&&(Ft=4)),ut.primType=Ft}function st(ut){qe.elementsCount--,delete it[ut.id],ut.buffer.destroy(),ut.buffer=null}var it={},Tt=0,Pt={uint8:5121,uint16:5123};xe.oes_element_index_uint&&(Pt.uint32=5125),Xe.prototype.bind=function(){this.buffer.bind()};var rt=[];return{create:function(ut,Ft){function wt(Ye){if(Ye)if(typeof Ye=="number")Lt(Ye),Ae.primType=4,Ae.vertCount=0|Ye,Ae.type=5121;else{var nt=null,ft=35044,Mt=-1,Rt=-1,Gt=0,jt=0;Array.isArray(Ye)||de(Ye)||r(Ye)?nt=Ye:("data"in Ye&&(nt=Ye.data),"usage"in Ye&&(ft=be[Ye.usage]),"primitive"in Ye&&(Mt=Me[Ye.primitive]),"count"in Ye&&(Rt=0|Ye.count),"type"in Ye&&(jt=Pt[Ye.type]),"length"in Ye?Gt=0|Ye.length:(Gt=Rt,jt===5123||jt===5122?Gt*=2:jt!==5125&&jt!==5124||(Gt*=4))),He(Ae,nt,ft,Mt,Rt,Gt,jt)}else Lt(),Ae.primType=4,Ae.vertCount=0,Ae.type=5121;return wt}var Lt=De.create(null,34963,!0),Ae=new Xe(Lt._buffer);return qe.elementsCount++,wt(ut),wt._reglType="elements",wt._elements=Ae,wt.subdata=function(Ye,nt){return Lt.subdata(Ye,nt),wt},wt.destroy=function(){st(Ae)},wt},createStream:function(ut){var Ft=rt.pop();return Ft||(Ft=new Xe(De.create(null,34963,!0,!1)._buffer)),He(Ft,ut,35040,-1,-1,0,0),Ft},destroyStream:function(ut){rt.push(ut)},getElements:function(ut){return typeof ut=="function"&&ut._elements instanceof Xe?ut._elements:null},clear:function(){se(it).forEach(st)}}}function h(he){for(var xe=le.allocType(5123,he.length),De=0;De<he.length;++De)if(isNaN(he[De]))xe[De]=65535;else if(1/0===he[De])xe[De]=31744;else if(-1/0===he[De])xe[De]=64512;else{ke[0]=he[De];var qe=(He=Le[0])>>>31<<15,Xe=(He<<1>>>24)-127,He=He>>13&1023;xe[De]=-24>Xe?qe:-14>Xe?qe+(He+1024>>-14-Xe):15<Xe?qe+31744:qe+(Xe+15<<10)+He}return xe}function d(he){return Array.isArray(he)||de(he)}function s(he){return"[object "+he+"]"}function x(he){return Array.isArray(he)&&(he.length===0||typeof he[0]=="number")}function c(he){return!(!Array.isArray(he)||he.length===0||!d(he[0]))}function T(he){return Object.prototype.toString.call(he)}function _(he){if(!he)return!1;var xe=T(he);return 0<=ot.indexOf(xe)||x(he)||c(he)||r(he)}function w(he,xe){he.type===36193?(he.data=h(xe),le.freeType(xe)):he.data=xe}function k(he,xe,De,qe,Xe,He){if(he=_t[he]!==void 0?_t[he]:Oe[he]*pt[xe],He&&(he*=6),Xe){for(qe=0;1<=De;)qe+=he*De*De,De/=2;return qe}return he*De*qe}function L(he,xe,De,qe,Xe,He,st){function it(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function Tt(tr,yr){tr.internalformat=yr.internalformat,tr.format=yr.format,tr.type=yr.type,tr.compressed=yr.compressed,tr.premultiplyAlpha=yr.premultiplyAlpha,tr.flipY=yr.flipY,tr.unpackAlignment=yr.unpackAlignment,tr.colorSpace=yr.colorSpace,tr.width=yr.width,tr.height=yr.height,tr.channels=yr.channels}function Pt(tr,yr){if(typeof yr=="object"&&yr){"premultiplyAlpha"in yr&&(tr.premultiplyAlpha=yr.premultiplyAlpha),"flipY"in yr&&(tr.flipY=yr.flipY),"alignment"in yr&&(tr.unpackAlignment=yr.alignment),"colorSpace"in yr&&(tr.colorSpace=Ur[yr.colorSpace]),"type"in yr&&(tr.type=Jr[yr.type]);var Ct=tr.width,lr=tr.height,dr=tr.channels,Fr=!1;"shape"in yr?(Ct=yr.shape[0],lr=yr.shape[1],yr.shape.length===3&&(dr=yr.shape[2],Fr=!0)):("radius"in yr&&(Ct=lr=yr.radius),"width"in yr&&(Ct=yr.width),"height"in yr&&(lr=yr.height),"channels"in yr&&(dr=yr.channels,Fr=!0)),tr.width=0|Ct,tr.height=0|lr,tr.channels=0|dr,Ct=!1,"format"in yr&&(Ct=yr.format,lr=tr.internalformat=mn[Ct],tr.format=on[lr],Ct in Jr&&!("type"in yr)&&(tr.type=Jr[Ct]),Ct in en&&(tr.compressed=!0),Ct=!0),!Fr&&Ct?tr.channels=Oe[tr.format]:Fr&&!Ct&&tr.channels!==Re[tr.format]&&(tr.format=tr.internalformat=Re[tr.channels])}}function rt(tr){he.pixelStorei(37440,tr.flipY),he.pixelStorei(37441,tr.premultiplyAlpha),he.pixelStorei(37443,tr.colorSpace),he.pixelStorei(3317,tr.unpackAlignment)}function ut(){it.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Ft(tr,yr){var Ct=null;if(_(yr)?Ct=yr:yr&&(Pt(tr,yr),"x"in yr&&(tr.xOffset=0|yr.x),"y"in yr&&(tr.yOffset=0|yr.y),_(yr.data)&&(Ct=yr.data)),yr.copy){var lr=Xe.viewportWidth,dr=Xe.viewportHeight;tr.width=tr.width||lr-tr.xOffset,tr.height=tr.height||dr-tr.yOffset,tr.needsCopy=!0}else if(Ct){if(de(Ct))tr.channels=tr.channels||4,tr.data=Ct,"type"in yr||tr.type!==5121||(tr.type=0|Te[Object.prototype.toString.call(Ct)]);else if(x(Ct)){switch(tr.channels=tr.channels||4,dr=(lr=Ct).length,tr.type){case 5121:case 5123:case 5125:case 5126:(dr=le.allocType(tr.type,dr)).set(lr),tr.data=dr;break;case 36193:tr.data=h(lr)}tr.alignment=1,tr.needsFree=!0}else if(r(Ct)){lr=Ct.data,Array.isArray(lr)||tr.type!==5121||(tr.type=0|Te[Object.prototype.toString.call(lr)]),dr=Ct.shape;var Fr,Rr,zr,Er,xr=Ct.stride;dr.length===3?(zr=dr[2],Er=xr[2]):Er=zr=1,Fr=dr[0],Rr=dr[1],dr=xr[0],xr=xr[1],tr.alignment=1,tr.width=Fr,tr.height=Rr,tr.channels=zr,tr.format=tr.internalformat=Re[zr],tr.needsFree=!0,Fr=Er,Ct=Ct.offset,zr=tr.width,Er=tr.height,Rr=tr.channels;for(var _r=le.allocType(tr.type===36193?5126:tr.type,zr*Er*Rr),kr=0,Cr=0;Cr<Er;++Cr)for(var Gr=0;Gr<zr;++Gr)for(var qr=0;qr<Rr;++qr)_r[kr++]=lr[dr*Gr+xr*Cr+Fr*qr+Ct];w(tr,_r)}else if(T(Ct)===Ze||T(Ct)===Pe||T(Ct)===Ie)T(Ct)===Ze||T(Ct)===Pe?tr.element=Ct:tr.element=Ct.canvas,tr.width=tr.element.width,tr.height=tr.element.height,tr.channels=4;else if(T(Ct)===Be)tr.element=Ct,tr.width=Ct.width,tr.height=Ct.height,tr.channels=4;else if(T(Ct)===Fe)tr.element=Ct,tr.width=Ct.naturalWidth,tr.height=Ct.naturalHeight,tr.channels=4;else if(T(Ct)===$e)tr.element=Ct,tr.width=Ct.videoWidth,tr.height=Ct.videoHeight,tr.channels=4;else if(c(Ct)){for(lr=tr.width||Ct[0].length,dr=tr.height||Ct.length,xr=tr.channels,xr=d(Ct[0][0])?xr||Ct[0][0].length:xr||1,Fr=me.shape(Ct),zr=1,Er=0;Er<Fr.length;++Er)zr*=Fr[Er];zr=le.allocType(tr.type===36193?5126:tr.type,zr),me.flatten(Ct,Fr,"",zr),w(tr,zr),tr.alignment=1,tr.width=lr,tr.height=dr,tr.channels=xr,tr.format=tr.internalformat=Re[xr],tr.needsFree=!0}}else tr.width=tr.width||1,tr.height=tr.height||1,tr.channels=tr.channels||4}function wt(tr,yr,Ct,lr,dr){var Fr=tr.element,Rr=tr.data,zr=tr.internalformat,Er=tr.format,xr=tr.type,_r=tr.width,kr=tr.height;rt(tr),Fr?he.texSubImage2D(yr,dr,Ct,lr,Er,xr,Fr):tr.compressed?he.compressedTexSubImage2D(yr,dr,Ct,lr,zr,_r,kr,Rr):tr.needsCopy?(qe(),he.copyTexSubImage2D(yr,dr,Ct,lr,tr.xOffset,tr.yOffset,_r,kr)):he.texSubImage2D(yr,dr,Ct,lr,_r,kr,Er,xr,Rr)}function Lt(){return Yr.pop()||new ut}function Ae(tr){tr.needsFree&&le.freeType(tr.data),ut.call(tr),Yr.push(tr)}function Ye(){it.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function nt(tr,yr,Ct){var lr=tr.images[0]=Lt();tr.mipmask=1,lr.width=tr.width=yr,lr.height=tr.height=Ct,lr.channels=tr.channels=4}function ft(tr,yr){var Ct=null;if(_(yr))Tt(Ct=tr.images[0]=Lt(),tr),Ft(Ct,yr),tr.mipmask=1;else if(Pt(tr,yr),Array.isArray(yr.mipmap))for(var lr=yr.mipmap,dr=0;dr<lr.length;++dr)Tt(Ct=tr.images[dr]=Lt(),tr),Ct.width>>=dr,Ct.height>>=dr,Ft(Ct,lr[dr]),tr.mipmask|=1<<dr;else Tt(Ct=tr.images[0]=Lt(),tr),Ft(Ct,yr),tr.mipmask=1;Tt(tr,tr.images[0])}function Mt(tr,yr){for(var Ct=tr.images,lr=0;lr<Ct.length&&Ct[lr];++lr){var dr=Ct[lr],Fr=yr,Rr=lr,zr=dr.element,Er=dr.data,xr=dr.internalformat,_r=dr.format,kr=dr.type,Cr=dr.width,Gr=dr.height;rt(dr),zr?he.texImage2D(Fr,Rr,_r,_r,kr,zr):dr.compressed?he.compressedTexImage2D(Fr,Rr,xr,Cr,Gr,0,Er):dr.needsCopy?(qe(),he.copyTexImage2D(Fr,Rr,_r,dr.xOffset,dr.yOffset,Cr,Gr,0)):he.texImage2D(Fr,Rr,_r,Cr,Gr,0,_r,kr,Er||null)}}function Rt(){var tr=Nn.pop()||new Ye;it.call(tr);for(var yr=tr.mipmask=0;16>yr;++yr)tr.images[yr]=null;return tr}function Gt(tr){for(var yr=tr.images,Ct=0;Ct<yr.length;++Ct)yr[Ct]&&Ae(yr[Ct]),yr[Ct]=null;Nn.push(tr)}function jt(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function pr(tr,yr){"min"in yr&&(tr.minFilter=Nr[yr.min],0<=ze.indexOf(tr.minFilter)&&!("faces"in yr)&&(tr.genMipmaps=!0)),"mag"in yr&&(tr.magFilter=Mr[yr.mag]);var Ct=tr.wrapS,lr=tr.wrapT;if("wrap"in yr){var dr=yr.wrap;typeof dr=="string"?Ct=lr=vr[dr]:Array.isArray(dr)&&(Ct=vr[dr[0]],lr=vr[dr[1]])}else"wrapS"in yr&&(Ct=vr[yr.wrapS]),"wrapT"in yr&&(lr=vr[yr.wrapT]);if(tr.wrapS=Ct,tr.wrapT=lr,"anisotropic"in yr&&(tr.anisotropic=yr.anisotropic),"mipmap"in yr){switch(Ct=!1,typeof yr.mipmap){case"string":tr.mipmapHint=hr[yr.mipmap],Ct=tr.genMipmaps=!0;break;case"boolean":Ct=tr.genMipmaps=yr.mipmap;break;case"object":tr.genMipmaps=!1,Ct=!0}!Ct||"min"in yr||(tr.minFilter=9984)}}function Ar(tr,yr){he.texParameteri(yr,10241,tr.minFilter),he.texParameteri(yr,10240,tr.magFilter),he.texParameteri(yr,10242,tr.wrapS),he.texParameteri(yr,10243,tr.wrapT),xe.ext_texture_filter_anisotropic&&he.texParameteri(yr,34046,tr.anisotropic),tr.genMipmaps&&(he.hint(33170,tr.mipmapHint),he.generateMipmap(yr))}function fr(tr){it.call(this),this.mipmask=0,this.internalformat=6408,this.id=Hn++,this.refCount=1,this.target=tr,this.texture=he.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new jt,st.profile&&(this.stats={size:0})}function Zt(tr){he.activeTexture(33984),he.bindTexture(tr.target,tr.texture)}function Qt(){var tr=ua[0];tr?he.bindTexture(tr.target,tr.texture):he.bindTexture(3553,null)}function $t(tr){var yr=tr.texture,Ct=tr.unit,lr=tr.target;0<=Ct&&(he.activeTexture(33984+Ct),he.bindTexture(lr,null),ua[Ct]=null),he.deleteTexture(yr),tr.texture=null,tr.params=null,tr.pixels=null,tr.refCount=0,delete xn[tr.id],He.textureCount--}var hr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},vr={repeat:10497,clamp:33071,mirror:33648},Mr={nearest:9728,linear:9729},Nr=j({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Mr),Ur={none:0,browser:37444},Jr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},mn={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},en={};xe.ext_srgb&&(mn.srgb=35904,mn.srgba=35906),xe.oes_texture_float&&(Jr.float32=Jr.float=5126),xe.oes_texture_half_float&&(Jr.float16=Jr["half float"]=36193),xe.webgl_depth_texture&&(j(mn,{depth:6402,"depth stencil":34041}),j(Jr,{uint16:5123,uint32:5125,"depth stencil":34042})),xe.webgl_compressed_texture_s3tc&&j(en,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),xe.webgl_compressed_texture_atc&&j(en,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),xe.webgl_compressed_texture_pvrtc&&j(en,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),xe.webgl_compressed_texture_etc1&&(en["rgb etc1"]=36196);var In=Array.prototype.slice.call(he.getParameter(34467));Object.keys(en).forEach(function(tr){var yr=en[tr];0<=In.indexOf(yr)&&(mn[tr]=yr)});var vn=Object.keys(mn);De.textureFormats=vn;var gn=[];Object.keys(mn).forEach(function(tr){gn[mn[tr]]=tr});var Sn=[];Object.keys(Jr).forEach(function(tr){Sn[Jr[tr]]=tr});var Xn=[];Object.keys(Mr).forEach(function(tr){Xn[Mr[tr]]=tr});var Br=[];Object.keys(Nr).forEach(function(tr){Br[Nr[tr]]=tr});var pn=[];Object.keys(vr).forEach(function(tr){pn[vr[tr]]=tr});var on=vn.reduce(function(tr,yr){var Ct=mn[yr];return Ct===6409||Ct===6406||Ct===6409||Ct===6410||Ct===6402||Ct===34041||xe.ext_srgb&&(Ct===35904||Ct===35906)?tr[Ct]=Ct:Ct===32855||0<=yr.indexOf("rgba")?tr[Ct]=6408:tr[Ct]=6407,tr},{}),Yr=[],Nn=[],Hn=0,xn={},On=De.maxTextureUnits,ua=Array(On).map(function(){return null});return j(fr.prototype,{bind:function(){this.bindCount+=1;var tr=this.unit;if(0>tr){for(var yr=0;yr<On;++yr){var Ct=ua[yr];if(Ct){if(0<Ct.bindCount)continue;Ct.unit=-1}ua[yr]=this,tr=yr;break}st.profile&&He.maxTextureUnits<tr+1&&(He.maxTextureUnits=tr+1),this.unit=tr,he.activeTexture(33984+tr),he.bindTexture(this.target,this.texture)}return tr},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&$t(this)}}),st.profile&&(He.getTotalTextureSize=function(){var tr=0;return Object.keys(xn).forEach(function(yr){tr+=xn[yr].stats.size}),tr}),{create2D:function(tr,yr){function Ct(dr,Fr){var Rr=lr.texInfo;jt.call(Rr);var zr=Rt();return typeof dr=="number"?nt(zr,0|dr,typeof Fr=="number"?0|Fr:0|dr):dr?(pr(Rr,dr),ft(zr,dr)):nt(zr,1,1),Rr.genMipmaps&&(zr.mipmask=(zr.width<<1)-1),lr.mipmask=zr.mipmask,Tt(lr,zr),lr.internalformat=zr.internalformat,Ct.width=zr.width,Ct.height=zr.height,Zt(lr),Mt(zr,3553),Ar(Rr,3553),Qt(),Gt(zr),st.profile&&(lr.stats.size=k(lr.internalformat,lr.type,zr.width,zr.height,Rr.genMipmaps,!1)),Ct.format=gn[lr.internalformat],Ct.type=Sn[lr.type],Ct.mag=Xn[Rr.magFilter],Ct.min=Br[Rr.minFilter],Ct.wrapS=pn[Rr.wrapS],Ct.wrapT=pn[Rr.wrapT],Ct}var lr=new fr(3553);return xn[lr.id]=lr,He.textureCount++,Ct(tr,yr),Ct.subimage=function(dr,Fr,Rr,zr){Fr|=0,Rr|=0,zr|=0;var Er=Lt();return Tt(Er,lr),Er.width=0,Er.height=0,Ft(Er,dr),Er.width=Er.width||(lr.width>>zr)-Fr,Er.height=Er.height||(lr.height>>zr)-Rr,Zt(lr),wt(Er,3553,Fr,Rr,zr),Qt(),Ae(Er),Ct},Ct.resize=function(dr,Fr){var Rr=0|dr,zr=0|Fr||Rr;if(Rr===lr.width&&zr===lr.height)return Ct;Ct.width=lr.width=Rr,Ct.height=lr.height=zr,Zt(lr);for(var Er=0;lr.mipmask>>Er;++Er){var xr=Rr>>Er,_r=zr>>Er;if(!xr||!_r)break;he.texImage2D(3553,Er,lr.format,xr,_r,0,lr.format,lr.type,null)}return Qt(),st.profile&&(lr.stats.size=k(lr.internalformat,lr.type,Rr,zr,!1,!1)),Ct},Ct._reglType="texture2d",Ct._texture=lr,st.profile&&(Ct.stats=lr.stats),Ct.destroy=function(){lr.decRef()},Ct},createCube:function(tr,yr,Ct,lr,dr,Fr){function Rr(xr,_r,kr,Cr,Gr,qr){var tn,rn=zr.texInfo;for(jt.call(rn),tn=0;6>tn;++tn)Er[tn]=Rt();if(typeof xr!="number"&&xr){if(typeof xr=="object")if(_r)ft(Er[0],xr),ft(Er[1],_r),ft(Er[2],kr),ft(Er[3],Cr),ft(Er[4],Gr),ft(Er[5],qr);else if(pr(rn,xr),Pt(zr,xr),"faces"in xr)for(xr=xr.faces,tn=0;6>tn;++tn)Tt(Er[tn],zr),ft(Er[tn],xr[tn]);else for(tn=0;6>tn;++tn)ft(Er[tn],xr)}else for(xr=0|xr||1,tn=0;6>tn;++tn)nt(Er[tn],xr,xr);for(Tt(zr,Er[0]),zr.mipmask=rn.genMipmaps?(Er[0].width<<1)-1:Er[0].mipmask,zr.internalformat=Er[0].internalformat,Rr.width=Er[0].width,Rr.height=Er[0].height,Zt(zr),tn=0;6>tn;++tn)Mt(Er[tn],34069+tn);for(Ar(rn,34067),Qt(),st.profile&&(zr.stats.size=k(zr.internalformat,zr.type,Rr.width,Rr.height,rn.genMipmaps,!0)),Rr.format=gn[zr.internalformat],Rr.type=Sn[zr.type],Rr.mag=Xn[rn.magFilter],Rr.min=Br[rn.minFilter],Rr.wrapS=pn[rn.wrapS],Rr.wrapT=pn[rn.wrapT],tn=0;6>tn;++tn)Gt(Er[tn]);return Rr}var zr=new fr(34067);xn[zr.id]=zr,He.cubeCount++;var Er=Array(6);return Rr(tr,yr,Ct,lr,dr,Fr),Rr.subimage=function(xr,_r,kr,Cr,Gr){kr|=0,Cr|=0,Gr|=0;var qr=Lt();return Tt(qr,zr),qr.width=0,qr.height=0,Ft(qr,_r),qr.width=qr.width||(zr.width>>Gr)-kr,qr.height=qr.height||(zr.height>>Gr)-Cr,Zt(zr),wt(qr,34069+xr,kr,Cr,Gr),Qt(),Ae(qr),Rr},Rr.resize=function(xr){if((xr|=0)!==zr.width){Rr.width=zr.width=xr,Rr.height=zr.height=xr,Zt(zr);for(var _r=0;6>_r;++_r)for(var kr=0;zr.mipmask>>kr;++kr)he.texImage2D(34069+_r,kr,zr.format,xr>>kr,xr>>kr,0,zr.format,zr.type,null);return Qt(),st.profile&&(zr.stats.size=k(zr.internalformat,zr.type,Rr.width,Rr.height,!1,!0)),Rr}},Rr._reglType="textureCube",Rr._texture=zr,st.profile&&(Rr.stats=zr.stats),Rr.destroy=function(){zr.decRef()},Rr},clear:function(){for(var tr=0;tr<On;++tr)he.activeTexture(33984+tr),he.bindTexture(3553,null),ua[tr]=null;se(xn).forEach($t),He.cubeCount=0,He.textureCount=0},getTexture:function(tr){return null},restore:function(){for(var tr=0;tr<On;++tr){var yr=ua[tr];yr&&(yr.bindCount=0,yr.unit=-1,ua[tr]=null)}se(xn).forEach(function(Ct){Ct.texture=he.createTexture(),he.bindTexture(Ct.target,Ct.texture);for(var lr=0;32>lr;++lr)if((Ct.mipmask&1<<lr)!=0)if(Ct.target===3553)he.texImage2D(3553,lr,Ct.internalformat,Ct.width>>lr,Ct.height>>lr,0,Ct.internalformat,Ct.type,null);else for(var dr=0;6>dr;++dr)he.texImage2D(34069+dr,lr,Ct.internalformat,Ct.width>>lr,Ct.height>>lr,0,Ct.internalformat,Ct.type,null);Ar(Ct.texInfo,Ct.target)})},refresh:function(){for(var tr=0;tr<On;++tr){var yr=ua[tr];yr&&(yr.bindCount=0,yr.unit=-1,ua[tr]=null),he.activeTexture(33984+tr),he.bindTexture(3553,null),he.bindTexture(34067,null)}}}}function A(he,xe,De,qe,Xe,He){function st(fr,Zt,Qt){this.target=fr,this.texture=Zt,this.renderbuffer=Qt;var $t=fr=0;Zt?(fr=Zt.width,$t=Zt.height):Qt&&(fr=Qt.width,$t=Qt.height),this.width=fr,this.height=$t}function it(fr){fr&&(fr.texture&&fr.texture._texture.decRef(),fr.renderbuffer&&fr.renderbuffer._renderbuffer.decRef())}function Tt(fr,Zt,Qt){fr&&(fr.texture?fr.texture._texture.refCount+=1:fr.renderbuffer._renderbuffer.refCount+=1)}function Pt(fr,Zt){Zt&&(Zt.texture?he.framebufferTexture2D(36160,fr,Zt.target,Zt.texture._texture.texture,0):he.framebufferRenderbuffer(36160,fr,36161,Zt.renderbuffer._renderbuffer.renderbuffer))}function rt(fr){var Zt=3553,Qt=null,$t=null,hr=fr;return typeof fr=="object"&&(hr=fr.data,"target"in fr&&(Zt=0|fr.target)),(fr=hr._reglType)==="texture2d"||fr==="textureCube"?Qt=hr:fr==="renderbuffer"&&($t=hr,Zt=36161),new st(Zt,Qt,$t)}function ut(fr,Zt,Qt,$t,hr){return Qt?((fr=qe.create2D({width:fr,height:Zt,format:$t,type:hr}))._texture.refCount=0,new st(3553,fr,null)):((fr=Xe.create({width:fr,height:Zt,format:$t}))._renderbuffer.refCount=0,new st(36161,null,fr))}function Ft(fr){return fr&&(fr.texture||fr.renderbuffer)}function wt(fr,Zt,Qt){fr&&(fr.texture?fr.texture.resize(Zt,Qt):fr.renderbuffer&&fr.renderbuffer.resize(Zt,Qt),fr.width=Zt,fr.height=Qt)}function Lt(){this.id=pr++,Ar[this.id]=this,this.framebuffer=he.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function Ae(fr){fr.colorAttachments.forEach(it),it(fr.depthAttachment),it(fr.stencilAttachment),it(fr.depthStencilAttachment)}function Ye(fr){he.deleteFramebuffer(fr.framebuffer),fr.framebuffer=null,He.framebufferCount--,delete Ar[fr.id]}function nt(fr){var Zt;he.bindFramebuffer(36160,fr.framebuffer);var Qt=fr.colorAttachments;for(Zt=0;Zt<Qt.length;++Zt)Pt(36064+Zt,Qt[Zt]);for(Zt=Qt.length;Zt<De.maxColorAttachments;++Zt)he.framebufferTexture2D(36160,36064+Zt,3553,null,0);he.framebufferTexture2D(36160,33306,3553,null,0),he.framebufferTexture2D(36160,36096,3553,null,0),he.framebufferTexture2D(36160,36128,3553,null,0),Pt(36096,fr.depthAttachment),Pt(36128,fr.stencilAttachment),Pt(33306,fr.depthStencilAttachment),he.checkFramebufferStatus(36160),he.isContextLost(),he.bindFramebuffer(36160,Mt.next?Mt.next.framebuffer:null),Mt.cur=Mt.next,he.getError()}function ft(fr,Zt){function Qt(hr,vr){var Mr,Nr=0,Ur=0,Jr=!0,mn=!0;Mr=null;var en=!0,In="rgba",vn="uint8",gn=1,Sn=null,Xn=null,Br=null,pn=!1;typeof hr=="number"?(Nr=0|hr,Ur=0|vr||Nr):hr?("shape"in hr?(Nr=(Ur=hr.shape)[0],Ur=Ur[1]):("radius"in hr&&(Nr=Ur=hr.radius),"width"in hr&&(Nr=hr.width),"height"in hr&&(Ur=hr.height)),("color"in hr||"colors"in hr)&&(Mr=hr.color||hr.colors,Array.isArray(Mr)),Mr||("colorCount"in hr&&(gn=0|hr.colorCount),"colorTexture"in hr&&(en=!!hr.colorTexture,In="rgba4"),"colorType"in hr&&(vn=hr.colorType,!en)&&(vn==="half float"||vn==="float16"?In="rgba16f":vn!=="float"&&vn!=="float32"||(In="rgba32f")),"colorFormat"in hr&&(In=hr.colorFormat,0<=Rt.indexOf(In)?en=!0:0<=Gt.indexOf(In)&&(en=!1))),("depthTexture"in hr||"depthStencilTexture"in hr)&&(pn=!(!hr.depthTexture&&!hr.depthStencilTexture)),"depth"in hr&&(typeof hr.depth=="boolean"?Jr=hr.depth:(Sn=hr.depth,mn=!1)),"stencil"in hr&&(typeof hr.stencil=="boolean"?mn=hr.stencil:(Xn=hr.stencil,Jr=!1)),"depthStencil"in hr&&(typeof hr.depthStencil=="boolean"?Jr=mn=hr.depthStencil:(Br=hr.depthStencil,mn=Jr=!1))):Nr=Ur=1;var on=null,Yr=null,Nn=null,Hn=null;if(Array.isArray(Mr))on=Mr.map(rt);else if(Mr)on=[rt(Mr)];else for(on=Array(gn),Mr=0;Mr<gn;++Mr)on[Mr]=ut(Nr,Ur,en,In,vn);for(Nr=Nr||on[0].width,Ur=Ur||on[0].height,Sn?Yr=rt(Sn):Jr&&!mn&&(Yr=ut(Nr,Ur,pn,"depth","uint32")),Xn?Nn=rt(Xn):mn&&!Jr&&(Nn=ut(Nr,Ur,!1,"stencil","uint8")),Br?Hn=rt(Br):!Sn&&!Xn&&mn&&Jr&&(Hn=ut(Nr,Ur,pn,"depth stencil","depth stencil")),Jr=null,Mr=0;Mr<on.length;++Mr)Tt(on[Mr]),on[Mr]&&on[Mr].texture&&(mn=Ke[on[Mr].texture._texture.format]*vt[on[Mr].texture._texture.type],Jr===null&&(Jr=mn));return Tt(Yr),Tt(Nn),Tt(Hn),Ae($t),$t.width=Nr,$t.height=Ur,$t.colorAttachments=on,$t.depthAttachment=Yr,$t.stencilAttachment=Nn,$t.depthStencilAttachment=Hn,Qt.color=on.map(Ft),Qt.depth=Ft(Yr),Qt.stencil=Ft(Nn),Qt.depthStencil=Ft(Hn),Qt.width=$t.width,Qt.height=$t.height,nt($t),Qt}var $t=new Lt;return He.framebufferCount++,Qt(fr,Zt),j(Qt,{resize:function(hr,vr){var Mr=Math.max(0|hr,1),Nr=Math.max(0|vr||Mr,1);if(Mr===$t.width&&Nr===$t.height)return Qt;for(var Ur=$t.colorAttachments,Jr=0;Jr<Ur.length;++Jr)wt(Ur[Jr],Mr,Nr);return wt($t.depthAttachment,Mr,Nr),wt($t.stencilAttachment,Mr,Nr),wt($t.depthStencilAttachment,Mr,Nr),$t.width=Qt.width=Mr,$t.height=Qt.height=Nr,nt($t),Qt},_reglType:"framebuffer",_framebuffer:$t,destroy:function(){Ye($t),Ae($t)},use:function(hr){Mt.setFBO({framebuffer:Qt},hr)}})}var Mt={cur:null,next:null,dirty:!1,setFBO:null},Rt=["rgba"],Gt=["rgba4","rgb565","rgb5 a1"];xe.ext_srgb&&Gt.push("srgba"),xe.ext_color_buffer_half_float&&Gt.push("rgba16f","rgb16f"),xe.webgl_color_buffer_float&&Gt.push("rgba32f");var jt=["uint8"];xe.oes_texture_half_float&&jt.push("half float","float16"),xe.oes_texture_float&&jt.push("float","float32");var pr=0,Ar={};return j(Mt,{getFramebuffer:function(fr){return typeof fr=="function"&&fr._reglType==="framebuffer"&&(fr=fr._framebuffer)instanceof Lt?fr:null},create:ft,createCube:function(fr){function Zt($t){var hr,vr={color:null},Mr=0,Nr=null;hr="rgba";var Ur="uint8",Jr=1;if(typeof $t=="number"?Mr=0|$t:$t?("shape"in $t?Mr=$t.shape[0]:("radius"in $t&&(Mr=0|$t.radius),"width"in $t?Mr=0|$t.width:"height"in $t&&(Mr=0|$t.height)),("color"in $t||"colors"in $t)&&(Nr=$t.color||$t.colors,Array.isArray(Nr)),Nr||("colorCount"in $t&&(Jr=0|$t.colorCount),"colorType"in $t&&(Ur=$t.colorType),"colorFormat"in $t&&(hr=$t.colorFormat)),"depth"in $t&&(vr.depth=$t.depth),"stencil"in $t&&(vr.stencil=$t.stencil),"depthStencil"in $t&&(vr.depthStencil=$t.depthStencil)):Mr=1,Nr)if(Array.isArray(Nr))for($t=[],hr=0;hr<Nr.length;++hr)$t[hr]=Nr[hr];else $t=[Nr];else for($t=Array(Jr),Nr={radius:Mr,format:hr,type:Ur},hr=0;hr<Jr;++hr)$t[hr]=qe.createCube(Nr);for(vr.color=Array($t.length),hr=0;hr<$t.length;++hr)Jr=$t[hr],Mr=Mr||Jr.width,vr.color[hr]={target:34069,data:$t[hr]};for(hr=0;6>hr;++hr){for(Jr=0;Jr<$t.length;++Jr)vr.color[Jr].target=34069+hr;0<hr&&(vr.depth=Qt[0].depth,vr.stencil=Qt[0].stencil,vr.depthStencil=Qt[0].depthStencil),Qt[hr]?Qt[hr](vr):Qt[hr]=ft(vr)}return j(Zt,{width:Mr,height:Mr,color:$t})}var Qt=Array(6);return Zt(fr),j(Zt,{faces:Qt,resize:function($t){var hr=0|$t;if(hr===Zt.width)return Zt;var vr=Zt.color;for($t=0;$t<vr.length;++$t)vr[$t].resize(hr);for($t=0;6>$t;++$t)Qt[$t].resize(hr);return Zt.width=Zt.height=hr,Zt},_reglType:"framebufferCube",destroy:function(){Qt.forEach(function($t){$t.destroy()})}})},clear:function(){se(Ar).forEach(Ye)},restore:function(){Mt.cur=null,Mt.next=null,Mt.dirty=!0,se(Ar).forEach(function(fr){fr.framebuffer=he.createFramebuffer(),nt(fr)})}})}function I(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function P(he,xe,De,qe,Xe,He,st){function it(){this.id=++rt,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var wt=xe.oes_vertex_array_object;this.vao=wt?wt.createVertexArrayOES():null,ut[this.id]=this,this.buffers=[]}var Tt=De.maxAttributes,Pt=Array(Tt);for(De=0;De<Tt;++De)Pt[De]=new I;var rt=0,ut={},Ft={Record:I,scope:{},state:Pt,currentVAO:null,targetVAO:null,restore:xe.oes_vertex_array_object?function(){xe.oes_vertex_array_object&&se(ut).forEach(function(wt){wt.refresh()})}:function(){},createVAO:function(wt){function Lt(Ye){var nt;Array.isArray(Ye)?(nt=Ye,Ae.elements&&Ae.ownsElements&&Ae.elements.destroy(),Ae.elements=null,Ae.ownsElements=!1,Ae.offset=0,Ae.count=0,Ae.instances=-1,Ae.primitive=4):(Ye.elements?(nt=Ye.elements,Ae.ownsElements?(typeof nt=="function"&&nt._reglType==="elements"?Ae.elements.destroy():Ae.elements(nt),Ae.ownsElements=!1):He.getElements(Ye.elements)?(Ae.elements=Ye.elements,Ae.ownsElements=!1):(Ae.elements=He.create(Ye.elements),Ae.ownsElements=!0)):(Ae.elements=null,Ae.ownsElements=!1),nt=Ye.attributes,Ae.offset=0,Ae.count=-1,Ae.instances=-1,Ae.primitive=4,Ae.elements&&(Ae.count=Ae.elements._elements.vertCount,Ae.primitive=Ae.elements._elements.primType),"offset"in Ye&&(Ae.offset=0|Ye.offset),"count"in Ye&&(Ae.count=0|Ye.count),"instances"in Ye&&(Ae.instances=0|Ye.instances),"primitive"in Ye&&(Ae.primitive=Me[Ye.primitive])),Ye={};var ft=Ae.attributes;ft.length=nt.length;for(var Mt=0;Mt<nt.length;++Mt){var Rt,Gt=nt[Mt],jt=ft[Mt]=new I,pr=Gt.data||Gt;Array.isArray(pr)||de(pr)||r(pr)?(Ae.buffers[Mt]&&(Rt=Ae.buffers[Mt],de(pr)&&Rt._buffer.byteLength>=pr.byteLength?Rt.subdata(pr):(Rt.destroy(),Ae.buffers[Mt]=null)),Ae.buffers[Mt]||(Rt=Ae.buffers[Mt]=Xe.create(Gt,34962,!1,!0)),jt.buffer=Xe.getBuffer(Rt),jt.size=0|jt.buffer.dimension,jt.normalized=!1,jt.type=jt.buffer.dtype,jt.offset=0,jt.stride=0,jt.divisor=0,jt.state=1,Ye[Mt]=1):Xe.getBuffer(Gt)?(jt.buffer=Xe.getBuffer(Gt),jt.size=0|jt.buffer.dimension,jt.normalized=!1,jt.type=jt.buffer.dtype,jt.offset=0,jt.stride=0,jt.divisor=0,jt.state=1):Xe.getBuffer(Gt.buffer)?(jt.buffer=Xe.getBuffer(Gt.buffer),jt.size=0|(+Gt.size||jt.buffer.dimension),jt.normalized=!!Gt.normalized||!1,jt.type="type"in Gt?_e[Gt.type]:jt.buffer.dtype,jt.offset=0|(Gt.offset||0),jt.stride=0|(Gt.stride||0),jt.divisor=0|(Gt.divisor||0),jt.state=1):"x"in Gt&&(jt.x=+Gt.x||0,jt.y=+Gt.y||0,jt.z=+Gt.z||0,jt.w=+Gt.w||0,jt.state=2)}for(Rt=0;Rt<Ae.buffers.length;++Rt)!Ye[Rt]&&Ae.buffers[Rt]&&(Ae.buffers[Rt].destroy(),Ae.buffers[Rt]=null);return Ae.refresh(),Lt}var Ae=new it;return qe.vaoCount+=1,Lt.destroy=function(){for(var Ye=0;Ye<Ae.buffers.length;++Ye)Ae.buffers[Ye]&&Ae.buffers[Ye].destroy();Ae.buffers.length=0,Ae.ownsElements&&(Ae.elements.destroy(),Ae.elements=null,Ae.ownsElements=!1),Ae.destroy()},Lt._vao=Ae,Lt._reglType="vao",Lt(wt)},getVAO:function(wt){return typeof wt=="function"&&wt._vao?wt._vao:null},destroyBuffer:function(wt){for(var Lt=0;Lt<Pt.length;++Lt){var Ae=Pt[Lt];Ae.buffer===wt&&(he.disableVertexAttribArray(Lt),Ae.buffer=null)}},setVAO:xe.oes_vertex_array_object?function(wt){if(wt!==Ft.currentVAO){var Lt=xe.oes_vertex_array_object;wt?Lt.bindVertexArrayOES(wt.vao):Lt.bindVertexArrayOES(null),Ft.currentVAO=wt}}:function(wt){if(wt!==Ft.currentVAO){if(wt)wt.bindAttrs();else{for(var Lt=xe.angle_instanced_arrays,Ae=0;Ae<Pt.length;++Ae){var Ye=Pt[Ae];Ye.buffer?(he.enableVertexAttribArray(Ae),Ye.buffer.bind(),he.vertexAttribPointer(Ae,Ye.size,Ye.type,Ye.normalized,Ye.stride,Ye.offfset),Lt&&Ye.divisor&&Lt.vertexAttribDivisorANGLE(Ae,Ye.divisor)):(he.disableVertexAttribArray(Ae),he.vertexAttrib4f(Ae,Ye.x,Ye.y,Ye.z,Ye.w))}st.elements?he.bindBuffer(34963,st.elements.buffer.buffer):he.bindBuffer(34963,null)}Ft.currentVAO=wt}},clear:xe.oes_vertex_array_object?function(){se(ut).forEach(function(wt){wt.destroy()})}:function(){}};return it.prototype.bindAttrs=function(){for(var wt=xe.angle_instanced_arrays,Lt=this.attributes,Ae=0;Ae<Lt.length;++Ae){var Ye=Lt[Ae];Ye.buffer?(he.enableVertexAttribArray(Ae),he.bindBuffer(34962,Ye.buffer.buffer),he.vertexAttribPointer(Ae,Ye.size,Ye.type,Ye.normalized,Ye.stride,Ye.offset),wt&&Ye.divisor&&wt.vertexAttribDivisorANGLE(Ae,Ye.divisor)):(he.disableVertexAttribArray(Ae),he.vertexAttrib4f(Ae,Ye.x,Ye.y,Ye.z,Ye.w))}for(wt=Lt.length;wt<Tt;++wt)he.disableVertexAttribArray(wt);(wt=He.getElements(this.elements))?he.bindBuffer(34963,wt.buffer.buffer):he.bindBuffer(34963,null)},it.prototype.refresh=function(){var wt=xe.oes_vertex_array_object;wt&&(wt.bindVertexArrayOES(this.vao),this.bindAttrs(),Ft.currentVAO=null,wt.bindVertexArrayOES(null))},it.prototype.destroy=function(){if(this.vao){var wt=xe.oes_vertex_array_object;this===Ft.currentVAO&&(Ft.currentVAO=null,wt.bindVertexArrayOES(null)),wt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ut[this.id]&&(delete ut[this.id],--qe.vaoCount)},Ft}function S(he,xe,De,qe){function Xe(Lt,Ae,Ye,nt){this.name=Lt,this.id=Ae,this.location=Ye,this.info=nt}function He(Lt,Ae){for(var Ye=0;Ye<Lt.length;++Ye)if(Lt[Ye].id===Ae.id)return void(Lt[Ye].location=Ae.location);Lt.push(Ae)}function st(Lt,Ae,Ye){if(!(ft=(Ye=Lt===35632?Pt:rt)[Ae])){var nt=xe.str(Ae),ft=he.createShader(Lt);he.shaderSource(ft,nt),he.compileShader(ft),Ye[Ae]=ft}return ft}function it(Lt,Ae){this.id=wt++,this.fragId=Lt,this.vertId=Ae,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,qe.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Tt(Lt,Ae,Ye){var nt;nt=st(35632,Lt.fragId);var ft=st(35633,Lt.vertId);if(Ae=Lt.program=he.createProgram(),he.attachShader(Ae,nt),he.attachShader(Ae,ft),Ye)for(nt=0;nt<Ye.length;++nt)ft=Ye[nt],he.bindAttribLocation(Ae,ft[0],ft[1]);he.linkProgram(Ae),ft=he.getProgramParameter(Ae,35718),qe.profile&&(Lt.stats.uniformsCount=ft);var Mt=Lt.uniforms;for(nt=0;nt<ft;++nt)if(Ye=he.getActiveUniform(Ae,nt))if(1<Ye.size)for(var Rt=0;Rt<Ye.size;++Rt){var Gt=Ye.name.replace("[0]","["+Rt+"]");He(Mt,new Xe(Gt,xe.id(Gt),he.getUniformLocation(Ae,Gt),Ye))}else He(Mt,new Xe(Ye.name,xe.id(Ye.name),he.getUniformLocation(Ae,Ye.name),Ye));for(ft=he.getProgramParameter(Ae,35721),qe.profile&&(Lt.stats.attributesCount=ft),Lt=Lt.attributes,nt=0;nt<ft;++nt)(Ye=he.getActiveAttrib(Ae,nt))&&He(Lt,new Xe(Ye.name,xe.id(Ye.name),he.getAttribLocation(Ae,Ye.name),Ye))}var Pt={},rt={},ut={},Ft=[],wt=0;return qe.profile&&(De.getMaxUniformsCount=function(){var Lt=0;return Ft.forEach(function(Ae){Ae.stats.uniformsCount>Lt&&(Lt=Ae.stats.uniformsCount)}),Lt},De.getMaxAttributesCount=function(){var Lt=0;return Ft.forEach(function(Ae){Ae.stats.attributesCount>Lt&&(Lt=Ae.stats.attributesCount)}),Lt}),{clear:function(){var Lt=he.deleteShader.bind(he);se(Pt).forEach(Lt),Pt={},se(rt).forEach(Lt),rt={},Ft.forEach(function(Ae){he.deleteProgram(Ae.program)}),Ft.length=0,ut={},De.shaderCount=0},program:function(Lt,Ae,Ye,nt){var ft=ut[Ae];ft||(ft=ut[Ae]={});var Mt=ft[Lt];if(Mt&&(Mt.refCount++,!nt))return Mt;var Rt=new it(Ae,Lt);return De.shaderCount++,Tt(Rt,Ye,nt),Mt||(ft[Lt]=Rt),Ft.push(Rt),j(Rt,{destroy:function(){if(Rt.refCount--,0>=Rt.refCount){he.deleteProgram(Rt.program);var Gt=Ft.indexOf(Rt);Ft.splice(Gt,1),De.shaderCount--}0>=ft[Rt.vertId].refCount&&(he.deleteShader(rt[Rt.vertId]),delete rt[Rt.vertId],delete ut[Rt.fragId][Rt.vertId]),Object.keys(ut[Rt.fragId]).length||(he.deleteShader(Pt[Rt.fragId]),delete Pt[Rt.fragId],delete ut[Rt.fragId])}})},restore:function(){Pt={},rt={};for(var Lt=0;Lt<Ft.length;++Lt)Tt(Ft[Lt],null,Ft[Lt].attributes.map(function(Ae){return[Ae.location,Ae.name]}))},shader:st,frag:-1,vert:-1}}function E(he,xe,De,qe,Xe,He,st){function it(Tt){var Pt;Pt=xe.next===null?5121:xe.next.colorAttachments[0].texture._texture.type;var rt=0,ut=0,Ft=qe.framebufferWidth,wt=qe.framebufferHeight,Lt=null;return de(Tt)?Lt=Tt:Tt&&(rt=0|Tt.x,ut=0|Tt.y,Ft=0|(Tt.width||qe.framebufferWidth-rt),wt=0|(Tt.height||qe.framebufferHeight-ut),Lt=Tt.data||null),De(),Tt=Ft*wt*4,Lt||(Pt===5121?Lt=new Uint8Array(Tt):Pt===5126&&(Lt=Lt||new Float32Array(Tt))),he.pixelStorei(3333,4),he.readPixels(rt,ut,Ft,wt,6408,Pt,Lt),Lt}return function(Tt){return Tt&&"framebuffer"in Tt?function(Pt){var rt;return xe.setFBO({framebuffer:Pt.framebuffer},function(){rt=it(Pt)}),rt}(Tt):it(Tt)}}function D(he,xe){return he>>>xe|he<<32-xe}function R(he,xe){var De=(65535&he)+(65535&xe);return(he>>16)+(xe>>16)+(De>>16)<<16|65535&De}function H(he){return Array.prototype.slice.call(he)}function V(he){return H(he).join("")}function X(he){function xe(){var rt=[],ut=[];return j(function(){rt.push.apply(rt,H(arguments))},{def:function(){var Ft="v"+Xe++;return ut.push(Ft),0<arguments.length&&(rt.push(Ft,"="),rt.push.apply(rt,H(arguments)),rt.push(";")),Ft},toString:function(){return V([0<ut.length?"var "+ut.join(",")+";":"",V(rt)])}})}function De(){function rt(Ae,Ye){Ft(Ae,Ye,"=",ut.def(Ae,Ye),";")}var ut=xe(),Ft=xe(),wt=ut.toString,Lt=Ft.toString;return j(function(){ut.apply(ut,H(arguments))},{def:ut.def,entry:ut,exit:Ft,save:rt,set:function(Ae,Ye,nt){rt(Ae,Ye),ut(Ae,Ye,"=",nt,";")},toString:function(){return wt()+Lt()}})}var qe=he&&he.cache,Xe=0,He=[],st=[],it=[],Tt=xe(),Pt={};return{global:Tt,link:function(rt,ut){var Ft=ut&&ut.stable;if(!Ft){for(var wt=0;wt<st.length;++wt)if(st[wt]===rt&&!it[wt])return He[wt]}return wt="g"+Xe++,He.push(wt),st.push(rt),it.push(Ft),wt},block:xe,proc:function(rt,ut){function Ft(){var Ye="a"+wt.length;return wt.push(Ye),Ye}var wt=[];ut=ut||0;for(var Lt=0;Lt<ut;++Lt)Ft();var Ae=(Lt=De()).toString;return Pt[rt]=j(Lt,{arg:Ft,toString:function(){return V(["function(",wt.join(),"){",Ae(),"}"])}})},scope:De,cond:function(){var rt=V(arguments),ut=De(),Ft=De(),wt=ut.toString,Lt=Ft.toString;return j(ut,{then:function(){return ut.apply(ut,H(arguments)),this},else:function(){return Ft.apply(Ft,H(arguments)),this},toString:function(){var Ae=Lt();return Ae&&(Ae="else{"+Ae+"}"),V(["if(",rt,"){",wt(),"}",Ae])}})},compile:function(){var rt=['"use strict";',Tt,"return {"];Object.keys(Pt).forEach(function(wt){rt.push('"',wt,'":',Pt[wt].toString(),",")}),rt.push("}");var ut,Ft=V(rt).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`);return qe&&(ut=function(wt){for(var Lt,Ae="",Ye=0;Ye<wt.length;Ye++)Lt=wt.charCodeAt(Ye),Ae+="0123456789abcdef".charAt(Lt>>>4&15)+"0123456789abcdef".charAt(15&Lt);return Ae}(function(wt){for(var Lt=Array(wt.length>>2),Ae=0;Ae<Lt.length;Ae++)Lt[Ae]=0;for(Ae=0;Ae<8*wt.length;Ae+=8)Lt[Ae>>5]|=(255&wt.charCodeAt(Ae/8))<<24-Ae%32;var Ye,nt,ft,Mt,Rt,Gt,jt,pr,Ar,fr,Zt,Qt=8*wt.length;for(wt=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Ae=Array(64),Lt[Qt>>5]|=128<<24-Qt%32,Lt[15+(Qt+64>>9<<4)]=Qt,pr=0;pr<Lt.length;pr+=16){for(Qt=wt[0],Ye=wt[1],nt=wt[2],ft=wt[3],Mt=wt[4],Rt=wt[5],Gt=wt[6],jt=wt[7],Ar=0;64>Ar;Ar++){var $t;16>Ar?Ae[Ar]=Lt[Ar+pr]:(fr=Ar,Zt=R(Zt=D(Zt=Ae[Ar-2],17)^D(Zt,19)^Zt>>>10,Ae[Ar-7]),$t=D($t=Ae[Ar-15],7)^D($t,18)^$t>>>3,Ae[fr]=R(R(Zt,$t),Ae[Ar-16])),fr=R(R(R(R(jt,fr=D(fr=Mt,6)^D(fr,11)^D(fr,25)),Mt&Rt^~Mt&Gt),Nt[Ar]),Ae[Ar]),Zt=R(jt=D(jt=Qt,2)^D(jt,13)^D(jt,22),Qt&Ye^Qt&nt^Ye&nt),jt=Gt,Gt=Rt,Rt=Mt,Mt=R(ft,fr),ft=nt,nt=Ye,Ye=Qt,Qt=R(fr,Zt)}wt[0]=R(Qt,wt[0]),wt[1]=R(Ye,wt[1]),wt[2]=R(nt,wt[2]),wt[3]=R(ft,wt[3]),wt[4]=R(Mt,wt[4]),wt[5]=R(Rt,wt[5]),wt[6]=R(Gt,wt[6]),wt[7]=R(jt,wt[7])}for(Lt="",Ae=0;Ae<32*wt.length;Ae+=8)Lt+=String.fromCharCode(wt[Ae>>5]>>>24-Ae%32&255);return Lt}(function(wt){for(var Lt,Ae,Ye="",nt=-1;++nt<wt.length;)Lt=wt.charCodeAt(nt),Ae=nt+1<wt.length?wt.charCodeAt(nt+1):0,55296<=Lt&&56319>=Lt&&56320<=Ae&&57343>=Ae&&(Lt=65536+((1023&Lt)<<10)+(1023&Ae),nt++),127>=Lt?Ye+=String.fromCharCode(Lt):2047>=Lt?Ye+=String.fromCharCode(192|Lt>>>6&31,128|63&Lt):65535>=Lt?Ye+=String.fromCharCode(224|Lt>>>12&15,128|Lt>>>6&63,128|63&Lt):2097151>=Lt&&(Ye+=String.fromCharCode(240|Lt>>>18&7,128|Lt>>>12&63,128|Lt>>>6&63,128|63&Lt));return Ye}(Ft))),qe[ut])?qe[ut].apply(null,st):(Ft=Function.apply(null,He.concat(Ft)),qe&&(qe[ut]=Ft),Ft.apply(null,st))}}}function $(he){return Array.isArray(he)||de(he)||r(he)}function G(he){return he.sort(function(xe,De){return xe==="viewport"?-1:De==="viewport"?1:xe<De?-1:1})}function W(he,xe,De,qe){this.thisDep=he,this.contextDep=xe,this.propDep=De,this.append=qe}function te(he){return he&&!(he.thisDep||he.contextDep||he.propDep)}function N(he){return new W(!1,!1,!1,he)}function B(he,xe){var De=he.type;if(De===0)return new W(!0,1<=(De=he.data.length),2<=De,xe);if(De===4)return new W((De=he.data).thisDep,De.contextDep,De.propDep,xe);if(De===5)return new W(!1,!1,!1,xe);if(De===6){for(var qe=De=!1,Xe=!1,He=0;He<he.data.length;++He){var st=he.data[He];st.type===1?Xe=!0:st.type===2?qe=!0:st.type===3?De=!0:st.type===0?(De=!0,1<=(st=st.data)&&(qe=!0),2<=st&&(Xe=!0)):st.type===4&&(De=De||st.data.thisDep,qe=qe||st.data.contextDep,Xe=Xe||st.data.propDep)}return new W(De,qe,Xe,xe)}return new W(De===3,De===2,De===1,xe)}function U(he,xe,De,qe,Xe,He,st,it,Tt,Pt,rt,ut,Ft,wt,Lt,Ae){function Ye(Ct){return Ct.replace(".","_")}function nt(Ct,lr,dr){var Fr=Ye(Ct);Hn.push(Ct),Nn[Fr]=Yr[Fr]=!!dr,xn[Fr]=lr}function ft(Ct,lr,dr){var Fr=Ye(Ct);Hn.push(Ct),Array.isArray(dr)?(Yr[Fr]=dr.slice(),Nn[Fr]=dr.slice()):Yr[Fr]=Nn[Fr]=dr,On[Fr]=lr}function Mt(){var Ct=X({cache:Lt}),lr=Ct.link,dr=Ct.global;Ct.id=yr++,Ct.batchId="0";var Fr=lr(ua),Rr=Ct.shared={props:"a0"};Object.keys(ua).forEach(function(kr){Rr[kr]=dr.def(Fr,".",kr)});var zr=Ct.next={},Er=Ct.current={};Object.keys(On).forEach(function(kr){Array.isArray(Yr[kr])&&(zr[kr]=dr.def(Rr.next,".",kr),Er[kr]=dr.def(Rr.current,".",kr))});var xr=Ct.constants={};Object.keys(tr).forEach(function(kr){xr[kr]=dr.def(JSON.stringify(tr[kr]))}),Ct.invoke=function(kr,Cr){switch(Cr.type){case 0:var Gr=["this",Rr.context,Rr.props,Ct.batchId];return kr.def(lr(Cr.data),".call(",Gr.slice(0,Math.max(Cr.data.length+1,4)),")");case 1:return kr.def(Rr.props,Cr.data);case 2:return kr.def(Rr.context,Cr.data);case 3:return kr.def("this",Cr.data);case 4:return Cr.data.append(Ct,kr),Cr.data.ref;case 5:return Cr.data.toString();case 6:return Cr.data.map(function(qr){return Ct.invoke(kr,qr)})}},Ct.attribCache={};var _r={};return Ct.scopeAttrib=function(kr){if((kr=xe.id(kr))in _r)return _r[kr];var Cr=Pt.scope[kr];return Cr||(Cr=Pt.scope[kr]=new Sn),_r[kr]=lr(Cr)},Ct}function Rt(Ct,lr){var dr=Ct.static,Fr=Ct.dynamic;if("framebuffer"in dr){var Rr=dr.framebuffer;return Rr?(Rr=it.getFramebuffer(Rr),N(function(Er,xr){var _r=Er.link(Rr),kr=Er.shared;return xr.set(kr.framebuffer,".next",_r),kr=kr.context,xr.set(kr,".framebufferWidth",_r+".width"),xr.set(kr,".framebufferHeight",_r+".height"),_r})):N(function(Er,xr){var _r=Er.shared;return xr.set(_r.framebuffer,".next","null"),_r=_r.context,xr.set(_r,".framebufferWidth",_r+".drawingBufferWidth"),xr.set(_r,".framebufferHeight",_r+".drawingBufferHeight"),"null"})}if("framebuffer"in Fr){var zr=Fr.framebuffer;return B(zr,function(Er,xr){var _r=Er.invoke(xr,zr),kr=Er.shared,Cr=kr.framebuffer;return _r=xr.def(Cr,".getFramebuffer(",_r,")"),xr.set(Cr,".next",_r),kr=kr.context,xr.set(kr,".framebufferWidth",_r+"?"+_r+".width:"+kr+".drawingBufferWidth"),xr.set(kr,".framebufferHeight",_r+"?"+_r+".height:"+kr+".drawingBufferHeight"),_r})}return null}function Gt(Ct,lr,dr){function Fr(kr){if(kr in Rr){var Cr=xe.id(Rr[kr]);return(kr=N(function(){return Cr})).id=Cr,kr}if(kr in zr){var Gr=zr[kr];return B(Gr,function(qr,tn){var rn=qr.invoke(tn,Gr);return tn.def(qr.shared.strings,".id(",rn,")")})}return null}var Rr=Ct.static,zr=Ct.dynamic,Er=Fr("frag"),xr=Fr("vert"),_r=null;return te(Er)&&te(xr)?(_r=rt.program(xr.id,Er.id,null,dr),Ct=N(function(kr,Cr){return kr.link(_r)})):Ct=new W(Er&&Er.thisDep||xr&&xr.thisDep,Er&&Er.contextDep||xr&&xr.contextDep,Er&&Er.propDep||xr&&xr.propDep,function(kr,Cr){var Gr,qr,tn=kr.shared.shader;return Gr=Er?Er.append(kr,Cr):Cr.def(tn,".","frag"),qr=xr?xr.append(kr,Cr):Cr.def(tn,".","vert"),Cr.def(tn+".program("+qr+","+Gr+")")}),{frag:Er,vert:xr,progVar:Ct,program:_r}}function jt(Ct,lr){function dr(rn,yn){if(rn in Fr){var _n=0|Fr[rn];return yn?zr.offset=_n:zr.instances=_n,N(function(Ln,zn){return yn&&(Ln.OFFSET=_n),_n})}if(rn in Rr){var wn=Rr[rn];return B(wn,function(Ln,zn){var Zn=Ln.invoke(zn,wn);return yn&&(Ln.OFFSET=Zn),Zn})}if(yn){if(_r)return N(function(Ln,zn){return Ln.OFFSET=0});if(Er)return new W(xr.thisDep,xr.contextDep,xr.propDep,function(Ln,zn){return zn.def(Ln.shared.vao+".currentVAO?"+Ln.shared.vao+".currentVAO.offset:0")})}else if(Er)return new W(xr.thisDep,xr.contextDep,xr.propDep,function(Ln,zn){return zn.def(Ln.shared.vao+".currentVAO?"+Ln.shared.vao+".currentVAO.instances:-1")});return null}var Fr=Ct.static,Rr=Ct.dynamic,zr={},Er=!1,xr=function(){if("vao"in Fr){var rn=Fr.vao;return rn!==null&&Pt.getVAO(rn)===null&&(rn=Pt.createVAO(rn)),Er=!0,zr.vao=rn,N(function(_n){var wn=Pt.getVAO(rn);return wn?_n.link(wn):"null"})}if("vao"in Rr){Er=!0;var yn=Rr.vao;return B(yn,function(_n,wn){var Ln=_n.invoke(wn,yn);return wn.def(_n.shared.vao+".getVAO("+Ln+")")})}return null}(),_r=!1,kr=function(){if("elements"in Fr){var rn=Fr.elements;if(zr.elements=rn,$(rn)){var yn=zr.elements=He.create(rn,!0);rn=He.getElements(yn),_r=!0}else rn&&(rn=He.getElements(rn),_r=!0);return(yn=N(function(wn,Ln){if(rn){var zn=wn.link(rn);return wn.ELEMENTS=zn}return wn.ELEMENTS=null})).value=rn,yn}if("elements"in Rr){_r=!0;var _n=Rr.elements;return B(_n,function(wn,Ln){var zn=(Zn=wn.shared).isBufferArgs,Zn=Zn.elements,Aa=wn.invoke(Ln,_n),Ma=Ln.def("null");return zn=Ln.def(zn,"(",Aa,")"),Aa=wn.cond(zn).then(Ma,"=",Zn,".createStream(",Aa,");").else(Ma,"=",Zn,".getElements(",Aa,");"),Ln.entry(Aa),Ln.exit(wn.cond(zn).then(Zn,".destroyStream(",Ma,");")),wn.ELEMENTS=Ma})}return Er?new W(xr.thisDep,xr.contextDep,xr.propDep,function(wn,Ln){return Ln.def(wn.shared.vao+".currentVAO?"+wn.shared.elements+".getElements("+wn.shared.vao+".currentVAO.elements):null")}):null}(),Cr=dr("offset",!0),Gr=function(){if("primitive"in Fr){var rn=Fr.primitive;return zr.primitive=rn,N(function(_n,wn){return Me[rn]})}if("primitive"in Rr){var yn=Rr.primitive;return B(yn,function(_n,wn){var Ln=_n.constants.primTypes,zn=_n.invoke(wn,yn);return wn.def(Ln,"[",zn,"]")})}return _r?te(kr)?kr.value?N(function(_n,wn){return wn.def(_n.ELEMENTS,".primType")}):N(function(){return 4}):new W(kr.thisDep,kr.contextDep,kr.propDep,function(_n,wn){var Ln=_n.ELEMENTS;return wn.def(Ln,"?",Ln,".primType:",4)}):Er?new W(xr.thisDep,xr.contextDep,xr.propDep,function(_n,wn){return wn.def(_n.shared.vao+".currentVAO?"+_n.shared.vao+".currentVAO.primitive:4")}):null}(),qr=function(){if("count"in Fr){var rn=0|Fr.count;return zr.count=rn,N(function(){return rn})}if("count"in Rr){var yn=Rr.count;return B(yn,function(_n,wn){return _n.invoke(wn,yn)})}return _r?te(kr)?kr?Cr?new W(Cr.thisDep,Cr.contextDep,Cr.propDep,function(_n,wn){return wn.def(_n.ELEMENTS,".vertCount-",_n.OFFSET)}):N(function(_n,wn){return wn.def(_n.ELEMENTS,".vertCount")}):N(function(){return-1}):new W(kr.thisDep||Cr.thisDep,kr.contextDep||Cr.contextDep,kr.propDep||Cr.propDep,function(_n,wn){var Ln=_n.ELEMENTS;return _n.OFFSET?wn.def(Ln,"?",Ln,".vertCount-",_n.OFFSET,":-1"):wn.def(Ln,"?",Ln,".vertCount:-1")}):Er?new W(xr.thisDep,xr.contextDep,xr.propDep,function(_n,wn){return wn.def(_n.shared.vao,".currentVAO?",_n.shared.vao,".currentVAO.count:-1")}):null}(),tn=dr("instances",!1);return{elements:kr,primitive:Gr,count:qr,instances:tn,offset:Cr,vao:xr,vaoActive:Er,elementsActive:_r,static:zr}}function pr(Ct,lr){var dr=Ct.static,Fr=Ct.dynamic,Rr={};return Object.keys(dr).forEach(function(zr){var Er=dr[zr],xr=xe.id(zr),_r=new Sn;if($(Er))_r.state=1,_r.buffer=Xe.getBuffer(Xe.create(Er,34962,!1,!0)),_r.type=0;else if(Cr=Xe.getBuffer(Er))_r.state=1,_r.buffer=Cr,_r.type=0;else if("constant"in Er){var kr=Er.constant;_r.buffer="null",_r.state=2,typeof kr=="number"?_r.x=kr:qt.forEach(function(_n,wn){wn<kr.length&&(_r[_n]=kr[wn])})}else{var Cr=$(Er.buffer)?Xe.getBuffer(Xe.create(Er.buffer,34962,!1,!0)):Xe.getBuffer(Er.buffer),Gr=0|Er.offset,qr=0|Er.stride,tn=0|Er.size,rn=!!Er.normalized,yn=0;"type"in Er&&(yn=_e[Er.type]),Er=0|Er.divisor,_r.buffer=Cr,_r.state=1,_r.size=tn,_r.normalized=rn,_r.type=yn||Cr.dtype,_r.offset=Gr,_r.stride=qr,_r.divisor=Er}Rr[zr]=N(function(_n,wn){var Ln=_n.attribCache;if(xr in Ln)return Ln[xr];var zn={isStream:!1};return Object.keys(_r).forEach(function(Zn){zn[Zn]=_r[Zn]}),_r.buffer&&(zn.buffer=_n.link(_r.buffer),zn.type=zn.type||zn.buffer+".dtype"),Ln[xr]=zn})}),Object.keys(Fr).forEach(function(zr){var Er=Fr[zr];Rr[zr]=B(Er,function(xr,_r){function kr(Ln){_r(rn[Ln],"=",Cr,".",Ln,"|0;")}var Cr=xr.invoke(_r,Er),Gr=xr.shared,qr=xr.constants,tn=Gr.isBufferArgs,rn=(Gr=Gr.buffer,{isStream:_r.def(!1)}),yn=new Sn;yn.state=1,Object.keys(yn).forEach(function(Ln){rn[Ln]=_r.def(""+yn[Ln])});var _n=rn.buffer,wn=rn.type;return _r("if(",tn,"(",Cr,")){",rn.isStream,"=true;",_n,"=",Gr,".createStream(",34962,",",Cr,");",wn,"=",_n,".dtype;","}else{",_n,"=",Gr,".getBuffer(",Cr,");","if(",_n,"){",wn,"=",_n,".dtype;",'}else if("constant" in ',Cr,"){",rn.state,"=",2,";","if(typeof "+Cr+'.constant === "number"){',rn[qt[0]],"=",Cr,".constant;",qt.slice(1).map(function(Ln){return rn[Ln]}).join("="),"=0;","}else{",qt.map(function(Ln,zn){return rn[Ln]+"="+Cr+".constant.length>"+zn+"?"+Cr+".constant["+zn+"]:0;"}).join(""),"}}else{","if(",tn,"(",Cr,".buffer)){",_n,"=",Gr,".createStream(",34962,",",Cr,".buffer);","}else{",_n,"=",Gr,".getBuffer(",Cr,".buffer);","}",wn,'="type" in ',Cr,"?",qr.glTypes,"[",Cr,".type]:",_n,".dtype;",rn.normalized,"=!!",Cr,".normalized;"),kr("size"),kr("offset"),kr("stride"),kr("divisor"),_r("}}"),_r.exit("if(",rn.isStream,"){",Gr,".destroyStream(",_n,");","}"),rn})}),Rr}function Ar(Ct,lr,dr,Fr,Rr){function zr(yn){var _n=xr[yn];_n&&(kr[yn]=_n)}var Er=function(yn,_n){if(typeof(wn=yn.static).frag=="string"&&typeof wn.vert=="string"){if(0<Object.keys(_n.dynamic).length)return null;var wn=_n.static,Ln=Object.keys(wn);if(0<Ln.length&&typeof wn[Ln[0]]=="number"){for(var zn=[],Zn=0;Zn<Ln.length;++Zn)zn.push([0|wn[Ln[Zn]],Ln[Zn]]);return zn}}return null}(Ct,lr),xr=function(yn,_n,wn){function Ln(Ma){if(Ma in zn){var An=zn[Ma];Ma=!0;var ea,Qn,za=0|An.x,vi=0|An.y;return"width"in An?ea=0|An.width:Ma=!1,"height"in An?Qn=0|An.height:Ma=!1,new W(!Ma&&_n&&_n.thisDep,!Ma&&_n&&_n.contextDep,!Ma&&_n&&_n.propDep,function(po,Xa){var Za=po.shared.context,eo=ea;"width"in An||(eo=Xa.def(Za,".","framebufferWidth","-",za));var Na=Qn;return"height"in An||(Na=Xa.def(Za,".","framebufferHeight","-",vi)),[za,vi,eo,Na]})}if(Ma in Zn){var Fi=Zn[Ma];return Ma=B(Fi,function(po,Xa){var Za=po.invoke(Xa,Fi),eo=po.shared.context,Na=Xa.def(Za,".x|0"),mo=Xa.def(Za,".y|0");return[Na,mo,Xa.def('"width" in ',Za,"?",Za,".width|0:","(",eo,".","framebufferWidth","-",Na,")"),Za=Xa.def('"height" in ',Za,"?",Za,".height|0:","(",eo,".","framebufferHeight","-",mo,")")]}),_n&&(Ma.thisDep=Ma.thisDep||_n.thisDep,Ma.contextDep=Ma.contextDep||_n.contextDep,Ma.propDep=Ma.propDep||_n.propDep),Ma}return _n?new W(_n.thisDep,_n.contextDep,_n.propDep,function(po,Xa){var Za=po.shared.context;return[0,0,Xa.def(Za,".","framebufferWidth"),Xa.def(Za,".","framebufferHeight")]}):null}var zn=yn.static,Zn=yn.dynamic;if(yn=Ln("viewport")){var Aa=yn;yn=new W(yn.thisDep,yn.contextDep,yn.propDep,function(Ma,An){var ea=Aa.append(Ma,An),Qn=Ma.shared.context;return An.set(Qn,".viewportWidth",ea[2]),An.set(Qn,".viewportHeight",ea[3]),ea})}return{viewport:yn,scissor_box:Ln("scissor.box")}}(Ct,Gr=Rt(Ct)),_r=jt(Ct),kr=function(yn,_n){var wn=yn.static,Ln=yn.dynamic,zn={};return Hn.forEach(function(Zn){function Aa(An,ea){if(Zn in wn){var Qn=An(wn[Zn]);zn[Ma]=N(function(){return Qn})}else if(Zn in Ln){var za=Ln[Zn];zn[Ma]=B(za,function(vi,Fi){return ea(vi,Fi,vi.invoke(Fi,za))})}}var Ma=Ye(Zn);switch(Zn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return Aa(function(An){return An},function(An,ea,Qn){return Qn});case"depth.func":return Aa(function(An){return ir[An]},function(An,ea,Qn){return ea.def(An.constants.compareFuncs,"[",Qn,"]")});case"depth.range":return Aa(function(An){return An},function(An,ea,Qn){return[ea.def("+",Qn,"[0]"),ea=ea.def("+",Qn,"[1]")]});case"blend.func":return Aa(function(An){return[Jt["srcRGB"in An?An.srcRGB:An.src],Jt["dstRGB"in An?An.dstRGB:An.dst],Jt["srcAlpha"in An?An.srcAlpha:An.src],Jt["dstAlpha"in An?An.dstAlpha:An.dst]]},function(An,ea,Qn){function za(Xa,Za){return ea.def('"',Xa,Za,'" in ',Qn,"?",Qn,".",Xa,Za,":",Qn,".",Xa)}An=An.constants.blendFuncs;var vi=za("src","RGB"),Fi=za("dst","RGB"),po=(vi=ea.def(An,"[",vi,"]"),ea.def(An,"[",za("src","Alpha"),"]"));return[vi,Fi=ea.def(An,"[",Fi,"]"),po,An=ea.def(An,"[",za("dst","Alpha"),"]")]});case"blend.equation":return Aa(function(An){return typeof An=="string"?[Xn[An],Xn[An]]:typeof An=="object"?[Xn[An.rgb],Xn[An.alpha]]:void 0},function(An,ea,Qn){var za=An.constants.blendEquations,vi=ea.def(),Fi=ea.def();return(An=An.cond("typeof ",Qn,'==="string"')).then(vi,"=",Fi,"=",za,"[",Qn,"];"),An.else(vi,"=",za,"[",Qn,".rgb];",Fi,"=",za,"[",Qn,".alpha];"),ea(An),[vi,Fi]});case"blend.color":return Aa(function(An){return n(4,function(ea){return+An[ea]})},function(An,ea,Qn){return n(4,function(za){return ea.def("+",Qn,"[",za,"]")})});case"stencil.mask":return Aa(function(An){return 0|An},function(An,ea,Qn){return ea.def(Qn,"|0")});case"stencil.func":return Aa(function(An){return[ir[An.cmp||"keep"],An.ref||0,"mask"in An?An.mask:-1]},function(An,ea,Qn){return[An=ea.def('"cmp" in ',Qn,"?",An.constants.compareFuncs,"[",Qn,".cmp]",":",7680),ea.def(Qn,".ref|0"),ea=ea.def('"mask" in ',Qn,"?",Qn,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return Aa(function(An){return[Zn==="stencil.opBack"?1029:1028,Ht[An.fail||"keep"],Ht[An.zfail||"keep"],Ht[An.zpass||"keep"]]},function(An,ea,Qn){function za(Fi){return ea.def('"',Fi,'" in ',Qn,"?",vi,"[",Qn,".",Fi,"]:",7680)}var vi=An.constants.stencilOps;return[Zn==="stencil.opBack"?1029:1028,za("fail"),za("zfail"),za("zpass")]});case"polygonOffset.offset":return Aa(function(An){return[0|An.factor,0|An.units]},function(An,ea,Qn){return[ea.def(Qn,".factor|0"),ea=ea.def(Qn,".units|0")]});case"cull.face":return Aa(function(An){var ea=0;return An==="front"?ea=1028:An==="back"&&(ea=1029),ea},function(An,ea,Qn){return ea.def(Qn,'==="front"?',1028,":",1029)});case"lineWidth":return Aa(function(An){return An},function(An,ea,Qn){return Qn});case"frontFace":return Aa(function(An){return Ue[An]},function(An,ea,Qn){return ea.def(Qn+'==="cw"?2304:2305')});case"colorMask":return Aa(function(An){return An.map(function(ea){return!!ea})},function(An,ea,Qn){return n(4,function(za){return"!!"+Qn+"["+za+"]"})});case"sample.coverage":return Aa(function(An){return["value"in An?An.value:1,!!An.invert]},function(An,ea,Qn){return[ea.def('"value" in ',Qn,"?+",Qn,".value:1"),ea=ea.def("!!",Qn,".invert")]})}}),zn}(Ct),Cr=Gt(Ct,0,Er);zr("viewport"),zr(Ye("scissor.box"));var Gr,qr=0<Object.keys(kr).length;if((Gr={framebuffer:Gr,draw:_r,shader:Cr,state:kr,dirty:qr,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(yn){var _n,wn=yn.static;if(yn=yn.dynamic,"profile"in wn){var Ln=!!wn.profile;(_n=N(function(Zn,Aa){return Ln})).enable=Ln}else if("profile"in yn){var zn=yn.profile;_n=B(zn,function(Zn,Aa){return Zn.invoke(Aa,zn)})}return _n}(Ct),Gr.uniforms=function(yn,_n){var wn=yn.static,Ln=yn.dynamic,zn={};return Object.keys(wn).forEach(function(Zn){var Aa,Ma=wn[Zn];if(typeof Ma=="number"||typeof Ma=="boolean")Aa=N(function(){return Ma});else if(typeof Ma=="function"){var An=Ma._reglType;An==="texture2d"||An==="textureCube"?Aa=N(function(ea){return ea.link(Ma)}):An!=="framebuffer"&&An!=="framebufferCube"||(Aa=N(function(ea){return ea.link(Ma.color[0])}))}else d(Ma)&&(Aa=N(function(ea){return ea.global.def("[",n(Ma.length,function(Qn){return Ma[Qn]}),"]")}));Aa.value=Ma,zn[Zn]=Aa}),Object.keys(Ln).forEach(function(Zn){var Aa=Ln[Zn];zn[Zn]=B(Aa,function(Ma,An){return Ma.invoke(An,Aa)})}),zn}(dr),Gr.drawVAO=Gr.scopeVAO=_r.vao,!Gr.drawVAO&&Cr.program&&!Er&&De.angle_instanced_arrays&&_r.static.elements){var tn=!0;if(Ct=Cr.program.attributes.map(function(yn){return yn=lr.static[yn],tn=tn&&!!yn,yn}),tn&&0<Ct.length){var rn=Pt.getVAO(Pt.createVAO({attributes:Ct,elements:_r.static.elements}));Gr.drawVAO=new W(null,null,null,function(yn,_n){return yn.link(rn)}),Gr.useVAO=!0}}return Er?Gr.useVAO=!0:Gr.attributes=pr(lr),Gr.context=function(yn){var _n=yn.static,wn=yn.dynamic,Ln={};return Object.keys(_n).forEach(function(zn){var Zn=_n[zn];Ln[zn]=N(function(Aa,Ma){return typeof Zn=="number"||typeof Zn=="boolean"?""+Zn:Aa.link(Zn)})}),Object.keys(wn).forEach(function(zn){var Zn=wn[zn];Ln[zn]=B(Zn,function(Aa,Ma){return Aa.invoke(Ma,Zn)})}),Ln}(Fr),Gr}function fr(Ct,lr,dr){var Fr=Ct.shared.context,Rr=Ct.scope();Object.keys(dr).forEach(function(zr){lr.save(Fr,"."+zr);var Er=dr[zr].append(Ct,lr);Array.isArray(Er)?Rr(Fr,".",zr,"=[",Er.join(),"];"):Rr(Fr,".",zr,"=",Er,";")}),lr(Rr)}function Zt(Ct,lr,dr,Fr){var Rr,zr=(xr=Ct.shared).gl,Er=xr.framebuffer;pn&&(Rr=lr.def(xr.extensions,".webgl_draw_buffers"));var xr=(_r=Ct.constants).drawBuffer,_r=_r.backBuffer;Ct=dr?dr.append(Ct,lr):lr.def(Er,".next"),Fr||lr("if(",Ct,"!==",Er,".cur){"),lr("if(",Ct,"){",zr,".bindFramebuffer(",36160,",",Ct,".framebuffer);"),pn&&lr(Rr,".drawBuffersWEBGL(",xr,"[",Ct,".colorAttachments.length]);"),lr("}else{",zr,".bindFramebuffer(",36160,",null);"),pn&&lr(Rr,".drawBuffersWEBGL(",_r,");"),lr("}",Er,".cur=",Ct,";"),Fr||lr("}")}function Qt(Ct,lr,dr){var Fr=Ct.shared,Rr=Fr.gl,zr=Ct.current,Er=Ct.next,xr=Fr.current,_r=Fr.next,kr=Ct.cond(xr,".dirty");Hn.forEach(function(Cr){var Gr,qr;if(!((Cr=Ye(Cr))in dr.state))if(Cr in Er){Gr=Er[Cr],qr=zr[Cr];var tn=n(Yr[Cr].length,function(rn){return kr.def(Gr,"[",rn,"]")});kr(Ct.cond(tn.map(function(rn,yn){return rn+"!=="+qr+"["+yn+"]"}).join("||")).then(Rr,".",On[Cr],"(",tn,");",tn.map(function(rn,yn){return qr+"["+yn+"]="+rn}).join(";"),";"))}else Gr=kr.def(_r,".",Cr),tn=Ct.cond(Gr,"!==",xr,".",Cr),kr(tn),Cr in xn?tn(Ct.cond(Gr).then(Rr,".enable(",xn[Cr],");").else(Rr,".disable(",xn[Cr],");"),xr,".",Cr,"=",Gr,";"):tn(Rr,".",On[Cr],"(",Gr,");",xr,".",Cr,"=",Gr,";")}),Object.keys(dr.state).length===0&&kr(xr,".dirty=false;"),lr(kr)}function $t(Ct,lr,dr,Fr){var Rr,zr=Ct.shared,Er=Ct.current,xr=zr.current,_r=zr.gl;G(Object.keys(dr)).forEach(function(kr){var Cr=dr[kr];if(!Fr||Fr(Cr)){var Gr=Cr.append(Ct,lr);if(xn[kr]){var qr=xn[kr];te(Cr)?(Rr=Ct.link(Gr,{stable:!0}),lr(Ct.cond(Rr).then(_r,".enable(",qr,");").else(_r,".disable(",qr,");")),lr(xr,".",kr,"=",Rr,";")):(lr(Ct.cond(Gr).then(_r,".enable(",qr,");").else(_r,".disable(",qr,");")),lr(xr,".",kr,"=",Gr,";"))}else if(d(Gr)){var tn=Er[kr];lr(_r,".",On[kr],"(",Gr,");",Gr.map(function(rn,yn){return tn+"["+yn+"]="+rn}).join(";"),";")}else te(Cr)?(Rr=Ct.link(Gr,{stable:!0}),lr(_r,".",On[kr],"(",Rr,");",xr,".",kr,"=",Rr,";")):lr(_r,".",On[kr],"(",Gr,");",xr,".",kr,"=",Gr,";")}})}function hr(Ct,lr){Br&&(Ct.instancing=lr.def(Ct.shared.extensions,".angle_instanced_arrays"))}function vr(Ct,lr,dr,Fr,Rr){function zr(){return typeof performance>"u"?"Date.now()":"performance.now()"}function Er(yn){yn(kr=lr.def(),"=",zr(),";"),typeof Rr=="string"?yn(qr,".count+=",Rr,";"):yn(qr,".count++;"),wt&&(Fr?yn(Cr=lr.def(),"=",rn,".getNumPendingQueries();"):yn(rn,".beginQuery(",qr,");"))}function xr(yn){yn(qr,".cpuTime+=",zr(),"-",kr,";"),wt&&(Fr?yn(rn,".pushScopeStats(",Cr,",",rn,".getNumPendingQueries(),",qr,");"):yn(rn,".endQuery();"))}function _r(yn){var _n=lr.def(tn,".profile");lr(tn,".profile=",yn,";"),lr.exit(tn,".profile=",_n,";")}var kr,Cr,Gr=Ct.shared,qr=Ct.stats,tn=Gr.current,rn=Gr.timer;if(dr=dr.profile){if(te(dr))return void(dr.enable?(Er(lr),xr(lr.exit),_r("true")):_r("false"));_r(dr=dr.append(Ct,lr))}else dr=lr.def(tn,".profile");Er(Gr=Ct.block()),lr("if(",dr,"){",Gr,"}"),xr(Ct=Ct.block()),lr.exit("if(",dr,"){",Ct,"}")}function Mr(Ct,lr,dr,Fr,Rr){function zr(xr,_r,kr){function Cr(){lr("if(!",rn,".buffer){",qr,".enableVertexAttribArray(",tn,");}");var Ln,zn=kr.type;Ln=kr.size?lr.def(kr.size,"||",_r):_r,lr("if(",rn,".type!==",zn,"||",rn,".size!==",Ln,"||",wn.map(function(Zn){return rn+"."+Zn+"!=="+kr[Zn]}).join("||"),"){",qr,".bindBuffer(",34962,",",yn,".buffer);",qr,".vertexAttribPointer(",[tn,Ln,zn,kr.normalized,kr.stride,kr.offset],");",rn,".type=",zn,";",rn,".size=",Ln,";",wn.map(function(Zn){return rn+"."+Zn+"="+kr[Zn]+";"}).join(""),"}"),Br&&(zn=kr.divisor,lr("if(",rn,".divisor!==",zn,"){",Ct.instancing,".vertexAttribDivisorANGLE(",[tn,zn],");",rn,".divisor=",zn,";}"))}function Gr(){lr("if(",rn,".buffer){",qr,".disableVertexAttribArray(",tn,");",rn,".buffer=null;","}if(",qt.map(function(Ln,zn){return rn+"."+Ln+"!=="+_n[zn]}).join("||"),"){",qr,".vertexAttrib4f(",tn,",",_n,");",qt.map(function(Ln,zn){return rn+"."+Ln+"="+_n[zn]+";"}).join(""),"}")}var qr=Er.gl,tn=lr.def(xr,".location"),rn=lr.def(Er.attributes,"[",tn,"]");xr=kr.state;var yn=kr.buffer,_n=[kr.x,kr.y,kr.z,kr.w],wn=["buffer","normalized","offset","stride"];xr===1?Cr():xr===2?Gr():(lr("if(",xr,"===",1,"){"),Cr(),lr("}else{"),Gr(),lr("}"))}var Er=Ct.shared;Fr.forEach(function(xr){var _r,kr=xr.name,Cr=dr.attributes[kr];if(Cr){if(!Rr(Cr))return;_r=Cr.append(Ct,lr)}else{if(!Rr(We))return;var Gr=Ct.scopeAttrib(kr);_r={},Object.keys(new Sn).forEach(function(qr){_r[qr]=lr.def(Gr,".",qr)})}zr(Ct.link(xr),function(qr){switch(qr){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(xr.info.type),_r)})}function Nr(Ct,lr,dr,Fr,Rr,zr){for(var Er,xr=Ct.shared,_r=xr.gl,kr=0;kr<Fr.length;++kr){var Cr,Gr=(rn=Fr[kr]).name,qr=rn.info.type,tn=dr.uniforms[Gr],rn=Ct.link(rn)+".location";if(tn){if(!Rr(tn))continue;if(te(tn)){if(Gr=tn.value,qr===35678||qr===35680)lr(_r,".uniform1i(",rn,",",(qr=Ct.link(Gr._texture||Gr.color[0]._texture))+".bind());"),lr.exit(qr,".unbind();");else if(qr===35674||qr===35675||qr===35676)tn=2,qr===35675?tn=3:qr===35676&&(tn=4),lr(_r,".uniformMatrix",tn,"fv(",rn,",false,",Gr=Ct.global.def("new Float32Array(["+Array.prototype.slice.call(Gr)+"])"),");");else{switch(qr){case 5126:Er="1f";break;case 35664:Er="2f";break;case 35665:Er="3f";break;case 35666:Er="4f";break;case 35670:case 5124:Er="1i";break;case 35671:case 35667:Er="2i";break;case 35672:case 35668:Er="3i";break;case 35673:Er="4i";break;case 35669:Er="4i"}lr(_r,".uniform",Er,"(",rn,",",d(Gr)?Array.prototype.slice.call(Gr):Gr,");")}continue}Cr=tn.append(Ct,lr)}else{if(!Rr(We))continue;Cr=lr.def(xr.uniforms,"[",xe.id(Gr),"]")}switch(qr===35678?lr("if(",Cr,"&&",Cr,'._reglType==="framebuffer"){',Cr,"=",Cr,".color[0];","}"):qr===35680&&lr("if(",Cr,"&&",Cr,'._reglType==="framebufferCube"){',Cr,"=",Cr,".color[0];","}"),Gr=1,qr){case 35678:case 35680:qr=lr.def(Cr,"._texture"),lr(_r,".uniform1i(",rn,",",qr,".bind());"),lr.exit(qr,".unbind();");continue;case 5124:case 35670:Er="1i";break;case 35667:case 35671:Er="2i",Gr=2;break;case 35668:case 35672:Er="3i",Gr=3;break;case 35669:case 35673:Er="4i",Gr=4;break;case 5126:Er="1f";break;case 35664:Er="2f",Gr=2;break;case 35665:Er="3f",Gr=3;break;case 35666:Er="4f",Gr=4;break;case 35674:Er="Matrix2fv";break;case 35675:Er="Matrix3fv";break;case 35676:Er="Matrix4fv"}if(Er.charAt(0)==="M"){lr(_r,".uniform",Er,"(",rn,","),rn=Math.pow(qr-35674+2,2);var yn=Ct.global.def("new Float32Array(",rn,")");Array.isArray(Cr)?lr("false,(",n(rn,function(wn){return yn+"["+wn+"]="+Cr[wn]}),",",yn,")"):lr("false,(Array.isArray(",Cr,")||",Cr," instanceof Float32Array)?",Cr,":(",n(rn,function(wn){return yn+"["+wn+"]="+Cr+"["+wn+"]"}),",",yn,")"),lr(");")}else{if(1<Gr){qr=[];var _n=[];for(tn=0;tn<Gr;++tn)Array.isArray(Cr)?_n.push(Cr[tn]):_n.push(lr.def(Cr+"["+tn+"]")),zr&&qr.push(lr.def());zr&&lr("if(!",Ct.batchId,"||",qr.map(function(wn,Ln){return wn+"!=="+_n[Ln]}).join("||"),"){",qr.map(function(wn,Ln){return wn+"="+_n[Ln]+";"}).join("")),lr(_r,".uniform",Er,"(",rn,",",_n.join(","),");")}else zr&&(qr=lr.def(),lr("if(!",Ct.batchId,"||",qr,"!==",Cr,"){",qr,"=",Cr,";")),lr(_r,".uniform",Er,"(",rn,",",Cr,");");zr&&lr("}")}}}function Ur(Ct,lr,dr,Fr){function Rr(zn){var Zn=qr[zn];return Zn?Zn.contextDep&&Fr.contextDynamic||Zn.propDep?Zn.append(Ct,dr):Zn.append(Ct,lr):lr.def(Gr,".",zn)}function zr(){function zn(){dr(_r,".drawElementsInstancedANGLE(",[rn,_n,wn,yn+"<<(("+wn+"-5121)>>1)",xr],");")}function Zn(){dr(_r,".drawArraysInstancedANGLE(",[rn,yn,_n,xr],");")}tn&&tn!=="null"?Ln?zn():(dr("if(",tn,"){"),zn(),dr("}else{"),Zn(),dr("}")):Zn()}function Er(){function zn(){dr(Cr+".drawElements("+[rn,_n,wn,yn+"<<(("+wn+"-5121)>>1)"]+");")}function Zn(){dr(Cr+".drawArrays("+[rn,yn,_n]+");")}tn&&tn!=="null"?Ln?zn():(dr("if(",tn,"){"),zn(),dr("}else{"),Zn(),dr("}")):Zn()}var xr,_r,kr=Ct.shared,Cr=kr.gl,Gr=kr.draw,qr=Fr.draw,tn=function(){var zn=qr.elements,Zn=lr;return zn?((zn.contextDep&&Fr.contextDynamic||zn.propDep)&&(Zn=dr),zn=zn.append(Ct,Zn),qr.elementsActive&&Zn("if("+zn+")"+Cr+".bindBuffer(34963,"+zn+".buffer.buffer);")):(zn=Zn.def(),Zn(zn,"=",Gr,".","elements",";","if(",zn,"){",Cr,".bindBuffer(",34963,",",zn,".buffer.buffer);}","else if(",kr.vao,".currentVAO){",zn,"=",Ct.shared.elements+".getElements("+kr.vao,".currentVAO.elements);",on?"":"if("+zn+")"+Cr+".bindBuffer(34963,"+zn+".buffer.buffer);","}")),zn}(),rn=Rr("primitive"),yn=Rr("offset"),_n=function(){var zn=qr.count,Zn=lr;return zn?((zn.contextDep&&Fr.contextDynamic||zn.propDep)&&(Zn=dr),zn=zn.append(Ct,Zn)):zn=Zn.def(Gr,".","count"),zn}();if(typeof _n=="number"){if(_n===0)return}else dr("if(",_n,"){"),dr.exit("}");Br&&(xr=Rr("instances"),_r=Ct.instancing);var wn=tn+".type",Ln=qr.elements&&te(qr.elements)&&!qr.vaoActive;Br&&(typeof xr!="number"||0<=xr)?typeof xr=="string"?(dr("if(",xr,">0){"),zr(),dr("}else if(",xr,"<0){"),Er(),dr("}")):zr():Er()}function Jr(Ct,lr,dr,Fr,Rr){return Rr=(lr=Mt()).proc("body",Rr),Br&&(lr.instancing=Rr.def(lr.shared.extensions,".angle_instanced_arrays")),Ct(lr,Rr,dr,Fr),lr.compile().body}function mn(Ct,lr,dr,Fr){hr(Ct,lr),dr.useVAO?dr.drawVAO?lr(Ct.shared.vao,".setVAO(",dr.drawVAO.append(Ct,lr),");"):lr(Ct.shared.vao,".setVAO(",Ct.shared.vao,".targetVAO);"):(lr(Ct.shared.vao,".setVAO(null);"),Mr(Ct,lr,dr,Fr.attributes,function(){return!0})),Nr(Ct,lr,dr,Fr.uniforms,function(){return!0},!1),Ur(Ct,lr,lr,dr)}function en(Ct,lr,dr,Fr){function Rr(){return!0}Ct.batchId="a1",hr(Ct,lr),Mr(Ct,lr,dr,Fr.attributes,Rr),Nr(Ct,lr,dr,Fr.uniforms,Rr,!1),Ur(Ct,lr,lr,dr)}function In(Ct,lr,dr,Fr){function Rr(Gr){return Gr.contextDep&&Er||Gr.propDep}function zr(Gr){return!Rr(Gr)}hr(Ct,lr);var Er=dr.contextDep,xr=lr.def(),_r=lr.def();Ct.shared.props=_r,Ct.batchId=xr;var kr=Ct.scope(),Cr=Ct.scope();lr(kr.entry,"for(",xr,"=0;",xr,"<","a1",";++",xr,"){",_r,"=","a0","[",xr,"];",Cr,"}",kr.exit),dr.needsContext&&fr(Ct,Cr,dr.context),dr.needsFramebuffer&&Zt(Ct,Cr,dr.framebuffer),$t(Ct,Cr,dr.state,Rr),dr.profile&&Rr(dr.profile)&&vr(Ct,Cr,dr,!1,!0),Fr?(dr.useVAO?dr.drawVAO?Rr(dr.drawVAO)?Cr(Ct.shared.vao,".setVAO(",dr.drawVAO.append(Ct,Cr),");"):kr(Ct.shared.vao,".setVAO(",dr.drawVAO.append(Ct,kr),");"):kr(Ct.shared.vao,".setVAO(",Ct.shared.vao,".targetVAO);"):(kr(Ct.shared.vao,".setVAO(null);"),Mr(Ct,kr,dr,Fr.attributes,zr),Mr(Ct,Cr,dr,Fr.attributes,Rr)),Nr(Ct,kr,dr,Fr.uniforms,zr,!1),Nr(Ct,Cr,dr,Fr.uniforms,Rr,!0),Ur(Ct,kr,Cr,dr)):(lr=Ct.global.def("{}"),Fr=dr.shader.progVar.append(Ct,Cr),_r=Cr.def(Fr,".id"),kr=Cr.def(lr,"[",_r,"]"),Cr(Ct.shared.gl,".useProgram(",Fr,".program);","if(!",kr,"){",kr,"=",lr,"[",_r,"]=",Ct.link(function(Gr){return Jr(en,Ct,dr,Gr,2)}),"(",Fr,");}",kr,".call(this,a0[",xr,"],",xr,");"))}function vn(Ct,lr){function dr(xr){var _r=lr.shader[xr];_r&&(_r=_r.append(Ct,Fr),isNaN(_r)?Fr.set(Rr.shader,"."+xr,_r):Fr.set(Rr.shader,"."+xr,Ct.link(_r,{stable:!0})))}var Fr=Ct.proc("scope",3);Ct.batchId="a2";var Rr=Ct.shared,zr=Rr.current;if(fr(Ct,Fr,lr.context),lr.framebuffer&&lr.framebuffer.append(Ct,Fr),G(Object.keys(lr.state)).forEach(function(xr){var _r=lr.state[xr],kr=_r.append(Ct,Fr);d(kr)?kr.forEach(function(Cr,Gr){isNaN(Cr)?Fr.set(Ct.next[xr],"["+Gr+"]",Cr):Fr.set(Ct.next[xr],"["+Gr+"]",Ct.link(Cr,{stable:!0}))}):te(_r)?Fr.set(Rr.next,"."+xr,Ct.link(kr,{stable:!0})):Fr.set(Rr.next,"."+xr,kr)}),vr(Ct,Fr,lr,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(xr){var _r=lr.draw[xr];_r&&(_r=_r.append(Ct,Fr),isNaN(_r)?Fr.set(Rr.draw,"."+xr,_r):Fr.set(Rr.draw,"."+xr,Ct.link(_r),{stable:!0}))}),Object.keys(lr.uniforms).forEach(function(xr){var _r=lr.uniforms[xr].append(Ct,Fr);Array.isArray(_r)&&(_r="["+_r.map(function(kr){return isNaN(kr)?kr:Ct.link(kr,{stable:!0})})+"]"),Fr.set(Rr.uniforms,"["+Ct.link(xe.id(xr),{stable:!0})+"]",_r)}),Object.keys(lr.attributes).forEach(function(xr){var _r=lr.attributes[xr].append(Ct,Fr),kr=Ct.scopeAttrib(xr);Object.keys(new Sn).forEach(function(Cr){Fr.set(kr,"."+Cr,_r[Cr])})}),lr.scopeVAO){var Er=lr.scopeVAO.append(Ct,Fr);isNaN(Er)?Fr.set(Rr.vao,".targetVAO",Er):Fr.set(Rr.vao,".targetVAO",Ct.link(Er,{stable:!0}))}dr("vert"),dr("frag"),0<Object.keys(lr.state).length&&(Fr(zr,".dirty=true;"),Fr.exit(zr,".dirty=true;")),Fr("a1(",Ct.shared.context,",a0,",Ct.batchId,");")}function gn(Ct,lr,dr){var Fr=lr.static[dr];if(Fr&&function(Cr){if(typeof Cr=="object"&&!d(Cr)){for(var Gr=Object.keys(Cr),qr=0;qr<Gr.length;++qr)if(K.isDynamic(Cr[Gr[qr]]))return!0;return!1}}(Fr)){var Rr=Ct.global,zr=Object.keys(Fr),Er=!1,xr=!1,_r=!1,kr=Ct.global.def("{}");zr.forEach(function(Cr){var Gr=Fr[Cr];if(K.isDynamic(Gr))typeof Gr=="function"&&(Gr=Fr[Cr]=K.unbox(Gr)),Cr=B(Gr,null),Er=Er||Cr.thisDep,_r=_r||Cr.propDep,xr=xr||Cr.contextDep;else{switch(Rr(kr,".",Cr,"="),typeof Gr){case"number":Rr(Gr);break;case"string":Rr('"',Gr,'"');break;case"object":Array.isArray(Gr)&&Rr("[",Gr.join(),"]");break;default:Rr(Ct.link(Gr))}Rr(";")}}),lr.dynamic[dr]=new K.DynamicVariable(4,{thisDep:Er,contextDep:xr,propDep:_r,ref:kr,append:function(Cr,Gr){zr.forEach(function(qr){var tn=Fr[qr];K.isDynamic(tn)&&(tn=Cr.invoke(Gr,tn),Gr(kr,".",qr,"=",tn,";"))})}}),delete lr.static[dr]}}var Sn=Pt.Record,Xn={add:32774,subtract:32778,"reverse subtract":32779};De.ext_blend_minmax&&(Xn.min=32775,Xn.max=32776);var Br=De.angle_instanced_arrays,pn=De.webgl_draw_buffers,on=De.oes_vertex_array_object,Yr={dirty:!0,profile:Ae.profile},Nn={},Hn=[],xn={},On={};nt("dither",3024),nt("blend.enable",3042),ft("blend.color","blendColor",[0,0,0,0]),ft("blend.equation","blendEquationSeparate",[32774,32774]),ft("blend.func","blendFuncSeparate",[1,0,1,0]),nt("depth.enable",2929,!0),ft("depth.func","depthFunc",513),ft("depth.range","depthRange",[0,1]),ft("depth.mask","depthMask",!0),ft("colorMask","colorMask",[!0,!0,!0,!0]),nt("cull.enable",2884),ft("cull.face","cullFace",1029),ft("frontFace","frontFace",2305),ft("lineWidth","lineWidth",1),nt("polygonOffset.enable",32823),ft("polygonOffset.offset","polygonOffset",[0,0]),nt("sample.alpha",32926),nt("sample.enable",32928),ft("sample.coverage","sampleCoverage",[1,!1]),nt("stencil.enable",2960),ft("stencil.mask","stencilMask",-1),ft("stencil.func","stencilFunc",[519,0,-1]),ft("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),ft("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),nt("scissor.enable",3089),ft("scissor.box","scissor",[0,0,he.drawingBufferWidth,he.drawingBufferHeight]),ft("viewport","viewport",[0,0,he.drawingBufferWidth,he.drawingBufferHeight]);var ua={gl:he,context:Ft,strings:xe,next:Nn,current:Yr,draw:ut,elements:He,buffer:Xe,shader:rt,attributes:Pt.state,vao:Pt,uniforms:Tt,framebuffer:it,extensions:De,timer:wt,isBufferArgs:$},tr={primTypes:Me,compareFuncs:ir,blendFuncs:Jt,blendEquations:Xn,stencilOps:Ht,glTypes:_e,orientationType:Ue};pn&&(tr.backBuffer=[1029],tr.drawBuffer=n(qe.maxDrawbuffers,function(Ct){return Ct===0?[0]:n(Ct,function(lr){return 36064+lr})}));var yr=0;return{next:Nn,current:Yr,procs:function(){var Ct=Mt(),lr=Ct.proc("poll"),dr=Ct.proc("refresh"),Fr=Ct.block();lr(Fr),dr(Fr);var Rr,zr=(_r=Ct.shared).gl,Er=_r.next,xr=_r.current;Fr(xr,".dirty=false;"),Zt(Ct,lr),Zt(Ct,dr,null,!0),Br&&(Rr=Ct.link(Br)),De.oes_vertex_array_object&&dr(Ct.link(De.oes_vertex_array_object),".bindVertexArrayOES(null);");var _r=dr.def(_r.attributes),kr=dr.def(0),Cr=Ct.cond(kr,".buffer");Cr.then(zr,".enableVertexAttribArray(i);",zr,".bindBuffer(",34962,",",kr,".buffer.buffer);",zr,".vertexAttribPointer(i,",kr,".size,",kr,".type,",kr,".normalized,",kr,".stride,",kr,".offset);").else(zr,".disableVertexAttribArray(i);",zr,".vertexAttrib4f(i,",kr,".x,",kr,".y,",kr,".z,",kr,".w);",kr,".buffer=null;");var Gr=Ct.link(qe.maxAttributes,{stable:!0});return dr("for(var i=0;i<",Gr,";++i){",kr,"=",_r,"[i];",Cr,"}"),Br&&dr("for(var i=0;i<",Gr,";++i){",Rr,".vertexAttribDivisorANGLE(i,",_r,"[i].divisor);","}"),dr(Ct.shared.vao,".currentVAO=null;",Ct.shared.vao,".setVAO(",Ct.shared.vao,".targetVAO);"),Object.keys(xn).forEach(function(qr){var tn=xn[qr],rn=Fr.def(Er,".",qr),yn=Ct.block();yn("if(",rn,"){",zr,".enable(",tn,")}else{",zr,".disable(",tn,")}",xr,".",qr,"=",rn,";"),dr(yn),lr("if(",rn,"!==",xr,".",qr,"){",yn,"}")}),Object.keys(On).forEach(function(qr){var tn,rn,yn=On[qr],_n=Yr[qr],wn=Ct.block();wn(zr,".",yn,"("),d(_n)?(yn=_n.length,tn=Ct.global.def(Er,".",qr),rn=Ct.global.def(xr,".",qr),wn(n(yn,function(Ln){return tn+"["+Ln+"]"}),");",n(yn,function(Ln){return rn+"["+Ln+"]="+tn+"["+Ln+"];"}).join("")),lr("if(",n(yn,function(Ln){return tn+"["+Ln+"]!=="+rn+"["+Ln+"]"}).join("||"),"){",wn,"}")):(tn=Fr.def(Er,".",qr),rn=Fr.def(xr,".",qr),wn(tn,");",xr,".",qr,"=",tn,";"),lr("if(",tn,"!==",rn,"){",wn,"}")),dr(wn)}),Ct.compile()}(),compile:function(Ct,lr,dr,Fr,Rr){var zr=Mt();zr.stats=zr.link(Rr),Object.keys(lr.static).forEach(function(xr){gn(zr,lr,xr)}),er.forEach(function(xr){gn(zr,Ct,xr)});var Er=Ar(Ct,lr,dr,Fr);return Er.shader.program&&(Er.shader.program.attributes.sort(function(xr,_r){return xr.name<_r.name?-1:1}),Er.shader.program.uniforms.sort(function(xr,_r){return xr.name<_r.name?-1:1})),function(xr,_r){var kr=xr.proc("draw",1);hr(xr,kr),fr(xr,kr,_r.context),Zt(xr,kr,_r.framebuffer),Qt(xr,kr,_r),$t(xr,kr,_r.state),vr(xr,kr,_r,!1,!0);var Cr=_r.shader.progVar.append(xr,kr);if(kr(xr.shared.gl,".useProgram(",Cr,".program);"),_r.shader.program)mn(xr,kr,_r,_r.shader.program);else{kr(xr.shared.vao,".setVAO(null);");var Gr=xr.global.def("{}"),qr=kr.def(Cr,".id"),tn=kr.def(Gr,"[",qr,"]");kr(xr.cond(tn).then(tn,".call(this,a0);").else(tn,"=",Gr,"[",qr,"]=",xr.link(function(rn){return Jr(mn,xr,_r,rn,1)}),"(",Cr,");",tn,".call(this,a0);"))}0<Object.keys(_r.state).length&&kr(xr.shared.current,".dirty=true;"),xr.shared.vao&&kr(xr.shared.vao,".setVAO(null);")}(zr,Er),vn(zr,Er),function(xr,_r){function kr(_n){return _n.contextDep&&Gr||_n.propDep}var Cr=xr.proc("batch",2);xr.batchId="0",hr(xr,Cr);var Gr=!1,qr=!0;Object.keys(_r.context).forEach(function(_n){Gr=Gr||_r.context[_n].propDep}),Gr||(fr(xr,Cr,_r.context),qr=!1);var tn=!1;if((rn=_r.framebuffer)?(rn.propDep?Gr=tn=!0:rn.contextDep&&Gr&&(tn=!0),tn||Zt(xr,Cr,rn)):Zt(xr,Cr,null),_r.state.viewport&&_r.state.viewport.propDep&&(Gr=!0),Qt(xr,Cr,_r),$t(xr,Cr,_r.state,function(_n){return!kr(_n)}),_r.profile&&kr(_r.profile)||vr(xr,Cr,_r,!1,"a1"),_r.contextDep=Gr,_r.needsContext=qr,_r.needsFramebuffer=tn,(qr=_r.shader.progVar).contextDep&&Gr||qr.propDep)In(xr,Cr,_r,null);else if(qr=qr.append(xr,Cr),Cr(xr.shared.gl,".useProgram(",qr,".program);"),_r.shader.program)In(xr,Cr,_r,_r.shader.program);else{Cr(xr.shared.vao,".setVAO(null);");var rn=xr.global.def("{}"),yn=(tn=Cr.def(qr,".id"),Cr.def(rn,"[",tn,"]"));Cr(xr.cond(yn).then(yn,".call(this,a0,a1);").else(yn,"=",rn,"[",tn,"]=",xr.link(function(_n){return Jr(In,xr,_r,_n,2)}),"(",qr,");",yn,".call(this,a0,a1);"))}0<Object.keys(_r.state).length&&Cr(xr.shared.current,".dirty=true;"),xr.shared.vao&&Cr(xr.shared.vao,".setVAO(null);")}(zr,Er),j(zr.compile(),{destroy:function(){Er.shader.program.destroy()}})}}}function ee(he,xe){for(var De=0;De<he.length;++De)if(he[De]===xe)return De;return-1}var j=function(he,xe){for(var De=Object.keys(xe),qe=0;qe<De.length;++qe)he[De[qe]]=xe[De[qe]];return he},Q=0,K={DynamicVariable:p,define:function(he,xe){return new p(he,g(xe+""))},isDynamic:function(he){return typeof he=="function"&&!he._reglType||he instanceof p},unbox:function he(xe,De){return typeof xe=="function"?new p(0,xe):typeof xe=="number"||typeof xe=="boolean"?new p(5,xe):Array.isArray(xe)?new p(6,xe.map(function(qe,Xe){return he(qe)})):xe instanceof p?xe:void 0},accessor:g},re={next:typeof requestAnimationFrame=="function"?function(he){return requestAnimationFrame(he)}:function(he){return setTimeout(he,16)},cancel:typeof cancelAnimationFrame=="function"?function(he){return cancelAnimationFrame(he)}:clearTimeout},ne=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},le=a();le.zero=a();var oe=function(he,xe){var De=1;xe.ext_texture_filter_anisotropic&&(De=he.getParameter(34047));var qe=1,Xe=1;xe.webgl_draw_buffers&&(qe=he.getParameter(34852),Xe=he.getParameter(36063));var He=!!xe.oes_texture_float;if(He){He=he.createTexture(),he.bindTexture(3553,He),he.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var st=he.createFramebuffer();if(he.bindFramebuffer(36160,st),he.framebufferTexture2D(36160,36064,3553,He,0),he.bindTexture(3553,null),he.checkFramebufferStatus(36160)!==36053)He=!1;else{he.viewport(0,0,1,1),he.clearColor(1,0,0,1),he.clear(16384);var it=le.allocType(5126,4);he.readPixels(0,0,1,1,6408,5126,it),he.getError()?He=!1:(he.deleteFramebuffer(st),he.deleteTexture(He),He=it[0]===1),le.freeType(it)}}return it=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(it=he.createTexture(),st=le.allocType(5121,36),he.activeTexture(33984),he.bindTexture(34067,it),he.texImage2D(34069,0,6408,3,3,0,6408,5121,st),le.freeType(st),he.bindTexture(34067,null),he.deleteTexture(it),it=!he.getError()),{colorBits:[he.getParameter(3410),he.getParameter(3411),he.getParameter(3412),he.getParameter(3413)],depthBits:he.getParameter(3414),stencilBits:he.getParameter(3415),subpixelBits:he.getParameter(3408),extensions:Object.keys(xe).filter(function(Tt){return!!xe[Tt]}),maxAnisotropic:De,maxDrawbuffers:qe,maxColorAttachments:Xe,pointSizeDims:he.getParameter(33901),lineWidthDims:he.getParameter(33902),maxViewportDims:he.getParameter(3386),maxCombinedTextureUnits:he.getParameter(35661),maxCubeMapSize:he.getParameter(34076),maxRenderbufferSize:he.getParameter(34024),maxTextureUnits:he.getParameter(34930),maxTextureSize:he.getParameter(3379),maxAttributes:he.getParameter(34921),maxVertexUniforms:he.getParameter(36347),maxVertexTextureUnits:he.getParameter(35660),maxVaryingVectors:he.getParameter(36348),maxFragmentUniforms:he.getParameter(36349),glsl:he.getParameter(35724),renderer:he.getParameter(7937),vendor:he.getParameter(7936),version:he.getParameter(7938),readFloat:He,npotTextureCube:it}},de=function(he){return he instanceof Uint8Array||he instanceof Uint16Array||he instanceof Uint32Array||he instanceof Int8Array||he instanceof Int16Array||he instanceof Int32Array||he instanceof Float32Array||he instanceof Float64Array||he instanceof Uint8ClampedArray},se=function(he){return Object.keys(he).map(function(xe){return he[xe]})},me={shape:function(he){for(var xe=[];he.length;he=he[0])xe.push(he.length);return xe},flatten:function(he,xe,De,qe){var Xe=1;if(xe.length)for(var He=0;He<xe.length;++He)Xe*=xe[He];else Xe=0;switch(De=qe||le.allocType(De,Xe),xe.length){case 0:break;case 1:for(qe=xe[0],xe=0;xe<qe;++xe)De[xe]=he[xe];break;case 2:for(qe=xe[0],xe=xe[1],He=Xe=0;He<qe;++He)for(var st=he[He],it=0;it<xe;++it)De[Xe++]=st[it];break;case 3:m(he,xe[0],xe[1],xe[2],De,0);break;default:(function Tt(Pt,rt,ut,Ft,wt){for(var Lt=1,Ae=ut+1;Ae<rt.length;++Ae)Lt*=rt[Ae];var Ye=rt[ut];if(rt.length-ut==4){var nt=rt[ut+1],ft=rt[ut+2];for(rt=rt[ut+3],Ae=0;Ae<Ye;++Ae)m(Pt[Ae],nt,ft,rt,Ft,wt),wt+=Lt}else for(Ae=0;Ae<Ye;++Ae)Tt(Pt[Ae],rt,ut+1,Ft,wt),wt+=Lt})(he,xe,0,De,0)}return De}},Te={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},_e={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},be={dynamic:35048,stream:35040,static:35044},Ce=me.flatten,fe=me.shape,ve=[];ve[5120]=1,ve[5122]=2,ve[5124]=4,ve[5121]=1,ve[5123]=2,ve[5125]=4,ve[5126]=4;var Me={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ke=new Float32Array(1),Le=new Uint32Array(ke.buffer),ze=[9984,9986,9985,9987],Re=[0,6409,6410,6407,6408],Oe={};Oe[6409]=Oe[6406]=Oe[6402]=1,Oe[34041]=Oe[6410]=2,Oe[6407]=Oe[35904]=3,Oe[6408]=Oe[35906]=4;var Ze=s("HTMLCanvasElement"),Pe=s("OffscreenCanvas"),Ie=s("CanvasRenderingContext2D"),Be=s("ImageBitmap"),Fe=s("HTMLImageElement"),$e=s("HTMLVideoElement"),ot=Object.keys(Te).concat([Ze,Pe,Ie,Be,Fe,$e]),pt=[];pt[5121]=1,pt[5126]=4,pt[36193]=2,pt[5123]=2,pt[5125]=4;var _t=[];_t[32854]=2,_t[32855]=2,_t[36194]=2,_t[34041]=4,_t[33776]=.5,_t[33777]=.5,_t[33778]=1,_t[33779]=1,_t[35986]=.5,_t[35987]=1,_t[34798]=1,_t[35840]=.5,_t[35841]=.25,_t[35842]=.5,_t[35843]=.25,_t[36196]=.5;var yt=[];yt[32854]=2,yt[32855]=2,yt[36194]=2,yt[33189]=2,yt[36168]=1,yt[34041]=4,yt[35907]=4,yt[34836]=16,yt[34842]=8,yt[34843]=6;var tt=function(he,xe,De,qe,Xe){function He(ut){this.id=Pt++,this.refCount=1,this.renderbuffer=ut,this.format=32854,this.height=this.width=0,Xe.profile&&(this.stats={size:0})}function st(ut){var Ft=ut.renderbuffer;he.bindRenderbuffer(36161,null),he.deleteRenderbuffer(Ft),ut.renderbuffer=null,ut.refCount=0,delete rt[ut.id],qe.renderbufferCount--}var it={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};xe.ext_srgb&&(it.srgba=35907),xe.ext_color_buffer_half_float&&(it.rgba16f=34842,it.rgb16f=34843),xe.webgl_color_buffer_float&&(it.rgba32f=34836);var Tt=[];Object.keys(it).forEach(function(ut){Tt[it[ut]]=ut});var Pt=0,rt={};return He.prototype.decRef=function(){0>=--this.refCount&&st(this)},Xe.profile&&(qe.getTotalRenderbufferSize=function(){var ut=0;return Object.keys(rt).forEach(function(Ft){ut+=rt[Ft].stats.size}),ut}),{create:function(ut,Ft){function wt(Ae,Ye){var nt=0,ft=0,Mt=32854;if(typeof Ae=="object"&&Ae?("shape"in Ae?(nt=0|(ft=Ae.shape)[0],ft=0|ft[1]):("radius"in Ae&&(nt=ft=0|Ae.radius),"width"in Ae&&(nt=0|Ae.width),"height"in Ae&&(ft=0|Ae.height)),"format"in Ae&&(Mt=it[Ae.format])):typeof Ae=="number"?(nt=0|Ae,ft=typeof Ye=="number"?0|Ye:nt):Ae||(nt=ft=1),nt!==Lt.width||ft!==Lt.height||Mt!==Lt.format)return wt.width=Lt.width=nt,wt.height=Lt.height=ft,Lt.format=Mt,he.bindRenderbuffer(36161,Lt.renderbuffer),he.renderbufferStorage(36161,Mt,nt,ft),Xe.profile&&(Lt.stats.size=yt[Lt.format]*Lt.width*Lt.height),wt.format=Tt[Lt.format],wt}var Lt=new He(he.createRenderbuffer());return rt[Lt.id]=Lt,qe.renderbufferCount++,wt(ut,Ft),wt.resize=function(Ae,Ye){var nt=0|Ae,ft=0|Ye||nt;return nt===Lt.width&&ft===Lt.height||(wt.width=Lt.width=nt,wt.height=Lt.height=ft,he.bindRenderbuffer(36161,Lt.renderbuffer),he.renderbufferStorage(36161,Lt.format,nt,ft),Xe.profile&&(Lt.stats.size=yt[Lt.format]*Lt.width*Lt.height)),wt},wt._reglType="renderbuffer",wt._renderbuffer=Lt,Xe.profile&&(wt.stats=Lt.stats),wt.destroy=function(){Lt.decRef()},wt},clear:function(){se(rt).forEach(st)},restore:function(){se(rt).forEach(function(ut){ut.renderbuffer=he.createRenderbuffer(),he.bindRenderbuffer(36161,ut.renderbuffer),he.renderbufferStorage(36161,ut.format,ut.width,ut.height)}),he.bindRenderbuffer(36161,null)}}},Ke=[];Ke[6408]=4,Ke[6407]=3;var vt=[];vt[5121]=1,vt[5126]=4,vt[36193]=2;var Nt=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],qt=["x","y","z","w"],er="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Jt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ir={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ht={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ue={cw:2304,ccw:2305},We=new W(!1,!1,!1,function(){});return function(he){function xe(){if(en.length===0)Rt&&Rt.update(),Sn=null;else{Sn=re.next(xe),rt();for(var Br=en.length-1;0<=Br;--Br){var pn=en[Br];pn&&pn(Ar,null,0)}wt.flush(),Rt&&Rt.update()}}function De(){!Sn&&0<en.length&&(Sn=re.next(xe))}function qe(){Sn&&(re.cancel(xe),Sn=null)}function Xe(Br){Br.preventDefault(),qe(),In.forEach(function(pn){pn()})}function He(Br){wt.getError(),Ae.restore(),hr.restore(),Zt.restore(),vr.restore(),Mr.restore(),Nr.restore(),$t.restore(),Rt&&Rt.restore(),Ur.procs.refresh(),De(),vn.forEach(function(pn){pn()})}function st(Br){function pn(Ct,lr){var dr={},Fr={};return Object.keys(Ct).forEach(function(Rr){var zr=Ct[Rr];if(K.isDynamic(zr))Fr[Rr]=K.unbox(zr,Rr);else{if(lr&&Array.isArray(zr)){for(var Er=0;Er<zr.length;++Er)if(K.isDynamic(zr[Er]))return void(Fr[Rr]=K.unbox(zr,Rr))}dr[Rr]=zr}}),{dynamic:Fr,static:dr}}var on=pn(Br.context||{},!0),Yr=pn(Br.uniforms||{},!0),Nn=pn(Br.attributes||{},!1);Br=pn(function(Ct){function lr(Fr){if(Fr in dr){var Rr=dr[Fr];delete dr[Fr],Object.keys(Rr).forEach(function(zr){dr[Fr+"."+zr]=Rr[zr]})}}var dr=j({},Ct);return delete dr.uniforms,delete dr.attributes,delete dr.context,delete dr.vao,"stencil"in dr&&dr.stencil.op&&(dr.stencil.opBack=dr.stencil.opFront=dr.stencil.op,delete dr.stencil.op),lr("blend"),lr("depth"),lr("cull"),lr("stencil"),lr("polygonOffset"),lr("scissor"),lr("sample"),"vao"in Ct&&(dr.vao=Ct.vao),dr}(Br),!1);var Hn={gpuTime:0,cpuTime:0,count:0},xn=Ur.compile(Br,Nn,Yr,on,Hn),On=xn.draw,ua=xn.batch,tr=xn.scope,yr=[];return j(function(Ct,lr){var dr;if(typeof Ct=="function")return tr.call(this,null,Ct,0);if(typeof lr=="function")if(typeof Ct=="number")for(dr=0;dr<Ct;++dr)tr.call(this,null,lr,dr);else{if(!Array.isArray(Ct))return tr.call(this,Ct,lr,0);for(dr=0;dr<Ct.length;++dr)tr.call(this,Ct[dr],lr,dr)}else if(typeof Ct=="number"){if(0<Ct)return ua.call(this,function(Fr){for(;yr.length<Fr;)yr.push(null);return yr}(0|Ct),0|Ct)}else{if(!Array.isArray(Ct))return On.call(this,Ct);if(Ct.length)return ua.call(this,Ct,Ct.length)}},{stats:Hn,destroy:function(){xn.destroy()}})}function it(Br,pn){var on=0;Ur.procs.poll();var Yr=pn.color;Yr&&(wt.clearColor(+Yr[0]||0,+Yr[1]||0,+Yr[2]||0,+Yr[3]||0),on|=16384),"depth"in pn&&(wt.clearDepth(+pn.depth),on|=256),"stencil"in pn&&(wt.clearStencil(0|pn.stencil),on|=1024),wt.clear(on)}function Tt(Br){return en.push(Br),De(),{cancel:function(){var pn=ee(en,Br);en[pn]=function on(){var Yr=ee(en,on);en[Yr]=en[en.length-1],--en.length,0>=en.length&&qe()}}}}function Pt(){var Br=Jr.viewport,pn=Jr.scissor_box;Br[0]=Br[1]=pn[0]=pn[1]=0,Ar.viewportWidth=Ar.framebufferWidth=Ar.drawingBufferWidth=Br[2]=pn[2]=wt.drawingBufferWidth,Ar.viewportHeight=Ar.framebufferHeight=Ar.drawingBufferHeight=Br[3]=pn[3]=wt.drawingBufferHeight}function rt(){Ar.tick+=1,Ar.time=Ft(),Pt(),Ur.procs.poll()}function ut(){vr.refresh(),Pt(),Ur.procs.refresh(),Rt&&Rt.update()}function Ft(){return(ne()-Gt)/1e3}if(!(he=e(he)))return null;var wt=he.gl,Lt=wt.getContextAttributes();wt.isContextLost();var Ae=function(Br,pn){function on(xn){var On;xn=xn.toLowerCase();try{On=Yr[xn]=Br.getExtension(xn)}catch{}return!!On}for(var Yr={},Nn=0;Nn<pn.extensions.length;++Nn){var Hn=pn.extensions[Nn];if(!on(Hn))return pn.onDestroy(),pn.onDone('"'+Hn+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return pn.optionalExtensions.forEach(on),{extensions:Yr,restore:function(){Object.keys(Yr).forEach(function(xn){if(Yr[xn]&&!on(xn))throw Error("(regl): error restoring extension "+xn)})}}}(wt,he);if(!Ae)return null;var Ye=function(){var Br={"":0},pn=[""];return{id:function(on){var Yr=Br[on];return Yr||(Yr=Br[on]=pn.length,pn.push(on),Yr)},str:function(on){return pn[on]}}}(),nt={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},ft=he.cachedCode||{},Mt=Ae.extensions,Rt=function(Br,pn){function on(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function Yr(yr,Ct,lr){var dr=xn.pop()||new on;dr.startQueryIndex=yr,dr.endQueryIndex=Ct,dr.sum=0,dr.stats=lr,On.push(dr)}if(!pn.ext_disjoint_timer_query)return null;var Nn=[],Hn=[],xn=[],On=[],ua=[],tr=[];return{beginQuery:function(yr){var Ct=Nn.pop()||pn.ext_disjoint_timer_query.createQueryEXT();pn.ext_disjoint_timer_query.beginQueryEXT(35007,Ct),Hn.push(Ct),Yr(Hn.length-1,Hn.length,yr)},endQuery:function(){pn.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:Yr,update:function(){var yr,Ct;if((yr=Hn.length)!==0){tr.length=Math.max(tr.length,yr+1),ua.length=Math.max(ua.length,yr+1),ua[0]=0;var lr=tr[0]=0;for(Ct=yr=0;Ct<Hn.length;++Ct){var dr=Hn[Ct];pn.ext_disjoint_timer_query.getQueryObjectEXT(dr,34919)?(lr+=pn.ext_disjoint_timer_query.getQueryObjectEXT(dr,34918),Nn.push(dr)):Hn[yr++]=dr,ua[Ct+1]=lr,tr[Ct+1]=yr}for(Hn.length=yr,Ct=yr=0;Ct<On.length;++Ct){var Fr=(lr=On[Ct]).startQueryIndex;dr=lr.endQueryIndex,lr.sum+=ua[dr]-ua[Fr],Fr=tr[Fr],(dr=tr[dr])===Fr?(lr.stats.gpuTime+=lr.sum/1e6,xn.push(lr)):(lr.startQueryIndex=Fr,lr.endQueryIndex=dr,On[yr++]=lr)}On.length=yr}},getNumPendingQueries:function(){return Hn.length},clear:function(){Nn.push.apply(Nn,Hn);for(var yr=0;yr<Nn.length;yr++)pn.ext_disjoint_timer_query.deleteQueryEXT(Nn[yr]);Hn.length=0,Nn.length=0},restore:function(){Hn.length=0,Nn.length=0}}}(0,Mt),Gt=ne(),jt=wt.drawingBufferWidth,pr=wt.drawingBufferHeight,Ar={tick:0,time:0,viewportWidth:jt,viewportHeight:pr,framebufferWidth:jt,framebufferHeight:pr,drawingBufferWidth:jt,drawingBufferHeight:pr,pixelRatio:he.pixelRatio},fr=(jt={elements:null,primitive:4,count:-1,offset:0,instances:-1},oe(wt,Mt)),Zt=f(wt,nt,he,function(Br){return $t.destroyBuffer(Br)}),Qt=l(wt,Mt,Zt,nt),$t=P(wt,Mt,fr,nt,Zt,Qt,jt),hr=S(wt,Ye,nt,he),vr=L(wt,Mt,fr,function(){Ur.procs.poll()},Ar,nt,he),Mr=tt(wt,Mt,0,nt,he),Nr=A(wt,Mt,fr,vr,Mr,nt),Ur=U(wt,Ye,Mt,fr,Zt,Qt,0,Nr,{},$t,hr,jt,Ar,Rt,ft,he),Jr=(Ye=E(wt,Nr,Ur.procs.poll,Ar),Ur.next),mn=wt.canvas,en=[],In=[],vn=[],gn=[he.onDestroy],Sn=null;mn&&(mn.addEventListener("webglcontextlost",Xe,!1),mn.addEventListener("webglcontextrestored",He,!1));var Xn=Nr.setFBO=st({framebuffer:K.define.call(null,1,"framebuffer")});return ut(),Lt=j(st,{clear:function(Br){if("framebuffer"in Br)if(Br.framebuffer&&Br.framebuffer_reglType==="framebufferCube")for(var pn=0;6>pn;++pn)Xn(j({framebuffer:Br.framebuffer.faces[pn]},Br),it);else Xn(Br,it);else it(0,Br)},prop:K.define.bind(null,1),context:K.define.bind(null,2),this:K.define.bind(null,3),draw:st({}),buffer:function(Br){return Zt.create(Br,34962,!1,!1)},elements:function(Br){return Qt.create(Br,!1)},texture:vr.create2D,cube:vr.createCube,renderbuffer:Mr.create,framebuffer:Nr.create,framebufferCube:Nr.createCube,vao:$t.createVAO,attributes:Lt,frame:Tt,on:function(Br,pn){var on;switch(Br){case"frame":return Tt(pn);case"lost":on=In;break;case"restore":on=vn;break;case"destroy":on=gn}return on.push(pn),{cancel:function(){for(var Yr=0;Yr<on.length;++Yr)if(on[Yr]===pn){on[Yr]=on[on.length-1],on.pop();break}}}},limits:fr,hasExtension:function(Br){return 0<=fr.extensions.indexOf(Br.toLowerCase())},read:Ye,destroy:function(){en.length=0,qe(),mn&&(mn.removeEventListener("webglcontextlost",Xe),mn.removeEventListener("webglcontextrestored",He)),hr.clear(),Nr.clear(),Mr.clear(),$t.clear(),vr.clear(),Qt.clear(),Zt.clear(),Rt&&Rt.clear(),gn.forEach(function(Br){Br()})},_gl:wt,_refresh:ut,poll:function(){rt(),Rt&&Rt.update()},now:Ft,stats:nt,getCachedCode:function(){return ft},preloadCachedCode:function(Br){Object.entries(Br).forEach(function(pn){ft[pn[0]]=pn[1]})}}),he.onDone(null,Lt),Lt}})},{}],285:[function(v,J,Z){var p=v("buffer"),g=p.Buffer;function b(e,n){for(var t in e)n[t]=e[t]}function y(e,n,t){return g(e,n,t)}g.from&&g.alloc&&g.allocUnsafe&&g.allocUnsafeSlow?J.exports=p:(b(p,Z),Z.Buffer=y),y.prototype=Object.create(g.prototype),b(g,y),y.from=function(e,n,t){if(typeof e=="number")throw new TypeError("Argument must not be a number");return g(e,n,t)},y.alloc=function(e,n,t){if(typeof e!="number")throw new TypeError("Argument must be a number");var a=g(e);return n!==void 0?typeof t=="string"?a.fill(n,t):a.fill(n):a.fill(0),a},y.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return g(e)},y.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return p.SlowBuffer(e)}},{buffer:85}],286:[function(v,J,Z){J.exports=g;var p=v("events").EventEmitter;function g(){p.call(this)}v("inherits")(g,p),g.Readable=v("readable-stream/lib/_stream_readable.js"),g.Writable=v("readable-stream/lib/_stream_writable.js"),g.Duplex=v("readable-stream/lib/_stream_duplex.js"),g.Transform=v("readable-stream/lib/_stream_transform.js"),g.PassThrough=v("readable-stream/lib/_stream_passthrough.js"),g.finished=v("readable-stream/lib/internal/streams/end-of-stream.js"),g.pipeline=v("readable-stream/lib/internal/streams/pipeline.js"),g.Stream=g,g.prototype.pipe=function(b,y){var e=this;function n(u){b.writable&&b.write(u)===!1&&e.pause&&e.pause()}function t(){e.readable&&e.resume&&e.resume()}e.on("data",n),b.on("drain",t),b._isStdio||y&&y.end===!1||(e.on("end",r),e.on("close",m));var a=!1;function r(){a||(a=!0,b.end())}function m(){a||(a=!0,typeof b.destroy=="function"&&b.destroy())}function o(u){if(i(),p.listenerCount(this,"error")===0)throw u}function i(){e.removeListener("data",n),b.removeListener("drain",t),e.removeListener("end",r),e.removeListener("close",m),e.removeListener("error",o),b.removeListener("error",o),e.removeListener("end",i),e.removeListener("close",i),b.removeListener("close",i)}return e.on("error",o),b.on("error",o),e.on("end",i),e.on("close",i),b.on("close",i),b.emit("pipe",e),b}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":288,"readable-stream/lib/_stream_passthrough.js":289,"readable-stream/lib/_stream_readable.js":290,"readable-stream/lib/_stream_transform.js":291,"readable-stream/lib/_stream_writable.js":292,"readable-stream/lib/internal/streams/end-of-stream.js":296,"readable-stream/lib/internal/streams/pipeline.js":298}],287:[function(v,J,Z){var p={};function g(y,e,n){n||(n=Error);var t=function(a){var r,m;function o(i,u,f){return a.call(this,function(l,h,d){return typeof e=="string"?e:e(l,h,d)}(i,u,f))||this}return m=a,(r=o).prototype=Object.create(m.prototype),r.prototype.constructor=r,r.__proto__=m,o}(n);t.prototype.name=n.name,t.prototype.code=y,p[y]=t}function b(y,e){if(Array.isArray(y)){var n=y.length;return y=y.map(function(t){return String(t)}),n>2?"one of ".concat(e," ").concat(y.slice(0,n-1).join(", "),", or ")+y[n-1]:n===2?"one of ".concat(e," ").concat(y[0]," or ").concat(y[1]):"of ".concat(e," ").concat(y[0])}return"of ".concat(e," ").concat(String(y))}g("ERR_INVALID_OPT_VALUE",function(y,e){return'The value "'+e+'" is invalid for option "'+y+'"'},TypeError),g("ERR_INVALID_ARG_TYPE",function(y,e,n){var t,a,r;if(typeof e=="string"&&(a="not ",e.substr(0,a.length)===a)?(t="must not be",e=e.replace(/^not /,"")):t="must be",function(o,i,u){return(u===void 0||u>o.length)&&(u=o.length),o.substring(u-i.length,u)===i}(y," argument"))r="The ".concat(y," ").concat(t," ").concat(b(e,"type"));else{var m=function(o,i,u){return typeof u!="number"&&(u=0),!(u+i.length>o.length)&&o.indexOf(i,u)!==-1}(y,".")?"property":"argument";r='The "'.concat(y,'" ').concat(m," ").concat(t," ").concat(b(e,"type"))}return r+=". Received type ".concat(typeof n)},TypeError),g("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),g("ERR_METHOD_NOT_IMPLEMENTED",function(y){return"The "+y+" method is not implemented"}),g("ERR_STREAM_PREMATURE_CLOSE","Premature close"),g("ERR_STREAM_DESTROYED",function(y){return"Cannot call "+y+" after a stream was destroyed"}),g("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),g("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),g("ERR_STREAM_WRITE_AFTER_END","write after end"),g("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),g("ERR_UNKNOWN_ENCODING",function(y){return"Unknown encoding: "+y},TypeError),g("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),J.exports.codes=p},{}],288:[function(v,J,Z){(function(p){(function(){var g=Object.keys||function(o){var i=[];for(var u in o)i.push(u);return i};J.exports=a;var b=v("./_stream_readable"),y=v("./_stream_writable");v("inherits")(a,b);for(var e=g(y.prototype),n=0;n<e.length;n++){var t=e[n];a.prototype[t]||(a.prototype[t]=y.prototype[t])}function a(o){if(!(this instanceof a))return new a(o);b.call(this,o),y.call(this,o),this.allowHalfOpen=!0,o&&(o.readable===!1&&(this.readable=!1),o.writable===!1&&(this.writable=!1),o.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",r)))}function r(){this._writableState.ended||p.nextTick(m,this)}function m(o){o.end()}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(o){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=o,this._writableState.destroyed=o)}})}).call(this)}).call(this,v("_process"))},{"./_stream_readable":290,"./_stream_writable":292,_process:278,inherits:231}],289:[function(v,J,Z){J.exports=g;var p=v("./_stream_transform");function g(b){if(!(this instanceof g))return new g(b);p.call(this,b)}v("inherits")(g,p),g.prototype._transform=function(b,y,e){e(null,b)}},{"./_stream_transform":291,inherits:231}],290:[function(v,J,Z){(function(p,g){(function(){var b;J.exports=k,k.ReadableState=w,v("events").EventEmitter;var y=function(N,B){return N.listeners(B).length},e=v("./internal/streams/stream"),n=v("buffer").Buffer,t=g.Uint8Array||function(){},a,r=v("util");a=r&&r.debuglog?r.debuglog("stream"):function(){};var m,o,i,u=v("./internal/streams/buffer_list"),f=v("./internal/streams/destroy"),l=v("./internal/streams/state").getHighWaterMark,h=v("../errors").codes,d=h.ERR_INVALID_ARG_TYPE,s=h.ERR_STREAM_PUSH_AFTER_EOF,x=h.ERR_METHOD_NOT_IMPLEMENTED,c=h.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;v("inherits")(k,e);var T=f.errorOrDestroy,_=["error","close","destroy","pause","resume"];function w(N,B,U){b=b||v("./_stream_duplex"),N=N||{},typeof U!="boolean"&&(U=B instanceof b),this.objectMode=!!N.objectMode,U&&(this.objectMode=this.objectMode||!!N.readableObjectMode),this.highWaterMark=l(this,N,"readableHighWaterMark",U),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=N.emitClose!==!1,this.autoDestroy=!!N.autoDestroy,this.destroyed=!1,this.defaultEncoding=N.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,N.encoding&&(m||(m=v("string_decoder/").StringDecoder),this.decoder=new m(N.encoding),this.encoding=N.encoding)}function k(N){if(b=b||v("./_stream_duplex"),!(this instanceof k))return new k(N);var B=this instanceof b;this._readableState=new w(N,this,B),this.readable=!0,N&&(typeof N.read=="function"&&(this._read=N.read),typeof N.destroy=="function"&&(this._destroy=N.destroy)),e.call(this)}function L(N,B,U,ee,j){a("readableAddChunk",B);var Q,K=N._readableState;if(B===null)K.reading=!1,function(re,ne){if(a("onEofChunk"),!ne.ended){if(ne.decoder){var le=ne.decoder.end();le&&le.length&&(ne.buffer.push(le),ne.length+=ne.objectMode?1:le.length)}ne.ended=!0,ne.sync?P(re):(ne.needReadable=!1,ne.emittedReadable||(ne.emittedReadable=!0,S(re)))}}(N,K);else if(j||(Q=function(re,ne){var le;oe=ne,n.isBuffer(oe)||oe instanceof t||typeof ne=="string"||ne===void 0||re.objectMode||(le=new d("chunk",["string","Buffer","Uint8Array"],ne));var oe;return le}(K,B)),Q)T(N,Q);else if(K.objectMode||B&&B.length>0)if(typeof B=="string"||K.objectMode||Object.getPrototypeOf(B)===n.prototype||(B=function(re){return n.from(re)}(B)),ee)K.endEmitted?T(N,new c):A(N,K,B,!0);else if(K.ended)T(N,new s);else{if(K.destroyed)return!1;K.reading=!1,K.decoder&&!U?(B=K.decoder.write(B),K.objectMode||B.length!==0?A(N,K,B,!1):E(N,K)):A(N,K,B,!1)}else ee||(K.reading=!1,E(N,K));return!K.ended&&(K.length<K.highWaterMark||K.length===0)}function A(N,B,U,ee){B.flowing&&B.length===0&&!B.sync?(B.awaitDrain=0,N.emit("data",U)):(B.length+=B.objectMode?1:U.length,ee?B.buffer.unshift(U):B.buffer.push(U),B.needReadable&&P(N)),E(N,B)}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(N){this._readableState&&(this._readableState.destroyed=N)}}),k.prototype.destroy=f.destroy,k.prototype._undestroy=f.undestroy,k.prototype._destroy=function(N,B){B(N)},k.prototype.push=function(N,B){var U,ee=this._readableState;return ee.objectMode?U=!0:typeof N=="string"&&((B=B||ee.defaultEncoding)!==ee.encoding&&(N=n.from(N,B),B=""),U=!0),L(this,N,B,!1,U)},k.prototype.unshift=function(N){return L(this,N,null,!0,!1)},k.prototype.isPaused=function(){return this._readableState.flowing===!1},k.prototype.setEncoding=function(N){m||(m=v("string_decoder/").StringDecoder);var B=new m(N);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var U=this._readableState.buffer.head,ee="";U!==null;)ee+=B.write(U.data),U=U.next;return this._readableState.buffer.clear(),ee!==""&&this._readableState.buffer.push(ee),this._readableState.length=ee.length,this};function I(N,B){return N<=0||B.length===0&&B.ended?0:B.objectMode?1:N!=N?B.flowing&&B.length?B.buffer.head.data.length:B.length:(N>B.highWaterMark&&(B.highWaterMark=function(U){return U>=1073741824?U=1073741824:(U--,U|=U>>>1,U|=U>>>2,U|=U>>>4,U|=U>>>8,U|=U>>>16,U++),U}(N)),N<=B.length?N:B.ended?B.length:(B.needReadable=!0,0))}function P(N){var B=N._readableState;a("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(a("emitReadable",B.flowing),B.emittedReadable=!0,p.nextTick(S,N))}function S(N){var B=N._readableState;a("emitReadable_",B.destroyed,B.length,B.ended),B.destroyed||!B.length&&!B.ended||(N.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,X(N)}function E(N,B){B.readingMore||(B.readingMore=!0,p.nextTick(D,N,B))}function D(N,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&B.length===0);){var U=B.length;if(a("maybeReadMore read 0"),N.read(0),U===B.length)break}B.readingMore=!1}function R(N){var B=N._readableState;B.readableListening=N.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:N.listenerCount("data")>0&&N.resume()}function H(N){a("readable nexttick read 0"),N.read(0)}function V(N,B){a("resume",B.reading),B.reading||N.read(0),B.resumeScheduled=!1,N.emit("resume"),X(N),B.flowing&&!B.reading&&N.read(0)}function X(N){var B=N._readableState;for(a("flow",B.flowing);B.flowing&&N.read()!==null;);}function $(N,B){return B.length===0?null:(B.objectMode?U=B.buffer.shift():!N||N>=B.length?(U=B.decoder?B.buffer.join(""):B.buffer.length===1?B.buffer.first():B.buffer.concat(B.length),B.buffer.clear()):U=B.buffer.consume(N,B.decoder),U);var U}function G(N){var B=N._readableState;a("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,p.nextTick(W,B,N))}function W(N,B){if(a("endReadableNT",N.endEmitted,N.length),!N.endEmitted&&N.length===0&&(N.endEmitted=!0,B.readable=!1,B.emit("end"),N.autoDestroy)){var U=B._writableState;(!U||U.autoDestroy&&U.finished)&&B.destroy()}}function te(N,B){for(var U=0,ee=N.length;U<ee;U++)if(N[U]===B)return U;return-1}k.prototype.read=function(N){a("read",N),N=parseInt(N,10);var B=this._readableState,U=N;if(N!==0&&(B.emittedReadable=!1),N===0&&B.needReadable&&((B.highWaterMark!==0?B.length>=B.highWaterMark:B.length>0)||B.ended))return a("read: emitReadable",B.length,B.ended),B.length===0&&B.ended?G(this):P(this),null;if((N=I(N,B))===0&&B.ended)return B.length===0&&G(this),null;var ee,j=B.needReadable;return a("need readable",j),(B.length===0||B.length-N<B.highWaterMark)&&a("length less than watermark",j=!0),B.ended||B.reading?a("reading or ended",j=!1):j&&(a("do read"),B.reading=!0,B.sync=!0,B.length===0&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(N=I(U,B))),(ee=N>0?$(N,B):null)===null?(B.needReadable=B.length<=B.highWaterMark,N=0):(B.length-=N,B.awaitDrain=0),B.length===0&&(B.ended||(B.needReadable=!0),U!==N&&B.ended&&G(this)),ee!==null&&this.emit("data",ee),ee},k.prototype._read=function(N){T(this,new x("_read()"))},k.prototype.pipe=function(N,B){var U=this,ee=this._readableState;switch(ee.pipesCount){case 0:ee.pipes=N;break;case 1:ee.pipes=[ee.pipes,N];break;default:ee.pipes.push(N)}ee.pipesCount+=1,a("pipe count=%d opts=%j",ee.pipesCount,B);var j=(!B||B.end!==!1)&&N!==p.stdout&&N!==p.stderr?K:me;function Q(Te,_e){a("onunpipe"),Te===U&&_e&&_e.hasUnpiped===!1&&(_e.hasUnpiped=!0,a("cleanup"),N.removeListener("close",de),N.removeListener("finish",se),N.removeListener("drain",re),N.removeListener("error",oe),N.removeListener("unpipe",Q),U.removeListener("end",K),U.removeListener("end",me),U.removeListener("data",le),ne=!0,!ee.awaitDrain||N._writableState&&!N._writableState.needDrain||re())}function K(){a("onend"),N.end()}ee.endEmitted?p.nextTick(j):U.once("end",j),N.on("unpipe",Q);var re=function(Te){return function(){var _e=Te._readableState;a("pipeOnDrain",_e.awaitDrain),_e.awaitDrain&&_e.awaitDrain--,_e.awaitDrain===0&&y(Te,"data")&&(_e.flowing=!0,X(Te))}}(U);N.on("drain",re);var ne=!1;function le(Te){a("ondata");var _e=N.write(Te);a("dest.write",_e),_e===!1&&((ee.pipesCount===1&&ee.pipes===N||ee.pipesCount>1&&te(ee.pipes,N)!==-1)&&!ne&&(a("false write response, pause",ee.awaitDrain),ee.awaitDrain++),U.pause())}function oe(Te){a("onerror",Te),me(),N.removeListener("error",oe),y(N,"error")===0&&T(N,Te)}function de(){N.removeListener("finish",se),me()}function se(){a("onfinish"),N.removeListener("close",de),me()}function me(){a("unpipe"),U.unpipe(N)}return U.on("data",le),function(Te,_e,be){if(typeof Te.prependListener=="function")return Te.prependListener(_e,be);Te._events&&Te._events[_e]?Array.isArray(Te._events[_e])?Te._events[_e].unshift(be):Te._events[_e]=[be,Te._events[_e]]:Te.on(_e,be)}(N,"error",oe),N.once("close",de),N.once("finish",se),N.emit("pipe",U),ee.flowing||(a("pipe resume"),U.resume()),N},k.prototype.unpipe=function(N){var B=this._readableState,U={hasUnpiped:!1};if(B.pipesCount===0)return this;if(B.pipesCount===1)return N&&N!==B.pipes||(N||(N=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,N&&N.emit("unpipe",this,U)),this;if(!N){var ee=B.pipes,j=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var Q=0;Q<j;Q++)ee[Q].emit("unpipe",this,{hasUnpiped:!1});return this}var K=te(B.pipes,N);return K===-1||(B.pipes.splice(K,1),B.pipesCount-=1,B.pipesCount===1&&(B.pipes=B.pipes[0]),N.emit("unpipe",this,U)),this},k.prototype.on=function(N,B){var U=e.prototype.on.call(this,N,B),ee=this._readableState;return N==="data"?(ee.readableListening=this.listenerCount("readable")>0,ee.flowing!==!1&&this.resume()):N==="readable"&&(ee.endEmitted||ee.readableListening||(ee.readableListening=ee.needReadable=!0,ee.flowing=!1,ee.emittedReadable=!1,a("on readable",ee.length,ee.reading),ee.length?P(this):ee.reading||p.nextTick(H,this))),U},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(N,B){var U=e.prototype.removeListener.call(this,N,B);return N==="readable"&&p.nextTick(R,this),U},k.prototype.removeAllListeners=function(N){var B=e.prototype.removeAllListeners.apply(this,arguments);return N!=="readable"&&N!==void 0||p.nextTick(R,this),B},k.prototype.resume=function(){var N=this._readableState;return N.flowing||(a("resume"),N.flowing=!N.readableListening,function(B,U){U.resumeScheduled||(U.resumeScheduled=!0,p.nextTick(V,B,U))}(this,N)),N.paused=!1,this},k.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},k.prototype.wrap=function(N){var B=this,U=this._readableState,ee=!1;for(var j in N.on("end",function(){if(a("wrapped end"),U.decoder&&!U.ended){var K=U.decoder.end();K&&K.length&&B.push(K)}B.push(null)}),N.on("data",function(K){a("wrapped data"),U.decoder&&(K=U.decoder.write(K)),U.objectMode&&K==null||(U.objectMode||K&&K.length)&&(B.push(K)||(ee=!0,N.pause()))}),N)this[j]===void 0&&typeof N[j]=="function"&&(this[j]=function(K){return function(){return N[K].apply(N,arguments)}}(j));for(var Q=0;Q<_.length;Q++)N.on(_[Q],this.emit.bind(this,_[Q]));return this._read=function(K){a("wrapped _read",K),ee&&(ee=!1,N.resume())},this},typeof Symbol=="function"&&(k.prototype[Symbol.asyncIterator]=function(){return o===void 0&&(o=v("./internal/streams/async_iterator")),o(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(N){this._readableState&&(this._readableState.flowing=N)}}),k._fromList=$,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(k.from=function(N,B){return i===void 0&&(i=v("./internal/streams/from")),i(k,N,B)})}).call(this)}).call(this,v("_process"),typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/async_iterator":293,"./internal/streams/buffer_list":294,"./internal/streams/destroy":295,"./internal/streams/from":297,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,events:84,inherits:231,"string_decoder/":301,util:83}],291:[function(v,J,Z){J.exports=a;var p=v("../errors").codes,g=p.ERR_METHOD_NOT_IMPLEMENTED,b=p.ERR_MULTIPLE_CALLBACK,y=p.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=p.ERR_TRANSFORM_WITH_LENGTH_0,n=v("./_stream_duplex");function t(o,i){var u=this._transformState;u.transforming=!1;var f=u.writecb;if(f===null)return this.emit("error",new b);u.writechunk=null,u.writecb=null,i!=null&&this.push(i),f(o);var l=this._readableState;l.reading=!1,(l.needReadable||l.length<l.highWaterMark)&&this._read(l.highWaterMark)}function a(o){if(!(this instanceof a))return new a(o);n.call(this,o),this._transformState={afterTransform:t.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,o&&(typeof o.transform=="function"&&(this._transform=o.transform),typeof o.flush=="function"&&(this._flush=o.flush)),this.on("prefinish",r)}function r(){var o=this;typeof this._flush!="function"||this._readableState.destroyed?m(this,null,null):this._flush(function(i,u){m(o,i,u)})}function m(o,i,u){if(i)return o.emit("error",i);if(u!=null&&o.push(u),o._writableState.length)throw new e;if(o._transformState.transforming)throw new y;return o.push(null)}v("inherits")(a,n),a.prototype.push=function(o,i){return this._transformState.needTransform=!1,n.prototype.push.call(this,o,i)},a.prototype._transform=function(o,i,u){u(new g("_transform()"))},a.prototype._write=function(o,i,u){var f=this._transformState;if(f.writecb=u,f.writechunk=o,f.writeencoding=i,!f.transforming){var l=this._readableState;(f.needTransform||l.needReadable||l.length<l.highWaterMark)&&this._read(l.highWaterMark)}},a.prototype._read=function(o){var i=this._transformState;i.writechunk===null||i.transforming?i.needTransform=!0:(i.transforming=!0,this._transform(i.writechunk,i.writeencoding,i.afterTransform))},a.prototype._destroy=function(o,i){n.prototype._destroy.call(this,o,function(u){i(u)})}},{"../errors":287,"./_stream_duplex":288,inherits:231}],292:[function(v,J,Z){(function(p,g){(function(){function b(D){var R=this;this.next=null,this.entry=null,this.finish=function(){(function(H,V,X){var $=H.entry;for(H.entry=null;$;){var G=$.callback;V.pendingcb--,G(X),$=$.next}V.corkedRequestsFree.next=H})(R,D)}}var y;J.exports=k,k.WritableState=w;var e={deprecate:v("util-deprecate")},n=v("./internal/streams/stream"),t=v("buffer").Buffer,a=g.Uint8Array||function(){},r,m=v("./internal/streams/destroy"),o=v("./internal/streams/state").getHighWaterMark,i=v("../errors").codes,u=i.ERR_INVALID_ARG_TYPE,f=i.ERR_METHOD_NOT_IMPLEMENTED,l=i.ERR_MULTIPLE_CALLBACK,h=i.ERR_STREAM_CANNOT_PIPE,d=i.ERR_STREAM_DESTROYED,s=i.ERR_STREAM_NULL_VALUES,x=i.ERR_STREAM_WRITE_AFTER_END,c=i.ERR_UNKNOWN_ENCODING,T=m.errorOrDestroy;function _(){}function w(D,R,H){y=y||v("./_stream_duplex"),D=D||{},typeof H!="boolean"&&(H=R instanceof y),this.objectMode=!!D.objectMode,H&&(this.objectMode=this.objectMode||!!D.writableObjectMode),this.highWaterMark=o(this,D,"writableHighWaterMark",H),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var V=D.decodeStrings===!1;this.decodeStrings=!V,this.defaultEncoding=D.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(X){(function($,G){var W=$._writableState,te=W.sync,N=W.writecb;if(typeof N!="function")throw new l;if(function(U){U.writing=!1,U.writecb=null,U.length-=U.writelen,U.writelen=0}(W),G)(function(U,ee,j,Q,K){--ee.pendingcb,j?(p.nextTick(K,Q),p.nextTick(E,U,ee),U._writableState.errorEmitted=!0,T(U,Q)):(K(Q),U._writableState.errorEmitted=!0,T(U,Q),E(U,ee))})($,W,te,G,N);else{var B=P(W)||$.destroyed;B||W.corked||W.bufferProcessing||!W.bufferedRequest||I($,W),te?p.nextTick(A,$,W,B,N):A($,W,B,N)}})(R,X)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=D.emitClose!==!1,this.autoDestroy=!!D.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new b(this)}function k(D){var R=this instanceof(y=y||v("./_stream_duplex"));if(!R&&!r.call(k,this))return new k(D);this._writableState=new w(D,this,R),this.writable=!0,D&&(typeof D.write=="function"&&(this._write=D.write),typeof D.writev=="function"&&(this._writev=D.writev),typeof D.destroy=="function"&&(this._destroy=D.destroy),typeof D.final=="function"&&(this._final=D.final)),n.call(this)}function L(D,R,H,V,X,$,G){R.writelen=V,R.writecb=G,R.writing=!0,R.sync=!0,R.destroyed?R.onwrite(new d("write")):H?D._writev(X,R.onwrite):D._write(X,$,R.onwrite),R.sync=!1}function A(D,R,H,V){H||function(X,$){$.length===0&&$.needDrain&&($.needDrain=!1,X.emit("drain"))}(D,R),R.pendingcb--,V(),E(D,R)}function I(D,R){R.bufferProcessing=!0;var H=R.bufferedRequest;if(D._writev&&H&&H.next){var V=R.bufferedRequestCount,X=new Array(V),$=R.corkedRequestsFree;$.entry=H;for(var G=0,W=!0;H;)X[G]=H,H.isBuf||(W=!1),H=H.next,G+=1;X.allBuffers=W,L(D,R,!0,R.length,X,"",$.finish),R.pendingcb++,R.lastBufferedRequest=null,$.next?(R.corkedRequestsFree=$.next,$.next=null):R.corkedRequestsFree=new b(R),R.bufferedRequestCount=0}else{for(;H;){var te=H.chunk,N=H.encoding,B=H.callback;if(L(D,R,!1,R.objectMode?1:te.length,te,N,B),H=H.next,R.bufferedRequestCount--,R.writing)break}H===null&&(R.lastBufferedRequest=null)}R.bufferedRequest=H,R.bufferProcessing=!1}function P(D){return D.ending&&D.length===0&&D.bufferedRequest===null&&!D.finished&&!D.writing}function S(D,R){D._final(function(H){R.pendingcb--,H&&T(D,H),R.prefinished=!0,D.emit("prefinish"),E(D,R)})}function E(D,R){var H=P(R);if(H&&(function(X,$){$.prefinished||$.finalCalled||(typeof X._final!="function"||$.destroyed?($.prefinished=!0,X.emit("prefinish")):($.pendingcb++,$.finalCalled=!0,p.nextTick(S,X,$)))}(D,R),R.pendingcb===0&&(R.finished=!0,D.emit("finish"),R.autoDestroy))){var V=D._readableState;(!V||V.autoDestroy&&V.endEmitted)&&D.destroy()}return H}v("inherits")(k,n),w.prototype.getBuffer=function(){for(var D=this.bufferedRequest,R=[];D;)R.push(D),D=D.next;return R},function(){try{Object.defineProperty(w.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(r=Function.prototype[Symbol.hasInstance],Object.defineProperty(k,Symbol.hasInstance,{value:function(D){return!!r.call(this,D)||this===k&&D&&D._writableState instanceof w}})):r=function(D){return D instanceof this},k.prototype.pipe=function(){T(this,new h)},k.prototype.write=function(D,R,H){var V,X=this._writableState,$=!1,G=!X.objectMode&&(V=D,t.isBuffer(V)||V instanceof a);return G&&!t.isBuffer(D)&&(D=function(W){return t.from(W)}(D)),typeof R=="function"&&(H=R,R=null),G?R="buffer":R||(R=X.defaultEncoding),typeof H!="function"&&(H=_),X.ending?function(W,te){var N=new x;T(W,N),p.nextTick(te,N)}(this,H):(G||function(W,te,N,B){var U;return N===null?U=new s:typeof N=="string"||te.objectMode||(U=new u("chunk",["string","Buffer"],N)),!U||(T(W,U),p.nextTick(B,U),!1)}(this,X,D,H))&&(X.pendingcb++,$=function(W,te,N,B,U,ee){if(!N){var j=function(ne,le,oe){return ne.objectMode||ne.decodeStrings===!1||typeof le!="string"||(le=t.from(le,oe)),le}(te,B,U);B!==j&&(N=!0,U="buffer",B=j)}var Q=te.objectMode?1:B.length;te.length+=Q;var K=te.length<te.highWaterMark;if(K||(te.needDrain=!0),te.writing||te.corked){var re=te.lastBufferedRequest;te.lastBufferedRequest={chunk:B,encoding:U,isBuf:N,callback:ee,next:null},re?re.next=te.lastBufferedRequest:te.bufferedRequest=te.lastBufferedRequest,te.bufferedRequestCount+=1}else L(W,te,!1,Q,B,U,ee);return K}(this,X,G,D,R,H)),$},k.prototype.cork=function(){this._writableState.corked++},k.prototype.uncork=function(){var D=this._writableState;D.corked&&(D.corked--,D.writing||D.corked||D.bufferProcessing||!D.bufferedRequest||I(this,D))},k.prototype.setDefaultEncoding=function(D){if(typeof D=="string"&&(D=D.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((D+"").toLowerCase())>-1))throw new c(D);return this._writableState.defaultEncoding=D,this},Object.defineProperty(k.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(k.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),k.prototype._write=function(D,R,H){H(new f("_write()"))},k.prototype._writev=null,k.prototype.end=function(D,R,H){var V=this._writableState;return typeof D=="function"?(H=D,D=null,R=null):typeof R=="function"&&(H=R,R=null),D!=null&&this.write(D,R),V.corked&&(V.corked=1,this.uncork()),V.ending||function(X,$,G){$.ending=!0,E(X,$),G&&($.finished?p.nextTick(G):X.once("finish",G)),$.ended=!0,X.writable=!1}(this,V,H),this},Object.defineProperty(k.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(D){this._writableState&&(this._writableState.destroyed=D)}}),k.prototype.destroy=m.destroy,k.prototype._undestroy=m.undestroy,k.prototype._destroy=function(D,R){R(D)}}).call(this)}).call(this,v("_process"),typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/destroy":295,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,inherits:231,"util-deprecate":331}],293:[function(v,J,Z){(function(p){(function(){var g;function b(d,s,x){return s in d?Object.defineProperty(d,s,{value:x,enumerable:!0,configurable:!0,writable:!0}):d[s]=x,d}var y=v("./end-of-stream"),e=Symbol("lastResolve"),n=Symbol("lastReject"),t=Symbol("error"),a=Symbol("ended"),r=Symbol("lastPromise"),m=Symbol("handlePromise"),o=Symbol("stream");function i(d,s){return{value:d,done:s}}function u(d){var s=d[e];if(s!==null){var x=d[o].read();x!==null&&(d[r]=null,d[e]=null,d[n]=null,s(i(x,!1)))}}function f(d){p.nextTick(u,d)}var l=Object.getPrototypeOf(function(){}),h=Object.setPrototypeOf((b(g={get stream(){return this[o]},next:function(){var d=this,s=this[t];if(s!==null)return Promise.reject(s);if(this[a])return Promise.resolve(i(void 0,!0));if(this[o].destroyed)return new Promise(function(_,w){p.nextTick(function(){d[t]?w(d[t]):_(i(void 0,!0))})});var x,c=this[r];if(c)x=new Promise(function(_,w){return function(k,L){_.then(function(){w[a]?k(i(void 0,!0)):w[m](k,L)},L)}}(c,this));else{var T=this[o].read();if(T!==null)return Promise.resolve(i(T,!1));x=new Promise(this[m])}return this[r]=x,x}},Symbol.asyncIterator,function(){return this}),b(g,"return",function(){var d=this;return new Promise(function(s,x){d[o].destroy(null,function(c){c?x(c):s(i(void 0,!0))})})}),g),l);J.exports=function(d){var s,x=Object.create(h,(b(s={},o,{value:d,writable:!0}),b(s,e,{value:null,writable:!0}),b(s,n,{value:null,writable:!0}),b(s,t,{value:null,writable:!0}),b(s,a,{value:d._readableState.endEmitted,writable:!0}),b(s,m,{value:function(c,T){var _=x[o].read();_?(x[r]=null,x[e]=null,x[n]=null,c(i(_,!1))):(x[e]=c,x[n]=T)},writable:!0}),s));return x[r]=null,y(d,function(c){if(c&&c.code!=="ERR_STREAM_PREMATURE_CLOSE"){var T=x[n];return T!==null&&(x[r]=null,x[e]=null,x[n]=null,T(c)),void(x[t]=c)}var _=x[e];_!==null&&(x[r]=null,x[e]=null,x[n]=null,_(i(void 0,!0))),x[a]=!0}),d.on("readable",f.bind(null,x)),x}}).call(this)}).call(this,v("_process"))},{"./end-of-stream":296,_process:278}],294:[function(v,J,Z){function p(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(t);a&&(m=m.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,m)}return r}function g(t,a,r){return a in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function b(t,a){for(var r=0;r<a.length;r++){var m=a[r];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(t,m.key,m)}}var y=v("buffer").Buffer,e=v("util").inspect,n=e&&e.custom||"inspect";J.exports=function(){function t(){(function(m,o){if(!(m instanceof o))throw new TypeError("Cannot call a class as a function")})(this,t),this.head=null,this.tail=null,this.length=0}var a,r;return a=t,(r=[{key:"push",value:function(m){var o={data:m,next:null};this.length>0?this.tail.next=o:this.head=o,this.tail=o,++this.length}},{key:"unshift",value:function(m){var o={data:m,next:this.head};this.length===0&&(this.tail=o),this.head=o,++this.length}},{key:"shift",value:function(){if(this.length!==0){var m=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,m}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(m){if(this.length===0)return"";for(var o=this.head,i=""+o.data;o=o.next;)i+=m+o.data;return i}},{key:"concat",value:function(m){if(this.length===0)return y.alloc(0);for(var o,i,u,f=y.allocUnsafe(m>>>0),l=this.head,h=0;l;)o=l.data,i=f,u=h,y.prototype.copy.call(o,i,u),h+=l.data.length,l=l.next;return f}},{key:"consume",value:function(m,o){var i;return m<this.head.data.length?(i=this.head.data.slice(0,m),this.head.data=this.head.data.slice(m)):i=m===this.head.data.length?this.shift():o?this._getString(m):this._getBuffer(m),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(m){var o=this.head,i=1,u=o.data;for(m-=u.length;o=o.next;){var f=o.data,l=m>f.length?f.length:m;if(l===f.length?u+=f:u+=f.slice(0,m),(m-=l)==0){l===f.length?(++i,o.next?this.head=o.next:this.head=this.tail=null):(this.head=o,o.data=f.slice(l));break}++i}return this.length-=i,u}},{key:"_getBuffer",value:function(m){var o=y.allocUnsafe(m),i=this.head,u=1;for(i.data.copy(o),m-=i.data.length;i=i.next;){var f=i.data,l=m>f.length?f.length:m;if(f.copy(o,o.length-m,0,l),(m-=l)==0){l===f.length?(++u,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=f.slice(l));break}++u}return this.length-=u,o}},{key:n,value:function(m,o){return e(this,function(i){for(var u=1;u<arguments.length;u++){var f=arguments[u]!=null?arguments[u]:{};u%2?p(Object(f),!0).forEach(function(l){g(i,l,f[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(f)):p(Object(f)).forEach(function(l){Object.defineProperty(i,l,Object.getOwnPropertyDescriptor(f,l))})}return i}({},o,{depth:0,customInspect:!1}))}}])&&b(a.prototype,r),t}()},{buffer:85,util:83}],295:[function(v,J,Z){(function(p){(function(){function g(e,n){y(e,n),b(e)}function b(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function y(e,n){e.emit("error",n)}J.exports={destroy:function(e,n){var t=this,a=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return a||r?(n?n(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,p.nextTick(y,this,e)):p.nextTick(y,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(m){!n&&m?t._writableState?t._writableState.errorEmitted?p.nextTick(b,t):(t._writableState.errorEmitted=!0,p.nextTick(g,t,m)):p.nextTick(g,t,m):n?(p.nextTick(b,t),n(m)):p.nextTick(b,t)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,n){var t=e._readableState,a=e._writableState;t&&t.autoDestroy||a&&a.autoDestroy?e.destroy(n):e.emit("error",n)}}}).call(this)}).call(this,v("_process"))},{_process:278}],296:[function(v,J,Z){var p=v("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function g(){}J.exports=function b(y,e,n){if(typeof e=="function")return b(y,null,e);e||(e={}),n=function(d){var s=!1;return function(){if(!s){s=!0;for(var x=arguments.length,c=new Array(x),T=0;T<x;T++)c[T]=arguments[T];d.apply(this,c)}}}(n||g);var t=e.readable||e.readable!==!1&&y.readable,a=e.writable||e.writable!==!1&&y.writable,r=function(){y.writable||o()},m=y._writableState&&y._writableState.finished,o=function(){a=!1,m=!0,t||n.call(y)},i=y._readableState&&y._readableState.endEmitted,u=function(){t=!1,i=!0,a||n.call(y)},f=function(d){n.call(y,d)},l=function(){var d;return t&&!i?(y._readableState&&y._readableState.ended||(d=new p),n.call(y,d)):a&&!m?(y._writableState&&y._writableState.ended||(d=new p),n.call(y,d)):void 0},h=function(){y.req.on("finish",o)};return function(d){return d.setHeader&&typeof d.abort=="function"}(y)?(y.on("complete",o),y.on("abort",l),y.req?h():y.on("request",h)):a&&!y._writableState&&(y.on("end",r),y.on("close",r)),y.on("end",u),y.on("finish",o),e.error!==!1&&y.on("error",f),y.on("close",l),function(){y.removeListener("complete",o),y.removeListener("abort",l),y.removeListener("request",h),y.req&&y.req.removeListener("finish",o),y.removeListener("end",r),y.removeListener("close",r),y.removeListener("finish",o),y.removeListener("end",u),y.removeListener("error",f),y.removeListener("close",l)}}},{"../../../errors":287}],297:[function(v,J,Z){J.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],298:[function(v,J,Z){var p,g=v("../../../errors").codes,b=g.ERR_MISSING_ARGS,y=g.ERR_STREAM_DESTROYED;function e(m){if(m)throw m}function n(m,o,i,u){u=function(h){var d=!1;return function(){d||(d=!0,h.apply(void 0,arguments))}}(u);var f=!1;m.on("close",function(){f=!0}),p===void 0&&(p=v("./end-of-stream")),p(m,{readable:o,writable:i},function(h){if(h)return u(h);f=!0,u()});var l=!1;return function(h){if(!f&&!l)return l=!0,function(d){return d.setHeader&&typeof d.abort=="function"}(m)?m.abort():typeof m.destroy=="function"?m.destroy():void u(h||new y("pipe"))}}function t(m){m()}function a(m,o){return m.pipe(o)}function r(m){return m.length?typeof m[m.length-1]!="function"?e:m.pop():e}J.exports=function(){for(var m=arguments.length,o=new Array(m),i=0;i<m;i++)o[i]=arguments[i];var u,f=r(o);if(Array.isArray(o[0])&&(o=o[0]),o.length<2)throw new b("streams");var l=o.map(function(h,d){var s=d<o.length-1;return n(h,s,d>0,function(x){u||(u=x),x&&l.forEach(t),s||(l.forEach(t),f(u))})});return o.reduce(a)}},{"../../../errors":287,"./end-of-stream":296}],299:[function(v,J,Z){var p=v("../../../errors").codes.ERR_INVALID_OPT_VALUE;J.exports={getHighWaterMark:function(g,b,y,e){var n=function(t,a,r){return t.highWaterMark!=null?t.highWaterMark:a?t[r]:null}(b,e,y);if(n!=null){if(!isFinite(n)||Math.floor(n)!==n||n<0)throw new p(e?y:"highWaterMark",n);return Math.floor(n)}return g.objectMode?16:16384}}},{"../../../errors":287}],300:[function(v,J,Z){J.exports=v("events").EventEmitter},{events:84}],301:[function(v,J,Z){var p=v("safe-buffer").Buffer,g=p.isEncoding||function(i){switch((i=""+i)&&i.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function b(i){var u;switch(this.encoding=function(f){var l=function(h){if(!h)return"utf8";for(var d;;)switch(h){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return h;default:if(d)return;h=(""+h).toLowerCase(),d=!0}}(f);if(typeof l!="string"&&(p.isEncoding===g||!g(f)))throw new Error("Unknown encoding: "+f);return l||f}(i),this.encoding){case"utf16le":this.text=n,this.end=t,u=4;break;case"utf8":this.fillLast=e,u=4;break;case"base64":this.text=a,this.end=r,u=3;break;default:return this.write=m,void(this.end=o)}this.lastNeed=0,this.lastTotal=0,this.lastChar=p.allocUnsafe(u)}function y(i){return i<=127?0:i>>5==6?2:i>>4==14?3:i>>3==30?4:i>>6==2?-1:-2}function e(i){var u=this.lastTotal-this.lastNeed,f=function(l,h,d){if((192&h[0])!=128)return l.lastNeed=0,"\uFFFD";if(l.lastNeed>1&&h.length>1){if((192&h[1])!=128)return l.lastNeed=1,"\uFFFD";if(l.lastNeed>2&&h.length>2&&(192&h[2])!=128)return l.lastNeed=2,"\uFFFD"}}(this,i);return f!==void 0?f:this.lastNeed<=i.length?(i.copy(this.lastChar,u,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(i.copy(this.lastChar,u,0,i.length),void(this.lastNeed-=i.length))}function n(i,u){if((i.length-u)%2==0){var f=i.toString("utf16le",u);if(f){var l=f.charCodeAt(f.length-1);if(l>=55296&&l<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=i[i.length-2],this.lastChar[1]=i[i.length-1],f.slice(0,-1)}return f}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=i[i.length-1],i.toString("utf16le",u,i.length-1)}function t(i){var u=i&&i.length?this.write(i):"";if(this.lastNeed){var f=this.lastTotal-this.lastNeed;return u+this.lastChar.toString("utf16le",0,f)}return u}function a(i,u){var f=(i.length-u)%3;return f===0?i.toString("base64",u):(this.lastNeed=3-f,this.lastTotal=3,f===1?this.lastChar[0]=i[i.length-1]:(this.lastChar[0]=i[i.length-2],this.lastChar[1]=i[i.length-1]),i.toString("base64",u,i.length-f))}function r(i){var u=i&&i.length?this.write(i):"";return this.lastNeed?u+this.lastChar.toString("base64",0,3-this.lastNeed):u}function m(i){return i.toString(this.encoding)}function o(i){return i&&i.length?this.write(i):""}Z.StringDecoder=b,b.prototype.write=function(i){if(i.length===0)return"";var u,f;if(this.lastNeed){if((u=this.fillLast(i))===void 0)return"";f=this.lastNeed,this.lastNeed=0}else f=0;return f<i.length?u?u+this.text(i,f):this.text(i,f):u||""},b.prototype.end=function(i){var u=i&&i.length?this.write(i):"";return this.lastNeed?u+"\uFFFD":u},b.prototype.text=function(i,u){var f=function(h,d,s){var x=d.length-1;if(x<s)return 0;var c=y(d[x]);return c>=0?(c>0&&(h.lastNeed=c-1),c):--x<s||c===-2?0:(c=y(d[x]))>=0?(c>0&&(h.lastNeed=c-2),c):--x<s||c===-2?0:(c=y(d[x]))>=0?(c>0&&(c===2?c=0:h.lastNeed=c-3),c):0}(this,i,u);if(!this.lastNeed)return i.toString("utf8",u);this.lastTotal=f;var l=i.length-(f-this.lastNeed);return i.copy(this.lastChar,0,l),i.toString("utf8",u,l)},b.prototype.fillLast=function(i){if(this.lastNeed<=i.length)return i.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);i.copy(this.lastChar,this.lastTotal-this.lastNeed,0,i.length),this.lastNeed-=i.length}},{"safe-buffer":285}],302:[function(v,J,Z){(function(p,g){(function(){var b=v("assert"),y=v("debug")("stream-parser");J.exports=function(f){var l=f&&typeof f._transform=="function",h=f&&typeof f._write=="function";if(!l&&!h)throw new Error("must pass a Writable or Transform stream in");y("extending Parser into stream"),f._bytes=n,f._skipBytes=t,l&&(f._passthrough=a),l?f._transform=m:f._write=r};function e(f){y("initializing parser stream"),f._parserBytesLeft=0,f._parserBuffers=[],f._parserBuffered=0,f._parserState=-1,f._parserCallback=null,typeof f.push=="function"&&(f._parserOutput=f.push.bind(f)),f._parserInit=!0}function n(f,l){b(!this._parserCallback,'there is already a "callback" set!'),b(isFinite(f)&&f>0,'can only buffer a finite number of bytes > 0, got "'+f+'"'),this._parserInit||e(this),y("buffering %o bytes",f),this._parserBytesLeft=f,this._parserCallback=l,this._parserState=0}function t(f,l){b(!this._parserCallback,'there is already a "callback" set!'),b(f>0,'can only skip > 0 bytes, got "'+f+'"'),this._parserInit||e(this),y("skipping %o bytes",f),this._parserBytesLeft=f,this._parserCallback=l,this._parserState=1}function a(f,l){b(!this._parserCallback,'There is already a "callback" set!'),b(f>0,'can only pass through > 0 bytes, got "'+f+'"'),this._parserInit||e(this),y("passing through %o bytes",f),this._parserBytesLeft=f,this._parserCallback=l,this._parserState=2}function r(f,l,h){this._parserInit||e(this),y("write(%o bytes)",f.length),typeof l=="function"&&(h=l),i(this,f,null,h)}function m(f,l,h){this._parserInit||e(this),y("transform(%o bytes)",f.length),typeof l!="function"&&(l=this._parserOutput),i(this,f,l,h)}function o(f,l,h,d){if(f._parserBytesLeft-=l.length,y("%o bytes left for stream piece",f._parserBytesLeft),f._parserState===0?(f._parserBuffers.push(l),f._parserBuffered+=l.length):f._parserState===2&&h(l),f._parserBytesLeft!==0)return d;var s=f._parserCallback;if(s&&f._parserState===0&&f._parserBuffers.length>1&&(l=g.concat(f._parserBuffers,f._parserBuffered)),f._parserState!==0&&(l=null),f._parserCallback=null,f._parserBuffered=0,f._parserState=-1,f._parserBuffers.splice(0),s){var x=[];l&&x.push(l),h&&x.push(h);var c=s.length>x.length;c&&x.push(u(d));var T=s.apply(f,x);if(!c||d===T)return d}}var i=u(function f(l,h,d,s){return l._parserBytesLeft<=0?s(new Error("got data but not currently parsing anything")):h.length<=l._parserBytesLeft?function(){return o(l,h,d,s)}:function(){var x=h.slice(0,l._parserBytesLeft);return o(l,x,d,function(c){return c?s(c):h.length>x.length?function(){return f(l,h.slice(x.length),d,s)}:void 0})}});function u(f){return function(){for(var l=f.apply(this,arguments);typeof l=="function";)l=l();return l}}}).call(this)}).call(this,v("_process"),v("buffer").Buffer)},{_process:278,assert:75,buffer:85,debug:303}],303:[function(v,J,Z){(function(p){(function(){function g(){var b;try{b=Z.storage.debug}catch{}return!b&&p!==void 0&&"env"in p&&(b=p.env.DEBUG),b}(Z=J.exports=v("./debug")).log=function(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},Z.formatArgs=function(b){var y=this.useColors;if(b[0]=(y?"%c":"")+this.namespace+(y?" %c":" ")+b[0]+(y?"%c ":" ")+"+"+Z.humanize(this.diff),!!y){var e="color: "+this.color;b.splice(1,0,e,"color: inherit");var n=0,t=0;b[0].replace(/%[a-zA-Z%]/g,function(a){a!=="%%"&&(n++,a==="%c"&&(t=n))}),b.splice(t,0,e)}},Z.save=function(b){try{b==null?Z.storage.removeItem("debug"):Z.storage.debug=b}catch{}},Z.load=g,Z.useColors=function(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},Z.storage=typeof chrome<"u"&&chrome.storage!==void 0?chrome.storage.local:function(){try{return window.localStorage}catch{}}(),Z.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],Z.formatters.j=function(b){try{return JSON.stringify(b)}catch(y){return"[UnexpectedJSONParseError]: "+y.message}},Z.enable(g())}).call(this)}).call(this,v("_process"))},{"./debug":304,_process:278}],304:[function(v,J,Z){var p;function g(b){function y(){if(y.enabled){var e=y,n=+new Date,t=n-(p||n);e.diff=t,e.prev=p,e.curr=n,p=n;for(var a=new Array(arguments.length),r=0;r<a.length;r++)a[r]=arguments[r];a[0]=Z.coerce(a[0]),typeof a[0]!="string"&&a.unshift("%O");var m=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(i,u){if(i==="%%")return i;m++;var f=Z.formatters[u];if(typeof f=="function"){var l=a[m];i=f.call(e,l),a.splice(m,1),m--}return i}),Z.formatArgs.call(e,a);var o=y.log||Z.log||console.log.bind(console);o.apply(e,a)}}return y.namespace=b,y.enabled=Z.enabled(b),y.useColors=Z.useColors(),y.color=function(e){var n,t=0;for(n in e)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Z.colors[Math.abs(t)%Z.colors.length]}(b),typeof Z.init=="function"&&Z.init(y),y}(Z=J.exports=g.debug=g.default=g).coerce=function(b){return b instanceof Error?b.stack||b.message:b},Z.disable=function(){Z.enable("")},Z.enable=function(b){Z.save(b),Z.names=[],Z.skips=[];for(var y=(typeof b=="string"?b:"").split(/[\s,]+/),e=y.length,n=0;n<e;n++)y[n]&&((b=y[n].replace(/\*/g,".*?"))[0]==="-"?Z.skips.push(new RegExp("^"+b.substr(1)+"$")):Z.names.push(new RegExp("^"+b+"$")))},Z.enabled=function(b){var y,e;for(y=0,e=Z.skips.length;y<e;y++)if(Z.skips[y].test(b))return!1;for(y=0,e=Z.names.length;y<e;y++)if(Z.names[y].test(b))return!0;return!1},Z.humanize=v("ms"),Z.names=[],Z.skips=[],Z.formatters={}},{ms:305}],305:[function(v,J,Z){var p=1e3,g=6e4,b=60*g,y=24*b;function e(n,t,a){if(!(n<t))return n<1.5*t?Math.floor(n/t)+" "+a:Math.ceil(n/t)+" "+a+"s"}J.exports=function(n,t){t=t||{};var a,r=typeof n;if(r==="string"&&n.length>0)return function(m){if(!((m=String(m)).length>100)){var o=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(m);if(!!o){var i=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"days":case"day":case"d":return i*y;case"hours":case"hour":case"hrs":case"hr":case"h":return i*b;case"minutes":case"minute":case"mins":case"min":case"m":return i*g;case"seconds":case"second":case"secs":case"sec":case"s":return i*p;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(n);if(r==="number"&&isNaN(n)===!1)return t.long?e(a=n,y,"day")||e(a,b,"hour")||e(a,g,"minute")||e(a,p,"second")||a+" ms":function(m){return m>=y?Math.round(m/y)+"d":m>=b?Math.round(m/b)+"h":m>=g?Math.round(m/g)+"m":m>=p?Math.round(m/p)+"s":m+"ms"}(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))}},{}],306:[function(v,J,Z){var p=v("parenthesis");J.exports=function(g,b,y){if(g==null)throw Error("First argument should be a string");if(b==null)throw Error("Separator should be a string or a RegExp");y?(typeof y=="string"||Array.isArray(y))&&(y={ignore:y}):y={},y.escape==null&&(y.escape=!0),y.ignore==null?y.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof y.ignore=="string"&&(y.ignore=[y.ignore]),y.ignore=y.ignore.map(function(o){return o.length===1&&(o+=o),o}));var e=p.parse(g,{flat:!0,brackets:y.ignore}),n=e[0].split(b);if(y.escape){for(var t=[],a=0;a<n.length;a++){var r=n[a],m=n[a+1];r[r.length-1]==="\\"&&r[r.length-2]!=="\\"?(t.push(r+b+m),a++):t.push(r)}n=t}for(a=0;a<n.length;a++)e[0]=n[a],n[a]=p.stringify(e,{flat:!0});return n}},{parenthesis:248}],307:[function(v,J,Z){J.exports=function(p){for(var g=p.length,b=new Array(g),y=new Array(g),e=new Array(g),n=new Array(g),t=new Array(g),a=new Array(g),r=0;r<g;++r)b[r]=-1,y[r]=0,e[r]=!1,n[r]=0,t[r]=-1,a[r]=[];var m,o=0,i=[],u=[];function f(d){var s=[d],x=[d];for(b[d]=y[d]=o,e[d]=!0,o+=1;x.length>0;){d=x[x.length-1];var c=p[d];if(n[d]<c.length){for(var T=n[d];T<c.length;++T){var _=c[T];if(b[_]<0){b[_]=y[_]=o,e[_]=!0,o+=1,s.push(_),x.push(_);break}e[_]&&(y[d]=0|Math.min(y[d],y[_])),t[_]>=0&&a[d].push(t[_])}n[d]=T}else{if(y[d]===b[d]){var w=[],k=[],L=0;for(T=s.length-1;T>=0;--T){var A=s[T];if(e[A]=!1,w.push(A),k.push(a[A]),L+=a[A].length,t[A]=i.length,A===d){s.length=T;break}}i.push(w);var I=new Array(L);for(T=0;T<k.length;T++)for(var P=0;P<k[T].length;P++)I[--L]=k[T][P];u.push(I)}x.pop()}}}for(r=0;r<g;++r)b[r]<0&&f(r);for(r=0;r<u.length;r++){var l=u[r];if(l.length!==0){l.sort(function(d,s){return d-s}),m=[l[0]];for(var h=1;h<l.length;h++)l[h]!==l[h-1]&&m.push(l[h]);u[r]=m}}return{components:i,adjacencyList:u}}},{}],308:[function(v,J,Z){Object.defineProperty(Z,"__esModule",{value:!0});var p=function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return function(a,r){var m=[],o=!0,i=!1,u=void 0;try{for(var f,l=a[Symbol.iterator]();!(o=(f=l.next()).done)&&(m.push(f.value),!r||m.length!==r);o=!0);}catch(h){i=!0,u=h}finally{try{!o&&l.return&&l.return()}finally{if(i)throw u}}return m}(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},g=2*Math.PI,b=function(n,t,a,r,m,o,i){var u=n.x,f=n.y;return{x:r*(u*=t)-m*(f*=a)+o,y:m*u+r*f+i}},y=function(n,t){var a=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=Math.cos(n),m=Math.sin(n),o=Math.cos(n+t),i=Math.sin(n+t);return[{x:r-m*a,y:m+r*a},{x:o+i*a,y:i-o*a},{x:o,y:i}]},e=function(n,t,a,r){var m=n*a+t*r;return m>1&&(m=1),m<-1&&(m=-1),(n*r-t*a<0?-1:1)*Math.acos(m)};Z.default=function(n){var t=n.px,a=n.py,r=n.cx,m=n.cy,o=n.rx,i=n.ry,u=n.xAxisRotation,f=u===void 0?0:u,l=n.largeArcFlag,h=l===void 0?0:l,d=n.sweepFlag,s=d===void 0?0:d,x=[];if(o===0||i===0)return[];var c=Math.sin(f*g/360),T=Math.cos(f*g/360),_=T*(t-r)/2+c*(a-m)/2,w=-c*(t-r)/2+T*(a-m)/2;if(_===0&&w===0)return[];o=Math.abs(o),i=Math.abs(i);var k=Math.pow(_,2)/Math.pow(o,2)+Math.pow(w,2)/Math.pow(i,2);k>1&&(o*=Math.sqrt(k),i*=Math.sqrt(k));var L=function(V,X,$,G,W,te,N,B,U,ee,j,Q){var K=Math.pow(W,2),re=Math.pow(te,2),ne=Math.pow(j,2),le=Math.pow(Q,2),oe=K*re-K*le-re*ne;oe<0&&(oe=0),oe/=K*le+re*ne;var de=(oe=Math.sqrt(oe)*(N===B?-1:1))*W/te*Q,se=oe*-te/W*j,me=ee*de-U*se+(V+$)/2,Te=U*de+ee*se+(X+G)/2,_e=(j-de)/W,be=(Q-se)/te,Ce=(-j-de)/W,fe=(-Q-se)/te,ve=e(1,0,_e,be),Me=e(_e,be,Ce,fe);return B===0&&Me>0&&(Me-=g),B===1&&Me<0&&(Me+=g),[me,Te,ve,Me]}(t,a,r,m,o,i,h,s,c,T,_,w),A=p(L,4),I=A[0],P=A[1],S=A[2],E=A[3],D=Math.abs(E)/(g/4);Math.abs(1-D)<1e-7&&(D=1);var R=Math.max(Math.ceil(D),1);E/=R;for(var H=0;H<R;H++)x.push(y(S,E)),S+=E;return x.map(function(V){var X=b(V[0],o,i,T,c,I,P),$=X.x,G=X.y,W=b(V[1],o,i,T,c,I,P),te=W.x,N=W.y,B=b(V[2],o,i,T,c,I,P);return{x1:$,y1:G,x2:te,y2:N,x:B.x,y:B.y}})},J.exports=Z.default},{}],309:[function(v,J,Z){var p=v("parse-svg-path"),g=v("abs-svg-path"),b=v("normalize-svg-path"),y=v("is-svg-path"),e=v("assert");J.exports=function(n){if(Array.isArray(n)&&n.length===1&&typeof n[0]=="string"&&(n=n[0]),typeof n=="string"&&(e(y(n),"String is not an SVG path."),n=p(n)),e(Array.isArray(n),"Argument should be a string or an array of path segments."),n=g(n),!(n=b(n)).length)return[0,0,0,0];for(var t=[1/0,1/0,-1/0,-1/0],a=0,r=n.length;a<r;a++)for(var m=n[a].slice(1),o=0;o<m.length;o+=2)m[o+0]<t[0]&&(t[0]=m[o+0]),m[o+1]<t[1]&&(t[1]=m[o+1]),m[o+0]>t[2]&&(t[2]=m[o+0]),m[o+1]>t[3]&&(t[3]=m[o+1]);return t}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":310,"parse-svg-path":250}],310:[function(v,J,Z){J.exports=function(y){for(var e,n=[],t=0,a=0,r=0,m=0,o=null,i=null,u=0,f=0,l=0,h=y.length;l<h;l++){var d=y[l],s=d[0];switch(s){case"M":r=d[1],m=d[2];break;case"A":var x=p({px:u,py:f,cx:d[6],cy:d[7],rx:d[1],ry:d[2],xAxisRotation:d[3],largeArcFlag:d[4],sweepFlag:d[5]});if(!x.length)continue;for(var c,T=0;T<x.length;T++)c=x[T],d=["C",c.x1,c.y1,c.x2,c.y2,c.x,c.y],T<x.length-1&&n.push(d);break;case"S":var _=u,w=f;e!="C"&&e!="S"||(_+=_-t,w+=w-a),d=["C",_,w,d[1],d[2],d[3],d[4]];break;case"T":e=="Q"||e=="T"?(o=2*u-o,i=2*f-i):(o=u,i=f),d=b(u,f,o,i,d[1],d[2]);break;case"Q":o=d[1],i=d[2],d=b(u,f,d[1],d[2],d[3],d[4]);break;case"L":d=g(u,f,d[1],d[2]);break;case"H":d=g(u,f,d[1],f);break;case"V":d=g(u,f,u,d[1]);break;case"Z":d=g(u,f,r,m)}e=s,u=d[d.length-2],f=d[d.length-1],d.length>4?(t=d[d.length-4],a=d[d.length-3]):(t=u,a=f),n.push(d)}return n};var p=v("svg-arc-to-cubic-bezier");function g(y,e,n,t){return["C",y,e,n,t,n,t]}function b(y,e,n,t,a,r){return["C",y/3+2/3*n,e/3+2/3*t,a/3+2/3*n,r/3+2/3*t,a,r]}},{"svg-arc-to-cubic-bezier":308}],311:[function(v,J,Z){var p,g=v("svg-path-bounds"),b=v("parse-svg-path"),y=v("draw-svg-path"),e=v("is-svg-path"),n=v("bitmap-sdf"),t=document.createElement("canvas"),a=t.getContext("2d");J.exports=function(r,m){if(!e(r))throw Error("Argument should be valid svg path string");m||(m={});var o,i;m.shape?(o=m.shape[0],i=m.shape[1]):(o=t.width=m.w||m.width||200,i=t.height=m.h||m.height||200);var u=Math.min(o,i),f=m.stroke||0,l=m.viewbox||m.viewBox||g(r),h=[o/(l[2]-l[0]),i/(l[3]-l[1])],d=Math.min(h[0]||0,h[1]||0)/2;if(a.fillStyle="black",a.fillRect(0,0,o,i),a.fillStyle="white",f&&(typeof f!="number"&&(f=1),a.strokeStyle=f>0?"white":"black",a.lineWidth=Math.abs(f)),a.translate(.5*o,.5*i),a.scale(d,d),function(){if(p!=null)return p;var c=document.createElement("canvas").getContext("2d");if(c.canvas.width=c.canvas.height=1,!window.Path2D)return p=!1;var T=new Path2D("M0,0h1v1h-1v-1Z");c.fillStyle="black",c.fill(T);var _=c.getImageData(0,0,1,1);return p=_&&_.data&&_.data[3]===255}()){var s=new Path2D(r);a.fill(s),f&&a.stroke(s)}else{var x=b(r);y(a,x),a.fill(),f&&a.stroke()}return a.setTransform(1,0,0,1,0,0),n(a,{cutoff:m.cutoff!=null?m.cutoff:.5,radius:m.radius!=null?m.radius:.5*u})}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":309}],312:[function(v,J,Z){(function(p,g){(function(){var b=v("process/browser.js").nextTick,y=Function.prototype.apply,e=Array.prototype.slice,n={},t=0;function a(r,m){this._id=r,this._clearFn=m}Z.setTimeout=function(){return new a(y.call(setTimeout,window,arguments),clearTimeout)},Z.setInterval=function(){return new a(y.call(setInterval,window,arguments),clearInterval)},Z.clearTimeout=Z.clearInterval=function(r){r.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},Z.enroll=function(r,m){clearTimeout(r._idleTimeoutId),r._idleTimeout=m},Z.unenroll=function(r){clearTimeout(r._idleTimeoutId),r._idleTimeout=-1},Z._unrefActive=Z.active=function(r){clearTimeout(r._idleTimeoutId);var m=r._idleTimeout;m>=0&&(r._idleTimeoutId=setTimeout(function(){r._onTimeout&&r._onTimeout()},m))},Z.setImmediate=typeof p=="function"?p:function(r){var m=t++,o=!(arguments.length<2)&&e.call(arguments,1);return n[m]=!0,b(function(){n[m]&&(o?r.apply(null,o):r.call(null),Z.clearImmediate(m))}),m},Z.clearImmediate=typeof g=="function"?g:function(r){delete n[r]}}).call(this)}).call(this,v("timers").setImmediate,v("timers").clearImmediate)},{"process/browser.js":278,timers:312}],313:[function(v,J,Z){(function(p){var g=/^\s+/,b=/\s+$/,y=0,e=p.round,n=p.min,t=p.max,a=p.random;function r(U,ee){if(ee=ee||{},(U=U||"")instanceof r)return U;if(!(this instanceof r))return new r(U,ee);var j=function(Q){var K={r:0,g:0,b:0},re=1,ne=null,le=null,oe=null,de=!1,se=!1;typeof Q=="string"&&(Q=function(be){be=be.replace(g,"").replace(b,"").toLowerCase();var Ce,fe=!1;if(I[be])be=I[be],fe=!0;else if(be=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(Ce=N.rgb.exec(be))?{r:Ce[1],g:Ce[2],b:Ce[3]}:(Ce=N.rgba.exec(be))?{r:Ce[1],g:Ce[2],b:Ce[3],a:Ce[4]}:(Ce=N.hsl.exec(be))?{h:Ce[1],s:Ce[2],l:Ce[3]}:(Ce=N.hsla.exec(be))?{h:Ce[1],s:Ce[2],l:Ce[3],a:Ce[4]}:(Ce=N.hsv.exec(be))?{h:Ce[1],s:Ce[2],v:Ce[3]}:(Ce=N.hsva.exec(be))?{h:Ce[1],s:Ce[2],v:Ce[3],a:Ce[4]}:(Ce=N.hex8.exec(be))?{r:R(Ce[1]),g:R(Ce[2]),b:R(Ce[3]),a:$(Ce[4]),format:fe?"name":"hex8"}:(Ce=N.hex6.exec(be))?{r:R(Ce[1]),g:R(Ce[2]),b:R(Ce[3]),format:fe?"name":"hex"}:(Ce=N.hex4.exec(be))?{r:R(Ce[1]+""+Ce[1]),g:R(Ce[2]+""+Ce[2]),b:R(Ce[3]+""+Ce[3]),a:$(Ce[4]+""+Ce[4]),format:fe?"name":"hex8"}:(Ce=N.hex3.exec(be))?{r:R(Ce[1]+""+Ce[1]),g:R(Ce[2]+""+Ce[2]),b:R(Ce[3]+""+Ce[3]),format:fe?"name":"hex"}:!1}(Q)),typeof Q=="object"&&(B(Q.r)&&B(Q.g)&&B(Q.b)?(me=Q.r,Te=Q.g,_e=Q.b,K={r:255*E(me,255),g:255*E(Te,255),b:255*E(_e,255)},de=!0,se=String(Q.r).substr(-1)==="%"?"prgb":"rgb"):B(Q.h)&&B(Q.s)&&B(Q.v)?(ne=V(Q.s),le=V(Q.v),K=function(be,Ce,fe){be=6*E(be,360),Ce=E(Ce,100),fe=E(fe,100);var ve=p.floor(be),Me=be-ve,ke=fe*(1-Ce),Le=fe*(1-Me*Ce),ze=fe*(1-(1-Me)*Ce),Re=ve%6;return{r:255*[fe,Le,ke,ke,ze,fe][Re],g:255*[ze,fe,fe,Le,ke,ke][Re],b:255*[ke,ke,ze,fe,fe,Le][Re]}}(Q.h,ne,le),de=!0,se="hsv"):B(Q.h)&&B(Q.s)&&B(Q.l)&&(ne=V(Q.s),oe=V(Q.l),K=function(be,Ce,fe){var ve,Me,ke;function Le(Oe,Ze,Pe){return Pe<0&&(Pe+=1),Pe>1&&(Pe-=1),Pe<1/6?Oe+6*(Ze-Oe)*Pe:Pe<.5?Ze:Pe<2/3?Oe+(Ze-Oe)*(2/3-Pe)*6:Oe}if(be=E(be,360),Ce=E(Ce,100),fe=E(fe,100),Ce===0)ve=Me=ke=fe;else{var ze=fe<.5?fe*(1+Ce):fe+Ce-fe*Ce,Re=2*fe-ze;ve=Le(Re,ze,be+1/3),Me=Le(Re,ze,be),ke=Le(Re,ze,be-1/3)}return{r:255*ve,g:255*Me,b:255*ke}}(Q.h,ne,oe),de=!0,se="hsl"),Q.hasOwnProperty("a")&&(re=Q.a));var me,Te,_e;return re=S(re),{ok:de,format:Q.format||se,r:n(255,t(K.r,0)),g:n(255,t(K.g,0)),b:n(255,t(K.b,0)),a:re}}(U);this._originalInput=U,this._r=j.r,this._g=j.g,this._b=j.b,this._a=j.a,this._roundA=e(100*this._a)/100,this._format=ee.format||j.format,this._gradientType=ee.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=j.ok,this._tc_id=y++}function m(U,ee,j){U=E(U,255),ee=E(ee,255),j=E(j,255);var Q,K,re=t(U,ee,j),ne=n(U,ee,j),le=(re+ne)/2;if(re==ne)Q=K=0;else{var oe=re-ne;switch(K=le>.5?oe/(2-re-ne):oe/(re+ne),re){case U:Q=(ee-j)/oe+(ee<j?6:0);break;case ee:Q=(j-U)/oe+2;break;case j:Q=(U-ee)/oe+4}Q/=6}return{h:Q,s:K,l:le}}function o(U,ee,j){U=E(U,255),ee=E(ee,255),j=E(j,255);var Q,K,re=t(U,ee,j),ne=n(U,ee,j),le=re,oe=re-ne;if(K=re===0?0:oe/re,re==ne)Q=0;else{switch(re){case U:Q=(ee-j)/oe+(ee<j?6:0);break;case ee:Q=(j-U)/oe+2;break;case j:Q=(U-ee)/oe+4}Q/=6}return{h:Q,s:K,v:le}}function i(U,ee,j,Q){var K=[H(e(U).toString(16)),H(e(ee).toString(16)),H(e(j).toString(16))];return Q&&K[0].charAt(0)==K[0].charAt(1)&&K[1].charAt(0)==K[1].charAt(1)&&K[2].charAt(0)==K[2].charAt(1)?K[0].charAt(0)+K[1].charAt(0)+K[2].charAt(0):K.join("")}function u(U,ee,j,Q){return[H(X(Q)),H(e(U).toString(16)),H(e(ee).toString(16)),H(e(j).toString(16))].join("")}function f(U,ee){ee=ee===0?0:ee||10;var j=r(U).toHsl();return j.s-=ee/100,j.s=D(j.s),r(j)}function l(U,ee){ee=ee===0?0:ee||10;var j=r(U).toHsl();return j.s+=ee/100,j.s=D(j.s),r(j)}function h(U){return r(U).desaturate(100)}function d(U,ee){ee=ee===0?0:ee||10;var j=r(U).toHsl();return j.l+=ee/100,j.l=D(j.l),r(j)}function s(U,ee){ee=ee===0?0:ee||10;var j=r(U).toRgb();return j.r=t(0,n(255,j.r-e(-ee/100*255))),j.g=t(0,n(255,j.g-e(-ee/100*255))),j.b=t(0,n(255,j.b-e(-ee/100*255))),r(j)}function x(U,ee){ee=ee===0?0:ee||10;var j=r(U).toHsl();return j.l-=ee/100,j.l=D(j.l),r(j)}function c(U,ee){var j=r(U).toHsl(),Q=(j.h+ee)%360;return j.h=Q<0?360+Q:Q,r(j)}function T(U){var ee=r(U).toHsl();return ee.h=(ee.h+180)%360,r(ee)}function _(U){var ee=r(U).toHsl(),j=ee.h;return[r(U),r({h:(j+120)%360,s:ee.s,l:ee.l}),r({h:(j+240)%360,s:ee.s,l:ee.l})]}function w(U){var ee=r(U).toHsl(),j=ee.h;return[r(U),r({h:(j+90)%360,s:ee.s,l:ee.l}),r({h:(j+180)%360,s:ee.s,l:ee.l}),r({h:(j+270)%360,s:ee.s,l:ee.l})]}function k(U){var ee=r(U).toHsl(),j=ee.h;return[r(U),r({h:(j+72)%360,s:ee.s,l:ee.l}),r({h:(j+216)%360,s:ee.s,l:ee.l})]}function L(U,ee,j){ee=ee||6,j=j||30;var Q=r(U).toHsl(),K=360/j,re=[r(U)];for(Q.h=(Q.h-(K*ee>>1)+720)%360;--ee;)Q.h=(Q.h+K)%360,re.push(r(Q));return re}function A(U,ee){ee=ee||6;for(var j=r(U).toHsv(),Q=j.h,K=j.s,re=j.v,ne=[],le=1/ee;ee--;)ne.push(r({h:Q,s:K,v:re})),re=(re+le)%1;return ne}r.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var U=this.toRgb();return(299*U.r+587*U.g+114*U.b)/1e3},getLuminance:function(){var U,ee,j,Q=this.toRgb();return U=Q.r/255,ee=Q.g/255,j=Q.b/255,.2126*(U<=.03928?U/12.92:p.pow((U+.055)/1.055,2.4))+.7152*(ee<=.03928?ee/12.92:p.pow((ee+.055)/1.055,2.4))+.0722*(j<=.03928?j/12.92:p.pow((j+.055)/1.055,2.4))},setAlpha:function(U){return this._a=S(U),this._roundA=e(100*this._a)/100,this},toHsv:function(){var U=o(this._r,this._g,this._b);return{h:360*U.h,s:U.s,v:U.v,a:this._a}},toHsvString:function(){var U=o(this._r,this._g,this._b),ee=e(360*U.h),j=e(100*U.s),Q=e(100*U.v);return this._a==1?"hsv("+ee+", "+j+"%, "+Q+"%)":"hsva("+ee+", "+j+"%, "+Q+"%, "+this._roundA+")"},toHsl:function(){var U=m(this._r,this._g,this._b);return{h:360*U.h,s:U.s,l:U.l,a:this._a}},toHslString:function(){var U=m(this._r,this._g,this._b),ee=e(360*U.h),j=e(100*U.s),Q=e(100*U.l);return this._a==1?"hsl("+ee+", "+j+"%, "+Q+"%)":"hsla("+ee+", "+j+"%, "+Q+"%, "+this._roundA+")"},toHex:function(U){return i(this._r,this._g,this._b,U)},toHexString:function(U){return"#"+this.toHex(U)},toHex8:function(U){return function(ee,j,Q,K,re){var ne=[H(e(ee).toString(16)),H(e(j).toString(16)),H(e(Q).toString(16)),H(X(K))];return re&&ne[0].charAt(0)==ne[0].charAt(1)&&ne[1].charAt(0)==ne[1].charAt(1)&&ne[2].charAt(0)==ne[2].charAt(1)&&ne[3].charAt(0)==ne[3].charAt(1)?ne[0].charAt(0)+ne[1].charAt(0)+ne[2].charAt(0)+ne[3].charAt(0):ne.join("")}(this._r,this._g,this._b,this._a,U)},toHex8String:function(U){return"#"+this.toHex8(U)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(100*E(this._r,255))+"%",g:e(100*E(this._g,255))+"%",b:e(100*E(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(100*E(this._r,255))+"%, "+e(100*E(this._g,255))+"%, "+e(100*E(this._b,255))+"%)":"rgba("+e(100*E(this._r,255))+"%, "+e(100*E(this._g,255))+"%, "+e(100*E(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(P[i(this._r,this._g,this._b,!0)]||!1)},toFilter:function(U){var ee="#"+u(this._r,this._g,this._b,this._a),j=ee,Q=this._gradientType?"GradientType = 1, ":"";if(U){var K=r(U);j="#"+u(K._r,K._g,K._b,K._a)}return"progid:DXImageTransform.Microsoft.gradient("+Q+"startColorstr="+ee+",endColorstr="+j+")"},toString:function(U){var ee=!!U;U=U||this._format;var j=!1,Q=this._a<1&&this._a>=0;return ee||!Q||U!=="hex"&&U!=="hex6"&&U!=="hex3"&&U!=="hex4"&&U!=="hex8"&&U!=="name"?(U==="rgb"&&(j=this.toRgbString()),U==="prgb"&&(j=this.toPercentageRgbString()),U!=="hex"&&U!=="hex6"||(j=this.toHexString()),U==="hex3"&&(j=this.toHexString(!0)),U==="hex4"&&(j=this.toHex8String(!0)),U==="hex8"&&(j=this.toHex8String()),U==="name"&&(j=this.toName()),U==="hsl"&&(j=this.toHslString()),U==="hsv"&&(j=this.toHsvString()),j||this.toHexString()):U==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return r(this.toString())},_applyModification:function(U,ee){var j=U.apply(null,[this].concat([].slice.call(ee)));return this._r=j._r,this._g=j._g,this._b=j._b,this.setAlpha(j._a),this},lighten:function(){return this._applyModification(d,arguments)},brighten:function(){return this._applyModification(s,arguments)},darken:function(){return this._applyModification(x,arguments)},desaturate:function(){return this._applyModification(f,arguments)},saturate:function(){return this._applyModification(l,arguments)},greyscale:function(){return this._applyModification(h,arguments)},spin:function(){return this._applyModification(c,arguments)},_applyCombination:function(U,ee){return U.apply(null,[this].concat([].slice.call(ee)))},analogous:function(){return this._applyCombination(L,arguments)},complement:function(){return this._applyCombination(T,arguments)},monochromatic:function(){return this._applyCombination(A,arguments)},splitcomplement:function(){return this._applyCombination(k,arguments)},triad:function(){return this._applyCombination(_,arguments)},tetrad:function(){return this._applyCombination(w,arguments)}},r.fromRatio=function(U,ee){if(typeof U=="object"){var j={};for(var Q in U)U.hasOwnProperty(Q)&&(j[Q]=Q==="a"?U[Q]:V(U[Q]));U=j}return r(U,ee)},r.equals=function(U,ee){return!(!U||!ee)&&r(U).toRgbString()==r(ee).toRgbString()},r.random=function(){return r.fromRatio({r:a(),g:a(),b:a()})},r.mix=function(U,ee,j){j=j===0?0:j||50;var Q=r(U).toRgb(),K=r(ee).toRgb(),re=j/100;return r({r:(K.r-Q.r)*re+Q.r,g:(K.g-Q.g)*re+Q.g,b:(K.b-Q.b)*re+Q.b,a:(K.a-Q.a)*re+Q.a})},r.readability=function(U,ee){var j=r(U),Q=r(ee);return(p.max(j.getLuminance(),Q.getLuminance())+.05)/(p.min(j.getLuminance(),Q.getLuminance())+.05)},r.isReadable=function(U,ee,j){var Q,K,re=r.readability(U,ee);switch(K=!1,(Q=function(ne){var le,oe;return le=((ne=ne||{level:"AA",size:"small"}).level||"AA").toUpperCase(),oe=(ne.size||"small").toLowerCase(),le!=="AA"&&le!=="AAA"&&(le="AA"),oe!=="small"&&oe!=="large"&&(oe="small"),{level:le,size:oe}}(j)).level+Q.size){case"AAsmall":case"AAAlarge":K=re>=4.5;break;case"AAlarge":K=re>=3;break;case"AAAsmall":K=re>=7}return K},r.mostReadable=function(U,ee,j){var Q,K,re,ne,le=null,oe=0;K=(j=j||{}).includeFallbackColors,re=j.level,ne=j.size;for(var de=0;de<ee.length;de++)(Q=r.readability(U,ee[de]))>oe&&(oe=Q,le=r(ee[de]));return r.isReadable(U,le,{level:re,size:ne})||!K?le:(j.includeFallbackColors=!1,r.mostReadable(U,["#fff","#000"],j))};var I=r.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},P=r.hexNames=function(U){var ee={};for(var j in U)U.hasOwnProperty(j)&&(ee[U[j]]=j);return ee}(I);function S(U){return U=parseFloat(U),(isNaN(U)||U<0||U>1)&&(U=1),U}function E(U,ee){(function(Q){return typeof Q=="string"&&Q.indexOf(".")!=-1&&parseFloat(Q)===1})(U)&&(U="100%");var j=function(Q){return typeof Q=="string"&&Q.indexOf("%")!=-1}(U);return U=n(ee,t(0,parseFloat(U))),j&&(U=parseInt(U*ee,10)/100),p.abs(U-ee)<1e-6?1:U%ee/parseFloat(ee)}function D(U){return n(1,t(0,U))}function R(U){return parseInt(U,16)}function H(U){return U.length==1?"0"+U:""+U}function V(U){return U<=1&&(U=100*U+"%"),U}function X(U){return p.round(255*parseFloat(U)).toString(16)}function $(U){return R(U)/255}var G,W,te,N=(W="[\\s|\\(]+("+(G="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+G+")[,|\\s]+("+G+")\\s*\\)?",te="[\\s|\\(]+("+G+")[,|\\s]+("+G+")[,|\\s]+("+G+")[,|\\s]+("+G+")\\s*\\)?",{CSS_UNIT:new RegExp(G),rgb:new RegExp("rgb"+W),rgba:new RegExp("rgba"+te),hsl:new RegExp("hsl"+W),hsla:new RegExp("hsla"+te),hsv:new RegExp("hsv"+W),hsva:new RegExp("hsva"+te),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function B(U){return!!N.CSS_UNIT.exec(U)}J!==void 0&&J.exports?J.exports=r:window.tinycolor=r})(Math)},{}],314:[function(v,J,Z){J.exports=g,J.exports.float32=J.exports.float=g,J.exports.fract32=J.exports.fract=function(b,y){if(b.length){if(b instanceof Float32Array)return new Float32Array(b.length);y instanceof Float32Array||(y=g(b));for(var e=0,n=y.length;e<n;e++)y[e]=b[e]-y[e];return y}return g(b-g(b))};var p=new Float32Array(1);function g(b){return b.length?b instanceof Float32Array?b:new Float32Array(b):(p[0]=b,p[0])}},{}],315:[function(v,J,Z){var p=v("parse-unit");J.exports=b;function g(y,e){var n=p(getComputedStyle(y).getPropertyValue(e));return n[0]*b(n[1],y)}function b(y,e){switch(e=e||document.body,y=(y||"px").trim().toLowerCase(),e!==window&&e!==document||(e=document.body),y){case"%":return e.clientHeight/100;case"ch":case"ex":return function(n,t){var a=document.createElement("div");a.style["font-size"]="128"+n,t.appendChild(a);var r=g(a,"font-size")/128;return t.removeChild(a),r}(y,e);case"em":return g(e,"font-size");case"rem":return g(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}},{"parse-unit":251}],316:[function(v,J,Z){(function(p,g){g(typeof Z=="object"&&J!==void 0?Z:(p=p||self).topojson=p.topojson||{})})(this,function(p){function g(u){return u}function b(u){if(u==null)return g;var f,l,h=u.scale[0],d=u.scale[1],s=u.translate[0],x=u.translate[1];return function(c,T){T||(f=l=0);var _=2,w=c.length,k=new Array(w);for(k[0]=(f+=c[0])*h+s,k[1]=(l+=c[1])*d+x;_<w;)k[_]=c[_],++_;return k}}function y(u){var f,l=b(u.transform),h=1/0,d=h,s=-h,x=-h;function c(_){(_=l(_))[0]<h&&(h=_[0]),_[0]>s&&(s=_[0]),_[1]<d&&(d=_[1]),_[1]>x&&(x=_[1])}function T(_){switch(_.type){case"GeometryCollection":_.geometries.forEach(T);break;case"Point":c(_.coordinates);break;case"MultiPoint":_.coordinates.forEach(c)}}for(f in u.arcs.forEach(function(_){for(var w,k=-1,L=_.length;++k<L;)(w=l(_[k],k))[0]<h&&(h=w[0]),w[0]>s&&(s=w[0]),w[1]<d&&(d=w[1]),w[1]>x&&(x=w[1])}),u.objects)T(u.objects[f]);return[h,d,s,x]}function e(u,f){var l=f.id,h=f.bbox,d=f.properties==null?{}:f.properties,s=n(u,f);return l==null&&h==null?{type:"Feature",properties:d,geometry:s}:h==null?{type:"Feature",id:l,properties:d,geometry:s}:{type:"Feature",id:l,bbox:h,properties:d,geometry:s}}function n(u,f){var l=b(u.transform),h=u.arcs;function d(_,w){w.length&&w.pop();for(var k=h[_<0?~_:_],L=0,A=k.length;L<A;++L)w.push(l(k[L],L));_<0&&function(I,P){for(var S,E=I.length,D=E-P;D<--E;)S=I[D],I[D++]=I[E],I[E]=S}(w,A)}function s(_){return l(_)}function x(_){for(var w=[],k=0,L=_.length;k<L;++k)d(_[k],w);return w.length<2&&w.push(w[0]),w}function c(_){for(var w=x(_);w.length<4;)w.push(w[0]);return w}function T(_){return _.map(c)}return function _(w){var k,L=w.type;switch(L){case"GeometryCollection":return{type:L,geometries:w.geometries.map(_)};case"Point":k=s(w.coordinates);break;case"MultiPoint":k=w.coordinates.map(s);break;case"LineString":k=x(w.arcs);break;case"MultiLineString":k=w.arcs.map(x);break;case"Polygon":k=T(w.arcs);break;case"MultiPolygon":k=w.arcs.map(T);break;default:return null}return{type:L,coordinates:k}}(f)}function t(u,f){var l={},h={},d={},s=[],x=-1;function c(T,_){for(var w in T){var k=T[w];delete _[k.start],delete k.start,delete k.end,k.forEach(function(L){l[L<0?~L:L]=1}),s.push(k)}}return f.forEach(function(T,_){var w,k=u.arcs[T<0?~T:T];k.length<3&&!k[1][0]&&!k[1][1]&&(w=f[++x],f[x]=T,f[_]=w)}),f.forEach(function(T){var _,w,k=function(S){var E,D=u.arcs[S<0?~S:S],R=D[0];return u.transform?(E=[0,0],D.forEach(function(H){E[0]+=H[0],E[1]+=H[1]})):E=D[D.length-1],S<0?[E,R]:[R,E]}(T),L=k[0],A=k[1];if(_=d[L])if(delete d[_.end],_.push(T),_.end=A,w=h[A]){delete h[w.start];var I=w===_?_:_.concat(w);h[I.start=_.start]=d[I.end=w.end]=I}else h[_.start]=d[_.end]=_;else if(_=h[A])if(delete h[_.start],_.unshift(T),_.start=L,w=d[L]){delete d[w.end];var P=w===_?_:w.concat(_);h[P.start=w.start]=d[P.end=_.end]=P}else h[_.start]=d[_.end]=_;else h[(_=[T]).start=L]=d[_.end=A]=_}),c(d,h),c(h,d),f.forEach(function(T){l[T<0?~T:T]||s.push([T])}),s}function a(u,f,l){var h,d,s;if(arguments.length>1)h=r(u,f,l);else for(d=0,h=new Array(s=u.arcs.length);d<s;++d)h[d]=d;return{type:"MultiLineString",arcs:t(u,h)}}function r(u,f,l){var h,d=[],s=[];function x(_){var w=_<0?~_:_;(s[w]||(s[w]=[])).push({i:_,g:h})}function c(_){_.forEach(x)}function T(_){_.forEach(c)}return function _(w){switch(h=w,w.type){case"GeometryCollection":w.geometries.forEach(_);break;case"LineString":c(w.arcs);break;case"MultiLineString":case"Polygon":T(w.arcs);break;case"MultiPolygon":(function(k){k.forEach(T)})(w.arcs)}}(f),s.forEach(l==null?function(_){d.push(_[0].i)}:function(_){l(_[0].g,_[_.length-1].g)&&d.push(_[0].i)}),d}function m(u,f){var l={},h=[],d=[];function s(c){c.forEach(function(T){T.forEach(function(_){(l[_=_<0?~_:_]||(l[_]=[])).push(c)})}),h.push(c)}function x(c){return function(T){for(var _,w=-1,k=T.length,L=T[k-1],A=0;++w<k;)_=L,L=T[w],A+=_[0]*L[1]-_[1]*L[0];return Math.abs(A)}(n(u,{type:"Polygon",arcs:[c]}).coordinates[0])}return f.forEach(function c(T){switch(T.type){case"GeometryCollection":T.geometries.forEach(c);break;case"Polygon":s(T.arcs);break;case"MultiPolygon":T.arcs.forEach(s)}}),h.forEach(function(c){if(!c._){var T=[],_=[c];for(c._=1,d.push(T);c=_.pop();)T.push(c),c.forEach(function(w){w.forEach(function(k){l[k<0?~k:k].forEach(function(L){L._||(L._=1,_.push(L))})})})}}),h.forEach(function(c){delete c._}),{type:"MultiPolygon",arcs:d.map(function(c){var T,_=[];if(c.forEach(function(I){I.forEach(function(P){P.forEach(function(S){l[S<0?~S:S].length<2&&_.push(S)})})}),(T=(_=t(u,_)).length)>1)for(var w,k,L=1,A=x(_[0]);L<T;++L)(w=x(_[L]))>A&&(k=_[0],_[0]=_[L],_[L]=k,A=w);return _}).filter(function(c){return c.length>0})}}function o(u,f){for(var l=0,h=u.length;l<h;){var d=l+h>>>1;u[d]<f?l=d+1:h=d}return l}function i(u){if(u==null)return g;var f,l,h=u.scale[0],d=u.scale[1],s=u.translate[0],x=u.translate[1];return function(c,T){T||(f=l=0);var _=2,w=c.length,k=new Array(w),L=Math.round((c[0]-s)/h),A=Math.round((c[1]-x)/d);for(k[0]=L-f,f=L,k[1]=A-l,l=A;_<w;)k[_]=c[_],++_;return k}}p.bbox=y,p.feature=function(u,f){return typeof f=="string"&&(f=u.objects[f]),f.type==="GeometryCollection"?{type:"FeatureCollection",features:f.geometries.map(function(l){return e(u,l)})}:e(u,f)},p.merge=function(u){return n(u,m.apply(this,arguments))},p.mergeArcs=m,p.mesh=function(u){return n(u,a.apply(this,arguments))},p.meshArcs=a,p.neighbors=function(u){var f={},l=u.map(function(){return[]});function h(I,P){I.forEach(function(S){S<0&&(S=~S);var E=f[S];E?E.push(P):f[S]=[P]})}function d(I,P){I.forEach(function(S){h(S,P)})}var s={LineString:h,MultiLineString:d,Polygon:d,MultiPolygon:function(I,P){I.forEach(function(S){d(S,P)})}};for(var x in u.forEach(function I(P,S){P.type==="GeometryCollection"?P.geometries.forEach(function(E){I(E,S)}):P.type in s&&s[P.type](P.arcs,S)}),f)for(var c=f[x],T=c.length,_=0;_<T;++_)for(var w=_+1;w<T;++w){var k,L=c[_],A=c[w];(k=l[L])[x=o(k,A)]!==A&&k.splice(x,0,A),(k=l[A])[x=o(k,L)]!==L&&k.splice(x,0,L)}return l},p.quantize=function(u,f){if(u.transform)throw new Error("already quantized");if(f&&f.scale)c=u.bbox;else{if(!((l=Math.floor(f))>=2))throw new Error("n must be \u22652");var l,h=(c=u.bbox||y(u))[0],d=c[1],s=c[2],x=c[3];f={scale:[s-h?(s-h)/(l-1):1,x-d?(x-d)/(l-1):1],translate:[h,d]}}var c,T,_=i(f),w=u.objects,k={};function L(I){return _(I)}function A(I){var P;switch(I.type){case"GeometryCollection":P={type:"GeometryCollection",geometries:I.geometries.map(A)};break;case"Point":P={type:"Point",coordinates:L(I.coordinates)};break;case"MultiPoint":P={type:"MultiPoint",coordinates:I.coordinates.map(L)};break;default:return I}return I.id!=null&&(P.id=I.id),I.bbox!=null&&(P.bbox=I.bbox),I.properties!=null&&(P.properties=I.properties),P}for(T in w)k[T]=A(w[T]);return{type:"Topology",bbox:c,transform:f,objects:k,arcs:u.arcs.map(function(I){var P,S=0,E=1,D=I.length,R=new Array(D);for(R[0]=_(I[0],0);++S<D;)((P=_(I[S],S))[0]||P[1])&&(R[E++]=P);return E===1&&(R[E++]=[0,0]),R.length=E,R})}},p.transform=b,p.untransform=i,Object.defineProperty(p,"__esModule",{value:!0})})},{}],317:[function(v,J,Z){var p=v("../prototype/is");J.exports=function(g){if(typeof g!="function"||!hasOwnProperty.call(g,"length"))return!1;try{if(typeof g.length!="number"||typeof g.call!="function"||typeof g.apply!="function")return!1}catch{return!1}return!p(g)}},{"../prototype/is":324}],318:[function(v,J,Z){var p=v("../value/is"),g=v("../object/is"),b=v("../string/coerce"),y=v("./to-short-string"),e=function(n,t){return n.replace("%v",y(t))};J.exports=function(n,t,a){if(!g(a))throw new TypeError(e(t,n));if(!p(n)){if("default"in a)return a.default;if(a.isOptional)return null}var r=b(a.errorMessage);throw p(r)||(r=t),new TypeError(e(r,n))}},{"../object/is":321,"../string/coerce":325,"../value/is":327,"./to-short-string":320}],319:[function(v,J,Z){J.exports=function(p){try{return p.toString()}catch{try{return String(p)}catch{return null}}}},{}],320:[function(v,J,Z){var p=v("./safe-to-string"),g=/[\n\r\u2028\u2029]/g;J.exports=function(b){var y=p(b);return y===null?"<Non-coercible to string value>":(y.length>100&&(y=y.slice(0,99)+"\u2026"),y=y.replace(g,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":319}],321:[function(v,J,Z){var p=v("../value/is"),g={object:!0,function:!0,undefined:!0};J.exports=function(b){return!!p(b)&&hasOwnProperty.call(g,typeof b)}},{"../value/is":327}],322:[function(v,J,Z){var p=v("../lib/resolve-exception"),g=v("./is");J.exports=function(b){return g(b)?b:p(b,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":318,"./is":323}],323:[function(v,J,Z){var p=v("../function/is"),g=/^\s*class[\s{/}]/,b=Function.prototype.toString;J.exports=function(y){return!!p(y)&&!g.test(b.call(y))}},{"../function/is":317}],324:[function(v,J,Z){var p=v("../object/is");J.exports=function(g){if(!p(g))return!1;try{return!!g.constructor&&g.constructor.prototype===g}catch{return!1}}},{"../object/is":321}],325:[function(v,J,Z){var p=v("../value/is"),g=v("../object/is"),b=Object.prototype.toString;J.exports=function(y){if(!p(y))return null;if(g(y)){var e=y.toString;if(typeof e!="function"||e===b)return null}try{return""+y}catch{return null}}},{"../object/is":321,"../value/is":327}],326:[function(v,J,Z){var p=v("../lib/resolve-exception"),g=v("./is");J.exports=function(b){return g(b)?b:p(b,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":318,"./is":327}],327:[function(v,J,Z){J.exports=function(p){return p!=null}},{}],328:[function(v,J,Z){(function(p){(function(){var g=v("bit-twiddle"),b=v("dup"),y=v("buffer").Buffer;p.__TYPEDARRAY_POOL||(p.__TYPEDARRAY_POOL={UINT8:b([32,0]),UINT16:b([32,0]),UINT32:b([32,0]),BIGUINT64:b([32,0]),INT8:b([32,0]),INT16:b([32,0]),INT32:b([32,0]),BIGINT64:b([32,0]),FLOAT:b([32,0]),DOUBLE:b([32,0]),DATA:b([32,0]),UINT8C:b([32,0]),BUFFER:b([32,0])});var e=typeof Uint8ClampedArray<"u",n=typeof BigUint64Array<"u",t=typeof BigInt64Array<"u",a=p.__TYPEDARRAY_POOL;a.UINT8C||(a.UINT8C=b([32,0])),a.BIGUINT64||(a.BIGUINT64=b([32,0])),a.BIGINT64||(a.BIGINT64=b([32,0])),a.BUFFER||(a.BUFFER=b([32,0]));var r=a.DATA,m=a.BUFFER;function o(A){if(A){var I=A.length||A.byteLength,P=g.log2(I);r[P].push(A)}}function i(A){A=g.nextPow2(A);var I=g.log2(A),P=r[I];return P.length>0?P.pop():new ArrayBuffer(A)}function u(A){return new Uint8Array(i(A),0,A)}function f(A){return new Uint16Array(i(2*A),0,A)}function l(A){return new Uint32Array(i(4*A),0,A)}function h(A){return new Int8Array(i(A),0,A)}function d(A){return new Int16Array(i(2*A),0,A)}function s(A){return new Int32Array(i(4*A),0,A)}function x(A){return new Float32Array(i(4*A),0,A)}function c(A){return new Float64Array(i(8*A),0,A)}function T(A){return e?new Uint8ClampedArray(i(A),0,A):u(A)}function _(A){return n?new BigUint64Array(i(8*A),0,A):null}function w(A){return t?new BigInt64Array(i(8*A),0,A):null}function k(A){return new DataView(i(A),0,A)}function L(A){A=g.nextPow2(A);var I=g.log2(A),P=m[I];return P.length>0?P.pop():new y(A)}Z.free=function(A){if(y.isBuffer(A))m[g.log2(A.length)].push(A);else{if(Object.prototype.toString.call(A)!=="[object ArrayBuffer]"&&(A=A.buffer),!A)return;var I=A.length||A.byteLength,P=0|g.log2(I);r[P].push(A)}},Z.freeUint8=Z.freeUint16=Z.freeUint32=Z.freeBigUint64=Z.freeInt8=Z.freeInt16=Z.freeInt32=Z.freeBigInt64=Z.freeFloat32=Z.freeFloat=Z.freeFloat64=Z.freeDouble=Z.freeUint8Clamped=Z.freeDataView=function(A){o(A.buffer)},Z.freeArrayBuffer=o,Z.freeBuffer=function(A){m[g.log2(A.length)].push(A)},Z.malloc=function(A,I){if(I===void 0||I==="arraybuffer")return i(A);switch(I){case"uint8":return u(A);case"uint16":return f(A);case"uint32":return l(A);case"int8":return h(A);case"int16":return d(A);case"int32":return s(A);case"float":case"float32":return x(A);case"double":case"float64":return c(A);case"uint8_clamped":return T(A);case"bigint64":return w(A);case"biguint64":return _(A);case"buffer":return L(A);case"data":case"dataview":return k(A);default:return null}return null},Z.mallocArrayBuffer=i,Z.mallocUint8=u,Z.mallocUint16=f,Z.mallocUint32=l,Z.mallocInt8=h,Z.mallocInt16=d,Z.mallocInt32=s,Z.mallocFloat32=Z.mallocFloat=x,Z.mallocFloat64=Z.mallocDouble=c,Z.mallocUint8Clamped=T,Z.mallocBigUint64=_,Z.mallocBigInt64=w,Z.mallocDataView=k,Z.mallocBuffer=L,Z.clearCache=function(){for(var A=0;A<32;++A)a.UINT8[A].length=0,a.UINT16[A].length=0,a.UINT32[A].length=0,a.INT8[A].length=0,a.INT16[A].length=0,a.INT32[A].length=0,a.FLOAT[A].length=0,a.DOUBLE[A].length=0,a.BIGUINT64[A].length=0,a.BIGINT64[A].length=0,a.UINT8C[A].length=0,r[A].length=0,m[A].length=0}}).call(this)}).call(this,typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],329:[function(v,J,Z){var p=/[\'\"]/;J.exports=function(g){return g?(p.test(g.charAt(0))&&(g=g.substr(1)),p.test(g.charAt(g.length-1))&&(g=g.substr(0,g.length-1)),g):""}},{}],330:[function(v,J,Z){J.exports=function(p,g,b){Array.isArray(b)||(b=[].slice.call(arguments,2));for(var y=0,e=b.length;y<e;y++){var n=b[y];for(var t in n)if((g[t]===void 0||Array.isArray(g[t])||p[t]!==g[t])&&t in g){var a;if(n[t]===!0)a=g[t];else if(n[t]===!1||typeof n[t]=="function"&&(a=n[t](g[t],p,g))===void 0)continue;p[t]=a}}return p}},{}],331:[function(v,J,Z){(function(p){(function(){function g(b){try{if(!p.localStorage)return!1}catch{return!1}var y=p.localStorage[b];return y!=null&&String(y).toLowerCase()==="true"}J.exports=function(b,y){if(g("noDeprecation"))return b;var e=!1;return function(){if(!e){if(g("throwDeprecation"))throw new Error(y);g("traceDeprecation")?console.trace(y):console.warn(y),e=!0}return b.apply(this,arguments)}}}).call(this)}).call(this,typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{}],332:[function(v,J,Z){var p=v("get-canvas-context");J.exports=function(g){return p("webgl",g)}},{"get-canvas-context":194}],333:[function(v,J,Z){var p=v("../main"),g=v("object-assign"),b=p.instance();function y(o){this.local=this.regionalOptions[o||""]||this.regionalOptions[""]}y.prototype=new p.baseCalendar,g(y.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(o,i){if(typeof o=="string"){var u=o.match(n);return u?u[0]:""}var f=this._validateYear(o),l=o.month(),h=""+this.toChineseMonth(f,l);return i&&h.length<2&&(h="0"+h),this.isIntercalaryMonth(f,l)&&(h+="i"),h},monthNames:function(o){if(typeof o=="string"){var i=o.match(t);return i?i[0]:""}var u=this._validateYear(o),f=o.month(),l=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][this.toChineseMonth(u,f)-1];return this.isIntercalaryMonth(u,f)&&(l="\u95F0"+l),l},monthNamesShort:function(o){if(typeof o=="string"){var i=o.match(a);return i?i[0]:""}var u=this._validateYear(o),f=o.month(),l=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][this.toChineseMonth(u,f)-1];return this.isIntercalaryMonth(u,f)&&(l="\u95F0"+l),l},parseMonth:function(o,i){o=this._validateYear(o);var u,f=parseInt(i);if(isNaN(f))i[0]==="\u95F0"&&(u=!0,i=i.substring(1)),i[i.length-1]==="\u6708"&&(i=i.substring(0,i.length-1)),f=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(i);else{var l=i[i.length-1];u=l==="i"||l==="I"}return this.toMonthIndex(o,f,u)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(o,i){if(o.year&&(o=o.year()),typeof o!="number"||o<1888||o>2111)throw i.replace(/\{0\}/,this.local.name);return o},toMonthIndex:function(o,i,u){var f=this.intercalaryMonth(o);if(u&&i!==f||i<1||i>12)throw p.local.invalidMonth.replace(/\{0\}/,this.local.name);return f?!u&&i<=f?i-1:i:i-1},toChineseMonth:function(o,i){o.year&&(i=(o=o.year()).month());var u=this.intercalaryMonth(o);if(i<0||i>(u?12:11))throw p.local.invalidMonth.replace(/\{0\}/,this.local.name);return u?i<u?i+1:i:i+1},intercalaryMonth:function(o){return o=this._validateYear(o),r[o-r[0]]>>13},isIntercalaryMonth:function(o,i){o.year&&(i=(o=o.year()).month());var u=this.intercalaryMonth(o);return!!u&&u===i},leapYear:function(o){return this.intercalaryMonth(o)!==0},weekOfYear:function(o,i,u){var f,l=this._validateYear(o,p.local.invalidyear),h=m[l-m[0]],d=h>>9&4095,s=h>>5&15,x=31&h;(f=b.newDate(d,s,x)).add(4-(f.dayOfWeek()||7),"d");var c=this.toJD(o,i,u)-f.toJD();return 1+Math.floor(c/7)},monthsInYear:function(o){return this.leapYear(o)?13:12},daysInMonth:function(o,i){o.year&&(i=o.month(),o=o.year()),o=this._validateYear(o);var u=r[o-r[0]];if(i>(u>>13?12:11))throw p.local.invalidMonth.replace(/\{0\}/,this.local.name);return u&1<<12-i?30:29},weekDay:function(o,i,u){return(this.dayOfWeek(o,i,u)||7)<6},toJD:function(o,i,u){var f=this._validate(o,h,u,p.local.invalidDate);o=this._validateYear(f.year()),i=f.month(),u=f.day();var l=this.isIntercalaryMonth(o,i),h=this.toChineseMonth(o,i),d=function(s,x,c,T,_){var w,k,L;if(typeof s=="object")k=s,w=x||{};else{var A;if(!(typeof s=="number"&&s>=1888&&s<=2111))throw new Error("Lunar year outside range 1888-2111");if(!(typeof x=="number"&&x>=1&&x<=12))throw new Error("Lunar month outside range 1 - 12");if(!(typeof c=="number"&&c>=1&&c<=30))throw new Error("Lunar day outside range 1 - 30");typeof T=="object"?(A=!1,w=T):(A=!!T,w=_||{}),k={year:s,month:x,day:c,isIntercalary:A}}L=k.day-1;var I,P=r[k.year-r[0]],S=P>>13;I=S&&(k.month>S||k.isIntercalary)?k.month:k.month-1;for(var E=0;E<I;E++)L+=P&1<<12-E?30:29;var D=m[k.year-m[0]],R=new Date(D>>9&4095,(D>>5&15)-1,(31&D)+L);return w.year=R.getFullYear(),w.month=1+R.getMonth(),w.day=R.getDate(),w}(o,h,u,l);return b.toJD(d.year,d.month,d.day)},fromJD:function(o){var i=b.fromJD(o),u=function(l,h,d,s){var x,c;if(typeof l=="object")x=l,c=h||{};else{if(!(typeof l=="number"&&l>=1888&&l<=2111))throw new Error("Solar year outside range 1888-2111");if(!(typeof h=="number"&&h>=1&&h<=12))throw new Error("Solar month outside range 1 - 12");if(!(typeof d=="number"&&d>=1&&d<=31))throw new Error("Solar day outside range 1 - 31");x={year:l,month:h,day:d},c=s||{}}var T=m[x.year-m[0]],_=x.year<<9|x.month<<5|x.day;c.year=_>=T?x.year:x.year-1,T=m[c.year-m[0]];var w,k=new Date(T>>9&4095,(T>>5&15)-1,31&T),L=new Date(x.year,x.month-1,x.day);w=Math.round((L-k)/864e5);var A,I=r[c.year-r[0]];for(A=0;A<13;A++){var P=I&1<<12-A?30:29;if(w<P)break;w-=P}var S=I>>13;return!S||A<S?(c.isIntercalary=!1,c.month=1+A):A===S?(c.isIntercalary=!0,c.month=A):(c.isIntercalary=!1,c.month=A),c.day=1+w,c}(i.year(),i.month(),i.day()),f=this.toMonthIndex(u.year,u.month,u.isIntercalary);return this.newDate(u.year,f,u.day)},fromString:function(o){var i=o.match(e),u=this._validateYear(+i[1]),f=+i[2],l=!!i[3],h=this.toMonthIndex(u,f,l),d=+i[4];return this.newDate(u,h,d)},add:function(o,i,u){var f=o.year(),l=o.month(),h=this.isIntercalaryMonth(f,l),d=this.toChineseMonth(f,l),s=Object.getPrototypeOf(y.prototype).add.call(this,o,i,u);if(u==="y"){var x=s.year(),c=s.month(),T=this.isIntercalaryMonth(x,d),_=h&&T?this.toMonthIndex(x,d,!0):this.toMonthIndex(x,d,!1);_!==c&&s.month(_)}return s}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,n=/^\d?\d[iI]?/m,t=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,a=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;p.calendars.chinese=y;var r=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],m=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":347,"object-assign":247}],334:[function(v,J,Z){var p=v("../main"),g=v("object-assign");function b(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}b.prototype=new p.baseCalendar,g(b.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(y){var e=this._validate(y,this.minMonth,this.minDay,p.local.invalidYear);return(y=e.year()+(e.year()<0?1:0))%4==3||y%4==-1},monthsInYear:function(y){return this._validate(y,this.minMonth,this.minDay,p.local.invalidYear||p.regionalOptions[""].invalidYear),13},weekOfYear:function(y,e,n){var t=this.newDate(y,e,n);return t.add(-t.dayOfWeek(),"d"),Math.floor((t.dayOfYear()-1)/7)+1},daysInMonth:function(y,e){var n=this._validate(y,e,this.minDay,p.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===13&&this.leapYear(n.year())?1:0)},weekDay:function(y,e,n){return(this.dayOfWeek(y,e,n)||7)<6},toJD:function(y,e,n){var t=this._validate(y,e,n,p.local.invalidDate);return(y=t.year())<0&&y++,t.day()+30*(t.month()-1)+365*(y-1)+Math.floor(y/4)+this.jdEpoch-1},fromJD:function(y){var e=Math.floor(y)+.5-this.jdEpoch,n=Math.floor((e-Math.floor((e+366)/1461))/365)+1;n<=0&&n--,e=Math.floor(y)+.5-this.newDate(n,1,1).toJD();var t=Math.floor(e/30)+1,a=e-30*(t-1)+1;return this.newDate(n,t,a)}}),p.calendars.coptic=b},{"../main":347,"object-assign":247}],335:[function(v,J,Z){var p=v("../main"),g=v("object-assign");function b(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}b.prototype=new p.baseCalendar,g(b.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,p.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,p.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,p.local.invalidYear),400},weekOfYear:function(e,n,t){var a=this.newDate(e,n,t);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/8)+1},daysInMonth:function(e,n){var t=this._validate(e,n,this.minDay,p.local.invalidMonth);return this.daysPerMonth[t.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,n,t){return(this._validate(e,n,t,p.local.invalidDate).day()+1)%8},weekDay:function(e,n,t){var a=this.dayOfWeek(e,n,t);return a>=2&&a<=6},extraInfo:function(e,n,t){var a=this._validate(e,n,t,p.local.invalidDate);return{century:y[Math.floor((a.year()-1)/100)+1]||""}},toJD:function(e,n,t){var a=this._validate(e,n,t,p.local.invalidDate);return e=a.year()+(a.year()<0?1:0),n=a.month(),(t=a.day())+(n>1?16:0)+(n>2?32*(n-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var n=Math.floor(e/400)+1;e-=400*(n-1),e+=e>15?16:0;var t=Math.floor(e/32)+1,a=e-32*(t-1)+1;return this.newDate(n<=0?n-1:n,t,a)}});var y={20:"Fruitbat",21:"Anchovy"};p.calendars.discworld=b},{"../main":347,"object-assign":247}],336:[function(v,J,Z){var p=v("../main"),g=v("object-assign");function b(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}b.prototype=new p.baseCalendar,g(b.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(y){var e=this._validate(y,this.minMonth,this.minDay,p.local.invalidYear);return(y=e.year()+(e.year()<0?1:0))%4==3||y%4==-1},monthsInYear:function(y){return this._validate(y,this.minMonth,this.minDay,p.local.invalidYear||p.regionalOptions[""].invalidYear),13},weekOfYear:function(y,e,n){var t=this.newDate(y,e,n);return t.add(-t.dayOfWeek(),"d"),Math.floor((t.dayOfYear()-1)/7)+1},daysInMonth:function(y,e){var n=this._validate(y,e,this.minDay,p.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===13&&this.leapYear(n.year())?1:0)},weekDay:function(y,e,n){return(this.dayOfWeek(y,e,n)||7)<6},toJD:function(y,e,n){var t=this._validate(y,e,n,p.local.invalidDate);return(y=t.year())<0&&y++,t.day()+30*(t.month()-1)+365*(y-1)+Math.floor(y/4)+this.jdEpoch-1},fromJD:function(y){var e=Math.floor(y)+.5-this.jdEpoch,n=Math.floor((e-Math.floor((e+366)/1461))/365)+1;n<=0&&n--,e=Math.floor(y)+.5-this.newDate(n,1,1).toJD();var t=Math.floor(e/30)+1,a=e-30*(t-1)+1;return this.newDate(n,t,a)}}),p.calendars.ethiopian=b},{"../main":347,"object-assign":247}],337:[function(v,J,Z){var p=v("../main"),g=v("object-assign");function b(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function y(e,n){return e-n*Math.floor(e/n)}b.prototype=new p.baseCalendar,g(b.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,p.local.invalidYear);return this._leapYear(n.year())},_leapYear:function(e){return y(7*(e=e<0?e+1:e)+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,p.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,n,t){var a=this.newDate(e,n,t);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){return e=this._validate(e,this.minMonth,this.minDay,p.local.invalidYear).year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,n){return e.year&&(n=e.month(),e=e.year()),this._validate(e,n,this.minDay,p.local.invalidMonth),n===12&&this.leapYear(e)||n===8&&y(this.daysInYear(e),10)===5?30:n===9&&y(this.daysInYear(e),10)===3?29:this.daysPerMonth[n-1]},weekDay:function(e,n,t){return this.dayOfWeek(e,n,t)!==6},extraInfo:function(e,n,t){var a=this._validate(e,n,t,p.local.invalidDate);return{yearType:(this.leapYear(a)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(a)%10-3]}},toJD:function(e,n,t){var a=this._validate(e,n,t,p.local.invalidDate);e=a.year(),n=a.month(),t=a.day();var r=e<=0?e+1:e,m=this.jdEpoch+this._delay1(r)+this._delay2(r)+t+1;if(n<7){for(var o=7;o<=this.monthsInYear(e);o++)m+=this.daysInMonth(e,o);for(o=1;o<n;o++)m+=this.daysInMonth(e,o)}else for(o=7;o<n;o++)m+=this.daysInMonth(e,o);return m},_delay1:function(e){var n=Math.floor((235*e-234)/19),t=12084+13753*n,a=29*n+Math.floor(t/25920);return y(3*(a+1),7)<3&&a++,a},_delay2:function(e){var n=this._delay1(e-1),t=this._delay1(e);return this._delay1(e+1)-t==356?2:t-n==382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var n=Math.floor(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(n===-1?1:n+1,7,1);)n++;for(var t=e<this.toJD(n,1,1)?7:1;e>this.toJD(n,t,this.daysInMonth(n,t));)t++;var a=e-this.toJD(n,t,1)+1;return this.newDate(n,t,a)}}),p.calendars.hebrew=b},{"../main":347,"object-assign":247}],338:[function(v,J,Z){var p=v("../main"),g=v("object-assign");function b(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}b.prototype=new p.baseCalendar,g(b.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(y){return(11*this._validate(y,this.minMonth,this.minDay,p.local.invalidYear).year()+14)%30<11},weekOfYear:function(y,e,n){var t=this.newDate(y,e,n);return t.add(-t.dayOfWeek(),"d"),Math.floor((t.dayOfYear()-1)/7)+1},daysInYear:function(y){return this.leapYear(y)?355:354},daysInMonth:function(y,e){var n=this._validate(y,e,this.minDay,p.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(y,e,n){return this.dayOfWeek(y,e,n)!==5},toJD:function(y,e,n){var t=this._validate(y,e,n,p.local.invalidDate);return y=t.year(),e=t.month(),y=y<=0?y+1:y,(n=t.day())+Math.ceil(29.5*(e-1))+354*(y-1)+Math.floor((3+11*y)/30)+this.jdEpoch-1},fromJD:function(y){y=Math.floor(y)+.5;var e=Math.floor((30*(y-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var n=Math.min(12,Math.ceil((y-29-this.toJD(e,1,1))/29.5)+1),t=y-this.toJD(e,n,1)+1;return this.newDate(e,n,t)}}),p.calendars.islamic=b},{"../main":347,"object-assign":247}],339:[function(v,J,Z){var p=v("../main"),g=v("object-assign");function b(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}b.prototype=new p.baseCalendar,g(b.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(y){var e=this._validate(y,this.minMonth,this.minDay,p.local.invalidYear);return(y=e.year()<0?e.year()+1:e.year())%4==0},weekOfYear:function(y,e,n){var t=this.newDate(y,e,n);return t.add(4-(t.dayOfWeek()||7),"d"),Math.floor((t.dayOfYear()-1)/7)+1},daysInMonth:function(y,e){var n=this._validate(y,e,this.minDay,p.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(y,e,n){return(this.dayOfWeek(y,e,n)||7)<6},toJD:function(y,e,n){var t=this._validate(y,e,n,p.local.invalidDate);return y=t.year(),e=t.month(),n=t.day(),y<0&&y++,e<=2&&(y--,e+=12),Math.floor(365.25*(y+4716))+Math.floor(30.6001*(e+1))+n-1524.5},fromJD:function(y){var e=Math.floor(y+.5)+1524,n=Math.floor((e-122.1)/365.25),t=Math.floor(365.25*n),a=Math.floor((e-t)/30.6001),r=a-Math.floor(a<14?1:13),m=n-Math.floor(r>2?4716:4715),o=e-t-Math.floor(30.6001*a);return m<=0&&m--,this.newDate(m,r,o)}}),p.calendars.julian=b},{"../main":347,"object-assign":247}],340:[function(v,J,Z){var p=v("../main"),g=v("object-assign");function b(n){this.local=this.regionalOptions[n||""]||this.regionalOptions[""]}function y(n,t){return n-t*Math.floor(n/t)}function e(n,t){return y(n-1,t)+1}b.prototype=new p.baseCalendar,g(b.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(n){return this._validate(n,this.minMonth,this.minDay,p.local.invalidYear),!1},formatYear:function(n){n=this._validate(n,this.minMonth,this.minDay,p.local.invalidYear).year();var t=Math.floor(n/400);return n%=400,n+=n<0?400:0,t+"."+Math.floor(n/20)+"."+n%20},forYear:function(n){if((n=n.split(".")).length<3)throw"Invalid Mayan year";for(var t=0,a=0;a<n.length;a++){var r=parseInt(n[a],10);if(Math.abs(r)>19||a>0&&r<0)throw"Invalid Mayan year";t=20*t+r}return t},monthsInYear:function(n){return this._validate(n,this.minMonth,this.minDay,p.local.invalidYear),18},weekOfYear:function(n,t,a){return this._validate(n,t,a,p.local.invalidDate),0},daysInYear:function(n){return this._validate(n,this.minMonth,this.minDay,p.local.invalidYear),360},daysInMonth:function(n,t){return this._validate(n,t,this.minDay,p.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(n,t,a){return this._validate(n,t,a,p.local.invalidDate).day()},weekDay:function(n,t,a){return this._validate(n,t,a,p.local.invalidDate),!0},extraInfo:function(n,t,a){var r=this._validate(n,t,a,p.local.invalidDate).toJD(),m=this._toHaab(r),o=this._toTzolkin(r);return{haabMonthName:this.local.haabMonths[m[0]-1],haabMonth:m[0],haabDay:m[1],tzolkinDayName:this.local.tzolkinMonths[o[0]-1],tzolkinDay:o[0],tzolkinTrecena:o[1]}},_toHaab:function(n){var t=y((n-=this.jdEpoch)+8+340,365);return[Math.floor(t/20)+1,y(t,20)]},_toTzolkin:function(n){return[e((n-=this.jdEpoch)+20,20),e(n+4,13)]},toJD:function(n,t,a){var r=this._validate(n,t,a,p.local.invalidDate);return r.day()+20*r.month()+360*r.year()+this.jdEpoch},fromJD:function(n){n=Math.floor(n)+.5-this.jdEpoch;var t=Math.floor(n/360);n%=360,n+=n<0?360:0;var a=Math.floor(n/20),r=n%20;return this.newDate(t,a,r)}}),p.calendars.mayan=b},{"../main":347,"object-assign":247}],341:[function(v,J,Z){var p=v("../main"),g=v("object-assign");function b(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}b.prototype=new p.baseCalendar;var y=p.instance("gregorian");g(b.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,p.local.invalidYear||p.regionalOptions[""].invalidYear);return y.leapYear(n.year()+(n.year()<1?1:0)+1469)},weekOfYear:function(e,n,t){var a=this.newDate(e,n,t);return a.add(1-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,n){var t=this._validate(e,n,this.minDay,p.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===12&&this.leapYear(t.year())?1:0)},weekDay:function(e,n,t){return(this.dayOfWeek(e,n,t)||7)<6},toJD:function(e,n,t){var a=this._validate(e,n,t,p.local.invalidMonth);(e=a.year())<0&&e++;for(var r=a.day(),m=1;m<a.month();m++)r+=this.daysPerMonth[m-1];return r+y.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var n=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(n+1,1,1);)n++;for(var t=e-Math.floor(this.toJD(n,1,1)+.5)+1,a=1;t>this.daysInMonth(n,a);)t-=this.daysInMonth(n,a),a++;return this.newDate(n,a,t)}}),p.calendars.nanakshahi=b},{"../main":347,"object-assign":247}],342:[function(v,J,Z){var p=v("../main"),g=v("object-assign");function b(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}b.prototype=new p.baseCalendar,g(b.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(y){return this.daysInYear(y)!==this.daysPerYear},weekOfYear:function(y,e,n){var t=this.newDate(y,e,n);return t.add(-t.dayOfWeek(),"d"),Math.floor((t.dayOfYear()-1)/7)+1},daysInYear:function(y){if(y=this._validate(y,this.minMonth,this.minDay,p.local.invalidYear).year(),this.NEPALI_CALENDAR_DATA[y]===void 0)return this.daysPerYear;for(var e=0,n=this.minMonth;n<=12;n++)e+=this.NEPALI_CALENDAR_DATA[y][n];return e},daysInMonth:function(y,e){return y.year&&(e=y.month(),y=y.year()),this._validate(y,e,this.minDay,p.local.invalidMonth),this.NEPALI_CALENDAR_DATA[y]===void 0?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[y][e]},weekDay:function(y,e,n){return this.dayOfWeek(y,e,n)!==6},toJD:function(y,e,n){var t=this._validate(y,e,n,p.local.invalidDate);y=t.year(),e=t.month(),n=t.day();var a=p.instance(),r=0,m=e,o=y;this._createMissingCalendarData(y);var i=y-(m>9||m===9&&n>=this.NEPALI_CALENDAR_DATA[o][0]?56:57);for(e!==9&&(r=n,m--);m!==9;)m<=0&&(m=12,o--),r+=this.NEPALI_CALENDAR_DATA[o][m],m--;return e===9?(r+=n-this.NEPALI_CALENDAR_DATA[o][0])<0&&(r+=a.daysInYear(i)):r+=this.NEPALI_CALENDAR_DATA[o][9]-this.NEPALI_CALENDAR_DATA[o][0],a.newDate(i,1,1).add(r,"d").toJD()},fromJD:function(y){var e=p.instance().fromJD(y),n=e.year(),t=e.dayOfYear(),a=n+56;this._createMissingCalendarData(a);for(var r=9,m=this.NEPALI_CALENDAR_DATA[a][0],o=this.NEPALI_CALENDAR_DATA[a][r]-m+1;t>o;)++r>12&&(r=1,a++),o+=this.NEPALI_CALENDAR_DATA[a][r];var i=this.NEPALI_CALENDAR_DATA[a][r]-(o-t);return this.newDate(a,r,i)},_createMissingCalendarData:function(y){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var n=y-1;n<y+2;n++)this.NEPALI_CALENDAR_DATA[n]===void 0&&(this.NEPALI_CALENDAR_DATA[n]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),p.calendars.nepali=b},{"../main":347,"object-assign":247}],343:[function(v,J,Z){var p=v("../main"),g=v("object-assign");function b(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function y(e,n){return e-n*Math.floor(e/n)}b.prototype=new p.baseCalendar,g(b.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,p.local.invalidYear);return 682*((n.year()-(n.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(e,n,t){var a=this.newDate(e,n,t);return a.add(-(a.dayOfWeek()+1)%7,"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,n){var t=this._validate(e,n,this.minDay,p.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===12&&this.leapYear(t.year())?1:0)},weekDay:function(e,n,t){return this.dayOfWeek(e,n,t)!==5},toJD:function(e,n,t){var a=this._validate(e,n,t,p.local.invalidDate);e=a.year(),n=a.month(),t=a.day();var r=e-(e>=0?474:473),m=474+y(r,2820);return t+(n<=7?31*(n-1):30*(n-1)+6)+Math.floor((682*m-110)/2816)+365*(m-1)+1029983*Math.floor(r/2820)+this.jdEpoch-1},fromJD:function(e){var n=(e=Math.floor(e)+.5)-this.toJD(475,1,1),t=Math.floor(n/1029983),a=y(n,1029983),r=2820;if(a!==1029982){var m=Math.floor(a/366),o=y(a,366);r=Math.floor((2134*m+2816*o+2815)/1028522)+m+1}var i=r+2820*t+474;i=i<=0?i-1:i;var u=e-this.toJD(i,1,1)+1,f=u<=186?Math.ceil(u/31):Math.ceil((u-6)/30),l=e-this.toJD(i,f,1)+1;return this.newDate(i,f,l)}}),p.calendars.persian=b,p.calendars.jalali=b},{"../main":347,"object-assign":247}],344:[function(v,J,Z){var p=v("../main"),g=v("object-assign"),b=p.instance();function y(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}y.prototype=new p.baseCalendar,g(y.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,p.local.invalidYear);return e=this._t2gYear(n.year()),b.leapYear(e)},weekOfYear:function(e,n,t){var a=this._validate(e,this.minMonth,this.minDay,p.local.invalidYear);return e=this._t2gYear(a.year()),b.weekOfYear(e,a.month(),a.day())},daysInMonth:function(e,n){var t=this._validate(e,n,this.minDay,p.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===2&&this.leapYear(t.year())?1:0)},weekDay:function(e,n,t){return(this.dayOfWeek(e,n,t)||7)<6},toJD:function(e,n,t){var a=this._validate(e,n,t,p.local.invalidDate);return e=this._t2gYear(a.year()),b.toJD(e,a.month(),a.day())},fromJD:function(e){var n=b.fromJD(e),t=this._g2tYear(n.year());return this.newDate(t,n.month(),n.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),p.calendars.taiwan=y},{"../main":347,"object-assign":247}],345:[function(v,J,Z){var p=v("../main"),g=v("object-assign"),b=p.instance();function y(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}y.prototype=new p.baseCalendar,g(y.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,p.local.invalidYear);return e=this._t2gYear(n.year()),b.leapYear(e)},weekOfYear:function(e,n,t){var a=this._validate(e,this.minMonth,this.minDay,p.local.invalidYear);return e=this._t2gYear(a.year()),b.weekOfYear(e,a.month(),a.day())},daysInMonth:function(e,n){var t=this._validate(e,n,this.minDay,p.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===2&&this.leapYear(t.year())?1:0)},weekDay:function(e,n,t){return(this.dayOfWeek(e,n,t)||7)<6},toJD:function(e,n,t){var a=this._validate(e,n,t,p.local.invalidDate);return e=this._t2gYear(a.year()),b.toJD(e,a.month(),a.day())},fromJD:function(e){var n=b.fromJD(e),t=this._g2tYear(n.year());return this.newDate(t,n.month(),n.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),p.calendars.thai=y},{"../main":347,"object-assign":247}],346:[function(v,J,Z){var p=v("../main"),g=v("object-assign");function b(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}b.prototype=new p.baseCalendar,g(b.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var n=this._validate(e,this.minMonth,this.minDay,p.local.invalidYear);return this.daysInYear(n.year())===355},weekOfYear:function(e,n,t){var a=this.newDate(e,n,t);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var n=0,t=1;t<=12;t++)n+=this.daysInMonth(e,t);return n},daysInMonth:function(e,n){for(var t=this._validate(e,n,this.minDay,p.local.invalidMonth).toJD()-24e5+.5,a=0,r=0;r<y.length;r++){if(y[r]>t)return y[a]-y[a-1];a++}return 30},weekDay:function(e,n,t){return this.dayOfWeek(e,n,t)!==5},toJD:function(e,n,t){var a=this._validate(e,n,t,p.local.invalidDate),r=12*(a.year()-1)+a.month()-15292;return a.day()+y[r-1]-1+24e5-.5},fromJD:function(e){for(var n=e-24e5+.5,t=0,a=0;a<y.length&&!(y[a]>n);a++)t++;var r=t+15292,m=Math.floor((r-1)/12),o=m+1,i=r-12*m,u=n-y[t-1]+1;return this.newDate(o,i,u)},isValid:function(e,n,t){var a=p.baseCalendar.prototype.isValid.apply(this,arguments);return a&&(a=(e=e.year!=null?e.year:e)>=1276&&e<=1500),a},_validate:function(e,n,t,a){var r=p.baseCalendar.prototype._validate.apply(this,arguments);if(r.year<1276||r.year>1500)throw a.replace(/\{0\}/,this.local.name);return r}}),p.calendars.ummalqura=b;var y=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":347,"object-assign":247}],347:[function(v,J,Z){var p=v("object-assign");function g(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function b(a,r,m,o){if(this._calendar=a,this._year=r,this._month=m,this._day=o,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(t.local.invalidDate||t.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function y(a,r){return"000000".substring(0,r-(a=""+a).length)+a}function e(){this.shortYearCutoff="+10"}function n(a){this.local=this.regionalOptions[a]||this.regionalOptions[""]}p(g.prototype,{instance:function(a,r){a=(a||"gregorian").toLowerCase(),r=r||"";var m=this._localCals[a+"-"+r];if(!m&&this.calendars[a]&&(m=new this.calendars[a](r),this._localCals[a+"-"+r]=m),!m)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,a);return m},newDate:function(a,r,m,o,i){return(o=(a!=null&&a.year?a.calendar():typeof o=="string"?this.instance(o,i):o)||this.instance()).newDate(a,r,m)},substituteDigits:function(a){return function(r){return(r+"").replace(/[0-9]/g,function(m){return a[m]})}},substituteChineseDigits:function(a,r){return function(m){for(var o="",i=0;m>0;){var u=m%10;o=(u===0?"":a[u]+r[i])+o,i++,m=Math.floor(m/10)}return o.indexOf(a[1]+r[1])===0&&(o=o.substr(1)),o||a[0]}}}),p(b.prototype,{newDate:function(a,r,m){return this._calendar.newDate(a==null?this:a,r,m)},year:function(a){return arguments.length===0?this._year:this.set(a,"y")},month:function(a){return arguments.length===0?this._month:this.set(a,"m")},day:function(a){return arguments.length===0?this._day:this.set(a,"d")},date:function(a,r,m){if(!this._calendar.isValid(a,r,m))throw(t.local.invalidDate||t.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=a,this._month=r,this._day=m,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(a,r){return this._calendar.add(this,a,r)},set:function(a,r){return this._calendar.set(this,a,r)},compareTo:function(a){if(this._calendar.name!==a._calendar.name)throw(t.local.differentCalendars||t.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,a._calendar.local.name);var r=this._year!==a._year?this._year-a._year:this._month!==a._month?this.monthOfYear()-a.monthOfYear():this._day-a._day;return r===0?0:r<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(a){return this._calendar.fromJD(a)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(a){return this._calendar.fromJSDate(a)},toString:function(){return(this.year()<0?"-":"")+y(Math.abs(this.year()),4)+"-"+y(this.month(),2)+"-"+y(this.day(),2)}}),p(e.prototype,{_validateLevel:0,newDate:function(a,r,m){return a==null?this.today():(a.year&&(this._validate(a,r,m,t.local.invalidDate||t.regionalOptions[""].invalidDate),m=a.day(),r=a.month(),a=a.year()),new b(this,a,r,m))},today:function(){return this.fromJSDate(new Date)},epoch:function(a){return this._validate(a,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(a){var r=this._validate(a,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear);return(r.year()<0?"-":"")+y(Math.abs(r.year()),4)},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),12},monthOfYear:function(a,r){var m=this._validate(a,r,this.minDay,t.local.invalidMonth||t.regionalOptions[""].invalidMonth);return(m.month()+this.monthsInYear(m)-this.firstMonth)%this.monthsInYear(m)+this.minMonth},fromMonthOfYear:function(a,r){var m=(r+this.firstMonth-2*this.minMonth)%this.monthsInYear(a)+this.minMonth;return this._validate(a,m,this.minDay,t.local.invalidMonth||t.regionalOptions[""].invalidMonth),m},daysInYear:function(a){var r=this._validate(a,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear);return this.leapYear(r)?366:365},dayOfYear:function(a,r,m){var o=this._validate(a,r,m,t.local.invalidDate||t.regionalOptions[""].invalidDate);return o.toJD()-this.newDate(o.year(),this.fromMonthOfYear(o.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(a,r,m){var o=this._validate(a,r,m,t.local.invalidDate||t.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(o))+2)%this.daysInWeek()},extraInfo:function(a,r,m){return this._validate(a,r,m,t.local.invalidDate||t.regionalOptions[""].invalidDate),{}},add:function(a,r,m){return this._validate(a,this.minMonth,this.minDay,t.local.invalidDate||t.regionalOptions[""].invalidDate),this._correctAdd(a,this._add(a,r,m),r,m)},_add:function(a,r,m){if(this._validateLevel++,m==="d"||m==="w"){var o=a.toJD()+r*(m==="w"?this.daysInWeek():1),i=a.calendar().fromJD(o);return this._validateLevel--,[i.year(),i.month(),i.day()]}try{var u=a.year()+(m==="y"?r:0),f=a.monthOfYear()+(m==="m"?r:0);i=a.day(),m==="y"?(a.month()!==this.fromMonthOfYear(u,f)&&(f=this.newDate(u,a.month(),this.minDay).monthOfYear()),f=Math.min(f,this.monthsInYear(u)),i=Math.min(i,this.daysInMonth(u,this.fromMonthOfYear(u,f)))):m==="m"&&(function(h){for(;f<h.minMonth;)u--,f+=h.monthsInYear(u);for(var d=h.monthsInYear(u);f>d-1+h.minMonth;)u++,f-=d,d=h.monthsInYear(u)}(this),i=Math.min(i,this.daysInMonth(u,this.fromMonthOfYear(u,f))));var l=[u,this.fromMonthOfYear(u,f),i];return this._validateLevel--,l}catch(h){throw this._validateLevel--,h}},_correctAdd:function(a,r,m,o){if(!(this.hasYearZero||o!=="y"&&o!=="m"||r[0]!==0&&a.year()>0==r[0]>0)){var i={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[o],u=m<0?-1:1;r=this._add(a,m*i[0]+u*i[1],i[2])}return a.date(r[0],r[1],r[2])},set:function(a,r,m){this._validate(a,this.minMonth,this.minDay,t.local.invalidDate||t.regionalOptions[""].invalidDate);var o=m==="y"?r:a.year(),i=m==="m"?r:a.month(),u=m==="d"?r:a.day();return m!=="y"&&m!=="m"||(u=Math.min(u,this.daysInMonth(o,i))),a.date(o,i,u)},isValid:function(a,r,m){this._validateLevel++;var o=this.hasYearZero||a!==0;if(o){var i=this.newDate(a,r,this.minDay);o=r>=this.minMonth&&r-this.minMonth<this.monthsInYear(i)&&m>=this.minDay&&m-this.minDay<this.daysInMonth(i)}return this._validateLevel--,o},toJSDate:function(a,r,m){var o=this._validate(a,r,m,t.local.invalidDate||t.regionalOptions[""].invalidDate);return t.instance().fromJD(this.toJD(o)).toJSDate()},fromJSDate:function(a){return this.fromJD(t.instance().fromJSDate(a).toJD())},_validate:function(a,r,m,o){if(a.year){if(this._validateLevel===0&&this.name!==a.calendar().name)throw(t.local.differentCalendars||t.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,a.calendar().local.name);return a}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(a,r,m))throw o.replace(/\{0\}/,this.local.name);var i=this.newDate(a,r,m);return this._validateLevel--,i}catch(u){throw this._validateLevel--,u}}}),n.prototype=new e,p(n.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var r=this._validate(a,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear);return(a=r.year()+(r.year()<0?1:0))%4==0&&(a%100!=0||a%400==0)},weekOfYear:function(a,r,m){var o=this.newDate(a,r,m);return o.add(4-(o.dayOfWeek()||7),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInMonth:function(a,r){var m=this._validate(a,r,this.minDay,t.local.invalidMonth||t.regionalOptions[""].invalidMonth);return this.daysPerMonth[m.month()-1]+(m.month()===2&&this.leapYear(m.year())?1:0)},weekDay:function(a,r,m){return(this.dayOfWeek(a,r,m)||7)<6},toJD:function(a,r,m){var o=this._validate(a,r,m,t.local.invalidDate||t.regionalOptions[""].invalidDate);a=o.year(),r=o.month(),m=o.day(),a<0&&a++,r<3&&(r+=12,a--);var i=Math.floor(a/100),u=2-i+Math.floor(i/4);return Math.floor(365.25*(a+4716))+Math.floor(30.6001*(r+1))+m+u-1524.5},fromJD:function(a){var r=Math.floor(a+.5),m=Math.floor((r-186721625e-2)/36524.25),o=(m=r+1+m-Math.floor(m/4))+1524,i=Math.floor((o-122.1)/365.25),u=Math.floor(365.25*i),f=Math.floor((o-u)/30.6001),l=o-u-Math.floor(30.6001*f),h=f-(f>13.5?13:1),d=i-(h>2.5?4716:4715);return d<=0&&d--,this.newDate(d,h,l)},toJSDate:function(a,r,m){var o=this._validate(a,r,m,t.local.invalidDate||t.regionalOptions[""].invalidDate),i=new Date(o.year(),o.month()-1,o.day());return i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),i.setHours(i.getHours()>12?i.getHours()+2:0),i},fromJSDate:function(a){return this.newDate(a.getFullYear(),a.getMonth()+1,a.getDate())}});var t=J.exports=new g;t.cdate=b,t.baseCalendar=e,t.calendars.gregorian=n},{"object-assign":247}],348:[function(v,J,Z){var p=v("object-assign"),g=v("./main");p(g.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),g.local=g.regionalOptions[""],p(g.cdate.prototype,{formatDate:function(b,y){return typeof b!="string"&&(y=b,b=""),this._calendar.formatDate(b||"",this,y)}}),p(g.baseCalendar.prototype,{UNIX_EPOCH:g.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:g.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(b,y,e){if(typeof b!="string"&&(e=y,y=b,b=""),!y)return"";if(y.calendar()!==this)throw g.local.invalidFormat||g.regionalOptions[""].invalidFormat;b=b||this.local.dateFormat;for(var n,t,a,r,m=(e=e||{}).dayNamesShort||this.local.dayNamesShort,o=e.dayNames||this.local.dayNames,i=e.monthNumbers||this.local.monthNumbers,u=e.monthNamesShort||this.local.monthNamesShort,f=e.monthNames||this.local.monthNames,l=(e.calculateWeek||this.local.calculateWeek,function(L,A){for(var I=1;k+I<b.length&&b.charAt(k+I)===L;)I++;return k+=I-1,Math.floor(I/(A||1))>1}),h=function(L,A,I,P){var S=""+A;if(l(L,P))for(;S.length<I;)S="0"+S;return S},d=this,s=function(L){return typeof i=="function"?i.call(d,L,l("m")):T(h("m",L.month(),2))},x=function(L,A){return A?typeof f=="function"?f.call(d,L):f[L.month()-d.minMonth]:typeof u=="function"?u.call(d,L):u[L.month()-d.minMonth]},c=this.local.digits,T=function(L){return e.localNumbers&&c?c(L):L},_="",w=!1,k=0;k<b.length;k++)if(w)b.charAt(k)!=="'"||l("'")?_+=b.charAt(k):w=!1;else switch(b.charAt(k)){case"d":_+=T(h("d",y.day(),2));break;case"D":_+=(n="D",t=y.dayOfWeek(),a=m,r=o,l(n)?r[t]:a[t]);break;case"o":_+=h("o",y.dayOfYear(),3);break;case"w":_+=h("w",y.weekOfYear(),2);break;case"m":_+=s(y);break;case"M":_+=x(y,l("M"));break;case"y":_+=l("y",2)?y.year():(y.year()%100<10?"0":"")+y.year()%100;break;case"Y":l("Y",2),_+=y.formatYear();break;case"J":_+=y.toJD();break;case"@":_+=(y.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":_+=(y.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":l("'")?_+="'":w=!0;break;default:_+=b.charAt(k)}return _},parseDate:function(b,y,e){if(y==null)throw g.local.invalidArguments||g.regionalOptions[""].invalidArguments;if((y=typeof y=="object"?y.toString():y+"")==="")return null;b=b||this.local.dateFormat;var n=(e=e||{}).shortYearCutoff||this.shortYearCutoff;n=typeof n!="string"?n:this.today().year()%100+parseInt(n,10);for(var t=e.dayNamesShort||this.local.dayNamesShort,a=e.dayNames||this.local.dayNames,r=e.parseMonth||this.local.parseMonth,m=e.monthNumbers||this.local.monthNumbers,o=e.monthNamesShort||this.local.monthNamesShort,i=e.monthNames||this.local.monthNames,u=-1,f=-1,l=-1,h=-1,d=-1,s=!1,x=!1,c=function(D,R){for(var H=1;P+H<b.length&&b.charAt(P+H)===D;)H++;return P+=H-1,Math.floor(H/(R||1))>1},T=function(D,R){var H=c(D,R),V=[2,3,H?4:2,H?4:2,10,11,20]["oyYJ@!".indexOf(D)+1],X=new RegExp("^-?\\d{1,"+V+"}"),$=y.substring(I).match(X);if(!$)throw(g.local.missingNumberAt||g.regionalOptions[""].missingNumberAt).replace(/\{0\}/,I);return I+=$[0].length,parseInt($[0],10)},_=this,w=function(){if(typeof m=="function"){c("m");var D=m.call(_,y.substring(I));return I+=D.length,D}return T("m")},k=function(D,R,H,V){for(var X=c(D,V)?H:R,$=0;$<X.length;$++)if(y.substr(I,X[$].length).toLowerCase()===X[$].toLowerCase())return I+=X[$].length,$+_.minMonth;throw(g.local.unknownNameAt||g.regionalOptions[""].unknownNameAt).replace(/\{0\}/,I)},L=function(){if(typeof i=="function"){var D=c("M")?i.call(_,y.substring(I)):o.call(_,y.substring(I));return I+=D.length,D}return k("M",o,i)},A=function(){if(y.charAt(I)!==b.charAt(P))throw(g.local.unexpectedLiteralAt||g.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,I);I++},I=0,P=0;P<b.length;P++)if(x)b.charAt(P)!=="'"||c("'")?A():x=!1;else switch(b.charAt(P)){case"d":h=T("d");break;case"D":k("D",t,a);break;case"o":d=T("o");break;case"w":T("w");break;case"m":l=w();break;case"M":l=L();break;case"y":var S=P;s=!c("y",2),P=S,f=T("y",2);break;case"Y":f=T("Y",2);break;case"J":u=T("J")+.5,y.charAt(I)==="."&&(I++,T("J"));break;case"@":u=T("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":u=T("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":I=y.length;break;case"'":c("'")?A():x=!0;break;default:A()}if(I<y.length)throw g.local.unexpectedText||g.regionalOptions[""].unexpectedText;if(f===-1?f=this.today().year():f<100&&s&&(f+=n===-1?1900:this.today().year()-this.today().year()%100-(f<=n?0:100)),typeof l=="string"&&(l=r.call(this,f,l)),d>-1){l=1,h=d;for(var E=this.daysInMonth(f,l);h>E;E=this.daysInMonth(f,l))l++,h-=E}return u>-1?this.fromJD(u):this.newDate(f,l,h)},determineDate:function(b,y,e,n,t){e&&typeof e!="object"&&(t=n,n=e,e=null),typeof n!="string"&&(t=n,n="");var a=this;return y=y?y.newDate():null,b=b==null?y:typeof b=="string"?function(r){try{return a.parseDate(n,r,t)}catch{}for(var m=((r=r.toLowerCase()).match(/^c/)&&e?e.newDate():null)||a.today(),o=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,i=o.exec(r);i;)m.add(parseInt(i[1],10),i[2]||"d"),i=o.exec(r);return m}(b):typeof b=="number"?isNaN(b)||b===1/0||b===-1/0?y:a.today().add(b,"d"):a.newDate(b)}})},{"./main":347,"object-assign":247}],349:[function(v,J,Z){J.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],350:[function(v,J,Z){var p=v("./arrow_paths"),g=v("../../plots/font_attributes"),b=v("../../plots/cartesian/constants"),y=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),J.exports=y("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:g({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:p.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:p.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",b.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",b.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",b.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",b.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:g({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/font_attributes":594,"./arrow_paths":349}],351:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes"),b=v("./draw").draw;function y(n){var t=n._fullLayout;p.filterVisible(t.annotations).forEach(function(a){var r=g.getFromId(n,a.xref),m=g.getFromId(n,a.yref),o=g.getRefType(a.xref),i=g.getRefType(a.yref);a._extremes={},o==="range"&&e(a,r),i==="range"&&e(a,m)})}function e(n,t){var a,r=t._id,m=r.charAt(0),o=n[m],i=n["a"+m],u=n[m+"ref"],f=n["a"+m+"ref"],l=n["_"+m+"padplus"],h=n["_"+m+"padminus"],d={x:1,y:-1}[m]*n[m+"shift"],s=3*n.arrowsize*n.arrowwidth||0,x=s+d,c=s-d,T=3*n.startarrowsize*n.arrowwidth||0,_=T+d,w=T-d;if(f===u){var k=g.findExtremes(t,[t.r2c(o)],{ppadplus:x,ppadminus:c}),L=g.findExtremes(t,[t.r2c(i)],{ppadplus:Math.max(l,_),ppadminus:Math.max(h,w)});a={min:[k.min[0],L.min[0]],max:[k.max[0],L.max[0]]}}else _=i?_+i:_,w=i?w-i:w,a=g.findExtremes(t,[t.r2c(o)],{ppadplus:Math.max(l,x,_),ppadminus:Math.max(h,c,w)});n._extremes[r]=a}J.exports=function(n){var t=n._fullLayout;if(p.filterVisible(t.annotations).length&&n._fullData.length)return p.syncOrAsync([b,y],n)}},{"../../lib":515,"../../plots/cartesian/axes":566,"./draw":356}],352:[function(v,J,Z){var p=v("../../lib"),g=v("../../registry"),b=v("../../plot_api/plot_template").arrayEditor;function y(n,t){var a,r,m,o,i,u,f,l=n._fullLayout.annotations,h=[],d=[],s=[],x=(t||[]).length;for(a=0;a<l.length;a++)if(o=(m=l[a]).clicktoshow){for(r=0;r<x;r++)if(u=(i=t[r]).xaxis,f=i.yaxis,u._id===m.xref&&f._id===m.yref&&u.d2r(i.x)===e(m._xclick,u)&&f.d2r(i.y)===e(m._yclick,f)){(m.visible?o==="onout"?d:s:h).push(a);break}r===x&&m.visible&&o==="onout"&&d.push(a)}return{on:h,off:d,explicitOff:s}}function e(n,t){return t.type==="log"?t.l2r(n):t.d2r(n)}J.exports={hasClickToShow:function(n,t){var a=y(n,t);return a.on.length>0||a.explicitOff.length>0},onClick:function(n,t){var a,r,m=y(n,t),o=m.on,i=m.off.concat(m.explicitOff),u={},f=n._fullLayout.annotations;if(!(!o.length&&!i.length)){for(a=0;a<o.length;a++)(r=b(n.layout,"annotations",f[o[a]])).modifyItem("visible",!0),p.extendFlat(u,r.getUpdateObj());for(a=0;a<i.length;a++)(r=b(n.layout,"annotations",f[i[a]])).modifyItem("visible",!1),p.extendFlat(u,r.getUpdateObj());return g.call("update",n,{},u)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647}],353:[function(v,J,Z){var p=v("../../lib"),g=v("../color");J.exports=function(b,y,e,n){n("opacity");var t=n("bgcolor"),a=n("bordercolor"),r=g.opacity(a);n("borderpad");var m=n("borderwidth"),o=n("showarrow");if(n("text",o?" ":e._dfltTitle.annotation),n("textangle"),p.coerceFont(n,"font",e.font),n("width"),n("align"),n("height")&&n("valign"),o){var i,u,f=n("arrowside");f.indexOf("end")!==-1&&(i=n("arrowhead"),u=n("arrowsize")),f.indexOf("start")!==-1&&(n("startarrowhead",i),n("startarrowsize",u)),n("arrowcolor",r?y.bordercolor:g.defaultLine),n("arrowwidth",2*(r&&m||1)),n("standoff"),n("startstandoff")}var l=n("hovertext"),h=e.hoverlabel||{};if(l){var d=n("hoverlabel.bgcolor",h.bgcolor||(g.opacity(t)?g.rgb(t):g.defaultLine)),s=n("hoverlabel.bordercolor",h.bordercolor||g.contrast(d));p.coerceFont(n,"hoverlabel.font",{family:h.font.family,size:h.font.size,color:h.font.color||s})}n("captureevents",!!l)}},{"../../lib":515,"../color":367}],354:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib/to_log_range");J.exports=function(b,y,e,n){y=y||{};var t=e==="log"&&y.type==="linear",a=e==="linear"&&y.type==="log";if(t||a)for(var r,m,o=b._fullLayout.annotations,i=y._id.charAt(0),u=0;u<o.length;u++)r=o[u],m="annotations["+u+"].",r[i+"ref"]===y._id&&f(i),r["a"+i+"ref"]===y._id&&f("a"+i);function f(l){var h=r[l],d=null;d=t?g(h,y.range):Math.pow(10,h),p(d)||(d=null),n(m+l,d)}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],355:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes"),b=v("../../plots/array_container_defaults"),y=v("./common_defaults"),e=v("./attributes");function n(t,a,r){function m(L,A){return p.coerce(t,a,e,L,A)}var o=m("visible"),i=m("clicktoshow");if(o||i){y(t,a,r,m);for(var u=a.showarrow,f=["x","y"],l=[-10,-30],h={_fullLayout:r},d=0;d<2;d++){var s=f[d],x=g.coerceRef(t,a,h,s,"","paper");if(x!=="paper"&&g.getFromId(h,x)._annIndices.push(a._index),g.coercePosition(a,h,m,x,s,.5),u){var c="a"+s,T=g.coerceRef(t,a,h,c,"pixel",["pixel","paper"]);T!=="pixel"&&T!==x&&(T=a[c]="pixel");var _=T==="pixel"?l[d]:.4;g.coercePosition(a,h,m,T,c,_)}m(s+"anchor"),m(s+"shift")}if(p.noneOrAll(t,a,["x","y"]),u&&p.noneOrAll(t,a,["ax","ay"]),i){var w=m("xclick"),k=m("yclick");a._xclick=w===void 0?a.x:g.cleanPosition(w,h,a.xref),a._yclick=k===void 0?a.y:g.cleanPosition(k,h,a.yref)}}}J.exports=function(t,a){b(t,a,{name:"annotations",handleItemDefaults:n})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":350,"./common_defaults":353}],356:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../registry"),b=v("../../plots/plots"),y=v("../../lib"),e=y.strTranslate,n=v("../../plots/cartesian/axes"),t=v("../color"),a=v("../drawing"),r=v("../fx"),m=v("../../lib/svg_text_utils"),o=v("../../lib/setcursor"),i=v("../dragelement"),u=v("../../plot_api/plot_template").arrayEditor,f=v("./draw_arrow_head");function l(s,x){var c=s._fullLayout.annotations[x]||{},T=n.getFromId(s,c.xref),_=n.getFromId(s,c.yref);T&&T.setScale(),_&&_.setScale(),d(s,c,x,!1,T,_)}function h(s,x,c,T,_){var w=_[c],k=_[c+"ref"],L=c.indexOf("y")!==-1,A=n.getRefType(k)==="domain",I=L?T.h:T.w;return s?A?w+(L?-x:x)/s._length:s.p2r(s.r2p(w)+x):w+(L?-x:x)/I}function d(s,x,c,T,_,w){var k,L,A=s._fullLayout,I=s._fullLayout._size,P=s._context.edits;T?(k="annotation-"+T,L=T+".annotations"):(k="annotation",L="annotations");var S=u(s.layout,L,x),E=S.modifyBase,D=S.modifyItem,R=S.getUpdateObj;A._infolayer.selectAll("."+k+'[data-index="'+c+'"]').remove();var H="clip"+A._uid+"_ann"+c;if(x._input&&x.visible!==!1){var V={x:{},y:{}},X=+x.textangle||0,$=A._infolayer.append("g").classed(k,!0).attr("data-index",String(c)).style("opacity",x.opacity),G=$.append("g").classed("annotation-text-g",!0),W=P[x.showarrow?"annotationTail":"annotationPosition"],te=x.captureevents||P.annotationText||W,N=G.append("g").style("pointer-events",te?"all":null).call(o,"pointer").on("click",function(){s._dragging=!1,s.emit("plotly_clickannotation",oe(p.event))});x.hovertext&&N.on("mouseover",function(){var me=x.hoverlabel,Te=me.font,_e=this.getBoundingClientRect(),be=s.getBoundingClientRect();r.loneHover({x0:_e.left-be.left,x1:_e.right-be.left,y:(_e.top+_e.bottom)/2-be.top,text:x.hovertext,color:me.bgcolor,borderColor:me.bordercolor,fontFamily:Te.family,fontSize:Te.size,fontColor:Te.color},{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:s})}).on("mouseout",function(){r.loneUnhover(A._hoverlayer.node())});var B=x.borderwidth,U=x.borderpad,ee=B+U,j=N.append("rect").attr("class","bg").style("stroke-width",B+"px").call(t.stroke,x.bordercolor).call(t.fill,x.bgcolor),Q=x.width||x.height,K=A._topclips.selectAll("#"+H).data(Q?[0]:[]);K.enter().append("clipPath").classed("annclip",!0).attr("id",H).append("rect"),K.exit().remove();var re=x.font,ne=A._meta?y.templateString(x.text,A._meta):x.text,le=N.append("text").classed("annotation-text",!0).text(ne);P.annotationText?le.call(m.makeEditable,{delegate:N,gd:s}).call(de).on("edit",function(me){x.text=me,this.call(de),D("text",me),_&&_.autorange&&E(_._name+".autorange",!0),w&&w.autorange&&E(w._name+".autorange",!0),g.call("_guiRelayout",s,R())}):le.call(de)}else p.selectAll("#"+H).remove();function oe(me){var Te={index:c,annotation:x._input,fullAnnotation:x,event:me};return T&&(Te.subplotId=T),Te}function de(me){return me.call(a.font,re).attr({"text-anchor":{left:"start",right:"end"}[x.align]||"middle"}),m.convertToTspans(me,s,se),me}function se(){var me=le.selectAll("a");me.size()===1&&me.text()===le.text()&&N.insert("a",":first-child").attr({"xlink:xlink:href":me.attr("xlink:href"),"xlink:xlink:show":me.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(j.node());var Te=N.select(".annotation-text-math-group"),_e=!Te.empty(),be=a.bBox((_e?Te:le).node()),Ce=be.width,fe=be.height,ve=x.width||Ce,Me=x.height||fe,ke=Math.round(ve+2*ee),Le=Math.round(Me+2*ee);function ze(rt,ut){return ut==="auto"&&(ut=rt<1/3?"left":rt>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[ut]}for(var Re=!1,Oe=["x","y"],Ze=0;Ze<Oe.length;Ze++){var Pe,Ie,Be,Fe,$e,ot=Oe[Ze],pt=x[ot+"ref"]||ot,_t=x["a"+ot+"ref"],yt={x:_,y:w}[ot],tt=(X+(ot==="x"?0:-90))*Math.PI/180,Ke=ke*Math.cos(tt),vt=Le*Math.sin(tt),Nt=Math.abs(Ke)+Math.abs(vt),qt=x[ot+"anchor"],er=x[ot+"shift"]*(ot==="x"?1:-1),Jt=V[ot],ir=n.getRefType(pt);if(yt&&ir!=="domain"){var Ht=yt.r2fraction(x[ot]);(Ht<0||Ht>1)&&(_t===pt?((Ht=yt.r2fraction(x["a"+ot]))<0||Ht>1)&&(Re=!0):Re=!0),Pe=yt._offset+yt.r2p(x[ot]),Fe=.5}else{var Ue=ir==="domain";ot==="x"?(Be=x[ot],Pe=Ue?yt._offset+yt._length*Be:Pe=I.l+I.w*Be):(Be=1-x[ot],Pe=Ue?yt._offset+yt._length*Be:Pe=I.t+I.h*Be),Fe=x.showarrow?.5:Be}if(x.showarrow){Jt.head=Pe;var We=x["a"+ot];if($e=Ke*ze(.5,x.xanchor)-vt*ze(.5,x.yanchor),_t===pt){var he=n.getRefType(_t);he==="domain"?(ot==="y"&&(We=1-We),Jt.tail=yt._offset+yt._length*We):he==="paper"?ot==="y"?(We=1-We,Jt.tail=I.t+I.h*We):Jt.tail=I.l+I.w*We:Jt.tail=yt._offset+yt.r2p(We),Ie=$e}else Jt.tail=Pe+We,Ie=$e+We;Jt.text=Jt.tail+$e;var xe=A[ot==="x"?"width":"height"];if(pt==="paper"&&(Jt.head=y.constrain(Jt.head,1,xe-1)),_t==="pixel"){var De=-Math.max(Jt.tail-3,Jt.text),qe=Math.min(Jt.tail+3,Jt.text)-xe;De>0?(Jt.tail+=De,Jt.text+=De):qe>0&&(Jt.tail-=qe,Jt.text-=qe)}Jt.tail+=er,Jt.head+=er}else Ie=$e=Nt*ze(Fe,qt),Jt.text=Pe+$e;Jt.text+=er,$e+=er,Ie+=er,x["_"+ot+"padplus"]=Nt/2+Ie,x["_"+ot+"padminus"]=Nt/2-Ie,x["_"+ot+"size"]=Nt,x["_"+ot+"shift"]=$e}if(Re)N.remove();else{var Xe=0,He=0;if(x.align!=="left"&&(Xe=(ve-Ce)*(x.align==="center"?.5:1)),x.valign!=="top"&&(He=(Me-fe)*(x.valign==="middle"?.5:1)),_e)Te.select("svg").attr({x:ee+Xe-1,y:ee+He}).call(a.setClipUrl,Q?H:null,s);else{var st=ee+He-be.top,it=ee+Xe-be.left;le.call(m.positionText,it,st).call(a.setClipUrl,Q?H:null,s)}K.select("rect").call(a.setRect,ee,ee,ve,Me),j.call(a.setRect,B/2,B/2,ke-B,Le-B),N.call(a.setTranslate,Math.round(V.x.text-ke/2),Math.round(V.y.text-Le/2)),G.attr({transform:"rotate("+X+","+V.x.text+","+V.y.text+")"});var Tt,Pt=function(rt,ut){$.selectAll(".annotation-arrow-g").remove();var Ft=V.x.head,wt=V.y.head,Lt=V.x.tail+rt,Ae=V.y.tail+ut,Ye=V.x.text+rt,nt=V.y.text+ut,ft=y.rotationXYMatrix(X,Ye,nt),Mt=y.apply2DTransform(ft),Rt=y.apply2DTransform2(ft),Gt=+j.attr("width"),jt=+j.attr("height"),pr=Ye-.5*Gt,Ar=pr+Gt,fr=nt-.5*jt,Zt=fr+jt,Qt=[[pr,fr,pr,Zt],[pr,Zt,Ar,Zt],[Ar,Zt,Ar,fr],[Ar,fr,pr,fr]].map(Rt);if(!Qt.reduce(function(gn,Sn){return gn^!!y.segmentsIntersect(Ft,wt,Ft+1e6,wt+1e6,Sn[0],Sn[1],Sn[2],Sn[3])},!1)){Qt.forEach(function(gn){var Sn=y.segmentsIntersect(Lt,Ae,Ft,wt,gn[0],gn[1],gn[2],gn[3]);Sn&&(Lt=Sn.x,Ae=Sn.y)});var $t=x.arrowwidth,hr=x.arrowcolor,vr=x.arrowside,Mr=$.append("g").style({opacity:t.opacity(hr)}).classed("annotation-arrow-g",!0),Nr=Mr.append("path").attr("d","M"+Lt+","+Ae+"L"+Ft+","+wt).style("stroke-width",$t+"px").call(t.stroke,t.rgb(hr));if(f(Nr,vr,x),P.annotationPosition&&Nr.node().parentNode&&!T){var Ur=Ft,Jr=wt;if(x.standoff){var mn=Math.sqrt(Math.pow(Ft-Lt,2)+Math.pow(wt-Ae,2));Ur+=x.standoff*(Lt-Ft)/mn,Jr+=x.standoff*(Ae-wt)/mn}var en,In,vn=Mr.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(Lt-Ur)+","+(Ae-Jr),transform:e(Ur,Jr)}).style("stroke-width",$t+6+"px").call(t.stroke,"rgba(0,0,0,0)").call(t.fill,"rgba(0,0,0,0)");i.init({element:vn.node(),gd:s,prepFn:function(){var gn=a.getTranslate(N);en=gn.x,In=gn.y,_&&_.autorange&&E(_._name+".autorange",!0),w&&w.autorange&&E(w._name+".autorange",!0)},moveFn:function(gn,Sn){var Xn=Mt(en,In),Br=Xn[0]+gn,pn=Xn[1]+Sn;N.call(a.setTranslate,Br,pn),D("x",h(_,gn,"x",I,x)),D("y",h(w,Sn,"y",I,x)),x.axref===x.xref&&D("ax",h(_,gn,"ax",I,x)),x.ayref===x.yref&&D("ay",h(w,Sn,"ay",I,x)),Mr.attr("transform",e(gn,Sn)),G.attr({transform:"rotate("+X+","+Br+","+pn+")"})},doneFn:function(){g.call("_guiRelayout",s,R());var gn=document.querySelector(".js-notes-box-panel");gn&&gn.redraw(gn.selectedObj)}})}}};x.showarrow&&Pt(0,0),W&&i.init({element:N.node(),gd:s,prepFn:function(){Tt=G.attr("transform")},moveFn:function(rt,ut){var Ft="pointer";if(x.showarrow)x.axref===x.xref?D("ax",h(_,rt,"ax",I,x)):D("ax",x.ax+rt),x.ayref===x.yref?D("ay",h(w,ut,"ay",I.w,x)):D("ay",x.ay+ut),Pt(rt,ut);else{if(T)return;var wt,Lt;if(_)wt=h(_,rt,"x",I,x);else{var Ae=x._xsize/I.w,Ye=x.x+(x._xshift-x.xshift)/I.w-Ae/2;wt=i.align(Ye+rt/I.w,Ae,0,1,x.xanchor)}if(w)Lt=h(w,ut,"y",I,x);else{var nt=x._ysize/I.h,ft=x.y-(x._yshift+x.yshift)/I.h-nt/2;Lt=i.align(ft-ut/I.h,nt,0,1,x.yanchor)}D("x",wt),D("y",Lt),_&&w||(Ft=i.getCursor(_?.5:wt,w?.5:Lt,x.xanchor,x.yanchor))}G.attr({transform:e(rt,ut)+Tt}),o(N,Ft)},clickFn:function(rt,ut){x.captureevents&&s.emit("plotly_clickannotation",oe(ut))},doneFn:function(){o(N),g.call("_guiRelayout",s,R());var rt=document.querySelector(".js-notes-box-panel");rt&&rt.redraw(rt.selectedObj)}})}}}J.exports={draw:function(s){var x=s._fullLayout;x._infolayer.selectAll(".annotation").remove();for(var c=0;c<x.annotations.length;c++)x.annotations[c].visible&&l(s,c);return b.previousPromises(s)},drawOne:l,drawRaw:d}},{"../../lib":515,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../fx":407,"./draw_arrow_head":357,"@plotly/d3":58}],357:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../color"),b=v("./arrow_paths"),y=v("../../lib"),e=y.strScale,n=y.strRotate,t=y.strTranslate;J.exports=function(a,r,m){var o,i,u,f,l=a.node(),h=b[m.arrowhead||0],d=b[m.startarrowhead||0],s=(m.arrowwidth||1)*(m.arrowsize||1),x=(m.arrowwidth||1)*(m.startarrowsize||1),c=r.indexOf("start")>=0,T=r.indexOf("end")>=0,_=h.backoff*s+m.standoff,w=d.backoff*x+m.startstandoff;if(l.nodeName==="line"){o={x:+a.attr("x1"),y:+a.attr("y1")},i={x:+a.attr("x2"),y:+a.attr("y2")};var k=o.x-i.x,L=o.y-i.y;if(f=(u=Math.atan2(L,k))+Math.PI,_&&w&&_+w>Math.sqrt(k*k+L*L))return void $();if(_){if(_*_>k*k+L*L)return void $();var A=_*Math.cos(u),I=_*Math.sin(u);i.x+=A,i.y+=I,a.attr({x2:i.x,y2:i.y})}if(w){if(w*w>k*k+L*L)return void $();var P=w*Math.cos(u),S=w*Math.sin(u);o.x-=P,o.y-=S,a.attr({x1:o.x,y1:o.y})}}else if(l.nodeName==="path"){var E=l.getTotalLength(),D="";if(E<_+w)return void $();var R=l.getPointAtLength(0),H=l.getPointAtLength(.1);u=Math.atan2(R.y-H.y,R.x-H.x),o=l.getPointAtLength(Math.min(w,E)),D="0px,"+w+"px,";var V=l.getPointAtLength(E),X=l.getPointAtLength(E-.1);f=Math.atan2(V.y-X.y,V.x-X.x),i=l.getPointAtLength(Math.max(0,E-_)),D+=E-(D?w+_:_)+"px,"+E+"px",a.style("stroke-dasharray",D)}function $(){a.style("stroke-dasharray","0px,100px")}function G(W,te,N,B){W.path&&(W.noRotate&&(N=0),p.select(l.parentNode).append("path").attr({class:a.attr("class"),d:W.path,transform:t(te.x,te.y)+n(180*N/Math.PI)+e(B)}).style({fill:g.rgb(m.arrowcolor),"stroke-width":0}))}c&&G(d,o,u,x),T&&G(h,i,f,s)}},{"../../lib":515,"../color":367,"./arrow_paths":349,"@plotly/d3":58}],358:[function(v,J,Z){var p=v("./draw"),g=v("./click");J.exports={moduleType:"component",name:"annotations",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("annotations"),calcAutorange:v("./calc_autorange"),draw:p.draw,drawOne:p.drawOne,drawRaw:p.drawRaw,hasClickToShow:g.hasClickToShow,onClick:g.onClick,convertCoords:v("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":350,"./calc_autorange":351,"./click":352,"./convert_coords":354,"./defaults":355,"./draw":356}],359:[function(v,J,Z){var p=v("../annotations/attributes"),g=v("../../plot_api/edit_types").overrideAll,b=v("../../plot_api/plot_template").templatedArray;J.exports=g(b("annotation",{visible:p.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:p.xanchor,xshift:p.xshift,yanchor:p.yanchor,yshift:p.yshift,text:p.text,textangle:p.textangle,font:p.font,width:p.width,height:p.height,opacity:p.opacity,align:p.align,valign:p.valign,bgcolor:p.bgcolor,bordercolor:p.bordercolor,borderpad:p.borderpad,borderwidth:p.borderwidth,showarrow:p.showarrow,arrowcolor:p.arrowcolor,arrowhead:p.arrowhead,startarrowhead:p.startarrowhead,arrowside:p.arrowside,arrowsize:p.arrowsize,startarrowsize:p.startarrowsize,arrowwidth:p.arrowwidth,standoff:p.standoff,startstandoff:p.startstandoff,hovertext:p.hovertext,hoverlabel:p.hoverlabel,captureevents:p.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../annotations/attributes":350}],360:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes");function b(y,e){var n=e.fullSceneLayout.domain,t=e.fullLayout._size,a={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};y._xa={},p.extendFlat(y._xa,a),g.setConvert(y._xa),y._xa._offset=t.l+n.x[0]*t.w,y._xa.l2p=function(){return .5*(1+y._pdata[0]/y._pdata[3])*t.w*(n.x[1]-n.x[0])},y._ya={},p.extendFlat(y._ya,a),g.setConvert(y._ya),y._ya._offset=t.t+(1-n.y[1])*t.h,y._ya.l2p=function(){return .5*(1-y._pdata[1]/y._pdata[3])*t.h*(n.y[1]-n.y[0])}}J.exports=function(y){for(var e=y.fullSceneLayout.annotations,n=0;n<e.length;n++)b(e[n],y);y.fullLayout._infolayer.selectAll(".annotation-"+y.id).remove()}},{"../../lib":515,"../../plots/cartesian/axes":566}],361:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes"),b=v("../../plots/array_container_defaults"),y=v("../annotations/common_defaults"),e=v("./attributes");function n(t,a,r,m){function o(u,f){return p.coerce(t,a,e,u,f)}function i(u){var f=u+"axis",l={_fullLayout:{}};return l._fullLayout[f]=r[f],g.coercePosition(a,l,o,u,u,.5)}o("visible")&&(y(t,a,m.fullLayout,o),i("x"),i("y"),i("z"),p.noneOrAll(t,a,["x","y","z"]),a.xref="x",a.yref="y",a.zref="z",o("xanchor"),o("yanchor"),o("xshift"),o("yshift"),a.showarrow&&(a.axref="pixel",a.ayref="pixel",o("ax",-10),o("ay",-30),p.noneOrAll(t,a,["ax","ay"])))}J.exports=function(t,a,r){b(t,a,{name:"annotations",handleItemDefaults:n,fullLayout:r.fullLayout})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../annotations/common_defaults":353,"./attributes":359}],362:[function(v,J,Z){var p=v("../annotations/draw").drawRaw,g=v("../../plots/gl3d/project"),b=["x","y","z"];J.exports=function(y){for(var e=y.fullSceneLayout,n=y.dataScale,t=e.annotations,a=0;a<t.length;a++){for(var r=t[a],m=!1,o=0;o<3;o++){var i=b[o],u=r[i],f=e[i+"axis"].r2fraction(u);if(f<0||f>1){m=!0;break}}m?y.fullLayout._infolayer.select(".annotation-"+y.id+'[data-index="'+a+'"]').remove():(r._pdata=g(y.glplot.cameraParams,[e.xaxis.r2l(r.x)*n[0],e.yaxis.r2l(r.y)*n[1],e.zaxis.r2l(r.z)*n[2]]),p(y.graphDiv,r,a,y.id,r._xa,r._ya))}}},{"../../plots/gl3d/project":616,"../annotations/draw":356}],363:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib");J.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:v("./attributes")}}},layoutAttributes:v("./attributes"),handleDefaults:v("./defaults"),includeBasePlot:function(b,y){var e=p.subplotsRegistry.gl3d;if(!!e)for(var n=e.attrRegex,t=Object.keys(b),a=0;a<t.length;a++){var r=t[a];n.test(r)&&(b[r].annotations||[]).length&&(g.pushUnique(y._basePlotModules,e),g.pushUnique(y._subplots.gl3d,r))}},convert:v("./convert"),draw:v("./draw")}},{"../../lib":515,"../../registry":647,"./attributes":359,"./convert":360,"./defaults":361,"./draw":362}],364:[function(v,J,Z){J.exports=v("world-calendars/dist/main"),v("world-calendars/dist/plus"),v("world-calendars/dist/calendars/chinese"),v("world-calendars/dist/calendars/coptic"),v("world-calendars/dist/calendars/discworld"),v("world-calendars/dist/calendars/ethiopian"),v("world-calendars/dist/calendars/hebrew"),v("world-calendars/dist/calendars/islamic"),v("world-calendars/dist/calendars/julian"),v("world-calendars/dist/calendars/mayan"),v("world-calendars/dist/calendars/nanakshahi"),v("world-calendars/dist/calendars/nepali"),v("world-calendars/dist/calendars/persian"),v("world-calendars/dist/calendars/taiwan"),v("world-calendars/dist/calendars/thai"),v("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":333,"world-calendars/dist/calendars/coptic":334,"world-calendars/dist/calendars/discworld":335,"world-calendars/dist/calendars/ethiopian":336,"world-calendars/dist/calendars/hebrew":337,"world-calendars/dist/calendars/islamic":338,"world-calendars/dist/calendars/julian":339,"world-calendars/dist/calendars/mayan":340,"world-calendars/dist/calendars/nanakshahi":341,"world-calendars/dist/calendars/nepali":342,"world-calendars/dist/calendars/persian":343,"world-calendars/dist/calendars/taiwan":344,"world-calendars/dist/calendars/thai":345,"world-calendars/dist/calendars/ummalqura":346,"world-calendars/dist/main":347,"world-calendars/dist/plus":348}],365:[function(v,J,Z){var p=v("./calendars"),g=v("../../lib"),b=v("../../constants/numerical"),y=b.EPOCHJD,e=b.ONEDAY,n={valType:"enumerated",values:g.sortObjectKeys(p.calendars),editType:"calc",dflt:"gregorian"},t=function(d,s,x,c){var T={};return T[x]=n,g.coerce(d,s,T,x,c)},a={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},r={};function m(d){var s=r[d];return s||(s=r[d]=p.instance(d))}function o(d){return g.extendFlat({},n,{description:d})}function i(d){return"Sets the calendar system to use with `"+d+"` date data."}var u={xcalendar:o(i("x"))},f=g.extendFlat({},u,{ycalendar:o(i("y"))}),l=g.extendFlat({},f,{zcalendar:o(i("z"))}),h=o(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));J.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:f,bar:f,box:f,heatmap:f,contour:f,histogram:f,histogram2d:f,histogram2dcontour:f,scatter3d:l,surface:l,mesh3d:l,scattergl:f,ohlc:u,candlestick:u},layout:{calendar:o(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:h},yaxis:{calendar:h},scene:{xaxis:{calendar:h},yaxis:{calendar:h},zaxis:{calendar:h}},polar:{radialaxis:{calendar:h}}},transforms:{filter:{valuecalendar:o(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:o(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:n,handleDefaults:t,handleTraceDefaults:function(d,s,x,c){for(var T=0;T<x.length;T++)t(d,s,x[T]+"calendar",c.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:m,worldCalFmt:function(d,s,x){for(var c,T,_,w,k,L=Math.floor((s+.05)/e)+y,A=m(x).fromJD(L),I=0;(I=d.indexOf("%",I))!==-1;)(c=d.charAt(I+1))==="0"||c==="-"||c==="_"?(_=3,T=d.charAt(I+2),c==="_"&&(c="-")):(T=c,c="0",_=2),(w=a[T])?(k=w==="##"?"##":A.formatDate(w[c]),d=d.substr(0,I)+k+d.substr(I+_),I+=k.length):I+=_;return d}}},{"../../constants/numerical":491,"../../lib":515,"./calendars":364}],366:[function(v,J,Z){Z.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Z.defaultLine="#444",Z.lightLine="#eee",Z.background="#fff",Z.borderLine="#BEC8D9",Z.lightFraction=1e3/11},{}],367:[function(v,J,Z){var p=v("tinycolor2"),g=v("fast-isnumeric"),b=v("../../lib/array").isTypedArray,y=J.exports={},e=v("./attributes");y.defaults=e.defaults;var n=y.defaultLine=e.defaultLine;y.lightLine=e.lightLine;var t=y.background=e.background;function a(r){if(g(r)||typeof r!="string")return r;var m=r.trim();if(m.substr(0,3)!=="rgb")return r;var o=m.match(/^rgba?\s*\(([^()]*)\)$/);if(!o)return r;var i=o[1].trim().split(/\s*[\s,]\s*/),u=m.charAt(3)==="a"&&i.length===4;if(!u&&i.length!==3)return r;for(var f=0;f<i.length;f++){if(!i[f].length||(i[f]=Number(i[f]),!(i[f]>=0)))return r;if(f===3)i[f]>1&&(i[f]=1);else if(i[f]>=1)return r}var l=Math.round(255*i[0])+", "+Math.round(255*i[1])+", "+Math.round(255*i[2]);return u?"rgba("+l+", "+i[3]+")":"rgb("+l+")"}y.tinyRGB=function(r){var m=r.toRgb();return"rgb("+Math.round(m.r)+", "+Math.round(m.g)+", "+Math.round(m.b)+")"},y.rgb=function(r){return y.tinyRGB(p(r))},y.opacity=function(r){return r?p(r).getAlpha():0},y.addOpacity=function(r,m){var o=p(r).toRgb();return"rgba("+Math.round(o.r)+", "+Math.round(o.g)+", "+Math.round(o.b)+", "+m+")"},y.combine=function(r,m){var o=p(r).toRgb();if(o.a===1)return p(r).toRgbString();var i=p(m||t).toRgb(),u=i.a===1?i:{r:255*(1-i.a)+i.r*i.a,g:255*(1-i.a)+i.g*i.a,b:255*(1-i.a)+i.b*i.a},f={r:u.r*(1-o.a)+o.r*o.a,g:u.g*(1-o.a)+o.g*o.a,b:u.b*(1-o.a)+o.b*o.a};return p(f).toRgbString()},y.contrast=function(r,m,o){var i=p(r);return i.getAlpha()!==1&&(i=p(y.combine(r,t))),(i.isDark()?m?i.lighten(m):t:o?i.darken(o):n).toString()},y.stroke=function(r,m){var o=p(m);r.style({stroke:y.tinyRGB(o),"stroke-opacity":o.getAlpha()})},y.fill=function(r,m){var o=p(m);r.style({fill:y.tinyRGB(o),"fill-opacity":o.getAlpha()})},y.clean=function(r){if(r&&typeof r=="object"){var m,o,i,u,f=Object.keys(r);for(m=0;m<f.length;m++)if(u=r[i=f[m]],i.substr(i.length-5)==="color")if(Array.isArray(u))for(o=0;o<u.length;o++)u[o]=a(u[o]);else r[i]=a(u);else if(i.substr(i.length-10)==="colorscale"&&Array.isArray(u))for(o=0;o<u.length;o++)Array.isArray(u[o])&&(u[o][1]=a(u[o][1]));else if(Array.isArray(u)){var l=u[0];if(!Array.isArray(l)&&l&&typeof l=="object")for(o=0;o<u.length;o++)y.clean(u[o])}else u&&typeof u=="object"&&!b(u)&&y.clean(u)}}},{"../../lib/array":497,"./attributes":366,"fast-isnumeric":190,tinycolor2:313}],368:[function(v,J,Z){var p=v("../../plots/cartesian/layout_attributes"),g=v("../../plots/font_attributes"),b=v("../../lib/extend").extendFlat,y=v("../../plot_api/edit_types").overrideAll;J.exports=y({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:p.linecolor,outlinewidth:p.linewidth,bordercolor:p.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:p.tickmode,nticks:p.nticks,tick0:p.tick0,dtick:p.dtick,tickvals:p.tickvals,ticktext:p.ticktext,ticks:b({},p.ticks,{dflt:""}),ticklabeloverflow:b({},p.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:p.ticklen,tickwidth:p.tickwidth,tickcolor:p.tickcolor,ticklabelstep:p.ticklabelstep,showticklabels:p.showticklabels,tickfont:g({}),tickangle:p.tickangle,tickformat:p.tickformat,tickformatstops:p.tickformatstops,tickprefix:p.tickprefix,showtickprefix:p.showtickprefix,ticksuffix:p.ticksuffix,showticksuffix:p.showticksuffix,separatethousands:p.separatethousands,exponentformat:p.exponentformat,minexponent:p.minexponent,showexponent:p.showexponent,title:{text:{valType:"string"},font:g({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:g({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],369:[function(v,J,Z){J.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],370:[function(v,J,Z){var p=v("../../lib"),g=v("../../plot_api/plot_template"),b=v("../../plots/cartesian/tick_value_defaults"),y=v("../../plots/cartesian/tick_mark_defaults"),e=v("../../plots/cartesian/tick_label_defaults"),n=v("../../plots/cartesian/prefix_suffix_defaults"),t=v("./attributes");J.exports=function(a,r,m){var o=g.newContainer(r,"colorbar"),i=a.colorbar||{};function u(L,A){return p.coerce(i,o,t,L,A)}var f=m.margin||{t:0,b:0,l:0,r:0},l=m.width-f.l-f.r,h=m.height-f.t-f.b,d=u("orientation")==="v",s=u("thicknessmode");u("thickness",s==="fraction"?30/(d?l:h):30);var x=u("lenmode");u("len",x==="fraction"?1:d?h:l),u("x",d?1.02:.5),u("xanchor",d?"left":"center"),u("xpad"),u("y",d?.5:1.02),u("yanchor",d?"middle":"bottom"),u("ypad"),p.noneOrAll(i,o,["x","y"]),u("outlinecolor"),u("outlinewidth"),u("bordercolor"),u("borderwidth"),u("bgcolor");var c=p.coerce(i,o,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:d?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");u("ticklabeloverflow",c.indexOf("inside")!==-1?"hide past domain":"hide past div"),b(i,o,u,"linear");var T=m.font,_={outerTicks:!1,font:T};c.indexOf("inside")!==-1&&(_.bgColor="black"),n(i,o,u,"linear",_),e(i,o,u,"linear",_),y(i,o,u,"linear",_),u("title.text",m._dfltTitle.colorbar);var w=o.tickfont,k=p.extendFlat({},w,{color:T.color,size:p.bigFont(w.size)});p.coerceFont(u,"title.font",k),u("title.side",d?"top":"right")}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"./attributes":368}],371:[function(v,J,Z){var p=v("@plotly/d3"),g=v("tinycolor2"),b=v("../../plots/plots"),y=v("../../registry"),e=v("../../plots/cartesian/axes"),n=v("../dragelement"),t=v("../../lib"),a=t.strTranslate,r=v("../../lib/extend").extendFlat,m=v("../../lib/setcursor"),o=v("../drawing"),i=v("../color"),u=v("../titles"),f=v("../../lib/svg_text_utils"),l=v("../colorscale/helpers").flipScale,h=v("../../plots/cartesian/axis_defaults"),d=v("../../plots/cartesian/position_defaults"),s=v("../../plots/cartesian/layout_attributes"),x=v("../../constants/alignment"),c=x.LINE_SPACING,T=x.FROM_TL,_=x.FROM_BR,w=v("./constants").cn;J.exports={draw:function(k){var L=k._fullLayout._infolayer.selectAll("g."+w.colorbar).data(function(A){var I,P,S,E,D=A._fullLayout,R=A.calcdata,H=[];function V(Q){return r(Q,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function X(){typeof E.calc=="function"?E.calc(A,S,I):(I._fillgradient=P.reversescale?l(P.colorscale):P.colorscale,I._zrange=[P[E.min],P[E.max]])}for(var $=0;$<R.length;$++){var G=R[$],W=(S=G[0].trace)._module.colorbar;if(S.visible===!0&&W)for(var te=Array.isArray(W),N=te?W:[W],B=0;B<N.length;B++){var U=(E=N[B]).container;(P=U?S[U]:S)&&P.showscale&&((I=V(P.colorbar))._id="cb"+S.uid+(te&&U?"-"+U:""),I._traceIndex=S.index,I._propPrefix=(U?U+".":"")+"colorbar.",I._meta=S._meta,X(),H.push(I))}}for(var ee in D._colorAxes)if((P=D[ee]).showscale){var j=D._colorAxes[ee];(I=V(P.colorbar))._id="cb"+ee,I._propPrefix=ee+".colorbar.",I._meta=D._meta,E={min:"cmin",max:"cmax"},j[0]!=="heatmap"&&(S=j[1],E.calc=S._module.colorbar.calc),X(),H.push(I)}return H}(k),function(A){return A._id});L.enter().append("g").attr("class",function(A){return A._id}).classed(w.colorbar,!0),L.each(function(A){var I=p.select(this);t.ensureSingle(I,"rect",w.cbbg),t.ensureSingle(I,"g",w.cbfills),t.ensureSingle(I,"g",w.cblines),t.ensureSingle(I,"g",w.cbaxis,function(S){S.classed(w.crisp,!0)}),t.ensureSingle(I,"g",w.cbtitleunshift,function(S){S.append("g").classed(w.cbtitle,!0)}),t.ensureSingle(I,"rect",w.cboutline);var P=function(S,E,D){var R=E.orientation==="v",H=E.len,V=E.lenmode,X=E.thickness,$=E.thicknessmode,G=E.outlinewidth,W=E.borderwidth,te=E.bgcolor,N=E.xanchor,B=E.yanchor,U=E.xpad,ee=E.ypad,j=E.x,Q=R?E.y:1-E.y,K=D._fullLayout,re=K._size,ne=E._fillcolor,le=E._line,oe=E.title,de=oe.side,se=E._zrange||p.extent((typeof ne=="function"?ne:le.color).domain()),me=typeof le.color=="function"?le.color:function(){return le.color},Te=typeof ne=="function"?ne:function(){return ne},_e=E._levels,be=function(ir,Ht,Ue){var We,he,xe=Ht._levels,De=[],qe=[],Xe=xe.end+xe.size/100,He=xe.size,st=1.001*Ue[0]-.001*Ue[1],it=1.001*Ue[1]-.001*Ue[0];for(he=0;he<1e5&&(We=xe.start+he*He,!(He>0?We>=Xe:We<=Xe));he++)We>st&&We<it&&De.push(We);if(Ht._fillgradient)qe=[0];else if(typeof Ht._fillcolor=="function"){var Tt=Ht._filllevels;if(Tt)for(Xe=Tt.end+Tt.size/100,He=Tt.size,he=0;he<1e5&&(We=Tt.start+he*He,!(He>0?We>=Xe:We<=Xe));he++)We>Ue[0]&&We<Ue[1]&&qe.push(We);else(qe=De.map(function(Pt){return Pt-xe.size/2})).push(qe[qe.length-1]+xe.size)}else Ht._fillcolor&&typeof Ht._fillcolor=="string"&&(qe=[0]);return xe.size<0&&(De.reverse(),qe.reverse()),{line:De,fill:qe}}(0,E,se),Ce=be.fill,fe=be.line,ve=Math.round(X*($==="fraction"?R?re.w:re.h:1)),Me=ve/(R?re.w:re.h),ke=Math.round(H*(V==="fraction"?R?re.h:re.w:1)),Le=ke/(R?re.h:re.w),ze=Math.round(R?j*re.w+U:Q*re.h+ee),Re={center:.5,right:1}[N]||0,Oe={top:1,middle:.5}[B]||0,Ze=R?j-Re*Me:Q-Oe*Me,Pe=R?Q-Oe*Le:j-Re*Le,Ie=Math.round(R?re.h*(1-Pe):re.w*Pe);E._lenFrac=Le,E._thickFrac=Me,E._uFrac=Ze,E._vFrac=Pe;var Be=E._axis=function(ir,Ht,Ue){var We=ir._fullLayout,he=Ht.orientation==="v",xe={type:"linear",range:Ue,tickmode:Ht.tickmode,nticks:Ht.nticks,tick0:Ht.tick0,dtick:Ht.dtick,tickvals:Ht.tickvals,ticktext:Ht.ticktext,ticks:Ht.ticks,ticklen:Ht.ticklen,tickwidth:Ht.tickwidth,tickcolor:Ht.tickcolor,showticklabels:Ht.showticklabels,ticklabelposition:Ht.ticklabelposition,ticklabeloverflow:Ht.ticklabeloverflow,ticklabelstep:Ht.ticklabelstep,tickfont:Ht.tickfont,tickangle:Ht.tickangle,tickformat:Ht.tickformat,exponentformat:Ht.exponentformat,minexponent:Ht.minexponent,separatethousands:Ht.separatethousands,showexponent:Ht.showexponent,showtickprefix:Ht.showtickprefix,tickprefix:Ht.tickprefix,showticksuffix:Ht.showticksuffix,ticksuffix:Ht.ticksuffix,title:Ht.title,showline:!0,anchor:"free",side:he?"right":"bottom",position:1},De=he?"y":"x",qe={type:"linear",_id:De+Ht._id},Xe={letter:De,font:We.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:We.calendar};function He(st,it){return t.coerce(xe,qe,s,st,it)}return h(xe,qe,He,Xe,We),d(xe,qe,He,Xe),qe}(D,E,se);Be.position=Me+(R?j+U/re.w:Q+ee/re.h);var Fe=["top","bottom"].indexOf(de)!==-1;if(R&&Fe&&(Be.title.side=de,Be.titlex=j+U/re.w,Be.titley=Pe+(oe.side==="top"?Le-ee/re.h:ee/re.h)),R||Fe||(Be.title.side=de,Be.titley=Q+ee/re.h,Be.titlex=Pe+U/re.w),le.color&&E.tickmode==="auto"){Be.tickmode="linear",Be.tick0=_e.start;var $e=_e.size,ot=t.constrain(ke/50,4,15)+1,pt=(se[1]-se[0])/((E.nticks||ot)*$e);if(pt>1){var _t=Math.pow(10,Math.floor(Math.log(pt)/Math.LN10));$e*=_t*t.roundUp(pt/_t,[2,5,10]),(Math.abs(_e.start)/_e.size+1e-6)%1<2e-6&&(Be.tick0=0)}Be.dtick=$e}Be.domain=R?[Pe+ee/re.h,Pe+Le-ee/re.h]:[Pe+U/re.w,Pe+Le-U/re.w],Be.setScale(),S.attr("transform",a(Math.round(re.l),Math.round(re.t)));var yt,tt=S.select("."+w.cbtitleunshift).attr("transform",a(-Math.round(re.l),-Math.round(re.t))),Ke=Be.ticklabelposition,vt=Be.title.font.size,Nt=S.select("."+w.cbaxis),qt=0,er=0;function Jt(ir,Ht){var Ue={propContainer:Be,propName:E._propPrefix+"title",traceIndex:E._traceIndex,_meta:E._meta,placeholder:K._dfltTitle.colorbar,containerGroup:S.select("."+w.cbtitle)},We=ir.charAt(0)==="h"?ir.substr(1):"h"+ir;S.selectAll("."+We+",."+We+"-math-group").remove(),u.draw(D,ir,r(Ue,Ht||{}))}return t.syncOrAsync([b.previousPromises,function(){var ir,Ht;(R&&Fe||!R&&!Fe)&&(de==="top"&&(ir=U+re.l+re.w*j,Ht=ee+re.t+re.h*(1-Pe-Le)+3+.75*vt),de==="bottom"&&(ir=U+re.l+re.w*j,Ht=ee+re.t+re.h*(1-Pe)-3-.25*vt),de==="right"&&(Ht=ee+re.t+re.h*Q+3+.75*vt,ir=U+re.l+re.w*Pe),Jt(Be._id+"title",{attributes:{x:ir,y:Ht,"text-anchor":R?"start":"middle"}}))},function(){if(!R&&!Fe||R&&Fe){var ir,Ht=S.select("."+w.cbtitle),Ue=Ht.select("text"),We=[-G/2,G/2],he=Ht.select(".h"+Be._id+"title-math-group").node(),xe=15.6;if(Ue.node()&&(xe=parseInt(Ue.node().style.fontSize,10)*c),he?(ir=o.bBox(he),er=ir.width,(qt=ir.height)>xe&&(We[1]-=(qt-xe)/2)):Ue.node()&&!Ue.classed(w.jsPlaceholder)&&(ir=o.bBox(Ue.node()),er=ir.width,qt=ir.height),R){if(qt){if(qt+=5,de==="top")Be.domain[1]-=qt/re.h,We[1]*=-1;else{Be.domain[0]+=qt/re.h;var De=f.lineCount(Ue);We[1]+=(1-De)*xe}Ht.attr("transform",a(We[0],We[1])),Be.setScale()}}else er&&(de==="right"&&(Be.domain[0]+=(er+vt/2)/re.w),Ht.attr("transform",a(We[0],We[1])),Be.setScale())}S.selectAll("."+w.cbfills+",."+w.cblines).attr("transform",R?a(0,Math.round(re.h*(1-Be.domain[1]))):a(Math.round(re.w*Be.domain[0]),0)),Nt.attr("transform",R?a(0,Math.round(-re.t)):a(Math.round(-re.l),0));var qe=S.select("."+w.cbfills).selectAll("rect."+w.cbfill).attr("style","").data(Ce);qe.enter().append("rect").classed(w.cbfill,!0).style("stroke","none"),qe.exit().remove();var Xe=se.map(Be.c2p).map(Math.round).sort(function(Pt,rt){return Pt-rt});qe.each(function(Pt,rt){var ut=[rt===0?se[0]:(Ce[rt]+Ce[rt-1])/2,rt===Ce.length-1?se[1]:(Ce[rt]+Ce[rt+1])/2].map(Be.c2p).map(Math.round);R&&(ut[1]=t.constrain(ut[1]+(ut[1]>ut[0])?1:-1,Xe[0],Xe[1]));var Ft=p.select(this).attr(R?"x":"y",ze).attr(R?"y":"x",p.min(ut)).attr(R?"width":"height",Math.max(ve,2)).attr(R?"height":"width",Math.max(p.max(ut)-p.min(ut),2));if(E._fillgradient)o.gradient(Ft,D,E._id,R?"vertical":"horizontalreversed",E._fillgradient,"fill");else{var wt=Te(Pt).replace("e-","");Ft.attr("fill",g(wt).toHexString())}});var He=S.select("."+w.cblines).selectAll("path."+w.cbline).data(le.color&&le.width?fe:[]);He.enter().append("path").classed(w.cbline,!0),He.exit().remove(),He.each(function(Pt){var rt=ze,ut=Math.round(Be.c2p(Pt))+le.width/2%1;p.select(this).attr("d","M"+(R?rt+","+ut:ut+","+rt)+(R?"h":"v")+ve).call(o.lineGroupStyle,le.width,me(Pt),le.dash)}),Nt.selectAll("g."+Be._id+"tick,path").remove();var st=ze+ve+(G||0)/2-(E.ticks==="outside"?1:0),it=e.calcTicks(Be),Tt=e.getTickSigns(Be)[2];return e.drawTicks(D,Be,{vals:Be.ticks==="inside"?e.clipEnds(Be,it):it,layer:Nt,path:e.makeTickPath(Be,st,Tt),transFn:e.makeTransTickFn(Be)}),e.drawLabels(D,Be,{vals:it,layer:Nt,transFn:e.makeTransTickLabelFn(Be),labelFns:e.makeLabelFns(Be,st)})},function(){if(R&&!Fe||!R&&Fe){var ir,Ht,Ue=Be.position||0,We=Be._offset+Be._length/2;if(de==="right")Ht=We,ir=re.l+re.w*Ue+10+vt*(Be.showticklabels?1:.5);else if(ir=We,de==="bottom"&&(Ht=re.t+re.h*Ue+10+(Ke.indexOf("inside")===-1?Be.tickfont.size:0)+(Be.ticks!=="intside"&&E.ticklen||0)),de==="top"){var he=oe.text.split("<br>").length;Ht=re.t+re.h*Ue+10-ve-c*vt*he}Jt((R?"h":"v")+Be._id+"title",{avoid:{selection:p.select(D).selectAll("g."+Be._id+"tick"),side:de,offsetTop:R?0:re.t,offsetLeft:R?re.l:0,maxShift:R?K.width:K.height},attributes:{x:ir,y:Ht,"text-anchor":"middle"},transform:{rotate:R?-90:0,offset:0}})}},b.previousPromises,function(){var ir,Ht=ve+G/2;Ke.indexOf("inside")===-1&&(ir=o.bBox(Nt.node()),Ht+=R?ir.width:ir.height),yt=tt.select("text");var Ue=0,We=R&&de==="top",he=!R&&de==="right",xe=0;if(yt.node()&&!yt.classed(w.jsPlaceholder)){var De,qe=tt.select(".h"+Be._id+"title-math-group").node();qe&&(R&&Fe||!R&&!Fe)?(Ue=(ir=o.bBox(qe)).width,De=ir.height):(Ue=(ir=o.bBox(tt.node())).right-re.l-(R?ze:Ie),De=ir.bottom-re.t-(R?Ie:ze),R||de!=="top"||(Ht+=ir.height,xe=ir.height)),he&&(yt.attr("transform",a(Ue/2+vt/2,0)),Ue*=2),Ht=Math.max(Ht,R?Ue:De)}var Xe=2*(R?U:ee)+Ht+W+G/2,He=0;!R&&oe.text&&B==="bottom"&&Q<=0&&(Xe+=He=Xe/2,xe+=He),K._hColorbarMoveTitle=He,K._hColorbarMoveCBTitle=xe;var st=W+G;S.select("."+w.cbbg).attr("x",(R?ze:Ie)-st/2-(R?U:0)).attr("y",(R?Ie:ze)-(R?ke:ee+xe-He)).attr(R?"width":"height",Math.max(Xe-He,2)).attr(R?"height":"width",Math.max(ke+st,2)).call(i.fill,te).call(i.stroke,E.bordercolor).style("stroke-width",W);var it=he?Math.max(Ue-10,0):0;if(S.selectAll("."+w.cboutline).attr("x",(R?ze:Ie+U)+it).attr("y",(R?Ie+ee-ke:ze)+(We?qt:0)).attr(R?"width":"height",Math.max(ve,2)).attr(R?"height":"width",Math.max(ke-(R?2*ee+qt:2*U+it),2)).call(i.stroke,E.outlinecolor).style({fill:"none","stroke-width":G}),S.attr("transform",a(re.l-(R?Re*Xe:0),re.t-(R?0:(1-Oe)*Xe-xe))),!R&&(W||g(te).getAlpha()&&!g.equals(K.paper_bgcolor,te))){var Tt=Nt.selectAll("text"),Pt=Tt[0].length,rt=S.select("."+w.cbbg).node(),ut=o.bBox(rt),Ft=o.getTranslate(S);Tt.each(function(Mt,Rt){var Gt=Pt-1;if(Rt===0||Rt===Gt){var jt,pr=o.bBox(this),Ar=o.getTranslate(this);if(Rt===Gt){var fr=pr.right+Ar.x;(jt=ut.right+Ft.x+Ie-W-2+j-fr)>0&&(jt=0)}else if(Rt===0){var Zt=pr.left+Ar.x;(jt=ut.left+Ft.x+Ie+W+2-Zt)<0&&(jt=0)}jt&&(Pt<3?this.setAttribute("transform","translate("+jt+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var wt={},Lt=T[N],Ae=_[N],Ye=T[B],nt=_[B],ft=Xe-ve;R?(V==="pixels"?(wt.y=Q,wt.t=ke*Ye,wt.b=ke*nt):(wt.t=wt.b=0,wt.yt=Q+H*Ye,wt.yb=Q-H*nt),$==="pixels"?(wt.x=j,wt.l=Xe*Lt,wt.r=Xe*Ae):(wt.l=ft*Lt,wt.r=ft*Ae,wt.xl=j-X*Lt,wt.xr=j+X*Ae)):(V==="pixels"?(wt.x=j,wt.l=ke*Lt,wt.r=ke*Ae):(wt.l=wt.r=0,wt.xl=j+H*Lt,wt.xr=j-H*Ae),$==="pixels"?(wt.y=1-Q,wt.t=Xe*Ye,wt.b=Xe*nt):(wt.t=ft*Ye,wt.b=ft*nt,wt.yt=Q-X*Ye,wt.yb=Q+X*nt)),b.autoMargin(D,E._id,wt)}],D)}(I,A,k);P&&P.then&&(k._promises||[]).push(P),k._context.edits.colorbarPosition&&function(S,E,D){var R,H,V,X=E.orientation==="v",$=D._fullLayout._size;n.init({element:S.node(),gd:D,prepFn:function(){R=S.attr("transform"),m(S)},moveFn:function(G,W){S.attr("transform",R+a(G,W)),H=n.align((X?E._uFrac:E._vFrac)+G/$.w,X?E._thickFrac:E._lenFrac,0,1,E.xanchor),V=n.align((X?E._vFrac:1-E._uFrac)-W/$.h,X?E._lenFrac:E._thickFrac,0,1,E.yanchor);var te=n.getCursor(H,V,E.xanchor,E.yanchor);m(S,te)},doneFn:function(){if(m(S),H!==void 0&&V!==void 0){var G={};G[E._propPrefix+"x"]=H,G[E._propPrefix+"y"]=V,E._traceIndex!==void 0?y.call("_guiRestyle",D,G,E._traceIndex):y.call("_guiRelayout",D,G)}}})}(I,A,k)}),L.exit().each(function(A){b.autoMargin(k,A._id)}).remove(),L.order()}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/extend":505,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"../../plots/plots":628,"../../registry":647,"../color":367,"../colorscale/helpers":378,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":369,"@plotly/d3":58,tinycolor2:313}],372:[function(v,J,Z){var p=v("../../lib");J.exports=function(g){return p.isPlainObject(g.colorbar)}},{"../../lib":515}],373:[function(v,J,Z){J.exports={moduleType:"component",name:"colorbar",attributes:v("./attributes"),supplyDefaults:v("./defaults"),draw:v("./draw").draw,hasColorbar:v("./has_colorbar")}},{"./attributes":368,"./defaults":370,"./draw":371,"./has_colorbar":372}],374:[function(v,J,Z){var p=v("../colorbar/attributes"),g=v("../../lib/regex").counter,b=v("../../lib/sort_object_keys"),y=v("./scales.js").scales;b(y);function e(n){return"`"+n+"`"}J.exports=function(n,t){n=n||"";var a,r=(t=t||{}).cLetter||"c",m=("onlyIfNumerical"in t?t.onlyIfNumerical:Boolean(n),"noScale"in t?t.noScale:n==="marker.line"),o="showScaleDflt"in t?t.showScaleDflt:r==="z",i=typeof t.colorscaleDflt=="string"?y[t.colorscaleDflt]:null,u=t.editTypeOverride||"",f=n?n+".":"";"colorAttr"in t?(a=t.colorAttr,t.colorAttr):e(f+(a={z:"z",c:"color"}[r]));var l=r+"auto",h=r+"min",d=r+"max",s=r+"mid",x={};x[h]=x[d]=void 0;var c={};c[l]=!1;var T={};return a==="color"&&(T.color={valType:"color",arrayOk:!0,editType:u||"style"},t.anim&&(T.color.anim=!0)),T[l]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:x},T[h]={valType:"number",dflt:null,editType:u||"plot",impliedEdits:c},T[d]={valType:"number",dflt:null,editType:u||"plot",impliedEdits:c},T[s]={valType:"number",dflt:null,editType:"calc",impliedEdits:x},T.colorscale={valType:"colorscale",editType:"calc",dflt:i,impliedEdits:{autocolorscale:!1}},T.autocolorscale={valType:"boolean",dflt:t.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},T.reversescale={valType:"boolean",dflt:!1,editType:"plot"},m||(T.showscale={valType:"boolean",dflt:o,editType:"calc"},T.colorbar=p),t.noColorAxis||(T.coloraxis={valType:"subplotid",regex:g("coloraxis"),dflt:null,editType:"calc"}),T}},{"../../lib/regex":532,"../../lib/sort_object_keys":538,"../colorbar/attributes":368,"./scales.js":382}],375:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("./helpers").extractOpts;J.exports=function(y,e,n){var t,a=y._fullLayout,r=n.vals,m=n.containerStr,o=m?g.nestedProperty(e,m).get():e,i=b(o),u=i.auto!==!1,f=i.min,l=i.max,h=i.mid,d=function(){return g.aggNums(Math.min,null,r)},s=function(){return g.aggNums(Math.max,null,r)};f===void 0?f=d():u&&(f=o._colorAx&&p(f)?Math.min(f,d()):d()),l===void 0?l=s():u&&(l=o._colorAx&&p(l)?Math.max(l,s()):s()),u&&h!==void 0&&(l-h>h-f?f=h-(l-h):l-h<h-f&&(l=h+(h-f))),f===l&&(f-=.5,l+=.5),i._sync("min",f),i._sync("max",l),i.autocolorscale&&(t=f*l<0?a.colorscale.diverging:f>=0?a.colorscale.sequential:a.colorscale.sequentialminus,i._sync("colorscale",t))}},{"../../lib":515,"./helpers":378,"fast-isnumeric":190}],376:[function(v,J,Z){var p=v("../../lib"),g=v("./helpers").hasColorscale,b=v("./helpers").extractOpts;J.exports=function(y,e){function n(u,f){var l=u["_"+f];l!==void 0&&(u[f]=l)}function t(u,f){var l=f.container?p.nestedProperty(u,f.container).get():u;if(l)if(l.coloraxis)l._colorAx=e[l.coloraxis];else{var h=b(l),d=h.auto;(d||h.min===void 0)&&n(l,f.min),(d||h.max===void 0)&&n(l,f.max),h.autocolorscale&&n(l,"colorscale")}}for(var a=0;a<y.length;a++){var r=y[a],m=r._module.colorbar;if(m)if(Array.isArray(m))for(var o=0;o<m.length;o++)t(r,m[o]);else t(r,m);g(r,"marker.line")&&t(r,{container:"marker.line",min:"cmin",max:"cmax"})}for(var i in e._colorAxes)t(e[i],{min:"cmin",max:"cmax"})}},{"../../lib":515,"./helpers":378}],377:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("../colorbar/has_colorbar"),y=v("../colorbar/defaults"),e=v("./scales").isValid,n=v("../../registry").traceIs;function t(a,r){var m=r.slice(0,r.length-1);return r?g.nestedProperty(a,m).get()||{}:a}J.exports=function a(r,m,o,i,u){var f=u.prefix,l=u.cLetter,h="_module"in m,d=t(r,f),s=t(m,f),x=t(m._template||{},f)||{},c=function(){return delete r.coloraxis,delete m.coloraxis,a(r,m,o,i,u)};if(h){var T=o._colorAxes||{},_=i(f+"coloraxis");if(_){var w=n(m,"contour")&&g.nestedProperty(m,"contours.coloring").get()||"heatmap",k=T[_];return void(k?(k[2].push(c),k[0]!==w&&(k[0]=!1,g.warn(["Ignoring coloraxis:",_,"setting","as it is linked to incompatible colorscales."].join(" ")))):T[_]=[w,m,[c]])}}var L=d[l+"min"],A=d[l+"max"],I=p(L)&&p(A)&&L<A;i(f+l+"auto",!I)?i(f+l+"mid"):(i(f+l+"min"),i(f+l+"max"));var P,S,E=d.colorscale,D=x.colorscale;E!==void 0&&(P=!e(E)),D!==void 0&&(P=!e(D)),i(f+"autocolorscale",P),i(f+"colorscale"),i(f+"reversescale"),f!=="marker.line."&&(f&&h&&(S=b(d)),i(f+"showscale",S)&&(f&&x&&(s._template=x),y(d,s,o)))}},{"../../lib":515,"../../registry":647,"../colorbar/defaults":370,"../colorbar/has_colorbar":372,"./scales":382,"fast-isnumeric":190}],378:[function(v,J,Z){var p=v("@plotly/d3"),g=v("tinycolor2"),b=v("fast-isnumeric"),y=v("../../lib"),e=v("../color"),n=v("./scales").isValid,t=["showscale","autocolorscale","colorscale","reversescale","colorbar"],a=["min","max","mid","auto"];function r(f){var l,h,d,s=f._colorAx,x=s||f,c={};for(h=0;h<t.length;h++)c[d=t[h]]=x[d];if(s)for(l="c",h=0;h<a.length;h++)c[d=a[h]]=x["c"+d];else{var T;for(h=0;h<a.length;h++)((T="c"+(d=a[h]))in x||(T="z"+d)in x)&&(c[d]=x[T]);l=T.charAt(0)}return c._sync=function(_,w){var k=a.indexOf(_)!==-1?l+_:_;x[k]=x["_"+k]=w},c}function m(f){for(var l=r(f),h=l.min,d=l.max,s=l.reversescale?o(l.colorscale):l.colorscale,x=s.length,c=new Array(x),T=new Array(x),_=0;_<x;_++){var w=s[_];c[_]=h+w[0]*(d-h),T[_]=w[1]}return{domain:c,range:T}}function o(f){for(var l=f.length,h=new Array(l),d=l-1,s=0;d>=0;d--,s++){var x=f[d];h[s]=[1-x[0],x[1]]}return h}function i(f,l){l=l||{};for(var h=f.domain,d=f.range,s=d.length,x=new Array(s),c=0;c<s;c++){var T=g(d[c]).toRgb();x[c]=[T.r,T.g,T.b,T.a]}var _,w=p.scale.linear().domain(h).range(x).clamp(!0),k=l.noNumericCheck,L=l.returnArray;return(_=k&&L?w:k?function(A){return u(w(A))}:L?function(A){return b(A)?w(A):g(A).isValid()?A:e.defaultLine}:function(A){return b(A)?u(w(A)):g(A).isValid()?A:e.defaultLine}).domain=w.domain,_.range=function(){return d},_}function u(f){var l={r:f[0],g:f[1],b:f[2],a:f[3]};return g(l).toRgbString()}J.exports={hasColorscale:function(f,l,h){var d=l?y.nestedProperty(f,l).get()||{}:f,s=d[h||"color"],x=!1;if(y.isArrayOrTypedArray(s)){for(var c=0;c<s.length;c++)if(b(s[c])){x=!0;break}}return y.isPlainObject(d)&&(x||d.showscale===!0||b(d.cmin)&&b(d.cmax)||n(d.colorscale)||y.isPlainObject(d.colorbar))},extractOpts:r,extractScale:m,flipScale:o,makeColorScaleFunc:i,makeColorScaleFuncFromTrace:function(f,l){return i(m(f),l)}}},{"../../lib":515,"../color":367,"./scales":382,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],379:[function(v,J,Z){var p=v("./scales"),g=v("./helpers");J.exports={moduleType:"component",name:"colorscale",attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),handleDefaults:v("./defaults"),crossTraceDefaults:v("./cross_trace_defaults"),calc:v("./calc"),scales:p.scales,defaultScale:p.defaultScale,getScale:p.get,isValidScale:p.isValid,hasColorscale:g.hasColorscale,extractOpts:g.extractOpts,extractScale:g.extractScale,flipScale:g.flipScale,makeColorScaleFunc:g.makeColorScaleFunc,makeColorScaleFuncFromTrace:g.makeColorScaleFuncFromTrace}},{"./attributes":374,"./calc":375,"./cross_trace_defaults":376,"./defaults":377,"./helpers":378,"./layout_attributes":380,"./layout_defaults":381,"./scales":382}],380:[function(v,J,Z){var p=v("../../lib/extend").extendFlat,g=v("./attributes"),b=v("./scales").scales;J.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:b.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:b.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:b.RdBu,editType:"calc"}},coloraxis:p({_isSubplotObj:!0,editType:"calc"},g("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":505,"./attributes":374,"./scales":382}],381:[function(v,J,Z){var p=v("../../lib"),g=v("../../plot_api/plot_template"),b=v("./layout_attributes"),y=v("./defaults");J.exports=function(e,n){function t(l,h){return p.coerce(e,n,b,l,h)}t("colorscale.sequential"),t("colorscale.sequentialminus"),t("colorscale.diverging");var a,r,m=n._colorAxes;function o(l,h){return p.coerce(a,r,b.coloraxis,l,h)}for(var i in m){var u=m[i];if(u[0])a=e[i]||{},(r=g.newContainer(n,i,"coloraxis"))._name=i,y(a,r,n,o,{prefix:"",cLetter:"c"});else{for(var f=0;f<u[2].length;f++)u[2][f]();delete n._colorAxes[i]}}}},{"../../lib":515,"../../plot_api/plot_template":555,"./defaults":377,"./layout_attributes":380}],382:[function(v,J,Z){var p=v("tinycolor2"),g={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},b=g.RdBu;function y(e){var n=0;if(!Array.isArray(e)||e.length<2||!e[0]||!e[e.length-1]||+e[0][0]!=0||+e[e.length-1][0]!=1)return!1;for(var t=0;t<e.length;t++){var a=e[t];if(a.length!==2||+a[0]<n||!p(a[1]).isValid())return!1;n=+a[0]}return!0}J.exports={scales:g,defaultScale:b,get:function(e,n){if(n||(n=b),!e)return n;function t(){try{e=g[e]||JSON.parse(e)}catch{e=n}}return typeof e=="string"&&(t(),typeof e=="string"&&t()),y(e)?e:n},isValid:function(e){return g[e]!==void 0||y(e)}}},{tinycolor2:313}],383:[function(v,J,Z){J.exports=function(p,g,b,y,e){var n=(p-b)/(y-b),t=n+g/(y-b),a=(n+t)/2;return e==="left"||e==="bottom"?n:e==="center"||e==="middle"?a:e==="right"||e==="top"?t:n<2/3-a?n:t>4/3-a?t:a}},{}],384:[function(v,J,Z){var p=v("../../lib"),g=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];J.exports=function(b,y,e,n){return b=e==="left"?0:e==="center"?1:e==="right"?2:p.constrain(Math.floor(3*b),0,2),y=n==="bottom"?0:n==="middle"?1:n==="top"?2:p.constrain(Math.floor(3*y),0,2),g[y][b]}},{"../../lib":515}],385:[function(v,J,Z){Z.selectMode=function(p){return p==="lasso"||p==="select"},Z.drawMode=function(p){return p==="drawclosedpath"||p==="drawopenpath"||p==="drawline"||p==="drawrect"||p==="drawcircle"},Z.openMode=function(p){return p==="drawline"||p==="drawopenpath"},Z.rectMode=function(p){return p==="select"||p==="drawline"||p==="drawrect"||p==="drawcircle"},Z.freeMode=function(p){return p==="lasso"||p==="drawclosedpath"||p==="drawopenpath"},Z.selectingOrDrawing=function(p){return Z.freeMode(p)||Z.rectMode(p)}},{}],386:[function(v,J,Z){var p=v("mouse-event-offset"),g=v("has-hover"),b=v("has-passive-events"),y=v("../../lib").removeElement,e=v("../../plots/cartesian/constants"),n=J.exports={};n.align=v("./align"),n.getCursor=v("./cursor");var t=v("./unhover");function a(){var m=document.createElement("div");m.className="dragcover";var o=m.style;return o.position="fixed",o.left=0,o.right=0,o.top=0,o.bottom=0,o.zIndex=999999999,o.background="none",document.body.appendChild(m),m}function r(m){return p(m.changedTouches?m.changedTouches[0]:m,document.body)}n.unhover=t.wrapped,n.unhoverRaw=t.raw,n.init=function(m){var o,i,u,f,l,h,d,s,x=m.gd,c=1,T=x._context.doubleClickDelay,_=m.element;x._mouseDownTime||(x._mouseDownTime=0),_.style.pointerEvents="all",_.onmousedown=k,b?(_._ontouchstart&&_.removeEventListener("touchstart",_._ontouchstart),_._ontouchstart=k,_.addEventListener("touchstart",k,{passive:!1})):_.ontouchstart=k;var w=m.clampFn||function(I,P,S){return Math.abs(I)<S&&(I=0),Math.abs(P)<S&&(P=0),[I,P]};function k(I){x._dragged=!1,x._dragging=!0;var P=r(I);o=P[0],i=P[1],d=I.target,h=I,s=I.buttons===2||I.ctrlKey,I.clientX===void 0&&I.clientY===void 0&&(I.clientX=o,I.clientY=i),(u=new Date().getTime())-x._mouseDownTime<T?c+=1:(c=1,x._mouseDownTime=u),m.prepFn&&m.prepFn(I,o,i),g&&!s?(l=a()).style.cursor=window.getComputedStyle(_).cursor:g||(l=document,f=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(_).cursor),document.addEventListener("mouseup",A),document.addEventListener("touchend",A),m.dragmode!==!1&&(I.preventDefault(),document.addEventListener("mousemove",L),document.addEventListener("touchmove",L,{passive:!1}))}function L(I){I.preventDefault();var P=r(I),S=m.minDrag||e.MINDRAG,E=w(P[0]-o,P[1]-i,S),D=E[0],R=E[1];(D||R)&&(x._dragged=!0,n.unhover(x,I)),x._dragged&&m.moveFn&&!s&&(x._dragdata={element:_,dx:D,dy:R},m.moveFn(D,R))}function A(I){if(delete x._dragdata,m.dragmode!==!1&&(I.preventDefault(),document.removeEventListener("mousemove",L),document.removeEventListener("touchmove",L)),document.removeEventListener("mouseup",A),document.removeEventListener("touchend",A),g?y(l):f&&(l.documentElement.style.cursor=f,f=null),x._dragging){if(x._dragging=!1,new Date().getTime()-x._mouseDownTime>T&&(c=Math.max(c-1,1)),x._dragged)m.doneFn&&m.doneFn();else if(m.clickFn&&m.clickFn(c,h),!s){var P;try{P=new MouseEvent("click",I)}catch{var S=r(I);(P=document.createEvent("MouseEvents")).initMouseEvent("click",I.bubbles,I.cancelable,I.view,I.detail,I.screenX,I.screenY,S[0],S[1],I.ctrlKey,I.altKey,I.shiftKey,I.metaKey,I.button,I.relatedTarget)}d.dispatchEvent(P)}x._dragging=!1,x._dragged=!1}else x._dragged=!1}},n.coverSlip=a},{"../../lib":515,"../../plots/cartesian/constants":573,"./align":383,"./cursor":384,"./unhover":387,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],387:[function(v,J,Z){var p=v("../../lib/events"),g=v("../../lib/throttle"),b=v("../../lib/dom").getGraphDiv,y=v("../fx/constants"),e=J.exports={};e.wrapped=function(n,t,a){(n=b(n))._fullLayout&&g.clear(n._fullLayout._uid+y.HOVERID),e.raw(n,t,a)},e.raw=function(n,t){var a=n._fullLayout,r=n._hoverdata;t||(t={}),t.target&&!n._dragged&&p.triggerHandler(n,"plotly_beforehover",t)===!1||(a._hoverlayer.selectAll("g").remove(),a._hoverlayer.selectAll("line").remove(),a._hoverlayer.selectAll("circle").remove(),n._hoverdata=void 0,t.target&&r&&n.emit("plotly_unhover",{event:t,points:r}))}},{"../../lib/dom":503,"../../lib/events":504,"../../lib/throttle":542,"../fx/constants":401}],388:[function(v,J,Z){Z.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},Z.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],389:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=g.numberFormat,y=v("fast-isnumeric"),e=v("tinycolor2"),n=v("../../registry"),t=v("../color"),a=v("../colorscale"),r=g.strTranslate,m=v("../../lib/svg_text_utils"),o=v("../../constants/xmlns_namespaces"),i=v("../../constants/alignment").LINE_SPACING,u=v("../../constants/interactions").DESELECTDIM,f=v("../../traces/scatter/subtypes"),l=v("../../traces/scatter/make_bubble_size_func"),h=v("../../components/fx/helpers").appendArrayPointValue,d=J.exports={};function s(G,W,te){var N=W.fillpattern,B=N&&d.getPatternAttr(N.shape,0,"");if(B){var U=d.getPatternAttr(N.bgcolor,0,null),ee=d.getPatternAttr(N.fgcolor,0,null),j=N.fgopacity,Q=d.getPatternAttr(N.size,0,8),K=d.getPatternAttr(N.solidity,0,.3),re=W.uid;d.pattern(G,"point",te,re,B,Q,K,void 0,N.fillmode,U,ee,j)}else W.fillcolor&&G.call(t.fill,W.fillcolor)}d.font=function(G,W,te,N){g.isPlainObject(W)&&(N=W.color,te=W.size,W=W.family),W&&G.style("font-family",W),te+1&&G.style("font-size",te+"px"),N&&G.call(t.fill,N)},d.setPosition=function(G,W,te){G.attr("x",W).attr("y",te)},d.setSize=function(G,W,te){G.attr("width",W).attr("height",te)},d.setRect=function(G,W,te,N,B){G.call(d.setPosition,W,te).call(d.setSize,N,B)},d.translatePoint=function(G,W,te,N){var B=te.c2p(G.x),U=N.c2p(G.y);return!!(y(B)&&y(U)&&W.node())&&(W.node().nodeName==="text"?W.attr("x",B).attr("y",U):W.attr("transform",r(B,U)),!0)},d.translatePoints=function(G,W,te){G.each(function(N){var B=p.select(this);d.translatePoint(N,B,W,te)})},d.hideOutsideRangePoint=function(G,W,te,N,B,U){W.attr("display",te.isPtWithinRange(G,B)&&N.isPtWithinRange(G,U)?null:"none")},d.hideOutsideRangePoints=function(G,W){if(W._hasClipOnAxisFalse){var te=W.xaxis,N=W.yaxis;G.each(function(B){var U=B[0].trace,ee=U.xcalendar,j=U.ycalendar,Q=n.traceIs(U,"bar-like")?".bartext":".point,.textpoint";G.selectAll(Q).each(function(K){d.hideOutsideRangePoint(K,p.select(this),te,N,ee,j)})})}},d.crispRound=function(G,W,te){return W&&y(W)?G._context.staticPlot?W:W<1?1:Math.round(W):te||0},d.singleLineStyle=function(G,W,te,N,B){W.style("fill","none");var U=(((G||[])[0]||{}).trace||{}).line||{},ee=te||U.width||0,j=B||U.dash||"";t.stroke(W,N||U.color),d.dashLine(W,j,ee)},d.lineGroupStyle=function(G,W,te,N){G.style("fill","none").each(function(B){var U=(((B||[])[0]||{}).trace||{}).line||{},ee=W||U.width||0,j=N||U.dash||"";p.select(this).call(t.stroke,te||U.color).call(d.dashLine,j,ee)})},d.dashLine=function(G,W,te){te=+te||0,W=d.dashStyle(W,te),G.style({"stroke-dasharray":W,"stroke-width":te+"px"})},d.dashStyle=function(G,W){W=+W||1;var te=Math.max(W,3);return G==="solid"?G="":G==="dot"?G=te+"px,"+te+"px":G==="dash"?G=3*te+"px,"+3*te+"px":G==="longdash"?G=5*te+"px,"+5*te+"px":G==="dashdot"?G=3*te+"px,"+te+"px,"+te+"px,"+te+"px":G==="longdashdot"&&(G=5*te+"px,"+2*te+"px,"+te+"px,"+2*te+"px"),G},d.singleFillStyle=function(G,W){var te=p.select(G.node());s(G,((te.data()[0]||[])[0]||{}).trace||{},W)},d.fillGroupStyle=function(G,W){G.style("stroke-width",0).each(function(te){var N=p.select(this);te[0].trace&&s(N,te[0].trace,W)})};var x=v("./symbol_defs");d.symbolNames=[],d.symbolFuncs=[],d.symbolNeedLines={},d.symbolNoDot={},d.symbolNoFill={},d.symbolList=[],Object.keys(x).forEach(function(G){var W=x[G],te=W.n;d.symbolList.push(te,String(te),G,te+100,String(te+100),G+"-open"),d.symbolNames[te]=G,d.symbolFuncs[te]=W.f,W.needLine&&(d.symbolNeedLines[te]=!0),W.noDot?d.symbolNoDot[te]=!0:d.symbolList.push(te+200,String(te+200),G+"-dot",te+300,String(te+300),G+"-open-dot"),W.noFill&&(d.symbolNoFill[te]=!0)});var c=d.symbolNames.length;function T(G,W){var te=G%100;return d.symbolFuncs[te](W)+(G>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}d.symbolNumber=function(G){if(y(G))G=+G;else if(typeof G=="string"){var W=0;G.indexOf("-open")>0&&(W=100,G=G.replace("-open","")),G.indexOf("-dot")>0&&(W+=200,G=G.replace("-dot","")),(G=d.symbolNames.indexOf(G))>=0&&(G+=W)}return G%100>=c||G>=400?0:Math.floor(Math.max(G,0))};var _={x1:1,x2:0,y1:0,y2:0},w={x1:0,x2:0,y1:1,y2:0},k=b("~f"),L={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:_},horizontalreversed:{node:"linearGradient",attrs:_,reversed:!0},vertical:{node:"linearGradient",attrs:w},verticalreversed:{node:"linearGradient",attrs:w,reversed:!0}};d.gradient=function(G,W,te,N,B,U){for(var ee=B.length,j=L[N],Q=new Array(ee),K=0;K<ee;K++)j.reversed?Q[ee-1-K]=[k(100*(1-B[K][0])),B[K][1]]:Q[K]=[k(100*B[K][0]),B[K][1]];var re=W._fullLayout,ne="g"+re._uid+"-"+te,le=re._defs.select(".gradients").selectAll("#"+ne).data([N+Q.join(";")],g.identity);le.exit().remove(),le.enter().append(j.node).each(function(){var oe=p.select(this);j.attrs&&oe.attr(j.attrs),oe.attr("id",ne);var de=oe.selectAll("stop").data(Q);de.exit().remove(),de.enter().append("stop"),de.each(function(se){var me=e(se[1]);p.select(this).attr({offset:se[0]+"%","stop-color":t.tinyRGB(me),"stop-opacity":me.getAlpha()})})}),G.style(U,V(ne,W)).style(U+"-opacity",null),G.classed("gradient_filled",!0)},d.pattern=function(G,W,te,N,B,U,ee,j,Q,K,re,ne){var le=W==="legend";j&&(Q==="overlay"?(K=j,re=t.contrast(K)):(K=void 0,re=j));var oe,de,se,me,Te,_e,be,Ce,fe,ve,Me,ke=te._fullLayout,Le="p"+ke._uid+"-"+N,ze={};switch(B){case"/":oe=U*Math.sqrt(2),de=U*Math.sqrt(2),_e="path",ze={d:se="M-"+oe/4+","+de/4+"l"+oe/2+",-"+de/2+"M0,"+de+"L"+oe+",0M"+oe/4*3+","+de/4*5+"l"+oe/2+",-"+de/2,opacity:ne,stroke:re,"stroke-width":(me=ee*U)+"px"};break;case"\\":oe=U*Math.sqrt(2),de=U*Math.sqrt(2),_e="path",ze={d:se="M"+oe/4*3+",-"+de/4+"l"+oe/2+","+de/2+"M0,0L"+oe+","+de+"M-"+oe/4+","+de/4*3+"l"+oe/2+","+de/2,opacity:ne,stroke:re,"stroke-width":(me=ee*U)+"px"};break;case"x":oe=U*Math.sqrt(2),de=U*Math.sqrt(2),se="M-"+oe/4+","+de/4+"l"+oe/2+",-"+de/2+"M0,"+de+"L"+oe+",0M"+oe/4*3+","+de/4*5+"l"+oe/2+",-"+de/2+"M"+oe/4*3+",-"+de/4+"l"+oe/2+","+de/2+"M0,0L"+oe+","+de+"M-"+oe/4+","+de/4*3+"l"+oe/2+","+de/2,me=U-U*Math.sqrt(1-ee),_e="path",ze={d:se,opacity:ne,stroke:re,"stroke-width":me+"px"};break;case"|":_e="path",_e="path",ze={d:se="M"+(oe=U)/2+",0L"+oe/2+","+(de=U),opacity:ne,stroke:re,"stroke-width":(me=ee*U)+"px"};break;case"-":_e="path",_e="path",ze={d:se="M0,"+(de=U)/2+"L"+(oe=U)+","+de/2,opacity:ne,stroke:re,"stroke-width":(me=ee*U)+"px"};break;case"+":_e="path",se="M"+(oe=U)/2+",0L"+oe/2+","+(de=U)+"M0,"+de/2+"L"+oe+","+de/2,me=U-U*Math.sqrt(1-ee),_e="path",ze={d:se,opacity:ne,stroke:re,"stroke-width":me+"px"};break;case".":oe=U,de=U,ee<Math.PI/4?Te=Math.sqrt(ee*U*U/Math.PI):(be=ee,Ce=Math.PI/4,fe=1,ve=U/2,Me=U/Math.sqrt(2),Te=ve+(Me-ve)*(be-Ce)/(fe-Ce)),_e="circle",ze={cx:oe/2,cy:de/2,r:Te,opacity:ne,fill:re}}var Re=[B||"noSh",K||"noBg",re||"noFg",U,ee].join(";"),Oe=ke._defs.select(".patterns").selectAll("#"+Le).data([Re],g.identity);Oe.exit().remove(),Oe.enter().append("pattern").each(function(){var Ze=p.select(this);if(Ze.attr({id:Le,width:oe+"px",height:de+"px",patternUnits:"userSpaceOnUse",patternTransform:le?"scale(0.8)":""}),K){var Pe=Ze.selectAll("rect").data([0]);Pe.exit().remove(),Pe.enter().append("rect").attr({width:oe+"px",height:de+"px",fill:K})}var Ie=Ze.selectAll(_e).data([0]);Ie.exit().remove(),Ie.enter().append(_e).attr(ze)}),G.style("fill",V(Le,te)).style("fill-opacity",null),G.classed("pattern_filled",!0)},d.initGradients=function(G){var W=G._fullLayout;g.ensureSingle(W._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),p.select(G).selectAll(".gradient_filled").classed("gradient_filled",!1)},d.initPatterns=function(G){var W=G._fullLayout;g.ensureSingle(W._defs,"g","patterns").selectAll("pattern").remove(),p.select(G).selectAll(".pattern_filled").classed("pattern_filled",!1)},d.getPatternAttr=function(G,W,te){return G&&g.isArrayOrTypedArray(G)?W<G.length?G[W]:te:G},d.pointStyle=function(G,W,te){if(G.size()){var N=d.makePointStyleFns(W);G.each(function(B){d.singlePointStyle(B,p.select(this),W,N,te)})}},d.singlePointStyle=function(G,W,te,N,B){var U=te.marker,ee=U.line;if(W.style("opacity",N.selectedOpacityFn?N.selectedOpacityFn(G):G.mo===void 0?U.opacity:G.mo),N.ms2mrc){var j;j=G.ms==="various"||U.size==="various"?3:N.ms2mrc(G.ms),G.mrc=j,N.selectedSizeFn&&(j=G.mrc=N.selectedSizeFn(G));var Q=d.symbolNumber(G.mx||U.symbol)||0;G.om=Q%200>=100,W.attr("d",T(Q,j))}var K,re,ne,le=!1;if(G.so)ne=ee.outlierwidth,re=ee.outliercolor,K=U.outliercolor;else{var oe=(ee||{}).width;ne=(G.mlw+1||oe+1||(G.trace?(G.trace.marker.line||{}).width:0)+1)-1||0,re="mlc"in G?G.mlcc=N.lineScale(G.mlc):g.isArrayOrTypedArray(ee.color)?t.defaultLine:ee.color,g.isArrayOrTypedArray(U.color)&&(K=t.defaultLine,le=!0),K="mc"in G?G.mcc=N.markerScale(G.mc):U.color||"rgba(0,0,0,0)",N.selectedColorFn&&(K=N.selectedColorFn(G))}if(G.om)W.call(t.stroke,K).style({"stroke-width":(ne||1)+"px",fill:"none"});else{W.style("stroke-width",(G.isBlank?0:ne)+"px");var de=U.gradient,se=G.mgt;se?le=!0:se=de&&de.type,g.isArrayOrTypedArray(se)&&(se=se[0],L[se]||(se=0));var me=U.pattern,Te=me&&d.getPatternAttr(me.shape,G.i,"");if(se&&se!=="none"){var _e=G.mgc;_e?le=!0:_e=de.color;var be=te.uid;le&&(be+="-"+G.i),d.gradient(W,B,be,se,[[0,_e],[1,K]],"fill")}else if(Te){var Ce=d.getPatternAttr(me.bgcolor,G.i,null),fe=d.getPatternAttr(me.fgcolor,G.i,null),ve=me.fgopacity,Me=d.getPatternAttr(me.size,G.i,8),ke=d.getPatternAttr(me.solidity,G.i,.3),Le=G.mcc||g.isArrayOrTypedArray(me.shape)||g.isArrayOrTypedArray(me.bgcolor)||g.isArrayOrTypedArray(me.size)||g.isArrayOrTypedArray(me.solidity),ze=te.uid;Le&&(ze+="-"+G.i),d.pattern(W,"point",B,ze,Te,Me,ke,G.mcc,me.fillmode,Ce,fe,ve)}else t.fill(W,K);ne&&t.stroke(W,re)}},d.makePointStyleFns=function(G){var W={},te=G.marker;return W.markerScale=d.tryColorscale(te,""),W.lineScale=d.tryColorscale(te,"line"),n.traceIs(G,"symbols")&&(W.ms2mrc=f.isBubble(G)?l(G):function(){return(te.size||6)/2}),G.selectedpoints&&g.extendFlat(W,d.makeSelectedPointStyleFns(G)),W},d.makeSelectedPointStyleFns=function(G){var W={},te=G.selected||{},N=G.unselected||{},B=G.marker||{},U=te.marker||{},ee=N.marker||{},j=B.opacity,Q=U.opacity,K=ee.opacity,re=Q!==void 0,ne=K!==void 0;(g.isArrayOrTypedArray(j)||re||ne)&&(W.selectedOpacityFn=function(Ce){var fe=Ce.mo===void 0?B.opacity:Ce.mo;return Ce.selected?re?Q:fe:ne?K:u*fe});var le=B.color,oe=U.color,de=ee.color;(oe||de)&&(W.selectedColorFn=function(Ce){var fe=Ce.mcc||le;return Ce.selected?oe||fe:de||fe});var se=B.size,me=U.size,Te=ee.size,_e=me!==void 0,be=Te!==void 0;return n.traceIs(G,"symbols")&&(_e||be)&&(W.selectedSizeFn=function(Ce){var fe=Ce.mrc||se/2;return Ce.selected?_e?me/2:fe:be?Te/2:fe}),W},d.makeSelectedTextStyleFns=function(G){var W={},te=G.selected||{},N=G.unselected||{},B=G.textfont||{},U=te.textfont||{},ee=N.textfont||{},j=B.color,Q=U.color,K=ee.color;return W.selectedTextColorFn=function(re){var ne=re.tc||j;return re.selected?Q||ne:K||(Q?ne:t.addOpacity(ne,u))},W},d.selectedPointStyle=function(G,W){if(G.size()&&W.selectedpoints){var te=d.makeSelectedPointStyleFns(W),N=W.marker||{},B=[];te.selectedOpacityFn&&B.push(function(U,ee){U.style("opacity",te.selectedOpacityFn(ee))}),te.selectedColorFn&&B.push(function(U,ee){t.fill(U,te.selectedColorFn(ee))}),te.selectedSizeFn&&B.push(function(U,ee){var j=ee.mx||N.symbol||0,Q=te.selectedSizeFn(ee);U.attr("d",T(d.symbolNumber(j),Q)),ee.mrc2=Q}),B.length&&G.each(function(U){for(var ee=p.select(this),j=0;j<B.length;j++)B[j](ee,U)})}},d.tryColorscale=function(G,W){var te=W?g.nestedProperty(G,W).get():G;if(te){var N=te.color;if((te.colorscale||te._colorAx)&&g.isArrayOrTypedArray(N))return a.makeColorScaleFuncFromTrace(te)}return g.identity};var A={start:1,end:-1,middle:0,bottom:1,top:-1};function I(G,W,te,N,B){var U=p.select(G.node().parentNode),ee=W.indexOf("top")!==-1?"top":W.indexOf("bottom")!==-1?"bottom":"middle",j=W.indexOf("left")!==-1?"end":W.indexOf("right")!==-1?"start":"middle",Q=N?N/.8+1:0,K=(m.lineCount(G)-1)*i+1,re=A[j]*Q,ne=.75*te+A[ee]*Q+(A[ee]-1)*K*te/2;G.attr("text-anchor",j),B||U.attr("transform",r(re,ne))}function P(G,W){var te=G.ts||W.textfont.size;return y(te)&&te>0?te:0}d.textPointStyle=function(G,W,te){if(G.size()){var N;if(W.selectedpoints){var B=d.makeSelectedTextStyleFns(W);N=B.selectedTextColorFn}var U=W.texttemplate,ee=te._fullLayout;G.each(function(j){var Q=p.select(this),K=U?g.extractOption(j,W,"txt","texttemplate"):g.extractOption(j,W,"tx","text");if(K||K===0){if(U){var re=W._module.formatLabels,ne=re?re(j,W,ee):{},le={};h(le,W,j.i);var oe=W._meta||{};K=g.texttemplateString(K,ne,ee._d3locale,le,j,oe)}var de=j.tp||W.textposition,se=P(j,W),me=N?N(j):j.tc||W.textfont.color;Q.call(d.font,j.tf||W.textfont.family,se,me).text(K).call(m.convertToTspans,te).call(I,de,se,j.mrc)}else Q.remove()})}},d.selectedTextStyle=function(G,W){if(G.size()&&W.selectedpoints){var te=d.makeSelectedTextStyleFns(W);G.each(function(N){var B=p.select(this),U=te.selectedTextColorFn(N),ee=N.tp||W.textposition,j=P(N,W);t.fill(B,U);var Q=n.traceIs(W,"bar-like");I(B,ee,j,N.mrc2||N.mrc,Q)})}};function S(G,W,te,N){var B=G[0]-W[0],U=G[1]-W[1],ee=te[0]-W[0],j=te[1]-W[1],Q=Math.pow(B*B+U*U,.25),K=Math.pow(ee*ee+j*j,.25),re=(K*K*B-Q*Q*ee)*N,ne=(K*K*U-Q*Q*j)*N,le=3*K*(Q+K),oe=3*Q*(Q+K);return[[p.round(W[0]+(le&&re/le),2),p.round(W[1]+(le&&ne/le),2)],[p.round(W[0]-(oe&&re/oe),2),p.round(W[1]-(oe&&ne/oe),2)]]}d.smoothopen=function(G,W){if(G.length<3)return"M"+G.join("L");var te,N="M"+G[0],B=[];for(te=1;te<G.length-1;te++)B.push(S(G[te-1],G[te],G[te+1],W));for(N+="Q"+B[0][0]+" "+G[1],te=2;te<G.length-1;te++)N+="C"+B[te-2][1]+" "+B[te-1][0]+" "+G[te];return N+="Q"+B[G.length-3][1]+" "+G[G.length-1]},d.smoothclosed=function(G,W){if(G.length<3)return"M"+G.join("L")+"Z";var te,N="M"+G[0],B=G.length-1,U=[S(G[B],G[0],G[1],W)];for(te=1;te<B;te++)U.push(S(G[te-1],G[te],G[te+1],W));for(U.push(S(G[B-1],G[B],G[0],W)),te=1;te<=B;te++)N+="C"+U[te-1][1]+" "+U[te][0]+" "+G[te];return N+="C"+U[B][1]+" "+U[0][0]+" "+G[0]+"Z"};var E={hv:function(G,W){return"H"+p.round(W[0],2)+"V"+p.round(W[1],2)},vh:function(G,W){return"V"+p.round(W[1],2)+"H"+p.round(W[0],2)},hvh:function(G,W){return"H"+p.round((G[0]+W[0])/2,2)+"V"+p.round(W[1],2)+"H"+p.round(W[0],2)},vhv:function(G,W){return"V"+p.round((G[1]+W[1])/2,2)+"H"+p.round(W[0],2)+"V"+p.round(W[1],2)}},D=function(G,W){return"L"+p.round(W[0],2)+","+p.round(W[1],2)};d.steps=function(G){var W=E[G]||D;return function(te){for(var N="M"+p.round(te[0][0],2)+","+p.round(te[0][1],2),B=1;B<te.length;B++)N+=W(te[B-1],te[B]);return N}},d.makeTester=function(){var G=g.ensureSingleById(p.select("body"),"svg","js-plotly-tester",function(te){te.attr(o.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),W=g.ensureSingle(G,"path","js-reference-point",function(te){te.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});d.tester=G,d.testref=W},d.savedBBoxes={};var R=0;function H(G){var W=G.getAttribute("data-unformatted");if(W!==null)return W+G.getAttribute("data-math")+G.getAttribute("text-anchor")+G.getAttribute("style")}function V(G,W){if(!G)return null;var te=W._context,N=te._exportedPlot?"":te._baseUrl||"";return N?"url('"+N+"#"+G+"')":"url(#"+G+")"}d.bBox=function(G,W,te){var N,B,U;if(te||(te=H(G)),te){if(N=d.savedBBoxes[te])return g.extendFlat({},N)}else if(G.childNodes.length===1){var ee=G.childNodes[0];if(te=H(ee)){var j=+ee.getAttribute("x")||0,Q=+ee.getAttribute("y")||0,K=ee.getAttribute("transform");if(!K){var re=d.bBox(ee,!1,te);return j&&(re.left+=j,re.right+=j),Q&&(re.top+=Q,re.bottom+=Q),re}if(te+="~"+j+"~"+Q+"~"+K,N=d.savedBBoxes[te])return g.extendFlat({},N)}}W?B=G:(U=d.tester.node(),B=G.cloneNode(!0),U.appendChild(B)),p.select(B).attr("transform",null).call(m.positionText,0,0);var ne=B.getBoundingClientRect(),le=d.testref.node().getBoundingClientRect();W||U.removeChild(B);var oe={height:ne.height,width:ne.width,left:ne.left-le.left,top:ne.top-le.top,right:ne.right-le.left,bottom:ne.bottom-le.top};return R>=1e4&&(d.savedBBoxes={},R=0),te&&(d.savedBBoxes[te]=oe),R++,g.extendFlat({},oe)},d.setClipUrl=function(G,W,te){G.attr("clip-path",V(W,te))},d.getTranslate=function(G){var W=(G[G.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(te,N,B){return[N,B].join(" ")}).split(" ");return{x:+W[0]||0,y:+W[1]||0}},d.setTranslate=function(G,W,te){var N=G.attr?"attr":"getAttribute",B=G.attr?"attr":"setAttribute",U=G[N]("transform")||"";return W=W||0,te=te||0,U=U.replace(/(\btranslate\(.*?\);?)/,"").trim(),U=(U+=r(W,te)).trim(),G[B]("transform",U),U},d.getScale=function(G){var W=(G[G.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(te,N,B){return[N,B].join(" ")}).split(" ");return{x:+W[0]||1,y:+W[1]||1}},d.setScale=function(G,W,te){var N=G.attr?"attr":"getAttribute",B=G.attr?"attr":"setAttribute",U=G[N]("transform")||"";return W=W||1,te=te||1,U=U.replace(/(\bscale\(.*?\);?)/,"").trim(),U=(U+="scale("+W+","+te+")").trim(),G[B]("transform",U),U};var X=/\s*sc.*/;d.setPointGroupScale=function(G,W,te){if(W=W||1,te=te||1,G){var N=W===1&&te===1?"":"scale("+W+","+te+")";G.each(function(){var B=(this.getAttribute("transform")||"").replace(X,"");B=(B+=N).trim(),this.setAttribute("transform",B)})}};var $=/translate\([^)]*\)\s*$/;d.setTextPointsScale=function(G,W,te){G&&G.each(function(){var N,B=p.select(this),U=B.select("text");if(U.node()){var ee=parseFloat(U.attr("x")||0),j=parseFloat(U.attr("y")||0),Q=(B.attr("transform")||"").match($);N=W===1&&te===1?[]:[r(ee,j),"scale("+W+","+te+")",r(-ee,-j)],Q&&N.push(Q),B.attr("transform",N.join(""))}})}},{"../../components/fx/helpers":403,"../../constants/alignment":483,"../../constants/interactions":490,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../registry":647,"../../traces/scatter/make_bubble_size_func":953,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale":379,"./symbol_defs":390,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],390:[function(v,J,Z){var p=v("@plotly/d3");J.exports={circle:{n:0,f:function(g){var b=p.round(g,2);return"M"+b+",0A"+b+","+b+" 0 1,1 0,-"+b+"A"+b+","+b+" 0 0,1 "+b+",0Z"}},square:{n:1,f:function(g){var b=p.round(g,2);return"M"+b+","+b+"H-"+b+"V-"+b+"H"+b+"Z"}},diamond:{n:2,f:function(g){var b=p.round(1.3*g,2);return"M"+b+",0L0,"+b+"L-"+b+",0L0,-"+b+"Z"}},cross:{n:3,f:function(g){var b=p.round(.4*g,2),y=p.round(1.2*g,2);return"M"+y+","+b+"H"+b+"V"+y+"H-"+b+"V"+b+"H-"+y+"V-"+b+"H-"+b+"V-"+y+"H"+b+"V-"+b+"H"+y+"Z"}},x:{n:4,f:function(g){var b=p.round(.8*g/Math.sqrt(2),2),y="l"+b+","+b,e="l"+b+",-"+b,n="l-"+b+",-"+b,t="l-"+b+","+b;return"M0,"+b+y+e+n+e+n+t+n+t+y+t+y+"Z"}},"triangle-up":{n:5,f:function(g){var b=p.round(2*g/Math.sqrt(3),2);return"M-"+b+","+p.round(g/2,2)+"H"+b+"L0,-"+p.round(g,2)+"Z"}},"triangle-down":{n:6,f:function(g){var b=p.round(2*g/Math.sqrt(3),2);return"M-"+b+",-"+p.round(g/2,2)+"H"+b+"L0,"+p.round(g,2)+"Z"}},"triangle-left":{n:7,f:function(g){var b=p.round(2*g/Math.sqrt(3),2);return"M"+p.round(g/2,2)+",-"+b+"V"+b+"L-"+p.round(g,2)+",0Z"}},"triangle-right":{n:8,f:function(g){var b=p.round(2*g/Math.sqrt(3),2);return"M-"+p.round(g/2,2)+",-"+b+"V"+b+"L"+p.round(g,2)+",0Z"}},"triangle-ne":{n:9,f:function(g){var b=p.round(.6*g,2),y=p.round(1.2*g,2);return"M-"+y+",-"+b+"H"+b+"V"+y+"Z"}},"triangle-se":{n:10,f:function(g){var b=p.round(.6*g,2),y=p.round(1.2*g,2);return"M"+b+",-"+y+"V"+b+"H-"+y+"Z"}},"triangle-sw":{n:11,f:function(g){var b=p.round(.6*g,2),y=p.round(1.2*g,2);return"M"+y+","+b+"H-"+b+"V-"+y+"Z"}},"triangle-nw":{n:12,f:function(g){var b=p.round(.6*g,2),y=p.round(1.2*g,2);return"M-"+b+","+y+"V-"+b+"H"+y+"Z"}},pentagon:{n:13,f:function(g){var b=p.round(.951*g,2),y=p.round(.588*g,2),e=p.round(-g,2),n=p.round(-.309*g,2);return"M"+b+","+n+"L"+y+","+p.round(.809*g,2)+"H-"+y+"L-"+b+","+n+"L0,"+e+"Z"}},hexagon:{n:14,f:function(g){var b=p.round(g,2),y=p.round(g/2,2),e=p.round(g*Math.sqrt(3)/2,2);return"M"+e+",-"+y+"V"+y+"L0,"+b+"L-"+e+","+y+"V-"+y+"L0,-"+b+"Z"}},hexagon2:{n:15,f:function(g){var b=p.round(g,2),y=p.round(g/2,2),e=p.round(g*Math.sqrt(3)/2,2);return"M-"+y+","+e+"H"+y+"L"+b+",0L"+y+",-"+e+"H-"+y+"L-"+b+",0Z"}},octagon:{n:16,f:function(g){var b=p.round(.924*g,2),y=p.round(.383*g,2);return"M-"+y+",-"+b+"H"+y+"L"+b+",-"+y+"V"+y+"L"+y+","+b+"H-"+y+"L-"+b+","+y+"V-"+y+"Z"}},star:{n:17,f:function(g){var b=1.4*g,y=p.round(.225*b,2),e=p.round(.951*b,2),n=p.round(.363*b,2),t=p.round(.588*b,2),a=p.round(-b,2),r=p.round(-.309*b,2),m=p.round(.118*b,2),o=p.round(.809*b,2);return"M"+y+","+r+"H"+e+"L"+n+","+m+"L"+t+","+o+"L0,"+p.round(.382*b,2)+"L-"+t+","+o+"L-"+n+","+m+"L-"+e+","+r+"H-"+y+"L0,"+a+"Z"}},hexagram:{n:18,f:function(g){var b=p.round(.66*g,2),y=p.round(.38*g,2),e=p.round(.76*g,2);return"M-"+e+",0l-"+y+",-"+b+"h"+e+"l"+y+",-"+b+"l"+y+","+b+"h"+e+"l-"+y+","+b+"l"+y+","+b+"h-"+e+"l-"+y+","+b+"l-"+y+",-"+b+"h-"+e+"Z"}},"star-triangle-up":{n:19,f:function(g){var b=p.round(g*Math.sqrt(3)*.8,2),y=p.round(.8*g,2),e=p.round(1.6*g,2),n=p.round(4*g,2),t="A "+n+","+n+" 0 0 1 ";return"M-"+b+","+y+t+b+","+y+t+"0,-"+e+t+"-"+b+","+y+"Z"}},"star-triangle-down":{n:20,f:function(g){var b=p.round(g*Math.sqrt(3)*.8,2),y=p.round(.8*g,2),e=p.round(1.6*g,2),n=p.round(4*g,2),t="A "+n+","+n+" 0 0 1 ";return"M"+b+",-"+y+t+"-"+b+",-"+y+t+"0,"+e+t+b+",-"+y+"Z"}},"star-square":{n:21,f:function(g){var b=p.round(1.1*g,2),y=p.round(2*g,2),e="A "+y+","+y+" 0 0 1 ";return"M-"+b+",-"+b+e+"-"+b+","+b+e+b+","+b+e+b+",-"+b+e+"-"+b+",-"+b+"Z"}},"star-diamond":{n:22,f:function(g){var b=p.round(1.4*g,2),y=p.round(1.9*g,2),e="A "+y+","+y+" 0 0 1 ";return"M-"+b+",0"+e+"0,"+b+e+b+",0"+e+"0,-"+b+e+"-"+b+",0Z"}},"diamond-tall":{n:23,f:function(g){var b=p.round(.7*g,2),y=p.round(1.4*g,2);return"M0,"+y+"L"+b+",0L0,-"+y+"L-"+b+",0Z"}},"diamond-wide":{n:24,f:function(g){var b=p.round(1.4*g,2),y=p.round(.7*g,2);return"M0,"+y+"L"+b+",0L0,-"+y+"L-"+b+",0Z"}},hourglass:{n:25,f:function(g){var b=p.round(g,2);return"M"+b+","+b+"H-"+b+"L"+b+",-"+b+"H-"+b+"Z"},noDot:!0},bowtie:{n:26,f:function(g){var b=p.round(g,2);return"M"+b+","+b+"V-"+b+"L-"+b+","+b+"V-"+b+"Z"},noDot:!0},"circle-cross":{n:27,f:function(g){var b=p.round(g,2);return"M0,"+b+"V-"+b+"M"+b+",0H-"+b+"M"+b+",0A"+b+","+b+" 0 1,1 0,-"+b+"A"+b+","+b+" 0 0,1 "+b+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(g){var b=p.round(g,2),y=p.round(g/Math.sqrt(2),2);return"M"+y+","+y+"L-"+y+",-"+y+"M"+y+",-"+y+"L-"+y+","+y+"M"+b+",0A"+b+","+b+" 0 1,1 0,-"+b+"A"+b+","+b+" 0 0,1 "+b+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(g){var b=p.round(g,2);return"M0,"+b+"V-"+b+"M"+b+",0H-"+b+"M"+b+","+b+"H-"+b+"V-"+b+"H"+b+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(g){var b=p.round(g,2);return"M"+b+","+b+"L-"+b+",-"+b+"M"+b+",-"+b+"L-"+b+","+b+"M"+b+","+b+"H-"+b+"V-"+b+"H"+b+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(g){var b=p.round(1.3*g,2);return"M"+b+",0L0,"+b+"L-"+b+",0L0,-"+b+"ZM0,-"+b+"V"+b+"M-"+b+",0H"+b},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(g){var b=p.round(1.3*g,2),y=p.round(.65*g,2);return"M"+b+",0L0,"+b+"L-"+b+",0L0,-"+b+"ZM-"+y+",-"+y+"L"+y+","+y+"M-"+y+","+y+"L"+y+",-"+y},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(g){var b=p.round(1.4*g,2);return"M0,"+b+"V-"+b+"M"+b+",0H-"+b},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(g){var b=p.round(g,2);return"M"+b+","+b+"L-"+b+",-"+b+"M"+b+",-"+b+"L-"+b+","+b},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(g){var b=p.round(1.2*g,2),y=p.round(.85*g,2);return"M0,"+b+"V-"+b+"M"+b+",0H-"+b+"M"+y+","+y+"L-"+y+",-"+y+"M"+y+",-"+y+"L-"+y+","+y},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(g){var b=p.round(g/2,2),y=p.round(g,2);return"M"+b+","+y+"V-"+y+"m-"+y+",0V"+y+"M"+y+","+b+"H-"+y+"m0,-"+y+"H"+y},needLine:!0,noFill:!0},"y-up":{n:37,f:function(g){var b=p.round(1.2*g,2),y=p.round(1.6*g,2),e=p.round(.8*g,2);return"M-"+b+","+e+"L0,0M"+b+","+e+"L0,0M0,-"+y+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(g){var b=p.round(1.2*g,2),y=p.round(1.6*g,2),e=p.round(.8*g,2);return"M-"+b+",-"+e+"L0,0M"+b+",-"+e+"L0,0M0,"+y+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(g){var b=p.round(1.2*g,2),y=p.round(1.6*g,2),e=p.round(.8*g,2);return"M"+e+","+b+"L0,0M"+e+",-"+b+"L0,0M-"+y+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(g){var b=p.round(1.2*g,2),y=p.round(1.6*g,2),e=p.round(.8*g,2);return"M-"+e+","+b+"L0,0M-"+e+",-"+b+"L0,0M"+y+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(g){var b=p.round(1.4*g,2);return"M"+b+",0H-"+b},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(g){var b=p.round(1.4*g,2);return"M0,"+b+"V-"+b},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(g){var b=p.round(g,2);return"M"+b+",-"+b+"L-"+b+","+b},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(g){var b=p.round(g,2);return"M"+b+","+b+"L-"+b+",-"+b},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(g){var b=p.round(g,2);return"M0,0L-"+b+","+p.round(2*g,2)+"H"+b+"Z"},noDot:!0},"arrow-down":{n:46,f:function(g){var b=p.round(g,2);return"M0,0L-"+b+",-"+p.round(2*g,2)+"H"+b+"Z"},noDot:!0},"arrow-left":{n:47,f:function(g){var b=p.round(2*g,2),y=p.round(g,2);return"M0,0L"+b+",-"+y+"V"+y+"Z"},noDot:!0},"arrow-right":{n:48,f:function(g){var b=p.round(2*g,2),y=p.round(g,2);return"M0,0L-"+b+",-"+y+"V"+y+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(g){var b=p.round(g,2);return"M-"+b+",0H"+b+"M0,0L-"+b+","+p.round(2*g,2)+"H"+b+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(g){var b=p.round(g,2);return"M-"+b+",0H"+b+"M0,0L-"+b+",-"+p.round(2*g,2)+"H"+b+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(g){var b=p.round(2*g,2),y=p.round(g,2);return"M0,-"+y+"V"+y+"M0,0L"+b+",-"+y+"V"+y+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(g){var b=p.round(2*g,2),y=p.round(g,2);return"M0,-"+y+"V"+y+"M0,0L-"+b+",-"+y+"V"+y+"Z"},needLine:!0,noDot:!0}}},{"@plotly/d3":58}],391:[function(v,J,Z){J.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],392:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../registry"),b=v("../../plots/cartesian/axes"),y=v("../../lib"),e=v("./compute_error");function n(t,a,r,m){var o=a["error_"+m]||{},i=[];if(o.visible&&["linear","log"].indexOf(r.type)!==-1){for(var u=e(o),f=0;f<t.length;f++){var l=t[f],h=l.i;if(h===void 0)h=f;else if(h===null)continue;var d=l[m];if(p(r.c2l(d))){var s=u(d,h);if(p(s[0])&&p(s[1])){var x=l[m+"s"]=d-s[0],c=l[m+"h"]=d+s[1];i.push(x,c)}}}var T=r._id,_=a._extremes[T],w=b.findExtremes(r,i,y.extendFlat({tozero:_.opts.tozero},{padded:!0}));_.min=_.min.concat(w.min),_.max=_.max.concat(w.max)}}J.exports=function(t){for(var a=t.calcdata,r=0;r<a.length;r++){var m=a[r],o=m[0].trace;if(o.visible===!0&&g.traceIs(o,"errorBarsOK")){var i=b.getFromId(t,o.xaxis),u=b.getFromId(t,o.yaxis);n(m,o,i,"x"),n(m,o,u,"y")}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./compute_error":393,"fast-isnumeric":190}],393:[function(v,J,Z){function p(g,b){return g==="percent"?function(y){return Math.abs(y*b/100)}:g==="constant"?function(){return Math.abs(b)}:g==="sqrt"?function(y){return Math.sqrt(Math.abs(y))}:void 0}J.exports=function(g){var b=g.type,y=g.symmetric;if(b==="data"){var e=g.array||[];if(y)return function(r,m){var o=+e[m];return[o,o]};var n=g.arrayminus||[];return function(r,m){var o=+e[m],i=+n[m];return isNaN(o)&&isNaN(i)?[NaN,NaN]:[i||0,o||0]}}var t=p(b,g.value),a=p(b,g.valueminus);return y||g.valueminus===void 0?function(r){var m=t(r);return[m,m]}:function(r){return[a(r),t(r)]}}},{}],394:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../registry"),b=v("../../lib"),y=v("../../plot_api/plot_template"),e=v("./attributes");J.exports=function(n,t,a,r){var m="error_"+r.axis,o=y.newContainer(t,m),i=n[m]||{};function u(d,s){return b.coerce(i,o,e,d,s)}if(u("visible",i.array!==void 0||i.value!==void 0||i.type==="sqrt")!==!1){var f=u("type","array"in i?"data":"percent"),l=!0;f!=="sqrt"&&(l=u("symmetric",!((f==="data"?"arrayminus":"valueminus")in i))),f==="data"?(u("array"),u("traceref"),l||(u("arrayminus"),u("tracerefminus"))):f!=="percent"&&f!=="constant"||(u("value"),l||u("valueminus"));var h="copy_"+r.inherit+"style";r.inherit&&(t["error_"+r.inherit]||{}).visible&&u(h,!(i.color||p(i.thickness)||p(i.width))),r.inherit&&o[h]||(u("color",a),u("thickness"),u("width",g.traceIs(t,"gl3d")?0:4))}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"./attributes":391,"fast-isnumeric":190}],395:[function(v,J,Z){var p=v("../../lib"),g=v("../../plot_api/edit_types").overrideAll,b=v("./attributes"),y={error_x:p.extendFlat({},b),error_y:p.extendFlat({},b)};delete y.error_x.copy_zstyle,delete y.error_y.copy_zstyle,delete y.error_y.copy_ystyle;var e={error_x:p.extendFlat({},b),error_y:p.extendFlat({},b),error_z:p.extendFlat({},b)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,J.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:y,bar:y,histogram:y,scatter3d:g(e,"calc","nested"),scattergl:g(y,"calc","nested")}},supplyDefaults:v("./defaults"),calc:v("./calc"),makeComputeError:v("./compute_error"),plot:v("./plot"),style:v("./style"),hoverInfo:function(n,t,a){(t.error_y||{}).visible&&(a.yerr=n.yh-n.y,t.error_y.symmetric||(a.yerrneg=n.y-n.ys)),(t.error_x||{}).visible&&(a.xerr=n.xh-n.x,t.error_x.symmetric||(a.xerrneg=n.x-n.xs))}}},{"../../lib":515,"../../plot_api/edit_types":548,"./attributes":391,"./calc":392,"./compute_error":393,"./defaults":394,"./plot":396,"./style":397}],396:[function(v,J,Z){var p=v("@plotly/d3"),g=v("fast-isnumeric"),b=v("../drawing"),y=v("../../traces/scatter/subtypes");J.exports=function(e,n,t,a){var r=t.xaxis,m=t.yaxis,o=a&&a.duration>0;n.each(function(i){var u,f=i[0].trace,l=f.error_x||{},h=f.error_y||{};f.ids&&(u=function(c){return c.id});var d=y.hasMarkers(f)&&f.marker.maxdisplayed>0;h.visible||l.visible||(i=[]);var s=p.select(this).selectAll("g.errorbar").data(i,u);if(s.exit().remove(),i.length){l.visible||s.selectAll("path.xerror").remove(),h.visible||s.selectAll("path.yerror").remove(),s.style("opacity",1);var x=s.enter().append("g").classed("errorbar",!0);o&&x.style("opacity",0).transition().duration(a.duration).style("opacity",1),b.setClipUrl(s,t.layerClipId,e),s.each(function(c){var T=p.select(this),_=function(P,S,E){var D={x:S.c2p(P.x),y:E.c2p(P.y)};return P.yh!==void 0&&(D.yh=E.c2p(P.yh),D.ys=E.c2p(P.ys),g(D.ys)||(D.noYS=!0,D.ys=E.c2p(P.ys,!0))),P.xh!==void 0&&(D.xh=S.c2p(P.xh),D.xs=S.c2p(P.xs),g(D.xs)||(D.noXS=!0,D.xs=S.c2p(P.xs,!0))),D}(c,r,m);if(!d||c.vis){var w,k=T.select("path.yerror");if(h.visible&&g(_.x)&&g(_.yh)&&g(_.ys)){var L=h.width;w="M"+(_.x-L)+","+_.yh+"h"+2*L+"m-"+L+",0V"+_.ys,_.noYS||(w+="m-"+L+",0h"+2*L),k.size()?o&&(k=k.transition().duration(a.duration).ease(a.easing)):k=T.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),k.attr("d",w)}else k.remove();var A=T.select("path.xerror");if(l.visible&&g(_.y)&&g(_.xh)&&g(_.xs)){var I=(l.copy_ystyle?h:l).width;w="M"+_.xh+","+(_.y-I)+"v"+2*I+"m0,-"+I+"H"+_.xs,_.noXS||(w+="m0,-"+I+"v"+2*I),A.size()?o&&(A=A.transition().duration(a.duration).ease(a.easing)):A=T.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),A.attr("d",w)}else A.remove()}})}})}},{"../../traces/scatter/subtypes":961,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],397:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../color");J.exports=function(b){b.each(function(y){var e=y[0].trace,n=e.error_y||{},t=e.error_x||{},a=p.select(this);a.selectAll("path.yerror").style("stroke-width",n.thickness+"px").call(g.stroke,n.color),t.copy_ystyle&&(t=n),a.selectAll("path.xerror").style("stroke-width",t.thickness+"px").call(g.stroke,t.color)})}},{"../color":367,"@plotly/d3":58}],398:[function(v,J,Z){var p=v("../../plots/font_attributes"),g=v("./layout_attributes").hoverlabel,b=v("../../lib/extend").extendFlat;J.exports={hoverlabel:{bgcolor:b({},g.bgcolor,{arrayOk:!0}),bordercolor:b({},g.bordercolor,{arrayOk:!0}),font:p({arrayOk:!0,editType:"none"}),align:b({},g.align,{arrayOk:!0}),namelength:b({},g.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":505,"../../plots/font_attributes":594,"./layout_attributes":408}],399:[function(v,J,Z){var p=v("../../lib"),g=v("../../registry");function b(y,e,n,t){t=t||p.identity,Array.isArray(y)&&(e[0][n]=t(y))}J.exports=function(y){var e=y.calcdata,n=y._fullLayout;function t(i){return function(u){return p.coerceHoverinfo({hoverinfo:u},{_module:i._module},n)}}for(var a=0;a<e.length;a++){var r=e[a],m=r[0].trace;if(!g.traceIs(m,"pie-like")){var o=g.traceIs(m,"2dMap")?b:p.fillArray;o(m.hoverinfo,r,"hi",t(m)),m.hovertemplate&&o(m.hovertemplate,r,"ht"),m.hoverlabel&&(o(m.hoverlabel.bgcolor,r,"hbg"),o(m.hoverlabel.bordercolor,r,"hbc"),o(m.hoverlabel.font.size,r,"hts"),o(m.hoverlabel.font.color,r,"htc"),o(m.hoverlabel.font.family,r,"htf"),o(m.hoverlabel.namelength,r,"hnl"),o(m.hoverlabel.align,r,"hta"))}}}},{"../../lib":515,"../../registry":647}],400:[function(v,J,Z){var p=v("../../registry"),g=v("./hover").hover;J.exports=function(b,y,e){var n=p.getComponentMethod("annotations","onClick")(b,b._hoverdata);function t(){b.emit("plotly_click",{points:b._hoverdata,event:y})}e!==void 0&&g(b,y,e,!0),b._hoverdata&&y&&y.target&&(n&&n.then?n.then(t):t(),y.stopImmediatePropagation&&y.stopImmediatePropagation())}},{"../../registry":647,"./hover":404}],401:[function(v,J,Z){J.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],402:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes"),b=v("./hoverlabel_defaults");J.exports=function(y,e,n,t){var a=p.extendFlat({},t.hoverlabel);e.hovertemplate&&(a.namelength=-1),b(y,e,function(r,m){return p.coerce(y,e,g,r,m)},a)}},{"../../lib":515,"./attributes":398,"./hoverlabel_defaults":405}],403:[function(v,J,Z){var p=v("../../lib");Z.getSubplot=function(t){return t.subplot||t.xaxis+t.yaxis||t.geo},Z.isTraceInSubplots=function(t,a){if(t.type==="splom"){for(var r=t.xaxes||[],m=t.yaxes||[],o=0;o<r.length;o++)for(var i=0;i<m.length;i++)if(a.indexOf(r[o]+m[i])!==-1)return!0;return!1}return a.indexOf(Z.getSubplot(t))!==-1},Z.flat=function(t,a){for(var r=new Array(t.length),m=0;m<t.length;m++)r[m]=a;return r},Z.p2c=function(t,a){for(var r=new Array(t.length),m=0;m<t.length;m++)r[m]=t[m].p2c(a);return r},Z.getDistanceFunction=function(t,a,r,m){return t==="closest"?m||Z.quadrature(a,r):t.charAt(0)==="x"?a:r},Z.getClosest=function(t,a,r){if(r.index!==!1)r.index>=0&&r.index<t.length?r.distance=0:r.index=!1;else for(var m=0;m<t.length;m++){var o=a(t[m]);o<=r.distance&&(r.index=m,r.distance=o)}return r},Z.inbox=function(t,a,r){return t*a<0||t===0?r:1/0},Z.quadrature=function(t,a){return function(r){var m=t(r),o=a(r);return Math.sqrt(m*m+o*o)}},Z.makeEventData=function(t,a,r){var m="index"in t?t.index:t.pointNumber,o={data:a._input,fullData:a,curveNumber:a.index,pointNumber:m};if(a._indexToPoints){var i=a._indexToPoints[m];i.length===1?o.pointIndex=i[0]:o.pointIndices=i}else o.pointIndex=m;return a._module.eventData?o=a._module.eventData(o,t,a,r,m):("xVal"in t?o.x=t.xVal:"x"in t&&(o.x=t.x),"yVal"in t?o.y=t.yVal:"y"in t&&(o.y=t.y),t.xa&&(o.xaxis=t.xa),t.ya&&(o.yaxis=t.ya),t.zLabelVal!==void 0&&(o.z=t.zLabelVal)),Z.appendArrayPointValue(o,a,m),o},Z.appendArrayPointValue=function(t,a,r){var m=a._arrayAttrs;if(m)for(var o=0;o<m.length;o++){var i=m[o],u=b(i);if(t[u]===void 0){var f=y(p.nestedProperty(a,i).get(),r);f!==void 0&&(t[u]=f)}}},Z.appendArrayMultiPointValues=function(t,a,r){var m=a._arrayAttrs;if(m)for(var o=0;o<m.length;o++){var i=m[o],u=b(i);if(t[u]===void 0){for(var f=p.nestedProperty(a,i).get(),l=new Array(r.length),h=0;h<r.length;h++)l[h]=y(f,r[h]);t[u]=l}}};var g={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function b(t){return g[t]||t}function y(t,a){return Array.isArray(a)?Array.isArray(t)&&Array.isArray(t[a[0]])?t[a[0]][a[1]]:void 0:t[a]}var e={x:!0,y:!0},n={"x unified":!0,"y unified":!0};Z.isUnifiedHover=function(t){return typeof t=="string"&&!!n[t]},Z.isXYhover=function(t){return typeof t=="string"&&!!e[t]}},{"../../lib":515}],404:[function(v,J,Z){var p=v("@plotly/d3"),g=v("fast-isnumeric"),b=v("tinycolor2"),y=v("../../lib"),e=y.strTranslate,n=y.strRotate,t=v("../../lib/events"),a=v("../../lib/svg_text_utils"),r=v("../../lib/override_cursor"),m=v("../drawing"),o=v("../color"),i=v("../dragelement"),u=v("../../plots/cartesian/axes"),f=v("../../registry"),l=v("./helpers"),h=v("./constants"),d=v("../legend/defaults"),s=v("../legend/draw"),x=h.YANGLE,c=Math.PI*x/180,T=1/Math.sin(c),_=Math.cos(c),w=Math.sin(c),k=h.HOVERARROWSIZE,L=h.HOVERTEXTPAD,A={box:!0,ohlc:!0,violin:!0,candlestick:!0},I={scatter:!0,scattergl:!0,splom:!0};function P(B){return[B.trace.index,B.index,B.x0,B.y0,B.name,B.attr,B.xa?B.xa._id:"",B.ya?B.ya._id:""].join(",")}Z.hover=function(B,U,ee,j){B=y.getGraphDiv(B);var Q=U.target;y.throttle(B._fullLayout._uid+h.HOVERID,h.HOVERMINTIME,function(){(function(K,re,ne,le,oe){ne||(ne="xy");var de=Array.isArray(ne)?ne:[ne],se=K._fullLayout,me=se._plots||[],Te=me[ne],_e=se._has("cartesian");if(Te){var be=Te.overlays.map(function(Br){return Br.id});de=de.concat(be)}for(var Ce=de.length,fe=new Array(Ce),ve=new Array(Ce),Me=!1,ke=0;ke<Ce;ke++){var Le=de[ke];if(me[Le])Me=!0,fe[ke]=me[Le].xaxis,ve[ke]=me[Le].yaxis;else{if(!se[Le]||!se[Le]._subplot)return void y.warn("Unrecognized subplot: "+Le);var ze=se[Le]._subplot;fe[ke]=ze.xaxis,ve[ke]=ze.yaxis}}var Re=re.hovermode||se.hovermode;if(Re&&!Me&&(Re="closest"),["x","y","closest","x unified","y unified"].indexOf(Re)===-1||!K.calcdata||K.querySelector(".zoombox")||K._dragging)return i.unhoverRaw(K,re);var Oe=se.hoverdistance;Oe===-1&&(Oe=1/0);var Ze=se.spikedistance;Ze===-1&&(Ze=1/0);var Pe,Ie,Be,Fe,$e,ot,pt,_t,yt,tt,Ke,vt,Nt,qt=[],er=[],Jt={hLinePoint:null,vLinePoint:null},ir=!1;if(Array.isArray(re))for(Re="array",Be=0;Be<re.length;Be++)($e=K.calcdata[re[Be].curveNumber||0])&&(ot=$e[0].trace,$e[0].trace.hoverinfo!=="skip"&&(er.push($e),ot.orientation==="h"&&(ir=!0)));else{for(Fe=0;Fe<K.calcdata.length;Fe++)$e=K.calcdata[Fe],(ot=$e[0].trace).hoverinfo!=="skip"&&l.isTraceInSubplots(ot,de)&&(er.push($e),ot.orientation==="h"&&(ir=!0));var Ht,Ue;if(!oe)Ht="xpx"in re?re.xpx:fe[0]._length/2,Ue="ypx"in re?re.ypx:ve[0]._length/2;else{if(t.triggerHandler(K,"plotly_beforehover",re)===!1)return;var We=oe.getBoundingClientRect();Ht=re.clientX-We.left,Ue=re.clientY-We.top,se._calcInverseTransform(K);var he=y.apply3DTransform(se._invTransform)(Ht,Ue);if(Ht=he[0],Ue=he[1],Ht<0||Ht>fe[0]._length||Ue<0||Ue>ve[0]._length)return i.unhoverRaw(K,re)}if(re.pointerX=Ht+fe[0]._offset,re.pointerY=Ue+ve[0]._offset,Pe="xval"in re?l.flat(de,re.xval):l.p2c(fe,Ht),Ie="yval"in re?l.flat(de,re.yval):l.p2c(ve,Ue),!g(Pe[0])||!g(Ie[0]))return y.warn("Fx.hover failed",re,K),i.unhoverRaw(K,re)}var xe=1/0;function De(Br,pn){for(Fe=0;Fe<er.length;Fe++)if(($e=er[Fe])&&$e[0]&&$e[0].trace&&(ot=$e[0].trace).visible===!0&&ot._length!==0&&["carpet","contourcarpet"].indexOf(ot._module.name)===-1){if(ot.type==="splom"?pt=de[_t=0]:(pt=l.getSubplot(ot),_t=de.indexOf(pt)),yt=Re,l.isUnifiedHover(yt)&&(yt=yt.charAt(0)),vt={cd:$e,trace:ot,xa:fe[_t],ya:ve[_t],maxHoverDistance:Oe,maxSpikeDistance:Ze,index:!1,distance:Math.min(xe,Oe),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:o.defaultLine,name:ot.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},se[pt]&&(vt.subplot=se[pt]._subplot),se._splomScenes&&se._splomScenes[ot.uid]&&(vt.scene=se._splomScenes[ot.uid]),Nt=qt.length,yt==="array"){var on=re[Fe];"pointNumber"in on?(vt.index=on.pointNumber,yt="closest"):(yt="","xval"in on&&(tt=on.xval,yt="x"),"yval"in on&&(Ke=on.yval,yt=yt?"closest":"y"))}else Br!==void 0&&pn!==void 0?(tt=Br,Ke=pn):(tt=Pe[_t],Ke=Ie[_t]);if(Oe!==0)if(ot._module&&ot._module.hoverPoints){var Yr=ot._module.hoverPoints(vt,tt,Ke,yt,{finiteRange:!0,hoverLayer:se._hoverlayer});if(Yr)for(var Nn,Hn=0;Hn<Yr.length;Hn++)Nn=Yr[Hn],g(Nn.x0)&&g(Nn.y0)&&qt.push(H(Nn,Re))}else y.log("Unrecognized trace type in hover:",ot);if(Re==="closest"&&qt.length>Nt&&(qt.splice(0,Nt),xe=qt[0].distance),_e&&Ze!==0&&qt.length===0){vt.distance=Ze,vt.index=!1;var xn=ot._module.hoverPoints(vt,tt,Ke,"closest",{hoverLayer:se._hoverlayer});if(xn&&(xn=xn.filter(function(lr){return lr.spikeDistance<=Ze})),xn&&xn.length){var On,ua=xn.filter(function(lr){return lr.xa.showspikes&&lr.xa.spikesnap!=="hovered data"});if(ua.length){var tr=ua[0];g(tr.x0)&&g(tr.y0)&&(On=Xe(tr),(!Jt.vLinePoint||Jt.vLinePoint.spikeDistance>On.spikeDistance)&&(Jt.vLinePoint=On))}var yr=xn.filter(function(lr){return lr.ya.showspikes&&lr.ya.spikesnap!=="hovered data"});if(yr.length){var Ct=yr[0];g(Ct.x0)&&g(Ct.y0)&&(On=Xe(Ct),(!Jt.hLinePoint||Jt.hLinePoint.spikeDistance>On.spikeDistance)&&(Jt.hLinePoint=On))}}}}}function qe(Br,pn,on){for(var Yr,Nn=null,Hn=1/0,xn=0;xn<Br.length;xn++)Yr=Br[xn].spikeDistance,on&&xn===0&&(Yr=-1/0),Yr<=Hn&&Yr<=pn&&(Nn=Br[xn],Hn=Yr);return Nn}function Xe(Br){return Br?{xa:Br.xa,ya:Br.ya,x:Br.xSpike!==void 0?Br.xSpike:(Br.x0+Br.x1)/2,y:Br.ySpike!==void 0?Br.ySpike:(Br.y0+Br.y1)/2,distance:Br.distance,spikeDistance:Br.spikeDistance,curveNumber:Br.trace.index,color:Br.color,pointNumber:Br.index}:null}De();var He={fullLayout:se,container:se._hoverlayer,event:re},st=K._spikepoints,it={vLinePoint:Jt.vLinePoint,hLinePoint:Jt.hLinePoint};K._spikepoints=it;var Tt=function(){qt.sort(function(Br,pn){return Br.distance-pn.distance}),qt=function(Br,pn){for(var on=pn.charAt(0),Yr=[],Nn=[],Hn=[],xn=0;xn<Br.length;xn++){var On=Br[xn];f.traceIs(On.trace,"bar-like")||f.traceIs(On.trace,"box-violin")?Hn.push(On):On.trace[on+"period"]?Nn.push(On):Yr.push(On)}return Yr.concat(Nn).concat(Hn)}(qt,Re)};Tt();var Pt=Re.charAt(0),rt=(Pt==="x"||Pt==="y")&&qt[0]&&I[qt[0].trace.type];if(_e&&Ze!==0&&qt.length!==0){var ut=qe(qt.filter(function(Br){return Br.ya.showspikes}),Ze,rt);Jt.hLinePoint=Xe(ut);var Ft=qe(qt.filter(function(Br){return Br.xa.showspikes}),Ze,rt);Jt.vLinePoint=Xe(Ft)}if(qt.length===0){var wt=i.unhoverRaw(K,re);return!_e||Jt.hLinePoint===null&&Jt.vLinePoint===null||X(st)&&V(K,Jt,He),wt}if(_e&&X(st)&&V(K,Jt,He),l.isXYhover(yt)&&qt[0].length!==0&&qt[0].trace.type!=="splom"){var Lt=qt[0],Ae=(qt=A[Lt.trace.type]?qt.filter(function(Br){return Br.trace.index===Lt.trace.index}):[Lt]).length,Ye=G("x",Lt,se),nt=G("y",Lt,se);De(Ye,nt);var ft,Mt=[],Rt={},Gt=0,jt=function(Br){var pn=A[Br.trace.type]?P(Br):Br.trace.index;if(Rt[pn]){var on=Rt[pn]-1,Yr=Mt[on];on>0&&Math.abs(Br.distance)<Math.abs(Yr.distance)&&(Mt[on]=Br)}else Gt++,Rt[pn]=Gt,Mt.push(Br)};for(ft=0;ft<Ae;ft++)jt(qt[ft]);for(ft=qt.length-1;ft>Ae-1;ft--)jt(qt[ft]);qt=Mt,Tt()}var pr=K._hoverdata,Ar=[],fr=W(K),Zt=te(K);for(Be=0;Be<qt.length;Be++){var Qt=qt[Be],$t=l.makeEventData(Qt,Qt.trace,Qt.cd);if(Qt.hovertemplate!==!1){var hr=!1;Qt.cd[Qt.index]&&Qt.cd[Qt.index].ht&&(hr=Qt.cd[Qt.index].ht),Qt.hovertemplate=hr||Qt.trace.hovertemplate||!1}if(Qt.xa&&Qt.ya){var vr=Qt.x0+Qt.xa._offset,Mr=Qt.x1+Qt.xa._offset,Nr=Qt.y0+Qt.ya._offset,Ur=Qt.y1+Qt.ya._offset,Jr=Math.min(vr,Mr),mn=Math.max(vr,Mr),en=Math.min(Nr,Ur),In=Math.max(Nr,Ur);$t.bbox={x0:Jr+Zt,x1:mn+Zt,y0:en+fr,y1:In+fr}}Qt.eventData=[$t],Ar.push($t)}K._hoverdata=Ar;var vn=Re==="y"&&(er.length>1||qt.length>1)||Re==="closest"&&ir&&qt.length>1,gn=o.combine(se.plot_bgcolor||o.background,se.paper_bgcolor),Sn=E(qt,{gd:K,hovermode:Re,rotateLabels:vn,bgColor:gn,container:se._hoverlayer,outerContainer:se._paper.node(),commonLabelOpts:se.hoverlabel,hoverdistance:se.hoverdistance});if(l.isUnifiedHover(Re)||(function(Br,pn,on){var Yr,Nn,Hn,xn,On,ua,tr,yr=0,Ct=1,lr=Br.size(),dr=new Array(lr),Fr=0;function Rr(qr){var tn=qr[0],rn=qr[qr.length-1];if(Nn=tn.pmin-tn.pos-tn.dp+tn.size,Hn=rn.pos+rn.dp+rn.size-tn.pmax,Nn>.01){for(On=qr.length-1;On>=0;On--)qr[On].dp+=Nn;Yr=!1}if(!(Hn<.01)){if(Nn<-.01){for(On=qr.length-1;On>=0;On--)qr[On].dp-=Hn;Yr=!1}if(Yr){var yn=0;for(xn=0;xn<qr.length;xn++)(ua=qr[xn]).pos+ua.dp+ua.size>tn.pmax&&yn++;for(xn=qr.length-1;xn>=0&&!(yn<=0);xn--)(ua=qr[xn]).pos>tn.pmax-1&&(ua.del=!0,yn--);for(xn=0;xn<qr.length&&!(yn<=0);xn++)if((ua=qr[xn]).pos<tn.pmin+1)for(ua.del=!0,yn--,Hn=2*ua.size,On=qr.length-1;On>=0;On--)qr[On].dp-=Hn;for(xn=qr.length-1;xn>=0&&!(yn<=0);xn--)(ua=qr[xn]).pos+ua.dp+ua.size>tn.pmax&&(ua.del=!0,yn--)}}}for(Br.each(function(qr){var tn=qr[pn],rn=tn._id.charAt(0)==="x",yn=tn.range;Fr===0&&yn&&yn[0]>yn[1]!==rn&&(Ct=-1),dr[Fr++]=[{datum:qr,traceIndex:qr.trace.index,dp:0,pos:qr.pos,posref:qr.posref,size:qr.by*(rn?T:1)/2,pmin:0,pmax:rn?on.width:on.height}]}),dr.sort(function(qr,tn){return qr[0].posref-tn[0].posref||Ct*(tn[0].traceIndex-qr[0].traceIndex)});!Yr&&yr<=lr;){for(yr++,Yr=!0,xn=0;xn<dr.length-1;){var zr=dr[xn],Er=dr[xn+1],xr=zr[zr.length-1],_r=Er[0];if((Nn=xr.pos+xr.dp+xr.size-_r.pos-_r.dp+_r.size)>.01&&xr.pmin===_r.pmin&&xr.pmax===_r.pmax){for(On=Er.length-1;On>=0;On--)Er[On].dp+=Nn;for(zr.push.apply(zr,Er),dr.splice(xn+1,1),tr=0,On=zr.length-1;On>=0;On--)tr+=zr[On].dp;for(Hn=tr/zr.length,On=zr.length-1;On>=0;On--)zr[On].dp-=Hn;Yr=!1}else xn++}dr.forEach(Rr)}for(xn=dr.length-1;xn>=0;xn--){var kr=dr[xn];for(On=kr.length-1;On>=0;On--){var Cr=kr[On],Gr=Cr.datum;Gr.offset=Cr.dp,Gr.del=Cr.del}}}(Sn,vn?"xa":"ya",se),R(Sn,vn,se._invScaleX,se._invScaleY)),oe&&oe.tagName){var Xn=f.getComponentMethod("annotations","hasClickToShow")(K,Ar);r(p.select(oe),Xn?"pointer":"")}!oe||le||!function(Br,pn,on){if(!on||on.length!==Br._hoverdata.length)return!0;for(var Yr=on.length-1;Yr>=0;Yr--){var Nn=on[Yr],Hn=Br._hoverdata[Yr];if(Nn.curveNumber!==Hn.curveNumber||String(Nn.pointNumber)!==String(Hn.pointNumber)||String(Nn.pointNumbers)!==String(Hn.pointNumbers))return!0}return!1}(K,0,pr)||(pr&&K.emit("plotly_unhover",{event:re,points:pr}),K.emit("plotly_hover",{event:re,points:K._hoverdata,xaxes:fe,yaxes:ve,xvals:Pe,yvals:Ie}))})(B,U,ee,j,Q)})},Z.loneHover=function(B,U){var ee=!0;Array.isArray(B)||(ee=!1,B=[B]);var j=U.gd,Q=W(j),K=te(j),re=E(B.map(function(oe){var de=oe._x0||oe.x0||oe.x||0,se=oe._x1||oe.x1||oe.x||0,me=oe._y0||oe.y0||oe.y||0,Te=oe._y1||oe.y1||oe.y||0,_e=oe.eventData;if(_e){var be=Math.min(de,se),Ce=Math.max(de,se),fe=Math.min(me,Te),ve=Math.max(me,Te),Me=oe.trace;if(f.traceIs(Me,"gl3d")){var ke=j._fullLayout[Me.scene]._scene.container,Le=ke.offsetLeft,ze=ke.offsetTop;be+=Le,Ce+=Le,fe+=ze,ve+=ze}_e.bbox={x0:be+K,x1:Ce+K,y0:fe+Q,y1:ve+Q},U.inOut_bbox&&U.inOut_bbox.push(_e.bbox)}else _e=!1;return{color:oe.color||o.defaultLine,x0:oe.x0||oe.x||0,x1:oe.x1||oe.x||0,y0:oe.y0||oe.y||0,y1:oe.y1||oe.y||0,xLabel:oe.xLabel,yLabel:oe.yLabel,zLabel:oe.zLabel,text:oe.text,name:oe.name,idealAlign:oe.idealAlign,borderColor:oe.borderColor,fontFamily:oe.fontFamily,fontSize:oe.fontSize,fontColor:oe.fontColor,nameLength:oe.nameLength,textAlign:oe.textAlign,trace:oe.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:oe.hovertemplate||!1,hovertemplateLabels:oe.hovertemplateLabels||!1,eventData:_e}}),{gd:j,hovermode:"closest",rotateLabels:!1,bgColor:U.bgColor||o.background,container:p.select(U.container),outerContainer:U.outerContainer||U.container}),ne=0,le=0;return re.sort(function(oe,de){return oe.y0-de.y0}).each(function(oe,de){var se=oe.y0-oe.by/2;oe.offset=se-5<ne?ne-se+5:0,ne=se+oe.by+oe.offset,de===U.anchorIndex&&(le=oe.offset)}).each(function(oe){oe.offset-=le}),R(re,!1,j._fullLayout._invScaleX,j._fullLayout._invScaleY),ee?re:re.node()};var S=/<extra>([\s\S]*)<\/extra>/;function E(B,U){var ee=U.gd,j=ee._fullLayout,Q=U.hovermode,K=U.rotateLabels,re=U.bgColor,ne=U.container,le=U.outerContainer,oe=U.commonLabelOpts||{};if(B.length===0)return[[]];var de=U.fontFamily||h.HOVERFONT,se=U.fontSize||h.HOVERFONTSIZE,me=B[0],Te=me.xa,_e=me.ya,be=Q.charAt(0),Ce=me[be+"Label"],fe=N(ee,le),ve=fe.top,Me=fe.width,ke=fe.height,Le=Ce!==void 0&&me.distance<=U.hoverdistance&&(Q==="x"||Q==="y");if(Le){var ze,Re,Oe=!0;for(ze=0;ze<B.length;ze++)if(Oe&&B[ze].zLabel===void 0&&(Oe=!1),Re=B[ze].hoverinfo||B[ze].trace.hoverinfo){var Ze=Array.isArray(Re)?Re:Re.split("+");if(Ze.indexOf("all")===-1&&Ze.indexOf(Q)===-1){Le=!1;break}}Oe&&(Le=!1)}var Pe=ne.selectAll("g.axistext").data(Le?[0]:[]);if(Pe.enter().append("g").classed("axistext",!0),Pe.exit().remove(),Pe.each(function(){var rt=p.select(this),ut=y.ensureSingle(rt,"path","",function(Mr){Mr.style({"stroke-width":"1px"})}),Ft=y.ensureSingle(rt,"text","",function(Mr){Mr.attr("data-notex",1)}),wt=oe.bgcolor||o.defaultLine,Lt=oe.bordercolor||o.contrast(wt),Ae=o.contrast(wt),Ye={family:oe.font.family||de,size:oe.font.size||se,color:oe.font.color||Ae};ut.style({fill:wt,stroke:Lt}),Ft.text(Ce).call(m.font,Ye).call(a.positionText,0,0).call(a.convertToTspans,ee),rt.attr("transform","");var nt,ft,Mt=N(ee,Ft.node());if(Q==="x"){var Rt=Te.side==="top"?"-":"";Ft.attr("text-anchor","middle").call(a.positionText,0,Te.side==="top"?ve-Mt.bottom-k-L:ve-Mt.top+k+L),nt=Te._offset+(me.x0+me.x1)/2,ft=_e._offset+(Te.side==="top"?0:_e._length);var Gt=Mt.width/2+L;nt<Gt?(nt=Gt,ut.attr("d","M-"+(Gt-k)+",0L-"+(Gt-2*k)+","+Rt+k+"H"+(L+Mt.width/2)+"v"+Rt+(2*L+Mt.height)+"H-"+Gt+"V"+Rt+k+"Z")):nt>j.width-Gt?(nt=j.width-Gt,ut.attr("d","M"+(Gt-k)+",0L"+Gt+","+Rt+k+"v"+Rt+(2*L+Mt.height)+"H-"+Gt+"V"+Rt+k+"H"+(Gt-2*k)+"Z")):ut.attr("d","M0,0L"+k+","+Rt+k+"H"+(L+Mt.width/2)+"v"+Rt+(2*L+Mt.height)+"H-"+(L+Mt.width/2)+"V"+Rt+k+"H-"+k+"Z")}else{var jt,pr,Ar;_e.side==="right"?(jt="start",pr=1,Ar="",nt=Te._offset+Te._length):(jt="end",pr=-1,Ar="-",nt=Te._offset),ft=_e._offset+(me.y0+me.y1)/2,Ft.attr("text-anchor",jt),ut.attr("d","M0,0L"+Ar+k+","+k+"V"+(L+Mt.height/2)+"h"+Ar+(2*L+Mt.width)+"V-"+(L+Mt.height/2)+"H"+Ar+k+"V-"+k+"Z");var fr,Zt=Mt.height/2,Qt=ve-Mt.top-Zt,$t="clip"+j._uid+"commonlabel"+_e._id;if(nt<Mt.width+2*L+k){fr="M-"+(k+L)+"-"+Zt+"h-"+(Mt.width-L)+"V"+Zt+"h"+(Mt.width-L)+"Z";var hr=Mt.width-nt+L;a.positionText(Ft,hr,Qt),jt==="end"&&Ft.selectAll("tspan").each(function(){var Mr=p.select(this),Nr=m.tester.append("text").text(Mr.text()).call(m.font,Ye),Ur=N(ee,Nr.node());Math.round(Ur.width)<Math.round(Mt.width)&&Mr.attr("x",hr-Ur.width),Nr.remove()})}else a.positionText(Ft,pr*(L+k),Qt),fr=null;var vr=j._topclips.selectAll("#"+$t).data(fr?[0]:[]);vr.enter().append("clipPath").attr("id",$t).append("path"),vr.exit().remove(),vr.select("path").attr("d",fr),m.setClipUrl(Ft,fr?$t:null,ee)}rt.attr("transform",e(nt,ft))}),l.isUnifiedHover(Q)){ne.selectAll("g.hovertext").remove();var Ie=B.filter(function(rt){return rt.hoverinfo!=="none"});if(Ie.length===0)return;var Be=j.hoverlabel,Fe=Be.font,$e={showlegend:!0,legend:{title:{text:Ce,font:Fe},font:Fe,bgcolor:Be.bgcolor,bordercolor:Be.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:j.legend?j.legend.traceorder:void 0,orientation:"v"}},ot={font:Fe};d($e,ot,ee._fullData);var pt=ot.legend;pt.entries=[];for(var _t=0;_t<Ie.length;_t++){var yt=Ie[_t];if(yt.hoverinfo!=="none"){var tt=D(yt,!0,Q,j,Ce),Ke=tt[0],vt=tt[1];yt.name=vt,yt.text=vt!==""?vt+" : "+Ke:Ke;var Nt=yt.cd[yt.index];Nt&&(Nt.mc&&(yt.mc=Nt.mc),Nt.mcc&&(yt.mc=Nt.mcc),Nt.mlc&&(yt.mlc=Nt.mlc),Nt.mlcc&&(yt.mlc=Nt.mlcc),Nt.mlw&&(yt.mlw=Nt.mlw),Nt.mrc&&(yt.mrc=Nt.mrc),Nt.dir&&(yt.dir=Nt.dir)),yt._distinct=!0,pt.entries.push([yt])}}pt.entries.sort(function(rt,ut){return rt[0].trace.index-ut[0].trace.index}),pt.layer=ne,pt._inHover=!0,pt._groupTitleFont=Be.grouptitlefont,s(ee,pt);var qt,er,Jt,ir,Ht=ne.select("g.legend"),Ue=N(ee,Ht.node()),We=Ue.width+2*L,he=Ue.height+2*L,xe=Ie[0],De=(xe.x0+xe.x1)/2,qe=(xe.y0+xe.y1)/2,Xe=!(f.traceIs(xe.trace,"bar-like")||f.traceIs(xe.trace,"box-violin"));be==="y"?Xe?(er=qe-L,qt=qe+L):(er=Math.min.apply(null,Ie.map(function(rt){return Math.min(rt.y0,rt.y1)})),qt=Math.max.apply(null,Ie.map(function(rt){return Math.max(rt.y0,rt.y1)}))):er=qt=y.mean(Ie.map(function(rt){return(rt.y0+rt.y1)/2}))-he/2,be==="x"?Xe?(Jt=De+L,ir=De-L):(Jt=Math.max.apply(null,Ie.map(function(rt){return Math.max(rt.x0,rt.x1)})),ir=Math.min.apply(null,Ie.map(function(rt){return Math.min(rt.x0,rt.x1)}))):Jt=ir=y.mean(Ie.map(function(rt){return(rt.x0+rt.x1)/2}))-We/2;var He,st,it=Te._offset,Tt=_e._offset;return ir+=it-We,er+=Tt-he,He=(Jt+=it)+We<Me&&Jt>=0?Jt:ir+We<Me&&ir>=0?ir:it+We<Me?it:Jt-De<De-ir+We?Me-We:0,He+=L,st=(qt+=Tt)+he<ke&&qt>=0?qt:er+he<ke&&er>=0?er:Tt+he<ke?Tt:qt-qe<qe-er+he?ke-he:0,st+=L,Ht.attr("transform",e(He-1,st-1)),Ht}var Pt=ne.selectAll("g.hovertext").data(B,function(rt){return P(rt)});return Pt.enter().append("g").classed("hovertext",!0).each(function(){var rt=p.select(this);rt.append("rect").call(o.fill,o.addOpacity(re,.8)),rt.append("text").classed("name",!0),rt.append("path").style("stroke-width","1px"),rt.append("text").classed("nums",!0).call(m.font,de,se)}),Pt.exit().remove(),Pt.each(function(rt){var ut=p.select(this).attr("transform",""),Ft=rt.color;Array.isArray(Ft)&&(Ft=Ft[rt.eventData[0].pointNumber]);var wt=rt.bgcolor||Ft,Lt=o.combine(o.opacity(wt)?wt:o.defaultLine,re),Ae=o.combine(o.opacity(Ft)?Ft:o.defaultLine,re),Ye=rt.borderColor||o.contrast(Lt),nt=D(rt,Le,Q,j,Ce,ut),ft=nt[0],Mt=nt[1],Rt=ut.select("text.nums").call(m.font,rt.fontFamily||de,rt.fontSize||se,rt.fontColor||Ye).text(ft).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,ee),Gt=ut.select("text.name"),jt=0,pr=0;if(Mt&&Mt!==ft){Gt.call(m.font,rt.fontFamily||de,rt.fontSize||se,Ae).text(Mt).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,ee);var Ar=N(ee,Gt.node());jt=Ar.width+2*L,pr=Ar.height+2*L}else Gt.remove(),ut.select("rect").remove();ut.select("path").style({fill:Lt,stroke:Ye});var fr=rt.xa._offset+(rt.x0+rt.x1)/2,Zt=rt.ya._offset+(rt.y0+rt.y1)/2,Qt=Math.abs(rt.x1-rt.x0),$t=Math.abs(rt.y1-rt.y0),hr=N(ee,Rt.node()),vr=hr.width/j._invScaleX,Mr=hr.height/j._invScaleY;rt.ty0=(ve-hr.top)/j._invScaleY,rt.bx=vr+2*L,rt.by=Math.max(Mr+2*L,pr),rt.anchor="start",rt.txwidth=vr,rt.tx2width=jt,rt.offset=0;var Nr,Ur,Jr=(vr+k+L+jt)*j._invScaleX;if(K)rt.pos=fr,Nr=Zt+$t/2+Jr<=ke,Ur=Zt-$t/2-Jr>=0,rt.idealAlign!=="top"&&Nr||!Ur?Nr?(Zt+=$t/2,rt.anchor="start"):rt.anchor="middle":(Zt-=$t/2,rt.anchor="end");else if(rt.pos=Zt,Nr=fr+Qt/2+Jr<=Me,Ur=fr-Qt/2-Jr>=0,rt.idealAlign!=="left"&&Nr||!Ur)if(Nr)fr+=Qt/2,rt.anchor="start";else{rt.anchor="middle";var mn=Jr/2,en=fr+mn-Me,In=fr-mn;en>0&&(fr-=en),In<0&&(fr+=-In)}else fr-=Qt/2,rt.anchor="end";Rt.attr("text-anchor",rt.anchor),jt&&Gt.attr("text-anchor",rt.anchor),ut.attr("transform",e(fr,Zt)+(K?n(x):""))}),Pt}function D(B,U,ee,j,Q,K){var re="",ne="";B.nameOverride!==void 0&&(B.name=B.nameOverride),B.name&&(B.trace._meta&&(B.name=y.templateString(B.name,B.trace._meta)),re=$(B.name,B.nameLength));var le=ee.charAt(0),oe=le==="x"?"y":"x";B.zLabel!==void 0?(B.xLabel!==void 0&&(ne+="x: "+B.xLabel+"<br>"),B.yLabel!==void 0&&(ne+="y: "+B.yLabel+"<br>"),B.trace.type!=="choropleth"&&B.trace.type!=="choroplethmapbox"&&(ne+=(ne?"z: ":"")+B.zLabel)):U&&B[le+"Label"]===Q?ne=B[oe+"Label"]||"":B.xLabel===void 0?B.yLabel!==void 0&&B.trace.type!=="scattercarpet"&&(ne=B.yLabel):ne=B.yLabel===void 0?B.xLabel:"("+B.xLabel+", "+B.yLabel+")",!B.text&&B.text!==0||Array.isArray(B.text)||(ne+=(ne?"<br>":"")+B.text),B.extraText!==void 0&&(ne+=(ne?"<br>":"")+B.extraText),K&&ne===""&&!B.hovertemplate&&(re===""&&K.remove(),ne=re);var de=B.hovertemplate||!1;if(de){var se=B.hovertemplateLabels||B;B[le+"Label"]!==Q&&(se[le+"other"]=se[le+"Val"],se[le+"otherLabel"]=se[le+"Label"]),ne=(ne=y.hovertemplateString(de,se,j._d3locale,B.eventData[0]||{},B.trace._meta)).replace(S,function(me,Te){return re=$(Te,B.nameLength),""})}return[ne,re]}function R(B,U,ee,j){var Q=function(re){return re*ee},K=function(re){return re*j};B.each(function(re){var ne=p.select(this);if(re.del)return ne.remove();var le=ne.select("text.nums"),oe=re.anchor,de=oe==="end"?-1:1,se={start:1,end:-1,middle:0}[oe],me=se*(k+L),Te=me+se*(re.txwidth+L),_e=0,be=re.offset,Ce=oe==="middle";Ce&&(me-=re.tx2width/2,Te+=re.txwidth/2+L),U&&(be*=-w,_e=re.offset*_),ne.select("path").attr("d",Ce?"M-"+Q(re.bx/2+re.tx2width/2)+","+K(be-re.by/2)+"h"+Q(re.bx)+"v"+K(re.by)+"h-"+Q(re.bx)+"Z":"M0,0L"+Q(de*k+_e)+","+K(k+be)+"v"+K(re.by/2-k)+"h"+Q(de*re.bx)+"v-"+K(re.by)+"H"+Q(de*k+_e)+"V"+K(be-k)+"Z");var fe=_e+me,ve=be+re.ty0-re.by/2+L,Me=re.textAlign||"auto";Me!=="auto"&&(Me==="left"&&oe!=="start"?(le.attr("text-anchor","start"),fe=Ce?-re.bx/2-re.tx2width/2+L:-re.bx-L):Me==="right"&&oe!=="end"&&(le.attr("text-anchor","end"),fe=Ce?re.bx/2-re.tx2width/2-L:re.bx+L)),le.call(a.positionText,Q(fe),K(ve)),re.tx2width&&(ne.select("text.name").call(a.positionText,Q(Te+se*L+_e),K(be+re.ty0-re.by/2+L)),ne.select("rect").call(m.setRect,Q(Te+(se-1)*re.tx2width/2+_e),K(be-re.by/2-1),Q(re.tx2width),K(re.by+2)))})}function H(B,U){var ee=B.index,j=B.trace||{},Q=B.cd[0],K=B.cd[ee]||{};function re(me){return me||g(me)&&me===0}var ne=Array.isArray(ee)?function(me,Te){var _e=y.castOption(Q,ee,me);return re(_e)?_e:y.extractOption({},j,"",Te)}:function(me,Te){return y.extractOption(K,j,me,Te)};function le(me,Te,_e){var be=ne(Te,_e);re(be)&&(B[me]=be)}if(le("hoverinfo","hi","hoverinfo"),le("bgcolor","hbg","hoverlabel.bgcolor"),le("borderColor","hbc","hoverlabel.bordercolor"),le("fontFamily","htf","hoverlabel.font.family"),le("fontSize","hts","hoverlabel.font.size"),le("fontColor","htc","hoverlabel.font.color"),le("nameLength","hnl","hoverlabel.namelength"),le("textAlign","hta","hoverlabel.align"),B.posref=U==="y"||U==="closest"&&j.orientation==="h"?B.xa._offset+(B.x0+B.x1)/2:B.ya._offset+(B.y0+B.y1)/2,B.x0=y.constrain(B.x0,0,B.xa._length),B.x1=y.constrain(B.x1,0,B.xa._length),B.y0=y.constrain(B.y0,0,B.ya._length),B.y1=y.constrain(B.y1,0,B.ya._length),B.xLabelVal!==void 0&&(B.xLabel="xLabel"in B?B.xLabel:u.hoverLabelText(B.xa,B.xLabelVal,j.xhoverformat),B.xVal=B.xa.c2d(B.xLabelVal)),B.yLabelVal!==void 0&&(B.yLabel="yLabel"in B?B.yLabel:u.hoverLabelText(B.ya,B.yLabelVal,j.yhoverformat),B.yVal=B.ya.c2d(B.yLabelVal)),B.zLabelVal!==void 0&&B.zLabel===void 0&&(B.zLabel=String(B.zLabelVal)),!(isNaN(B.xerr)||B.xa.type==="log"&&B.xerr<=0)){var oe=u.tickText(B.xa,B.xa.c2l(B.xerr),"hover").text;B.xerrneg!==void 0?B.xLabel+=" +"+oe+" / -"+u.tickText(B.xa,B.xa.c2l(B.xerrneg),"hover").text:B.xLabel+=" \xB1 "+oe,U==="x"&&(B.distance+=1)}if(!(isNaN(B.yerr)||B.ya.type==="log"&&B.yerr<=0)){var de=u.tickText(B.ya,B.ya.c2l(B.yerr),"hover").text;B.yerrneg!==void 0?B.yLabel+=" +"+de+" / -"+u.tickText(B.ya,B.ya.c2l(B.yerrneg),"hover").text:B.yLabel+=" \xB1 "+de,U==="y"&&(B.distance+=1)}var se=B.hoverinfo||B.trace.hoverinfo;return se&&se!=="all"&&((se=Array.isArray(se)?se:se.split("+")).indexOf("x")===-1&&(B.xLabel=void 0),se.indexOf("y")===-1&&(B.yLabel=void 0),se.indexOf("z")===-1&&(B.zLabel=void 0),se.indexOf("text")===-1&&(B.text=void 0),se.indexOf("name")===-1&&(B.name=void 0)),B}function V(B,U,ee){var j,Q,K=ee.container,re=ee.fullLayout,ne=re._size,le=ee.event,oe=!!U.hLinePoint,de=!!U.vLinePoint;if(K.selectAll(".spikeline").remove(),de||oe){var se=o.combine(re.plot_bgcolor,re.paper_bgcolor);if(oe){var me,Te,_e=U.hLinePoint;j=_e&&_e.xa,(Q=_e&&_e.ya).spikesnap==="cursor"?(me=le.pointerX,Te=le.pointerY):(me=j._offset+_e.x,Te=Q._offset+_e.y);var be,Ce,fe=b.readability(_e.color,se)<1.5?o.contrast(se):_e.color,ve=Q.spikemode,Me=Q.spikethickness,ke=Q.spikecolor||fe,Le=u.getPxPosition(B,Q);if(ve.indexOf("toaxis")!==-1||ve.indexOf("across")!==-1){if(ve.indexOf("toaxis")!==-1&&(be=Le,Ce=me),ve.indexOf("across")!==-1){var ze=Q._counterDomainMin,Re=Q._counterDomainMax;Q.anchor==="free"&&(ze=Math.min(ze,Q.position),Re=Math.max(Re,Q.position)),be=ne.l+ze*ne.w,Ce=ne.l+Re*ne.w}K.insert("line",":first-child").attr({x1:be,x2:Ce,y1:Te,y2:Te,"stroke-width":Me,stroke:ke,"stroke-dasharray":m.dashStyle(Q.spikedash,Me)}).classed("spikeline",!0).classed("crisp",!0),K.insert("line",":first-child").attr({x1:be,x2:Ce,y1:Te,y2:Te,"stroke-width":Me+2,stroke:se}).classed("spikeline",!0).classed("crisp",!0)}ve.indexOf("marker")!==-1&&K.insert("circle",":first-child").attr({cx:Le+(Q.side!=="right"?Me:-Me),cy:Te,r:Me,fill:ke}).classed("spikeline",!0)}if(de){var Oe,Ze,Pe=U.vLinePoint;j=Pe&&Pe.xa,Q=Pe&&Pe.ya,j.spikesnap==="cursor"?(Oe=le.pointerX,Ze=le.pointerY):(Oe=j._offset+Pe.x,Ze=Q._offset+Pe.y);var Ie,Be,Fe=b.readability(Pe.color,se)<1.5?o.contrast(se):Pe.color,$e=j.spikemode,ot=j.spikethickness,pt=j.spikecolor||Fe,_t=u.getPxPosition(B,j);if($e.indexOf("toaxis")!==-1||$e.indexOf("across")!==-1){if($e.indexOf("toaxis")!==-1&&(Ie=_t,Be=Ze),$e.indexOf("across")!==-1){var yt=j._counterDomainMin,tt=j._counterDomainMax;j.anchor==="free"&&(yt=Math.min(yt,j.position),tt=Math.max(tt,j.position)),Ie=ne.t+(1-tt)*ne.h,Be=ne.t+(1-yt)*ne.h}K.insert("line",":first-child").attr({x1:Oe,x2:Oe,y1:Ie,y2:Be,"stroke-width":ot,stroke:pt,"stroke-dasharray":m.dashStyle(j.spikedash,ot)}).classed("spikeline",!0).classed("crisp",!0),K.insert("line",":first-child").attr({x1:Oe,x2:Oe,y1:Ie,y2:Be,"stroke-width":ot+2,stroke:se}).classed("spikeline",!0).classed("crisp",!0)}$e.indexOf("marker")!==-1&&K.insert("circle",":first-child").attr({cx:Oe,cy:_t-(j.side!=="top"?ot:-ot),r:ot,fill:pt}).classed("spikeline",!0)}}}function X(B,U){return!U||U.vLinePoint!==B._spikepoints.vLinePoint||U.hLinePoint!==B._spikepoints.hLinePoint}function $(B,U){return a.plainText(B||"",{len:U,allowedTags:["br","sub","sup","b","i","em"]})}function G(B,U,ee){var j=U[B+"a"],Q=U[B+"Val"],K=U.cd[0];if(j.type==="category")Q=j._categoriesMap[Q];else if(j.type==="date"){var re=U.trace[B+"periodalignment"];if(re){var ne=U.cd[U.index],le=ne[B+"Start"];le===void 0&&(le=ne[B]);var oe=ne[B+"End"];oe===void 0&&(oe=ne[B]);var de=oe-le;re==="end"?Q+=de:re==="middle"&&(Q+=de/2)}Q=j.d2c(Q)}return K&&K.t&&K.t.posLetter===j._id&&(ee.boxmode!=="group"&&ee.violinmode!=="group"||(Q+=K.t.dPos)),Q}function W(B){return B.offsetTop+B.clientTop}function te(B){return B.offsetLeft+B.clientLeft}function N(B,U){var ee=B._fullLayout,j=U.getBoundingClientRect(),Q=j.x,K=j.y,re=Q+j.width,ne=K+j.height,le=y.apply3DTransform(ee._invTransform)(Q,K),oe=y.apply3DTransform(ee._invTransform)(re,ne),de=le[0],se=le[1],me=oe[0],Te=oe[1];return{x:de,y:se,width:me-de,height:Te-se,top:Math.min(se,Te),left:Math.min(de,me),right:Math.max(de,me),bottom:Math.max(se,Te)}}},{"../../lib":515,"../../lib/events":504,"../../lib/override_cursor":526,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../legend/defaults":419,"../legend/draw":420,"./constants":401,"./helpers":403,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],405:[function(v,J,Z){var p=v("../../lib"),g=v("../color"),b=v("./helpers").isUnifiedHover;J.exports=function(y,e,n,t){t=t||{};var a=e.legend;function r(m){t.font[m]||(t.font[m]=a?e.legend.font[m]:e.font[m])}e&&b(e.hovermode)&&(t.font||(t.font={}),r("size"),r("family"),r("color"),a?(t.bgcolor||(t.bgcolor=g.combine(e.legend.bgcolor,e.paper_bgcolor)),t.bordercolor||(t.bordercolor=e.legend.bordercolor)):t.bgcolor||(t.bgcolor=e.paper_bgcolor)),n("hoverlabel.bgcolor",t.bgcolor),n("hoverlabel.bordercolor",t.bordercolor),n("hoverlabel.namelength",t.namelength),p.coerceFont(n,"hoverlabel.font",t.font),n("hoverlabel.align",t.align)}},{"../../lib":515,"../color":367,"./helpers":403}],406:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes");J.exports=function(b,y){function e(n,t){return y[n]!==void 0?y[n]:p.coerce(b,y,g,n,t)}return e("clickmode"),e("hovermode")}},{"../../lib":515,"./layout_attributes":408}],407:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../dragelement"),y=v("./helpers"),e=v("./layout_attributes"),n=v("./hover");J.exports={moduleType:"component",name:"fx",constants:v("./constants"),schema:{layout:e},attributes:v("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:v("./layout_global_defaults"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),getDistanceFunction:y.getDistanceFunction,getClosest:y.getClosest,inbox:y.inbox,quadrature:y.quadrature,appendArrayPointValue:y.appendArrayPointValue,castHoverOption:function(t,a,r){return g.castOption(t,a,"hoverlabel."+r)},castHoverinfo:function(t,a,r){return g.castOption(t,r,"hoverinfo",function(m){return g.coerceHoverinfo({hoverinfo:m},{_module:t._module},a)})},hover:n.hover,unhover:b.unhover,loneHover:n.loneHover,loneUnhover:function(t){var a=g.isD3Selection(t)?t:p.select(t);a.selectAll("g.hovertext").remove(),a.selectAll(".spikeline").remove()},click:v("./click")}},{"../../lib":515,"../dragelement":386,"./attributes":398,"./calc":399,"./click":400,"./constants":401,"./defaults":402,"./helpers":403,"./hover":404,"./layout_attributes":408,"./layout_defaults":409,"./layout_global_defaults":410,"@plotly/d3":58}],408:[function(v,J,Z){var p=v("./constants"),g=v("../../plots/font_attributes"),b=g({editType:"none"});b.family.dflt=p.HOVERFONT,b.size.dflt=p.HOVERFONTSIZE,J.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:b,grouptitlefont:g({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":594,"./constants":401}],409:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes"),b=v("./hovermode_defaults"),y=v("./hoverlabel_defaults");J.exports=function(e,n){function t(o,i){return p.coerce(e,n,g,o,i)}b(e,n)&&(t("hoverdistance"),t("spikedistance")),t("dragmode")==="select"&&t("selectdirection");var a=n._has("mapbox"),r=n._has("geo"),m=n._basePlotModules.length;n.dragmode==="zoom"&&((a||r)&&m===1||a&&r&&m===2)&&(n.dragmode="pan"),y(e,n,t),p.coerceFont(t,"hoverlabel.grouptitlefont",n.hoverlabel.font)}},{"../../lib":515,"./hoverlabel_defaults":405,"./hovermode_defaults":406,"./layout_attributes":408}],410:[function(v,J,Z){var p=v("../../lib"),g=v("./hoverlabel_defaults"),b=v("./layout_attributes");J.exports=function(y,e){g(y,e,function(n,t){return p.coerce(y,e,b,n,t)})}},{"../../lib":515,"./hoverlabel_defaults":405,"./layout_attributes":408}],411:[function(v,J,Z){var p=v("../../lib"),g=v("../../lib/regex").counter,b=v("../../plots/domain").attributes,y=v("../../plots/cartesian/constants").idRegex,e=v("../../plot_api/plot_template"),n={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[g("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[y.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[y.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:b({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function t(m,o,i){var u=o[i+"axes"],f=Object.keys((m._splomAxes||{})[i]||{});return Array.isArray(u)?u:f.length?f:void 0}function a(m,o,i,u,f,l){var h=o(m+"gap",i),d=o("domain."+m);o(m+"side",u);for(var s=new Array(f),x=d[0],c=(d[1]-x)/(f-h),T=c*(1-h),_=0;_<f;_++){var w=x+c*_;s[l?f-1-_:_]=[w,w+T]}return s}function r(m,o,i,u,f){var l,h=new Array(i);function d(s,x){o.indexOf(x)!==-1&&u[x]===void 0?(h[s]=x,u[x]=s):h[s]=""}if(Array.isArray(m))for(l=0;l<i;l++)d(l,m[l]);else for(d(0,f),l=1;l<i;l++)d(l,f+(l+1));return h}J.exports={moduleType:"component",name:"grid",schema:{layout:{grid:n}},layoutAttributes:n,sizeDefaults:function(m,o){var i=m.grid||{},u=t(o,i,"x"),f=t(o,i,"y");if(m.grid||u||f){var l,h,d=Array.isArray(i.subplots)&&Array.isArray(i.subplots[0]),s=Array.isArray(u),x=Array.isArray(f),c=s&&u!==i.xaxes&&x&&f!==i.yaxes;d?(l=i.subplots.length,h=i.subplots[0].length):(x&&(l=f.length),s&&(h=u.length));var T=e.newContainer(o,"grid"),_=S("rows",l),w=S("columns",h);if(_*w>1){!d&&!s&&!x&&S("pattern")==="independent"&&(d=!0),T._hasSubplotGrid=d;var k,L,A=S("roworder")==="top to bottom",I=d?.2:.1,P=d?.3:.1;c&&o._splomGridDflt&&(k=o._splomGridDflt.xside,L=o._splomGridDflt.yside),T._domains={x:a("x",S,I,k,w),y:a("y",S,P,L,_,A)}}else delete o.grid}function S(E,D){return p.coerce(i,T,n,E,D)}},contentDefaults:function(m,o){var i=o.grid;if(i&&i._domains){var u,f,l,h,d,s,x,c=m.grid||{},T=o._subplots,_=i._hasSubplotGrid,w=i.rows,k=i.columns,L=i.pattern==="independent",A=i._axisMap={};if(_){var I=c.subplots||[];s=i.subplots=new Array(w);var P=1;for(u=0;u<w;u++){var S=s[u]=new Array(k),E=I[u]||[];for(f=0;f<k;f++)if(L?(d=P===1?"xy":"x"+P+"y"+P,P++):d=E[f],S[f]="",T.cartesian.indexOf(d)!==-1){if(x=d.indexOf("y"),l=d.slice(0,x),h=d.slice(x),A[l]!==void 0&&A[l]!==f||A[h]!==void 0&&A[h]!==u)continue;S[f]=d,A[l]=f,A[h]=u}}}else{var D=t(o,c,"x"),R=t(o,c,"y");i.xaxes=r(D,T.xaxis,k,A,"x"),i.yaxes=r(R,T.yaxis,w,A,"y")}var H=i._anchors={},V=i.roworder==="top to bottom";for(var X in A){var $,G,W,te=X.charAt(0),N=i[te+"side"];if(N.length<8)H[X]="free";else if(te==="x"){if(N.charAt(0)==="t"===V?($=0,G=1,W=w):($=w-1,G=-1,W=-1),_){var B=A[X];for(u=$;u!==W;u+=G)if((d=s[u][B])&&(x=d.indexOf("y"),d.slice(0,x)===X)){H[X]=d.slice(x);break}}else for(u=$;u!==W;u+=G)if(h=i.yaxes[u],T.cartesian.indexOf(X+h)!==-1){H[X]=h;break}}else if(N.charAt(0)==="l"?($=0,G=1,W=k):($=k-1,G=-1,W=-1),_){var U=A[X];for(u=$;u!==W;u+=G)if((d=s[U][u])&&(x=d.indexOf("y"),d.slice(x)===X)){H[X]=d.slice(0,x);break}}else for(u=$;u!==W;u+=G)if(l=i.xaxes[u],T.cartesian.indexOf(l+X)!==-1){H[X]=l;break}}}}}},{"../../lib":515,"../../lib/regex":532,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/domain":593}],412:[function(v,J,Z){var p=v("../../plots/cartesian/constants"),g=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),J.exports=g("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",p.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",p.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573}],413:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib/to_log_range");J.exports=function(b,y,e,n){y=y||{};var t=e==="log"&&y.type==="linear",a=e==="linear"&&y.type==="log";if(t||a){for(var r,m,o=b._fullLayout.images,i=y._id.charAt(0),u=0;u<o.length;u++)if(m="images["+u+"].",(r=o[u])[i+"ref"]===y._id){var f=r[i],l=r["size"+i],h=null,d=null;if(t){h=g(f,y.range);var s=l/Math.pow(10,h)/2;d=2*Math.log(s+Math.sqrt(1+s*s))/Math.LN10}else d=(h=Math.pow(10,f))*(Math.pow(10,l/2)-Math.pow(10,-l/2));p(h)?p(d)||(d=null):(h=null,d=null),n(m+i,h),n(m+"size"+i,d)}}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],414:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes"),b=v("../../plots/array_container_defaults"),y=v("./attributes");function e(n,t,a){function r(h,d){return p.coerce(n,t,y,h,d)}var m=r("source");if(!r("visible",!!m))return t;r("layer"),r("xanchor"),r("yanchor"),r("sizex"),r("sizey"),r("sizing"),r("opacity");for(var o={_fullLayout:a},i=["x","y"],u=0;u<2;u++){var f=i[u],l=g.coerceRef(n,t,o,f,"paper",void 0);l!=="paper"&&g.getFromId(o,l)._imgIndices.push(t._index),g.coercePosition(t,o,r,l,f,0)}return t}J.exports=function(n,t){b(n,t,{name:"images",handleItemDefaults:e})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":412}],415:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../drawing"),b=v("../../plots/cartesian/axes"),y=v("../../plots/cartesian/axis_ids"),e=v("../../constants/xmlns_namespaces");J.exports=function(n){var t,a,r=n._fullLayout,m=[],o={},i=[];for(a=0;a<r.images.length;a++){var u=r.images[a];if(u.visible)if(u.layer==="below"&&u.xref!=="paper"&&u.yref!=="paper"){t=y.ref2id(u.xref)+y.ref2id(u.yref);var f=r._plots[t];if(!f){i.push(u);continue}f.mainplot&&(t=f.mainplot.id),o[t]||(o[t]=[]),o[t].push(u)}else u.layer==="above"?m.push(u):i.push(u)}var l={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},h={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function d(k){var L=p.select(this);if(this._imgSrc!==k.source)if(L.attr("xmlns",e.svg),k.source&&k.source.slice(0,5)==="data:")L.attr("xlink:href",k.source),this._imgSrc=k.source;else{var A=new Promise(function(I){var P=new Image;function S(){L.remove(),I()}this.img=P,P.setAttribute("crossOrigin","anonymous"),P.onerror=S,P.onload=function(){var E=document.createElement("canvas");E.width=this.width,E.height=this.height,E.getContext("2d",{willReadFrequently:!0}).drawImage(this,0,0);var D=E.toDataURL("image/png");L.attr("xlink:href",D),I()},L.on("error",S),P.src=k.source,this._imgSrc=k.source}.bind(this));n._promises.push(A)}}function s(k){var L,A,I=p.select(this),P=b.getFromId(n,k.xref),S=b.getFromId(n,k.yref),E=b.getRefType(k.xref)==="domain",D=b.getRefType(k.yref)==="domain",R=r._size;L=P!==void 0?typeof k.xref=="string"&&E?P._length*k.sizex:Math.abs(P.l2p(k.sizex)-P.l2p(0)):k.sizex*R.w,A=S!==void 0?typeof k.yref=="string"&&D?S._length*k.sizey:Math.abs(S.l2p(k.sizey)-S.l2p(0)):k.sizey*R.h;var H,V,X=L*l[k.xanchor].offset,$=A*h[k.yanchor].offset,G=l[k.xanchor].sizing+h[k.yanchor].sizing;switch(H=P!==void 0?typeof k.xref=="string"&&E?P._length*k.x+P._offset:P.r2p(k.x)+P._offset:k.x*R.w+R.l,H+=X,V=S!==void 0?typeof k.yref=="string"&&D?S._length*(1-k.y)+S._offset:S.r2p(k.y)+S._offset:R.h-k.y*R.h+R.t,V+=$,k.sizing){case"fill":G+=" slice";break;case"stretch":G="none"}I.attr({x:H,y:V,width:L,height:A,preserveAspectRatio:G,opacity:k.opacity});var W=(P&&b.getRefType(k.xref)!=="domain"?P._id:"")+(S&&b.getRefType(k.yref)!=="domain"?S._id:"");g.setClipUrl(I,W?"clip"+r._uid+W:null,n)}var x=r._imageLowerLayer.selectAll("image").data(i),c=r._imageUpperLayer.selectAll("image").data(m);x.enter().append("image"),c.enter().append("image"),x.exit().remove(),c.exit().remove(),x.each(function(k){d.bind(this)(k),s.bind(this)(k)}),c.each(function(k){d.bind(this)(k),s.bind(this)(k)});var T=Object.keys(r._plots);for(a=0;a<T.length;a++){t=T[a];var _=r._plots[t];if(_.imagelayer){var w=_.imagelayer.selectAll("image").data(o[t]||[]);w.enter().append("image"),w.exit().remove(),w.each(function(k){d.bind(this)(k),s.bind(this)(k)})}}}},{"../../constants/xmlns_namespaces":492,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../drawing":389,"@plotly/d3":58}],416:[function(v,J,Z){J.exports={moduleType:"component",name:"images",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("images"),draw:v("./draw"),convertCoords:v("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":412,"./convert_coords":413,"./defaults":414,"./draw":415}],417:[function(v,J,Z){var p=v("../../plots/font_attributes"),g=v("../color/attributes");J.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:g.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:p({editType:"legend"}),grouptitlefont:p({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:p({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":594,"../color/attributes":366}],418:[function(v,J,Z){J.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],419:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib"),b=v("../../plot_api/plot_template"),y=v("../../plots/attributes"),e=v("./attributes"),n=v("../../plots/layout_attributes"),t=v("./helpers");J.exports=function(a,r,m){var o,i=a.legend||{},u=b.newContainer(r,"legend");function f(S,E){return g.coerce(i,u,e,S,E)}for(var l=function(S,E){var D=o._input,R=o;return g.coerce(D,R,y,S,E)},h=r.font||{},d=g.coerceFont(f,"grouptitlefont",g.extendFlat({},h,{size:Math.round(1.1*h.size)})),s=0,x=!1,c="normal",T=0;T<m.length;T++)(o=m[T]).visible&&((o.showlegend||o._dfltShowLegend&&!(o._module&&o._module.attributes&&o._module.attributes.showlegend&&o._module.attributes.showlegend.dflt===!1))&&(s++,o.showlegend&&(x=!0,(p.traceIs(o,"pie-like")||o._input.showlegend===!0)&&s++),g.coerceFont(l,"legendgrouptitle.font",d)),(p.traceIs(o,"bar")&&r.barmode==="stack"||["tonextx","tonexty"].indexOf(o.fill)!==-1)&&(c=t.isGrouped({traceorder:c})?"grouped+reversed":"reversed"),o.legendgroup!==void 0&&o.legendgroup!==""&&(c=t.isReversed({traceorder:c})?"reversed+grouped":"grouped"));var _=g.coerce(a,r,n,"showlegend",x&&s>1);if(_===!1&&(r.legend=void 0),(_!==!1||i.uirevision)&&(f("uirevision",r.uirevision),_!==!1)){f("bgcolor",r.paper_bgcolor),f("bordercolor"),f("borderwidth");var w,k,L,A=g.coerceFont(f,"font",r.font),I=f("orientation")==="h";if(I?(w=0,p.getComponentMethod("rangeslider","isVisible")(a.xaxis)?(k=1.1,L="bottom"):(k=-.1,L="top")):(w=1.02,k=1,L="auto"),f("traceorder",c),t.isGrouped(r.legend)&&f("tracegroupgap"),f("itemsizing"),f("itemwidth"),f("itemclick"),f("itemdoubleclick"),f("groupclick"),f("x",w),f("xanchor"),f("y",k),f("yanchor",L),f("valign"),g.noneOrAll(i,u,["x","y"]),f("title.text")){f("title.side",I?"left":"top");var P=g.extendFlat({},A,{size:g.bigFont(A.size)});g.coerceFont(f,"title.font",P)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/layout_attributes":619,"../../registry":647,"./attributes":417,"./helpers":423}],420:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../plots/plots"),y=v("../../registry"),e=v("../../lib/events"),n=v("../dragelement"),t=v("../drawing"),a=v("../color"),r=v("../../lib/svg_text_utils"),m=v("./handle_click"),o=v("./constants"),i=v("../../constants/alignment"),u=i.LINE_SPACING,f=i.FROM_TL,l=i.FROM_BR,h=v("./get_legend_data"),d=v("./style"),s=v("./helpers");function x(A,I,P,S,E){var D=P.data()[0][0].trace,R={event:E,node:P.node(),curveNumber:D.index,expandedIndex:D._expandedIndex,data:A.data,layout:A.layout,frames:A._transitionData._frames,config:A._context,fullData:A._fullData,fullLayout:A._fullLayout};D._group&&(R.group=D._group),y.traceIs(D,"pie-like")&&(R.label=P.datum()[0].label),e.triggerHandler(A,"plotly_legendclick",R)!==!1&&(S===1?I._clickTimeout=setTimeout(function(){A._fullLayout&&m(P,A,S)},A._context.doubleClickDelay):S===2&&(I._clickTimeout&&clearTimeout(I._clickTimeout),A._legendMouseDownTime=0,e.triggerHandler(A,"plotly_legenddoubleclick",R)!==!1&&m(P,A,S)))}function c(A,I,P){var S,E,D=A.data()[0][0],R=D.trace,H=y.traceIs(R,"pie-like"),V=!P._inHover&&I._context.edits.legendText&&!H,X=P._maxNameLength;D.groupTitle?(S=D.groupTitle.text,E=D.groupTitle.font):(E=P.font,P.entries?S=D.text:(S=H?D.label:R.name,R._meta&&(S=g.templateString(S,R._meta))));var $=g.ensureSingle(A,"text","legendtext");$.attr("text-anchor","start").call(t.font,E).text(V?T(S,X):S);var G=P.itemwidth+2*o.itemGap;r.positionText($,G,0),V?$.call(r.makeEditable,{gd:I,text:S}).call(w,A,I,P).on("edit",function(W){this.text(T(W,X)).call(w,A,I,P);var te=D.trace._fullInput||{},N={};if(y.hasTransform(te,"groupby")){var B=y.getTransformIndices(te,"groupby"),U=B[B.length-1],ee=g.keyedContainer(te,"transforms["+U+"].styles","target","value.name");ee.set(D.trace._group,W),N=ee.constructUpdate()}else N.name=W;return y.call("_guiRestyle",I,N,R.index)}):w($,A,I,P)}function T(A,I){var P=Math.max(4,I);if(A&&A.trim().length>=P/2)return A;for(var S=P-(A=A||"").length;S>0;S--)A+=" ";return A}function _(A,I){var P,S=I._context.doubleClickDelay,E=1,D=g.ensureSingle(A,"rect","legendtoggle",function(R){I._context.staticPlot||R.style("cursor","pointer").attr("pointer-events","all"),R.call(a.fill,"rgba(0,0,0,0)")});I._context.staticPlot||(D.on("mousedown",function(){(P=new Date().getTime())-I._legendMouseDownTime<S?E+=1:(E=1,I._legendMouseDownTime=P)}),D.on("mouseup",function(){if(!I._dragged&&!I._editing){var R=I._fullLayout.legend;new Date().getTime()-I._legendMouseDownTime>S&&(E=Math.max(E-1,1)),x(I,R,A,E,p.event)}}))}function w(A,I,P,S,E){S._inHover&&A.attr("data-notex",!0),r.convertToTspans(A,P,function(){(function(D,R,H,V){var X=D.data()[0][0];if(!H._inHover&&X&&!X.trace.showlegend)return void D.remove();var $=D.select("g[class*=math-group]"),G=$.node();H||(H=R._fullLayout.legend);var W,te=H.borderwidth;W=V===1?H.title.font:X.groupTitle?X.groupTitle.font:H.font;var N,B,U=W.size*u;if(G){var ee=t.bBox(G);N=ee.height,B=ee.width,V===1?t.setTranslate($,te,te+.75*N):t.setTranslate($,0,.25*N)}else{var j=D.select(V===1?".legendtitletext":".legendtext"),Q=r.lineCount(j),K=j.node();if(N=U*Q,B=K?t.bBox(K).width:0,V===1)H.title.side==="left"&&(B+=2*o.itemGap),r.positionText(j,te+o.titlePad,te+U);else{var re=2*o.itemGap+H.itemwidth;X.groupTitle&&(re=o.itemGap,B-=H.itemwidth),r.positionText(j,re,-U*((Q-1)/2-.3))}}V===1?(H._titleWidth=B,H._titleHeight=N):(X.lineHeight=U,X.height=Math.max(N,16)+3,X.width=B)})(I,P,S,E)})}function k(A){return g.isRightAnchor(A)?"right":g.isCenterAnchor(A)?"center":"left"}function L(A){return g.isBottomAnchor(A)?"bottom":g.isMiddleAnchor(A)?"middle":"top"}J.exports=function(A,I){return I||(I=A._fullLayout.legend||{}),function(P,S){var E,D,R=P._fullLayout,H="legend"+R._uid,V=S._inHover;if(V?(E=S.layer,H+="-hover"):E=R._infolayer,!!E){if(P._legendMouseDownTime||(P._legendMouseDownTime=0),V){if(!S.entries)return;D=h(S.entries,S)}else{if(!P.calcdata)return;D=R.showlegend&&h(P.calcdata,S)}var X=R.hiddenlabels||[];if(!(V||R.showlegend&&D.length))return E.selectAll(".legend").remove(),R._topdefs.select("#"+H).remove(),b.autoMargin(P,"legend");var $=g.ensureSingle(E,"g","legend",function(Q){V||Q.attr("pointer-events","all")}),G=g.ensureSingleById(R._topdefs,"clipPath",H,function(Q){Q.append("rect")}),W=g.ensureSingle($,"rect","bg",function(Q){Q.attr("shape-rendering","crispEdges")});W.call(a.stroke,S.bordercolor).call(a.fill,S.bgcolor).style("stroke-width",S.borderwidth+"px");var te=g.ensureSingle($,"g","scrollbox"),N=S.title;if(S._titleWidth=0,S._titleHeight=0,N.text){var B=g.ensureSingle(te,"text","legendtitletext");B.attr("text-anchor","start").call(t.font,N.font).text(N.text),w(B,te,P,S,1)}else te.selectAll(".legendtitletext").remove();var U=g.ensureSingle($,"rect","scrollbar",function(Q){Q.attr(o.scrollBarEnterAttrs).call(a.fill,o.scrollBarColor)}),ee=te.selectAll("g.groups").data(D);ee.enter().append("g").attr("class","groups"),ee.exit().remove();var j=ee.selectAll("g.traces").data(g.identity);j.enter().append("g").attr("class","traces"),j.exit().remove(),j.style("opacity",function(Q){var K=Q[0].trace;return y.traceIs(K,"pie-like")?X.indexOf(Q[0].label)!==-1?.5:1:K.visible==="legendonly"?.5:1}).each(function(){p.select(this).call(c,P,S)}).call(d,P,S).each(function(){V||p.select(this).call(_,P)}),g.syncOrAsync([b.previousPromises,function(){return function(Q,K,re,ne){var le=Q._fullLayout;ne||(ne=le.legend);var oe=le._size,de=s.isVertical(ne),se=s.isGrouped(ne),me=ne.borderwidth,Te=2*me,_e=o.itemGap,be=ne.itemwidth+2*_e,Ce=2*(me+_e),fe=L(ne),ve=ne.y<0||ne.y===0&&fe==="top",Me=ne.y>1||ne.y===1&&fe==="bottom",ke=ne.tracegroupgap;ne._maxHeight=Math.max(ve||Me?le.height/2:oe.h,30);var Le=0;ne._width=0,ne._height=0;var ze=function(ir){var Ht=0,Ue=0,We=ir.title.side;return We&&(We.indexOf("left")!==-1&&(Ht=ir._titleWidth),We.indexOf("top")!==-1&&(Ue=ir._titleHeight)),[Ht,Ue]}(ne);if(de)re.each(function(ir){var Ht=ir[0].height;t.setTranslate(this,me+ze[0],me+ze[1]+ne._height+Ht/2+_e),ne._height+=Ht,ne._width=Math.max(ne._width,ir[0].width)}),Le=be+ne._width,ne._width+=_e+be+Te,ne._height+=Ce,se&&(K.each(function(ir,Ht){t.setTranslate(this,0,Ht*ne.tracegroupgap)}),ne._height+=(ne._lgroupsLength-1)*ne.tracegroupgap);else{var Re=k(ne),Oe=ne.x<0||ne.x===0&&Re==="right",Ze=ne.x>1||ne.x===1&&Re==="left",Pe=Me||ve,Ie=le.width/2;ne._maxWidth=Math.max(Oe?Pe&&Re==="left"?oe.l+oe.w:Ie:Ze?Pe&&Re==="right"?oe.r+oe.w:Ie:oe.w,2*be);var Be=0,Fe=0;re.each(function(ir){var Ht=ir[0].width+be;Be=Math.max(Be,Ht),Fe+=Ht}),Le=null;var $e=0;if(se){var ot=0,pt=0,_t=0;K.each(function(){var ir=0,Ht=0;p.select(this).selectAll("g.traces").each(function(We){var he=We[0].width,xe=We[0].height;t.setTranslate(this,ze[0],ze[1]+me+_e+xe/2+Ht),Ht+=xe,ir=Math.max(ir,be+he)});var Ue=ir+_e;pt>0&&Ue+me+pt>ne._maxWidth?($e=Math.max($e,pt),pt=0,_t+=ot+ke,ot=Ht):ot=Math.max(ot,Ht),t.setTranslate(this,pt,_t),pt+=Ue}),ne._width=Math.max($e,pt)+me,ne._height=_t+ot+Ce}else{var yt=re.size(),tt=Fe+Te+(yt-1)*_e<ne._maxWidth,Ke=0,vt=0,Nt=0,qt=0;re.each(function(ir){var Ht=ir[0].height,Ue=be+ir[0].width,We=(tt?Ue:Be)+_e;We+me+vt-_e>=ne._maxWidth&&($e=Math.max($e,qt),vt=0,Nt+=Ke,ne._height+=Ke,Ke=0),t.setTranslate(this,ze[0]+me+vt,ze[1]+me+Nt+Ht/2+_e),qt=vt+Ue+_e,vt+=We,Ke=Math.max(Ke,Ht)}),tt?(ne._width=vt+Te,ne._height=Ke+Ce):(ne._width=Math.max($e,qt)+Te,ne._height+=Ke+Ce)}}ne._width=Math.ceil(Math.max(ne._width+ze[0],ne._titleWidth+2*(me+o.titlePad))),ne._height=Math.ceil(Math.max(ne._height+ze[1],ne._titleHeight+2*(me+o.itemGap))),ne._effHeight=Math.min(ne._height,ne._maxHeight);var er=Q._context.edits,Jt=er.legendText||er.legendPosition;re.each(function(ir){var Ht=p.select(this).select(".legendtoggle"),Ue=ir[0].height,We=Jt?be:Le||be+ir[0].width;de||(We+=_e/2),t.setRect(Ht,0,-Ue/2,We,Ue)})}(P,ee,j,S)},function(){var Q,K,re,ne,le=R._size,oe=S.borderwidth;if(!V){if(function(Pe){var Ie=Pe._fullLayout.legend,Be=k(Ie),Fe=L(Ie);return b.autoMargin(Pe,"legend",{x:Ie.x,y:Ie.y,l:Ie._width*f[Be],r:Ie._width*l[Be],b:Ie._effHeight*l[Fe],t:Ie._effHeight*f[Fe]})}(P))return;var de=le.l+le.w*S.x-f[k(S)]*S._width,se=le.t+le.h*(1-S.y)-f[L(S)]*S._effHeight;if(R.margin.autoexpand){var me=de,Te=se;de=g.constrain(de,0,R.width-S._width),se=g.constrain(se,0,R.height-S._effHeight),de!==me&&g.log("Constrain legend.x to make legend fit inside graph"),se!==Te&&g.log("Constrain legend.y to make legend fit inside graph")}t.setTranslate($,de,se)}if(U.on(".drag",null),$.on("wheel",null),V||S._height<=S._maxHeight||P._context.staticPlot){var _e=S._effHeight;V&&(_e=S._height),W.attr({width:S._width-oe,height:_e-oe,x:oe/2,y:oe/2}),t.setTranslate(te,0,0),G.select("rect").attr({width:S._width-2*oe,height:_e-2*oe,x:oe,y:oe}),t.setClipUrl(te,H,P),t.setRect(U,0,0,0,0),delete S._scrollY}else{var be,Ce,fe,ve=Math.max(o.scrollBarMinHeight,S._effHeight*S._effHeight/S._height),Me=S._effHeight-ve-2*o.scrollBarMargin,ke=S._height-S._effHeight,Le=Me/ke,ze=Math.min(S._scrollY||0,ke);W.attr({width:S._width-2*oe+o.scrollBarWidth+o.scrollBarMargin,height:S._effHeight-oe,x:oe/2,y:oe/2}),G.select("rect").attr({width:S._width-2*oe+o.scrollBarWidth+o.scrollBarMargin,height:S._effHeight-2*oe,x:oe,y:oe+ze}),t.setClipUrl(te,H,P),Ze(ze,ve,Le),$.on("wheel",function(){Ze(ze=g.constrain(S._scrollY+p.event.deltaY/Me*ke,0,ke),ve,Le),ze!==0&&ze!==ke&&p.event.preventDefault()});var Re=p.behavior.drag().on("dragstart",function(){var Pe=p.event.sourceEvent;be=Pe.type==="touchstart"?Pe.changedTouches[0].clientY:Pe.clientY,fe=ze}).on("drag",function(){var Pe=p.event.sourceEvent;Pe.buttons===2||Pe.ctrlKey||(Ce=Pe.type==="touchmove"?Pe.changedTouches[0].clientY:Pe.clientY,Ze(ze=function(Ie,Be,Fe){var $e=(Fe-Be)/Le+Ie;return g.constrain($e,0,ke)}(fe,be,Ce),ve,Le))});U.call(Re);var Oe=p.behavior.drag().on("dragstart",function(){var Pe=p.event.sourceEvent;Pe.type==="touchstart"&&(be=Pe.changedTouches[0].clientY,fe=ze)}).on("drag",function(){var Pe=p.event.sourceEvent;Pe.type==="touchmove"&&(Ce=Pe.changedTouches[0].clientY,Ze(ze=function(Ie,Be,Fe){var $e=(Be-Fe)/Le+Ie;return g.constrain($e,0,ke)}(fe,be,Ce),ve,Le))});te.call(Oe)}function Ze(Pe,Ie,Be){S._scrollY=P._fullLayout.legend._scrollY=Pe,t.setTranslate(te,0,-Pe),t.setRect(U,S._width,o.scrollBarMargin+Pe*Be,o.scrollBarWidth,Ie),G.select("rect").attr("y",oe+Pe)}P._context.edits.legendPosition&&($.classed("cursor-move",!0),n.init({element:$.node(),gd:P,prepFn:function(){var Pe=t.getTranslate($);re=Pe.x,ne=Pe.y},moveFn:function(Pe,Ie){var Be=re+Pe,Fe=ne+Ie;t.setTranslate($,Be,Fe),Q=n.align(Be,0,le.l,le.l+le.w,S.xanchor),K=n.align(Fe,0,le.t+le.h,le.t,S.yanchor)},doneFn:function(){Q!==void 0&&K!==void 0&&y.call("_guiRelayout",P,{"legend.x":Q,"legend.y":K})},clickFn:function(Pe,Ie){var Be=E.selectAll("g.traces").filter(function(){var Fe=this.getBoundingClientRect();return Ie.clientX>=Fe.left&&Ie.clientX<=Fe.right&&Ie.clientY>=Fe.top&&Ie.clientY<=Fe.bottom});Be.size()>0&&x(P,$,Be,Pe,Ie)}}))}],P)}}(A,I)}},{"../../constants/alignment":483,"../../lib":515,"../../lib/events":504,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":418,"./get_legend_data":421,"./handle_click":422,"./helpers":423,"./style":425,"@plotly/d3":58}],421:[function(v,J,Z){var p=v("../../registry"),g=v("./helpers");J.exports=function(b,y){var e,n,t=y._inHover,a=g.isGrouped(y),r=g.isReversed(y),m={},o=[],i=!1,u={},f=0,l=0;function h(R,H){if(R!==""&&g.isGrouped(y))o.indexOf(R)===-1?(o.push(R),i=!0,m[R]=[H]):m[R].push(H);else{var V="~~i"+f;o.push(V),m[V]=[H],f++}}for(e=0;e<b.length;e++){var d=b[e],s=d[0],x=s.trace,c=x.legendgroup;if(t||x.visible&&x.showlegend)if(p.traceIs(x,"pie-like"))for(u[c]||(u[c]={}),n=0;n<d.length;n++){var T=d[n].label;u[c][T]||(h(c,{label:T,color:d[n].color,i:d[n].i,trace:x,pts:d[n].pts}),u[c][T]=!0,l=Math.max(l,(T||"").length))}else h(c,s),l=Math.max(l,(x.name||"").length)}if(!o.length)return[];var _=!i||!a,w=[];for(e=0;e<o.length;e++){var k=m[o[e]];_?w.push(k[0]):w.push(k)}for(_&&(w=[w]),e=0;e<w.length;e++){var L=1/0;for(n=0;n<w[e].length;n++){var A=w[e][n].trace.legendrank;L>A&&(L=A)}w[e][0]._groupMinRank=L,w[e][0]._preGroupSort=e}var I=function(R,H){return R.trace.legendrank-H.trace.legendrank||R._preSort-H._preSort};for(w.forEach(function(R,H){R[0]._preGroupSort=H}),w.sort(function(R,H){return R[0]._groupMinRank-H[0]._groupMinRank||R[0]._preGroupSort-H[0]._preGroupSort}),e=0;e<w.length;e++){w[e].forEach(function(R,H){R._preSort=H}),w[e].sort(I);var P=w[e][0].trace,S=null;for(n=0;n<w[e].length;n++){var E=w[e][n].trace.legendgrouptitle;if(E&&E.text){S=E,t&&(E.font=y._groupTitleFont);break}}if(r&&w[e].reverse(),S){var D=!1;for(n=0;n<w[e].length;n++)if(p.traceIs(w[e][n].trace,"pie-like")){D=!0;break}w[e].unshift({i:-1,groupTitle:S,noClick:D,trace:{showlegend:P.showlegend,legendgroup:P.legendgroup,visible:y.groupclick==="toggleitem"||P.visible}})}for(n=0;n<w[e].length;n++)w[e][n]=[w[e][n]]}return y._lgroupsLength=w.length,y._maxNameLength=l,w}},{"../../registry":647,"./helpers":423}],422:[function(v,J,Z){var p=v("../../lib"),g=v("../../registry"),b=!0;J.exports=function(y,e,n){var t=e._fullLayout;if(!e._dragged&&!e._editing){var a,r=t.legend.itemclick,m=t.legend.itemdoubleclick,o=t.legend.groupclick;if(n===1&&r==="toggle"&&m==="toggleothers"&&b&&e.data&&e._context.showTips&&p.notifier(p._(e,"Double-click on legend to isolate one trace"),"long"),b=!1,n===1?a=r:n===2&&(a=m),a){var i=o==="togglegroup",u=t.hiddenlabels?t.hiddenlabels.slice():[],f=y.data()[0][0];if(!f.groupTitle||!f.noClick){var l,h,d,s,x,c=e._fullData,T=f.trace,_=T.legendgroup,w={},k=[],L=[],A=[];if(g.traceIs(T,"pie-like")){var I=f.label,P=u.indexOf(I);a==="toggle"?P===-1?u.push(I):u.splice(P,1):a==="toggleothers"&&(u=[],e.calcdata[0].forEach(function(U){I!==U.label&&u.push(U.label)}),e._fullLayout.hiddenlabels&&e._fullLayout.hiddenlabels.length===u.length&&P===-1&&(u=[])),g.call("_guiRelayout",e,"hiddenlabels",u)}else{var S,E=_&&_.length,D=[];if(E)for(l=0;l<c.length;l++)(S=c[l]).visible&&S.legendgroup===_&&D.push(l);if(a==="toggle"){var R;switch(T.visible){case!0:R="legendonly";break;case!1:R=!1;break;case"legendonly":R=!0}if(E)if(i)for(l=0;l<c.length;l++)c[l].visible!==!1&&c[l].legendgroup===_&&B(c[l],R);else B(T,R);else B(T,R)}else if(a==="toggleothers"){var H,V,X,$,G=!0;for(l=0;l<c.length;l++)if(H=c[l]===T,X=c[l].showlegend!==!0,!(H||X||(V=E&&c[l].legendgroup===_)||c[l].visible!==!0||g.traceIs(c[l],"notLegendIsolatable"))){G=!1;break}for(l=0;l<c.length;l++)if(c[l].visible!==!1&&!g.traceIs(c[l],"notLegendIsolatable"))switch(T.visible){case"legendonly":B(c[l],!0);break;case!0:$=!!G||"legendonly",H=c[l]===T,X=c[l].showlegend!==!0&&!c[l].legendgroup,V=H||E&&c[l].legendgroup===_,B(c[l],!(!V&&!X)||$)}}for(l=0;l<L.length;l++)if(d=L[l]){var W=d.constructUpdate(),te=Object.keys(W);for(h=0;h<te.length;h++)s=te[h],(w[s]=w[s]||[])[A[l]]=W[s]}for(x=Object.keys(w),l=0;l<x.length;l++)for(s=x[l],h=0;h<k.length;h++)w[s].hasOwnProperty(h)||(w[s][h]=void 0);g.call("_guiRestyle",e,w,k)}}}}function N(U,ee,j){var Q=k.indexOf(U),K=w[ee];return K||(K=w[ee]=[]),k.indexOf(U)===-1&&(k.push(U),Q=k.length-1),K[Q]=j,Q}function B(U,ee){if(!f.groupTitle||i){var j=U._fullInput;if(g.hasTransform(j,"groupby")){var Q=L[j.index];if(!Q){var K=g.getTransformIndices(j,"groupby"),re=K[K.length-1];Q=p.keyedContainer(j,"transforms["+re+"].styles","target","value.visible"),L[j.index]=Q}var ne=Q.get(U._group);ne===void 0&&(ne=!0),ne!==!1&&Q.set(U._group,ee),A[j.index]=N(j.index,"visible",j.visible!==!1)}else{var le=j.visible!==!1&&ee;N(j.index,"visible",le)}}}}},{"../../lib":515,"../../registry":647}],423:[function(v,J,Z){Z.isGrouped=function(p){return(p.traceorder||"").indexOf("grouped")!==-1},Z.isVertical=function(p){return p.orientation!=="h"},Z.isReversed=function(p){return(p.traceorder||"").indexOf("reversed")!==-1}},{}],424:[function(v,J,Z){J.exports={moduleType:"component",name:"legend",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),draw:v("./draw"),style:v("./style")}},{"./attributes":417,"./defaults":419,"./draw":420,"./style":425}],425:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../registry"),b=v("../../lib"),y=b.strTranslate,e=v("../drawing"),n=v("../color"),t=v("../colorscale/helpers").extractOpts,a=v("../../traces/scatter/subtypes"),r=v("../../traces/pie/style_one"),m=v("../../traces/pie/helpers").castOption,o=v("./constants");function i(l,h){return(h?"radial":"horizontal")+(l?"":"reversed")}function u(l){var h=l[0].trace,d=h.contours,s=a.hasLines(h),x=a.hasMarkers(h),c=h.visible&&h.fill&&h.fill!=="none",T=!1,_=!1;if(d){var w=d.coloring;w==="lines"?T=!0:s=w==="none"||w==="heatmap"||d.showlines,d.type==="constraint"?c=d._operation!=="=":w!=="fill"&&w!=="heatmap"||(_=!0)}return{showMarker:x,showLine:s,showFill:c,showGradientLine:T,showGradientFill:_,anyLine:s||T,anyFill:c||_}}function f(l,h,d){return l&&b.isArrayOrTypedArray(l)?h:l>d?d:l}J.exports=function(l,h,d){var s=h._fullLayout;d||(d=s.legend);var x=d.itemsizing==="constant",c=d.itemwidth,T=(c+2*o.itemGap)/2,_=y(T,0),w=function(A,I,P,S){var E;if(A+1)E=A;else{if(!(I&&I.width>0))return 0;E=I.width}return x?S:Math.min(E,P)};function k(A,I,P){var S=A[0].trace,E=S.marker||{},D=E.line||{},R=P?S.visible&&S.type===P:g.traceIs(S,"bar"),H=p.select(I).select("g.legendpoints").selectAll("path.legend"+P).data(R?[A]:[]);H.enter().append("path").classed("legend"+P,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",_),H.exit().remove(),H.each(function(V){var X=p.select(this),$=V[0],G=w($.mlw,E.line,5,2);X.style("stroke-width",G+"px");var W=$.mcc;if(!d._inHover&&"mc"in $){var te=t(E),N=te.mid;N===void 0&&(N=(te.max+te.min)/2),W=e.tryColorscale(E,"")(N)}var B=W||$.mc||E.color,U=E.pattern,ee=U&&e.getPatternAttr(U.shape,0,"");if(ee){var j=e.getPatternAttr(U.bgcolor,0,null),Q=e.getPatternAttr(U.fgcolor,0,null),K=U.fgopacity,re=f(U.size,8,10),ne=f(U.solidity,.5,1),le="legend-"+S.uid;X.call(e.pattern,"legend",h,le,ee,re,ne,W,U.fillmode,j,Q,K)}else X.call(n.fill,B);G&&n.stroke(X,$.mlc||D.color)})}function L(A,I,P){var S=A[0],E=S.trace,D=P?E.visible&&E.type===P:g.traceIs(E,P),R=p.select(I).select("g.legendpoints").selectAll("path.legend"+P).data(D?[A]:[]);if(R.enter().append("path").classed("legend"+P,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",_),R.exit().remove(),R.size()){var H=(E.marker||{}).line,V=w(m(H.width,S.pts),H,5,2),X=b.minExtend(E,{marker:{line:{width:V}}});X.marker.line.color=H.color;var $=b.minExtend(S,{trace:X});r(R,$,X)}}l.each(function(A){var I=p.select(this),P=b.ensureSingle(I,"g","layers");P.style("opacity",A[0].trace.opacity);var S=d.valign,E=A[0].lineHeight,D=A[0].height;if(S!=="middle"&&E&&D){var R={top:1,bottom:-1}[S]*(.5*(E-D+3));P.attr("transform",y(0,R))}else P.attr("transform",null);P.selectAll("g.legendfill").data([A]).enter().append("g").classed("legendfill",!0),P.selectAll("g.legendlines").data([A]).enter().append("g").classed("legendlines",!0);var H=P.selectAll("g.legendsymbols").data([A]);H.enter().append("g").classed("legendsymbols",!0),H.selectAll("g.legendpoints").data([A]).enter().append("g").classed("legendpoints",!0)}).each(function(A){var I,P=A[0].trace,S=[];if(P.visible)switch(P.type){case"histogram2d":case"heatmap":S=[["M-15,-2V4H15V-2Z"]],I=!0;break;case"choropleth":case"choroplethmapbox":S=[["M-6,-6V6H6V-6Z"]],I=!0;break;case"densitymapbox":S=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],I="radial";break;case"cone":S=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],I=!1;break;case"streamtube":S=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],I=!1;break;case"surface":S=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],I=!0;break;case"mesh3d":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],I=!1;break;case"volume":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],I=!0;break;case"isosurface":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],I=!1}var E=p.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(S);E.enter().append("path").classed("legend3dandfriends",!0).attr("transform",_).style("stroke-miterlimit",1),E.exit().remove(),E.each(function(D,R){var H,V=p.select(this),X=t(P),$=X.colorscale,G=X.reversescale;if($){if(!I){var W=$.length;H=R===0?$[G?W-1:0][1]:R===1?$[G?0:W-1][1]:$[Math.floor((W-1)/2)][1]}}else{var te=P.vertexcolor||P.facecolor||P.color;H=b.isArrayOrTypedArray(te)?te[R]||te[0]:te}V.attr("d",D[0]),H?V.call(n.fill,H):V.call(function(N){if(N.size()){var B="legendfill-"+P.uid;e.gradient(N,h,B,i(G,I==="radial"),$,"fill")}})})}).each(function(A){var I=A[0].trace,P=I.type==="waterfall";if(A[0]._distinct&&P){var S=A[0].trace[A[0].dir].marker;return A[0].mc=S.color,A[0].mlw=S.line.width,A[0].mlc=S.line.color,k(A,this,"waterfall")}var E=[];I.visible&&P&&(E=A[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var D=p.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(E);D.enter().append("path").classed("legendwaterfall",!0).attr("transform",_).style("stroke-miterlimit",1),D.exit().remove(),D.each(function(R){var H=p.select(this),V=I[R[0]].marker,X=w(void 0,V.line,5,2);H.attr("d",R[1]).style("stroke-width",X+"px").call(n.fill,V.color),X&&H.call(n.stroke,V.line.color)})}).each(function(A){k(A,this,"funnel")}).each(function(A){k(A,this)}).each(function(A){var I=A[0].trace,P=p.select(this).select("g.legendpoints").selectAll("path.legendbox").data(I.visible&&g.traceIs(I,"box-violin")?[A]:[]);P.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",_),P.exit().remove(),P.each(function(){var S=p.select(this);if(I.boxpoints!=="all"&&I.points!=="all"||n.opacity(I.fillcolor)!==0||n.opacity((I.line||{}).color)!==0){var E=w(void 0,I.line,5,2);S.style("stroke-width",E+"px").call(n.fill,I.fillcolor),E&&n.stroke(S,I.line.color)}else{var D=b.minExtend(I,{marker:{size:x?12:b.constrain(I.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});P.call(e.pointStyle,D,h)}})}).each(function(A){L(A,this,"funnelarea")}).each(function(A){L(A,this,"pie")}).each(function(A){var I,P,S=u(A),E=S.showFill,D=S.showLine,R=S.showGradientLine,H=S.showGradientFill,V=S.anyFill,X=S.anyLine,$=A[0],G=$.trace,W=t(G),te=W.colorscale,N=W.reversescale,B=a.hasMarkers(G)||!V?"M5,0":X?"M5,-2":"M5,-3",U=p.select(this),ee=U.select(".legendfill").selectAll("path").data(E||H?[A]:[]);if(ee.enter().append("path").classed("js-fill",!0),ee.exit().remove(),ee.attr("d",B+"h"+c+"v6h-"+c+"z").call(function(K){if(K.size())if(E)e.fillGroupStyle(K,h);else{var re="legendfill-"+G.uid;e.gradient(K,h,re,i(N),te,"fill")}}),D||R){var j=w(void 0,G.line,10,5);P=b.minExtend(G,{line:{width:j}}),I=[b.minExtend($,{trace:P})]}var Q=U.select(".legendlines").selectAll("path").data(D||R?[I]:[]);Q.enter().append("path").classed("js-line",!0),Q.exit().remove(),Q.attr("d",B+(R?"l"+c+",0.0001":"h"+c)).call(D?e.lineGroupStyle:function(K){if(K.size()){var re="legendline-"+G.uid;e.lineGroupStyle(K),e.gradient(K,h,re,i(N),te,"stroke")}})}).each(function(A){var I,P,S=u(A),E=S.anyFill,D=S.anyLine,R=S.showLine,H=S.showMarker,V=A[0],X=V.trace,$=!H&&!D&&!E&&a.hasText(X);function G(Q,K,re,ne){var le=b.nestedProperty(X,Q).get(),oe=b.isArrayOrTypedArray(le)&&K?K(le):le;if(x&&oe&&ne!==void 0&&(oe=ne),re){if(oe<re[0])return re[0];if(oe>re[1])return re[1]}return oe}function W(Q){return V._distinct&&V.index&&Q[V.index]?Q[V.index]:Q[0]}if(H||$||R){var te={},N={};if(H){te.mc=G("marker.color",W),te.mx=G("marker.symbol",W),te.mo=G("marker.opacity",b.mean,[.2,1]),te.mlc=G("marker.line.color",W),te.mlw=G("marker.line.width",b.mean,[0,5],2),N.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var B=G("marker.size",b.mean,[2,16],12);te.ms=B,N.marker.size=B}R&&(N.line={width:G("line.width",W,[0,10],5)}),$&&(te.tx="Aa",te.tp=G("textposition",W),te.ts=10,te.tc=G("textfont.color",W),te.tf=G("textfont.family",W)),I=[b.minExtend(V,te)],(P=b.minExtend(X,N)).selectedpoints=null,P.texttemplate=null}var U=p.select(this).select("g.legendpoints"),ee=U.selectAll("path.scatterpts").data(H?I:[]);ee.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",_),ee.exit().remove(),ee.call(e.pointStyle,P,h),H&&(I[0].mrc=3);var j=U.selectAll("g.pointtext").data($?I:[]);j.enter().append("g").classed("pointtext",!0).append("text").attr("transform",_),j.exit().remove(),j.selectAll("text").call(e.textPointStyle,P,h)}).each(function(A){var I=A[0].trace,P=p.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(I.visible&&I.type==="candlestick"?[A,A]:[]);P.enter().append("path").classed("legendcandle",!0).attr("d",function(S,E){return E?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",_).style("stroke-miterlimit",1),P.exit().remove(),P.each(function(S,E){var D=p.select(this),R=I[E?"increasing":"decreasing"],H=w(void 0,R.line,5,2);D.style("stroke-width",H+"px").call(n.fill,R.fillcolor),H&&n.stroke(D,R.line.color)})}).each(function(A){var I=A[0].trace,P=p.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(I.visible&&I.type==="ohlc"?[A,A]:[]);P.enter().append("path").classed("legendohlc",!0).attr("d",function(S,E){return E?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",_).style("stroke-miterlimit",1),P.exit().remove(),P.each(function(S,E){var D=p.select(this),R=I[E?"increasing":"decreasing"],H=w(void 0,R.line,5,2);D.style("fill","none").call(e.dashLine,R.line.dash,H),H&&n.stroke(D,R.line.color)})})}},{"../../lib":515,"../../registry":647,"../../traces/pie/helpers":915,"../../traces/pie/style_one":921,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale/helpers":378,"../drawing":389,"./constants":418,"@plotly/d3":58}],426:[function(v,J,Z){v("./constants"),J.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":428}],427:[function(v,J,Z){var p=v("../../registry"),g=v("../../plots/plots"),b=v("../../plots/cartesian/axis_ids"),y=v("../../fonts/ploticon"),e=v("../shapes/draw").eraseActiveShape,n=v("../../lib"),t=n._,a=J.exports={};function r(s,x){var c,T,_=x.currentTarget,w=_.getAttribute("data-attr"),k=_.getAttribute("data-val")||!0,L=s._fullLayout,A={},I=b.list(s,null,!0),P=L._cartesianSpikesEnabled;if(w==="zoom"){var S,E=k==="in"?.5:2,D=(1+E)/2,R=(1-E)/2;for(T=0;T<I.length;T++)if(!(c=I[T]).fixedrange)if(S=c._name,k==="auto")A[S+".autorange"]=!0;else if(k==="reset"){if(c._rangeInitial===void 0)A[S+".autorange"]=!0;else{var H=c._rangeInitial.slice();A[S+".range[0]"]=H[0],A[S+".range[1]"]=H[1]}c._showSpikeInitial!==void 0&&(A[S+".showspikes"]=c._showSpikeInitial,P!=="on"||c._showSpikeInitial||(P="off"))}else{var V=[c.r2l(c.range[0]),c.r2l(c.range[1])],X=[D*V[0]+R*V[1],D*V[1]+R*V[0]];A[S+".range[0]"]=c.l2r(X[0]),A[S+".range[1]"]=c.l2r(X[1])}}else w!=="hovermode"||k!=="x"&&k!=="y"||(k=L._isHoriz?"y":"x",_.setAttribute("data-val",k)),A[w]=k;L._cartesianSpikesEnabled=P,p.call("_guiRelayout",s,A)}function m(s,x){for(var c=x.currentTarget,T=c.getAttribute("data-attr"),_=c.getAttribute("data-val")||!0,w=s._fullLayout._subplots.gl3d||[],k={},L=T.split("."),A=0;A<w.length;A++)k[w[A]+"."+L[1]]=_;var I=_==="pan"?_:"zoom";k.dragmode=I,p.call("_guiRelayout",s,k)}function o(s,x){for(var c=x.currentTarget.getAttribute("data-attr"),T=c==="resetLastSave",_=c==="resetDefault",w=s._fullLayout,k=w._subplots.gl3d||[],L={},A=0;A<k.length;A++){var I,P=k[A],S=P+".camera",E=P+".aspectratio",D=P+".aspectmode",R=w[P]._scene;T?(L[S+".up"]=R.viewInitial.up,L[S+".eye"]=R.viewInitial.eye,L[S+".center"]=R.viewInitial.center,I=!0):_&&(L[S+".up"]=null,L[S+".eye"]=null,L[S+".center"]=null,I=!0),I&&(L[E+".x"]=R.viewInitial.aspectratio.x,L[E+".y"]=R.viewInitial.aspectratio.y,L[E+".z"]=R.viewInitial.aspectratio.z,L[D]=R.viewInitial.aspectmode)}p.call("_guiRelayout",s,L)}function i(s,x){var c=x.currentTarget,T=c._previousVal,_=s._fullLayout,w=_._subplots.gl3d||[],k=["xaxis","yaxis","zaxis"],L={},A={};if(T)A=T,c._previousVal=null;else{for(var I=0;I<w.length;I++){var P=w[I],S=_[P],E=P+".hovermode";L[E]=S.hovermode,A[E]=!1;for(var D=0;D<3;D++){var R=k[D],H=P+"."+R+".showspikes";A[H]=!1,L[H]=S[R].showspikes}}c._previousVal=L}return A}function u(s,x){for(var c=x.currentTarget,T=c.getAttribute("data-attr"),_=c.getAttribute("data-val")||!0,w=s._fullLayout,k=w._subplots.geo||[],L=0;L<k.length;L++){var A=k[L],I=w[A];if(T==="zoom"){var P=I.projection.scale,S=_==="in"?2*P:.5*P;p.call("_guiRelayout",s,A+".projection.scale",S)}}T==="reset"&&d(s,"geo")}function f(s){var x=s._fullLayout;return!x.hovermode&&(x._has("cartesian")?x._isHoriz?"y":"x":"closest")}function l(s){var x=f(s);p.call("_guiRelayout",s,"hovermode",x)}function h(s,x){for(var c=x.currentTarget.getAttribute("data-val"),T=s._fullLayout,_=T._subplots.mapbox||[],w={},k=0;k<_.length;k++){var L=_[k],A=T[L].zoom,I=c==="in"?1.05*A:A/1.05;w[L+".zoom"]=I}p.call("_guiRelayout",s,w)}function d(s,x){for(var c=s._fullLayout,T=c._subplots[x]||[],_={},w=0;w<T.length;w++)for(var k=T[w],L=c[k]._subplot.viewInitial,A=Object.keys(L),I=0;I<A.length;I++){var P=A[I];_[k+"."+P]=L[P]}p.call("_guiRelayout",s,_)}a.toImage={name:"toImage",title:function(s){var x=(s._context.toImageButtonOptions||{}).format||"png";return t(s,x==="png"?"Download plot as a png":"Download plot")},icon:y.camera,click:function(s){var x=s._context.toImageButtonOptions,c={format:x.format||"png"};n.notifier(t(s,"Taking snapshot - this may take a few seconds"),"long"),c.format!=="svg"&&n.isIE()&&(n.notifier(t(s,"IE only supports svg.  Changing format to svg."),"long"),c.format="svg"),["filename","width","height","scale"].forEach(function(T){T in x&&(c[T]=x[T])}),p.call("downloadImage",s,c).then(function(T){n.notifier(t(s,"Snapshot succeeded")+" - "+T,"long")}).catch(function(){n.notifier(t(s,"Sorry, there was a problem downloading your snapshot!"),"long")})}},a.sendDataToCloud={name:"sendDataToCloud",title:function(s){return t(s,"Edit in Chart Studio")},icon:y.disk,click:function(s){g.sendDataToCloud(s)}},a.editInChartStudio={name:"editInChartStudio",title:function(s){return t(s,"Edit in Chart Studio")},icon:y.pencil,click:function(s){g.sendDataToCloud(s)}},a.zoom2d={name:"zoom2d",_cat:"zoom",title:function(s){return t(s,"Zoom")},attr:"dragmode",val:"zoom",icon:y.zoombox,click:r},a.pan2d={name:"pan2d",_cat:"pan",title:function(s){return t(s,"Pan")},attr:"dragmode",val:"pan",icon:y.pan,click:r},a.select2d={name:"select2d",_cat:"select",title:function(s){return t(s,"Box Select")},attr:"dragmode",val:"select",icon:y.selectbox,click:r},a.lasso2d={name:"lasso2d",_cat:"lasso",title:function(s){return t(s,"Lasso Select")},attr:"dragmode",val:"lasso",icon:y.lasso,click:r},a.drawclosedpath={name:"drawclosedpath",title:function(s){return t(s,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:y.drawclosedpath,click:r},a.drawopenpath={name:"drawopenpath",title:function(s){return t(s,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:y.drawopenpath,click:r},a.drawline={name:"drawline",title:function(s){return t(s,"Draw line")},attr:"dragmode",val:"drawline",icon:y.drawline,click:r},a.drawrect={name:"drawrect",title:function(s){return t(s,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:y.drawrect,click:r},a.drawcircle={name:"drawcircle",title:function(s){return t(s,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:y.drawcircle,click:r},a.eraseshape={name:"eraseshape",title:function(s){return t(s,"Erase active shape")},icon:y.eraseshape,click:e},a.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(s){return t(s,"Zoom in")},attr:"zoom",val:"in",icon:y.zoom_plus,click:r},a.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(s){return t(s,"Zoom out")},attr:"zoom",val:"out",icon:y.zoom_minus,click:r},a.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(s){return t(s,"Autoscale")},attr:"zoom",val:"auto",icon:y.autoscale,click:r},a.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(s){return t(s,"Reset axes")},attr:"zoom",val:"reset",icon:y.home,click:r},a.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(s){return t(s,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:y.tooltip_basic,gravity:"ne",click:r},a.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(s){return t(s,"Compare data on hover")},attr:"hovermode",val:function(s){return s._fullLayout._isHoriz?"y":"x"},icon:y.tooltip_compare,gravity:"ne",click:r},a.zoom3d={name:"zoom3d",_cat:"zoom",title:function(s){return t(s,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:y.zoombox,click:m},a.pan3d={name:"pan3d",_cat:"pan",title:function(s){return t(s,"Pan")},attr:"scene.dragmode",val:"pan",icon:y.pan,click:m},a.orbitRotation={name:"orbitRotation",title:function(s){return t(s,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:y["3d_rotate"],click:m},a.tableRotation={name:"tableRotation",title:function(s){return t(s,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:y["z-axis"],click:m},a.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(s){return t(s,"Reset camera to default")},attr:"resetDefault",icon:y.home,click:o},a.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(s){return t(s,"Reset camera to last save")},attr:"resetLastSave",icon:y.movie,click:o},a.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(s){return t(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:function(s,x){var c=i(s,x);p.call("_guiRelayout",s,c)}},a.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(s){return t(s,"Zoom in")},attr:"zoom",val:"in",icon:y.zoom_plus,click:u},a.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(s){return t(s,"Zoom out")},attr:"zoom",val:"out",icon:y.zoom_minus,click:u},a.resetGeo={name:"resetGeo",_cat:"reset",title:function(s){return t(s,"Reset")},attr:"reset",val:null,icon:y.autoscale,click:u},a.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(s){return t(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:l},a.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(s){return t(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:l},a.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(s){return t(s,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:y.tooltip_basic,gravity:"ne",click:l},a.resetViewSankey={name:"resetSankeyGroup",title:function(s){return t(s,"Reset view")},icon:y.home,click:function(s){for(var x={"node.groups":[],"node.x":[],"node.y":[]},c=0;c<s._fullData.length;c++){var T=s._fullData[c]._viewInitial;x["node.groups"].push(T.node.groups.slice()),x["node.x"].push(T.node.x.slice()),x["node.y"].push(T.node.y.slice())}p.call("restyle",s,x)}},a.toggleHover={name:"toggleHover",title:function(s){return t(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:function(s,x){var c=i(s,x);c.hovermode=f(s),p.call("_guiRelayout",s,c)}},a.resetViews={name:"resetViews",title:function(s){return t(s,"Reset views")},icon:y.home,click:function(s,x){var c=x.currentTarget;c.setAttribute("data-attr","zoom"),c.setAttribute("data-val","reset"),r(s,x),c.setAttribute("data-attr","resetLastSave"),o(s,x),d(s,"geo"),d(s,"mapbox")}},a.toggleSpikelines={name:"toggleSpikelines",title:function(s){return t(s,"Toggle Spike Lines")},icon:y.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(s){var x=s._fullLayout,c=x._cartesianSpikesEnabled;x._cartesianSpikesEnabled=c==="on"?"off":"on",p.call("_guiRelayout",s,function(T){for(var _=T._fullLayout._cartesianSpikesEnabled==="on",w=b.list(T,null,!0),k={},L=0;L<w.length;L++){var A=w[L];k[A._name+".showspikes"]=!!_||A._showSpikeInitial}return k}(s))}},a.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(s){return t(s,"Reset view")},attr:"reset",icon:y.home,click:function(s){d(s,"mapbox")}},a.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(s){return t(s,"Zoom in")},attr:"zoom",val:"in",icon:y.zoom_plus,click:h},a.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(s){return t(s,"Zoom out")},attr:"zoom",val:"out",icon:y.zoom_minus,click:h}},{"../../fonts/ploticon":494,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../shapes/draw":462}],428:[function(v,J,Z){var p=v("./buttons"),g=Object.keys(p),b=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],y=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(b),e=[];g.forEach(function(n){(function(t){if(y.indexOf(t._cat||t.name)===-1){var a=t.name,r=(t._cat||t.name).toLowerCase();e.indexOf(a)===-1&&e.push(a),e.indexOf(r)===-1&&e.push(r)}})(p[n])}),e.sort(),J.exports={DRAW_MODES:b,backButtons:y,foreButtons:e}},{"./buttons":427}],429:[function(v,J,Z){var p=v("../../lib"),g=v("../color"),b=v("../../plot_api/plot_template"),y=v("./attributes");J.exports=function(e,n){var t=e.modebar||{},a=b.newContainer(n,"modebar");function r(o,i){return p.coerce(t,a,y,o,i)}r("orientation"),r("bgcolor",g.addOpacity(n.paper_bgcolor,.5));var m=g.contrast(g.rgb(n.modebar.bgcolor));r("color",g.addOpacity(m,.3)),r("activecolor",g.addOpacity(m,.7)),r("uirevision",n.uirevision),r("add"),r("remove")}},{"../../lib":515,"../../plot_api/plot_template":555,"../color":367,"./attributes":426}],430:[function(v,J,Z){J.exports={moduleType:"component",name:"modebar",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),manage:v("./manage")}},{"./attributes":426,"./defaults":429,"./manage":431}],431:[function(v,J,Z){var p=v("../../plots/cartesian/axis_ids"),g=v("../../traces/scatter/subtypes"),b=v("../../registry"),y=v("../fx/helpers").isUnifiedHover,e=v("./modebar"),n=v("./buttons"),t=v("./constants").DRAW_MODES,a=v("../../lib").extendDeep;J.exports=function(r){var m=r._fullLayout,o=r._context,i=m._modeBar;if(o.displayModeBar||o.watermark){if(!Array.isArray(o.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(o.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var u,f=o.modeBarButtons;u=Array.isArray(f)&&f.length?function(l){for(var h=a([],l),d=0;d<h.length;d++)for(var s=h[d],x=0;x<s.length;x++){var c=s[x];if(typeof c=="string"){if(n[c]===void 0)throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));h[d][x]=n[c]}}return h}(f):!o.displayModeBar&&o.watermark?[]:function(l){var h=l._fullLayout,d=l._fullData,s=l._context;function x(le,oe){if(typeof oe=="string"){if(oe.toLowerCase()===le.toLowerCase())return!0}else{var de=oe.name,se=oe._cat||oe.name;if(de===le||se===le.toLowerCase())return!0}return!1}var c=h.modebar.add;typeof c=="string"&&(c=[c]);var T=h.modebar.remove;typeof T=="string"&&(T=[T]);var _=s.modeBarButtonsToAdd.concat(c.filter(function(le){for(var oe=0;oe<s.modeBarButtonsToRemove.length;oe++)if(x(le,s.modeBarButtonsToRemove[oe]))return!1;return!0})),w=s.modeBarButtonsToRemove.concat(T.filter(function(le){for(var oe=0;oe<s.modeBarButtonsToAdd.length;oe++)if(x(le,s.modeBarButtonsToAdd[oe]))return!1;return!0})),k=h._has("cartesian"),L=h._has("gl3d"),A=h._has("geo"),I=h._has("pie"),P=h._has("funnelarea"),S=h._has("gl2d"),E=h._has("ternary"),D=h._has("mapbox"),R=h._has("polar"),H=h._has("smith"),V=h._has("sankey"),X=function(le){for(var oe=p.list({_fullLayout:le},null,!0),de=0;de<oe.length;de++)if(!oe[de].fixedrange)return!1;return!0}(h),$=y(h.hovermode),G=[];function W(le){if(le.length){for(var oe=[],de=0;de<le.length;de++){for(var se=le[de],me=n[se],Te=me.name.toLowerCase(),_e=(me._cat||me.name).toLowerCase(),be=!1,Ce=0;Ce<w.length;Ce++){var fe=w[Ce].toLowerCase();if(fe===Te||fe===_e){be=!0;break}}be||oe.push(n[se])}G.push(oe)}}var te=["toImage"];s.showEditInChartStudio?te.push("editInChartStudio"):s.showSendToCloud&&te.push("sendDataToCloud"),W(te);var N=[],B=[],U=[],ee=[];(k||S||I||P||E)+A+L+D+R+H>1?(B=["toggleHover"],U=["resetViews"]):A?(N=["zoomInGeo","zoomOutGeo"],B=["hoverClosestGeo"],U=["resetGeo"]):L?(B=["hoverClosest3d"],U=["resetCameraDefault3d","resetCameraLastSave3d"]):D?(N=["zoomInMapbox","zoomOutMapbox"],B=["toggleHover"],U=["resetViewMapbox"]):S?B=["hoverClosestGl2d"]:I?B=["hoverClosestPie"]:V?(B=["hoverClosestCartesian","hoverCompareCartesian"],U=["resetViewSankey"]):B=["toggleHover"],k&&(B=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(le){for(var oe=0;oe<le.length;oe++)if(!b.traceIs(le[oe],"noHover"))return!1;return!0}(d)||$)&&(B=[]),!k&&!S||X||(N=["zoomIn2d","zoomOut2d","autoScale2d"],U[0]!=="resetViews"&&(U=["resetScale2d"])),L?ee=["zoom3d","pan3d","orbitRotation","tableRotation"]:(k||S)&&!X||E?ee=["zoom2d","pan2d"]:D||A?ee=["pan2d"]:R&&(ee=["zoom2d"]),function(le){for(var oe=!1,de=0;de<le.length&&!oe;de++){var se=le[de];se._module&&se._module.selectPoints&&(b.traceIs(se,"scatter-like")?(g.hasMarkers(se)||g.hasText(se))&&(oe=!0):b.traceIs(se,"box-violin")&&se.boxpoints!=="all"&&se.points!=="all"||(oe=!0))}return oe}(d)&&ee.push("select2d","lasso2d");var j=[],Q=function(le){j.indexOf(le)===-1&&B.indexOf(le)!==-1&&j.push(le)};if(Array.isArray(_)){for(var K=[],re=0;re<_.length;re++){var ne=_[re];typeof ne=="string"?(ne=ne.toLowerCase(),t.indexOf(ne)!==-1?(h._has("mapbox")||h._has("cartesian"))&&ee.push(ne):ne==="togglespikelines"?Q("toggleSpikelines"):ne==="togglehover"?Q("toggleHover"):ne==="hovercompare"?Q("hoverCompareCartesian"):ne==="hoverclosest"?(Q("hoverClosestCartesian"),Q("hoverClosestGeo"),Q("hoverClosest3d"),Q("hoverClosestGl2d"),Q("hoverClosestPie")):ne==="v1hovermode"&&(Q("toggleHover"),Q("hoverClosestCartesian"),Q("hoverCompareCartesian"),Q("hoverClosestGeo"),Q("hoverClosest3d"),Q("hoverClosestGl2d"),Q("hoverClosestPie"))):K.push(ne)}_=K}return W(ee),W(N.concat(U)),W(j),function(le,oe){if(oe.length)if(Array.isArray(oe[0]))for(var de=0;de<oe.length;de++)le.push(oe[de]);else le.push(oe);return le}(G,_)}(r),i?i.update(r,u):m._modeBar=e(r,u)}else i&&(i.destroy(),delete m._modeBar)}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../../traces/scatter/subtypes":961,"../fx/helpers":403,"./buttons":427,"./constants":428,"./modebar":432}],432:[function(v,J,Z){var p=v("@plotly/d3"),g=v("fast-isnumeric"),b=v("../../lib"),y=v("../../fonts/ploticon"),e=v("../../version").version,n=new DOMParser;function t(r){this.container=r.container,this.element=document.createElement("div"),this.update(r.graphInfo,r.buttons),this.container.appendChild(this.element)}var a=t.prototype;a.update=function(r,m){this.graphInfo=r;var o=this.graphInfo._context,i=this.graphInfo._fullLayout,u="modebar-"+i._uid;this.element.setAttribute("id",u),this._uid=u,this.element.className="modebar",o.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),i.modebar.orientation==="v"&&(this.element.className+=" vertical",m=m.reverse());var f=i.modebar,l=o.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";b.deleteRelatedStyleRule(u),b.addRelatedStyleRule(u,l+"#"+u+" .modebar-group","background-color: "+f.bgcolor),b.addRelatedStyleRule(u,"#"+u+" .modebar-btn .icon path","fill: "+f.color),b.addRelatedStyleRule(u,"#"+u+" .modebar-btn:hover .icon path","fill: "+f.activecolor),b.addRelatedStyleRule(u,"#"+u+" .modebar-btn.active .icon path","fill: "+f.activecolor);var h=!this.hasButtons(m),d=this.hasLogo!==o.displaylogo,s=this.locale!==o.locale;if(this.locale=o.locale,(h||d||s)&&(this.removeAllButtons(),this.updateButtons(m),o.watermark||o.displaylogo)){var x=this.getLogo();o.watermark&&(x.className=x.className+" watermark"),i.modebar.orientation==="v"?this.element.insertBefore(x,this.element.childNodes[0]):this.element.appendChild(x),this.hasLogo=!0}this.updateActiveButton()},a.updateButtons=function(r){var m=this;this.buttons=r,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(o){var i=m.createGroup();o.forEach(function(u){var f=u.name;if(!f)throw new Error("must provide button 'name' in button config");if(m.buttonsNames.indexOf(f)!==-1)throw new Error("button name '"+f+"' is taken");m.buttonsNames.push(f);var l=m.createButton(u);m.buttonElements.push(l),i.appendChild(l)}),m.element.appendChild(i)})},a.createGroup=function(){var r=document.createElement("div");return r.className="modebar-group",r},a.createButton=function(r){var m=this,o=document.createElement("a");o.setAttribute("rel","tooltip"),o.className="modebar-btn";var i=r.title;i===void 0?i=r.name:typeof i=="function"&&(i=i(this.graphInfo)),(i||i===0)&&o.setAttribute("data-title",i),r.attr!==void 0&&o.setAttribute("data-attr",r.attr);var u=r.val;if(u!==void 0&&(typeof u=="function"&&(u=u(this.graphInfo)),o.setAttribute("data-val",u)),typeof r.click!="function")throw new Error("must provide button 'click' function in button config");o.addEventListener("click",function(l){r.click(m.graphInfo,l),m.updateActiveButton(l.currentTarget)}),o.setAttribute("data-toggle",r.toggle||!1),r.toggle&&p.select(o).classed("active",!0);var f=r.icon;return typeof f=="function"?o.appendChild(f()):o.appendChild(this.createIcon(f||y.question)),o.setAttribute("data-gravity",r.gravity||"n"),o},a.createIcon=function(r){var m,o=g(r.height)?Number(r.height):r.ascent-r.descent,i="http://www.w3.org/2000/svg";if(r.path){(m=document.createElementNS(i,"svg")).setAttribute("viewBox",[0,0,r.width,o].join(" ")),m.setAttribute("class","icon");var u=document.createElementNS(i,"path");u.setAttribute("d",r.path),r.transform?u.setAttribute("transform",r.transform):r.ascent!==void 0&&u.setAttribute("transform","matrix(1 0 0 -1 0 "+r.ascent+")"),m.appendChild(u)}return r.svg&&(m=n.parseFromString(r.svg,"application/xml").childNodes[0]),m.setAttribute("height","1em"),m.setAttribute("width","1em"),m},a.updateActiveButton=function(r){var m=this.graphInfo._fullLayout,o=r!==void 0?r.getAttribute("data-attr"):null;this.buttonElements.forEach(function(i){var u=i.getAttribute("data-val")||!0,f=i.getAttribute("data-attr"),l=i.getAttribute("data-toggle")==="true",h=p.select(i);if(l)f===o&&h.classed("active",!h.classed("active"));else{var d=f===null?f:b.nestedProperty(m,f).get();h.classed("active",d===u)}})},a.hasButtons=function(r){var m=this.buttons;if(!m||r.length!==m.length)return!1;for(var o=0;o<r.length;++o){if(r[o].length!==m[o].length)return!1;for(var i=0;i<r[o].length;i++)if(r[o][i].name!==m[o][i].name)return!1}return!0},a.getLogo=function(){var r=this.createGroup(),m=document.createElement("a");return m.href="https://plotly.com/",m.target="_blank",m.setAttribute("data-title",b._(this.graphInfo,"Produced with Plotly.js")+" (v"+e+")"),m.className="modebar-btn plotlyjsicon modebar-btn--logo",m.appendChild(this.createIcon(y.newplotlylogo)),r.appendChild(m),r},a.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},a.destroy=function(){b.removeElement(this.container.querySelector(".modebar")),b.deleteRelatedStyleRule(this._uid)},J.exports=function(r,m){var o=r._fullLayout,i=new t({graphInfo:r,container:o._modebardiv.node(),buttons:m});return o._privateplot&&p.select(i.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),i}},{"../../fonts/ploticon":494,"../../lib":515,"../../version":1132,"@plotly/d3":58,"fast-isnumeric":190}],433:[function(v,J,Z){var p=v("../../plots/font_attributes"),g=v("../color/attributes"),b=(0,v("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});J.exports={visible:{valType:"boolean",editType:"plot"},buttons:b,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:p({editType:"plot"}),bgcolor:{valType:"color",dflt:g.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:g.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../color/attributes":366}],434:[function(v,J,Z){J.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],435:[function(v,J,Z){var p=v("../../lib"),g=v("../color"),b=v("../../plot_api/plot_template"),y=v("../../plots/array_container_defaults"),e=v("./attributes"),n=v("./constants");function t(a,r,m,o){var i=o.calendar;function u(l,h){return p.coerce(a,r,e.buttons,l,h)}if(u("visible")){var f=u("step");f!=="all"&&(!i||i==="gregorian"||f!=="month"&&f!=="year"?u("stepmode"):r.stepmode="backward",u("count")),u("label")}}J.exports=function(a,r,m,o,i){var u=a.rangeselector||{},f=b.newContainer(r,"rangeselector");function l(s,x){return p.coerce(u,f,e,s,x)}if(l("visible",y(u,f,{name:"buttons",handleItemDefaults:t,calendar:i}).length>0)){var h=function(s,x,c){for(var T=c.filter(function(L){return x[L].anchor===s._id}),_=0,w=0;w<T.length;w++){var k=x[T[w]].domain;k&&(_=Math.max(k[1],_))}return[s.domain[0],_+n.yPad]}(r,m,o);l("x",h[0]),l("y",h[1]),p.noneOrAll(a,r,["x","y"]),l("xanchor"),l("yanchor"),p.coerceFont(l,"font",m.font);var d=l("bgcolor");l("activecolor",g.contrast(d,n.lightAmount,n.darkAmount)),l("bordercolor"),l("borderwidth")}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../color":367,"./attributes":433,"./constants":434}],436:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../registry"),b=v("../../plots/plots"),y=v("../color"),e=v("../drawing"),n=v("../../lib"),t=n.strTranslate,a=v("../../lib/svg_text_utils"),r=v("../../plots/cartesian/axis_ids"),m=v("../../constants/alignment"),o=m.LINE_SPACING,i=m.FROM_TL,u=m.FROM_BR,f=v("./constants"),l=v("./get_update_object");function h(x){return x._id}function d(x,c,T){var _=n.ensureSingle(x,"rect","selector-rect",function(w){w.attr("shape-rendering","crispEdges")});_.attr({rx:f.rx,ry:f.ry}),_.call(y.stroke,c.bordercolor).call(y.fill,function(w,k){return k._isActive||k._isHovered?w.activecolor:w.bgcolor}(c,T)).style("stroke-width",c.borderwidth+"px")}function s(x,c,T,_){n.ensureSingle(x,"text","selector-text",function(w){w.attr("text-anchor","middle")}).call(e.font,c.font).text(function(w,k){return w.label?k?n.templateString(w.label,k):w.label:w.step==="all"?"all":w.count+w.step.charAt(0)}(T,_._fullLayout._meta)).call(function(w){a.convertToTspans(w,_)})}J.exports=function(x){var c=x._fullLayout._infolayer.selectAll(".rangeselector").data(function(T){for(var _=r.list(T,"x",!0),w=[],k=0;k<_.length;k++){var L=_[k];L.rangeselector&&L.rangeselector.visible&&w.push(L)}return w}(x),h);c.enter().append("g").classed("rangeselector",!0),c.exit().remove(),c.style({cursor:"pointer","pointer-events":"all"}),c.each(function(T){var _=p.select(this),w=T,k=w.rangeselector,L=_.selectAll("g.button").data(n.filterVisible(k.buttons));L.enter().append("g").classed("button",!0),L.exit().remove(),L.each(function(A){var I=p.select(this),P=l(w,A);A._isActive=function(S,E,D){if(E.step==="all")return S.autorange===!0;var R=Object.keys(D);return S.range[0]===D[R[0]]&&S.range[1]===D[R[1]]}(w,A,P),I.call(d,k,A),I.call(s,k,A,x),I.on("click",function(){x._dragged||g.call("_guiRelayout",x,P)}),I.on("mouseover",function(){A._isHovered=!0,I.call(d,k,A)}),I.on("mouseout",function(){A._isHovered=!1,I.call(d,k,A)})}),function(A,I,P,S,E){var D=0,R=0,H=P.borderwidth;I.each(function(){var te=p.select(this).select(".selector-text"),N=P.font.size*o,B=Math.max(N*a.lineCount(te),16)+3;R=Math.max(R,B)}),I.each(function(){var te=p.select(this),N=te.select(".selector-rect"),B=te.select(".selector-text"),U=B.node()&&e.bBox(B.node()).width,ee=P.font.size*o,j=a.lineCount(B),Q=Math.max(U+10,f.minButtonWidth);te.attr("transform",t(H+D,H)),N.attr({x:0,y:0,width:Q,height:R}),a.positionText(B,Q/2,R/2-(j-1)*ee/2+3),D+=Q+5});var V=A._fullLayout._size,X=V.l+V.w*P.x,$=V.t+V.h*(1-P.y),G="left";n.isRightAnchor(P)&&(X-=D,G="right"),n.isCenterAnchor(P)&&(X-=D/2,G="center");var W="top";n.isBottomAnchor(P)&&($-=R,W="bottom"),n.isMiddleAnchor(P)&&($-=R/2,W="middle"),D=Math.ceil(D),R=Math.ceil(R),X=Math.round(X),$=Math.round($),b.autoMargin(A,S+"-range-selector",{x:P.x,y:P.y,l:D*i[G],r:D*u[G],b:R*u[W],t:R*i[W]}),E.attr("transform",t(X,$))}(x,L,k,w._name,_)})}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"./constants":434,"./get_update_object":437,"@plotly/d3":58}],437:[function(v,J,Z){var p=v("d3-time"),g=v("../../lib").titleCase;J.exports=function(b,y){var e=b._name,n={};if(y.step==="all")n[e+".autorange"]=!0;else{var t=function(a,r){var m,o=a.range,i=new Date(a.r2l(o[1])),u=r.step,f=p["utc"+g(u)],l=r.count;switch(r.stepmode){case"backward":m=a.l2r(+f.offset(i,-l));break;case"todate":var h=f.offset(i,-l);m=a.l2r(+f.ceil(h))}var d=o[1];return[m,d]}(b,y);n[e+".range[0]"]=t[0],n[e+".range[1]"]=t[1]}return n}},{"../../lib":515,"d3-time":122}],438:[function(v,J,Z){J.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:v("./attributes")}}},layoutAttributes:v("./attributes"),handleDefaults:v("./defaults"),draw:v("./draw")}},{"./attributes":433,"./defaults":435,"./draw":436}],439:[function(v,J,Z){var p=v("../color/attributes");J.exports={bgcolor:{valType:"color",dflt:p.background,editType:"plot"},bordercolor:{valType:"color",dflt:p.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":366}],440:[function(v,J,Z){var p=v("../../plots/cartesian/axis_ids").list,g=v("../../plots/cartesian/autorange").getAutoRange,b=v("./constants");J.exports=function(y){for(var e=p(y,"x",!0),n=0;n<e.length;n++){var t=e[n],a=t[b.name];a&&a.visible&&a.autorange&&(a._input.autorange=!0,a._input.range=a.range=g(y,t))}}},{"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"./constants":441}],441:[function(v,J,Z){J.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],442:[function(v,J,Z){var p=v("../../lib"),g=v("../../plot_api/plot_template"),b=v("../../plots/cartesian/axis_ids"),y=v("./attributes"),e=v("./oppaxis_attributes");J.exports=function(n,t,a){var r=n[a],m=t[a];if(r.rangeslider||t._requestRangeslider[m._id]){p.isPlainObject(r.rangeslider)||(r.rangeslider={});var o,i,u=r.rangeslider,f=g.newContainer(m,"rangeslider");if(_("visible")){_("bgcolor",t.plot_bgcolor),_("bordercolor"),_("borderwidth"),_("thickness"),_("autorange",!m.isValidRange(u.range)),_("range");var l=t._subplots;if(l)for(var h=l.cartesian.filter(function(k){return k.substr(0,k.indexOf("y"))===b.name2id(a)}).map(function(k){return k.substr(k.indexOf("y"),k.length)}),d=p.simpleMap(h,b.id2name),s=0;s<d.length;s++){var x=d[s];o=u[x]||{},i=g.newContainer(f,x,"yaxis");var c,T=t[x];o.range&&T.isValidRange(o.range)&&(c="fixed"),w("rangemode",c)!=="match"&&w("range",T.range.slice())}f._input=u}}function _(k,L){return p.coerce(u,f,y,k,L)}function w(k,L){return p.coerce(o,i,e,k,L)}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_ids":570,"./attributes":439,"./oppaxis_attributes":446}],443:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../registry"),b=v("../../plots/plots"),y=v("../../lib"),e=y.strTranslate,n=v("../drawing"),t=v("../color"),a=v("../titles"),r=v("../../plots/cartesian"),m=v("../../plots/cartesian/axis_ids"),o=v("../dragelement"),i=v("../../lib/setcursor"),u=v("./constants");function f(c,T,_,w){var k=y.ensureSingle(c,"rect",u.bgClassName,function(P){P.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),L=w.borderwidth%2==0?w.borderwidth:w.borderwidth-1,A=-w._offsetShift,I=n.crispRound(T,w.borderwidth);k.attr({width:w._width+L,height:w._height+L,transform:e(A,A),fill:w.bgcolor,stroke:w.bordercolor,"stroke-width":I})}function l(c,T,_,w){var k=T._fullLayout;y.ensureSingleById(k._topdefs,"clipPath",w._clipId,function(L){L.append("rect").attr({x:0,y:0})}).select("rect").attr({width:w._width,height:w._height})}function h(c,T,_,w){var k,L=T.calcdata,A=c.selectAll("g."+u.rangePlotClassName).data(_._subplotsWith,y.identity);A.enter().append("g").attr("class",function(I){return u.rangePlotClassName+" "+I}).call(n.setClipUrl,w._clipId,T),A.order(),A.exit().remove(),A.each(function(I,P){var S=p.select(this),E=P===0,D=m.getFromId(T,I,"y"),R=D._name,H=w[R],V={data:[],layout:{xaxis:{type:_.type,domain:[0,1],range:w.range.slice(),calendar:_.calendar},width:w._width,height:w._height,margin:{t:0,b:0,l:0,r:0}},_context:T._context};_.rangebreaks&&(V.layout.xaxis.rangebreaks=_.rangebreaks),V.layout[R]={type:D.type,domain:[0,1],range:H.rangemode!=="match"?H.range.slice():D.range.slice(),calendar:D.calendar},D.rangebreaks&&(V.layout[R].rangebreaks=D.rangebreaks),b.supplyDefaults(V);var X=V._fullLayout.xaxis,$=V._fullLayout[R];X.clearCalc(),X.setScale(),$.clearCalc(),$.setScale();var G={id:I,plotgroup:S,xaxis:X,yaxis:$,isRangePlot:!0};E?k=G:(G.mainplot="xy",G.mainplotinfo=k),r.rangePlot(T,G,function(W,te){for(var N=[],B=0;B<W.length;B++){var U=W[B],ee=U[0].trace;ee.xaxis+ee.yaxis===te&&N.push(U)}return N}(L,I))})}function d(c,T,_,w,k){y.ensureSingle(c,"rect",u.maskMinClassName,function(L){L.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",w._height).call(t.fill,u.maskColor),y.ensureSingle(c,"rect",u.maskMaxClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",w._height).call(t.fill,u.maskColor),k.rangemode!=="match"&&(y.ensureSingle(c,"rect",u.maskMinOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",w._width).call(t.fill,u.maskOppAxisColor),y.ensureSingle(c,"rect",u.maskMaxOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",w._width).style("border-top",u.maskOppBorder).call(t.fill,u.maskOppAxisColor))}function s(c,T,_,w){T._context.staticPlot||y.ensureSingle(c,"rect",u.slideBoxClassName,function(k){k.attr({y:0,cursor:u.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:w._height,fill:u.slideBoxFill})}function x(c,T,_,w){var k=y.ensureSingle(c,"g",u.grabberMinClassName),L=y.ensureSingle(c,"g",u.grabberMaxClassName),A={x:0,width:u.handleWidth,rx:u.handleRadius,fill:t.background,stroke:t.defaultLine,"stroke-width":u.handleStrokeWidth,"shape-rendering":"crispEdges"},I={y:Math.round(w._height/4),height:Math.round(w._height/2)};y.ensureSingle(k,"rect",u.handleMinClassName,function(S){S.attr(A)}).attr(I),y.ensureSingle(L,"rect",u.handleMaxClassName,function(S){S.attr(A)}).attr(I);var P={width:u.grabAreaWidth,x:0,y:0,fill:u.grabAreaFill,cursor:T._context.staticPlot?void 0:u.grabAreaCursor};y.ensureSingle(k,"rect",u.grabAreaMinClassName,function(S){S.attr(P)}).attr("height",w._height),y.ensureSingle(L,"rect",u.grabAreaMaxClassName,function(S){S.attr(P)}).attr("height",w._height)}J.exports=function(c){for(var T=c._fullLayout,_=T._rangeSliderData,w=0;w<_.length;w++){var k=_[w][u.name];k._clipId=k._id+"-"+T._uid}var L=T._infolayer.selectAll("g."+u.containerClassName).data(_,function(A){return A._name});L.exit().each(function(A){var I=A[u.name];T._topdefs.select("#"+I._clipId).remove()}).remove(),_.length!==0&&(L.enter().append("g").classed(u.containerClassName,!0).attr("pointer-events","all"),L.each(function(A){var I=p.select(this),P=A[u.name],S=T[m.id2name(A.anchor)],E=P[m.id2name(A.anchor)];if(P.range){var D,R=y.simpleMap(P.range,A.r2l),H=y.simpleMap(A.range,A.r2l);D=H[0]<H[1]?[Math.min(R[0],H[0]),Math.max(R[1],H[1])]:[Math.max(R[0],H[0]),Math.min(R[1],H[1])],P.range=P._input.range=y.simpleMap(D,A.l2r)}A.cleanRange("rangeslider.range");var V=T._size,X=A.domain;P._width=V.w*(X[1]-X[0]);var $=Math.round(V.l+V.w*X[0]),G=Math.round(V.t+V.h*(1-A._counterDomainMin)+(A.side==="bottom"?A._depth:0)+P._offsetShift+u.extraPad);I.attr("transform",e($,G)),P._rl=y.simpleMap(P.range,A.r2l);var W=P._rl[0],te=P._rl[1],N=te-W;if(P.p2d=function(le){return le/P._width*N+W},P.d2p=function(le){return(le-W)/N*P._width},A.rangebreaks){var B=A.locateBreaks(W,te);if(B.length){var U,ee,j=0;for(U=0;U<B.length;U++)j+=(ee=B[U]).max-ee.min;var Q=P._width/(te-W-j),K=[-Q*W];for(U=0;U<B.length;U++)ee=B[U],K.push(K[K.length-1]-Q*(ee.max-ee.min));for(P.d2p=function(le){for(var oe=K[0],de=0;de<B.length;de++){var se=B[de];if(le>=se.max)oe=K[de+1];else if(le<se.min)break}return oe+Q*le},U=0;U<B.length;U++)(ee=B[U]).pmin=P.d2p(ee.min),ee.pmax=P.d2p(ee.max);P.p2d=function(le){for(var oe=K[0],de=0;de<B.length;de++){var se=B[de];if(le>=se.pmax)oe=K[de+1];else if(le<se.pmin)break}return(le-oe)/Q}}}if(E.rangemode!=="match"){var re=S.r2l(E.range[0]),ne=S.r2l(E.range[1])-re;P.d2pOppAxis=function(le){return(le-re)/ne*P._height}}I.call(f,c,A,P).call(l,c,A,P).call(h,c,A,P).call(d,c,A,P,E).call(s,c,A,P).call(x,c,A,P),function(le,oe,de,se){if(oe._context.staticPlot)return;var me=le.select("rect."+u.slideBoxClassName).node(),Te=le.select("rect."+u.grabAreaMinClassName).node(),_e=le.select("rect."+u.grabAreaMaxClassName).node();function be(){var Ce=p.event,fe=Ce.target,ve=Ce.clientX||Ce.touches[0].clientX,Me=ve-le.node().getBoundingClientRect().left,ke=se.d2p(de._rl[0]),Le=se.d2p(de._rl[1]),ze=o.coverSlip();function Re(Ze){var Pe,Ie,Be,Fe=+(Ze.clientX||Ze.touches[0].clientX)-ve;switch(fe){case me:Be="ew-resize",Pe=ke+Fe,Ie=Le+Fe;break;case Te:Be="col-resize",Pe=ke+Fe,Ie=Le;break;case _e:Be="col-resize",Pe=ke,Ie=Le+Fe;break;default:Be="ew-resize",Pe=Me,Ie=Me+Fe}if(Ie<Pe){var $e=Ie;Ie=Pe,Pe=$e}se._pixelMin=Pe,se._pixelMax=Ie,i(p.select(ze),Be),function(ot,pt,_t,yt){function tt(Nt){return _t.l2r(y.constrain(Nt,yt._rl[0],yt._rl[1]))}var Ke=tt(yt.p2d(yt._pixelMin)),vt=tt(yt.p2d(yt._pixelMax));window.requestAnimationFrame(function(){g.call("_guiRelayout",pt,_t._name+".range",[Ke,vt])})}(0,oe,de,se)}function Oe(){ze.removeEventListener("mousemove",Re),ze.removeEventListener("mouseup",Oe),this.removeEventListener("touchmove",Re),this.removeEventListener("touchend",Oe),y.removeElement(ze)}this.addEventListener("touchmove",Re),this.addEventListener("touchend",Oe),ze.addEventListener("mousemove",Re),ze.addEventListener("mouseup",Oe)}le.on("mousedown",be),le.on("touchstart",be)}(I,c,A,P),function(le,oe,de,se,me,Te){var _e=u.handleWidth/2;function be(Oe){return y.constrain(Oe,0,se._width)}function Ce(Oe){return y.constrain(Oe,0,se._height)}function fe(Oe){return y.constrain(Oe,-_e,se._width+_e)}var ve=be(se.d2p(de._rl[0])),Me=be(se.d2p(de._rl[1]));if(le.select("rect."+u.slideBoxClassName).attr("x",ve).attr("width",Me-ve),le.select("rect."+u.maskMinClassName).attr("width",ve),le.select("rect."+u.maskMaxClassName).attr("x",Me).attr("width",se._width-Me),Te.rangemode!=="match"){var ke=se._height-Ce(se.d2pOppAxis(me._rl[1])),Le=se._height-Ce(se.d2pOppAxis(me._rl[0]));le.select("rect."+u.maskMinOppAxisClassName).attr("x",ve).attr("height",ke).attr("width",Me-ve),le.select("rect."+u.maskMaxOppAxisClassName).attr("x",ve).attr("y",Le).attr("height",se._height-Le).attr("width",Me-ve),le.select("rect."+u.slideBoxClassName).attr("y",ke).attr("height",Le-ke)}var ze=Math.round(fe(ve-_e))-.5,Re=Math.round(fe(Me-_e))+.5;le.select("g."+u.grabberMinClassName).attr("transform",e(ze,.5)),le.select("g."+u.grabberMaxClassName).attr("transform",e(Re,.5))}(I,0,A,P,S,E),A.side==="bottom"&&a.draw(c,A._id+"title",{propContainer:A,propName:A._name+".title",placeholder:T._dfltTitle.x,attributes:{x:A._offset+A._length/2,y:G+P._height+P._offsetShift+10+1.5*A.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":515,"../../lib/setcursor":536,"../../plots/cartesian":578,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":441,"@plotly/d3":58}],444:[function(v,J,Z){var p=v("../../plots/cartesian/axis_ids"),g=v("../../lib/svg_text_utils"),b=v("./constants"),y=v("../../constants/alignment").LINE_SPACING,e=b.name;function n(t){var a=t&&t[e];return a&&a.visible}Z.isVisible=n,Z.makeData=function(t){var a=p.list({_fullLayout:t},"x",!0),r=t.margin,m=[];if(!t._has("gl2d"))for(var o=0;o<a.length;o++){var i=a[o];if(n(i)){m.push(i);var u=i[e];u._id=e+i._id,u._height=(t.height-r.b-r.t)*u.thickness,u._offsetShift=Math.floor(u.borderwidth/2)}}t._rangeSliderData=m},Z.autoMarginOpts=function(t,a){var r=t._fullLayout,m=a[e],o=a._id.charAt(0),i=0,u=0;return a.side==="bottom"&&(i=a._depth,a.title.text!==r._dfltTitle[o]&&(u=1.5*a.title.font.size+10+m._offsetShift,u+=(a.title.text.match(g.BR_TAG_ALL)||[]).length*a.title.font.size*y)),{x:0,y:a._counterDomainMin,l:0,r:0,t:0,b:m._height+i+Math.max(r.margin.b,u),pad:b.extraPad+2*m._offsetShift}}},{"../../constants/alignment":483,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"./constants":441}],445:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes"),b=v("./oppaxis_attributes"),y=v("./helpers");J.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:p.extendFlat({},g,{yaxis:b})}}},layoutAttributes:v("./attributes"),handleDefaults:v("./defaults"),calcAutorange:v("./calc_autorange"),draw:v("./draw"),isVisible:y.isVisible,makeData:y.makeData,autoMarginOpts:y.autoMarginOpts}},{"../../lib":515,"./attributes":439,"./calc_autorange":440,"./defaults":442,"./draw":443,"./helpers":444,"./oppaxis_attributes":446}],446:[function(v,J,Z){J.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],447:[function(v,J,Z){var p=v("../annotations/attributes"),g=v("../../traces/scatter/attributes").line,b=v("../drawing/attributes").dash,y=v("../../lib/extend").extendFlat,e=v("../../plot_api/edit_types").overrideAll,n=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),J.exports=e(n("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:y({},p.xref,{}),yref:y({},p.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:g.color,width:y({},g.width,{min:1,dflt:1}),dash:y({},b,{dflt:"dot"})}}),"arraydraw","from-root")},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],448:[function(v,J,Z){J.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}},{}],449:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes"),b=v("../../plots/array_container_defaults"),y=v("./attributes"),e=v("../shapes/helpers");function n(t,a,r){function m(I,P){return p.coerce(t,a,y,I,P)}var o=m("path"),i=m("type",o?"path":"rect")!=="path";i&&delete a.path,m("opacity"),m("line.color"),m("line.width"),m("line.dash");for(var u=["x","y"],f=0;f<2;f++){var l,h,d,s=u[f],x={_fullLayout:r},c=g.coerceRef(t,a,x,s);if((l=g.getFromId(x,c))._selectionIndices.push(a._index),d=e.rangeToShapePosition(l),h=e.shapePositionToRange(l),i){var T=s+"0",_=s+"1",w=t[T],k=t[_];t[T]=h(t[T],!0),t[_]=h(t[_],!0),g.coercePosition(a,x,m,c,T),g.coercePosition(a,x,m,c,_);var L=a[T],A=a[_];L!==void 0&&A!==void 0&&(a[T]=d(L),a[_]=d(A),t[T]=w,t[_]=k)}}i&&p.noneOrAll(t,a,["x0","x1","y0","y1"])}J.exports=function(t,a){b(t,a,{name:"selections",handleItemDefaults:n});for(var r=a.selections,m=0;m<r.length;m++){var o=r[m];o&&o.path===void 0&&(o.x0!==void 0&&o.x1!==void 0&&o.y0!==void 0&&o.y1!==void 0||(a.selections[m]=null))}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../shapes/helpers":469,"./attributes":447}],450:[function(v,J,Z){var p=v("../shapes/draw_newshape/helpers").readPaths,g=v("../shapes/display_outlines"),b=v("../shapes/handle_outline").clearOutlineControllers,y=v("../color"),e=v("../drawing"),n=v("../../plot_api/plot_template").arrayEditor,t=v("../shapes/helpers"),a=t.getPathString;function r(f){var l=f._fullLayout;for(var h in b(f),l._selectionLayer.selectAll("path").remove(),l._plots){var d=l._plots[h].selectionLayer;d&&d.selectAll("path").remove()}for(var s=0;s<l.selections.length;s++)o(f,s)}function m(f){return f._context.editSelection}function o(f,l){f._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+l+'"]').remove();var h=t.makeSelectionsOptionsAndPlotinfo(f,l),d=h.options,s=h.plotinfo;d._input&&function(x){var c=a(f,d),T={"data-index":l,"fill-rule":"evenodd",d:c},_=d.opacity,w="rgba(0,0,0,0)",k=d.line.color||y.contrast(f._fullLayout.plot_bgcolor),L=d.line.width,A=d.line.dash;L||(L=5,A="solid");var I=m(f)&&f._fullLayout._activeSelectionIndex===l;I&&(w=f._fullLayout.activeselection.fillcolor,_=f._fullLayout.activeselection.opacity);for(var P=[],S=1;S>=0;S--){var E=x.append("path").attr(T).style("opacity",S?.1:_).call(y.stroke,k).call(y.fill,w).call(e.dashLine,S?"solid":A,S?4+L:L);if(i(E,f,d),I){var D=n(f.layout,"selections",d);E.style({cursor:"move"});var R={element:E.node(),plotinfo:s,gd:f,editHelpers:D,isActiveSelection:!0},H=p(c,f);g(H,E,R)}else E.style("pointer-events",S?"all":"none");P[S]=E}var V=P[0];P[1].node().addEventListener("click",function(){return function(X,$){if(!!m(X)){var G=+$.node().getAttribute("data-index");if(G>=0){if(G===X._fullLayout._activeSelectionIndex)return void u(X);X._fullLayout._activeSelectionIndex=G,X._fullLayout._deactivateSelection=u,r(X)}}}(f,V)})}(f._fullLayout._selectionLayer)}function i(f,l,h){var d=h.xref+h.yref;e.setClipUrl(f,"clip"+l._fullLayout._uid+d,l)}function u(f){m(f)&&f._fullLayout._activeSelectionIndex>=0&&(b(f),delete f._fullLayout._activeSelectionIndex,r(f))}J.exports={draw:r,drawOne:o,activateLastSelection:function(f){if(!!m(f)){var l=f._fullLayout.selections.length-1;f._fullLayout._activeSelectionIndex=l,f._fullLayout._deactivateSelection=u,r(f)}}}},{"../../plot_api/plot_template":555,"../color":367,"../drawing":389,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/handle_outline":468,"../shapes/helpers":469}],451:[function(v,J,Z){var p=v("../../drawing/attributes").dash,g=v("../../../lib/extend").extendFlat;J.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:g({},p,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],452:[function(v,J,Z){J.exports=function(p,g,b){b("newselection.mode"),b("newselection.line.width")&&(b("newselection.line.color"),b("newselection.line.dash")),b("activeselection.fillcolor"),b("activeselection.opacity")}},{}],453:[function(v,J,Z){var p=v("../../dragelement/helpers").selectMode,g=v("../../shapes/handle_outline").clearOutline,b=v("../../shapes/draw_newshape/helpers"),y=b.readPaths,e=b.writePaths,n=b.fixDatesForPaths;J.exports=function(t,a){if(t.length){var r=t[0][0];if(r){var m=r.getAttribute("d"),o=a.gd,i=o._fullLayout.newselection,u=a.plotinfo,f=u.xaxis,l=u.yaxis,h=a.isActiveSelection,d=a.dragmode,s=(o.layout||{}).selections||[];if(!p(d)&&h!==void 0){var x=o._fullLayout._activeSelectionIndex;if(x<s.length)switch(o._fullLayout.selections[x].type){case"rect":d="select";break;case"path":d="lasso"}}var c,T=y(m,o,u,h),_={xref:f._id,yref:l._id,opacity:i.opacity,line:{color:i.line.color,width:i.line.width,dash:i.line.dash}};T.length===1&&(c=T[0]),c&&c.length===5&&d==="select"?(_.type="rect",_.x0=c[0][1],_.y0=c[0][2],_.x1=c[2][1],_.y1=c[2][2]):(_.type="path",f&&l&&n(T,f,l),_.path=e(T),c=null),g(o);for(var w=a.editHelpers,k=(w||{}).modifyItem,L=[],A=0;A<s.length;A++){var I=o._fullLayout.selections[A];if(I){if(L[A]=I._input,h!==void 0&&A===o._fullLayout._activeSelectionIndex){var P=_;switch(I.type){case"rect":k("x0",P.x0),k("x1",P.x1),k("y0",P.y0),k("y1",P.y1);break;case"path":k("path",P.path)}}}else L[A]=I}return h===void 0?(L.push(_),L):w?w.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../shapes/draw_newshape/helpers":466,"../../shapes/handle_outline":468}],454:[function(v,J,Z){var p=v("../../lib").strTranslate;function g(b,y){switch(b.type){case"log":return b.p2d(y);case"date":return b.p2r(y,0,b.calendar);default:return b.p2r(y)}}J.exports={p2r:g,r2p:function(b,y){switch(b.type){case"log":return b.d2p(y);case"date":return b.r2p(y,0,b.calendar);default:return b.r2p(y)}},axValue:function(b){var y=b._id.charAt(0)==="y"?1:0;return function(e){return g(b,e[y])}},getTransform:function(b){return p(b.xaxis._offset,b.yaxis._offset)}}},{"../../lib":515}],455:[function(v,J,Z){var p=v("./draw"),g=v("./select");J.exports={moduleType:"component",name:"selections",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),supplyDrawNewSelectionDefaults:v("./draw_newselection/defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("selections"),draw:p.draw,drawOne:p.drawOne,reselect:g.reselect,prepSelect:g.prepSelect,clearOutline:g.clearOutline,clearSelectionsCache:g.clearSelectionsCache,selectOnClick:g.selectOnClick}},{"../../plots/cartesian/include_components":577,"./attributes":447,"./defaults":449,"./draw":450,"./draw_newselection/defaults":452,"./select":456}],456:[function(v,J,Z){var p=v("polybooljs"),g=v("point-in-polygon/nested"),b=v("../../registry"),y=v("../drawing").dashStyle,e=v("../color"),n=v("../fx"),t=v("../fx/helpers").makeEventData,a=v("../dragelement/helpers"),r=a.freeMode,m=a.rectMode,o=a.drawMode,i=a.openMode,u=a.selectMode,f=v("../shapes/helpers"),l=v("../shapes/constants"),h=v("../shapes/display_outlines"),d=v("../shapes/handle_outline").clearOutline,s=v("../shapes/draw_newshape/helpers"),x=s.handleEllipse,c=s.readPaths,T=v("../shapes/draw_newshape/newshapes"),_=v("./draw_newselection/newselections"),w=v("./draw").activateLastSelection,k=v("../../lib"),L=k.sorterAsc,A=v("../../lib/polygon"),I=v("../../lib/throttle"),P=v("../../plots/cartesian/axis_ids").getFromId,S=v("../../lib/clear_gl_canvases"),E=v("../../plot_api/subroutines").redrawReglTraces,D=v("./constants"),R=D.MINSELECT,H=A.filter,V=A.tester,X=v("./helpers"),$=X.p2r,G=X.axValue,W=X.getTransform;function te(Oe){return Oe.subplot!==void 0}function N(Oe,Ze,Pe,Ie,Be,Fe,$e){var ot,pt,_t,yt,tt,Ke,vt,Nt,qt,er=Ze._hoverdata,Jt=Ze._fullLayout.clickmode.indexOf("event")>-1,ir=[];if(function(xe){return xe&&Array.isArray(xe)&&xe[0].hoverOnBox!==!0}(er)){j(Oe,Ze,Fe);var Ht=function(xe,De){var qe,Xe,He=xe[0],st=-1,it=[];for(Xe=0;Xe<De.length;Xe++)if(qe=De[Xe],He.fullData._expandedIndex===qe.cd[0].trace._expandedIndex){if(He.hoverOnBox===!0)break;He.pointNumber!==void 0?st=He.pointNumber:He.binNumber!==void 0&&(st=He.binNumber,it=He.pointNumbers);break}return{pointNumber:st,pointNumbers:it,searchInfo:qe}}(er,ot=re(Ze,Pe,Ie,Be));if(Ht.pointNumbers.length>0?function(xe,De){var qe,Xe,He,st=[];for(He=0;He<xe.length;He++)(qe=xe[He]).cd[0].trace.selectedpoints&&qe.cd[0].trace.selectedpoints.length>0&&st.push(qe);if(st.length===1&&st[0]===De.searchInfo&&(Xe=De.searchInfo.cd[0].trace).selectedpoints.length===De.pointNumbers.length){for(He=0;He<De.pointNumbers.length;He++)if(Xe.selectedpoints.indexOf(De.pointNumbers[He])<0)return!1;return!0}return!1}(ot,Ht):function(xe){var De,qe,Xe,He=0;for(Xe=0;Xe<xe.length;Xe++)if(De=xe[Xe],(qe=De.cd[0].trace).selectedpoints&&(qe.selectedpoints.length>1||(He+=qe.selectedpoints.length)>1))return!1;return He===1}(ot)&&(Ke=le(Ht))){for($e&&$e.remove(),qt=0;qt<ot.length;qt++)(pt=ot[qt])._module.selectPoints(pt,!1);oe(Ze,ot),Q(Fe),Jt&&Re(Ze)}else{for(vt=Oe.shiftKey&&(Ke!==void 0?Ke:le(Ht)),_t=function(xe,De,qe){return{pointNumber:xe,searchInfo:De,subtract:!!qe}}(Ht.pointNumber,Ht.searchInfo,vt),yt=ee(Fe.selectionDefs.concat([_t])),qt=0;qt<ot.length;qt++)if(tt=se(ot[qt]._module.selectPoints(ot[qt],yt),ot[qt]),ir.length)for(var Ue=0;Ue<tt.length;Ue++)ir.push(tt[Ue]);else ir=tt;if(oe(Ze,ot,Nt={points:ir}),_t&&Fe&&Fe.selectionDefs.push(_t),$e){var We=Fe.mergedPolygons,he=i(Fe.dragmode);h(me(We,he),$e,Fe)}Jt&&ze(Ze,Nt)}}}function B(Oe){return"pointNumber"in Oe&&"searchInfo"in Oe}function U(Oe){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(Ze,Pe,Ie,Be){var Fe=Oe.searchInfo.cd[0].trace._expandedIndex;return Be.cd[0].trace._expandedIndex===Fe&&Ie===Oe.pointNumber},isRect:!1,degenerate:!1,subtract:!!Oe.subtract}}function ee(Oe){if(Oe.length){for(var Ze=[],Pe=B(Oe[0])?0:Oe[0][0][0],Ie=Pe,Be=B(Oe[0])?0:Oe[0][0][1],Fe=Be,$e=0;$e<Oe.length;$e++)if(B(Oe[$e]))Ze.push(U(Oe[$e]));else{var ot=V(Oe[$e]);ot.subtract=!!Oe[$e].subtract,Ze.push(ot),Pe=Math.min(Pe,ot.xmin),Ie=Math.max(Ie,ot.xmax),Be=Math.min(Be,ot.ymin),Fe=Math.max(Fe,ot.ymax)}return{xmin:Pe,xmax:Ie,ymin:Be,ymax:Fe,pts:[],contains:function(pt,_t,yt,tt){for(var Ke=!1,vt=0;vt<Ze.length;vt++)Ze[vt].contains(pt,_t,yt,tt)&&(Ke=!Ze[vt].subtract);return Ke},isRect:!1,degenerate:!1}}}function j(Oe,Ze,Pe){var Ie=Ze._fullLayout,Be=Pe.plotinfo,Fe=Pe.dragmode,$e=Ie._lastSelectedSubplot&&Ie._lastSelectedSubplot===Be.id,ot=(Oe.shiftKey||Oe.altKey)&&!(o(Fe)&&i(Fe));$e&&ot&&Be.selection&&Be.selection.selectionDefs&&!Pe.selectionDefs?(Pe.selectionDefs=Be.selection.selectionDefs,Pe.mergedPolygons=Be.selection.mergedPolygons):ot&&Be.selection||Q(Pe),$e||(d(Ze),Ie._lastSelectedSubplot=Be.id)}function Q(Oe,Ze){var Pe=Oe.dragmode,Ie=Oe.plotinfo,Be=Oe.gd;(function(tt){return tt._fullLayout._activeShapeIndex>=0})(Be)&&Be._fullLayout._deactivateShape(Be),function(tt){return tt._fullLayout._activeSelectionIndex>=0}(Be)&&Be._fullLayout._deactivateSelection(Be);var Fe=Be._fullLayout._zoomlayer,$e=o(Pe),ot=u(Pe);if($e||ot){var pt,_t,yt=Fe.selectAll(".select-outline-"+Ie.id);yt&&Be._fullLayout._outlining&&($e&&(pt=T(yt,Oe)),pt&&b.call("_guiRelayout",Be,{shapes:pt}),ot&&!te(Oe)&&(_t=_(yt,Oe)),_t&&(Be._fullLayout._noEmitSelectedAtStart=!0,b.call("_guiRelayout",Be,{selections:_t}).then(function(){Ze&&w(Be)})),Be._fullLayout._outlining=!1)}Ie.selection={},Ie.selection.selectionDefs=Oe.selectionDefs=[],Ie.selection.mergedPolygons=Oe.mergedPolygons=[]}function K(Oe){return Oe._id}function re(Oe,Ze,Pe,Ie){if(!Oe.calcdata)return[];var Be,Fe,$e,ot=[],pt=Ze.map(K),_t=Pe.map(K);for($e=0;$e<Oe.calcdata.length;$e++)if((Fe=(Be=Oe.calcdata[$e])[0].trace).visible===!0&&Fe._module&&Fe._module.selectPoints)if(!te({subplot:Ie})||Fe.subplot!==Ie&&Fe.geo!==Ie)if(Fe.type==="splom"){if(Fe._xaxes[pt[0]]&&Fe._yaxes[_t[0]]){var yt=ne(Fe._module,Be,Ze[0],Pe[0]);yt.scene=Oe._fullLayout._splomScenes[Fe.uid],ot.push(yt)}}else if(Fe.type==="sankey"){var tt=ne(Fe._module,Be,Ze[0],Pe[0]);ot.push(tt)}else{if(pt.indexOf(Fe.xaxis)===-1||_t.indexOf(Fe.yaxis)===-1)continue;ot.push(ne(Fe._module,Be,P(Oe,Fe.xaxis),P(Oe,Fe.yaxis)))}else ot.push(ne(Fe._module,Be,Ze[0],Pe[0]));return ot}function ne(Oe,Ze,Pe,Ie){return{_module:Oe,cd:Ze,xaxis:Pe,yaxis:Ie}}function le(Oe){var Ze=Oe.searchInfo.cd[0].trace,Pe=Oe.pointNumber,Ie=Oe.pointNumbers,Be=Ie.length>0?Ie[0]:Pe;return!!Ze.selectedpoints&&Ze.selectedpoints.indexOf(Be)>-1}function oe(Oe,Ze,Pe){var Ie,Be;for(Ie=0;Ie<Ze.length;Ie++){var Fe=Ze[Ie].cd[0].trace._fullInput,$e=Oe._fullLayout._tracePreGUI[Fe.uid]||{};$e.selectedpoints===void 0&&($e.selectedpoints=Fe._input.selectedpoints||null)}if(Pe){var ot=Pe.points||[];for(Ie=0;Ie<Ze.length;Ie++)(Be=Ze[Ie].cd[0].trace)._input.selectedpoints=Be._fullInput.selectedpoints=[],Be._fullInput!==Be&&(Be.selectedpoints=[]);for(var pt=0;pt<ot.length;pt++){var _t=ot[pt],yt=_t.data,tt=_t.fullData,Ke=_t.pointIndex,vt=_t.pointIndices;vt?([].push.apply(yt.selectedpoints,vt),Be._fullInput!==Be&&[].push.apply(tt.selectedpoints,vt)):(yt.selectedpoints.push(Ke),Be._fullInput!==Be&&tt.selectedpoints.push(Ke))}}else for(Ie=0;Ie<Ze.length;Ie++)delete(Be=Ze[Ie].cd[0].trace).selectedpoints,delete Be._input.selectedpoints,Be._fullInput!==Be&&delete Be._fullInput.selectedpoints;(function(Nt,qt){for(var er=!1,Jt=0;Jt<qt.length;Jt++){var ir=qt[Jt],Ht=ir.cd;b.traceIs(Ht[0].trace,"regl")&&(er=!0);var Ue=ir._module,We=Ue.styleOnSelect||Ue.style;We&&(We(Nt,Ht,Ht[0].node3),Ht[0].nodeRangePlot3&&We(Nt,Ht,Ht[0].nodeRangePlot3))}er&&(S(Nt),E(Nt))})(Oe,Ze)}function de(Oe,Ze,Pe){for(var Ie=(Pe?p.difference:p.union)({regions:Oe},{regions:[Ze]}).regions.reverse(),Be=0;Be<Ie.length;Be++){var Fe=Ie[Be];Fe.subtract=ve(Fe,Ie.slice(0,Be))}return Ie}function se(Oe,Ze){if(Array.isArray(Oe))for(var Pe=Ze.cd,Ie=Ze.cd[0].trace,Be=0;Be<Oe.length;Be++)Oe[Be]=t(Oe[Be],Ie,Pe);return Oe}function me(Oe,Ze){for(var Pe=[],Ie=0;Ie<Oe.length;Ie++){Pe[Ie]=[];for(var Be=0;Be<Oe[Ie].length;Be++){Pe[Ie][Be]=[],Pe[Ie][Be][0]=Be?"L":"M";for(var Fe=0;Fe<Oe[Ie][Be].length;Fe++)Pe[Ie][Be].push(Oe[Ie][Be][Fe])}Ze||Pe[Ie].push(["Z",Pe[Ie][0][1],Pe[Ie][0][2]])}return Pe}function Te(Oe,Ze){for(var Pe,Ie,Be=[],Fe=[],$e=0;$e<Ze.length;$e++){var ot=Ze[$e];Ie=ot._module.selectPoints(ot,Oe),Fe.push(Ie),Pe=se(Ie,ot),Be=Be.concat(Pe)}return Be}function _e(Oe,Ze,Pe,Ie,Be){var Fe,$e,ot,pt=!!Ie;Be&&(Fe=Be.plotinfo,$e=Be.xaxes[0]._id,ot=Be.yaxes[0]._id);var _t=[],yt=[],tt=fe(Oe),Ke=Oe._fullLayout;if(Fe){var vt=Ke._zoomlayer,Nt=Ke.dragmode,qt=o(Nt),er=u(Nt);if(qt||er){var Jt=P(Oe,$e,"x"),ir=P(Oe,ot,"y");if(Jt&&ir){var Ht=vt.selectAll(".select-outline-"+Fe.id);if(Ht&&Oe._fullLayout._outlining&&Ht.length){for(var Ue=Ht[0][0].getAttribute("d"),We=c(Ue,Oe,Fe),he=[],xe=0;xe<We.length;xe++){for(var De=We[xe],qe=[],Xe=0;Xe<De.length;Xe++)qe.push([Me(Jt,De[Xe][1]),Me(ir,De[Xe][2])]);qe.xref=$e,qe.yref=ot,qe.subtract=ve(qe,he),he.push(qe)}tt=tt.concat(he)}}}}var He=$e&&ot?[$e+ot]:Ke._subplots.cartesian;(function(Nr){var Ur=Nr.calcdata;if(!!Ur)for(var Jr=0;Jr<Ur.length;Jr++){var mn=Ur[Jr][0].trace,en=Nr._fullLayout._splomScenes;if(en){var In=en[mn.uid];In&&(In.selectBatch=[])}}})(Oe);for(var st={},it=0;it<He.length;it++){var Tt=He[it],Pt=Tt.indexOf("y"),rt=Tt.slice(0,Pt),ut=Tt.slice(Pt),Ft=$e&&ot?Pe:void 0;if(Ft=Ce(tt,rt,ut,Ft)){var wt=Ie;if(!pt){var Lt=P(Oe,rt,"x"),Ae=P(Oe,ut,"y");wt=re(Oe,[Lt],[Ae],Tt);for(var Ye=0;Ye<wt.length;Ye++){var nt=wt[Ye],ft=nt.cd[0],Mt=ft.trace;if(nt._module.name==="scattergl"&&!ft.t.xpx){var Rt=Mt.x,Gt=Mt.y,jt=Mt._length;ft.t.xpx=[],ft.t.ypx=[];for(var pr=0;pr<jt;pr++)ft.t.xpx[pr]=Lt.c2p(Rt[pr]),ft.t.ypx[pr]=Ae.c2p(Gt[pr])}nt._module.name==="splom"&&(st[Mt.uid]||(st[Mt.uid]=!0))}}var Ar=Te(Ft,wt);_t=_t.concat(Ar),yt=yt.concat(wt)}}var fr={points:_t};oe(Oe,yt,fr);var Zt=Ke.clickmode.indexOf("event")>-1&&Ze;if(!Fe&&Ze){var Qt=fe(Oe,!0);if(Qt.length){var $t=Qt[0].xref,hr=Qt[0].yref;if($t&&hr){var vr=ke(Qt);Le([P(Oe,$t,"x"),P(Oe,hr,"y")])(fr,vr)}}Oe._fullLayout._noEmitSelectedAtStart?Oe._fullLayout._noEmitSelectedAtStart=!1:Zt&&ze(Oe,fr),Ke._reselect=!1}if(!Fe&&Ke._deselect){var Mr=Ke._deselect;(function(Nr,Ur,Jr){for(var mn=0;mn<Jr.length;mn++){var en=Jr[mn];if(en.xaxis&&en.xaxis._id===Nr&&en.yaxis&&en.yaxis._id===Ur)return!0}return!1})($e=Mr.xref,ot=Mr.yref,yt)||be(Oe,$e,ot,Ie),Zt&&(fr.points.length?ze(Oe,fr):Re(Oe)),Ke._deselect=!1}return{eventData:fr,selectionTesters:Pe}}function be(Oe,Ze,Pe,Ie){Ie=re(Oe,[P(Oe,Ze,"x")],[P(Oe,Pe,"y")],Ze+Pe);for(var Be=0;Be<Ie.length;Be++){var Fe=Ie[Be];Fe._module.selectPoints(Fe,!1)}oe(Oe,Ie)}function Ce(Oe,Ze,Pe,Ie){for(var Be,Fe=0;Fe<Oe.length;Fe++){var $e=Oe[Fe];Ze===$e.xref&&Pe===$e.yref&&(Be?Ie=ee(Be=de(Be,$e,!!$e.subtract)):(Be=[$e],Ie=V($e)))}return Ie}function fe(Oe,Ze){for(var Pe=[],Ie=Oe._fullLayout,Be=Ie.selections,Fe=Be.length,$e=0;$e<Fe;$e++)if(!Ze||$e===Ie._activeSelectionIndex){var ot=Be[$e];if(ot){var pt,_t,yt,tt,Ke,vt=ot.xref,Nt=ot.yref,qt=P(Oe,vt,"x"),er=P(Oe,Nt,"y");if(ot.type==="rect"){Ke=[];var Jt=Me(qt,ot.x0),ir=Me(qt,ot.x1),Ht=Me(er,ot.y0),Ue=Me(er,ot.y1);Ke=[[Jt,Ht],[Jt,Ue],[ir,Ue],[ir,Ht]],pt=Math.min(Jt,ir),_t=Math.max(Jt,ir),yt=Math.min(Ht,Ue),tt=Math.max(Ht,Ue),Ke.xmin=pt,Ke.xmax=_t,Ke.ymin=yt,Ke.ymax=tt,Ke.xref=vt,Ke.yref=Nt,Ke.subtract=!1,Ke.isRect=!0,Pe.push(Ke)}else if(ot.type==="path")for(var We=ot.path.split("Z"),he=[],xe=0;xe<We.length;xe++){var De=We[xe];if(De){De+="Z";var qe=f.extractPathCoords(De,l.paramIsX,"raw"),Xe=f.extractPathCoords(De,l.paramIsY,"raw");pt=1/0,_t=-1/0,yt=1/0,tt=-1/0,Ke=[];for(var He=0;He<qe.length;He++){var st=Me(qt,qe[He]),it=Me(er,Xe[He]);Ke.push([st,it]),pt=Math.min(st,pt),_t=Math.max(st,_t),yt=Math.min(it,yt),tt=Math.max(it,tt)}Ke.xmin=pt,Ke.xmax=_t,Ke.ymin=yt,Ke.ymax=tt,Ke.xref=vt,Ke.yref=Nt,Ke.subtract=ve(Ke,he),he.push(Ke),Pe.push(Ke)}}}}return Pe}function ve(Oe,Ze){for(var Pe=!1,Ie=0;Ie<Ze.length;Ie++)for(var Be=Ze[Ie],Fe=0;Fe<Oe.length;Fe++)if(g(Oe[Fe],Be)){Pe=!Pe;break}return Pe}function Me(Oe,Ze){return Oe.type==="date"&&(Ze=Ze.replace("_"," ")),Oe.type==="log"?Oe.c2p(Ze):Oe.r2p(Ze,null,Oe.calendar)}function ke(Oe){for(var Ze=Oe.length,Pe=[],Ie=0;Ie<Ze;Ie++){var Be=Oe[Ie];Pe=(Pe=Pe.concat(Be)).concat([Be[0]])}return function(Fe){return Fe.isRect=Fe.length===5&&Fe[0][0]===Fe[4][0]&&Fe[0][1]===Fe[4][1]&&Fe[0][0]===Fe[1][0]&&Fe[2][0]===Fe[3][0]&&Fe[0][1]===Fe[3][1]&&Fe[1][1]===Fe[2][1]||Fe[0][1]===Fe[1][1]&&Fe[2][1]===Fe[3][1]&&Fe[0][0]===Fe[3][0]&&Fe[1][0]===Fe[2][0],Fe.isRect&&(Fe.xmin=Math.min(Fe[0][0],Fe[2][0]),Fe.xmax=Math.max(Fe[0][0],Fe[2][0]),Fe.ymin=Math.min(Fe[0][1],Fe[2][1]),Fe.ymax=Math.max(Fe[0][1],Fe[2][1])),Fe}(Pe)}function Le(Oe){return function(Ze,Pe){for(var Ie,Be,Fe=0;Fe<Oe.length;Fe++){var $e=Oe[Fe],ot=$e._id,pt=ot.charAt(0);if(Pe.isRect){Ie||(Ie={});var _t=Pe[pt+"min"],yt=Pe[pt+"max"];_t!==void 0&&yt!==void 0&&(Ie[ot]=[$($e,_t),$($e,yt)].sort(L))}else Be||(Be={}),Be[ot]=Pe.map(G($e))}Ie&&(Ze.range=Ie),Be&&(Ze.lassoPoints=Be)}}function ze(Oe,Ze){Ze&&(Ze.selections=(Oe.layout||{}).selections||[]),Oe.emit("plotly_selected",Ze)}function Re(Oe){Oe.emit("plotly_deselect",null)}J.exports={reselect:_e,prepSelect:function(Oe,Ze,Pe,Ie,Be){var Fe=!te(Ie),$e=r(Be),ot=m(Be),pt=i(Be),_t=o(Be),yt=u(Be),tt=Be==="drawcircle",Ke=Be==="drawline"||tt,vt=Ie.gd,Nt=vt._fullLayout,qt=yt&&Nt.newselection.mode==="immediate"&&Fe,er=Nt._zoomlayer,Jt=Ie.element.getBoundingClientRect(),ir=Ie.plotinfo,Ht=W(ir),Ue=Ze-Jt.left,We=Pe-Jt.top;Nt._calcInverseTransform(vt);var he=k.apply3DTransform(Nt._invTransform)(Ue,We);Ue=he[0],We=he[1];var xe,De,qe,Xe,He,st,it,Tt=Nt._invScaleX,Pt=Nt._invScaleY,rt=Ue,ut=We,Ft="M"+Ue+","+We,wt=Ie.xaxes[0],Lt=Ie.yaxes[0],Ae=wt._length,Ye=Lt._length,nt=Oe.altKey&&!(o(Be)&&pt);j(Oe,vt,Ie),$e&&(xe=H([[Ue,We]],D.BENDPX));var ft=er.selectAll("path.select-outline-"+ir.id).data([1]),Mt=_t?Nt.newshape:Nt.newselection;ft.enter().append("path").attr("class","select-outline select-outline-"+ir.id).style({opacity:_t?Mt.opacity/2:1,fill:_t&&!pt?Mt.fillcolor:"none",stroke:Mt.line.color||(Fe?e.contrast(vt._fullLayout.plot_bgcolor):"#7f7f7f"),"stroke-dasharray":y(Mt.line.dash,Mt.line.width),"stroke-width":Mt.line.width+"px","shape-rendering":"crispEdges"}).attr("fill-rule","evenodd").classed("cursor-move",!!_t).attr("transform",Ht).attr("d",Ft+"Z");var Rt=er.append("path").attr("class","zoombox-corners").style({fill:e.background,stroke:e.defaultLine,"stroke-width":1}).attr("transform",Ht).attr("d","M0,0Z"),Gt=Nt._uid+D.SELECTID,jt=[],pr=re(vt,Ie.xaxes,Ie.yaxes,Ie.subplot);qt&&!Oe.shiftKey&&(Ie._clearSubplotSelections=function(){if(Fe){var fr=wt._id,Zt=Lt._id;be(vt,fr,Zt,pr);for(var Qt=(vt.layout||{}).selections||[],$t=[],hr=!1,vr=0;vr<Qt.length;vr++){var Mr=Nt.selections[vr];Mr.xref!==fr||Mr.yref!==Zt?$t.push(Qt[vr]):hr=!0}hr&&(vt._fullLayout._noEmitSelectedAtStart=!0,b.call("_guiRelayout",vt,{selections:$t}))}});var Ar=function(fr){return fr.plotinfo.fillRangeItems||Le(fr.xaxes.concat(fr.yaxes))}(Ie);Ie.moveFn=function(fr,Zt){Ie._clearSubplotSelections&&(Ie._clearSubplotSelections(),Ie._clearSubplotSelections=void 0),rt=Math.max(0,Math.min(Ae,Tt*fr+Ue)),ut=Math.max(0,Math.min(Ye,Pt*Zt+We));var Qt=Math.abs(rt-Ue),$t=Math.abs(ut-We);if(ot){var hr,vr,Mr;if(yt){var Nr=Nt.selectdirection;switch(hr=Nr==="any"?$t<Math.min(.6*Qt,R)?"h":Qt<Math.min(.6*$t,R)?"v":"d":Nr){case"h":vr=tt?Ye/2:0,Mr=Ye;break;case"v":vr=tt?Ae/2:0,Mr=Ae}}if(_t)switch(Nt.newshape.drawdirection){case"vertical":hr="h",vr=tt?Ye/2:0,Mr=Ye;break;case"horizontal":hr="v",vr=tt?Ae/2:0,Mr=Ae;break;case"ortho":Qt<$t?(hr="h",vr=We,Mr=ut):(hr="v",vr=Ue,Mr=rt);break;default:hr="d"}hr==="h"?((Xe=Ke?x(tt,[rt,vr],[rt,Mr]):[[Ue,vr],[Ue,Mr],[rt,Mr],[rt,vr]]).xmin=Ke?rt:Math.min(Ue,rt),Xe.xmax=Ke?rt:Math.max(Ue,rt),Xe.ymin=Math.min(vr,Mr),Xe.ymax=Math.max(vr,Mr),Rt.attr("d","M"+Xe.xmin+","+(We-R)+"h-4v"+2*R+"h4ZM"+(Xe.xmax-1)+","+(We-R)+"h4v"+2*R+"h-4Z")):hr==="v"?((Xe=Ke?x(tt,[vr,ut],[Mr,ut]):[[vr,We],[vr,ut],[Mr,ut],[Mr,We]]).xmin=Math.min(vr,Mr),Xe.xmax=Math.max(vr,Mr),Xe.ymin=Ke?ut:Math.min(We,ut),Xe.ymax=Ke?ut:Math.max(We,ut),Rt.attr("d","M"+(Ue-R)+","+Xe.ymin+"v-4h"+2*R+"v4ZM"+(Ue-R)+","+(Xe.ymax-1)+"v4h"+2*R+"v-4Z")):hr==="d"&&((Xe=Ke?x(tt,[Ue,We],[rt,ut]):[[Ue,We],[Ue,ut],[rt,ut],[rt,We]]).xmin=Math.min(Ue,rt),Xe.xmax=Math.max(Ue,rt),Xe.ymin=Math.min(We,ut),Xe.ymax=Math.max(We,ut),Rt.attr("d","M0,0Z"))}else $e&&(xe.addPt([rt,ut]),Xe=xe.filtered);if(Ie.selectionDefs&&Ie.selectionDefs.length?(qe=de(Ie.mergedPolygons,Xe,nt),Xe.subtract=nt,De=ee(Ie.selectionDefs.concat([Xe]))):(qe=[Xe],De=V(Xe)),h(me(qe,pt),ft,Ie),yt){var Ur,Jr=_e(vt,!1),mn=Jr.eventData?Jr.eventData.points.slice():[];Jr=_e(vt,!1,De,pr,Ie),De=Jr.selectionTesters,it=Jr.eventData,Ur=xe?xe.filtered:ke(qe),I.throttle(Gt,D.SELECTDELAY,function(){for(var en=(jt=Te(De,pr)).slice(),In=0;In<mn.length;In++){for(var vn=mn[In],gn=!1,Sn=0;Sn<en.length;Sn++)if(en[Sn].curveNumber===vn.curveNumber&&en[Sn].pointNumber===vn.pointNumber){gn=!0;break}gn||en.push(vn)}en.length&&(it||(it={}),it.points=en),Ar(it,Ur),function(Xn,Br){Xn.emit("plotly_selecting",Br)}(vt,it)})}},Ie.clickFn=function(fr,Zt){if(Rt.remove(),vt._fullLayout._activeShapeIndex>=0)vt._fullLayout._deactivateShape(vt);else if(!_t){var Qt=Nt.clickmode;I.done(Gt).then(function(){if(I.clear(Gt),fr===2){for(ft.remove(),He=0;He<pr.length;He++)(st=pr[He])._module.selectPoints(st,!1);if(oe(vt,pr),Q(Ie),Re(vt),pr.length){var $t=pr[0].xaxis,hr=pr[0].yaxis;if($t&&hr){for(var vr=[],Mr=vt._fullLayout.selections,Nr=0;Nr<Mr.length;Nr++){var Ur=Mr[Nr];Ur&&(Ur.xref===$t._id&&Ur.yref===hr._id||vr.push(Ur))}vr.length<Mr.length&&(vt._fullLayout._noEmitSelectedAtStart=!0,b.call("_guiRelayout",vt,{selections:vr}))}}}else Qt.indexOf("select")>-1&&N(Zt,vt,Ie.xaxes,Ie.yaxes,Ie.subplot,Ie,ft),Qt==="event"&&ze(vt,void 0);n.click(vt,Zt)}).catch(k.error)}},Ie.doneFn=function(){Rt.remove(),I.done(Gt).then(function(){I.clear(Gt),!qt&&Xe&&Ie.selectionDefs&&(Xe.subtract=nt,Ie.selectionDefs.push(Xe),Ie.mergedPolygons.length=0,[].push.apply(Ie.mergedPolygons,qe)),(qt||_t)&&Q(Ie,qt),Ie.doneFnCompleted&&Ie.doneFnCompleted(jt),yt&&ze(vt,it)}).catch(k.error)}},clearOutline:d,clearSelectionsCache:Q,selectOnClick:N}},{"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/polygon":527,"../../lib/throttle":542,"../../plot_api/subroutines":556,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../color":367,"../dragelement/helpers":385,"../drawing":389,"../fx":407,"../fx/helpers":403,"../shapes/constants":459,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/draw_newshape/newshapes":467,"../shapes/handle_outline":468,"../shapes/helpers":469,"./constants":448,"./draw":450,"./draw_newselection/newselections":453,"./helpers":454,"point-in-polygon/nested":254,polybooljs:255}],457:[function(v,J,Z){var p=v("../annotations/attributes"),g=v("../../traces/scatter/attributes").line,b=v("../drawing/attributes").dash,y=v("../../lib/extend").extendFlat,e=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),J.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:y({},p.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:y({},p.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:y({},g.color,{editType:"arraydraw"}),width:y({},g.width,{editType:"calc+arraydraw"}),dash:y({},b,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],458:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes"),b=v("./constants"),y=v("./helpers");function e(r){return t(r.line.width,r.xsizemode,r.x0,r.x1,r.path,!1)}function n(r){return t(r.line.width,r.ysizemode,r.y0,r.y1,r.path,!0)}function t(r,m,o,i,u,f){var l=r/2,h=f;if(m==="pixel"){var d=u?y.extractPathCoords(u,f?b.paramIsY:b.paramIsX):[o,i],s=p.aggNums(Math.max,null,d),x=p.aggNums(Math.min,null,d),c=x<0?Math.abs(x)+l:l,T=s>0?s+l:l;return{ppad:l,ppadplus:h?c:T,ppadminus:h?T:c}}return{ppad:l}}function a(r,m,o,i,u){var f=r.type==="category"||r.type==="multicategory"?r.r2c:r.d2c;if(m!==void 0)return[f(m),f(o)];if(i){var l,h,d,s,x=1/0,c=-1/0,T=i.match(b.segmentRE);for(r.type==="date"&&(f=y.decodeDate(f)),l=0;l<T.length;l++)(h=u[T[l].charAt(0)].drawn)!==void 0&&(!(d=T[l].substr(1).match(b.paramRE))||d.length<h||((s=f(d[h]))<x&&(x=s),s>c&&(c=s)));return c>=x?[x,c]:void 0}}J.exports=function(r){var m=r._fullLayout,o=p.filterVisible(m.shapes);if(o.length&&r._fullData.length)for(var i=0;i<o.length;i++){var u,f,l=o[i];l._extremes={};var h=g.getRefType(l.xref),d=g.getRefType(l.yref);if(l.xref!=="paper"&&h!=="domain"){var s=l.xsizemode==="pixel"?l.xanchor:l.x0,x=l.xsizemode==="pixel"?l.xanchor:l.x1;(f=a(u=g.getFromId(r,l.xref),s,x,l.path,b.paramIsX))&&(l._extremes[u._id]=g.findExtremes(u,f,e(l)))}if(l.yref!=="paper"&&d!=="domain"){var c=l.ysizemode==="pixel"?l.yanchor:l.y0,T=l.ysizemode==="pixel"?l.yanchor:l.y1;(f=a(u=g.getFromId(r,l.yref),c,T,l.path,b.paramIsY))&&(l._extremes[u._id]=g.findExtremes(u,f,n(l)))}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459,"./helpers":469}],459:[function(v,J,Z){J.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],460:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes"),b=v("../../plots/array_container_defaults"),y=v("./attributes"),e=v("./helpers");function n(t,a,r){function m(E,D){return p.coerce(t,a,y,E,D)}if(m("visible")){var o=m("path"),i=m("type",o?"path":"rect")!=="path";i&&delete a.path,m("editable"),m("layer"),m("opacity"),m("fillcolor"),m("fillrule"),m("line.width")&&(m("line.color"),m("line.dash"));for(var u=m("xsizemode"),f=m("ysizemode"),l=["x","y"],h=0;h<2;h++){var d,s,x,c=l[h],T=c+"anchor",_=c==="x"?u:f,w={_fullLayout:r},k=g.coerceRef(t,a,w,c,void 0,"paper");if(g.getRefType(k)==="range"?((d=g.getFromId(w,k))._shapeIndices.push(a._index),x=e.rangeToShapePosition(d),s=e.shapePositionToRange(d)):s=x=p.identity,i){var L=c+"0",A=c+"1",I=t[L],P=t[A];t[L]=s(t[L],!0),t[A]=s(t[A],!0),_==="pixel"?(m(L,0),m(A,10)):(g.coercePosition(a,w,m,k,L,.25),g.coercePosition(a,w,m,k,A,.75)),a[L]=x(a[L]),a[A]=x(a[A]),t[L]=I,t[A]=P}if(_==="pixel"){var S=t[T];t[T]=s(t[T],!0),g.coercePosition(a,w,m,k,T,.25),a[T]=x(a[T]),t[T]=S}}i&&p.noneOrAll(t,a,["x0","x1","y0","y1"])}}J.exports=function(t,a){b(t,a,{name:"shapes",handleItemDefaults:n})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":457,"./helpers":469}],461:[function(v,J,Z){var p=v("../../lib").strTranslate,g=v("../dragelement"),b=v("../dragelement/helpers"),y=b.drawMode,e=b.selectMode,n=v("../../registry"),t=v("../color"),a=v("./draw_newshape/constants"),r=a.i000,m=a.i090,o=a.i180,i=a.i270,u=v("./handle_outline").clearOutlineControllers,f=v("./draw_newshape/helpers"),l=f.pointsOnRectangle,h=f.pointsOnEllipse,d=f.writePaths,s=v("./draw_newshape/newshapes"),x=v("../selections/draw_newselection/newselections");function c(T,_){var w,k,L,A=T[_][1],I=T[_][2],P=T.length;return k=T[w=(_+1)%P][1],L=T[w][2],k===A&&L===I&&(k=T[w=(_+2)%P][1],L=T[w][2]),[w,k,L]}J.exports=function T(_,w,k,L){L||(L=0);var A=k.gd;function I(){T(_,w,k,L++),h(_[0])&&P({redrawing:!0})}function P(K){var re={};k.isActiveShape!==void 0&&(k.isActiveShape=!1,re=s(w,k)),k.isActiveSelection!==void 0&&(k.isActiveSelection=!1,re=x(w,k),A._fullLayout._reselect=!0),Object.keys(re).length&&n.call((K||{}).redrawing?"relayout":"_guiRelayout",A,re)}var S,E,D,R,H,V=A._fullLayout._zoomlayer,X=k.dragmode,$=y(X),G=e(X);($||G)&&(A._fullLayout._outlining=!0),u(A),w.attr("d",d(_)),L||!k.isActiveShape&&!k.isActiveSelection||(H=function(K,re){for(var ne=0;ne<re.length;ne++){var le=re[ne];K[ne]=[];for(var oe=0;oe<le.length;oe++){K[ne][oe]=[];for(var de=0;de<le[oe].length;de++)K[ne][oe][de]=le[oe][de]}}return K}([],_),function(K){S=[];for(var re=0;re<_.length;re++){var ne=_[re],le=l(ne),oe=!le&&h(ne);S[re]=[];for(var de=ne.length,se=0;se<de;se++)if(ne[se][0]!=="Z"&&(!oe||se===r||se===m||se===o||se===i)){var me,Te=le&&k.isActiveSelection;Te&&(me=c(ne,se));var _e=ne[se][1],be=ne[se][2],Ce=K.append(Te?"rect":"circle").attr("data-i",re).attr("data-j",se).style({fill:t.background,stroke:t.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(Te){var fe=me[1]-_e,ve=me[2]-be,Me=ve?5:Math.max(Math.min(25,Math.abs(fe)-5),5),ke=fe?5:Math.max(Math.min(25,Math.abs(ve)-5),5);Ce.classed(ve?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",Me).attr("height",ke).attr("x",_e-Me/2).attr("y",be-ke/2).attr("transform",p(fe/2,ve/2))}else Ce.classed("cursor-grab",!0).attr("r",5).attr("cx",_e).attr("cy",be);S[re][se]={element:Ce.node(),gd:A,prepFn:W,doneFn:N,clickFn:B},g.init(S[re][se])}}}(V.append("g").attr("class","outline-controllers")),function(){E=[],_.length&&(E[0]={element:w[0][0],gd:A,prepFn:ee,doneFn:j,clickFn:Q},g.init(E[0]))}());function W(K){D=+K.srcElement.getAttribute("data-i"),R=+K.srcElement.getAttribute("data-j"),S[D][R].moveFn=te}function te(K,re){if(_.length){var ne=H[D][R][1],le=H[D][R][2],oe=_[D],de=oe.length;if(l(oe)){var se=K,me=re;k.isActiveSelection&&(c(oe,R)[1]===oe[R][1]?me=0:se=0);for(var Te=0;Te<de;Te++)if(Te!==R){var _e=oe[Te];_e[1]===oe[R][1]&&(_e[1]=ne+se),_e[2]===oe[R][2]&&(_e[2]=le+me)}if(oe[R][1]=ne+se,oe[R][2]=le+me,!l(oe))for(var be=0;be<de;be++)for(var Ce=0;Ce<oe[be].length;Ce++)oe[be][Ce]=H[D][be][Ce]}else oe[R][1]=ne+K,oe[R][2]=le+re;I()}}function N(){P()}function B(K,re){if(K===2){D=+re.srcElement.getAttribute("data-i"),R=+re.srcElement.getAttribute("data-j");var ne=_[D];l(ne)||h(ne)||function(){if(_.length&&_[D]&&_[D].length){for(var le=[],oe=0;oe<_[D].length;oe++)oe!==R&&le.push(_[D][oe]);le.length>1&&(le.length!==2||le[1][0]!=="Z")&&(R===0&&(le[0][0]="M"),_[D]=le,I(),P())}}()}}function U(K,re){(function(ne,le){if(_.length)for(var oe=0;oe<_.length;oe++)for(var de=0;de<_[oe].length;de++)for(var se=0;se+2<_[oe][de].length;se+=2)_[oe][de][se+1]=H[oe][de][se+1]+ne,_[oe][de][se+2]=H[oe][de][se+2]+le})(K,re),I()}function ee(K){(D=+K.srcElement.getAttribute("data-i"))||(D=0),E[D].moveFn=U}function j(){P()}function Q(K){K===2&&function(re){if(!!e(re._fullLayout.dragmode)){u(re);var ne=re._fullLayout._activeSelectionIndex,le=(re.layout||{}).selections||[];if(ne<le.length){for(var oe=[],de=0;de<le.length;de++)de!==ne&&oe.push(le[de]);delete re._fullLayout._activeSelectionIndex;var se=re._fullLayout.selections[ne];re._fullLayout._deselect={xref:se.xref,yref:se.yref},n.call("_guiRelayout",re,{selections:oe})}}}(A)}}},{"../../lib":515,"../../registry":647,"../color":367,"../dragelement":386,"../dragelement/helpers":385,"../selections/draw_newselection/newselections":453,"./draw_newshape/constants":464,"./draw_newshape/helpers":466,"./draw_newshape/newshapes":467,"./handle_outline":468}],462:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib"),b=v("../../plots/cartesian/axes"),y=v("./draw_newshape/helpers").readPaths,e=v("./display_outlines"),n=v("./handle_outline").clearOutlineControllers,t=v("../color"),a=v("../drawing"),r=v("../../plot_api/plot_template").arrayEditor,m=v("../dragelement"),o=v("../../lib/setcursor"),i=v("./constants"),u=v("./helpers"),f=u.getPathString;function l(_){var w=_._fullLayout;for(var k in w._shapeUpperLayer.selectAll("path").remove(),w._shapeLowerLayer.selectAll("path").remove(),w._plots){var L=w._plots[k].shapelayer;L&&L.selectAll("path").remove()}for(var A=0;A<w.shapes.length;A++)w.shapes[A].visible&&s(_,A)}function h(_){return!!_._fullLayout._outlining}function d(_){return!_._context.edits.shapePosition}function s(_,w){_._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+w+'"]').remove();var k=u.makeShapesOptionsAndPlotinfo(_,w),L=k.options,A=k.plotinfo;L._input&&L.visible!==!1&&(L.layer!=="below"?I(_._fullLayout._shapeUpperLayer):L.xref==="paper"||L.yref==="paper"?I(_._fullLayout._shapeLowerLayer):A._hadPlotinfo?I((A.mainplotinfo||A).shapelayer):I(_._fullLayout._shapeLowerLayer));function I(P){var S=f(_,L),E={"data-index":w,"fill-rule":L.fillrule,d:S},D=L.opacity,R=L.fillcolor,H=L.line.width?L.line.color:"rgba(0,0,0,0)",V=L.line.width,X=L.line.dash;V||L.editable!==!0||(V=5,X="solid");var $=S[S.length-1]!=="Z",G=d(_)&&L.editable&&_._fullLayout._activeShapeIndex===w;G&&(R=$?"rgba(0,0,0,0)":_._fullLayout.activeshape.fillcolor,D=_._fullLayout.activeshape.opacity);var W,te=P.append("path").attr(E).style("opacity",D).call(t.stroke,H).call(t.fill,R).call(a.dashLine,X,V);if(x(te,_,L),(G||_._context.edits.shapePosition)&&(W=r(_.layout,"shapes",L)),G){te.style({cursor:"move"});var N={element:te.node(),plotinfo:A,gd:_,editHelpers:W,isActiveShape:!0},B=y(S,_);e(B,te,N)}else _._context.edits.shapePosition?function(U,ee,j,Q,K,re){var ne,le,oe,de,se,me,Te,_e,be,Ce,fe,ve,Me,ke,Le,ze,Re=j.xsizemode==="pixel",Oe=j.ysizemode==="pixel",Ze=j.type==="line",Pe=j.type==="path",Ie=re.modifyItem,Be=b.getFromId(U,j.xref),Fe=b.getRefType(j.xref),$e=b.getFromId(U,j.yref),ot=b.getRefType(j.yref),pt=u.getDataToPixel(U,Be,!1,Fe),_t=u.getDataToPixel(U,$e,!0,ot),yt=u.getPixelToData(U,Be,!1,Fe),tt=u.getPixelToData(U,$e,!0,ot),Ke=Ze?function(){var Ht=Math.max(j.line.width,10),Ue=K.append("g").attr("data-index",Q);Ue.append("path").attr("d",ee.attr("d")).style({cursor:"move","stroke-width":Ht,"stroke-opacity":"0"});var We={"fill-opacity":"0"},he=Math.max(Ht/2,10);return Ue.append("circle").attr({"data-line-point":"start-point",cx:Re?pt(j.xanchor)+j.x0:pt(j.x0),cy:Oe?_t(j.yanchor)-j.y0:_t(j.y0),r:he}).style(We).classed("cursor-grab",!0),Ue.append("circle").attr({"data-line-point":"end-point",cx:Re?pt(j.xanchor)+j.x1:pt(j.x1),cy:Oe?_t(j.yanchor)-j.y1:_t(j.y1),r:he}).style(We).classed("cursor-grab",!0),Ue}():ee,vt={element:Ke.node(),gd:U,prepFn:function(Ht){h(U)||(Re&&(se=pt(j.xanchor)),Oe&&(me=_t(j.yanchor)),j.type==="path"?Le=j.path:(ne=Re?j.x0:pt(j.x0),le=Oe?j.y0:_t(j.y0),oe=Re?j.x1:pt(j.x1),de=Oe?j.y1:_t(j.y1)),ne<oe?(be=ne,Me="x0",Ce=oe,ke="x1"):(be=oe,Me="x1",Ce=ne,ke="x0"),!Oe&&le<de||Oe&&le>de?(Te=le,fe="y0",_e=de,ve="y1"):(Te=de,fe="y1",_e=le,ve="y0"),Nt(Ht),Jt(K,j),function(Ue,We,he){var xe=We.xref,De=We.yref,qe=b.getFromId(he,xe),Xe=b.getFromId(he,De),He="";xe==="paper"||qe.autorange||(He+=xe),De==="paper"||Xe.autorange||(He+=De),a.setClipUrl(Ue,He?"clip"+he._fullLayout._uid+He:null,he)}(ee,j,U),vt.moveFn=ze==="move"?qt:er,vt.altKey=Ht.altKey)},doneFn:function(){h(U)||(o(ee),ir(K),x(ee,U,j),p.call("_guiRelayout",U,re.getUpdateObj()))},clickFn:function(){h(U)||ir(K)}};function Nt(Ht){if(h(U))ze=null;else if(Ze)ze=Ht.target.tagName==="path"?"move":Ht.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var Ue=vt.element.getBoundingClientRect(),We=Ue.right-Ue.left,he=Ue.bottom-Ue.top,xe=Ht.clientX-Ue.left,De=Ht.clientY-Ue.top,qe=!Pe&&We>10&&he>10&&!Ht.shiftKey?m.getCursor(xe/We,1-De/he):"move";o(ee,qe),ze=qe.split("-")[0]}}function qt(Ht,Ue){if(j.type==="path"){var We=function(De){return De},he=We,xe=We;Re?Ie("xanchor",j.xanchor=yt(se+Ht)):(he=function(De){return yt(pt(De)+Ht)},Be&&Be.type==="date"&&(he=u.encodeDate(he))),Oe?Ie("yanchor",j.yanchor=tt(me+Ue)):(xe=function(De){return tt(_t(De)+Ue)},$e&&$e.type==="date"&&(xe=u.encodeDate(xe))),Ie("path",j.path=c(Le,he,xe))}else Re?Ie("xanchor",j.xanchor=yt(se+Ht)):(Ie("x0",j.x0=yt(ne+Ht)),Ie("x1",j.x1=yt(oe+Ht))),Oe?Ie("yanchor",j.yanchor=tt(me+Ue)):(Ie("y0",j.y0=tt(le+Ue)),Ie("y1",j.y1=tt(de+Ue)));ee.attr("d",f(U,j)),Jt(K,j)}function er(Ht,Ue){if(Pe){var We=function(Ae){return Ae},he=We,xe=We;Re?Ie("xanchor",j.xanchor=yt(se+Ht)):(he=function(Ae){return yt(pt(Ae)+Ht)},Be&&Be.type==="date"&&(he=u.encodeDate(he))),Oe?Ie("yanchor",j.yanchor=tt(me+Ue)):(xe=function(Ae){return tt(_t(Ae)+Ue)},$e&&$e.type==="date"&&(xe=u.encodeDate(xe))),Ie("path",j.path=c(Le,he,xe))}else if(Ze){if(ze==="resize-over-start-point"){var De=ne+Ht,qe=Oe?le-Ue:le+Ue;Ie("x0",j.x0=Re?De:yt(De)),Ie("y0",j.y0=Oe?qe:tt(qe))}else if(ze==="resize-over-end-point"){var Xe=oe+Ht,He=Oe?de-Ue:de+Ue;Ie("x1",j.x1=Re?Xe:yt(Xe)),Ie("y1",j.y1=Oe?He:tt(He))}}else{var st=function(Ae){return ze.indexOf(Ae)!==-1},it=st("n"),Tt=st("s"),Pt=st("w"),rt=st("e"),ut=it?Te+Ue:Te,Ft=Tt?_e+Ue:_e,wt=Pt?be+Ht:be,Lt=rt?Ce+Ht:Ce;Oe&&(it&&(ut=Te-Ue),Tt&&(Ft=_e-Ue)),(!Oe&&Ft-ut>10||Oe&&ut-Ft>10)&&(Ie(fe,j[fe]=Oe?ut:tt(ut)),Ie(ve,j[ve]=Oe?Ft:tt(Ft))),Lt-wt>10&&(Ie(Me,j[Me]=Re?wt:yt(wt)),Ie(ke,j[ke]=Re?Lt:yt(Lt)))}ee.attr("d",f(U,j)),Jt(K,j)}function Jt(Ht,Ue){(Re||Oe)&&function(){var We=Ue.type!=="path",he=Ht.selectAll(".visual-cue").data([0]);he.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var xe=pt(Re?Ue.xanchor:g.midRange(We?[Ue.x0,Ue.x1]:u.extractPathCoords(Ue.path,i.paramIsX))),De=_t(Oe?Ue.yanchor:g.midRange(We?[Ue.y0,Ue.y1]:u.extractPathCoords(Ue.path,i.paramIsY)));if(xe=u.roundPositionForSharpStrokeRendering(xe,1),De=u.roundPositionForSharpStrokeRendering(De,1),Re&&Oe){var qe="M"+(xe-1-1)+","+(De-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";he.attr("d",qe)}else if(Re){var Xe="M"+(xe-1-1)+","+(De-9-1)+"v18 h2 v-18 Z";he.attr("d",Xe)}else{var He="M"+(xe-9-1)+","+(De-1-1)+"h18 v2 h-18 Z";he.attr("d",He)}}()}function ir(Ht){Ht.selectAll(".visual-cue").remove()}m.init(vt),Ke.node().onmousemove=Nt}(_,te,L,w,P,W):L.editable===!0&&te.style("pointer-events",$||t.opacity(R)*D<=.5?"stroke":"all");te.node().addEventListener("click",function(){return function(U,ee){if(!!d(U)){var j=+ee.node().getAttribute("data-index");if(j>=0){if(j===U._fullLayout._activeShapeIndex)return void T(U);U._fullLayout._activeShapeIndex=j,U._fullLayout._deactivateShape=T,l(U)}}}(_,te)})}}function x(_,w,k){var L=(k.xref+k.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");a.setClipUrl(_,L?"clip"+w._fullLayout._uid+L:null,w)}function c(_,w,k){return _.replace(i.segmentRE,function(L){var A=0,I=L.charAt(0),P=i.paramIsX[I],S=i.paramIsY[I],E=i.numParams[I];return I+L.substr(1).replace(i.paramRE,function(D){return A>=E||(P[A]?D=w(D):S[A]&&(D=k(D)),A++),D})})}function T(_){d(_)&&_._fullLayout._activeShapeIndex>=0&&(n(_),delete _._fullLayout._activeShapeIndex,l(_))}J.exports={draw:l,drawOne:s,eraseActiveShape:function(_){if(!!d(_)){n(_);var w=_._fullLayout._activeShapeIndex,k=(_.layout||{}).shapes||[];if(w<k.length){for(var L=[],A=0;A<k.length;A++)A!==w&&L.push(k[A]);delete _._fullLayout._activeShapeIndex,p.call("_guiRelayout",_,{shapes:L})}}}}},{"../../lib":515,"../../lib/setcursor":536,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":459,"./display_outlines":461,"./draw_newshape/helpers":466,"./handle_outline":468,"./helpers":469}],463:[function(v,J,Z){var p=v("../../drawing/attributes").dash,g=v("../../../lib/extend").extendFlat;J.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:g({},p,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],464:[function(v,J,Z){J.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],465:[function(v,J,Z){var p=v("../../color");J.exports=function(g,b,y){if(y("newshape.drawdirection"),y("newshape.layer"),y("newshape.fillcolor"),y("newshape.fillrule"),y("newshape.opacity"),y("newshape.line.width")){var e=(g||{}).plot_bgcolor||"#FFF";y("newshape.line.color",p.contrast(e)),y("newshape.line.dash")}y("activeshape.fillcolor"),y("activeshape.opacity")}},{"../../color":367}],466:[function(v,J,Z){var p=v("parse-svg-path"),g=v("./constants"),b=g.CIRCLE_SIDES,y=g.SQRT2,e=v("../../selections/helpers"),n=e.p2r,t=e.r2p,a=[0,3,4,5,6,1,2],r=[0,3,4,1,2];function m(i,u){return Math.abs(i-u)<=1e-6}function o(i,u){var f=u[1]-i[1],l=u[2]-i[2];return Math.sqrt(f*f+l*l)}Z.writePaths=function(i){var u=i.length;if(!u)return"M0,0Z";for(var f="",l=0;l<u;l++)for(var h=i[l].length,d=0;d<h;d++){var s=i[l][d][0];if(s==="Z")f+="Z";else for(var x=i[l][d].length,c=0;c<x;c++){var T=c;s==="Q"||s==="S"?T=r[c]:s==="C"&&(T=a[c]),f+=i[l][d][T],c>0&&c<x-1&&(f+=",")}}return f},Z.readPaths=function(i,u,f,l){var h,d,s,x=p(i),c=[],T=-1,_=0,w=0,k=function(){d=_,s=w};k();for(var L=0;L<x.length;L++){var A,I,P,S,E=[],D=x[L][0],R=D;switch(D){case"M":T++,c[T]=[],_=+x[L][1],w=+x[L][2],E.push([R,_,w]),k();break;case"Q":case"S":A=+x[L][1],P=+x[L][2],_=+x[L][3],w=+x[L][4],E.push([R,_,w,A,P]);break;case"C":A=+x[L][1],P=+x[L][2],I=+x[L][3],S=+x[L][4],_=+x[L][5],w=+x[L][6],E.push([R,_,w,A,P,I,S]);break;case"T":case"L":_=+x[L][1],w=+x[L][2],E.push([R,_,w]);break;case"H":R="L",_=+x[L][1],E.push([R,_,w]);break;case"V":R="L",w=+x[L][1],E.push([R,_,w]);break;case"A":R="L";var H=+x[L][1],V=+x[L][2];+x[L][4]||(H=-H,V=-V);var X=_-H,$=w;for(h=1;h<=b/2;h++){var G=2*Math.PI*h/b;E.push([R,X+H*Math.cos(G),$+V*Math.sin(G)])}break;case"Z":_===d&&w===s||(_=d,w=s,E.push([R,_,w]))}for(var W=(f||{}).domain,te=u._fullLayout._size,N=f&&f.xsizemode==="pixel",B=f&&f.ysizemode==="pixel",U=l===!1,ee=0;ee<E.length;ee++){for(h=0;h+2<7;h+=2){var j=E[ee][h+1],Q=E[ee][h+2];j!==void 0&&Q!==void 0&&(_=j,w=Q,f&&(f.xaxis&&f.xaxis.p2r?(U&&(j-=f.xaxis._offset),j=N?t(f.xaxis,f.xanchor)+j:n(f.xaxis,j)):(U&&(j-=te.l),W?j=W.x[0]+j/te.w:j/=te.w),f.yaxis&&f.yaxis.p2r?(U&&(Q-=f.yaxis._offset),Q=B?t(f.yaxis,f.yanchor)-Q:n(f.yaxis,Q)):(U&&(Q-=te.t),Q=W?W.y[1]-Q/te.h:1-Q/te.h)),E[ee][h+1]=j,E[ee][h+2]=Q)}c[T].push(E[ee].slice())}}return c},Z.pointsOnRectangle=function(i){if(i.length!==5)return!1;for(var u=1;u<3;u++)if(!m(i[0][u]-i[1][u],i[3][u]-i[2][u])||!m(i[0][u]-i[3][u],i[1][u]-i[2][u]))return!1;return!(!m(i[0][1],i[1][1])&&!m(i[0][1],i[3][1]))&&!!(o(i[0],i[1])*o(i[0],i[3]))},Z.pointsOnEllipse=function(i){var u=i.length;if(u!==b+1)return!1;u=b;for(var f=0;f<u;f++){var l=(2*u-f)%u,h=(u/2+l)%u,d=(u/2+f)%u;if(!m(o(i[f],i[d]),o(i[l],i[h])))return!1}return!0},Z.handleEllipse=function(i,u,f){if(!i)return[u,f];var l=Z.ellipseOver({x0:u[0],y0:u[1],x1:f[0],y1:f[1]}),h=(l.x1+l.x0)/2,d=(l.y1+l.y0)/2,s=(l.x1-l.x0)/2,x=(l.y1-l.y0)/2;s||(s=x/=y),x||(x=s/=y);for(var c=[],T=0;T<b;T++){var _=2*T*Math.PI/b;c.push([h+s*Math.cos(_),d+x*Math.sin(_)])}return c},Z.ellipseOver=function(i){var u=i.x0,f=i.y0,l=i.x1,h=i.y1,d=l-u,s=h-f,x=((u-=d)+l)/2,c=((f-=s)+h)/2;return{x0:x-(d*=y),y0:c-(s*=y),x1:x+d,y1:c+s}},Z.fixDatesForPaths=function(i,u,f){var l=u.type==="date",h=f.type==="date";if(!l&&!h)return i;for(var d=0;d<i.length;d++)for(var s=0;s<i[d].length;s++)for(var x=0;x+2<i[d][s].length;x+=2)l&&(i[d][s][x+1]=i[d][s][x+1].replace(" ","_")),h&&(i[d][s][x+2]=i[d][s][x+2].replace(" ","_"));return i}},{"../../selections/helpers":454,"./constants":464,"parse-svg-path":250}],467:[function(v,J,Z){var p=v("../../dragelement/helpers"),g=p.drawMode,b=p.openMode,y=v("./constants"),e=y.i000,n=y.i090,t=y.i180,a=y.i270,r=y.cos45,m=y.sin45,o=v("../../selections/helpers"),i=o.p2r,u=o.r2p,f=v(".././handle_outline").clearOutline,l=v("./helpers"),h=l.readPaths,d=l.writePaths,s=l.ellipseOver,x=l.fixDatesForPaths;J.exports=function(c,T){if(c.length){var _=c[0][0];if(_){var w=_.getAttribute("d"),k=T.gd,L=k._fullLayout.newshape,A=T.plotinfo,I=A.xaxis,P=A.yaxis,S=!!A.domain||!A.xaxis,E=!!A.domain||!A.yaxis,D=T.isActiveShape,R=T.dragmode,H=(k.layout||{}).shapes||[];if(!g(R)&&D!==void 0){var V=k._fullLayout._activeShapeIndex;if(V<H.length)switch(k._fullLayout.shapes[V].type){case"rect":R="drawrect";break;case"circle":R="drawcircle";break;case"line":R="drawline";break;case"path":var X=H[V].path||"";R=X[X.length-1]==="Z"?"drawclosedpath":"drawopenpath"}}var $,G=b(R),W=h(w,k,A,D),te={editable:!0,xref:S?"paper":I._id,yref:E?"paper":P._id,layer:L.layer,opacity:L.opacity,line:{color:L.line.color,width:L.line.width,dash:L.line.dash}};if(G||(te.fillcolor=L.fillcolor,te.fillrule=L.fillrule),W.length===1&&($=W[0]),$&&$.length===5&&R==="drawrect")te.type="rect",te.x0=$[0][1],te.y0=$[0][2],te.x1=$[2][1],te.y1=$[2][2];else if($&&R==="drawline")te.type="line",te.x0=$[0][1],te.y0=$[0][2],te.x1=$[1][1],te.y1=$[1][2];else if($&&R==="drawcircle"){te.type="circle";var N=$[e][1],B=$[n][1],U=$[t][1],ee=$[a][1],j=$[e][2],Q=$[n][2],K=$[t][2],re=$[a][2],ne=A.xaxis&&(A.xaxis.type==="date"||A.xaxis.type==="log"),le=A.yaxis&&(A.yaxis.type==="date"||A.yaxis.type==="log");ne&&(N=u(A.xaxis,N),B=u(A.xaxis,B),U=u(A.xaxis,U),ee=u(A.xaxis,ee)),le&&(j=u(A.yaxis,j),Q=u(A.yaxis,Q),K=u(A.yaxis,K),re=u(A.yaxis,re));var oe=(B+ee)/2,de=(j+K)/2,se=s({x0:oe,y0:de,x1:oe+(ee-B+U-N)/2*r,y1:de+(re-Q+K-j)/2*m});ne&&(se.x0=i(A.xaxis,se.x0),se.x1=i(A.xaxis,se.x1)),le&&(se.y0=i(A.yaxis,se.y0),se.y1=i(A.yaxis,se.y1)),te.x0=se.x0,te.y0=se.y0,te.x1=se.x1,te.y1=se.y1}else te.type="path",I&&P&&x(W,I,P),te.path=d(W),$=null;f(k);for(var me=T.editHelpers,Te=(me||{}).modifyItem,_e=[],be=0;be<H.length;be++){var Ce=k._fullLayout.shapes[be];if(_e[be]=Ce._input,D!==void 0&&be===k._fullLayout._activeShapeIndex){var fe=te;switch(Ce.type){case"line":case"rect":case"circle":Te("x0",fe.x0),Te("x1",fe.x1),Te("y0",fe.y0),Te("y1",fe.y1);break;case"path":Te("path",fe.path)}}}return D===void 0?(_e.push(te),_e):me?me.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../selections/helpers":454,".././handle_outline":468,"./constants":464,"./helpers":466}],468:[function(v,J,Z){J.exports={clearOutlineControllers:function(p){var g=p._fullLayout._zoomlayer;g&&g.selectAll(".outline-controllers").remove()},clearOutline:function(p){var g=p._fullLayout._zoomlayer;g&&g.selectAll(".select-outline").remove(),p._fullLayout._outlining=!1}}},{}],469:[function(v,J,Z){var p=v("./constants"),g=v("../../lib"),b=v("../../plots/cartesian/axes");Z.rangeToShapePosition=function(y){return y.type==="log"?y.r2d:function(e){return e}},Z.shapePositionToRange=function(y){return y.type==="log"?y.d2r:function(e){return e}},Z.decodeDate=function(y){return function(e){return e.replace&&(e=e.replace("_"," ")),y(e)}},Z.encodeDate=function(y){return function(e){return y(e).replace(" ","_")}},Z.extractPathCoords=function(y,e,n){var t=[];return y.match(p.segmentRE).forEach(function(a){var r=e[a.charAt(0)].drawn;if(r!==void 0){var m=a.substr(1).match(p.paramRE);if(m&&!(m.length<r)){var o=m[r],i=n?o:g.cleanNumber(o);t.push(i)}}}),t},Z.getDataToPixel=function(y,e,n,t){var a,r=y._fullLayout._size;if(e)if(t==="domain")a=function(o){return e._length*(n?1-o:o)+e._offset};else{var m=Z.shapePositionToRange(e);a=function(o){return e._offset+e.r2p(m(o,!0))},e.type==="date"&&(a=Z.decodeDate(a))}else a=n?function(o){return r.t+r.h*(1-o)}:function(o){return r.l+r.w*o};return a},Z.getPixelToData=function(y,e,n,t){var a,r=y._fullLayout._size;if(e)if(t==="domain")a=function(o){var i=(o-e._offset)/e._length;return n?1-i:i};else{var m=Z.rangeToShapePosition(e);a=function(o){return m(e.p2r(o-e._offset))}}else a=n?function(o){return 1-(o-r.t)/r.h}:function(o){return(o-r.l)/r.w};return a},Z.roundPositionForSharpStrokeRendering=function(y,e){var n=Math.round(e%2)===1,t=Math.round(y);return n?t+.5:t},Z.makeShapesOptionsAndPlotinfo=function(y,e){var n=y._fullLayout.shapes[e]||{},t=y._fullLayout._plots[n.xref+n.yref];return t?t._hadPlotinfo=!0:(t={},n.xref&&n.xref!=="paper"&&(t.xaxis=y._fullLayout[n.xref+"axis"]),n.yref&&n.yref!=="paper"&&(t.yaxis=y._fullLayout[n.yref+"axis"])),t.xsizemode=n.xsizemode,t.ysizemode=n.ysizemode,t.xanchor=n.xanchor,t.yanchor=n.yanchor,{options:n,plotinfo:t}},Z.makeSelectionsOptionsAndPlotinfo=function(y,e){var n=y._fullLayout.selections[e]||{},t=y._fullLayout._plots[n.xref+n.yref];return t?t._hadPlotinfo=!0:(t={},n.xref&&(t.xaxis=y._fullLayout[n.xref+"axis"]),n.yref&&(t.yaxis=y._fullLayout[n.yref+"axis"])),{options:n,plotinfo:t}},Z.getPathString=function(y,e){var n,t,a,r,m,o,i,u,f=e.type,l=b.getRefType(e.xref),h=b.getRefType(e.yref),d=b.getFromId(y,e.xref),s=b.getFromId(y,e.yref),x=y._fullLayout._size;if(d?l==="domain"?t=function(P){return d._offset+d._length*P}:(n=Z.shapePositionToRange(d),t=function(P){return d._offset+d.r2p(n(P,!0))}):t=function(P){return x.l+x.w*P},s?h==="domain"?r=function(P){return s._offset+s._length*(1-P)}:(a=Z.shapePositionToRange(s),r=function(P){return s._offset+s.r2p(a(P,!0))}):r=function(P){return x.t+x.h*(1-P)},f==="path")return d&&d.type==="date"&&(t=Z.decodeDate(t)),s&&s.type==="date"&&(r=Z.decodeDate(r)),function(P,S,E){var D=P.path,R=P.xsizemode,H=P.ysizemode,V=P.xanchor,X=P.yanchor;return D.replace(p.segmentRE,function($){var G=0,W=$.charAt(0),te=p.paramIsX[W],N=p.paramIsY[W],B=p.numParams[W],U=$.substr(1).replace(p.paramRE,function(ee){return te[G]?ee=R==="pixel"?S(V)+Number(ee):S(ee):N[G]&&(ee=H==="pixel"?E(X)-Number(ee):E(ee)),++G>B&&(ee="X"),ee});return G>B&&(U=U.replace(/[\s,]*X.*/,""),g.log("Ignoring extra params in segment "+$)),W+U})}(e,t,r);if(e.xsizemode==="pixel"){var c=t(e.xanchor);m=c+e.x0,o=c+e.x1}else m=t(e.x0),o=t(e.x1);if(e.ysizemode==="pixel"){var T=r(e.yanchor);i=T-e.y0,u=T-e.y1}else i=r(e.y0),u=r(e.y1);if(f==="line")return"M"+m+","+i+"L"+o+","+u;if(f==="rect")return"M"+m+","+i+"H"+o+"V"+u+"H"+m+"Z";var _=(m+o)/2,w=(i+u)/2,k=Math.abs(_-m),L=Math.abs(w-i),A="A"+k+","+L,I=_+k+","+w;return"M"+I+A+" 0 1,1 "+(_+","+(w-L))+A+" 0 0,1 "+I+"Z"}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459}],470:[function(v,J,Z){var p=v("./draw");J.exports={moduleType:"component",name:"shapes",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),supplyDrawNewShapeDefaults:v("./draw_newshape/defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("shapes"),calcAutorange:v("./calc_autorange"),draw:p.draw,drawOne:p.drawOne}},{"../../plots/cartesian/include_components":577,"./attributes":457,"./calc_autorange":458,"./defaults":460,"./draw":462,"./draw_newshape/defaults":465}],471:[function(v,J,Z){var p=v("../../plots/font_attributes"),g=v("../../plots/pad_attributes"),b=v("../../lib/extend").extendDeepAll,y=v("../../plot_api/edit_types").overrideAll,e=v("../../plots/animation_attributes"),n=v("../../plot_api/plot_template").templatedArray,t=v("./constants"),a=n("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});J.exports=y(n("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:a,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:b(g({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:p({})},font:p({}),activebgcolor:{valType:"color",dflt:t.gripBgActiveColor},bgcolor:{valType:"color",dflt:t.railBgColor},bordercolor:{valType:"color",dflt:t.railBorderColor},borderwidth:{valType:"number",min:0,dflt:t.railBorderWidth},ticklen:{valType:"number",min:0,dflt:t.tickLength},tickcolor:{valType:"color",dflt:t.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:t.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/animation_attributes":560,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"./constants":472}],472:[function(v,J,Z){J.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],473:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/array_container_defaults"),b=v("./attributes"),y=v("./constants").name,e=b.steps;function n(a,r,m){function o(h,d){return p.coerce(a,r,b,h,d)}for(var i=g(a,r,{name:"steps",handleItemDefaults:t}),u=0,f=0;f<i.length;f++)i[f].visible&&u++;if(u<2?r.visible=!1:o("visible")){r._stepCount=u;var l=r._visibleSteps=p.filterVisible(i);(i[o("active")]||{}).visible||(r.active=l[0]._index),o("x"),o("y"),p.noneOrAll(a,r,["x","y"]),o("xanchor"),o("yanchor"),o("len"),o("lenmode"),o("pad.t"),o("pad.r"),o("pad.b"),o("pad.l"),p.coerceFont(o,"font",m.font),o("currentvalue.visible")&&(o("currentvalue.xanchor"),o("currentvalue.prefix"),o("currentvalue.suffix"),o("currentvalue.offset"),p.coerceFont(o,"currentvalue.font",r.font)),o("transition.duration"),o("transition.easing"),o("bgcolor"),o("activebgcolor"),o("bordercolor"),o("borderwidth"),o("ticklen"),o("tickwidth"),o("tickcolor"),o("minorticklen")}}function t(a,r){function m(i,u){return p.coerce(a,r,e,i,u)}if(a.method==="skip"||Array.isArray(a.args)?m("visible"):r.visible=!1){m("method"),m("args");var o=m("label","step-"+r._index);m("value",o),m("execute")}}J.exports=function(a,r){g(a,r,{name:y,handleItemDefaults:n})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":471,"./constants":472}],474:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../plots/plots"),b=v("../color"),y=v("../drawing"),e=v("../../lib"),n=e.strTranslate,t=v("../../lib/svg_text_utils"),a=v("../../plot_api/plot_template").arrayEditor,r=v("./constants"),m=v("../../constants/alignment"),o=m.LINE_SPACING,i=m.FROM_TL,u=m.FROM_BR;function f(E){return r.autoMarginIdRoot+E._index}function l(E){return E._index}function h(E,D){var R=y.tester.selectAll("g."+r.labelGroupClass).data(D._visibleSteps);R.enter().append("g").classed(r.labelGroupClass,!0);var H=0,V=0;R.each(function(ee){var j=x(p.select(this),{step:ee},D).node();if(j){var Q=y.bBox(j);V=Math.max(V,Q.height),H=Math.max(H,Q.width)}}),R.remove();var X=D._dims={};X.inputAreaWidth=Math.max(r.railWidth,r.gripHeight);var $=E._fullLayout._size;X.lx=$.l+$.w*D.x,X.ly=$.t+$.h*(1-D.y),D.lenmode==="fraction"?X.outerLength=Math.round($.w*D.len):X.outerLength=D.len,X.inputAreaStart=0,X.inputAreaLength=Math.round(X.outerLength-D.pad.l-D.pad.r);var G=(X.inputAreaLength-2*r.stepInset)/(D._stepCount-1),W=H+r.labelPadding;if(X.labelStride=Math.max(1,Math.ceil(W/G)),X.labelHeight=V,X.currentValueMaxWidth=0,X.currentValueHeight=0,X.currentValueTotalHeight=0,X.currentValueMaxLines=1,D.currentvalue.visible){var te=y.tester.append("g");R.each(function(ee){var j=d(te,D,ee.label),Q=j.node()&&y.bBox(j.node())||{width:0,height:0},K=t.lineCount(j);X.currentValueMaxWidth=Math.max(X.currentValueMaxWidth,Math.ceil(Q.width)),X.currentValueHeight=Math.max(X.currentValueHeight,Math.ceil(Q.height)),X.currentValueMaxLines=Math.max(X.currentValueMaxLines,K)}),X.currentValueTotalHeight=X.currentValueHeight+D.currentvalue.offset,te.remove()}X.height=X.currentValueTotalHeight+r.tickOffset+D.ticklen+r.labelOffset+X.labelHeight+D.pad.t+D.pad.b;var N="left";e.isRightAnchor(D)&&(X.lx-=X.outerLength,N="right"),e.isCenterAnchor(D)&&(X.lx-=X.outerLength/2,N="center");var B="top";e.isBottomAnchor(D)&&(X.ly-=X.height,B="bottom"),e.isMiddleAnchor(D)&&(X.ly-=X.height/2,B="middle"),X.outerLength=Math.ceil(X.outerLength),X.height=Math.ceil(X.height),X.lx=Math.round(X.lx),X.ly=Math.round(X.ly);var U={y:D.y,b:X.height*u[B],t:X.height*i[B]};D.lenmode==="fraction"?(U.l=0,U.xl=D.x-D.len*i[N],U.r=0,U.xr=D.x+D.len*u[N]):(U.x=D.x,U.l=X.outerLength*i[N],U.r=X.outerLength*u[N]),g.autoMargin(E,f(D),U)}function d(E,D,R){if(D.currentvalue.visible){var H,V,X=D._dims;switch(D.currentvalue.xanchor){case"right":H=X.inputAreaLength-r.currentValueInset-X.currentValueMaxWidth,V="left";break;case"center":H=.5*X.inputAreaLength,V="middle";break;default:H=r.currentValueInset,V="left"}var $=e.ensureSingle(E,"text",r.labelClass,function(U){U.attr({"text-anchor":V,"data-notex":1})}),G=D.currentvalue.prefix?D.currentvalue.prefix:"";if(typeof R=="string")G+=R;else{var W=D.steps[D.active].label,te=D._gd._fullLayout._meta;te&&(W=e.templateString(W,te)),G+=W}D.currentvalue.suffix&&(G+=D.currentvalue.suffix),$.call(y.font,D.currentvalue.font).text(G).call(t.convertToTspans,D._gd);var N=t.lineCount($),B=(X.currentValueMaxLines+1-N)*D.currentvalue.font.size*o;return t.positionText($,H,B),$}}function s(E,D,R){e.ensureSingle(E,"rect",r.gripRectClass,function(H){H.call(w,D,E,R).style("pointer-events","all")}).attr({width:r.gripWidth,height:r.gripHeight,rx:r.gripRadius,ry:r.gripRadius}).call(b.stroke,R.bordercolor).call(b.fill,R.bgcolor).style("stroke-width",R.borderwidth+"px")}function x(E,D,R){var H=e.ensureSingle(E,"text",r.labelClass,function($){$.attr({"text-anchor":"middle","data-notex":1})}),V=D.step.label,X=R._gd._fullLayout._meta;return X&&(V=e.templateString(V,X)),H.call(y.font,R.font).text(V).call(t.convertToTspans,R._gd),H}function c(E,D){var R=e.ensureSingle(E,"g",r.labelsClass),H=D._dims,V=R.selectAll("g."+r.labelGroupClass).data(H.labelSteps);V.enter().append("g").classed(r.labelGroupClass,!0),V.exit().remove(),V.each(function(X){var $=p.select(this);$.call(x,X,D),y.setTranslate($,A(D,X.fraction),r.tickOffset+D.ticklen+D.font.size*o+r.labelOffset+H.currentValueTotalHeight)})}function T(E,D,R,H,V){var X=Math.round(H*(R._stepCount-1)),$=R._visibleSteps[X]._index;$!==R.active&&_(E,D,R,$,!0,V)}function _(E,D,R,H,V,X){var $=R.active;R.active=H,a(E.layout,r.name,R).applyUpdate("active",H);var G=R.steps[R.active];D.call(L,R,X),D.call(d,R),E.emit("plotly_sliderchange",{slider:R,step:R.steps[R.active],interaction:V,previousActive:$}),G&&G.method&&V&&(D._nextMethod?(D._nextMethod.step=G,D._nextMethod.doCallback=V,D._nextMethod.doTransition=X):(D._nextMethod={step:G,doCallback:V,doTransition:X},D._nextMethodRaf=window.requestAnimationFrame(function(){var W=D._nextMethod.step;W.method&&(W.execute&&g.executeAPICommand(E,W.method,W.args),D._nextMethod=null,D._nextMethodRaf=null)})))}function w(E,D,R){var H=R.node(),V=p.select(D);function X(){return R.data()[0]}function $(){var G=X();D.emit("plotly_sliderstart",{slider:G});var W=R.select("."+r.gripRectClass);p.event.stopPropagation(),p.event.preventDefault(),W.call(b.fill,G.activebgcolor);var te=I(G,p.mouse(H)[0]);function N(){var U=X(),ee=I(U,p.mouse(H)[0]);T(D,R,U,ee,!1)}function B(){var U=X();U._dragging=!1,W.call(b.fill,U.bgcolor),V.on("mouseup",null),V.on("mousemove",null),V.on("touchend",null),V.on("touchmove",null),D.emit("plotly_sliderend",{slider:U,step:U.steps[U.active]})}T(D,R,G,te,!0),G._dragging=!0,V.on("mousemove",N),V.on("touchmove",N),V.on("mouseup",B),V.on("touchend",B)}E.on("mousedown",$),E.on("touchstart",$)}function k(E,D){var R=E.selectAll("rect."+r.tickRectClass).data(D._visibleSteps),H=D._dims;R.enter().append("rect").classed(r.tickRectClass,!0),R.exit().remove(),R.attr({width:D.tickwidth+"px","shape-rendering":"crispEdges"}),R.each(function(V,X){var $=X%H.labelStride==0,G=p.select(this);G.attr({height:$?D.ticklen:D.minorticklen}).call(b.fill,D.tickcolor),y.setTranslate(G,A(D,X/(D._stepCount-1))-.5*D.tickwidth,($?r.tickOffset:r.minorTickOffset)+H.currentValueTotalHeight)})}function L(E,D,R){for(var H=E.select("rect."+r.gripRectClass),V=0,X=0;X<D._stepCount;X++)if(D._visibleSteps[X]._index===D.active){V=X;break}var $=A(D,V/(D._stepCount-1));if(!D._invokingCommand){var G=H;R&&D.transition.duration>0&&(G=G.transition().duration(D.transition.duration).ease(D.transition.easing)),G.attr("transform",n($-.5*r.gripWidth,D._dims.currentValueTotalHeight))}}function A(E,D){var R=E._dims;return R.inputAreaStart+r.stepInset+(R.inputAreaLength-2*r.stepInset)*Math.min(1,Math.max(0,D))}function I(E,D){var R=E._dims;return Math.min(1,Math.max(0,(D-r.stepInset-R.inputAreaStart)/(R.inputAreaLength-2*r.stepInset-2*R.inputAreaStart)))}function P(E,D,R){var H=R._dims,V=e.ensureSingle(E,"rect",r.railTouchRectClass,function(X){X.call(w,D,E,R).style("pointer-events","all")});V.attr({width:H.inputAreaLength,height:Math.max(H.inputAreaWidth,r.tickOffset+R.ticklen+H.labelHeight)}).call(b.fill,R.bgcolor).attr("opacity",0),y.setTranslate(V,0,H.currentValueTotalHeight)}function S(E,D){var R=D._dims,H=R.inputAreaLength-2*r.railInset,V=e.ensureSingle(E,"rect",r.railRectClass);V.attr({width:H,height:r.railWidth,rx:r.railRadius,ry:r.railRadius,"shape-rendering":"crispEdges"}).call(b.stroke,D.bordercolor).call(b.fill,D.bgcolor).style("stroke-width",D.borderwidth+"px"),y.setTranslate(V,r.railInset,.5*(R.inputAreaWidth-r.railWidth)+R.currentValueTotalHeight)}J.exports=function(E){var D=E._fullLayout,R=function(W,te){for(var N=W[r.name],B=[],U=0;U<N.length;U++){var ee=N[U];ee.visible&&(ee._gd=te,B.push(ee))}return B}(D,E),H=D._infolayer.selectAll("g."+r.containerClassName).data(R.length>0?[0]:[]);function V(W){W._commandObserver&&(W._commandObserver.remove(),delete W._commandObserver),g.autoMargin(E,f(W))}if(H.enter().append("g").classed(r.containerClassName,!0).style("cursor","ew-resize"),H.exit().each(function(){p.select(this).selectAll("g."+r.groupClassName).each(V)}).remove(),R.length!==0){var X=H.selectAll("g."+r.groupClassName).data(R,l);X.enter().append("g").classed(r.groupClassName,!0),X.exit().each(V).remove();for(var $=0;$<R.length;$++){var G=R[$];h(E,G)}X.each(function(W){var te=p.select(this);(function(N){var B=N._dims;B.labelSteps=[];for(var U=N._stepCount,ee=0;ee<U;ee+=B.labelStride)B.labelSteps.push({fraction:ee/(U-1),step:N._visibleSteps[ee]})})(W),g.manageCommandObserver(E,W,W._visibleSteps,function(N){var B=te.data()[0];B.active!==N.index&&(B._dragging||_(E,te,B,N.index,!1,!0))}),function(N,B,U){(U.steps[U.active]||{}).visible||(U.active=U._visibleSteps[0]._index),B.call(d,U).call(S,U).call(c,U).call(k,U).call(P,N,U).call(s,N,U);var ee=U._dims;y.setTranslate(B,ee.lx+U.pad.l,ee.ly+U.pad.t),B.call(L,U,!1),B.call(d,U)}(E,p.select(this),W)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":472,"@plotly/d3":58}],475:[function(v,J,Z){var p=v("./constants");J.exports={moduleType:"component",name:p.name,layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),draw:v("./draw")}},{"./attributes":471,"./constants":472,"./defaults":473,"./draw":474}],476:[function(v,J,Z){var p=v("@plotly/d3"),g=v("fast-isnumeric"),b=v("../../plots/plots"),y=v("../../registry"),e=v("../../lib"),n=e.strTranslate,t=v("../drawing"),a=v("../color"),r=v("../../lib/svg_text_utils"),m=v("../../constants/interactions"),o=v("../../constants/alignment").OPPOSITE_SIDE,i=/ [XY][0-9]* /;J.exports={draw:function(u,f,l){var h,d=l.propContainer,s=l.propName,x=l.placeholder,c=l.traceIndex,T=l.avoid||{},_=l.attributes,w=l.transform,k=l.containerGroup,L=u._fullLayout,A=1,I=!1,P=d.title,S=(P&&P.text?P.text:"").trim(),E=P&&P.font?P.font:{},D=E.family,R=E.size,H=E.color;s==="title.text"?h="titleText":s.indexOf("axis")!==-1?h="axisTitleText":s.indexOf(!0)&&(h="colorbarTitleText");var V=u._context.edits[h];S===""?A=0:S.replace(i," % ")===x.replace(i," % ")&&(A=.2,I=!0,V||(S="")),l._meta?S=e.templateString(S,l._meta):L._meta&&(S=e.templateString(S,L._meta));var X,$=S||V;k||(k=e.ensureSingle(L._infolayer,"g","g-"+f),X=L._hColorbarMoveTitle);var G=k.selectAll("text").data($?[0]:[]);if(G.enter().append("text"),G.text(S).attr("class",f),G.exit().remove(),!$)return k;function W(B){e.syncOrAsync([te,N],B)}function te(B){var U;return!w&&X&&(w={}),w?(U="",w.rotate&&(U+="rotate("+[w.rotate,_.x,_.y]+")"),(w.offset||X)&&(U+=n(0,(w.offset||0)-(X||0)))):U=null,B.attr("transform",U),B.style({"font-family":D,"font-size":p.round(R,2)+"px",fill:a.rgb(H),opacity:A*a.opacity(H),"font-weight":b.fontWeight}).attr(_).call(r.convertToTspans,u),b.previousPromises(u)}function N(B){var U=p.select(B.node().parentNode);if(T&&T.selection&&T.side&&S){U.attr("transform",null);var ee=o[T.side],j=T.side==="left"||T.side==="top"?-1:1,Q=g(T.pad)?T.pad:2,K=t.bBox(U.node()),re={left:0,top:0,right:L.width,bottom:L.height},ne=T.maxShift||j*(re[T.side]-K[T.side]),le=0;if(ne<0)le=ne;else{var oe=T.offsetLeft||0,de=T.offsetTop||0;K.left-=oe,K.right-=oe,K.top-=de,K.bottom-=de,T.selection.each(function(){var me=t.bBox(this);e.bBoxIntersect(K,me,Q)&&(le=Math.max(le,j*(me[T.side]-K[ee])+Q))}),le=Math.min(ne,le)}if(le>0||ne<0){var se={left:[-le,0],right:[le,0],top:[0,-le],bottom:[0,le]}[T.side];U.attr("transform",n(se[0],se[1]))}}}return G.call(W),V&&(S?G.on(".opacity",null):(A=0,I=!0,G.text(x).on("mouseover.opacity",function(){p.select(this).transition().duration(m.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){p.select(this).transition().duration(m.HIDE_PLACEHOLDER).style("opacity",0)})),G.call(r.makeEditable,{gd:u}).on("edit",function(B){c!==void 0?y.call("_guiRestyle",u,s,B,c):y.call("_guiRelayout",u,s,B)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(W)}).on("input",function(B){this.text(B||" ").call(r.positionText,_.x,_.y)})),G.classed("js-placeholder",I),k}}},{"../../constants/alignment":483,"../../constants/interactions":490,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],477:[function(v,J,Z){var p=v("../../plots/font_attributes"),g=v("../color/attributes"),b=v("../../lib/extend").extendFlat,y=v("../../plot_api/edit_types").overrideAll,e=v("../../plots/pad_attributes"),n=v("../../plot_api/plot_template").templatedArray,t=n("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});J.exports=y(n("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:t,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:b(e({editType:"arraydraw"}),{}),font:p({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:g.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"../color/attributes":366}],478:[function(v,J,Z){J.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],479:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/array_container_defaults"),b=v("./attributes"),y=v("./constants").name,e=b.buttons;function n(a,r,m){function o(i,u){return p.coerce(a,r,b,i,u)}o("visible",g(a,r,{name:"buttons",handleItemDefaults:t}).length>0)&&(o("active"),o("direction"),o("type"),o("showactive"),o("x"),o("y"),p.noneOrAll(a,r,["x","y"]),o("xanchor"),o("yanchor"),o("pad.t"),o("pad.r"),o("pad.b"),o("pad.l"),p.coerceFont(o,"font",m.font),o("bgcolor",m.paper_bgcolor),o("bordercolor"),o("borderwidth"))}function t(a,r){function m(o,i){return p.coerce(a,r,e,o,i)}m("visible",a.method==="skip"||Array.isArray(a.args))&&(m("method"),m("args"),m("args2"),m("label"),m("execute"))}J.exports=function(a,r){g(a,r,{name:y,handleItemDefaults:n})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":477,"./constants":478}],480:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../plots/plots"),b=v("../color"),y=v("../drawing"),e=v("../../lib"),n=v("../../lib/svg_text_utils"),t=v("../../plot_api/plot_template").arrayEditor,a=v("../../constants/alignment").LINE_SPACING,r=v("./constants"),m=v("./scrollbox");function o(A){return A._index}function i(A,I){return+A.attr(r.menuIndexAttrName)===I._index}function u(A,I,P,S,E,D,R,H){I.active=R,t(A.layout,r.name,I).applyUpdate("active",R),I.type==="buttons"?l(A,S,null,null,I):I.type==="dropdown"&&(E.attr(r.menuIndexAttrName,"-1"),f(A,S,E,D,I),H||l(A,S,E,D,I))}function f(A,I,P,S,E){var D=e.ensureSingle(I,"g",r.headerClassName,function(G){G.style("pointer-events","all")}),R=E._dims,H=E.active,V=E.buttons[H]||r.blankHeaderOpts,X={y:E.pad.t,yPad:0,x:E.pad.l,xPad:0,index:0},$={width:R.headerWidth,height:R.headerHeight};D.call(h,E,V,A).call(k,E,X,$),e.ensureSingle(I,"text",r.headerArrowClassName,function(G){G.attr("text-anchor","end").call(y.font,E.font).text(r.arrowSymbol[E.direction])}).attr({x:R.headerWidth-r.arrowOffsetX+E.pad.l,y:R.headerHeight/2+r.textOffsetY+E.pad.t}),D.on("click",function(){P.call(L,String(i(P,E)?-1:E._index)),l(A,I,P,S,E)}),D.on("mouseover",function(){D.call(c)}),D.on("mouseout",function(){D.call(T,E)}),y.setTranslate(I,R.lx,R.ly)}function l(A,I,P,S,E){P||(P=I).attr("pointer-events","all");var D=function(U){return+U.attr(r.menuIndexAttrName)==-1}(P)&&E.type!=="buttons"?[]:E.buttons,R=E.type==="dropdown"?r.dropdownButtonClassName:r.buttonClassName,H=P.selectAll("g."+R).data(e.filterVisible(D)),V=H.enter().append("g").classed(R,!0),X=H.exit();E.type==="dropdown"?(V.attr("opacity","0").transition().attr("opacity","1"),X.transition().attr("opacity","0").remove()):X.remove();var $=0,G=0,W=E._dims,te=["up","down"].indexOf(E.direction)!==-1;E.type==="dropdown"&&(te?G=W.headerHeight+r.gapButtonHeader:$=W.headerWidth+r.gapButtonHeader),E.type==="dropdown"&&E.direction==="up"&&(G=-r.gapButtonHeader+r.gapButton-W.openHeight),E.type==="dropdown"&&E.direction==="left"&&($=-r.gapButtonHeader+r.gapButton-W.openWidth);var N={x:W.lx+$+E.pad.l,y:W.ly+G+E.pad.t,yPad:r.gapButton,xPad:r.gapButton,index:0},B={l:N.x+E.borderwidth,t:N.y+E.borderwidth};H.each(function(U,ee){var j=p.select(this);j.call(h,E,U,A).call(k,E,N),j.on("click",function(){p.event.defaultPrevented||(U.execute&&(U.args2&&E.active===ee?(u(A,E,0,I,P,S,-1),g.executeAPICommand(A,U.method,U.args2)):(u(A,E,0,I,P,S,ee),g.executeAPICommand(A,U.method,U.args))),A.emit("plotly_buttonclicked",{menu:E,button:U,active:E.active}))}),j.on("mouseover",function(){j.call(c)}),j.on("mouseout",function(){j.call(T,E),H.call(x,E)})}),H.call(x,E),te?(B.w=Math.max(W.openWidth,W.headerWidth),B.h=N.y-B.t):(B.w=N.x-B.l,B.h=Math.max(W.openHeight,W.headerHeight)),B.direction=E.direction,S&&(H.size()?function(U,ee,j,Q,K,re){var ne,le,oe,de=K.direction,se=de==="up"||de==="down",me=K._dims,Te=K.active;if(se)for(le=0,oe=0;oe<Te;oe++)le+=me.heights[oe]+r.gapButton;else for(ne=0,oe=0;oe<Te;oe++)ne+=me.widths[oe]+r.gapButton;Q.enable(re,ne,le),Q.hbar&&Q.hbar.attr("opacity","0").transition().attr("opacity","1"),Q.vbar&&Q.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,S,E,B):function(U){var ee=!!U.hbar,j=!!U.vbar;ee&&U.hbar.transition().attr("opacity","0").each("end",function(){ee=!1,j||U.disable()}),j&&U.vbar.transition().attr("opacity","0").each("end",function(){j=!1,ee||U.disable()})}(S))}function h(A,I,P,S){A.call(d,I).call(s,I,P,S)}function d(A,I){e.ensureSingle(A,"rect",r.itemRectClassName,function(P){P.attr({rx:r.rx,ry:r.ry,"shape-rendering":"crispEdges"})}).call(b.stroke,I.bordercolor).call(b.fill,I.bgcolor).style("stroke-width",I.borderwidth+"px")}function s(A,I,P,S){var E=e.ensureSingle(A,"text",r.itemTextClassName,function(H){H.attr({"text-anchor":"start","data-notex":1})}),D=P.label,R=S._fullLayout._meta;R&&(D=e.templateString(D,R)),E.call(y.font,I.font).text(D).call(n.convertToTspans,S)}function x(A,I){var P=I.active;A.each(function(S,E){var D=p.select(this);E===P&&I.showactive&&D.select("rect."+r.itemRectClassName).call(b.fill,r.activeColor)})}function c(A){A.select("rect."+r.itemRectClassName).call(b.fill,r.hoverColor)}function T(A,I){A.select("rect."+r.itemRectClassName).call(b.fill,I.bgcolor)}function _(A,I){var P=I._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},S=y.tester.selectAll("g."+r.dropdownButtonClassName).data(e.filterVisible(I.buttons));S.enter().append("g").classed(r.dropdownButtonClassName,!0);var E=["up","down"].indexOf(I.direction)!==-1;S.each(function($,G){var W=p.select(this);W.call(h,I,$,A);var te=W.select("."+r.itemTextClassName),N=te.node()&&y.bBox(te.node()).width,B=Math.max(N+r.textPadX,r.minWidth),U=I.font.size*a,ee=n.lineCount(te),j=Math.max(U*ee,r.minHeight)+r.textOffsetY;j=Math.ceil(j),B=Math.ceil(B),P.widths[G]=B,P.heights[G]=j,P.height1=Math.max(P.height1,j),P.width1=Math.max(P.width1,B),E?(P.totalWidth=Math.max(P.totalWidth,B),P.openWidth=P.totalWidth,P.totalHeight+=j+r.gapButton,P.openHeight+=j+r.gapButton):(P.totalWidth+=B+r.gapButton,P.openWidth+=B+r.gapButton,P.totalHeight=Math.max(P.totalHeight,j),P.openHeight=P.totalHeight)}),E?P.totalHeight-=r.gapButton:P.totalWidth-=r.gapButton,P.headerWidth=P.width1+r.arrowPadX,P.headerHeight=P.height1,I.type==="dropdown"&&(E?(P.width1+=r.arrowPadX,P.totalHeight=P.height1):P.totalWidth=P.width1,P.totalWidth+=r.arrowPadX),S.remove();var D=P.totalWidth+I.pad.l+I.pad.r,R=P.totalHeight+I.pad.t+I.pad.b,H=A._fullLayout._size;P.lx=H.l+H.w*I.x,P.ly=H.t+H.h*(1-I.y);var V="left";e.isRightAnchor(I)&&(P.lx-=D,V="right"),e.isCenterAnchor(I)&&(P.lx-=D/2,V="center");var X="top";e.isBottomAnchor(I)&&(P.ly-=R,X="bottom"),e.isMiddleAnchor(I)&&(P.ly-=R/2,X="middle"),P.totalWidth=Math.ceil(P.totalWidth),P.totalHeight=Math.ceil(P.totalHeight),P.lx=Math.round(P.lx),P.ly=Math.round(P.ly),g.autoMargin(A,w(I),{x:I.x,y:I.y,l:D*({right:1,center:.5}[V]||0),r:D*({left:1,center:.5}[V]||0),b:R*({top:1,middle:.5}[X]||0),t:R*({bottom:1,middle:.5}[X]||0)})}function w(A){return r.autoMarginIdRoot+A._index}function k(A,I,P,S){S=S||{};var E=A.select("."+r.itemRectClassName),D=A.select("."+r.itemTextClassName),R=I.borderwidth,H=P.index,V=I._dims;y.setTranslate(A,R+P.x,R+P.y);var X=["up","down"].indexOf(I.direction)!==-1,$=S.height||(X?V.heights[H]:V.height1);E.attr({x:0,y:0,width:S.width||(X?V.width1:V.widths[H]),height:$});var G=I.font.size*a,W=(n.lineCount(D)-1)*G/2;n.positionText(D,r.textOffsetX,$/2-W+r.textOffsetY),X?P.y+=V.heights[H]+P.yPad:P.x+=V.widths[H]+P.xPad,P.index++}function L(A,I){A.attr(r.menuIndexAttrName,I||"-1").selectAll("g."+r.dropdownButtonClassName).remove()}J.exports=function(A){var I=A._fullLayout,P=e.filterVisible(I[r.name]);function S(G){g.autoMargin(A,w(G))}var E=I._menulayer.selectAll("g."+r.containerClassName).data(P.length>0?[0]:[]);if(E.enter().append("g").classed(r.containerClassName,!0).style("cursor","pointer"),E.exit().each(function(){p.select(this).selectAll("g."+r.headerGroupClassName).each(S)}).remove(),P.length!==0){var D=E.selectAll("g."+r.headerGroupClassName).data(P,o);D.enter().append("g").classed(r.headerGroupClassName,!0);for(var R=e.ensureSingle(E,"g",r.dropdownButtonGroupClassName,function(G){G.style("pointer-events","all")}),H=0;H<P.length;H++){var V=P[H];_(A,V)}var X="updatemenus"+I._uid,$=new m(A,R,X);D.enter().size()&&(R.node().parentNode.appendChild(R.node()),R.call(L)),D.exit().each(function(G){R.call(L),S(G)}).remove(),D.each(function(G){var W=p.select(this),te=G.type==="dropdown"?R:null;g.manageCommandObserver(A,G,G.buttons,function(N){u(A,G,G.buttons[N.index],W,te,$,N.index,!0)}),G.type==="dropdown"?(f(A,W,R,$,G),i(R,G)&&l(A,W,R,$,G)):l(A,W,null,null,G)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":478,"./scrollbox":482,"@plotly/d3":58}],481:[function(v,J,Z){arguments[4][475][0].apply(Z,arguments)},{"./attributes":477,"./constants":478,"./defaults":479,"./draw":480,dup:475}],482:[function(v,J,Z){J.exports=e;var p=v("@plotly/d3"),g=v("../color"),b=v("../drawing"),y=v("../../lib");function e(n,t,a){this.gd=n,this.container=t,this.id=a,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(n,t,a){var r=this.gd._fullLayout,m=r.width,o=r.height;this.position=n;var i,u,f,l,h=this.position.l,d=this.position.w,s=this.position.t,x=this.position.h,c=this.position.direction,T=c==="down",_=c==="left",w=c==="up",k=d,L=x;T||_||c==="right"||w||(this.position.direction="down",T=!0),T||w?(u=(i=h)+k,T?(f=s,L=(l=Math.min(f+L,o))-f):L=(l=s+L)-(f=Math.max(l-L,0))):(l=(f=s)+L,_?k=(u=h+k)-(i=Math.max(u-k,0)):(i=h,k=(u=Math.min(i+k,m))-i)),this._box={l:i,t:f,w:k,h:L};var A=d>k,I=e.barLength+2*e.barPad,P=e.barWidth+2*e.barPad,S=h,E=s+x;E+P>o&&(E=o-P);var D=this.container.selectAll("rect.scrollbar-horizontal").data(A?[0]:[]);D.exit().on(".drag",null).remove(),D.enter().append("rect").classed("scrollbar-horizontal",!0).call(g.fill,e.barColor),A?(this.hbar=D.attr({rx:e.barRadius,ry:e.barRadius,x:S,y:E,width:I,height:P}),this._hbarXMin=S+I/2,this._hbarTranslateMax=k-I):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var R=x>L,H=e.barWidth+2*e.barPad,V=e.barLength+2*e.barPad,X=h+d,$=s;X+H>m&&(X=m-H);var G=this.container.selectAll("rect.scrollbar-vertical").data(R?[0]:[]);G.exit().on(".drag",null).remove(),G.enter().append("rect").classed("scrollbar-vertical",!0).call(g.fill,e.barColor),R?(this.vbar=G.attr({rx:e.barRadius,ry:e.barRadius,x:X,y:$,width:H,height:V}),this._vbarYMin=$+V/2,this._vbarTranslateMax=L-V):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var W=this.id,te=i-.5,N=R?u+H+.5:u+.5,B=f-.5,U=A?l+P+.5:l+.5,ee=r._topdefs.selectAll("#"+W).data(A||R?[0]:[]);if(ee.exit().remove(),ee.enter().append("clipPath").attr("id",W).append("rect"),A||R?(this._clipRect=ee.select("rect").attr({x:Math.floor(te),y:Math.floor(B),width:Math.ceil(N)-Math.floor(te),height:Math.ceil(U)-Math.floor(B)}),this.container.call(b.setClipUrl,W,this.gd),this.bg.attr({x:h,y:s,width:d,height:x})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(b.setClipUrl,null),delete this._clipRect),A||R){var j=p.behavior.drag().on("dragstart",function(){p.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(j);var Q=p.behavior.drag().on("dragstart",function(){p.event.sourceEvent.preventDefault(),p.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));A&&this.hbar.on(".drag",null).call(Q),R&&this.vbar.on(".drag",null).call(Q)}this.setTranslate(t,a)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(b.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var n=this.translateX,t=this.translateY;this.hbar&&(n-=p.event.dx),this.vbar&&(t-=p.event.dy),this.setTranslate(n,t)},e.prototype._onBoxWheel=function(){var n=this.translateX,t=this.translateY;this.hbar&&(n+=p.event.deltaY),this.vbar&&(t+=p.event.deltaY),this.setTranslate(n,t)},e.prototype._onBarDrag=function(){var n=this.translateX,t=this.translateY;if(this.hbar){var a=n+this._hbarXMin,r=a+this._hbarTranslateMax;n=(y.constrain(p.event.x,a,r)-a)/(r-a)*(this.position.w-this._box.w)}if(this.vbar){var m=t+this._vbarYMin,o=m+this._vbarTranslateMax;t=(y.constrain(p.event.y,m,o)-m)/(o-m)*(this.position.h-this._box.h)}this.setTranslate(n,t)},e.prototype.setTranslate=function(n,t){var a=this.position.w-this._box.w,r=this.position.h-this._box.h;if(n=y.constrain(n||0,0,a),t=y.constrain(t||0,0,r),this.translateX=n,this.translateY=t,this.container.call(b.setTranslate,this._box.l-this.position.l-n,this._box.t-this.position.t-t),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+n-.5),y:Math.floor(this.position.t+t-.5)}),this.hbar){var m=n/a;this.hbar.call(b.setTranslate,n+m*this._hbarTranslateMax,t)}if(this.vbar){var o=t/r;this.vbar.call(b.setTranslate,n,t+o*this._vbarTranslateMax)}}},{"../../lib":515,"../color":367,"../drawing":389,"@plotly/d3":58}],483:[function(v,J,Z){J.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],484:[function(v,J,Z){J.exports={axisRefDescription:function(p,g,b){return["If set to a",p,"axis id (e.g. *"+p+"* or","*"+p+"2*), the `"+p+"` position refers to a",p,"coordinate. If set to *paper*, the `"+p+"`","position refers to the distance from the",g,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",g,"("+b+"). If set to a",p,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",g,"of the domain of that axis: e.g.,","*"+p+"2 domain* refers to the domain of the second",p," axis and a",p,"position of 0.5 refers to the","point between the",g,"and the",b,"of the domain of the","second",p,"axis."].join(" ")}}},{}],485:[function(v,J,Z){J.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],486:[function(v,J,Z){J.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],487:[function(v,J,Z){J.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],488:[function(v,J,Z){J.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],489:[function(v,J,Z){J.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],490:[function(v,J,Z){J.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],491:[function(v,J,Z){J.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],492:[function(v,J,Z){Z.xmlns="http://www.w3.org/2000/xmlns/",Z.svg="http://www.w3.org/2000/svg",Z.xlink="http://www.w3.org/1999/xlink",Z.svgAttrs={xmlns:Z.svg,"xmlns:xlink":Z.xlink}},{}],493:[function(v,J,Z){Z.version=v("./version").version,v("native-promise-only"),v("../build/plotcss");for(var p=v("./registry"),g=Z.register=p.register,b=v("./plot_api"),y=Object.keys(b),e=0;e<y.length;e++){var n=y[e];n.charAt(0)!=="_"&&(Z[n]=b[n]),g({moduleType:"apiMethod",name:n,fn:b[n]})}g(v("./traces/scatter")),g([v("./components/legend"),v("./components/fx"),v("./components/annotations"),v("./components/annotations3d"),v("./components/selections"),v("./components/shapes"),v("./components/images"),v("./components/updatemenus"),v("./components/sliders"),v("./components/rangeslider"),v("./components/rangeselector"),v("./components/grid"),v("./components/errorbars"),v("./components/colorscale"),v("./components/colorbar"),v("./components/modebar")]),g([v("./locale-en"),v("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(g(window.PlotlyLocales),delete window.PlotlyLocales),Z.Icons=v("./fonts/ploticon");var t=v("./components/fx"),a=v("./plots/plots");Z.Plots={resize:a.resize,graphJson:a.graphJson,sendDataToCloud:a.sendDataToCloud},Z.Fx={hover:t.hover,unhover:t.unhover,loneHover:t.loneHover,loneUnhover:t.loneUnhover},Z.Snapshot=v("./snapshot"),Z.PlotSchema=v("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":358,"./components/annotations3d":363,"./components/colorbar":373,"./components/colorscale":379,"./components/errorbars":395,"./components/fx":407,"./components/grid":411,"./components/images":416,"./components/legend":424,"./components/modebar":430,"./components/rangeselector":438,"./components/rangeslider":445,"./components/selections":455,"./components/shapes":470,"./components/sliders":475,"./components/updatemenus":481,"./fonts/ploticon":494,"./locale-en":546,"./locale-en-us":545,"./plot_api":550,"./plot_api/plot_schema":554,"./plots/plots":628,"./registry":647,"./snapshot":652,"./traces/scatter":948,"./version":1132,"native-promise-only":245}],494:[function(v,J,Z){J.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:["<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'>","<defs>"," <style>","  .cls-0{fill:#000;}","  .cls-1{fill:#FFF;}","  .cls-2{fill:#F26;}","  .cls-3{fill:#D69;}","  .cls-4{fill:#BAC;}","  .cls-5{fill:#9EF;}"," </style>","</defs>"," <title>plotly-logomark</title>"," <g id='symbol'>","  <rect class='cls-0' x='0' y='0' width='132' height='132' rx='18' ry='18'/>","  <circle class='cls-5' cx='102' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='54' r='6'/>","  <circle class='cls-3' cx='54' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='54' r='6'/>","  <path class='cls-1' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>","  <path class='cls-1' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>","  <path class='cls-1' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>","  <path class='cls-1' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/>"," </g>","</svg>"].join("")}}},{}],495:[function(v,J,Z){Z.isLeftAnchor=function(p){return p.xanchor==="left"||p.xanchor==="auto"&&p.x<=1/3},Z.isCenterAnchor=function(p){return p.xanchor==="center"||p.xanchor==="auto"&&p.x>1/3&&p.x<2/3},Z.isRightAnchor=function(p){return p.xanchor==="right"||p.xanchor==="auto"&&p.x>=2/3},Z.isTopAnchor=function(p){return p.yanchor==="top"||p.yanchor==="auto"&&p.y>=2/3},Z.isMiddleAnchor=function(p){return p.yanchor==="middle"||p.yanchor==="auto"&&p.y>1/3&&p.y<2/3},Z.isBottomAnchor=function(p){return p.yanchor==="bottom"||p.yanchor==="auto"&&p.y<=1/3}},{}],496:[function(v,J,Z){var p=v("./mod"),g=p.mod,b=p.modHalf,y=Math.PI,e=2*y;function n(m){return Math.abs(m[1]-m[0])>e-1e-14}function t(m,o){return b(o-m,e)}function a(m,o){if(n(o))return!0;var i,u;o[0]<o[1]?(i=o[0],u=o[1]):(i=o[1],u=o[0]),(i=g(i,e))>(u=g(u,e))&&(u+=e);var f=g(m,e),l=f+e;return f>=i&&f<=u||l>=i&&l<=u}function r(m,o,i,u,f,l,h){f=f||0,l=l||0;var d,s,x,c,T,_=n([i,u]);function w(I,P){return[I*Math.cos(P)+f,l-I*Math.sin(P)]}_?(d=0,s=y,x=e):i<u?(d=i,x=u):(d=u,x=i),m<o?(c=m,T=o):(c=o,T=m);var k,L=Math.abs(x-d)<=y?0:1;function A(I,P,S){return"A"+[I,I]+" "+[0,L,S]+" "+w(I,P)}return _?k=c===null?"M"+w(T,d)+A(T,s,0)+A(T,x,0)+"Z":"M"+w(c,d)+A(c,s,0)+A(c,x,0)+"ZM"+w(T,d)+A(T,s,1)+A(T,x,1)+"Z":c===null?(k="M"+w(T,d)+A(T,x,0),h&&(k+="L0,0Z")):k="M"+w(c,d)+"L"+w(T,d)+A(T,x,0)+"L"+w(c,x)+A(c,d,1)+"Z",k}J.exports={deg2rad:function(m){return m/180*y},rad2deg:function(m){return m/y*180},angleDelta:t,angleDist:function(m,o){return Math.abs(t(m,o))},isFullCircle:n,isAngleInsideSector:a,isPtInsideSector:function(m,o,i,u){return!!a(o,u)&&(i[0]<i[1]?(f=i[0],l=i[1]):(f=i[1],l=i[0]),m>=f&&m<=l);var f,l},pathArc:function(m,o,i,u,f){return r(null,m,o,i,u,f,0)},pathSector:function(m,o,i,u,f){return r(null,m,o,i,u,f,1)},pathAnnulus:function(m,o,i,u,f,l){return r(m,o,i,u,f,l,1)}}},{"./mod":522}],497:[function(v,J,Z){var p=Array.isArray,g=ArrayBuffer,b=DataView;function y(t){return g.isView(t)&&!(t instanceof b)}function e(t){return p(t)||y(t)}function n(t,a,r){if(e(t)){if(e(t[0])){for(var m=r,o=0;o<t.length;o++)m=a(m,t[o].length);return m}return t.length}return 0}Z.isTypedArray=y,Z.isArrayOrTypedArray=e,Z.isArray1D=function(t){return!e(t[0])},Z.ensureArray=function(t,a){return p(t)||(t=[]),t.length=a,t},Z.concat=function(){var t,a,r,m,o,i,u,f,l=[],h=!0,d=0;for(r=0;r<arguments.length;r++)(i=(m=arguments[r]).length)&&(a?l.push(m):(a=m,o=i),p(m)?t=!1:(h=!1,d?t!==m.constructor&&(t=!1):t=m.constructor),d+=i);if(!d)return[];if(!l.length)return a;if(h)return a.concat.apply(a,l);if(t){for((u=new t(d)).set(a),r=0;r<l.length;r++)m=l[r],u.set(m,o),o+=m.length;return u}for(u=new Array(d),f=0;f<a.length;f++)u[f]=a[f];for(r=0;r<l.length;r++){for(m=l[r],f=0;f<m.length;f++)u[o+f]=m[f];o+=f}return u},Z.maxRowLength=function(t){return n(t,Math.max,0)},Z.minRowLength=function(t){return n(t,Math.min,1/0)}},{}],498:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../constants/numerical").BADNUM,b=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;J.exports=function(y){return typeof y=="string"&&(y=y.replace(b,"")),p(y)?Number(y):g}},{"../constants/numerical":491,"fast-isnumeric":190}],499:[function(v,J,Z){J.exports=function(p){var g=p._fullLayout;g._glcanvas&&g._glcanvas.size()&&g._glcanvas.each(function(b){b.regl&&b.regl.clear({color:!0,depth:!0})})}},{}],500:[function(v,J,Z){J.exports=function(p){p._responsiveChartHandler&&(window.removeEventListener("resize",p._responsiveChartHandler),delete p._responsiveChartHandler)}},{}],501:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("tinycolor2"),b=v("../plots/attributes"),y=v("../components/colorscale/scales"),e=v("../components/color"),n=v("../constants/interactions").DESELECTDIM,t=v("./nested_property"),a=v("./regex").counter,r=v("./mod").modHalf,m=v("./array").isArrayOrTypedArray;function o(i,u){var f=Z.valObjectMeta[u.valType];if(u.arrayOk&&m(i))return!0;if(f.validateFunction)return f.validateFunction(i,u);var l={},h=l,d={set:function(s){h=s}};return f.coerceFunction(i,d,l,u),h!==l}Z.valObjectMeta={data_array:{coerceFunction:function(i,u,f){m(i)?u.set(i):f!==void 0&&u.set(f)}},enumerated:{coerceFunction:function(i,u,f,l){l.coerceNumber&&(i=+i),l.values.indexOf(i)===-1?u.set(f):u.set(i)},validateFunction:function(i,u){u.coerceNumber&&(i=+i);for(var f=u.values,l=0;l<f.length;l++){var h=String(f[l]);if(h.charAt(0)==="/"&&h.charAt(h.length-1)==="/"){if(new RegExp(h.substr(1,h.length-2)).test(i))return!0}else if(i===f[l])return!0}return!1}},boolean:{coerceFunction:function(i,u,f){i===!0||i===!1?u.set(i):u.set(f)}},number:{coerceFunction:function(i,u,f,l){!p(i)||l.min!==void 0&&i<l.min||l.max!==void 0&&i>l.max?u.set(f):u.set(+i)}},integer:{coerceFunction:function(i,u,f,l){i%1||!p(i)||l.min!==void 0&&i<l.min||l.max!==void 0&&i>l.max?u.set(f):u.set(+i)}},string:{coerceFunction:function(i,u,f,l){if(typeof i!="string"){var h=typeof i=="number";l.strict!==!0&&h?u.set(String(i)):u.set(f)}else l.noBlank&&!i?u.set(f):u.set(i)}},color:{coerceFunction:function(i,u,f){g(i).isValid()?u.set(i):u.set(f)}},colorlist:{coerceFunction:function(i,u,f){Array.isArray(i)&&i.length&&i.every(function(l){return g(l).isValid()})?u.set(i):u.set(f)}},colorscale:{coerceFunction:function(i,u,f){u.set(y.get(i,f))}},angle:{coerceFunction:function(i,u,f){i==="auto"?u.set("auto"):p(i)?u.set(r(+i,360)):u.set(f)}},subplotid:{coerceFunction:function(i,u,f,l){var h=l.regex||a(f);typeof i=="string"&&h.test(i)?u.set(i):u.set(f)},validateFunction:function(i,u){var f=u.dflt;return i===f||typeof i=="string"&&!!a(f).test(i)}},flaglist:{coerceFunction:function(i,u,f,l){if((l.extras||[]).indexOf(i)===-1)if(typeof i=="string"){for(var h=i.split("+"),d=0;d<h.length;){var s=h[d];l.flags.indexOf(s)===-1||h.indexOf(s)<d?h.splice(d,1):d++}h.length?u.set(h.join("+")):u.set(f)}else u.set(f);else u.set(i)}},any:{coerceFunction:function(i,u,f){i===void 0?u.set(f):u.set(i)}},info_array:{coerceFunction:function(i,u,f,l){function h(E,D,R){var H,V={set:function(X){H=X}};return R===void 0&&(R=D.dflt),Z.valObjectMeta[D.valType].coerceFunction(E,V,R,D),H}var d=l.dimensions===2||l.dimensions==="1-2"&&Array.isArray(i)&&Array.isArray(i[0]);if(Array.isArray(i)){var s,x,c,T,_,w,k=l.items,L=[],A=Array.isArray(k),I=A&&d&&Array.isArray(k[0]),P=d&&A&&!I,S=A&&!P?k.length:i.length;if(f=Array.isArray(f)?f:[],d)for(s=0;s<S;s++)for(L[s]=[],c=Array.isArray(i[s])?i[s]:[],_=P?k.length:A?k[s].length:c.length,x=0;x<_;x++)T=P?k[x]:A?k[s][x]:k,(w=h(c[x],T,(f[s]||[])[x]))!==void 0&&(L[s][x]=w);else for(s=0;s<S;s++)(w=h(i[s],A?k[s]:k,f[s]))!==void 0&&(L[s]=w);u.set(L)}else u.set(f)},validateFunction:function(i,u){if(!Array.isArray(i))return!1;var f=u.items,l=Array.isArray(f),h=u.dimensions===2;if(!u.freeLength&&i.length!==f.length)return!1;for(var d=0;d<i.length;d++)if(h){if(!Array.isArray(i[d])||!u.freeLength&&i[d].length!==f[d].length)return!1;for(var s=0;s<i[d].length;s++)if(!o(i[d][s],l?f[d][s]:f))return!1}else if(!o(i[d],l?f[d]:f))return!1;return!0}}},Z.coerce=function(i,u,f,l,h){var d=t(f,l).get(),s=t(i,l),x=t(u,l),c=s.get(),T=u._template;if(c===void 0&&T&&(c=t(T,l).get(),T=0),h===void 0&&(h=d.dflt),d.arrayOk&&m(c))return x.set(c),c;var _=Z.valObjectMeta[d.valType].coerceFunction;_(c,x,h,d);var w=x.get();return T&&w===h&&!o(c,d)&&(_(c=t(T,l).get(),x,h,d),w=x.get()),w},Z.coerce2=function(i,u,f,l,h){var d=t(i,l),s=Z.coerce(i,u,f,l,h),x=d.get();return x!=null&&s},Z.coerceFont=function(i,u,f){var l={};return f=f||{},l.family=i(u+".family",f.family),l.size=i(u+".size",f.size),l.color=i(u+".color",f.color),l},Z.coercePattern=function(i,u,f,l){if(i(u+".shape")){i(u+".solidity"),i(u+".size");var h=i(u+".fillmode")==="overlay";if(!l){var d=i(u+".bgcolor",h?f:void 0);i(u+".fgcolor",h?e.contrast(d):f)}i(u+".fgopacity",h?.5:1)}},Z.coerceHoverinfo=function(i,u,f){var l,h=u._module.attributes,d=h.hoverinfo?h:b,s=d.hoverinfo;if(f._dataLength===1){var x=s.dflt==="all"?s.flags.slice():s.dflt.split("+");x.splice(x.indexOf("name"),1),l=x.join("+")}return Z.coerce(i,u,d,"hoverinfo",l)},Z.coerceSelectionMarkerOpacity=function(i,u){if(i.marker){var f,l,h=i.marker.opacity;h!==void 0&&(m(h)||i.selected||i.unselected||(f=h,l=n*h),u("selected.marker.opacity",f),u("unselected.marker.opacity",l))}},Z.validate=o},{"../components/color":367,"../components/colorscale/scales":382,"../constants/interactions":490,"../plots/attributes":562,"./array":497,"./mod":522,"./nested_property":523,"./regex":532,"fast-isnumeric":190,tinycolor2:313}],502:[function(v,J,Z){var p,g,b=v("d3-time-format").timeFormat,y=v("fast-isnumeric"),e=v("./loggers"),n=v("./mod").mod,t=v("../constants/numerical"),a=t.BADNUM,r=t.ONEDAY,m=t.ONEHOUR,o=t.ONEMIN,i=t.ONESEC,u=t.EPOCHJD,f=v("../registry"),l=v("d3-time-format").utcFormat,h=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,d=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,s=new Date().getFullYear()-70;function x(D){return D&&f.componentsRegistry.calendars&&typeof D=="string"&&D!=="gregorian"}function c(D,R){return String(D+Math.pow(10,R)).substr(1)}Z.dateTick0=function(D,R){var H=function(X,$){return x(X)?$?f.getComponentMethod("calendars","CANONICAL_SUNDAY")[X]:f.getComponentMethod("calendars","CANONICAL_TICK")[X]:$?"2000-01-02":"2000-01-01"}(D,!!R);if(R<2)return H;var V=Z.dateTime2ms(H,D);return V+=r*(R-1),Z.ms2DateTime(V,0,D)},Z.dfltRange=function(D){return x(D)?f.getComponentMethod("calendars","DFLTRANGE")[D]:["2000-01-01","2001-01-01"]},Z.isJSDate=function(D){return typeof D=="object"&&D!==null&&typeof D.getTime=="function"},Z.dateTime2ms=function(D,R){if(Z.isJSDate(D)){var H=D.getTimezoneOffset()*o,V=(D.getUTCMinutes()-D.getMinutes())*o+(D.getUTCSeconds()-D.getSeconds())*i+(D.getUTCMilliseconds()-D.getMilliseconds());if(V){var X=3*o;H=H-X/2+n(V-H+X/2,X)}return(D=Number(D)-H)>=p&&D<=g?D:a}if(typeof D!="string"&&typeof D!="number")return a;D=String(D);var $=x(R),G=D.charAt(0);!$||G!=="G"&&G!=="g"||(D=D.substr(1),R="");var W=$&&R.substr(0,7)==="chinese",te=D.match(W?d:h);if(!te)return a;var N=te[1],B=te[3]||"1",U=Number(te[5]||1),ee=Number(te[7]||0),j=Number(te[9]||0),Q=Number(te[11]||0);if($){if(N.length===2)return a;var K;N=Number(N);try{var re=f.getComponentMethod("calendars","getCal")(R);if(W){var ne=B.charAt(B.length-1)==="i";B=parseInt(B,10),K=re.newDate(N,re.toMonthIndex(N,B,ne),U)}else K=re.newDate(N,Number(B),U)}catch{return a}return K?(K.toJD()-u)*r+ee*m+j*o+Q*i:a}N=N.length===2?(Number(N)+2e3-s)%100+s:Number(N),B-=1;var le=new Date(Date.UTC(2e3,B,U,ee,j));return le.setUTCFullYear(N),le.getUTCMonth()!==B||le.getUTCDate()!==U?a:le.getTime()+Q*i},p=Z.MIN_MS=Z.dateTime2ms("-9999"),g=Z.MAX_MS=Z.dateTime2ms("9999-12-31 23:59:59.9999"),Z.isDateTime=function(D,R){return Z.dateTime2ms(D,R)!==a};var T=90*r,_=3*m,w=5*o;function k(D,R,H,V,X){if((R||H||V||X)&&(D+=" "+c(R,2)+":"+c(H,2),(V||X)&&(D+=":"+c(V,2),X))){for(var $=4;X%10==0;)$-=1,X/=10;D+="."+c(X,$)}return D}Z.ms2DateTime=function(D,R,H){if(typeof D!="number"||!(D>=p&&D<=g))return a;R||(R=0);var V,X,$,G,W,te,N=Math.floor(10*n(D+.05,1)),B=Math.round(D-N/10);if(x(H)){var U=Math.floor(B/r)+u,ee=Math.floor(n(D,r));try{V=f.getComponentMethod("calendars","getCal")(H).fromJD(U).formatDate("yyyy-mm-dd")}catch{V=l("G%Y-%m-%d")(new Date(B))}if(V.charAt(0)==="-")for(;V.length<11;)V="-0"+V.substr(1);else for(;V.length<10;)V="0"+V;X=R<T?Math.floor(ee/m):0,$=R<T?Math.floor(ee%m/o):0,G=R<_?Math.floor(ee%o/i):0,W=R<w?ee%i*10+N:0}else te=new Date(B),V=l("%Y-%m-%d")(te),X=R<T?te.getUTCHours():0,$=R<T?te.getUTCMinutes():0,G=R<_?te.getUTCSeconds():0,W=R<w?10*te.getUTCMilliseconds()+N:0;return k(V,X,$,G,W)},Z.ms2DateTimeLocal=function(D){if(!(D>=p+r&&D<=g-r))return a;var R=Math.floor(10*n(D+.05,1)),H=new Date(Math.round(D-R/10));return k(b("%Y-%m-%d")(H),H.getHours(),H.getMinutes(),H.getSeconds(),10*H.getUTCMilliseconds()+R)},Z.cleanDate=function(D,R,H){if(D===a)return R;if(Z.isJSDate(D)||typeof D=="number"&&isFinite(D)){if(x(H))return e.error("JS Dates and milliseconds are incompatible with world calendars",D),R;if(!(D=Z.ms2DateTimeLocal(+D))&&R!==void 0)return R}else if(!Z.isDateTime(D,H))return e.error("unrecognized date",D),R;return D};var L=/%\d?f/g,A=/%h/g,I={1:"1",2:"1",3:"2",4:"2"};function P(D,R,H,V){D=D.replace(L,function($){var G=Math.min(+$.charAt(1)||6,6);return(R/1e3%1+2).toFixed(G).substr(2).replace(/0+$/,"")||"0"});var X=new Date(Math.floor(R+.05));if(D=D.replace(A,function(){return I[H("%q")(X)]}),x(V))try{D=f.getComponentMethod("calendars","worldCalFmt")(D,R,V)}catch{return"Invalid"}return H(D)(X)}var S=[59,59.9,59.99,59.999,59.9999];Z.formatDate=function(D,R,H,V,X,$){if(X=x(X)&&X,!R)if(H==="y")R=$.year;else if(H==="m")R=$.month;else{if(H!=="d")return function(G,W){var te=n(G+.05,r),N=c(Math.floor(te/m),2)+":"+c(n(Math.floor(te/o),60),2);if(W!=="M"){y(W)||(W=0);var B=(100+Math.min(n(G/i,60),S[W])).toFixed(W).substr(1);W>0&&(B=B.replace(/0+$/,"").replace(/[\.]$/,"")),N+=":"+B}return N}(D,H)+`
`+P($.dayMonthYear,D,V,X);R=$.dayMonth+`
`+$.year}return P(R,D,V,X)};var E=3*r;Z.incrementMonth=function(D,R,H){H=x(H)&&H;var V=n(D,r);if(D=Math.round(D-V),H)try{var X=Math.round(D/r)+u,$=f.getComponentMethod("calendars","getCal")(H),G=$.fromJD(X);return R%12?$.add(G,R,"m"):$.add(G,R/12,"y"),(G.toJD()-u)*r+V}catch{e.error("invalid ms "+D+" in calendar "+H)}var W=new Date(D+E);return W.setUTCMonth(W.getUTCMonth()+R)+V-E},Z.findExactDates=function(D,R){for(var H,V,X=0,$=0,G=0,W=0,te=x(R)&&f.getComponentMethod("calendars","getCal")(R),N=0;N<D.length;N++)if(V=D[N],y(V)){if(!(V%r))if(te)try{(H=te.fromJD(V/r+u)).day()===1?H.month()===1?X++:$++:G++}catch{}else(H=new Date(V)).getUTCDate()===1?H.getUTCMonth()===0?X++:$++:G++}else W++;G+=$+=X;var B=D.length-W;return{exactYears:X/B,exactMonths:$/B,exactDays:G/B}}},{"../constants/numerical":491,"../registry":647,"./loggers":519,"./mod":522,"d3-time-format":120,"fast-isnumeric":190}],503:[function(v,J,Z){var p=v("@plotly/d3"),g=v("./loggers"),b=v("./matrix"),y=v("gl-mat4");function e(m){var o=m&&m.parentNode;o&&o.removeChild(m)}function n(m,o,i){var u="plotly.js-style-"+m,f=document.getElementById(u);f||((f=document.createElement("style")).setAttribute("id",u),f.appendChild(document.createTextNode("")),document.head.appendChild(f));var l=f.sheet;l.insertRule?l.insertRule(o+"{"+i+"}",0):l.addRule?l.addRule(o,i,0):g.warn("addStyleRule failed")}function t(m){var o=window.getComputedStyle(m,null),i=o.getPropertyValue("-webkit-transform")||o.getPropertyValue("-moz-transform")||o.getPropertyValue("-ms-transform")||o.getPropertyValue("-o-transform")||o.getPropertyValue("transform");return i==="none"?null:i.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(u){return+u})}function a(m){for(var o=[];r(m);)o.push(m),m=m.parentNode;return o}function r(m){return m&&(m instanceof Element||m instanceof HTMLElement)}J.exports={getGraphDiv:function(m){var o;if(typeof m=="string"){if((o=document.getElementById(m))===null)throw new Error("No DOM element with id '"+m+"' exists on the page.");return o}if(m==null)throw new Error("DOM element provided is null or undefined");return m},isPlotDiv:function(m){var o=p.select(m);return o.node()instanceof HTMLElement&&o.size()&&o.classed("js-plotly-plot")},removeElement:e,addStyleRule:function(m,o){n("global",m,o)},addRelatedStyleRule:n,deleteRelatedStyleRule:function(m){var o="plotly.js-style-"+m,i=document.getElementById(o);i&&e(i)},getFullTransformMatrix:function(m){var o=a(m),i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return o.forEach(function(u){var f=t(u);if(f){var l=b.convertCssMatrix(f);i=y.multiply(i,i,l)}}),i},getElementTransformMatrix:t,getElementAndAncestors:a,equalDomRects:function(m,o){return m&&o&&m.x===o.x&&m.y===o.y&&m.top===o.top&&m.left===o.left&&m.right===o.right&&m.bottom===o.bottom}}},{"./loggers":519,"./matrix":521,"@plotly/d3":58,"gl-mat4":210}],504:[function(v,J,Z){var p=v("events").EventEmitter,g={init:function(b){if(b._ev instanceof p)return b;var y=new p,e=new p;return b._ev=y,b._internalEv=e,b.on=y.on.bind(y),b.once=y.once.bind(y),b.removeListener=y.removeListener.bind(y),b.removeAllListeners=y.removeAllListeners.bind(y),b._internalOn=e.on.bind(e),b._internalOnce=e.once.bind(e),b._removeInternalListener=e.removeListener.bind(e),b._removeAllInternalListeners=e.removeAllListeners.bind(e),b.emit=function(n,t){typeof jQuery<"u"&&jQuery(b).trigger(n,t),y.emit(n,t),e.emit(n,t)},b},triggerHandler:function(b,y,e){var n,t;typeof jQuery<"u"&&(n=jQuery(b).triggerHandler(y,e));var a=b._ev;if(!a)return n;var r,m=a._events[y];if(!m)return n;function o(i){return i.listener?(a.removeListener(y,i.listener),i.fired?void 0:(i.fired=!0,i.listener.apply(a,[e]))):i.apply(a,[e])}for(m=Array.isArray(m)?m:[m],r=0;r<m.length-1;r++)o(m[r]);return t=o(m[r]),n!==void 0?n:t},purge:function(b){return delete b._ev,delete b.on,delete b.once,delete b.removeListener,delete b.removeAllListeners,delete b.emit,delete b._ev,delete b._internalEv,delete b._internalOn,delete b._internalOnce,delete b._removeInternalListener,delete b._removeAllInternalListeners,b}};J.exports=g},{events:84}],505:[function(v,J,Z){var p=v("./is_plain_object.js"),g=Array.isArray;function b(y,e,n,t){var a,r,m,o,i,u,f=y[0],l=y.length;if(l===2&&g(f)&&g(y[1])&&f.length===0){if(function(d,s){var x,c;for(x=0;x<d.length;x++){if((c=d[x])!==null&&typeof c=="object")return!1;c!==void 0&&(s[x]=c)}return!0}(y[1],f))return f;f.splice(0,f.length)}for(var h=1;h<l;h++)for(r in a=y[h])m=f[r],o=a[r],t&&g(o)?f[r]=o:e&&o&&(p(o)||(i=g(o)))?(i?(i=!1,u=m&&g(m)?m:[]):u=m&&p(m)?m:{},f[r]=b([u,o],e,n,t)):(o!==void 0||n)&&(f[r]=o);return f}Z.extendFlat=function(){return b(arguments,!1,!1,!1)},Z.extendDeep=function(){return b(arguments,!0,!1,!1)},Z.extendDeepAll=function(){return b(arguments,!0,!0,!1)},Z.extendDeepNoArrays=function(){return b(arguments,!0,!1,!0)}},{"./is_plain_object.js":516}],506:[function(v,J,Z){J.exports=function(p){for(var g={},b=[],y=0,e=0;e<p.length;e++){var n=p[e];g[n]!==1&&(g[n]=1,b[y++]=n)}return b}},{}],507:[function(v,J,Z){function p(b){return b.visible===!0}function g(b){var y=b[0].trace;return y.visible===!0&&y._length!==0}J.exports=function(b){for(var y,e=(y=b,Array.isArray(y)&&Array.isArray(y[0])&&y[0][0]&&y[0][0].trace?g:p),n=[],t=0;t<b.length;t++){var a=b[t];e(a)&&n.push(a)}return n}},{}],508:[function(v,J,Z){var p=v("@plotly/d3"),g=v("country-regex"),b=v("@turf/area"),y=v("@turf/centroid"),e=v("@turf/bbox"),n=v("./identity"),t=v("./loggers"),a=v("./is_plain_object"),r=v("./nested_property"),m=v("./polygon"),o=Object.keys(g),i={"ISO-3":n,"USA-states":n,"country names":function(f){for(var l=0;l<o.length;l++){var h=o[l];if(new RegExp(g[h]).test(f.trim().toLowerCase()))return h}return t.log("Unrecognized country name: "+f+"."),!1}};function u(f){var l=f.geojson,h=window.PlotlyGeoAssets||{},d=typeof l=="string"?h[l]:l;return a(d)?d:(t.error("Oops ... something went wrong when fetching "+l),!1)}J.exports={locationToFeature:function(f,l,h){if(!l||typeof l!="string")return!1;var d,s,x,c=i[f](l);if(c){if(f==="USA-states")for(d=[],x=0;x<h.length;x++)(s=h[x]).properties&&s.properties.gu&&s.properties.gu==="USA"&&d.push(s);else d=h;for(x=0;x<d.length;x++)if((s=d[x]).id===c)return s;t.log(["Location with id",c,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(f){var l,h,d,s,x=f.geometry,c=x.coordinates,T=f.id,_=[];function w(k){for(var L=0;L<k.length-1;L++)if(k[L][0]>0&&k[L+1][0]<0)return L;return null}switch(l=T==="RUS"||T==="FJI"?function(k){var L;if(w(k)===null)L=k;else for(L=new Array(k.length),s=0;s<k.length;s++)L[s]=[k[s][0]<0?k[s][0]+360:k[s][0],k[s][1]];_.push(m.tester(L))}:T==="ATA"?function(k){var L=w(k);if(L===null)return _.push(m.tester(k));var A=new Array(k.length+1),I=0;for(s=0;s<k.length;s++)s>L?A[I++]=[k[s][0]+360,k[s][1]]:s===L?(A[I++]=k[s],A[I++]=[k[s][0],-90]):A[I++]=k[s];var P=m.tester(A);P.pts.pop(),_.push(P)}:function(k){_.push(m.tester(k))},x.type){case"MultiPolygon":for(h=0;h<c.length;h++)for(d=0;d<c[h].length;d++)l(c[h][d]);break;case"Polygon":for(h=0;h<c.length;h++)l(c[h])}return _},getTraceGeojson:u,extractTraceFeature:function(f){var l=f[0].trace,h=u(l);if(!h)return!1;var d,s={},x=[];for(d=0;d<l._length;d++){var c=f[d];(c.loc||c.loc===0)&&(s[c.loc]=c)}function T(k){var L=r(k,l.featureidkey||"id").get(),A=s[L];if(A){var I=k.geometry;if(I.type==="Polygon"||I.type==="MultiPolygon"){var P={type:"Feature",id:L,geometry:I,properties:{}};P.properties.ct=function(S){var E,D=S.geometry;if(D.type==="MultiPolygon")for(var R=D.coordinates,H=0,V=0;V<R.length;V++){var X={type:"Polygon",coordinates:R[V]},$=b.default(X);$>H&&(H=$,E=X)}else E=D;return y.default(E).geometry.coordinates}(P),A.fIn=k,A.fOut=P,x.push(P)}else t.log(["Location",A.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete s[L]}switch(h.type){case"FeatureCollection":var _=h.features;for(d=0;d<_.length;d++)T(_[d]);break;case"Feature":T(h);break;default:return t.warn(["Invalid GeoJSON type",(h.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var w in s)t.log(["Location *"+w+"*","does not have a matching feature with id-key","*"+l.featureidkey+"*."].join(" "));return x},fetchTraceGeoData:function(f){var l=window.PlotlyGeoAssets||{},h=[];function d(T){return new Promise(function(_,w){p.json(T,function(k,L){if(k){delete l[T];var A=k.status===404?'GeoJSON at URL "'+T+'" does not exist.':"Unexpected error while fetching from "+T;return w(new Error(A))}return l[T]=L,_(L)})})}function s(T){return new Promise(function(_,w){var k=0,L=setInterval(function(){return l[T]&&l[T]!=="pending"?(clearInterval(L),_(l[T])):k>100?(clearInterval(L),w("Unexpected error while fetching from "+T)):void k++},50)})}for(var x=0;x<f.length;x++){var c=f[x][0].trace.geojson;typeof c=="string"&&(l[c]?l[c]==="pending"&&h.push(s(c)):(l[c]="pending",h.push(d(c))))}return h},computeBbox:function(f){return e.default(f)}}},{"./identity":513,"./is_plain_object":516,"./loggers":519,"./nested_property":523,"./polygon":527,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],509:[function(v,J,Z){var p=v("../constants/numerical").BADNUM;Z.calcTraceToLineCoords=function(g){for(var b=g[0].trace.connectgaps,y=[],e=[],n=0;n<g.length;n++){var t=g[n].lonlat;t[0]!==p?e.push(t):!b&&e.length>0&&(y.push(e),e=[])}return e.length>0&&y.push(e),y},Z.makeLine=function(g){return g.length===1?{type:"LineString",coordinates:g[0]}:{type:"MultiLineString",coordinates:g}},Z.makePolygon=function(g){if(g.length===1)return{type:"Polygon",coordinates:g};for(var b=new Array(g.length),y=0;y<g.length;y++)b[y]=[g[y]];return{type:"MultiPolygon",coordinates:b}},Z.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":491}],510:[function(v,J,Z){var p,g,b,y=v("./mod").mod;function e(t,a,r,m,o,i,u,f){var l=r-t,h=o-t,d=u-o,s=m-a,x=i-a,c=f-i,T=l*c-d*s;if(T===0)return null;var _=(h*c-d*x)/T,w=(h*s-l*x)/T;return w<0||w>1||_<0||_>1?null:{x:t+l*_,y:a+s*_}}function n(t,a,r,m,o){var i=m*t+o*a;if(i<0)return m*m+o*o;if(i>r){var u=m-t,f=o-a;return u*u+f*f}var l=m*a-o*t;return l*l/r}Z.segmentsIntersect=e,Z.segmentDistance=function(t,a,r,m,o,i,u,f){if(e(t,a,r,m,o,i,u,f))return 0;var l=r-t,h=m-a,d=u-o,s=f-i,x=l*l+h*h,c=d*d+s*s,T=Math.min(n(l,h,x,o-t,i-a),n(l,h,x,u-t,f-a),n(d,s,c,t-o,a-i),n(d,s,c,r-o,m-i));return Math.sqrt(T)},Z.getTextLocation=function(t,a,r,m){if(t===g&&m===b||(p={},g=t,b=m),p[r])return p[r];var o=t.getPointAtLength(y(r-m/2,a)),i=t.getPointAtLength(y(r+m/2,a)),u=Math.atan((i.y-o.y)/(i.x-o.x)),f=t.getPointAtLength(y(r,a)),l={x:(4*f.x+o.x+i.x)/6,y:(4*f.y+o.y+i.y)/6,theta:u};return p[r]=l,l},Z.clearLocationCache=function(){g=null},Z.getVisibleSegment=function(t,a,r){var m,o,i=a.left,u=a.right,f=a.top,l=a.bottom,h=0,d=t.getTotalLength(),s=d;function x(T){var _=t.getPointAtLength(T);T===0?m=_:T===d&&(o=_);var w=_.x<i?i-_.x:_.x>u?_.x-u:0,k=_.y<f?f-_.y:_.y>l?_.y-l:0;return Math.sqrt(w*w+k*k)}for(var c=x(h);c;){if((h+=c+r)>s)return;c=x(h)}for(c=x(s);c;){if(h>(s-=c+r))return;c=x(s)}return{min:h,max:s,len:s-h,total:d,isClosed:h===0&&s===d&&Math.abs(m.x-o.x)<.1&&Math.abs(m.y-o.y)<.1}},Z.findPointOnPath=function(t,a,r,m){for(var o,i,u,f=(m=m||{}).pathLength||t.getTotalLength(),l=m.tolerance||.001,h=m.iterationLimit||30,d=t.getPointAtLength(0)[r]>t.getPointAtLength(f)[r]?-1:1,s=0,x=0,c=f;s<h;){if(o=(x+c)/2,u=(i=t.getPointAtLength(o))[r]-a,Math.abs(u)<l)return i;d*u>0?c=o:x=o,s++}return i}},{"./mod":522}],511:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("tinycolor2"),b=v("color-normalize"),y=v("../components/colorscale"),e=v("../components/color/attributes").defaultLine,n=v("./array").isArrayOrTypedArray,t=b(e);function a(o,i){var u=o;return u[3]*=i,u}function r(o){if(p(o))return t;var i=b(o);return i.length?i:t}function m(o){return p(o)?o:1}J.exports={formatColor:function(o,i,u){var f,l,h,d,s,x=o.color,c=n(x),T=n(i),_=y.extractOpts(o),w=[];if(f=_.colorscale!==void 0?y.makeColorScaleFuncFromTrace(o):r,l=c?function(L,A){return L[A]===void 0?t:b(f(L[A]))}:r,h=T?function(L,A){return L[A]===void 0?1:m(L[A])}:m,c||T)for(var k=0;k<u;k++)d=l(x,k),s=h(i,k),w[k]=a(d,s);else w=a(b(x),i);return w},parseColorScale:function(o){var i=y.extractOpts(o),u=i.colorscale;return i.reversescale&&(u=y.flipScale(i.colorscale)),u.map(function(f){var l=f[0],h=g(f[1]).toRgb();return{index:l,rgb:[h.r,h.g,h.b,h.a]}})}}},{"../components/color/attributes":366,"../components/colorscale":379,"./array":497,"color-normalize":89,"fast-isnumeric":190,tinycolor2:313}],512:[function(v,J,Z){var p=v("./identity");function g(b){return[b]}J.exports={keyFun:function(b){return b.key},repeat:g,descend:p,wrap:g,unwrap:function(b){return b[0]}}},{"./identity":513}],513:[function(v,J,Z){J.exports=function(p){return p}},{}],514:[function(v,J,Z){J.exports=function(p,g){if(!g)return p;var b=1/Math.abs(g),y=b>1?(b*p+b*g)/b:p+g,e=String(y).length;if(e>16){var n=String(g).length;if(e>=String(p).length+n){var t=parseFloat(y).toPrecision(12);t.indexOf("e+")===-1&&(y=+t)}}return y}},{}],515:[function(v,J,Z){var p=v("@plotly/d3"),g=v("d3-time-format").utcFormat,b=v("d3-format").format,y=v("fast-isnumeric"),e=v("../constants/numerical"),n=e.FP_SAFE,t=-n,a=e.BADNUM,r=J.exports={};r.adjustFormat=function(N){return!N||/^\d[.]\df/.test(N)||/[.]\d%/.test(N)?N:N==="0.f"?"~f":/^\d%/.test(N)?"~%":/^\ds/.test(N)?"~s":!/^[~,.0$]/.test(N)&&/[&fps]/.test(N)?"~"+N:N};var m={};r.warnBadFormat=function(N){var B=String(N);m[B]||(m[B]=1,r.warn('encountered bad format: "'+B+'"'))},r.noFormat=function(N){return String(N)},r.numberFormat=function(N){var B;try{B=b(r.adjustFormat(N))}catch{return r.warnBadFormat(N),r.noFormat}return B},r.nestedProperty=v("./nested_property"),r.keyedContainer=v("./keyed_container"),r.relativeAttr=v("./relative_attr"),r.isPlainObject=v("./is_plain_object"),r.toLogRange=v("./to_log_range"),r.relinkPrivateKeys=v("./relink_private");var o=v("./array");r.isTypedArray=o.isTypedArray,r.isArrayOrTypedArray=o.isArrayOrTypedArray,r.isArray1D=o.isArray1D,r.ensureArray=o.ensureArray,r.concat=o.concat,r.maxRowLength=o.maxRowLength,r.minRowLength=o.minRowLength;var i=v("./mod");r.mod=i.mod,r.modHalf=i.modHalf;var u=v("./coerce");r.valObjectMeta=u.valObjectMeta,r.coerce=u.coerce,r.coerce2=u.coerce2,r.coerceFont=u.coerceFont,r.coercePattern=u.coercePattern,r.coerceHoverinfo=u.coerceHoverinfo,r.coerceSelectionMarkerOpacity=u.coerceSelectionMarkerOpacity,r.validate=u.validate;var f=v("./dates");r.dateTime2ms=f.dateTime2ms,r.isDateTime=f.isDateTime,r.ms2DateTime=f.ms2DateTime,r.ms2DateTimeLocal=f.ms2DateTimeLocal,r.cleanDate=f.cleanDate,r.isJSDate=f.isJSDate,r.formatDate=f.formatDate,r.incrementMonth=f.incrementMonth,r.dateTick0=f.dateTick0,r.dfltRange=f.dfltRange,r.findExactDates=f.findExactDates,r.MIN_MS=f.MIN_MS,r.MAX_MS=f.MAX_MS;var l=v("./search");r.findBin=l.findBin,r.sorterAsc=l.sorterAsc,r.sorterDes=l.sorterDes,r.distinctVals=l.distinctVals,r.roundUp=l.roundUp,r.sort=l.sort,r.findIndexOfMin=l.findIndexOfMin,r.sortObjectKeys=v("./sort_object_keys");var h=v("./stats");r.aggNums=h.aggNums,r.len=h.len,r.mean=h.mean,r.median=h.median,r.midRange=h.midRange,r.variance=h.variance,r.stdev=h.stdev,r.interp=h.interp;var d=v("./matrix");r.init2dArray=d.init2dArray,r.transposeRagged=d.transposeRagged,r.dot=d.dot,r.translationMatrix=d.translationMatrix,r.rotationMatrix=d.rotationMatrix,r.rotationXYMatrix=d.rotationXYMatrix,r.apply3DTransform=d.apply3DTransform,r.apply2DTransform=d.apply2DTransform,r.apply2DTransform2=d.apply2DTransform2,r.convertCssMatrix=d.convertCssMatrix,r.inverseTransformMatrix=d.inverseTransformMatrix;var s=v("./angles");r.deg2rad=s.deg2rad,r.rad2deg=s.rad2deg,r.angleDelta=s.angleDelta,r.angleDist=s.angleDist,r.isFullCircle=s.isFullCircle,r.isAngleInsideSector=s.isAngleInsideSector,r.isPtInsideSector=s.isPtInsideSector,r.pathArc=s.pathArc,r.pathSector=s.pathSector,r.pathAnnulus=s.pathAnnulus;var x=v("./anchor_utils");r.isLeftAnchor=x.isLeftAnchor,r.isCenterAnchor=x.isCenterAnchor,r.isRightAnchor=x.isRightAnchor,r.isTopAnchor=x.isTopAnchor,r.isMiddleAnchor=x.isMiddleAnchor,r.isBottomAnchor=x.isBottomAnchor;var c=v("./geometry2d");r.segmentsIntersect=c.segmentsIntersect,r.segmentDistance=c.segmentDistance,r.getTextLocation=c.getTextLocation,r.clearLocationCache=c.clearLocationCache,r.getVisibleSegment=c.getVisibleSegment,r.findPointOnPath=c.findPointOnPath;var T=v("./extend");r.extendFlat=T.extendFlat,r.extendDeep=T.extendDeep,r.extendDeepAll=T.extendDeepAll,r.extendDeepNoArrays=T.extendDeepNoArrays;var _=v("./loggers");r.log=_.log,r.warn=_.warn,r.error=_.error;var w=v("./regex");r.counterRegex=w.counter;var k=v("./throttle");r.throttle=k.throttle,r.throttleDone=k.done,r.clearThrottle=k.clear;var L=v("./dom");function A(N){var B={};for(var U in N)for(var ee=N[U],j=0;j<ee.length;j++)B[ee[j]]=+U;return B}r.getGraphDiv=L.getGraphDiv,r.isPlotDiv=L.isPlotDiv,r.removeElement=L.removeElement,r.addStyleRule=L.addStyleRule,r.addRelatedStyleRule=L.addRelatedStyleRule,r.deleteRelatedStyleRule=L.deleteRelatedStyleRule,r.getFullTransformMatrix=L.getFullTransformMatrix,r.getElementTransformMatrix=L.getElementTransformMatrix,r.getElementAndAncestors=L.getElementAndAncestors,r.equalDomRects=L.equalDomRects,r.clearResponsive=v("./clear_responsive"),r.preserveDrawingBuffer=v("./preserve_drawing_buffer"),r.makeTraceGroups=v("./make_trace_groups"),r._=v("./localize"),r.notifier=v("./notifier"),r.filterUnique=v("./filter_unique"),r.filterVisible=v("./filter_visible"),r.pushUnique=v("./push_unique"),r.increment=v("./increment"),r.cleanNumber=v("./clean_number"),r.ensureNumber=function(N){return y(N)?(N=Number(N))>n||N<t?a:N:a},r.isIndex=function(N,B){return!(B!==void 0&&N>=B)&&y(N)&&N>=0&&N%1==0},r.noop=v("./noop"),r.identity=v("./identity"),r.repeat=function(N,B){for(var U=new Array(B),ee=0;ee<B;ee++)U[ee]=N;return U},r.swapAttrs=function(N,B,U,ee){U||(U="x"),ee||(ee="y");for(var j=0;j<B.length;j++){var Q=B[j],K=r.nestedProperty(N,Q.replace("?",U)),re=r.nestedProperty(N,Q.replace("?",ee)),ne=K.get();K.set(re.get()),re.set(ne)}},r.raiseToTop=function(N){N.parentNode.appendChild(N)},r.cancelTransition=function(N){return N.transition().duration(0)},r.constrain=function(N,B,U){return B>U?Math.max(U,Math.min(B,N)):Math.max(B,Math.min(U,N))},r.bBoxIntersect=function(N,B,U){return U=U||0,N.left<=B.right+U&&B.left<=N.right+U&&N.top<=B.bottom+U&&B.top<=N.bottom+U},r.simpleMap=function(N,B,U,ee,j){for(var Q=N.length,K=new Array(Q),re=0;re<Q;re++)K[re]=B(N[re],U,ee,j);return K},r.randstr=function N(B,U,ee,j){if(ee||(ee=16),U===void 0&&(U=24),U<=0)return"0";var Q,K,re=Math.log(Math.pow(2,U))/Math.log(ee),ne="";for(Q=2;re===1/0;Q*=2)re=Math.log(Math.pow(2,U/Q))/Math.log(ee)*Q;var le=re-Math.floor(re);for(Q=0;Q<Math.floor(re);Q++)ne=Math.floor(Math.random()*ee).toString(ee)+ne;le&&(K=Math.pow(ee,le),ne=Math.floor(Math.random()*K).toString(ee)+ne);var oe=parseInt(ne,ee);return B&&B[ne]||oe!==1/0&&oe>=Math.pow(2,U)?j>10?(r.warn("randstr failed uniqueness"),ne):N(B,U,ee,(j||0)+1):ne},r.OptionControl=function(N,B){N||(N={}),B||(B="opt");var U={optionList:[],_newoption:function(ee){ee[B]=N,U[ee.name]=ee,U.optionList.push(ee)}};return U["_"+B]=N,U},r.smooth=function(N,B){if((B=Math.round(B)||0)<2)return N;var U,ee,j,Q,K=N.length,re=2*K,ne=2*B-1,le=new Array(ne),oe=new Array(K);for(U=0;U<ne;U++)le[U]=(1-Math.cos(Math.PI*(U+1)/B))/(2*B);for(U=0;U<K;U++){for(Q=0,ee=0;ee<ne;ee++)(j=U+ee+1-B)<-K?j-=re*Math.round(j/re):j>=re&&(j-=re*Math.floor(j/re)),j<0?j=-1-j:j>=K&&(j=re-1-j),Q+=N[j]*le[ee];oe[U]=Q}return oe},r.syncOrAsync=function(N,B,U){var ee;function j(){return r.syncOrAsync(N,B,U)}for(;N.length;)if((ee=(0,N.splice(0,1)[0])(B))&&ee.then)return ee.then(j);return U&&U(B)},r.stripTrailingSlash=function(N){return N.substr(-1)==="/"?N.substr(0,N.length-1):N},r.noneOrAll=function(N,B,U){if(N){var ee,j=!1,Q=!0;for(ee=0;ee<U.length;ee++)N[U[ee]]!=null?j=!0:Q=!1;if(j&&!Q)for(ee=0;ee<U.length;ee++)N[U[ee]]=B[U[ee]]}},r.mergeArray=function(N,B,U,ee){var j=typeof ee=="function";if(r.isArrayOrTypedArray(N))for(var Q=Math.min(N.length,B.length),K=0;K<Q;K++){var re=N[K];B[K][U]=j?ee(re):re}},r.mergeArrayCastPositive=function(N,B,U){return r.mergeArray(N,B,U,function(ee){var j=+ee;return isFinite(j)&&j>0?j:0})},r.fillArray=function(N,B,U,ee){if(ee=ee||r.identity,r.isArrayOrTypedArray(N))for(var j=0;j<B.length;j++)B[j][U]=ee(N[j])},r.castOption=function(N,B,U,ee){ee=ee||r.identity;var j=r.nestedProperty(N,U).get();return r.isArrayOrTypedArray(j)?Array.isArray(B)&&r.isArrayOrTypedArray(j[B[0]])?ee(j[B[0]][B[1]]):ee(j[B]):j},r.extractOption=function(N,B,U,ee){if(U in N)return N[U];var j=r.nestedProperty(B,ee).get();return Array.isArray(j)?void 0:j},r.tagSelected=function(N,B,U){var ee,j,Q=B.selectedpoints,K=B._indexToPoints;K&&(ee=A(K));for(var re=0;re<Q.length;re++){var ne=Q[re];if(r.isIndex(ne)||r.isArrayOrTypedArray(ne)&&r.isIndex(ne[0])&&r.isIndex(ne[1])){var le=ee?ee[ne]:ne,oe=U?U[le]:le;(j=oe)!==void 0&&j<N.length&&(N[oe].selected=1)}}},r.selIndices2selPoints=function(N){var B=N.selectedpoints,U=N._indexToPoints;if(U){for(var ee=A(U),j=[],Q=0;Q<B.length;Q++){var K=B[Q];if(r.isIndex(K)){var re=ee[K];r.isIndex(re)&&j.push(re)}}return j}return B},r.getTargetArray=function(N,B){var U=B.target;if(typeof U=="string"&&U){var ee=r.nestedProperty(N,U).get();return!!Array.isArray(ee)&&ee}return!!Array.isArray(U)&&U},r.minExtend=function(N,B){var U={};typeof B!="object"&&(B={});var ee,j,Q,K=Object.keys(N);for(ee=0;ee<K.length;ee++)Q=N[j=K[ee]],j.charAt(0)!=="_"&&typeof Q!="function"&&(j==="module"?U[j]=Q:Array.isArray(Q)?U[j]=j==="colorscale"?Q.slice():Q.slice(0,3):r.isTypedArray(Q)?U[j]=Q.subarray(0,3):U[j]=Q&&typeof Q=="object"?r.minExtend(N[j],B[j]):Q);for(K=Object.keys(B),ee=0;ee<K.length;ee++)typeof(Q=B[j=K[ee]])=="object"&&j in U&&typeof U[j]=="object"||(U[j]=Q);return U},r.titleCase=function(N){return N.charAt(0).toUpperCase()+N.substr(1)},r.containsAny=function(N,B){for(var U=0;U<B.length;U++)if(N.indexOf(B[U])!==-1)return!0;return!1},r.isIE=function(){return window.navigator.msSaveBlob!==void 0};var I=/Version\/[\d\.]+.*Safari/;r.isSafari=function(){return I.test(window.navigator.userAgent)};var P=/iPad|iPhone|iPod/;r.isIOS=function(){return P.test(window.navigator.userAgent)};var S=/Firefox\/(\d+)\.\d+/;r.getFirefoxVersion=function(){var N=S.exec(window.navigator.userAgent);if(N&&N.length===2){var B=parseInt(N[1]);if(!isNaN(B))return B}return null},r.isD3Selection=function(N){return N instanceof p.selection},r.ensureSingle=function(N,B,U,ee){var j=N.select(B+(U?"."+U:""));if(j.size())return j;var Q=N.append(B);return U&&Q.classed(U,!0),ee&&Q.call(ee),Q},r.ensureSingleById=function(N,B,U,ee){var j=N.select(B+"#"+U);if(j.size())return j;var Q=N.append(B).attr("id",U);return ee&&Q.call(ee),Q},r.objectFromPath=function(N,B){for(var U,ee=N.split("."),j=U={},Q=0;Q<ee.length;Q++){var K=ee[Q],re=null,ne=ee[Q].match(/(.*)\[([0-9]+)\]/);ne?(K=ne[1],re=ne[2],U=U[K]=[],Q===ee.length-1?U[re]=B:U[re]={},U=U[re]):(Q===ee.length-1?U[K]=B:U[K]={},U=U[K])}return j};var E=/^([^\[\.]+)\.(.+)?/,D=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;r.expandObjectPaths=function(N){var B,U,ee,j,Q,K,re;if(typeof N=="object"&&!Array.isArray(N))for(U in N)N.hasOwnProperty(U)&&((B=U.match(E))?(j=N[U],ee=B[1],delete N[U],N[ee]=r.extendDeepNoArrays(N[ee]||{},r.objectFromPath(U,r.expandObjectPaths(j))[ee])):(B=U.match(D))?(j=N[U],ee=B[1],Q=parseInt(B[2]),delete N[U],N[ee]=N[ee]||[],B[3]==="."?(re=B[4],K=N[ee][Q]=N[ee][Q]||{},r.extendDeepNoArrays(K,r.objectFromPath(re,r.expandObjectPaths(j)))):N[ee][Q]=r.expandObjectPaths(j)):N[U]=r.expandObjectPaths(N[U]));return N},r.numSeparate=function(N,B,U){if(U||(U=!1),typeof B!="string"||B.length===0)throw new Error("Separator string required for formatting!");typeof N=="number"&&(N=String(N));var ee=/(\d+)(\d{3})/,j=B.charAt(0),Q=B.charAt(1),K=N.split("."),re=K[0],ne=K.length>1?j+K[1]:"";if(Q&&(K.length>1||re.length>4||U))for(;ee.test(re);)re=re.replace(ee,"$1"+Q+"$2");return re+ne},r.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var R=/^\w*$/;r.templateString=function(N,B){var U={};return N.replace(r.TEMPLATE_STRING_REGEX,function(ee,j){var Q;return R.test(j)?Q=B[j]:(U[j]=U[j]||r.nestedProperty(B,j).get,Q=U[j]()),r.isValidTextValue(Q)?Q:""})};var H={max:10,count:0,name:"hovertemplate"};r.hovertemplateString=function(){return $.apply(H,arguments)};var V={max:10,count:0,name:"texttemplate"};r.texttemplateString=function(){return $.apply(V,arguments)};var X=/^[:|\|]/;function $(N,B,U){var ee=this,j=arguments;B||(B={});var Q={};return N.replace(r.TEMPLATE_STRING_REGEX,function(K,re,ne){var le,oe,de,se=re==="_xother"||re==="_yother",me=re==="_xother_"||re==="_yother_",Te=re==="xother_"||re==="yother_",_e=re==="xother"||re==="yother"||se||Te||me,be=re;if((se||me)&&(be=be.substring(1)),(Te||me)&&(be=be.substring(0,be.length-1)),_e){if((le=B[be])===void 0)return""}else for(de=3;de<j.length;de++)if(oe=j[de]){if(oe.hasOwnProperty(be)){le=oe[be];break}if(R.test(be)||(le=r.nestedProperty(oe,be).get(),(le=Q[be]||r.nestedProperty(oe,be).get())&&(Q[be]=le)),le!==void 0)break}if(le===void 0&&ee)return ee.count<ee.max&&(r.warn("Variable '"+be+"' in "+ee.name+" could not be found!"),le=K),ee.count===ee.max&&r.warn("Too many "+ee.name+" warnings - additional warnings will be suppressed"),ee.count++,K;if(ne){var Ce;if(ne[0]===":"&&(le=(Ce=U?U.numberFormat:r.numberFormat)(ne.replace(X,""))(le)),ne[0]==="|"){Ce=U?U.timeFormat:g;var fe=r.dateTime2ms(le);le=r.formatDate(fe,ne.replace(X,""),!1,Ce)}}else{var ve=be+"Label";B.hasOwnProperty(ve)&&(le=B[ve])}return _e&&(le="("+le+")",(se||me)&&(le=" "+le),(Te||me)&&(le+=" ")),le})}r.subplotSort=function(N,B){for(var U=Math.min(N.length,B.length)+1,ee=0,j=0,Q=0;Q<U;Q++){var K=N.charCodeAt(Q)||0,re=B.charCodeAt(Q)||0,ne=K>=48&&K<=57,le=re>=48&&re<=57;if(ne&&(ee=10*ee+K-48),le&&(j=10*j+re-48),!ne||!le){if(ee!==j)return ee-j;if(K!==re)return K-re}}return j-ee};var G=2e9;r.seedPseudoRandom=function(){G=2e9},r.pseudoRandom=function(){var N=G;return G=(69069*G+1)%4294967296,Math.abs(G-N)<429496729?r.pseudoRandom():G/4294967296},r.fillText=function(N,B,U){var ee=Array.isArray(U)?function(K){U.push(K)}:function(K){U.text=K},j=r.extractOption(N,B,"htx","hovertext");if(r.isValidTextValue(j))return ee(j);var Q=r.extractOption(N,B,"tx","text");return r.isValidTextValue(Q)?ee(Q):void 0},r.isValidTextValue=function(N){return N||N===0},r.formatPercent=function(N,B){B=B||0;for(var U=(Math.round(100*N*Math.pow(10,B))*Math.pow(.1,B)).toFixed(B)+"%",ee=0;ee<B;ee++)U.indexOf(".")!==-1&&(U=(U=U.replace("0%","%")).replace(".%","%"));return U},r.isHidden=function(N){var B=window.getComputedStyle(N).display;return!B||B==="none"},r.strTranslate=function(N,B){return N||B?"translate("+N+","+B+")":""},r.strRotate=function(N){return N?"rotate("+N+")":""},r.strScale=function(N){return N!==1?"scale("+N+")":""},r.getTextTransform=function(N){var B=N.noCenter,U=N.textX,ee=N.textY,j=N.targetX,Q=N.targetY,K=N.anchorX||0,re=N.anchorY||0,ne=N.rotate,le=N.scale;return le?le>1&&(le=1):le=0,r.strTranslate(j-le*(U+K),Q-le*(ee+re))+r.strScale(le)+(ne?"rotate("+ne+(B?"":" "+U+" "+ee)+")":"")},r.ensureUniformFontSize=function(N,B){var U=r.extendFlat({},B);return U.size=Math.max(B.size,N._fullLayout.uniformtext.minsize||0),U},r.join2=function(N,B,U){var ee=N.length;return ee>1?N.slice(0,-1).join(B)+U+N[ee-1]:N.join(B)},r.bigFont=function(N){return Math.round(1.2*N)};var W=r.getFirefoxVersion(),te=W!==null&&W<86;r.getPositionFromD3Event=function(){return te?[p.event.layerX,p.event.layerY]:[p.event.offsetX,p.event.offsetY]}},{"../constants/numerical":491,"./anchor_utils":495,"./angles":496,"./array":497,"./clean_number":498,"./clear_responsive":500,"./coerce":501,"./dates":502,"./dom":503,"./extend":505,"./filter_unique":506,"./filter_visible":507,"./geometry2d":510,"./identity":513,"./increment":514,"./is_plain_object":516,"./keyed_container":517,"./localize":518,"./loggers":519,"./make_trace_groups":520,"./matrix":521,"./mod":522,"./nested_property":523,"./noop":524,"./notifier":525,"./preserve_drawing_buffer":529,"./push_unique":530,"./regex":532,"./relative_attr":533,"./relink_private":534,"./search":535,"./sort_object_keys":538,"./stats":539,"./throttle":542,"./to_log_range":543,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],516:[function(v,J,Z){J.exports=function(p){return window&&window.process&&window.process.versions?Object.prototype.toString.call(p)==="[object Object]":Object.prototype.toString.call(p)==="[object Object]"&&Object.getPrototypeOf(p).hasOwnProperty("hasOwnProperty")}},{}],517:[function(v,J,Z){var p=v("./nested_property"),g=/^\w*$/;J.exports=function(b,y,e,n){var t,a,r;e=e||"name",n=n||"value";var m={};y&&y.length?(r=p(b,y),a=r.get()):a=b,y=y||"";var o={};if(a)for(t=0;t<a.length;t++)o[a[t][e]]=t;var i=g.test(n),u={set:function(f,l){var h=l===null?4:0;if(!a){if(!r||h===4)return;a=[],r.set(a)}var d=o[f];if(d===void 0){if(h===4)return;h|=3,d=a.length,o[f]=d}else l!==(i?a[d][n]:p(a[d],n).get())&&(h|=2);var s=a[d]=a[d]||{};return s[e]=f,i?s[n]=l:p(s,n).set(l),l!==null&&(h&=-5),m[d]=m[d]|h,u},get:function(f){if(a){var l=o[f];return l===void 0?void 0:i?a[l][n]:p(a[l],n).get()}},rename:function(f,l){var h=o[f];return h===void 0||(m[h]=1|m[h],o[l]=h,delete o[f],a[h][e]=l),u},remove:function(f){var l=o[f];if(l===void 0)return u;var h=a[l];if(Object.keys(h).length>2)return m[l]=2|m[l],u.set(f,null);if(i){for(t=l;t<a.length;t++)m[t]=3|m[t];for(t=l;t<a.length;t++)o[a[t][e]]--;a.splice(l,1),delete o[f]}else p(h,n).set(null),m[l]=6|m[l];return u},constructUpdate:function(){for(var f,l,h={},d=Object.keys(m),s=0;s<d.length;s++)l=d[s],f=y+"["+l+"]",a[l]?(1&m[l]&&(h[f+"."+e]=a[l][e]),2&m[l]&&(h[f+"."+n]=i?4&m[l]?null:a[l][n]:4&m[l]?null:p(a[l],n).get())):h[f]=null;return h}};return u}},{"./nested_property":523}],518:[function(v,J,Z){var p=v("../registry");J.exports=function(g,b){for(var y=g._context.locale,e=0;e<2;e++){for(var n=g._context.locales,t=0;t<2;t++){var a=(n[y]||{}).dictionary;if(a){var r=a[b];if(r)return r}n=p.localeRegistry}var m=y.split("-")[0];if(m===y)break;y=m}return b}},{"../registry":647}],519:[function(v,J,Z){var p=v("../plot_api/plot_config").dfltConfig,g=v("./notifier"),b=J.exports={};b.log=function(){var y;if(p.logging>1){var e=["LOG:"];for(y=0;y<arguments.length;y++)e.push(arguments[y]);console.trace.apply(console,e)}if(p.notifyOnLogging>1){var n=[];for(y=0;y<arguments.length;y++)n.push(arguments[y]);g(n.join("<br>"),"long")}},b.warn=function(){var y;if(p.logging>0){var e=["WARN:"];for(y=0;y<arguments.length;y++)e.push(arguments[y]);console.trace.apply(console,e)}if(p.notifyOnLogging>0){var n=[];for(y=0;y<arguments.length;y++)n.push(arguments[y]);g(n.join("<br>"),"stick")}},b.error=function(){var y;if(p.logging>0){var e=["ERROR:"];for(y=0;y<arguments.length;y++)e.push(arguments[y]);console.error.apply(console,e)}if(p.notifyOnLogging>0){var n=[];for(y=0;y<arguments.length;y++)n.push(arguments[y]);g(n.join("<br>"),"stick")}}},{"../plot_api/plot_config":553,"./notifier":525}],520:[function(v,J,Z){var p=v("@plotly/d3");J.exports=function(g,b,y){var e=g.selectAll("g."+y.replace(/\s/g,".")).data(b,function(t){return t[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",y),e.order();var n=g.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(t){t[0][n]=p.select(this)}),e}},{"@plotly/d3":58}],521:[function(v,J,Z){var p=v("gl-mat4");Z.init2dArray=function(g,b){for(var y=new Array(g),e=0;e<g;e++)y[e]=new Array(b);return y},Z.transposeRagged=function(g){var b,y,e=0,n=g.length;for(b=0;b<n;b++)e=Math.max(e,g[b].length);var t=new Array(e);for(b=0;b<e;b++)for(t[b]=new Array(n),y=0;y<n;y++)t[b][y]=g[y][b];return t},Z.dot=function(g,b){if(!g.length||!b.length||g.length!==b.length)return null;var y,e,n=g.length;if(g[0].length)for(y=new Array(n),e=0;e<n;e++)y[e]=Z.dot(g[e],b);else if(b[0].length){var t=Z.transposeRagged(b);for(y=new Array(t.length),e=0;e<t.length;e++)y[e]=Z.dot(g,t[e])}else for(y=0,e=0;e<n;e++)y+=g[e]*b[e];return y},Z.translationMatrix=function(g,b){return[[1,0,g],[0,1,b],[0,0,1]]},Z.rotationMatrix=function(g){var b=g*Math.PI/180;return[[Math.cos(b),-Math.sin(b),0],[Math.sin(b),Math.cos(b),0],[0,0,1]]},Z.rotationXYMatrix=function(g,b,y){return Z.dot(Z.dot(Z.translationMatrix(b,y),Z.rotationMatrix(g)),Z.translationMatrix(-b,-y))},Z.apply3DTransform=function(g){return function(){var b=arguments,y=arguments.length===1?b[0]:[b[0],b[1],b[2]||0];return Z.dot(g,[y[0],y[1],y[2],1]).slice(0,3)}},Z.apply2DTransform=function(g){return function(){var b=arguments;b.length===3&&(b=b[0]);var y=arguments.length===1?b[0]:[b[0],b[1]];return Z.dot(g,[y[0],y[1],1]).slice(0,2)}},Z.apply2DTransform2=function(g){var b=Z.apply2DTransform(g);return function(y){return b(y.slice(0,2)).concat(b(y.slice(2,4)))}},Z.convertCssMatrix=function(g){if(g){var b=g.length;if(b===16)return g;if(b===6)return[g[0],g[1],0,0,g[2],g[3],0,0,0,0,1,0,g[4],g[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Z.inverseTransformMatrix=function(g){var b=[];return p.invert(b,g),[[b[0],b[1],b[2],b[3]],[b[4],b[5],b[6],b[7]],[b[8],b[9],b[10],b[11]],[b[12],b[13],b[14],b[15]]]}},{"gl-mat4":210}],522:[function(v,J,Z){J.exports={mod:function(p,g){var b=p%g;return b<0?b+g:b},modHalf:function(p,g){return Math.abs(p)>g/2?p-Math.round(p/g)*g:p}}},{}],523:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("./array").isArrayOrTypedArray;function b(m,o){return function(){var i,u,f,l,h,d=m;for(l=0;l<o.length-1;l++){if((i=o[l])===-1){for(u=!0,f=[],h=0;h<d.length;h++)f[h]=b(d[h],o.slice(l+1))(),f[h]!==f[0]&&(u=!1);return u?f[0]:f}if(typeof i=="number"&&!g(d)||typeof(d=d[i])!="object"||d===null)return}if(typeof d=="object"&&d!==null&&(f=d[o[l]])!==null)return f}}J.exports=function(m,o){if(p(o))o=String(o);else if(typeof o!="string"||o.substr(o.length-4)==="[-1]")throw"bad property string";for(var i,u,f,l=0,h=o.split(".");l<h.length;){if(i=String(h[l]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(i[1])h[l]=i[1];else{if(l!==0)throw"bad property string";h.splice(0,1)}for(u=i[2].substr(1,i[2].length-2).split("]["),f=0;f<u.length;f++)l++,h.splice(l,0,Number(u[f]))}l++}return typeof m!="object"?function(d,s,x){return{set:function(){throw"bad container"},get:function(){},astr:s,parts:x,obj:d}}(m,o,h):{set:n(m,h,o),get:b(m,h),astr:o,parts:h,obj:m}};var y=/(^|\.)args\[/;function e(m,o){return m===void 0||m===null&&!o.match(y)}function n(m,o,i){return function(u){var f,l,h=m,d="",s=e(u,i);for(l=0;l<o.length-1;l++){if(typeof(f=o[l])=="number"&&!g(h))throw"array index but container is not an array";if(f===-1){if(s=!a(h,o.slice(l+1),u,i))break;return}if(!r(h,f,o[l+1],s))break;if(typeof(h=h[f])!="object"||h===null)throw"container is not an object";d=t(d,f)}if(s){if(l===o.length-1&&(delete h[o[l]],Array.isArray(h)&&+o[l]==h.length-1))for(;h.length&&h[h.length-1]===void 0;)h.pop()}else h[o[l]]=u}}function t(m,o){var i=o;return p(o)?i="["+o+"]":m&&(i="."+o),m+i}function a(m,o,i,u){var f,l=g(i),h=!0,d=i,s=u.replace("-1",0),x=!l&&e(i,s),c=o[0];for(f=0;f<m.length;f++)s=u.replace("-1",f),l&&(x=e(d=i[f%i.length],s)),x&&(h=!1),r(m,f,c,x)&&n(m[f],o,u.replace("-1",f))(d);return h}function r(m,o,i,u){if(m[o]===void 0){if(u)return!1;m[o]=typeof i=="number"?[]:{}}return!0}},{"./array":497,"fast-isnumeric":190}],524:[function(v,J,Z){J.exports=function(){}},{}],525:[function(v,J,Z){var p=v("@plotly/d3"),g=v("fast-isnumeric"),b=[];J.exports=function(y,e){if(b.indexOf(y)===-1){b.push(y);var n=1e3;g(e)?n=e:e==="long"&&(n=3e3);var t=p.select("body").selectAll(".plotly-notifier").data([0]);t.enter().append("div").classed("plotly-notifier",!0),t.selectAll(".notifier-note").data(b).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(r){var m=p.select(this);m.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){m.transition().call(a)});for(var o=m.append("p"),i=r.split(/<br\s*\/?>/g),u=0;u<i.length;u++)u&&o.append("br"),o.append("span").text(i[u]);e==="stick"?m.transition().duration(350).style("opacity",1):m.transition().duration(700).style("opacity",1).transition().delay(n).call(a)})}function a(r){r.duration(700).style("opacity",0).each("end",function(m){var o=b.indexOf(m);o!==-1&&b.splice(o,1),p.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":190}],526:[function(v,J,Z){var p=v("./setcursor"),g="data-savedcursor";J.exports=function(b,y){var e=b.attr(g);if(y){if(!e){for(var n=(b.attr("class")||"").split(" "),t=0;t<n.length;t++){var a=n[t];a.indexOf("cursor-")===0&&b.attr(g,a.substr(7)).classed(a,!1)}b.attr(g)||b.attr(g,"!!")}p(b,y)}else e&&(b.attr(g,null),e==="!!"?p(b):p(b,e))}},{"./setcursor":536}],527:[function(v,J,Z){var p=v("./matrix").dot,g=v("../constants/numerical").BADNUM,b=J.exports={};b.tester=function(y){var e,n=y.slice(),t=n[0][0],a=t,r=n[0][1],m=r;for(n[n.length-1][0]===n[0][0]&&n[n.length-1][1]===n[0][1]||n.push(n[0]),e=1;e<n.length;e++)t=Math.min(t,n[e][0]),a=Math.max(a,n[e][0]),r=Math.min(r,n[e][1]),m=Math.max(m,n[e][1]);var o,i=!1;n.length===5&&(n[0][0]===n[1][0]?n[2][0]===n[3][0]&&n[0][1]===n[3][1]&&n[1][1]===n[2][1]&&(i=!0,o=function(l){return l[0]===n[0][0]}):n[0][1]===n[1][1]&&n[2][1]===n[3][1]&&n[0][0]===n[3][0]&&n[1][0]===n[2][0]&&(i=!0,o=function(l){return l[1]===n[0][1]}));var u=!0,f=n[0];for(e=1;e<n.length;e++)if(f[0]!==n[e][0]||f[1]!==n[e][1]){u=!1;break}return{xmin:t,xmax:a,ymin:r,ymax:m,pts:n,contains:i?function(l,h){var d=l[0],s=l[1];return!(d===g||d<t||d>a||s===g||s<r||s>m)&&(!h||!o(l))}:function(l,h){var d=l[0],s=l[1];if(d===g||d<t||d>a||s===g||s<r||s>m)return!1;var x,c,T,_,w,k=n.length,L=n[0][0],A=n[0][1],I=0;for(x=1;x<k;x++)if(c=L,T=A,L=n[x][0],A=n[x][1],!(d<(_=Math.min(c,L))||d>Math.max(c,L)||s>Math.max(T,A)))if(s<Math.min(T,A))d!==_&&I++;else{if(s===(w=L===c?s:T+(d-c)*(A-T)/(L-c)))return x!==1||!h;s<=w&&d!==_&&I++}return I%2==1},isRect:i,degenerate:u}},b.isSegmentBent=function(y,e,n,t){var a,r,m,o=y[e],i=[y[n][0]-o[0],y[n][1]-o[1]],u=p(i,i),f=Math.sqrt(u),l=[-i[1]/f,i[0]/f];for(a=e+1;a<n;a++)if(r=[y[a][0]-o[0],y[a][1]-o[1]],(m=p(r,i))<0||m>u||Math.abs(p(r,l))>t)return!0;return!1},b.filter=function(y,e){var n=[y[0]],t=0,a=0;function r(m){y.push(m);var o=n.length,i=t;n.splice(a+1);for(var u=i+1;u<y.length;u++)(u===y.length-1||b.isSegmentBent(y,i,u+1,e))&&(n.push(y[u]),n.length<o-2&&(t=u,a=n.length-1),i=u)}return y.length>1&&r(y.pop()),{addPt:r,raw:y,filtered:n}}},{"../constants/numerical":491,"./matrix":521}],528:[function(v,J,Z){(function(p){(function(){var g=v("./show_no_webgl_msg"),b=v("regl");J.exports=function(y,e,n){var t=y._fullLayout,a=!0;return t._glcanvas.each(function(r){if(r.regl)r.regl.preloadCachedCode(n);else if(!r.pick||t._has("parcoords")){try{r.regl=b({canvas:this,attributes:{antialias:!r.pick,preserveDrawingBuffer:!0},pixelRatio:y._context.plotGlPixelRatio||p.devicePixelRatio,extensions:e||[],cachedCode:n||{}})}catch{a=!1}r.regl||(a=!1),a&&this.addEventListener("webglcontextlost",function(m){y&&y.emit&&y.emit("plotly_webglcontextlost",{event:m,layer:r.key})},!1)}}),a||g({container:t._glcontainer.node()}),a}}).call(this)}).call(this,typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":537,regl:284}],529:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("is-mobile");J.exports=function(b){var y;if(typeof(y=b&&b.hasOwnProperty("userAgent")?b.userAgent:function(){var o;return typeof navigator<"u"&&(o=navigator.userAgent),o&&o.headers&&typeof o.headers["user-agent"]=="string"&&(o=o.headers["user-agent"]),o}())!="string")return!0;var e=g({ua:{headers:{"user-agent":y}},tablet:!0,featureDetect:!1});if(!e){for(var n=y.split(" "),t=1;t<n.length;t++)if(n[t].indexOf("Safari")!==-1)for(var a=t-1;a>-1;a--){var r=n[a];if(r.substr(0,8)==="Version/"){var m=r.substr(8).split(".")[0];if(p(m)&&(m=+m),m>=13)return!0}}}return e}},{"fast-isnumeric":190,"is-mobile":234}],530:[function(v,J,Z){J.exports=function(p,g){if(g instanceof RegExp){for(var b=g.toString(),y=0;y<p.length;y++)if(p[y]instanceof RegExp&&p[y].toString()===b)return p;p.push(g)}else!g&&g!==0||p.indexOf(g)!==-1||p.push(g);return p}},{}],531:[function(v,J,Z){var p=v("../lib"),g=v("../plot_api/plot_config").dfltConfig,b={add:function(y,e,n,t,a){var r,m;y.undoQueue=y.undoQueue||{index:0,queue:[],sequence:!1},m=y.undoQueue.index,y.autoplay?y.undoQueue.inSequence||(y.autoplay=!1):(!y.undoQueue.sequence||y.undoQueue.beginSequence?(r={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},y.undoQueue.queue.splice(m,y.undoQueue.queue.length-m,r),y.undoQueue.index+=1):r=y.undoQueue.queue[m-1],y.undoQueue.beginSequence=!1,r&&(r.undo.calls.unshift(e),r.undo.args.unshift(n),r.redo.calls.push(t),r.redo.args.push(a)),y.undoQueue.queue.length>g.queueLength&&(y.undoQueue.queue.shift(),y.undoQueue.index--))},startSequence:function(y){y.undoQueue=y.undoQueue||{index:0,queue:[],sequence:!1},y.undoQueue.sequence=!0,y.undoQueue.beginSequence=!0},stopSequence:function(y){y.undoQueue=y.undoQueue||{index:0,queue:[],sequence:!1},y.undoQueue.sequence=!1,y.undoQueue.beginSequence=!1},undo:function(y){var e,n;if(!(y.undoQueue===void 0||isNaN(y.undoQueue.index)||y.undoQueue.index<=0)){for(y.undoQueue.index--,e=y.undoQueue.queue[y.undoQueue.index],y.undoQueue.inSequence=!0,n=0;n<e.undo.calls.length;n++)b.plotDo(y,e.undo.calls[n],e.undo.args[n]);y.undoQueue.inSequence=!1,y.autoplay=!1}},redo:function(y){var e,n;if(!(y.undoQueue===void 0||isNaN(y.undoQueue.index)||y.undoQueue.index>=y.undoQueue.queue.length)){for(e=y.undoQueue.queue[y.undoQueue.index],y.undoQueue.inSequence=!0,n=0;n<e.redo.calls.length;n++)b.plotDo(y,e.redo.calls[n],e.redo.args[n]);y.undoQueue.inSequence=!1,y.autoplay=!1,y.undoQueue.index++}}};b.plotDo=function(y,e,n){y.autoplay=!0,n=function(t,a){for(var r,m=[],o=0;o<a.length;o++)r=a[o],m[o]=r===t?r:typeof r=="object"?Array.isArray(r)?p.extendDeep([],r):p.extendDeepAll({},r):r;return m}(y,n),e.apply(null,n)},J.exports=b},{"../lib":515,"../plot_api/plot_config":553}],532:[function(v,J,Z){Z.counter=function(p,g,b,y){var e=(g||"")+(b?"":"$"),n=y===!1?"":"^";return p==="xy"?new RegExp(n+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(n+p+"([2-9]|[1-9][0-9]+)?"+e)}},{}],533:[function(v,J,Z){var p=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,g=/^[^\.\[\]]+$/;J.exports=function(b,y){for(;y;){var e=b.match(p);if(e)b=e[1];else{if(!b.match(g))throw new Error("bad relativeAttr call:"+[b,y]);b=""}if(y.charAt(0)!=="^")break;y=y.slice(1)}return b&&y.charAt(0)!=="["?b+"."+y:b+y}},{}],534:[function(v,J,Z){var p=v("./array").isArrayOrTypedArray,g=v("./is_plain_object");J.exports=function b(y,e){for(var n in e){var t=e[n],a=y[n];if(a!==t)if(n.charAt(0)==="_"||typeof t=="function"){if(n in y)continue;y[n]=t}else if(p(t)&&p(a)&&g(t[0])){if(n==="customdata"||n==="ids")continue;for(var r=Math.min(t.length,a.length),m=0;m<r;m++)a[m]!==t[m]&&g(t[m])&&g(a[m])&&b(a[m],t[m])}else g(t)&&g(a)&&(b(a,t),Object.keys(a).length||delete y[n])}}},{"./array":497,"./is_plain_object":516}],535:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("./loggers"),b=v("./identity"),y=v("../constants/numerical").BADNUM;function e(r,m){return r<m}function n(r,m){return r<=m}function t(r,m){return r>m}function a(r,m){return r>=m}Z.findBin=function(r,m,o){if(p(m.start))return o?Math.ceil((r-m.start)/m.size-1e-9)-1:Math.floor((r-m.start)/m.size+1e-9);var i,u,f=0,l=m.length,h=0,d=l>1?(m[l-1]-m[0])/(l-1):1;for(u=d>=0?o?e:n:o?a:t,r+=1e-9*d*(o?-1:1)*(d>=0?1:-1);f<l&&h++<100;)u(m[i=Math.floor((f+l)/2)],r)?f=i+1:l=i;return h>90&&g.log("Long binary search..."),f-1},Z.sorterAsc=function(r,m){return r-m},Z.sorterDes=function(r,m){return m-r},Z.distinctVals=function(r){var m,o=r.slice();for(o.sort(Z.sorterAsc),m=o.length-1;m>-1&&o[m]===y;m--);for(var i,u=o[m]-o[0]||1,f=u/(m||1)/1e4,l=[],h=0;h<=m;h++){var d=o[h],s=d-i;i===void 0?(l.push(d),i=d):s>f&&(u=Math.min(u,s),l.push(d),i=d)}return{vals:l,minDiff:u}},Z.roundUp=function(r,m,o){for(var i,u=0,f=m.length-1,l=0,h=o?0:1,d=o?1:0,s=o?Math.ceil:Math.floor;u<f&&l++<100;)m[i=s((u+f)/2)]<=r?u=i+h:f=i-d;return m[u]},Z.sort=function(r,m){for(var o=0,i=0,u=1;u<r.length;u++){var f=m(r[u],r[u-1]);if(f<0?o=1:f>0&&(i=1),o&&i)return r.sort(m)}return i?r:r.reverse()},Z.findIndexOfMin=function(r,m){m=m||b;for(var o,i=1/0,u=0;u<r.length;u++){var f=m(r[u]);f<i&&(i=f,o=u)}return o}},{"../constants/numerical":491,"./identity":513,"./loggers":519,"fast-isnumeric":190}],536:[function(v,J,Z){J.exports=function(p,g){(p.attr("class")||"").split(" ").forEach(function(b){b.indexOf("cursor-")===0&&p.classed(b,!1)}),g&&p.classed("cursor-"+g,!0)}},{}],537:[function(v,J,Z){var p=v("../components/color"),g=function(){};J.exports=function(b){for(var y in b)typeof b[y]=="function"&&(b[y]=g);b.destroy=function(){b.container.parentNode.removeChild(b.container)};var e=document.createElement("div");e.className="no-webgl",e.style.cursor="pointer",e.style.fontSize="24px",e.style.color=p.defaults[0],e.style.position="absolute",e.style.left=e.style.top="0px",e.style.width=e.style.height="100%",e.style["background-color"]=p.lightLine,e.style["z-index"]=30;var n=document.createElement("p");return n.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",n.style.position="relative",n.style.top="50%",n.style.left="50%",n.style.height="30%",n.style.width="50%",n.style.margin="-15% 0 0 -25%",e.appendChild(n),b.container.appendChild(e),b.container.style.background="#FFFFFF",b.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":367}],538:[function(v,J,Z){J.exports=function(p){return Object.keys(p).sort()}},{}],539:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("./array").isArrayOrTypedArray;Z.aggNums=function(b,y,e,n){var t,a;if((!n||n>e.length)&&(n=e.length),p(y)||(y=!1),g(e[0])){for(a=new Array(n),t=0;t<n;t++)a[t]=Z.aggNums(b,y,e[t]);e=a}for(t=0;t<n;t++)p(y)?p(e[t])&&(y=b(+y,+e[t])):y=e[t];return y},Z.len=function(b){return Z.aggNums(function(y){return y+1},0,b)},Z.mean=function(b,y){return y||(y=Z.len(b)),Z.aggNums(function(e,n){return e+n},0,b)/y},Z.midRange=function(b){if(b!==void 0&&b.length!==0)return(Z.aggNums(Math.max,null,b)+Z.aggNums(Math.min,null,b))/2},Z.variance=function(b,y,e){return y||(y=Z.len(b)),p(e)||(e=Z.mean(b,y)),Z.aggNums(function(n,t){return n+Math.pow(t-e,2)},0,b)/y},Z.stdev=function(b,y,e){return Math.sqrt(Z.variance(b,y,e))},Z.median=function(b){var y=b.slice().sort();return Z.interp(y,.5)},Z.interp=function(b,y){if(!p(y))throw"n should be a finite number";if((y=y*b.length-.5)<0)return b[0];if(y>b.length-1)return b[b.length-1];var e=y%1;return e*b[Math.ceil(y)]+(1-e)*b[Math.floor(y)]}},{"./array":497,"fast-isnumeric":190}],540:[function(v,J,Z){var p=v("color-normalize");J.exports=function(g){return g?p(g):[0,0,0,1]}},{"color-normalize":89}],541:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../lib"),b=g.strTranslate,y=v("../constants/xmlns_namespaces"),e=v("../constants/alignment").LINE_SPACING,n=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;Z.convertToTspans=function(S,E,D){var R=S.text(),H=!S.attr("data-notex")&&E&&E._context.typesetMath&&typeof MathJax<"u"&&R.match(n),V=p.select(S.node().parentNode);if(!V.empty()){var X=S.attr("class")?S.attr("class").split(" ")[0]:"text";return X+="-math",V.selectAll("svg."+X).remove(),V.selectAll("g."+X+"-group").remove(),S.style("display",null).attr({"data-unformatted":R,"data-math":"N"}),H?(E&&E._promises||[]).push(new Promise(function(G){S.style("display","none");var W=parseInt(S.node().style.fontSize,10),te={fontSize:W};(function(N,B,U){var ee,j,Q,K,re=parseInt((MathJax.version||"").split(".")[0]);if(re!==2&&re!==3)return void g.warn("No MathJax version:",MathJax.version);var ne=function(){var oe="math-output-"+g.randstr({},64),de=(K=p.select("body").append("div").attr({id:oe}).style({visibility:"hidden",position:"absolute","font-size":B.fontSize+"px"}).text(N.replace(t,"\\lt ").replace(a,"\\gt "))).node();return re===2?MathJax.Hub.Typeset(de):MathJax.typeset([de])},le=function(){var oe=K.select(re===2?".MathJax_SVG":".MathJax"),de=!oe.empty()&&K.select("svg").node();if(de){var se,me=de.getBoundingClientRect();se=re===2?p.select("body").select("#MathJax_SVG_glyphs"):oe.select("defs"),U(oe,se,me)}else g.log("There was an error in the tex syntax.",N),U();K.remove()};re===2?MathJax.Hub.Queue(function(){return j=g.extendDeepAll({},MathJax.Hub.config),Q=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:r},displayAlign:"left"})},function(){if((ee=MathJax.Hub.config.menuSettings.renderer)!=="SVG")return MathJax.Hub.setRenderer("SVG")},ne,le,function(){if(ee!=="SVG")return MathJax.Hub.setRenderer(ee)},function(){return Q!==void 0&&(MathJax.Hub.processSectionDelay=Q),MathJax.Hub.Config(j)}):re===3&&(j=g.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=r,(ee=MathJax.config.startup.output)!=="svg"&&(MathJax.config.startup.output="svg"),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){ne(),le(),ee!=="svg"&&(MathJax.config.startup.output=ee),MathJax.config=j}))})(H[2],te,function(N,B,U){V.selectAll("svg."+X).remove(),V.selectAll("g."+X+"-group").remove();var ee=N&&N.select("svg");if(!ee||!ee.node())return $(),void G();var j=V.append("g").classed(X+"-group",!0).attr({"pointer-events":"none","data-unformatted":R,"data-math":"Y"});j.node().appendChild(ee.node()),B&&B.node()&&ee.node().insertBefore(B.node().cloneNode(!0),ee.node().firstChild);var Q=U.width,K=U.height;ee.attr({class:X,height:K,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var re=S.node().style.fill||"black",ne=ee.select("g");ne.attr({fill:re,stroke:re});var le=ne.node().getBoundingClientRect(),oe=le.width,de=le.height;(oe>Q||de>K)&&(ee.style("overflow","hidden"),oe=(le=ee.node().getBoundingClientRect()).width,de=le.height);var se=+S.attr("x"),me=+S.attr("y"),Te=-(W||S.node().getBoundingClientRect().height)/4;if(X[0]==="y")j.attr({transform:"rotate("+[-90,se,me]+")"+b(-oe/2,Te-de/2)});else if(X[0]==="l")me=Te-de/2;else if(X[0]==="a"&&X.indexOf("atitle")!==0)se=0,me=Te;else{var _e=S.attr("text-anchor");se-=oe*(_e==="middle"?.5:_e==="end"?1:0),me=me+Te-de/2}ee.attr({x:se,y:me}),D&&D.call(S,j),G(j)})})):$(),S}function $(){V.empty()||(X=S.attr("class")+"-math",V.select("svg."+X).remove()),S.text("").style("white-space","pre"),function(G,W){W=W.replace(f," ");var te,N=!1,B=[],U=-1;function ee(){U++;var fe=document.createElementNS(y.svg,"tspan");p.select(fe).attr({class:"line",dy:U*e+"em"}),G.appendChild(fe),te=fe;var ve=B;if(B=[{node:fe}],ve.length>1)for(var Me=1;Me<ve.length;Me++)j(ve[Me])}function j(fe){var ve,Me=fe.type,ke={};if(Me==="a"){ve="a";var Le=fe.target,ze=fe.href,Re=fe.popup;ze&&(ke={"xlink:xlink:show":Le==="_blank"||Le.charAt(0)!=="_"?"new":"replace",target:Le,"xlink:xlink:href":ze},Re&&(ke.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Re+'");return false;'))}else ve="tspan";fe.style&&(ke.style=fe.style);var Oe=document.createElementNS(y.svg,ve);if(Me==="sup"||Me==="sub"){Q(te,"\u200B"),te.appendChild(Oe);var Ze=document.createElementNS(y.svg,"tspan");Q(Ze,"\u200B"),p.select(Ze).attr("dy",i[Me]),ke.dy=o[Me],te.appendChild(Oe),te.appendChild(Ze)}else te.appendChild(Oe);p.select(Oe).attr(ke),te=fe.node=Oe,B.push(fe)}function Q(fe,ve){fe.appendChild(document.createTextNode(ve))}function K(fe){if(B.length!==1){var ve=B.pop();fe!==ve.type&&g.log("Start tag <"+ve.type+"> doesnt match end tag <"+fe+">. Pretending it did match.",W),te=B[B.length-1].node}else g.log("Ignoring unexpected end tag </"+fe+">.",W)}d.test(W)?ee():(te=G,B=[{node:G}]);for(var re=W.split(l),ne=0;ne<re.length;ne++){var le=re[ne],oe=le.match(h),de=oe&&oe[2].toLowerCase(),se=m[de];if(de==="br")ee();else if(se===void 0)Q(te,A(le));else if(oe[1])K(de);else{var me=oe[4],Te={type:de},_e=_(me,s);if(_e?(_e=_e.replace(w,"$1 fill:"),se&&(_e+=";"+se)):se&&(_e=se),_e&&(Te.style=_e),de==="a"){N=!0;var be=_(me,x);if(be){var Ce=I(be);Ce&&(Te.href=Ce,Te.target=_(me,c)||"_blank",Te.popup=_(me,T))}}j(Te)}}return N}(S.node(),R)&&S.style("pointer-events","all"),Z.positionText(S),D&&D.call(S)}};var t=/(<|&lt;|&#60;)/g,a=/(>|&gt;|&#62;)/g,r=[["$","$"],["\\(","\\)"]],m={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},o={sub:"0.3em",sup:"-0.6em"},i={sub:"-0.21em",sup:"0.42em"},u=["http:","https:","mailto:","",void 0,":"],f=Z.NEWLINES=/(\r\n?|\n)/g,l=/(<[^<>]*>)/,h=/<(\/?)([^ >]*)(\s+(.*))?>/i,d=/<br(\s+.*)?>/i;Z.BR_TAG_ALL=/<br(\s+.*)?>/gi;var s=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,x=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,c=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,T=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function _(S,E){if(!S)return null;var D=S.match(E),R=D&&(D[3]||D[4]);return R&&A(R)}var w=/(^|;)\s*color:/;Z.plainText=function(S,E){for(var D=(E=E||{}).len!==void 0&&E.len!==-1?E.len:1/0,R=E.allowedTags!==void 0?E.allowedTags:["br"],H=3,V=S.split(l),X=[],$="",G=0,W=0;W<V.length;W++){var te=V[W],N=te.match(h),B=N&&N[2].toLowerCase();if(B)R.indexOf(B)!==-1&&(X.push(te),$=B);else{var U=te.length;if(G+U<D)X.push(te),G+=U;else if(G<D){var ee=D-G;$&&($!=="br"||ee<=H||U<=H)&&X.pop(),D>H?X.push(te.substr(0,ee-H)+"..."):X.push(te.substr(0,ee));break}$=""}}return X.join("")};var k={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},L=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function A(S){return S.replace(L,function(E,D){return(D.charAt(0)==="#"?function(R){if(!(R>1114111)){var H=String.fromCodePoint;if(H)return H(R);var V=String.fromCharCode;return R<=65535?V(R):V(55232+(R>>10),R%1024+56320)}}(D.charAt(1)==="x"?parseInt(D.substr(2),16):parseInt(D.substr(1),10)):k[D])||E})}function I(S){var E=encodeURI(decodeURI(S)),D=document.createElement("a"),R=document.createElement("a");D.href=S,R.href=E;var H=D.protocol,V=R.protocol;return u.indexOf(H)!==-1&&u.indexOf(V)!==-1?E:""}function P(S,E,D){var R,H,V,X=D.horizontalAlign,$=D.verticalAlign||"top",G=S.node().getBoundingClientRect(),W=E.node().getBoundingClientRect();return H=$==="bottom"?function(){return G.bottom-R.height}:$==="middle"?function(){return G.top+(G.height-R.height)/2}:function(){return G.top},V=X==="right"?function(){return G.right-R.width}:X==="center"?function(){return G.left+(G.width-R.width)/2}:function(){return G.left},function(){R=this.node().getBoundingClientRect();var te=V()-W.left,N=H()-W.top,B=D.gd||{};if(D.gd){B._fullLayout._calcInverseTransform(B);var U=g.apply3DTransform(B._fullLayout._invTransform)(te,N);te=U[0],N=U[1]}return this.style({top:N+"px",left:te+"px","z-index":1e3}),this}}Z.convertEntities=A,Z.sanitizeHTML=function(S){S=S.replace(f," ");for(var E=document.createElement("p"),D=E,R=[],H=S.split(l),V=0;V<H.length;V++){var X=H[V],$=X.match(h),G=$&&$[2].toLowerCase();if(G in m)if($[1])R.length&&(D=R.pop());else{var W=$[4],te=_(W,s),N=te?{style:te}:{};if(G==="a"){var B=_(W,x);if(B){var U=I(B);if(U){N.href=U;var ee=_(W,c);ee&&(N.target=ee)}}}var j=document.createElement(G);D.appendChild(j),p.select(j).attr(N),D=j,R.push(j)}else D.appendChild(document.createTextNode(A(X)))}return E.innerHTML},Z.lineCount=function(S){return S.selectAll("tspan.line").size()||1},Z.positionText=function(S,E,D){return S.each(function(){var R=p.select(this);function H($,G){return G===void 0?(G=R.attr($))===null&&(R.attr($,0),G=0):R.attr($,G),G}var V=H("x",E),X=H("y",D);this.nodeName==="text"&&R.selectAll("tspan.line").attr({x:V,y:X})})},Z.makeTextShadow=function(S){var E="1px ",D="1px ",R="1px ";return E+D+R+S+", -"+E+"-"+D+R+S+", "+E+"-"+D+R+S+", -"+E+D+R+S},Z.makeEditable=function(S,E){var D=E.gd,R=E.delegate,H=p.dispatch("edit","input","cancel"),V=R||S;if(S.style({"pointer-events":R?"none":"all"}),S.size()!==1)throw new Error("boo");function X(){(function(){var te=p.select(D).select(".svg-container"),N=te.append("div"),B=S.node().style,U=parseFloat(B.fontSize||12),ee=E.text;ee===void 0&&(ee=S.attr("data-unformatted")),N.classed("plugin-editable editable",!0).style({position:"absolute","font-family":B.fontFamily||"Arial","font-size":U,color:E.fill||B.fill||"black",opacity:1,"background-color":E.background||"transparent",outline:"#ffffff33 1px solid",margin:[-U/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(ee).call(P(S,te,E)).on("blur",function(){D._editing=!1,S.text(this.textContent).style({opacity:1});var j,Q=p.select(this).attr("class");(j=Q?"."+Q.split(" ")[0]+"-math-group":"[class*=-math-group]")&&p.select(S.node().parentNode).select(j).style({opacity:0});var K=this.textContent;p.select(this).transition().duration(0).remove(),p.select(document).on("mouseup",null),H.edit.call(S,K)}).on("focus",function(){var j=this;D._editing=!0,p.select(document).on("mouseup",function(){if(p.event.target===j)return!1;document.activeElement===N.node()&&N.node().blur()})}).on("keyup",function(){p.event.which===27?(D._editing=!1,S.style({opacity:1}),p.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),H.cancel.call(S,this.textContent)):(H.input.call(S,this.textContent),p.select(this).call(P(S,te,E)))}).on("keydown",function(){p.event.which===13&&this.blur()}).call($)})(),S.style({opacity:0});var G,W=V.attr("class");(G=W?"."+W.split(" ")[0]+"-math-group":"[class*=-math-group]")&&p.select(S.node().parentNode).select(G).style({opacity:0})}function $(G){var W=G.node(),te=document.createRange();te.selectNodeContents(W);var N=window.getSelection();N.removeAllRanges(),N.addRange(te),W.focus()}return E.immediate?X():V.on("click",X),p.rebind(S,H,"on")}},{"../constants/alignment":483,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],542:[function(v,J,Z){var p={};function g(b){b&&b.timer!==null&&(clearTimeout(b.timer),b.timer=null)}Z.throttle=function(b,y,e){var n=p[b],t=Date.now();if(!n){for(var a in p)p[a].ts<t-6e4&&delete p[a];n=p[b]={ts:0,timer:null}}function r(){e(),n.ts=Date.now(),n.onDone&&(n.onDone(),n.onDone=null)}g(n),t>n.ts+y?r():n.timer=setTimeout(function(){r(),n.timer=null},y)},Z.done=function(b){var y=p[b];return y&&y.timer?new Promise(function(e){var n=y.onDone;y.onDone=function(){n&&n(),e(),y.onDone=null}}):Promise.resolve()},Z.clear=function(b){if(b)g(p[b]),delete p[b];else for(var y in p)Z.clear(y)}},{}],543:[function(v,J,Z){var p=v("fast-isnumeric");J.exports=function(g,b){if(g>0)return Math.log(g)/Math.LN10;var y=Math.log(Math.min(b[0],b[1]))/Math.LN10;return p(y)||(y=Math.log(Math.max(b[0],b[1]))/Math.LN10-6),y}},{"fast-isnumeric":190}],544:[function(v,J,Z){var p=J.exports={},g=v("../plots/geo/constants").locationmodeToLayer,b=v("topojson-client").feature;p.getTopojsonName=function(y){return[y.scope.replace(/ /g,"-"),"_",y.resolution.toString(),"m"].join("")},p.getTopojsonPath=function(y,e){return y+e+".json"},p.getTopojsonFeatures=function(y,e){var n=g[y.locationmode],t=e.objects[n];return b(e,t).features}},{"../plots/geo/constants":596,"topojson-client":316}],545:[function(v,J,Z){J.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],546:[function(v,J,Z){J.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],547:[function(v,J,Z){var p=v("../registry");J.exports=function(g){for(var b,y,e=p.layoutArrayContainers,n=p.layoutArrayRegexes,t=g.split("[")[0],a=0;a<n.length;a++)if((y=g.match(n[a]))&&y.index===0){b=y[0];break}if(b||(b=e[e.indexOf(t)]),!b)return!1;var r=g.substr(b.length);return r?!!(y=r.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:b,index:Number(y[1]),property:y[3]||""}:{array:b,index:"",property:""}}},{"../registry":647}],548:[function(v,J,Z){var p=v("../lib"),g=p.extendFlat,b=p.isPlainObject,y={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},n=y.flags.slice().concat(["fullReplot"]),t=e.flags.slice().concat("layoutReplot");function a(o){for(var i={},u=0;u<o.length;u++)i[o[u]]=!1;return i}function r(o,i,u){var f=g({},o);for(var l in f){var h=f[l];b(h)&&(f[l]=m(h,i,u,l))}return u==="from-root"&&(f.editType=i),f}function m(o,i,u,f){if(o.valType){var l=g({},o);if(l.editType=i,Array.isArray(o.items)){l.items=new Array(o.items.length);for(var h=0;h<o.items.length;h++)l.items[h]=m(o.items[h],i)}return l}return r(o,i,f.charAt(0)==="_"?"nested":"from-root")}J.exports={traces:y,layout:e,traceFlags:function(){return a(n)},layoutFlags:function(){return a(t)},update:function(o,i){var u=i.editType;if(u&&u!=="none")for(var f=u.split("+"),l=0;l<f.length;l++)o[f[l]]=!0},overrideAll:r}},{"../lib":515}],549:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("gl-mat4/fromQuat"),b=v("../registry"),y=v("../lib"),e=v("../plots/plots"),n=v("../plots/cartesian/axis_ids"),t=v("../components/color"),a=n.cleanId,r=n.getFromTrace,m=b.traceIs;function o(c,T){var _=c[T],w=T.charAt(0);_&&_!=="paper"&&(c[T]=a(_,w,!0))}function i(c){function T(_,w){var k=c[_],L=c.title&&c.title[w];k&&!L&&(c.title||(c.title={}),c.title[w]=c[_],delete c[_])}c&&(typeof c.title!="string"&&typeof c.title!="number"||(c.title={text:c.title}),T("titlefont","font"),T("titleposition","position"),T("titleside","side"),T("titleoffset","offset"))}function u(c){if(!y.isPlainObject(c))return!1;var T=c.name;return delete c.name,delete c.showlegend,(typeof T=="string"||typeof T=="number")&&String(T)}function f(c,T,_,w){if(_&&!w)return c;if(w&&!_||!c.trim())return T;if(!T.trim())return c;var k,L=Math.min(c.length,T.length);for(k=0;k<L&&c.charAt(k)===T.charAt(k);k++);return c.substr(0,k).trim()}function l(c){var T="middle",_="center";return typeof c=="string"&&(c.indexOf("top")!==-1?T="top":c.indexOf("bottom")!==-1&&(T="bottom"),c.indexOf("left")!==-1?_="left":c.indexOf("right")!==-1&&(_="right")),T+" "+_}function h(c,T){return T in c&&typeof c[T]=="object"&&Object.keys(c[T]).length===0}Z.clearPromiseQueue=function(c){Array.isArray(c._promises)&&c._promises.length>0&&y.log("Clearing previous rejected promises from queue."),c._promises=[]},Z.cleanLayout=function(c){var T,_;c||(c={}),c.xaxis1&&(c.xaxis||(c.xaxis=c.xaxis1),delete c.xaxis1),c.yaxis1&&(c.yaxis||(c.yaxis=c.yaxis1),delete c.yaxis1),c.scene1&&(c.scene||(c.scene=c.scene1),delete c.scene1);var w=(e.subplotsRegistry.cartesian||{}).attrRegex,k=(e.subplotsRegistry.polar||{}).attrRegex,L=(e.subplotsRegistry.ternary||{}).attrRegex,A=(e.subplotsRegistry.gl3d||{}).attrRegex,I=Object.keys(c);for(T=0;T<I.length;T++){var P=I[T];if(w&&w.test(P)){var S=c[P];S.anchor&&S.anchor!=="free"&&(S.anchor=a(S.anchor)),S.overlaying&&(S.overlaying=a(S.overlaying)),S.type||(S.isdate?S.type="date":S.islog?S.type="log":S.isdate===!1&&S.islog===!1&&(S.type="linear")),S.autorange!=="withzero"&&S.autorange!=="tozero"||(S.autorange=!0,S.rangemode="tozero"),delete S.islog,delete S.isdate,delete S.categories,h(S,"domain")&&delete S.domain,S.autotick!==void 0&&(S.tickmode===void 0&&(S.tickmode=S.autotick?"auto":"linear"),delete S.autotick),i(S)}else if(k&&k.test(P))i(c[P].radialaxis);else if(L&&L.test(P)){var E=c[P];i(E.aaxis),i(E.baxis),i(E.caxis)}else if(A&&A.test(P)){var D=c[P],R=D.cameraposition;if(Array.isArray(R)&&R[0].length===4){var H=R[0],V=R[1],X=R[2],$=g([],H),G=[];for(_=0;_<3;++_)G[_]=V[_]+X*$[2+4*_];D.camera={eye:{x:G[0],y:G[1],z:G[2]},center:{x:V[0],y:V[1],z:V[2]},up:{x:0,y:0,z:1}},delete D.cameraposition}i(D.xaxis),i(D.yaxis),i(D.zaxis)}}var W=Array.isArray(c.annotations)?c.annotations.length:0;for(T=0;T<W;T++){var te=c.annotations[T];y.isPlainObject(te)&&(te.ref&&(te.ref==="paper"?(te.xref="paper",te.yref="paper"):te.ref==="data"&&(te.xref="x",te.yref="y"),delete te.ref),o(te,"xref"),o(te,"yref"))}var N=Array.isArray(c.shapes)?c.shapes.length:0;for(T=0;T<N;T++){var B=c.shapes[T];y.isPlainObject(B)&&(o(B,"xref"),o(B,"yref"))}var U=Array.isArray(c.images)?c.images.length:0;for(T=0;T<U;T++){var ee=c.images[T];y.isPlainObject(ee)&&(o(ee,"xref"),o(ee,"yref"))}var j=c.legend;return j&&(j.x>3?(j.x=1.02,j.xanchor="left"):j.x<-2&&(j.x=-.02,j.xanchor="right"),j.y>3?(j.y=1.02,j.yanchor="bottom"):j.y<-2&&(j.y=-.02,j.yanchor="top")),i(c),c.dragmode==="rotate"&&(c.dragmode="orbit"),t.clean(c),c.template&&c.template.layout&&Z.cleanLayout(c.template.layout),c},Z.cleanData=function(c){for(var T=0;T<c.length;T++){var _,w=c[T];if(w.type==="histogramy"&&"xbins"in w&&!("ybins"in w)&&(w.ybins=w.xbins,delete w.xbins),w.error_y&&"opacity"in w.error_y){var k=t.defaults,L=w.error_y.color||(m(w,"bar")?t.defaultLine:k[T%k.length]);w.error_y.color=t.addOpacity(t.rgb(L),t.opacity(L)*w.error_y.opacity),delete w.error_y.opacity}if("bardir"in w&&(w.bardir!=="h"||!m(w,"bar")&&w.type.substr(0,9)!=="histogram"||(w.orientation="h",Z.swapXYData(w)),delete w.bardir),w.type==="histogramy"&&Z.swapXYData(w),w.type!=="histogramx"&&w.type!=="histogramy"||(w.type="histogram"),"scl"in w&&!("colorscale"in w)&&(w.colorscale=w.scl,delete w.scl),"reversescl"in w&&!("reversescale"in w)&&(w.reversescale=w.reversescl,delete w.reversescl),w.xaxis&&(w.xaxis=a(w.xaxis,"x")),w.yaxis&&(w.yaxis=a(w.yaxis,"y")),m(w,"gl3d")&&w.scene&&(w.scene=e.subplotsRegistry.gl3d.cleanId(w.scene)),!m(w,"pie-like")&&!m(w,"bar-like"))if(Array.isArray(w.textposition))for(_=0;_<w.textposition.length;_++)w.textposition[_]=l(w.textposition[_]);else w.textposition&&(w.textposition=l(w.textposition));var A=b.getModule(w);if(A&&A.colorbar){var I=A.colorbar.container,P=I?w[I]:w;P&&P.colorscale&&(P.colorscale==="YIGnBu"&&(P.colorscale="YlGnBu"),P.colorscale==="YIOrRd"&&(P.colorscale="YlOrRd"))}if(w.type==="surface"&&y.isPlainObject(w.contours)){var S=["x","y","z"];for(_=0;_<S.length;_++){var E=w.contours[S[_]];y.isPlainObject(E)&&(E.highlightColor&&(E.highlightcolor=E.highlightColor,delete E.highlightColor),E.highlightWidth&&(E.highlightwidth=E.highlightWidth,delete E.highlightWidth))}}if(w.type==="candlestick"||w.type==="ohlc"){var D=(w.increasing||{}).showlegend!==!1,R=(w.decreasing||{}).showlegend!==!1,H=u(w.increasing),V=u(w.decreasing);if(H!==!1&&V!==!1){var X=f(H,V,D,R);X&&(w.name=X)}else!H&&!V||w.name||(w.name=H||V)}if(Array.isArray(w.transforms)){var $=w.transforms;for(_=0;_<$.length;_++){var G=$[_];if(y.isPlainObject(G))switch(G.type){case"filter":G.filtersrc&&(G.target=G.filtersrc,delete G.filtersrc),G.calendar&&(G.valuecalendar||(G.valuecalendar=G.calendar),delete G.calendar);break;case"groupby":if(G.styles=G.styles||G.style,G.styles&&!Array.isArray(G.styles)){var W=G.styles,te=Object.keys(W);G.styles=[];for(var N=0;N<te.length;N++)G.styles.push({target:te[N],value:W[te[N]]})}}}}h(w,"line")&&delete w.line,"marker"in w&&(h(w.marker,"line")&&delete w.marker.line,h(w,"marker")&&delete w.marker),t.clean(w),w.autobinx&&(delete w.autobinx,delete w.xbins),w.autobiny&&(delete w.autobiny,delete w.ybins),i(w),w.colorbar&&i(w.colorbar),w.marker&&w.marker.colorbar&&i(w.marker.colorbar),w.line&&w.line.colorbar&&i(w.line.colorbar),w.aaxis&&i(w.aaxis),w.baxis&&i(w.baxis)}},Z.swapXYData=function(c){var T;if(y.swapAttrs(c,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(c.z)&&Array.isArray(c.z[0])&&(c.transpose?delete c.transpose:c.transpose=!0),c.error_x&&c.error_y){var _=c.error_y,w="copy_ystyle"in _?_.copy_ystyle:!(_.color||_.thickness||_.width);y.swapAttrs(c,["error_?.copy_ystyle"]),w&&y.swapAttrs(c,["error_?.color","error_?.thickness","error_?.width"])}if(typeof c.hoverinfo=="string"){var k=c.hoverinfo.split("+");for(T=0;T<k.length;T++)k[T]==="x"?k[T]="y":k[T]==="y"&&(k[T]="x");c.hoverinfo=k.join("+")}},Z.coerceTraceIndices=function(c,T){if(p(T))return[T];if(!Array.isArray(T)||!T.length)return c.data.map(function(k,L){return L});if(Array.isArray(T)){for(var _=[],w=0;w<T.length;w++)y.isIndex(T[w],c.data.length)?_.push(T[w]):y.warn("trace index (",T[w],") is not a number or is out of bounds");return _}return T},Z.manageArrayContainers=function(c,T,_){var w=c.obj,k=c.parts,L=k.length,A=k[L-1],I=p(A);if(I&&T===null){var P=k.slice(0,L-1).join(".");y.nestedProperty(w,P).get().splice(A,1)}else I&&c.get()===void 0&&c.get()===void 0&&(_[c.astr]=null),c.set(T)};var d=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function s(c){var T=c.search(d);if(T>0)return c.substr(0,T)}Z.hasParent=function(c,T){for(var _=s(T);_;){if(_ in c)return!0;_=s(_)}return!1};var x=["x","y","z"];Z.clearAxisTypes=function(c,T,_){for(var w=0;w<T.length;w++)for(var k=c._fullData[w],L=0;L<3;L++){var A=r(c,k,x[L]);if(A&&A.type!=="log"){var I=A._name,P=A._id.substr(1);if(P.substr(0,5)==="scene"){if(_[P]!==void 0)continue;I=P+"."+I}var S=I+".type";_[I]===void 0&&_[S]===void 0&&y.nestedProperty(c.layout,S).set(null)}}}},{"../components/color":367,"../lib":515,"../plots/cartesian/axis_ids":570,"../plots/plots":628,"../registry":647,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],550:[function(v,J,Z){var p=v("./plot_api");Z._doPlot=p._doPlot,Z.newPlot=p.newPlot,Z.restyle=p.restyle,Z.relayout=p.relayout,Z.redraw=p.redraw,Z.update=p.update,Z._guiRestyle=p._guiRestyle,Z._guiRelayout=p._guiRelayout,Z._guiUpdate=p._guiUpdate,Z._storeDirectGUIEdit=p._storeDirectGUIEdit,Z.react=p.react,Z.extendTraces=p.extendTraces,Z.prependTraces=p.prependTraces,Z.addTraces=p.addTraces,Z.deleteTraces=p.deleteTraces,Z.moveTraces=p.moveTraces,Z.purge=p.purge,Z.addFrames=p.addFrames,Z.deleteFrames=p.deleteFrames,Z.animate=p.animate,Z.setPlotConfig=p.setPlotConfig,Z.toImage=v("./to_image"),Z.validate=v("./validate"),Z.downloadImage=v("../snapshot/download");var g=v("./template_api");Z.makeTemplate=g.makeTemplate,Z.validateTemplate=g.validateTemplate},{"../snapshot/download":649,"./plot_api":552,"./template_api":557,"./to_image":558,"./validate":559}],551:[function(v,J,Z){var p=v("../lib/is_plain_object"),g=v("../lib/noop"),b=v("../lib/loggers"),y=v("../lib/search").sorterAsc,e=v("../registry");Z.containerArrayMatch=v("./container_array_match");var n=Z.isAddVal=function(a){return a==="add"||p(a)},t=Z.isRemoveVal=function(a){return a===null||a==="remove"};Z.applyContainerArrayChanges=function(a,r,m,o,i){var u=r.astr,f=e.getComponentMethod(u,"supplyLayoutDefaults"),l=e.getComponentMethod(u,"draw"),h=e.getComponentMethod(u,"drawOne"),d=o.replot||o.recalc||f===g||l===g,s=a.layout,x=a._fullLayout;if(m[""]){Object.keys(m).length>1&&b.warn("Full array edits are incompatible with other edits",u);var c=m[""][""];if(t(c))r.set(null);else{if(!Array.isArray(c))return b.warn("Unrecognized full array edit value",u,c),!0;r.set(c)}return!d&&(f(s,x),l(a),!0)}var T,_,w,k,L,A,I,P,S=Object.keys(m).map(Number).sort(y),E=r.get(),D=E||[],R=i(x,u).get(),H=[],V=-1,X=D.length;for(T=0;T<S.length;T++)if(k=m[w=S[T]],L=Object.keys(k),A=k[""],I=n(A),w<0||w>D.length-(I?0:1))b.warn("index out of range",u,w);else if(A!==void 0)L.length>1&&b.warn("Insertion & removal are incompatible with edits to the same index.",u,w),t(A)?H.push(w):I?(A==="add"&&(A={}),D.splice(w,0,A),R&&R.splice(w,0,{})):b.warn("Unrecognized full object edit value",u,w,A),V===-1&&(V=w);else for(_=0;_<L.length;_++)P=u+"["+w+"].",i(D[w],L[_],P).set(k[L[_]]);for(T=H.length-1;T>=0;T--)D.splice(H[T],1),R&&R.splice(H[T],1);if(D.length?E||r.set(D):r.set(null),d)return!1;if(f(s,x),h!==g){var $;if(V===-1)$=S;else{for(X=Math.max(D.length,X),$=[],T=0;T<S.length&&!((w=S[T])>=V);T++)$.push(w);for(T=V;T<X;T++)$.push(T)}for(T=0;T<$.length;T++)h(a,$[T])}else l(a);return!0}},{"../lib/is_plain_object":516,"../lib/loggers":519,"../lib/noop":524,"../lib/search":535,"../registry":647,"./container_array_match":547}],552:[function(v,J,Z){var p=v("@plotly/d3"),g=v("fast-isnumeric"),b=v("has-hover"),y=v("../lib"),e=y.nestedProperty,n=v("../lib/events"),t=v("../lib/queue"),a=v("../registry"),r=v("./plot_schema"),m=v("../plots/plots"),o=v("../plots/cartesian/axes"),i=v("../components/drawing"),u=v("../components/color"),f=v("../plots/cartesian/graph_interact").initInteractions,l=v("../constants/xmlns_namespaces"),h=v("../components/selections").clearOutline,d=v("./plot_config").dfltConfig,s=v("./manage_arrays"),x=v("./helpers"),c=v("./subroutines"),T=v("./edit_types"),_=v("../plots/cartesian/constants").AX_NAME_PATTERN,w=0;function k(fe){var ve=fe._fullLayout;ve._redrawFromAutoMarginCount?ve._redrawFromAutoMarginCount--:fe.emit("plotly_afterplot")}function L(fe,ve){try{fe._fullLayout._paper.style("background",ve)}catch(Me){y.error(Me)}}function A(fe,ve){L(fe,u.combine(ve,"white"))}function I(fe,ve){if(!fe._context){fe._context=y.extendDeep({},d);var Me=p.select("base");fe._context._baseUrl=Me.size()&&Me.attr("href")?window.location.href.split("#")[0]:""}var ke,Le,ze,Re=fe._context;if(ve){for(Le=Object.keys(ve),ke=0;ke<Le.length;ke++)(ze=Le[ke])!=="editable"&&ze!=="edits"&&ze in Re&&(ze==="setBackground"&&ve[ze]==="opaque"?Re[ze]=A:Re[ze]=ve[ze]);ve.plot3dPixelRatio&&!Re.plotGlPixelRatio&&(Re.plotGlPixelRatio=Re.plot3dPixelRatio);var Oe=ve.editable;if(Oe!==void 0)for(Re.editable=Oe,Le=Object.keys(Re.edits),ke=0;ke<Le.length;ke++)Re.edits[Le[ke]]=Oe;if(ve.edits)for(Le=Object.keys(ve.edits),ke=0;ke<Le.length;ke++)(ze=Le[ke])in Re.edits&&(Re.edits[ze]=ve.edits[ze]);Re._exportedPlot=ve._exportedPlot}Re.staticPlot&&(Re.editable=!1,Re.edits={},Re.autosizable=!1,Re.scrollZoom=!1,Re.doubleClick=!1,Re.showTips=!1,Re.showLink=!1,Re.displayModeBar=!1),Re.displayModeBar!=="hover"||b||(Re.displayModeBar=!0),Re.setBackground!=="transparent"&&typeof Re.setBackground=="function"||(Re.setBackground=L),Re._hasZeroHeight=Re._hasZeroHeight||fe.clientHeight===0,Re._hasZeroWidth=Re._hasZeroWidth||fe.clientWidth===0;var Ze=Re.scrollZoom,Pe=Re._scrollZoom={};if(Ze===!0)Pe.cartesian=1,Pe.gl3d=1,Pe.geo=1,Pe.mapbox=1;else if(typeof Ze=="string"){var Ie=Ze.split("+");for(ke=0;ke<Ie.length;ke++)Pe[Ie[ke]]=1}else Ze!==!1&&(Pe.gl3d=1,Pe.geo=1,Pe.mapbox=1)}function P(fe,ve){var Me,ke,Le=ve+1,ze=[];for(Me=0;Me<fe.length;Me++)(ke=fe[Me])<0?ze.push(Le+ke):ze.push(ke);return ze}function S(fe,ve,Me){var ke,Le;for(ke=0;ke<ve.length;ke++){if((Le=ve[ke])!==parseInt(Le,10))throw new Error("all values in "+Me+" must be integers");if(Le>=fe.data.length||Le<-fe.data.length)throw new Error(Me+" must be valid indices for gd.data.");if(ve.indexOf(Le,ke+1)>-1||Le>=0&&ve.indexOf(-fe.data.length+Le)>-1||Le<0&&ve.indexOf(fe.data.length+Le)>-1)throw new Error("each index in "+Me+" must be unique.")}}function E(fe,ve,Me){if(!Array.isArray(fe.data))throw new Error("gd.data must be an array.");if(ve===void 0)throw new Error("currentIndices is a required argument.");if(Array.isArray(ve)||(ve=[ve]),S(fe,ve,"currentIndices"),Me===void 0||Array.isArray(Me)||(Me=[Me]),Me!==void 0&&S(fe,Me,"newIndices"),Me!==void 0&&ve.length!==Me.length)throw new Error("current and new indices must be of equal length.")}function D(fe,ve,Me,ke,Le){(function(Fe,$e,ot,pt){var _t=y.isPlainObject(pt);if(!Array.isArray(Fe.data))throw new Error("gd.data must be an array");if(!y.isPlainObject($e))throw new Error("update must be a key:value object");if(ot===void 0)throw new Error("indices must be an integer or array of integers");for(var yt in S(Fe,ot,"indices"),$e){if(!Array.isArray($e[yt])||$e[yt].length!==ot.length)throw new Error("attribute "+yt+" must be an array of length equal to indices array length");if(_t&&(!(yt in pt)||!Array.isArray(pt[yt])||pt[yt].length!==$e[yt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}})(fe,ve,Me,ke);for(var ze=function(Fe,$e,ot,pt){var _t,yt,tt,Ke,vt,Nt=y.isPlainObject(pt),qt=[];for(var er in Array.isArray(ot)||(ot=[ot]),ot=P(ot,Fe.data.length-1),$e)for(var Jt=0;Jt<ot.length;Jt++){if(_t=Fe.data[ot[Jt]],yt=(tt=e(_t,er)).get(),Ke=$e[er][Jt],!y.isArrayOrTypedArray(Ke))throw new Error("attribute: "+er+" index: "+Jt+" must be an array");if(!y.isArrayOrTypedArray(yt))throw new Error("cannot extend missing or non-array attribute: "+er);if(yt.constructor!==Ke.constructor)throw new Error("cannot extend array with an array of a different type: "+er);vt=Nt?pt[er][Jt]:pt,g(vt)||(vt=-1),qt.push({prop:tt,target:yt,insert:Ke,maxp:Math.floor(vt)})}return qt}(fe,ve,Me,ke),Re={},Oe={},Ze=0;Ze<ze.length;Ze++){var Pe=ze[Ze].prop,Ie=ze[Ze].maxp,Be=Le(ze[Ze].target,ze[Ze].insert,Ie);Pe.set(Be[0]),Array.isArray(Re[Pe.astr])||(Re[Pe.astr]=[]),Re[Pe.astr].push(Be[1]),Array.isArray(Oe[Pe.astr])||(Oe[Pe.astr]=[]),Oe[Pe.astr].push(ze[Ze].target.length)}return{update:Re,maxPoints:Oe}}function R(fe,ve){var Me=new fe.constructor(fe.length+ve.length);return Me.set(fe),Me.set(ve,fe.length),Me}function H(fe,ve,Me,ke){fe=y.getGraphDiv(fe),x.clearPromiseQueue(fe);var Le={};if(typeof ve=="string")Le[ve]=Me;else{if(!y.isPlainObject(ve))return y.warn("Restyle fail.",ve,Me,ke),Promise.reject();Le=y.extendFlat({},ve),ke===void 0&&(ke=Me)}Object.keys(Le).length&&(fe.changed=!0);var ze=x.coerceTraceIndices(fe,ke),Re=G(fe,Le,ze),Oe=Re.flags;Oe.calc&&(fe.calcdata=void 0),Oe.clearAxisTypes&&x.clearAxisTypes(fe,ze,{});var Ze=[];Oe.fullReplot?Ze.push(Z._doPlot):(Ze.push(m.previousPromises),m.supplyDefaults(fe),Oe.markerSize&&(m.doCalcdata(fe),B(Ze)),Oe.style&&Ze.push(c.doTraceStyle),Oe.colorbars&&Ze.push(c.doColorBars),Ze.push(k)),Ze.push(m.rehover,m.redrag,m.reselect),t.add(fe,H,[fe,Re.undoit,Re.traces],H,[fe,Re.redoit,Re.traces]);var Pe=y.syncOrAsync(Ze,fe);return Pe&&Pe.then||(Pe=Promise.resolve()),Pe.then(function(){return fe.emit("plotly_restyle",Re.eventData),fe})}function V(fe){return fe===void 0?null:fe}function X(fe,ve){return ve?function(Me,ke,Le){var ze=e(Me,ke),Re=ze.set;return ze.set=function(Oe){$((Le||"")+ke,ze.get(),Oe,fe),Re(Oe)},ze}:e}function $(fe,ve,Me,ke){if(Array.isArray(ve)||Array.isArray(Me))for(var Le=Array.isArray(ve)?ve:[],ze=Array.isArray(Me)?Me:[],Re=Math.max(Le.length,ze.length),Oe=0;Oe<Re;Oe++)$(fe+"["+Oe+"]",Le[Oe],ze[Oe],ke);else if(y.isPlainObject(ve)||y.isPlainObject(Me)){var Ze=y.isPlainObject(ve)?ve:{},Pe=y.isPlainObject(Me)?Me:{},Ie=y.extendFlat({},Ze,Pe);for(var Be in Ie)$(fe+"."+Be,Ze[Be],Pe[Be],ke)}else ke[fe]===void 0&&(ke[fe]=V(ve))}function G(fe,ve,Me){var ke,Le=fe._fullLayout,ze=fe._fullData,Re=fe.data,Oe=Le._guiEditing,Ze=X(Le._preGUI,Oe),Pe=y.extendDeepAll({},ve);W(ve);var Ie,Be=T.traceFlags(),Fe={},$e={};function ot(){return Me.map(function(){})}function pt(nt){var ft=o.id2name(nt);Ie.indexOf(ft)===-1&&Ie.push(ft)}function _t(nt){return"LAYOUT"+nt+".autorange"}function yt(nt){return"LAYOUT"+nt+".range"}function tt(nt){for(var ft=nt;ft<ze.length;ft++)if(ze[ft]._input===Re[nt])return ze[ft]}function Ke(nt,ft,Mt){if(Array.isArray(nt))nt.forEach(function(jt){Ke(jt,ft,Mt)});else if(!(nt in ve)&&!x.hasParent(ve,nt)){var Rt;if(nt.substr(0,6)==="LAYOUT")Rt=Ze(fe.layout,nt.replace("LAYOUT",""));else{var Gt=Me[Mt];Rt=X(Le._tracePreGUI[tt(Gt)._fullInput.uid],Oe)(Re[Gt],nt)}nt in $e||($e[nt]=ot()),$e[nt][Mt]===void 0&&($e[nt][Mt]=V(Rt.get())),ft!==void 0&&Rt.set(ft)}}function vt(nt){return function(ft){return ze[ft][nt]}}function Nt(nt){return function(ft,Mt){return ft===!1?ze[Me[Mt]][nt]:null}}for(var qt in ve){if(x.hasParent(ve,qt))throw new Error("cannot set "+qt+" and a parent attribute simultaneously");var er,Jt,ir,Ht,Ue,We,he=ve[qt];if(qt!=="autobinx"&&qt!=="autobiny"||(qt=qt.charAt(qt.length-1)+"bins",he=Array.isArray(he)?he.map(Nt(qt)):he===!1?Me.map(vt(qt)):null),Fe[qt]=he,qt.substr(0,6)!=="LAYOUT"){for($e[qt]=ot(),ke=0;ke<Me.length;ke++)if(er=Re[Me[ke]],Jt=tt(Me[ke]),Ht=(ir=X(Le._tracePreGUI[Jt._fullInput.uid],Oe)(er,qt)).get(),(Ue=Array.isArray(he)?he[ke%he.length]:he)!==void 0){var xe=ir.parts[ir.parts.length-1],De=qt.substr(0,qt.length-xe.length-1),qe=De?De+".":"",Xe=De?e(Jt,De).get():Jt;if((We=r.getTraceValObject(Jt,ir.parts))&&We.impliedEdits&&Ue!==null)for(var He in We.impliedEdits)Ke(y.relativeAttr(qt,He),We.impliedEdits[He],ke);else if(xe!=="thicknessmode"&&xe!=="lenmode"||Ht===Ue||Ue!=="fraction"&&Ue!=="pixels"||!Xe){if(qt==="type"&&(Ue==="pie"!=(Ht==="pie")||Ue==="funnelarea"!=(Ht==="funnelarea"))){var st="x",it="y";Ue!=="bar"&&Ht!=="bar"||er.orientation!=="h"||(st="y",it="x"),y.swapAttrs(er,["?","?src"],"labels",st),y.swapAttrs(er,["d?","?0"],"label",st),y.swapAttrs(er,["?","?src"],"values",it),Ht==="pie"||Ht==="funnelarea"?(e(er,"marker.color").set(e(er,"marker.colors").get()),Le._pielayer.selectAll("g.trace").remove()):a.traceIs(er,"cartesian")&&e(er,"marker.colors").set(e(er,"marker.color").get())}}else{var Tt=Le._size,Pt=Xe.orient,rt=Pt==="top"||Pt==="bottom";if(xe==="thicknessmode"){var ut=rt?Tt.h:Tt.w;Ke(qe+"thickness",Xe.thickness*(Ue==="fraction"?1/ut:ut),ke)}else{var Ft=rt?Tt.w:Tt.h;Ke(qe+"len",Xe.len*(Ue==="fraction"?1/Ft:Ft),ke)}}if($e[qt][ke]=V(Ht),["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(qt)!==-1){if(qt==="orientation"){ir.set(Ue);var wt=er.x&&!er.y?"h":"v";if((ir.get()||wt)===Jt.orientation)continue}else qt==="orientationaxes"&&(er.orientation={v:"h",h:"v"}[Jt.orientation]);x.swapXYData(er),Be.calc=Be.clearAxisTypes=!0}else m.dataArrayContainers.indexOf(ir.parts[0])!==-1?(x.manageArrayContainers(ir,Ue,$e),Be.calc=!0):(We?We.arrayOk&&!a.traceIs(Jt,"regl")&&(y.isArrayOrTypedArray(Ue)||y.isArrayOrTypedArray(Ht))?Be.calc=!0:T.update(Be,We):Be.calc=!0,ir.set(Ue))}if(["swapxyaxes","orientationaxes"].indexOf(qt)!==-1&&o.swap(fe,Me),qt==="orientationaxes"){var Lt=e(fe.layout,"hovermode"),Ae=Lt.get();Ae==="x"?Lt.set("y"):Ae==="y"?Lt.set("x"):Ae==="x unified"?Lt.set("y unified"):Ae==="y unified"&&Lt.set("x unified")}if(["orientation","type"].indexOf(qt)!==-1){for(Ie=[],ke=0;ke<Me.length;ke++){var Ye=Re[Me[ke]];a.traceIs(Ye,"cartesian")&&(pt(Ye.xaxis||"x"),pt(Ye.yaxis||"y"))}Ke(Ie.map(_t),!0,0),Ke(Ie.map(yt),[0,1],0)}}else ir=Ze(fe.layout,qt.replace("LAYOUT","")),$e[qt]=[V(ir.get())],ir.set(Array.isArray(he)?he[0]:he),Be.calc=!0}return(Be.calc||Be.plot)&&(Be.fullReplot=!0),{flags:Be,undoit:$e,redoit:Fe,traces:Me,eventData:y.extendDeepNoArrays([],[Pe,Me])}}function W(fe){var ve,Me,ke,Le=y.counterRegex("axis",".title",!1,!1),ze=/colorbar\.title$/,Re=Object.keys(fe);for(ve=0;ve<Re.length;ve++)Me=Re[ve],ke=fe[Me],Me!=="title"&&!Le.test(Me)&&!ze.test(Me)||typeof ke!="string"&&typeof ke!="number"?Me.indexOf("titlefont")>-1&&Me.indexOf("grouptitlefont")===-1?Oe(Me,Me.replace("titlefont","title.font")):Me.indexOf("titleposition")>-1?Oe(Me,Me.replace("titleposition","title.position")):Me.indexOf("titleside")>-1?Oe(Me,Me.replace("titleside","title.side")):Me.indexOf("titleoffset")>-1&&Oe(Me,Me.replace("titleoffset","title.offset")):Oe(Me,Me.replace("title","title.text"));function Oe(Ze,Pe){fe[Pe]=fe[Ze],delete fe[Ze]}}function te(fe,ve,Me){fe=y.getGraphDiv(fe),x.clearPromiseQueue(fe);var ke={};if(typeof ve=="string")ke[ve]=Me;else{if(!y.isPlainObject(ve))return y.warn("Relayout fail.",ve,Me),Promise.reject();ke=y.extendFlat({},ve)}Object.keys(ke).length&&(fe.changed=!0);var Le=Q(fe,ke),ze=Le.flags;ze.calc&&(fe.calcdata=void 0);var Re=[m.previousPromises];ze.layoutReplot?Re.push(c.layoutReplot):Object.keys(ke).length&&(N(fe,ze,Le)||m.supplyDefaults(fe),ze.legend&&Re.push(c.doLegend),ze.layoutstyle&&Re.push(c.layoutStyles),ze.axrange&&B(Re,Le.rangesAltered),ze.ticks&&Re.push(c.doTicksRelayout),ze.modebar&&Re.push(c.doModeBar),ze.camera&&Re.push(c.doCamera),ze.colorbars&&Re.push(c.doColorBars),Re.push(k)),Re.push(m.rehover,m.redrag,m.reselect),t.add(fe,te,[fe,Le.undoit],te,[fe,Le.redoit]);var Oe=y.syncOrAsync(Re,fe);return Oe&&Oe.then||(Oe=Promise.resolve(fe)),Oe.then(function(){return fe.emit("plotly_relayout",Le.eventData),fe})}function N(fe,ve,Me){var ke=fe._fullLayout;if(!ve.axrange)return!1;for(var Le in ve)if(Le!=="axrange"&&ve[Le])return!1;for(var ze in Me.rangesAltered){var Re=o.id2name(ze),Oe=fe.layout[Re],Ze=ke[Re];if(Ze.autorange=Oe.autorange,Oe.range&&(Ze.range=Oe.range.slice()),Ze.cleanRange(),Ze._matchGroup){for(var Pe in Ze._matchGroup)if(Pe!==ze){var Ie=ke[o.id2name(Pe)];Ie.autorange=Ze.autorange,Ie.range=Ze.range.slice(),Ie._input.range=Ze.range.slice()}}}return!0}function B(fe,ve){var Me=ve?function(ke){var Le=[],ze=!0;for(var Re in ve){var Oe=o.getFromId(ke,Re);if(Le.push(Re),(Oe.ticklabelposition||"").indexOf("inside")!==-1&&Oe._anchorAxis&&Le.push(Oe._anchorAxis._id),Oe._matchGroup)for(var Ze in Oe._matchGroup)ve[Ze]||Le.push(Ze);Oe.automargin&&(ze=!1)}return o.draw(ke,Le,{skipTitle:ze})}:function(ke){return o.draw(ke,"redraw")};fe.push(h,c.doAutoRangeAndConstraints,Me,c.drawData,c.finalDraw)}var U=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,ee=/^[xyz]axis[0-9]*\.autorange$/,j=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function Q(fe,ve){var Me,ke,Le,ze=fe.layout,Re=fe._fullLayout,Oe=Re._guiEditing,Ze=X(Re._preGUI,Oe),Pe=Object.keys(ve),Ie=o.list(fe),Be=y.extendDeepAll({},ve),Fe={};for(W(ve),Pe=Object.keys(ve),ke=0;ke<Pe.length;ke++)if(Pe[ke].indexOf("allaxes")===0){for(Le=0;Le<Ie.length;Le++){var $e=Ie[Le]._id.substr(1),ot=$e.indexOf("scene")!==-1?$e+".":"",pt=Pe[ke].replace("allaxes",ot+Ie[Le]._name);ve[pt]||(ve[pt]=ve[Pe[ke]])}delete ve[Pe[ke]]}var _t=T.layoutFlags(),yt={},tt={};function Ke(Gt,jt){if(Array.isArray(Gt))Gt.forEach(function(Ar){Ke(Ar,jt)});else if(!(Gt in ve)&&!x.hasParent(ve,Gt)){var pr=Ze(ze,Gt);Gt in tt||(tt[Gt]=V(pr.get())),jt!==void 0&&pr.set(jt)}}var vt,Nt={};function qt(Gt){var jt=o.name2id(Gt.split(".")[0]);return Nt[jt]=1,jt}for(var er in ve){if(x.hasParent(ve,er))throw new Error("cannot set "+er+" and a parent attribute simultaneously");for(var Jt=Ze(ze,er),ir=ve[er],Ht=Jt.parts.length-1;Ht>0&&typeof Jt.parts[Ht]!="string";)Ht--;var Ue=Jt.parts[Ht],We=Jt.parts[Ht-1]+"."+Ue,he=Jt.parts.slice(0,Ht).join("."),xe=e(fe.layout,he).get(),De=e(Re,he).get(),qe=Jt.get();if(ir!==void 0){yt[er]=ir,tt[er]=Ue==="reverse"?ir:V(qe);var Xe=r.getLayoutValObject(Re,Jt.parts);if(Xe&&Xe.impliedEdits&&ir!==null)for(var He in Xe.impliedEdits)Ke(y.relativeAttr(er,He),Xe.impliedEdits[He]);if(["width","height"].indexOf(er)!==-1)if(ir){Ke("autosize",null);var st=er==="height"?"width":"height";Ke(st,Re[st])}else Re[er]=fe._initialAutoSize[er];else if(er==="autosize")Ke("width",ir?null:Re.width),Ke("height",ir?null:Re.height);else if(We.match(U))qt(We),e(Re,he+"._inputRange").set(null);else if(We.match(ee)){qt(We),e(Re,he+"._inputRange").set(null);var it=e(Re,he).get();it._inputDomain&&(it._input.domain=it._inputDomain.slice())}else We.match(j)&&e(Re,he+"._inputDomain").set(null);if(Ue==="type"){vt=xe;var Tt=De.type==="linear"&&ir==="log",Pt=De.type==="log"&&ir==="linear";if(Tt||Pt){if(vt&&vt.range)if(De.autorange)Tt&&(vt.range=vt.range[1]>vt.range[0]?[1,2]:[2,1]);else{var rt=vt.range[0],ut=vt.range[1];Tt?(rt<=0&&ut<=0&&Ke(he+".autorange",!0),rt<=0?rt=ut/1e6:ut<=0&&(ut=rt/1e6),Ke(he+".range[0]",Math.log(rt)/Math.LN10),Ke(he+".range[1]",Math.log(ut)/Math.LN10)):(Ke(he+".range[0]",Math.pow(10,rt)),Ke(he+".range[1]",Math.pow(10,ut)))}else Ke(he+".autorange",!0);Array.isArray(Re._subplots.polar)&&Re._subplots.polar.length&&Re[Jt.parts[0]]&&Jt.parts[1]==="radialaxis"&&delete Re[Jt.parts[0]]._subplot.viewInitial["radialaxis.range"],a.getComponentMethod("annotations","convertCoords")(fe,De,ir,Ke),a.getComponentMethod("images","convertCoords")(fe,De,ir,Ke)}else Ke(he+".autorange",!0),Ke(he+".range",null);e(Re,he+"._inputRange").set(null)}else if(Ue.match(_)){var Ft=e(Re,er).get(),wt=(ir||{}).type;wt&&wt!=="-"||(wt="linear"),a.getComponentMethod("annotations","convertCoords")(fe,Ft,wt,Ke),a.getComponentMethod("images","convertCoords")(fe,Ft,wt,Ke)}var Lt=s.containerArrayMatch(er);if(Lt){Me=Lt.array,ke=Lt.index;var Ae=Lt.property,Ye=Xe||{editType:"calc"};ke!==""&&Ae===""&&(s.isAddVal(ir)?tt[er]=null:s.isRemoveVal(ir)?tt[er]=(e(ze,Me).get()||[])[ke]:y.warn("unrecognized full object value",ve)),T.update(_t,Ye),Fe[Me]||(Fe[Me]={});var nt=Fe[Me][ke];nt||(nt=Fe[Me][ke]={}),nt[Ae]=ir,delete ve[er]}else Ue==="reverse"?(xe.range?xe.range.reverse():(Ke(he+".autorange",!0),xe.range=[1,0]),De.autorange?_t.calc=!0:_t.plot=!0):(er==="dragmode"&&(ir===!1&&qe!==!1||ir!==!1&&qe===!1)||Re._has("scatter-like")&&Re._has("regl")&&er==="dragmode"&&(ir==="lasso"||ir==="select")&&qe!=="lasso"&&qe!=="select"||Re._has("gl2d")?_t.plot=!0:Xe?T.update(_t,Xe):_t.calc=!0,Jt.set(ir))}}for(Me in Fe)s.applyContainerArrayChanges(fe,Ze(ze,Me),Fe[Me],_t,Ze)||(_t.plot=!0);for(var ft in Nt){var Mt=(vt=o.getFromId(fe,ft))&&vt._constraintGroup;if(Mt)for(var Rt in _t.calc=!0,Mt)Nt[Rt]||(o.getFromId(fe,Rt)._constraintShrinkable=!0)}return(K(fe)||ve.height||ve.width)&&(_t.plot=!0),(_t.plot||_t.calc)&&(_t.layoutReplot=!0),{flags:_t,rangesAltered:Nt,undoit:tt,redoit:yt,eventData:Be}}function K(fe){var ve=fe._fullLayout,Me=ve.width,ke=ve.height;return fe.layout.autosize&&m.plotAutoSize(fe,fe.layout,ve),ve.width!==Me||ve.height!==ke}function re(fe,ve,Me,ke){fe=y.getGraphDiv(fe),x.clearPromiseQueue(fe),y.isPlainObject(ve)||(ve={}),y.isPlainObject(Me)||(Me={}),Object.keys(ve).length&&(fe.changed=!0),Object.keys(Me).length&&(fe.changed=!0);var Le=x.coerceTraceIndices(fe,ke),ze=G(fe,y.extendFlat({},ve),Le),Re=ze.flags,Oe=Q(fe,y.extendFlat({},Me)),Ze=Oe.flags;(Re.calc||Ze.calc)&&(fe.calcdata=void 0),Re.clearAxisTypes&&x.clearAxisTypes(fe,Le,Me);var Pe=[];Ze.layoutReplot?Pe.push(c.layoutReplot):Re.fullReplot?Pe.push(Z._doPlot):(Pe.push(m.previousPromises),N(fe,Ze,Oe)||m.supplyDefaults(fe),Re.style&&Pe.push(c.doTraceStyle),(Re.colorbars||Ze.colorbars)&&Pe.push(c.doColorBars),Ze.legend&&Pe.push(c.doLegend),Ze.layoutstyle&&Pe.push(c.layoutStyles),Ze.axrange&&B(Pe,Oe.rangesAltered),Ze.ticks&&Pe.push(c.doTicksRelayout),Ze.modebar&&Pe.push(c.doModeBar),Ze.camera&&Pe.push(c.doCamera),Pe.push(k)),Pe.push(m.rehover,m.redrag,m.reselect),t.add(fe,re,[fe,ze.undoit,Oe.undoit,ze.traces],re,[fe,ze.redoit,Oe.redoit,ze.traces]);var Ie=y.syncOrAsync(Pe,fe);return Ie&&Ie.then||(Ie=Promise.resolve(fe)),Ie.then(function(){return fe.emit("plotly_update",{data:ze.eventData,layout:Oe.eventData}),fe})}function ne(fe){return function(ve){ve._fullLayout._guiEditing=!0;var Me=fe.apply(null,arguments);return ve._fullLayout._guiEditing=!1,Me}}var le=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],oe=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function de(fe,ve){for(var Me=0;Me<ve.length;Me++){var ke=ve[Me],Le=fe.match(ke.pattern);if(Le){var ze=Le[1]||"";return{head:ze,tail:fe.substr(ze.length+1),attr:ke.attr}}}}function se(fe,ve){var Me=e(ve,fe).get();if(Me!==void 0)return Me;var ke=fe.split(".");for(ke.pop();ke.length>1;)if(ke.pop(),(Me=e(ve,ke.join(".")+".uirevision").get())!==void 0)return Me;return ve.uirevision}function me(fe,ve){for(var Me=0;Me<ve.length;Me++)if(ve[Me]._fullInput.uid===fe)return Me;return-1}function Te(fe,ve,Me){for(var ke=0;ke<ve.length;ke++)if(ve[ke].uid===fe)return ke;return!ve[Me]||ve[Me].uid?-1:Me}function _e(fe,ve){var Me=y.isPlainObject(fe),ke=Array.isArray(fe);return Me||ke?(Me&&y.isPlainObject(ve)||ke&&Array.isArray(ve))&&JSON.stringify(fe)===JSON.stringify(ve):fe===ve}function be(fe,ve,Me,ke){var Le,ze,Re,Oe=ke.getValObject,Ze=ke.flags,Pe=ke.immutable,Ie=ke.inArray,Be=ke.arrayIndex;function Fe(){var xe=Le.editType;Ie&&xe.indexOf("arraydraw")!==-1?y.pushUnique(Ze.arrays[Ie],Be):(T.update(Ze,Le),xe!=="none"&&Ze.nChanges++,ke.transition&&Le.anim&&Ze.nChangesAnim++,(U.test(Re)||ee.test(Re))&&(Ze.rangesAltered[Me[0]]=1),j.test(Re)&&e(ve,"_inputDomain").set(null),ze==="datarevision"&&(Ze.newDataRevision=1))}function $e(xe){return xe.valType==="data_array"||xe.arrayOk}for(ze in fe){if(Ze.calc&&!ke.transition)return;var ot=fe[ze],pt=ve[ze],_t=Me.concat(ze);if(Re=_t.join("."),ze.charAt(0)!=="_"&&typeof ot!="function"&&ot!==pt){if((ze==="tick0"||ze==="dtick")&&Me[0]!=="geo"){var yt=ve.tickmode;if(yt==="auto"||yt==="array"||!yt)continue}if((ze!=="range"||!ve.autorange)&&(ze!=="zmin"&&ze!=="zmax"||ve.type!=="contourcarpet")&&(Le=Oe(_t))&&(!Le._compareAsJSON||JSON.stringify(ot)!==JSON.stringify(pt))){var tt,Ke=Le.valType,vt=$e(Le),Nt=Array.isArray(ot),qt=Array.isArray(pt);if(Nt&&qt){var er="_input_"+ze,Jt=fe[er],ir=ve[er];if(Array.isArray(Jt)&&Jt===ir)continue}if(pt===void 0)vt&&Nt?Ze.calc=!0:Fe();else if(Le._isLinkedToArray){var Ht=[],Ue=!1;Ie||(Ze.arrays[ze]=Ht);var We=Math.min(ot.length,pt.length),he=Math.max(ot.length,pt.length);if(We!==he){if(Le.editType!=="arraydraw"){Fe();continue}Ue=!0}for(tt=0;tt<We;tt++)be(ot[tt],pt[tt],_t.concat(tt),y.extendFlat({inArray:ze,arrayIndex:tt},ke));if(Ue)for(tt=We;tt<he;tt++)Ht.push(tt)}else!Ke&&y.isPlainObject(ot)?be(ot,pt,_t,ke):vt?Nt&&qt?(Pe&&(Ze.calc=!0),(Pe||ke.newDataRevision)&&Fe()):Nt!==qt?Ze.calc=!0:Fe():Nt&&qt&&ot.length===pt.length&&String(ot)===String(pt)||Fe()}}}for(ze in ve)if(!(ze in fe)&&ze.charAt(0)!=="_"&&typeof ve[ze]!="function"){if($e(Le=Oe(Me.concat(ze)))&&Array.isArray(ve[ze]))return void(Ze.calc=!0);Fe()}}function Ce(fe){var ve=fe._fullLayout,Me=fe.getBoundingClientRect();if(!y.equalDomRects(Me,ve._lastBBox)){var ke=ve._invTransform=y.inverseTransformMatrix(y.getFullTransformMatrix(fe));ve._invScaleX=Math.sqrt(ke[0][0]*ke[0][0]+ke[0][1]*ke[0][1]+ke[0][2]*ke[0][2]),ve._invScaleY=Math.sqrt(ke[1][0]*ke[1][0]+ke[1][1]*ke[1][1]+ke[1][2]*ke[1][2]),ve._lastBBox=Me}}Z.animate=function(fe,ve,Me){if(fe=y.getGraphDiv(fe),!y.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var ke=fe._transitionData;ke._frameQueue||(ke._frameQueue=[]);var Le=(Me=m.supplyAnimationDefaults(Me)).transition,ze=Me.frame;function Re(Pe){return Array.isArray(Le)?Pe>=Le.length?Le[0]:Le[Pe]:Le}function Oe(Pe){return Array.isArray(ze)?Pe>=ze.length?ze[0]:ze[Pe]:ze}function Ze(Pe,Ie){var Be=0;return function(){if(Pe&&++Be===Ie)return Pe()}}return ke._frameWaitingCnt===void 0&&(ke._frameWaitingCnt=0),new Promise(function(Pe,Ie){function Be(){ke._currentFrame&&ke._currentFrame.onComplete&&ke._currentFrame.onComplete();var Jt=ke._currentFrame=ke._frameQueue.shift();if(Jt){var ir=Jt.name?Jt.name.toString():null;fe._fullLayout._currentFrame=ir,ke._lastFrameAt=Date.now(),ke._timeToNext=Jt.frameOpts.duration,m.transition(fe,Jt.frame.data,Jt.frame.layout,x.coerceTraceIndices(fe,Jt.frame.traces),Jt.frameOpts,Jt.transitionOpts).then(function(){Jt.onComplete&&Jt.onComplete()}),fe.emit("plotly_animatingframe",{name:ir,frame:Jt.frame,animation:{frame:Jt.frameOpts,transition:Jt.transitionOpts}})}else fe.emit("plotly_animated"),window.cancelAnimationFrame(ke._animationRaf),ke._animationRaf=null}function Fe(){fe.emit("plotly_animating"),ke._lastFrameAt=-1/0,ke._timeToNext=0,ke._runningTransitions=0,ke._currentFrame=null;var Jt=function(){ke._animationRaf=window.requestAnimationFrame(Jt),Date.now()-ke._lastFrameAt>ke._timeToNext&&Be()};Jt()}var $e,ot,pt=0;function _t(Jt){return Array.isArray(Le)?pt>=Le.length?Jt.transitionOpts=Le[pt]:Jt.transitionOpts=Le[0]:Jt.transitionOpts=Le,pt++,Jt}var yt=[],tt=ve==null,Ke=Array.isArray(ve);if(!tt&&!Ke&&y.isPlainObject(ve))yt.push({type:"object",data:_t(y.extendFlat({},ve))});else if(tt||["string","number"].indexOf(typeof ve)!==-1)for($e=0;$e<ke._frames.length;$e++)(ot=ke._frames[$e])&&(tt||String(ot.group)===String(ve))&&yt.push({type:"byname",name:String(ot.name),data:_t({name:ot.name})});else if(Ke)for($e=0;$e<ve.length;$e++){var vt=ve[$e];["number","string"].indexOf(typeof vt)!==-1?(vt=String(vt),yt.push({type:"byname",name:vt,data:_t({name:vt})})):y.isPlainObject(vt)&&yt.push({type:"object",data:_t(y.extendFlat({},vt))})}for($e=0;$e<yt.length;$e++)if((ot=yt[$e]).type==="byname"&&!ke._frameHash[ot.data.name])return y.warn('animate failure: frame not found: "'+ot.data.name+'"'),void Ie();["next","immediate"].indexOf(Me.mode)!==-1&&function(){if(ke._frameQueue.length!==0){for(;ke._frameQueue.length;){var Jt=ke._frameQueue.pop();Jt.onInterrupt&&Jt.onInterrupt()}fe.emit("plotly_animationinterrupted",[])}}(),Me.direction==="reverse"&&yt.reverse();var Nt=fe._fullLayout._currentFrame;if(Nt&&Me.fromcurrent){var qt=-1;for($e=0;$e<yt.length;$e++)if((ot=yt[$e]).type==="byname"&&ot.name===Nt){qt=$e;break}if(qt>0&&qt<yt.length-1){var er=[];for($e=0;$e<yt.length;$e++)ot=yt[$e],(yt[$e].type!=="byname"||$e>qt)&&er.push(ot);yt=er}}yt.length>0?function(Jt){if(Jt.length!==0){for(var ir=0;ir<Jt.length;ir++){var Ht;Ht=Jt[ir].type==="byname"?m.computeFrame(fe,Jt[ir].name):Jt[ir].data;var Ue=Oe(ir),We=Re(ir);We.duration=Math.min(We.duration,Ue.duration);var he={frame:Ht,name:Jt[ir].name,frameOpts:Ue,transitionOpts:We};ir===Jt.length-1&&(he.onComplete=Ze(Pe,2),he.onInterrupt=Ie),ke._frameQueue.push(he)}Me.mode==="immediate"&&(ke._lastFrameAt=-1/0),ke._animationRaf||Fe()}}(yt):(fe.emit("plotly_animated"),Pe())})},Z.addFrames=function(fe,ve,Me){if(fe=y.getGraphDiv(fe),ve==null)return Promise.resolve();if(!y.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var ke,Le,ze,Re,Oe=fe._transitionData._frames,Ze=fe._transitionData._frameHash;if(!Array.isArray(ve))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+ve);var Pe=Oe.length+2*ve.length,Ie=[],Be={};for(ke=ve.length-1;ke>=0;ke--)if(y.isPlainObject(ve[ke])){var Fe=ve[ke].name,$e=(Ze[Fe]||Be[Fe]||{}).name,ot=ve[ke].name,pt=Ze[$e]||Be[$e];$e&&ot&&typeof ot=="number"&&pt&&w<5&&(w++,y.warn('addFrames: overwriting frame "'+(Ze[$e]||Be[$e]).name+'" with a frame whose name of type "number" also equates to "'+$e+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),w===5&&y.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Be[Fe]={name:Fe},Ie.push({frame:m.supplyFrameDefaults(ve[ke]),index:Me&&Me[ke]!==void 0&&Me[ke]!==null?Me[ke]:Pe+ke})}Ie.sort(function(er,Jt){return er.index>Jt.index?-1:er.index<Jt.index?1:0});var _t=[],yt=[],tt=Oe.length;for(ke=Ie.length-1;ke>=0;ke--){if(typeof(Le=Ie[ke].frame).name=="number"&&y.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!Le.name)for(;Ze[Le.name="frame "+fe._transitionData._counter++];);if(Ze[Le.name]){for(ze=0;ze<Oe.length&&(Oe[ze]||{}).name!==Le.name;ze++);_t.push({type:"replace",index:ze,value:Le}),yt.unshift({type:"replace",index:ze,value:Oe[ze]})}else Re=Math.max(0,Math.min(Ie[ke].index,tt)),_t.push({type:"insert",index:Re,value:Le}),yt.unshift({type:"delete",index:Re}),tt++}var Ke=m.modifyFrames,vt=m.modifyFrames,Nt=[fe,yt],qt=[fe,_t];return t&&t.add(fe,Ke,Nt,vt,qt),m.modifyFrames(fe,_t)},Z.deleteFrames=function(fe,ve){if(fe=y.getGraphDiv(fe),!y.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe);var Me,ke,Le=fe._transitionData._frames,ze=[],Re=[];if(!ve)for(ve=[],Me=0;Me<Le.length;Me++)ve.push(Me);for((ve=ve.slice()).sort(),Me=ve.length-1;Me>=0;Me--)ke=ve[Me],ze.push({type:"delete",index:ke}),Re.unshift({type:"insert",index:ke,value:Le[ke]});var Oe=m.modifyFrames,Ze=m.modifyFrames,Pe=[fe,Re],Ie=[fe,ze];return t&&t.add(fe,Oe,Pe,Ze,Ie),m.modifyFrames(fe,ze)},Z.addTraces=function fe(ve,Me,ke){ve=y.getGraphDiv(ve);var Le,ze,Re=[],Oe=Z.deleteTraces,Ze=fe,Pe=[ve,Re],Ie=[ve,Me];for(function(Be,Fe,$e){var ot,pt;if(!Array.isArray(Be.data))throw new Error("gd.data must be an array.");if(Fe===void 0)throw new Error("traces must be defined.");for(Array.isArray(Fe)||(Fe=[Fe]),ot=0;ot<Fe.length;ot++)if(typeof(pt=Fe[ot])!="object"||Array.isArray(pt)||pt===null)throw new Error("all values in traces array must be non-array objects");if($e===void 0||Array.isArray($e)||($e=[$e]),$e!==void 0&&$e.length!==Fe.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(ve,Me,ke),Array.isArray(Me)||(Me=[Me]),Me=Me.map(function(Be){return y.extendFlat({},Be)}),x.cleanData(Me),Le=0;Le<Me.length;Le++)ve.data.push(Me[Le]);for(Le=0;Le<Me.length;Le++)Re.push(-Me.length+Le);if(ke===void 0)return ze=Z.redraw(ve),t.add(ve,Oe,Pe,Ze,Ie),ze;Array.isArray(ke)||(ke=[ke]);try{E(ve,Re,ke)}catch(Be){throw ve.data.splice(ve.data.length-Me.length,Me.length),Be}return t.startSequence(ve),t.add(ve,Oe,Pe,Ze,Ie),ze=Z.moveTraces(ve,Re,ke),t.stopSequence(ve),ze},Z.deleteTraces=function fe(ve,Me){ve=y.getGraphDiv(ve);var ke,Le,ze=[],Re=Z.addTraces,Oe=fe,Ze=[ve,ze,Me],Pe=[ve,Me];if(Me===void 0)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Me)||(Me=[Me]),S(ve,Me,"indices"),(Me=P(Me,ve.data.length-1)).sort(y.sorterDes),ke=0;ke<Me.length;ke+=1)Le=ve.data.splice(Me[ke],1)[0],ze.push(Le);var Ie=Z.redraw(ve);return t.add(ve,Re,Ze,Oe,Pe),Ie},Z.extendTraces=function fe(ve,Me,ke,Le){function ze(Pe,Ie,Be){var Fe,$e;if(y.isTypedArray(Pe))if(Be<0){var ot=new Pe.constructor(0),pt=R(Pe,Ie);Be<0?(Fe=pt,$e=ot):(Fe=ot,$e=pt)}else if(Fe=new Pe.constructor(Be),$e=new Pe.constructor(Pe.length+Ie.length-Be),Be===Ie.length)Fe.set(Ie),$e.set(Pe);else if(Be<Ie.length){var _t=Ie.length-Be;Fe.set(Ie.subarray(_t)),$e.set(Pe),$e.set(Ie.subarray(0,_t),Pe.length)}else{var yt=Be-Ie.length,tt=Pe.length-yt;Fe.set(Pe.subarray(tt)),Fe.set(Ie,yt),$e.set(Pe.subarray(0,tt))}else Fe=Pe.concat(Ie),$e=Be>=0&&Be<Fe.length?Fe.splice(0,Fe.length-Be):[];return[Fe,$e]}var Re=D(ve=y.getGraphDiv(ve),Me,ke,Le,ze),Oe=Z.redraw(ve),Ze=[ve,Re.update,ke,Re.maxPoints];return t.add(ve,Z.prependTraces,Ze,fe,arguments),Oe},Z.moveTraces=function fe(ve,Me,ke){var Le,ze=[],Re=[],Oe=fe,Ze=fe,Pe=[ve=y.getGraphDiv(ve),ke,Me],Ie=[ve,Me,ke];if(E(ve,Me,ke),Me=Array.isArray(Me)?Me:[Me],ke===void 0)for(ke=[],Le=0;Le<Me.length;Le++)ke.push(-Me.length+Le);for(ke=Array.isArray(ke)?ke:[ke],Me=P(Me,ve.data.length-1),ke=P(ke,ve.data.length-1),Le=0;Le<ve.data.length;Le++)Me.indexOf(Le)===-1&&ze.push(ve.data[Le]);for(Le=0;Le<Me.length;Le++)Re.push({newIndex:ke[Le],trace:ve.data[Me[Le]]});for(Re.sort(function(Fe,$e){return Fe.newIndex-$e.newIndex}),Le=0;Le<Re.length;Le+=1)ze.splice(Re[Le].newIndex,0,Re[Le].trace);ve.data=ze;var Be=Z.redraw(ve);return t.add(ve,Oe,Pe,Ze,Ie),Be},Z.prependTraces=function fe(ve,Me,ke,Le){function ze(Pe,Ie,Be){var Fe,$e;if(y.isTypedArray(Pe))if(Be<=0){var ot=new Pe.constructor(0),pt=R(Ie,Pe);Be<0?(Fe=pt,$e=ot):(Fe=ot,$e=pt)}else if(Fe=new Pe.constructor(Be),$e=new Pe.constructor(Pe.length+Ie.length-Be),Be===Ie.length)Fe.set(Ie),$e.set(Pe);else if(Be<Ie.length){var _t=Ie.length-Be;Fe.set(Ie.subarray(0,_t)),$e.set(Ie.subarray(_t)),$e.set(Pe,_t)}else{var yt=Be-Ie.length;Fe.set(Ie),Fe.set(Pe.subarray(0,yt),Ie.length),$e.set(Pe.subarray(yt))}else Fe=Ie.concat(Pe),$e=Be>=0&&Be<Fe.length?Fe.splice(Be,Fe.length):[];return[Fe,$e]}var Re=D(ve=y.getGraphDiv(ve),Me,ke,Le,ze),Oe=Z.redraw(ve),Ze=[ve,Re.update,ke,Re.maxPoints];return t.add(ve,Z.extendTraces,Ze,fe,arguments),Oe},Z.newPlot=function(fe,ve,Me,ke){return fe=y.getGraphDiv(fe),m.cleanPlot([],{},fe._fullData||[],fe._fullLayout||{}),m.purge(fe),Z._doPlot(fe,ve,Me,ke)},Z._doPlot=function(fe,ve,Me,ke){var Le;if(fe=y.getGraphDiv(fe),n.init(fe),y.isPlainObject(ve)){var ze=ve;ve=ze.data,Me=ze.layout,ke=ze.config,Le=ze.frames}if(n.triggerHandler(fe,"plotly_beforeplot",[ve,Me,ke])===!1)return Promise.reject();ve||Me||y.isPlotDiv(fe)||y.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",fe),I(fe,ke),Me||(Me={}),p.select(fe).classed("js-plotly-plot",!0),i.makeTester(),Array.isArray(fe._promises)||(fe._promises=[]);var Re=(fe.data||[]).length===0&&Array.isArray(ve);Array.isArray(ve)&&(x.cleanData(ve),Re?fe.data=ve:fe.data.push.apply(fe.data,ve),fe.empty=!1),fe.layout&&!Re||(fe.layout=x.cleanLayout(Me)),m.supplyDefaults(fe);var Oe=fe._fullLayout,Ze=Oe._has("cartesian");Oe._replotting=!0,(Re||Oe._shouldCreateBgLayer)&&(function(yt){var tt=p.select(yt),Ke=yt._fullLayout;if(Ke._calcInverseTransform=Ce,Ke._calcInverseTransform(yt),Ke._container=tt.selectAll(".plot-container").data([0]),Ke._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Ke._paperdiv=Ke._container.selectAll(".svg-container").data([0]),Ke._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Ke._glcontainer=Ke._paperdiv.selectAll(".gl-container").data([{}]),Ke._glcontainer.enter().append("div").classed("gl-container",!0),Ke._paperdiv.selectAll(".main-svg").remove(),Ke._paperdiv.select(".modebar-container").remove(),Ke._paper=Ke._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Ke._toppaper=Ke._paperdiv.append("svg").classed("main-svg",!0),Ke._modebardiv=Ke._paperdiv.append("div"),delete Ke._modeBar,Ke._hoverpaper=Ke._paperdiv.append("svg").classed("main-svg",!0),!Ke._uid){var vt={};p.selectAll("defs").each(function(){this.id&&(vt[this.id.split("-")[1]]=1)}),Ke._uid=y.randstr(vt)}Ke._paperdiv.selectAll(".main-svg").attr(l.svgAttrs),Ke._defs=Ke._paper.append("defs").attr("id","defs-"+Ke._uid),Ke._clips=Ke._defs.append("g").classed("clips",!0),Ke._topdefs=Ke._toppaper.append("defs").attr("id","topdefs-"+Ke._uid),Ke._topclips=Ke._topdefs.append("g").classed("clips",!0),Ke._bgLayer=Ke._paper.append("g").classed("bglayer",!0),Ke._draggers=Ke._paper.append("g").classed("draglayer",!0);var Nt=Ke._paper.append("g").classed("layer-below",!0);Ke._imageLowerLayer=Nt.append("g").classed("imagelayer",!0),Ke._shapeLowerLayer=Nt.append("g").classed("shapelayer",!0),Ke._cartesianlayer=Ke._paper.append("g").classed("cartesianlayer",!0),Ke._polarlayer=Ke._paper.append("g").classed("polarlayer",!0),Ke._smithlayer=Ke._paper.append("g").classed("smithlayer",!0),Ke._ternarylayer=Ke._paper.append("g").classed("ternarylayer",!0),Ke._geolayer=Ke._paper.append("g").classed("geolayer",!0),Ke._funnelarealayer=Ke._paper.append("g").classed("funnelarealayer",!0),Ke._pielayer=Ke._paper.append("g").classed("pielayer",!0),Ke._iciclelayer=Ke._paper.append("g").classed("iciclelayer",!0),Ke._treemaplayer=Ke._paper.append("g").classed("treemaplayer",!0),Ke._sunburstlayer=Ke._paper.append("g").classed("sunburstlayer",!0),Ke._indicatorlayer=Ke._toppaper.append("g").classed("indicatorlayer",!0),Ke._glimages=Ke._paper.append("g").classed("glimages",!0);var qt=Ke._toppaper.append("g").classed("layer-above",!0);Ke._imageUpperLayer=qt.append("g").classed("imagelayer",!0),Ke._shapeUpperLayer=qt.append("g").classed("shapelayer",!0),Ke._selectionLayer=Ke._toppaper.append("g").classed("selectionlayer",!0),Ke._infolayer=Ke._toppaper.append("g").classed("infolayer",!0),Ke._menulayer=Ke._toppaper.append("g").classed("menulayer",!0),Ke._zoomlayer=Ke._toppaper.append("g").classed("zoomlayer",!0),Ke._hoverlayer=Ke._hoverpaper.append("g").classed("hoverlayer",!0),Ke._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),yt.emit("plotly_framework")}(fe),Oe._shouldCreateBgLayer&&delete Oe._shouldCreateBgLayer),i.initGradients(fe),i.initPatterns(fe),Re&&o.saveShowSpikeInitial(fe);var Pe=!fe.calcdata||fe.calcdata.length!==(fe._fullData||[]).length;Pe&&m.doCalcdata(fe);for(var Ie=0;Ie<fe.calcdata.length;Ie++)fe.calcdata[Ie][0].trace=fe._fullData[Ie];fe._context.responsive?fe._responsiveChartHandler||(fe._responsiveChartHandler=function(){y.isHidden(fe)||m.resize(fe)},window.addEventListener("resize",fe._responsiveChartHandler)):y.clearResponsive(fe);var Be=y.extendFlat({},Oe._size),Fe=0;function $e(){if(m.clearAutoMarginIds(fe),c.drawMarginPushers(fe),o.allowAutoMargin(fe),Oe._has("pie"))for(var yt=fe._fullData,tt=0;tt<yt.length;tt++){var Ke=yt[tt];Ke.type==="pie"&&Ke.automargin&&m.allowAutoMargin(fe,"pie."+Ke.uid+".automargin")}return m.doAutoMargin(fe),m.previousPromises(fe)}function ot(){fe._transitioning||(c.doAutoRangeAndConstraints(fe),Re&&o.saveRangeInitial(fe),a.getComponentMethod("rangeslider","calcAutorange")(fe))}var pt=[m.previousPromises,function(){if(Le)return Z.addFrames(fe,Le)},function yt(){for(var tt=Oe._basePlotModules,Ke=0;Ke<tt.length;Ke++)tt[Ke].drawFramework&&tt[Ke].drawFramework(fe);!Oe._glcanvas&&Oe._has("gl")&&(Oe._glcanvas=Oe._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(er){return er.key}),Oe._glcanvas.enter().append("canvas").attr("class",function(er){return"gl-canvas gl-canvas-"+er.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var vt=fe._context.plotGlPixelRatio;if(Oe._glcanvas){Oe._glcanvas.attr("width",Oe.width*vt).attr("height",Oe.height*vt).style("width",Oe.width+"px").style("height",Oe.height+"px");var Nt=Oe._glcanvas.data()[0].regl;if(Nt&&(Math.floor(Oe.width*vt)!==Nt._gl.drawingBufferWidth||Math.floor(Oe.height*vt)!==Nt._gl.drawingBufferHeight)){var qt="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!Fe)return y.log(qt+" Clearing graph and plotting again."),m.cleanPlot([],{},fe._fullData,Oe),m.supplyDefaults(fe),Oe=fe._fullLayout,m.doCalcdata(fe),Fe++,yt();y.error(qt)}}return Oe.modebar.orientation==="h"?Oe._modebardiv.style("height",null).style("width","100%"):Oe._modebardiv.style("width",null).style("height",Oe.height+"px"),m.previousPromises(fe)},$e,function(){if(m.didMarginChange(Be,Oe._size))return y.syncOrAsync([$e,c.layoutStyles],fe)}];Ze&&pt.push(function(){if(Pe)return y.syncOrAsync([a.getComponentMethod("shapes","calcAutorange"),a.getComponentMethod("annotations","calcAutorange"),ot],fe);ot()}),pt.push(c.layoutStyles),Ze&&pt.push(function(){return o.draw(fe,Re?"":"redraw")},function(yt){yt._fullLayout._insideTickLabelsAutorange&&te(yt,yt._fullLayout._insideTickLabelsAutorange).then(function(){yt._fullLayout._insideTickLabelsAutorange=void 0})}),pt.push(c.drawData,c.finalDraw,f,m.addLinks,m.rehover,m.redrag,m.reselect,m.doAutoMargin,function(yt){yt._fullLayout._insideTickLabelsAutorange&&Re&&o.saveRangeInitial(yt,!0)},m.previousPromises);var _t=y.syncOrAsync(pt,fe);return _t&&_t.then||(_t=Promise.resolve()),_t.then(function(){return k(fe),fe})},Z.purge=function(fe){var ve=(fe=y.getGraphDiv(fe))._fullLayout||{},Me=fe._fullData||[];return m.cleanPlot([],{},Me,ve),m.purge(fe),n.purge(fe),ve._container&&ve._container.remove(),delete fe._context,fe},Z.react=function(fe,ve,Me,ke){var Le,ze;fe=y.getGraphDiv(fe),x.clearPromiseQueue(fe);var Re=fe._fullData,Oe=fe._fullLayout;if(y.isPlotDiv(fe)&&Re&&Oe){if(y.isPlainObject(ve)){var Ze=ve;ve=Ze.data,Me=Ze.layout,ke=Ze.config,Le=Ze.frames}var Pe=!1;if(ke){var Ie=y.extendDeep({},fe._context);fe._context=void 0,I(fe,ke),Pe=function he(xe,De){var qe;for(qe in xe)if(qe.charAt(0)!=="_"){var Xe=xe[qe],He=De[qe];if(Xe!==He)if(y.isPlainObject(Xe)&&y.isPlainObject(He)){if(he(Xe,He))return!0}else{if(!Array.isArray(Xe)||!Array.isArray(He)||Xe.length!==He.length)return!0;for(var st=0;st<Xe.length;st++)if(Xe[st]!==He[st]&&(!y.isPlainObject(Xe[st])||!y.isPlainObject(He[st])||he(Xe[st],He[st])))return!0}}}(Ie,fe._context)}fe.data=ve||[],x.cleanData(fe.data),fe.layout=Me||{},x.cleanLayout(fe.layout),function(he,xe,De,qe){var Xe,He,st,it,Tt,Pt,rt,ut,Ft,wt,Lt=qe._preGUI,Ae=[],Ye={},nt={};for(Xe in Lt){if(Tt=de(Xe,le)){if(Ft=Tt.head,wt=Tt.tail,He=Tt.attr||Ft+".uirevision",(it=(st=e(qe,He).get())&&se(He,xe))&&it===st){if((Pt=Lt[Xe])===null&&(Pt=void 0),_e(ut=(rt=e(xe,Xe)).get(),Pt)){ut===void 0&&wt==="autorange"&&Ae.push(Ft),rt.set(V(e(qe,Xe).get()));continue}if(wt==="autorange"||wt.substr(0,6)==="range["){var ft=Lt[Ft+".range[0]"],Mt=Lt[Ft+".range[1]"],Rt=Lt[Ft+".autorange"];if(Rt||Rt===null&&ft===null&&Mt===null){if(!(Ft in Ye)){var Gt=e(xe,Ft).get();Ye[Ft]=Gt&&(Gt.autorange||Gt.autorange!==!1&&(!Gt.range||Gt.range.length!==2))}if(Ye[Ft]){rt.set(V(e(qe,Xe).get()));continue}}}}}else y.warn("unrecognized GUI edit: "+Xe);delete Lt[Xe],Tt&&Tt.tail.substr(0,6)==="range["&&(nt[Tt.head]=1)}for(var jt=0;jt<Ae.length;jt++){var pr=Ae[jt];if(nt[pr]){var Ar=e(xe,pr).get();Ar&&delete Ar.autorange}}var fr=qe._tracePreGUI;for(var Zt in fr){var Qt,$t=fr[Zt],hr=null;for(Xe in $t){if(!hr){var vr=me(Zt,De);if(vr<0){delete fr[Zt];break}var Mr=Te(Zt,he,(Qt=De[vr]._fullInput).index);if(Mr<0){delete fr[Zt];break}hr=he[Mr]}if(Tt=de(Xe,oe)){if(Tt.attr?it=(st=e(qe,Tt.attr).get())&&se(Tt.attr,xe):(st=Qt.uirevision,(it=hr.uirevision)===void 0&&(it=xe.uirevision)),it&&it===st&&((Pt=$t[Xe])===null&&(Pt=void 0),_e(ut=(rt=e(hr,Xe)).get(),Pt))){rt.set(V(e(Qt,Xe).get()));continue}}else y.warn("unrecognized GUI edit: "+Xe+" in trace uid "+Zt);delete $t[Xe]}}}(fe.data,fe.layout,Re,Oe),m.supplyDefaults(fe,{skipUpdateCalc:!0});var Be=fe._fullData,Fe=fe._fullLayout,$e=Fe.datarevision===void 0,ot=Fe.transition,pt=function(he,xe,De,qe,Xe){var He=T.layoutFlags();function st(it){return r.getLayoutValObject(De,it)}return He.arrays={},He.rangesAltered={},He.nChanges=0,He.nChangesAnim=0,be(xe,De,[],{getValObject:st,flags:He,immutable:qe,transition:Xe,gd:he}),(He.plot||He.calc)&&(He.layoutReplot=!0),Xe&&He.nChanges&&He.nChangesAnim&&(He.anim=He.nChanges===He.nChangesAnim?"all":"some"),He}(fe,Oe,Fe,$e,ot),_t=pt.newDataRevision,yt=function(he,xe,De,qe,Xe,He){var st=xe.length===De.length;if(!Xe&&!st)return{fullReplot:!0,calc:!0};var it,Tt,Pt=T.traceFlags();Pt.arrays={},Pt.nChanges=0,Pt.nChangesAnim=0;var rt={getValObject:function(Ft){var wt=r.getTraceValObject(Tt,Ft);return!Tt._module.animatable&&wt.anim&&(wt.anim=!1),wt},flags:Pt,immutable:qe,transition:Xe,newDataRevision:He,gd:he},ut={};for(it=0;it<xe.length;it++)if(De[it]){if(Tt=De[it]._fullInput,m.hasMakesDataTransform(Tt)&&(Tt=De[it]),ut[Tt.uid])continue;ut[Tt.uid]=1,be(xe[it]._fullInput,Tt,[],rt)}return(Pt.calc||Pt.plot)&&(Pt.fullReplot=!0),Xe&&Pt.nChanges&&Pt.nChangesAnim&&(Pt.anim=Pt.nChanges===Pt.nChangesAnim&&st?"all":"some"),Pt}(fe,Re,Be,$e,ot,_t);if(K(fe)&&(pt.layoutReplot=!0),yt.calc||pt.calc){fe.calcdata=void 0;for(var tt=Object.getOwnPropertyNames(Fe),Ke=0;Ke<tt.length;Ke++){var vt=tt[Ke],Nt=vt.substring(0,5);if(Nt==="xaxis"||Nt==="yaxis"){var qt=Fe[vt]._emptyCategories;qt&&qt()}}}else m.supplyDefaultsUpdateCalc(fe.calcdata,Be);var er=[];if(Le&&(fe._transitionData={},m.createTransitionData(fe),er.push(function(){return Z.addFrames(fe,Le)})),Fe.transition&&!Pe&&(yt.anim||pt.anim))pt.ticks&&er.push(c.doTicksRelayout),m.doCalcdata(fe),c.doAutoRangeAndConstraints(fe),er.push(function(){return m.transitionFromReact(fe,yt,pt,Oe)});else if(yt.fullReplot||pt.layoutReplot||Pe)fe._fullLayout._skipDefaults=!0,er.push(Z._doPlot);else{for(var Jt in pt.arrays){var ir=pt.arrays[Jt];if(ir.length){var Ht=a.getComponentMethod(Jt,"drawOne");if(Ht!==y.noop)for(var Ue=0;Ue<ir.length;Ue++)Ht(fe,ir[Ue]);else{var We=a.getComponentMethod(Jt,"draw");if(We===y.noop)throw new Error("cannot draw components: "+Jt);We(fe)}}}er.push(m.previousPromises),yt.style&&er.push(c.doTraceStyle),(yt.colorbars||pt.colorbars)&&er.push(c.doColorBars),pt.legend&&er.push(c.doLegend),pt.layoutstyle&&er.push(c.layoutStyles),pt.axrange&&B(er),pt.ticks&&er.push(c.doTicksRelayout),pt.modebar&&er.push(c.doModeBar),pt.camera&&er.push(c.doCamera),er.push(k)}er.push(m.rehover,m.redrag,m.reselect),(ze=y.syncOrAsync(er,fe))&&ze.then||(ze=Promise.resolve(fe))}else ze=Z.newPlot(fe,ve,Me,ke);return ze.then(function(){return fe.emit("plotly_react",{data:ve,layout:Me}),fe})},Z.redraw=function(fe){if(fe=y.getGraphDiv(fe),!y.isPlotDiv(fe))throw new Error("This element is not a Plotly plot: "+fe);return x.cleanData(fe.data),x.cleanLayout(fe.layout),fe.calcdata=void 0,Z._doPlot(fe).then(function(){return fe.emit("plotly_redraw"),fe})},Z.relayout=te,Z.restyle=H,Z.setPlotConfig=function(fe){return y.extendFlat(d,fe)},Z.update=re,Z._guiRelayout=ne(te),Z._guiRestyle=ne(H),Z._guiUpdate=ne(re),Z._storeDirectGUIEdit=function(fe,ve,Me){for(var ke in Me)$(ke,e(fe,ke).get(),Me[ke],ve)}},{"../components/color":367,"../components/drawing":389,"../components/selections":455,"../constants/xmlns_namespaces":492,"../lib":515,"../lib/events":504,"../lib/queue":531,"../plots/cartesian/axes":566,"../plots/cartesian/constants":573,"../plots/cartesian/graph_interact":576,"../plots/plots":628,"../registry":647,"./edit_types":548,"./helpers":549,"./manage_arrays":551,"./plot_config":553,"./plot_schema":554,"./subroutines":556,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],553:[function(v,J,Z){var p={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},editSelection:{valType:"boolean",dflt:!0},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},g={};(function b(y,e){for(var n in y){var t=y[n];t.valType?e[n]=t.dflt:(e[n]||(e[n]={}),b(t,e[n]))}})(p,g),J.exports={configAttributes:p,dfltConfig:g}},{}],554:[function(v,J,Z){var p=v("../registry"),g=v("../lib"),b=v("../plots/attributes"),y=v("../plots/layout_attributes"),e=v("../plots/frame_attributes"),n=v("../plots/animation_attributes"),t=v("./plot_config").configAttributes,a=v("./edit_types"),r=g.extendDeepAll,m=g.isPlainObject,o=g.isArrayOrTypedArray,i=g.nestedProperty,u=g.valObjectMeta,f=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function l(_,w,k){if(!_)return!1;if(_._isLinkedToArray){if(h(w[k]))k++;else if(k<w.length)return!1}for(;k<w.length;k++){var L=_[w[k]];if(!m(L)||(_=L,k===w.length-1))break;if(_._isLinkedToArray){if(!h(w[++k]))return!1}else if(_.valType==="info_array"){var A=w[++k];if(!h(A))return!1;var I=_.items;if(Array.isArray(I)){if(A>=I.length)return!1;if(_.dimensions===2){if(k++,w.length===k)return _;var P=w[k];if(!h(P))return!1;_=I[A][P]}else _=I[A]}else _=I}}return _}function h(_){return _===Math.round(_)&&_>=0}function d(){var _,w,k={};for(_ in r(k,y),p.subplotsRegistry)if((w=p.subplotsRegistry[_]).layoutAttributes)if(Array.isArray(w.attr))for(var L=0;L<w.attr.length;L++)c(k,w,w.attr[L]);else c(k,w,w.attr==="subplot"?w.name:w.attr);for(_ in p.componentsRegistry){var A=(w=p.componentsRegistry[_]).schema;if(A&&(A.subplots||A.layout)){var I=A.subplots;if(I&&I.xaxis&&!I.yaxis)for(var P in I.xaxis)delete k.yaxis[P]}else w.name==="colorscale"?r(k,w.layoutAttributes):w.layoutAttributes&&T(k,w.layoutAttributes,w.name)}return{layoutAttributes:x(k)}}function s(){var _={frames:r({},e)};return x(_),_.frames}function x(_){return function(w){Z.crawl(w,function(k,L,A){Z.isValObject(k)?k.arrayOk!==!0&&k.valType!=="data_array"||(A[L+"src"]={valType:"string",editType:"none"}):m(k)&&(k.role="object")})}(_),function(w){Z.crawl(w,function(k,L,A){if(k){var I=k._isLinkedToArray;I&&(delete k._isLinkedToArray,A[L]={items:{}},A[L].items[I]=k,A[L].role="object")}})}(_),function(w){(function k(L){for(var A in L)if(m(L[A]))k(L[A]);else if(Array.isArray(L[A]))for(var I=0;I<L[A].length;I++)k(L[A][I]);else L[A]instanceof RegExp&&(L[A]=L[A].toString())})(w)}(_),_}function c(_,w,k){var L=i(_,k),A=r({},w.layoutAttributes);A._isSubplotObj=!0,L.set(A)}function T(_,w,k){var L=i(_,k);L.set(r(L.get()||{},w))}Z.IS_SUBPLOT_OBJ="_isSubplotObj",Z.IS_LINKED_TO_ARRAY="_isLinkedToArray",Z.DEPRECATED="_deprecated",Z.UNDERSCORE_ATTRS=f,Z.get=function(){var _={};p.allTypes.forEach(function(k){_[k]=function(L){var A,I;A=p.modules[L]._module,I=A.basePlotModule;var P={type:null},S=r({},b),E=r({},A.attributes);Z.crawl(E,function(H,V,X,$,G){i(S,G).set(void 0),H===void 0&&i(E,G).set(void 0)}),r(P,S),p.traceIs(L,"noOpacity")&&delete P.opacity,p.traceIs(L,"showLegend")||(delete P.showlegend,delete P.legendgroup),p.traceIs(L,"noHover")&&(delete P.hoverinfo,delete P.hoverlabel),A.selectPoints||delete P.selectedpoints,r(P,E),I.attributes&&r(P,I.attributes),P.type=L;var D={meta:A.meta||{},categories:A.categories||{},animatable:Boolean(A.animatable),type:L,attributes:x(P)};if(A.layoutAttributes){var R={};r(R,A.layoutAttributes),D.layoutAttributes=x(R)}return A.animatable||Z.crawl(D,function(H){Z.isValObject(H)&&"anim"in H&&delete H.anim}),D}(k)});var w={};return Object.keys(p.transformsRegistry).forEach(function(k){w[k]=function(L){var A=p.transformsRegistry[L],I=r({},A.attributes);return Object.keys(p.componentsRegistry).forEach(function(P){var S=p.componentsRegistry[P];S.schema&&S.schema.transforms&&S.schema.transforms[L]&&Object.keys(S.schema.transforms[L]).forEach(function(E){T(I,S.schema.transforms[L][E],E)})}),{attributes:x(I)}}(k)}),{defs:{valObjects:u,metaKeys:f.concat(["description","role","editType","impliedEdits"]),editType:{traces:a.traces,layout:a.layout},impliedEdits:{}},traces:_,layout:d(),transforms:w,frames:s(),animation:x(n),config:x(t)}},Z.crawl=function(_,w,k,L){var A=k||0;L=L||"",Object.keys(_).forEach(function(I){var P=_[I];if(f.indexOf(I)===-1){var S=(L?L+".":"")+I;w(P,I,_,A,S),Z.isValObject(P)||m(P)&&I!=="impliedEdits"&&Z.crawl(P,w,A+1,S)}})},Z.isValObject=function(_){return _&&_.valType!==void 0},Z.findArrayAttributes=function(_){var w,k,L=[],A=[],I=[];function P(H,V,X,$){A=A.slice(0,$).concat([V]),I=I.slice(0,$).concat([H&&H._isLinkedToArray]),H&&(H.valType==="data_array"||H.arrayOk===!0)&&!(A[$-1]==="colorbar"&&(V==="ticktext"||V==="tickvals"))&&function G(W,te,N){var B=W[A[te]],U=N+A[te];if(te===A.length-1)o(B)&&L.push(k+U);else if(I[te]){if(Array.isArray(B))for(var ee=0;ee<B.length;ee++)m(B[ee])&&G(B[ee],te+1,U+"["+ee+"].")}else m(B)&&G(B,te+1,U+".")}(w,0,"")}w=_,k="",Z.crawl(b,P),_._module&&_._module.attributes&&Z.crawl(_._module.attributes,P);var S=_.transforms;if(S)for(var E=0;E<S.length;E++){var D=S[E],R=D._module;R&&(k="transforms["+E+"].",w=D,Z.crawl(R.attributes,P))}return L},Z.getTraceValObject=function(_,w){var k,L,A=w[0],I=1;if(A==="transforms"){if(w.length===1)return b.transforms;var P=_.transforms;if(!Array.isArray(P)||!P.length)return!1;var S=w[1];if(!h(S)||S>=P.length)return!1;L=(k=(p.transformsRegistry[P[S].type]||{}).attributes)&&k[w[2]],I=3}else{var E=_._module;if(E||(E=(p.modules[_.type||b.type.dflt]||{})._module),!E)return!1;if(!(L=(k=E.attributes)&&k[A])){var D=E.basePlotModule;D&&D.attributes&&(L=D.attributes[A])}L||(L=b[A])}return l(L,w,I)},Z.getLayoutValObject=function(_,w){return l(function(k,L){var A,I,P,S,E=k._basePlotModules;if(E){var D;for(A=0;A<E.length;A++){if((P=E[A]).attrRegex&&P.attrRegex.test(L)){if(P.layoutAttrOverrides)return P.layoutAttrOverrides;!D&&P.layoutAttributes&&(D=P.layoutAttributes)}var R=P.baseLayoutAttrOverrides;if(R&&L in R)return R[L]}if(D)return D}var H=k._modules;if(H){for(A=0;A<H.length;A++)if((S=H[A].layoutAttributes)&&L in S)return S[L]}for(I in p.componentsRegistry){if((P=p.componentsRegistry[I]).name==="colorscale"&&L.indexOf("coloraxis")===0)return P.layoutAttributes[L];if(!P.schema&&L===P.name)return P.layoutAttributes}return L in y&&y[L]}(_,w[0]),w,1)}},{"../lib":515,"../plots/animation_attributes":560,"../plots/attributes":562,"../plots/frame_attributes":595,"../plots/layout_attributes":619,"../registry":647,"./edit_types":548,"./plot_config":553}],555:[function(v,J,Z){var p=v("../lib"),g=v("../plots/attributes"),b={name:{valType:"string",editType:"none"}};function y(n){return n&&typeof n=="string"}function e(n){var t=n.length-1;return n.charAt(t)!=="s"&&p.warn("bad argument to arrayDefaultKey: "+n),n.substr(0,n.length-1)+"defaults"}b.templateitemname={valType:"string",editType:"calc"},Z.templatedArray=function(n,t){return t._isLinkedToArray=n,t.name=b.name,t.templateitemname=b.templateitemname,t},Z.traceTemplater=function(n){var t,a,r={};for(t in n)a=n[t],Array.isArray(a)&&a.length&&(r[t]=0);return{newTrace:function(m){var o={type:t=p.coerce(m,{},g,"type"),_template:null};if(t in r){a=n[t];var i=r[t]%a.length;r[t]++,o._template=a[i]}return o}}},Z.newContainer=function(n,t,a){var r=n._template,m=r&&(r[t]||a&&r[a]);return p.isPlainObject(m)||(m=null),n[t]={_template:m}},Z.arrayTemplater=function(n,t,a){var r=n._template,m=r&&r[e(t)],o=r&&r[t];Array.isArray(o)&&o.length||(o=[]);var i={};return{newItem:function(u){var f={name:u.name,_input:u},l=f.templateitemname=u.templateitemname;if(!y(l))return f._template=m,f;for(var h=0;h<o.length;h++){var d=o[h];if(d.name===l)return i[l]=1,f._template=d,f}return f[a]=u[a]||!1,f._template=!1,f},defaultItems:function(){for(var u=[],f=0;f<o.length;f++){var l=o[f],h=l.name;if(y(h)&&!i[h]){var d={_template:l,name:h,_input:{_templateitemname:h}};d.templateitemname=l.templateitemname,u.push(d),i[h]=1}}return u}}},Z.arrayDefaultKey=e,Z.arrayEditor=function(n,t,a){var r=(p.nestedProperty(n,t).get()||[]).length,m=a._index,o=m>=r&&(a._input||{})._templateitemname;o&&(m=r);var i,u=t+"["+m+"]";function f(){i={},o&&(i[u]={},i[u].templateitemname=o)}function l(d,s){o?p.nestedProperty(i[u],d).set(s):i[u+"."+d]=s}function h(){var d=i;return f(),d}return f(),{modifyBase:function(d,s){i[d]=s},modifyItem:l,getUpdateObj:h,applyUpdate:function(d,s){d&&l(d,s);var x=h();for(var c in x)p.nestedProperty(n,c).set(x[c])}}}},{"../lib":515,"../plots/attributes":562}],556:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../registry"),b=v("../plots/plots"),y=v("../lib"),e=v("../lib/clear_gl_canvases"),n=v("../components/color"),t=v("../components/drawing"),a=v("../components/titles"),r=v("../components/modebar"),m=v("../plots/cartesian/axes"),o=v("../constants/alignment"),i=v("../plots/cartesian/constraints"),u=i.enforce,f=i.clean,l=v("../plots/cartesian/autorange").doAutoRange;function h(w,k,L){for(var A=0;A<L.length;A++){var I=L[A][0],P=L[A][1];if(!(I[0]>=w[1]||I[1]<=w[0])&&P[0]<k[1]&&P[1]>k[0])return!0}return!1}function d(w){var k,L,A,I,P,S,E=w._fullLayout,D=E._size,R=D.p,H=m.list(w,"",!0);if(E._paperdiv.style({width:w._context.responsive&&E.autosize&&!w._context._hasZeroWidth&&!w.layout.width?"100%":E.width+"px",height:w._context.responsive&&E.autosize&&!w._context._hasZeroHeight&&!w.layout.height?"100%":E.height+"px"}).selectAll(".main-svg").call(t.setSize,E.width,E.height),w._context.setBackground(w,E.paper_bgcolor),Z.drawMainTitle(w),r.manage(w),!E._has("cartesian"))return b.previousPromises(w);function V(Fe,$e,ot){var pt=Fe._lw/2;return Fe._id.charAt(0)==="x"?$e?ot==="top"?$e._offset-R-pt:$e._offset+$e._length+R+pt:D.t+D.h*(1-(Fe.position||0))+pt%1:$e?ot==="right"?$e._offset+$e._length+R+pt:$e._offset-R-pt:D.l+D.w*(Fe.position||0)+pt%1}for(k=0;k<H.length;k++){var X=(I=H[k])._anchorAxis;I._linepositions={},I._lw=t.crispRound(w,I.linewidth,1),I._mainLinePosition=V(I,X,I.side),I._mainMirrorPosition=I.mirror&&X?V(I,X,o.OPPOSITE_SIDE[I.side]):null}var $=[],G=[],W=[],te=n.opacity(E.paper_bgcolor)===1&&n.opacity(E.plot_bgcolor)===1&&E.paper_bgcolor===E.plot_bgcolor;for(L in E._plots)if((A=E._plots[L]).mainplot)A.bg&&A.bg.remove(),A.bg=void 0;else{var N=A.xaxis.domain,B=A.yaxis.domain,U=A.plotgroup;if(h(N,B,W)){var ee=U.node(),j=A.bg=y.ensureSingle(U,"rect","bg");ee.insertBefore(j.node(),ee.childNodes[0]),G.push(L)}else U.select("rect.bg").remove(),W.push([N,B]),te||($.push(L),G.push(L))}var Q,K,re,ne,le,oe,de,se,me,Te,_e,be,Ce,fe=E._bgLayer.selectAll(".bg").data($);for(fe.enter().append("rect").classed("bg",!0),fe.exit().remove(),fe.each(function(Fe){E._plots[Fe].bg=p.select(this)}),k=0;k<G.length;k++)A=E._plots[G[k]],P=A.xaxis,S=A.yaxis,A.bg&&P._offset!==void 0&&S._offset!==void 0&&A.bg.call(t.setRect,P._offset-R,S._offset-R,P._length+2*R,S._length+2*R).call(n.fill,E.plot_bgcolor).style("stroke-width",0);if(!E._hasOnlyLargeSploms)for(L in E._plots){A=E._plots[L],P=A.xaxis,S=A.yaxis;var ve,Me,ke=A.clipId="clip"+E._uid+L+"plot",Le=y.ensureSingleById(E._clips,"clipPath",ke,function(Fe){Fe.classed("plotclip",!0).append("rect")});A.clipRect=Le.select("rect").attr({width:P._length,height:S._length}),t.setTranslate(A.plot,P._offset,S._offset),A._hasClipOnAxisFalse?(ve=null,Me=ke):(ve=ke,Me=null),t.setClipUrl(A.plot,ve,w),A.layerClipId=Me}function ze(Fe){return"M"+Q+","+Fe+"H"+K}function Re(Fe){return"M"+P._offset+","+Fe+"h"+P._length}function Oe(Fe){return"M"+Fe+","+se+"V"+de}function Ze(Fe){return"M"+Fe+","+S._offset+"v"+S._length}function Pe(Fe,$e,ot){if(!Fe.showline||L!==Fe._mainSubplot)return"";if(!Fe._anchorAxis)return ot(Fe._mainLinePosition);var pt=$e(Fe._mainLinePosition);return Fe.mirror&&(pt+=$e(Fe._mainMirrorPosition)),pt}for(L in E._plots){A=E._plots[L],P=A.xaxis,S=A.yaxis;var Ie="M0,0";s(P,L)&&(le=c(P,"left",S,H),Q=P._offset-(le?R+le:0),oe=c(P,"right",S,H),K=P._offset+P._length+(oe?R+oe:0),re=V(P,S,"bottom"),ne=V(P,S,"top"),!(Ce=!P._anchorAxis||L!==P._mainSubplot)||P.mirror!=="allticks"&&P.mirror!=="all"||(P._linepositions[L]=[re,ne]),Ie=Pe(P,ze,Re),Ce&&P.showline&&(P.mirror==="all"||P.mirror==="allticks")&&(Ie+=ze(re)+ze(ne)),A.xlines.style("stroke-width",P._lw+"px").call(n.stroke,P.showline?P.linecolor:"rgba(0,0,0,0)")),A.xlines.attr("d",Ie);var Be="M0,0";s(S,L)&&(_e=c(S,"bottom",P,H),de=S._offset+S._length+(_e?R:0),be=c(S,"top",P,H),se=S._offset-(be?R:0),me=V(S,P,"left"),Te=V(S,P,"right"),!(Ce=!S._anchorAxis||L!==S._mainSubplot)||S.mirror!=="allticks"&&S.mirror!=="all"||(S._linepositions[L]=[me,Te]),Be=Pe(S,Oe,Ze),Ce&&S.showline&&(S.mirror==="all"||S.mirror==="allticks")&&(Be+=Oe(me)+Oe(Te)),A.ylines.style("stroke-width",S._lw+"px").call(n.stroke,S.showline?S.linecolor:"rgba(0,0,0,0)")),A.ylines.attr("d",Be)}return m.makeClipPaths(w),b.previousPromises(w)}function s(w,k){return(w.ticks||w.showline)&&(k===w._mainSubplot||w.mirror==="all"||w.mirror==="allticks")}function x(w,k,L){if(!L.showline||!L._lw)return!1;if(L.mirror==="all"||L.mirror==="allticks")return!0;var A=L._anchorAxis;if(!A)return!1;var I=o.FROM_BL[k];return L.side===k?A.domain[I]===w.domain[I]:L.mirror&&A.domain[1-I]===w.domain[1-I]}function c(w,k,L,A){if(x(w,k,L))return L._lw;for(var I=0;I<A.length;I++){var P=A[I];if(P._mainAxis===L._mainAxis&&x(w,k,P))return P._lw}return 0}function T(w,k){var L=w.title,A=w._size,I=0;switch(k==="start"?I=L.pad.l:k==="end"&&(I=-L.pad.r),L.xref){case"paper":return A.l+A.w*L.x+I;case"container":default:return w.width*L.x+I}}function _(w,k){var L=w.title,A=w._size,I=0;if(k!=="0em"&&k?k===o.CAP_SHIFT+"em"&&(I=L.pad.t):I=-L.pad.b,L.y==="auto")return A.t/2;switch(L.yref){case"paper":return A.t+A.h-A.h*L.y+I;case"container":default:return w.height-w.height*L.y+I}}Z.layoutStyles=function(w){return y.syncOrAsync([b.doAutoMargin,d],w)},Z.drawMainTitle=function(w){var k=w._fullLayout,L=function(I){var P=I.title,S="middle";return y.isRightAnchor(P)?S="end":y.isLeftAnchor(P)&&(S="start"),S}(k),A=function(I){var P=I.title,S="0em";return y.isTopAnchor(P)?S=o.CAP_SHIFT+"em":y.isMiddleAnchor(P)&&(S=o.MID_SHIFT+"em"),S}(k);a.draw(w,"gtitle",{propContainer:k,propName:"title.text",placeholder:k._dfltTitle.plot,attributes:{x:T(k,L),y:_(k,A),"text-anchor":L,dy:A}})},Z.doTraceStyle=function(w){var k,L=w.calcdata,A=[];for(k=0;k<L.length;k++){var I=L[k],P=I[0]||{},S=P.trace||{},E=S._module||{},D=E.arraysToCalcdata;D&&D(I,S);var R=E.editStyle;R&&A.push({fn:R,cd0:P})}if(A.length){for(k=0;k<A.length;k++){var H=A[k];H.fn(w,H.cd0)}e(w),Z.redrawReglTraces(w)}return b.style(w),g.getComponentMethod("legend","draw")(w),b.previousPromises(w)},Z.doColorBars=function(w){return g.getComponentMethod("colorbar","draw")(w),b.previousPromises(w)},Z.layoutReplot=function(w){var k=w.layout;return w.layout=void 0,g.call("_doPlot",w,"",k)},Z.doLegend=function(w){return g.getComponentMethod("legend","draw")(w),b.previousPromises(w)},Z.doTicksRelayout=function(w){return m.draw(w,"redraw"),w._fullLayout._hasOnlyLargeSploms&&(g.subplotsRegistry.splom.updateGrid(w),e(w),Z.redrawReglTraces(w)),Z.drawMainTitle(w),b.previousPromises(w)},Z.doModeBar=function(w){var k=w._fullLayout;r.manage(w);for(var L=0;L<k._basePlotModules.length;L++){var A=k._basePlotModules[L].updateFx;A&&A(w)}return b.previousPromises(w)},Z.doCamera=function(w){for(var k=w._fullLayout,L=k._subplots.gl3d,A=0;A<L.length;A++){var I=k[L[A]];I._scene.setViewport(I)}},Z.drawData=function(w){var k=w._fullLayout;e(w);for(var L=k._basePlotModules,A=0;A<L.length;A++)L[A].plot(w);return Z.redrawReglTraces(w),b.style(w),g.getComponentMethod("selections","draw")(w),g.getComponentMethod("shapes","draw")(w),g.getComponentMethod("annotations","draw")(w),g.getComponentMethod("images","draw")(w),k._replotting=!1,b.previousPromises(w)},Z.redrawReglTraces=function(w){var k=w._fullLayout;if(k._has("regl")){var L,A,I=w._fullData,P=[],S=[];for(k._hasOnlyLargeSploms&&k._splomGrid.draw(),L=0;L<I.length;L++){var E=I[L];E.visible===!0&&E._length!==0&&(E.type==="splom"?k._splomScenes[E.uid].draw():E.type==="scattergl"?y.pushUnique(P,E.xaxis+E.yaxis):E.type==="scatterpolargl"&&y.pushUnique(S,E.subplot))}for(L=0;L<P.length;L++)(A=k._plots[P[L]])._scene&&A._scene.draw();for(L=0;L<S.length;L++)(A=k[S[L]]._subplot)._scene&&A._scene.draw()}},Z.doAutoRangeAndConstraints=function(w){for(var k,L=m.list(w,"",!0),A={},I=0;I<L.length;I++)if(!A[(k=L[I])._id]){A[k._id]=1,f(w,k),l(w,k);var P=k._matchGroup;if(P)for(var S in P){var E=m.getFromId(w,S);l(w,E,k.range),A[S]=1}}u(w)},Z.finalDraw=function(w){g.getComponentMethod("rangeslider","draw")(w),g.getComponentMethod("rangeselector","draw")(w)},Z.drawMarginPushers=function(w){g.getComponentMethod("legend","draw")(w),g.getComponentMethod("rangeselector","draw")(w),g.getComponentMethod("sliders","draw")(w),g.getComponentMethod("updatemenus","draw")(w),g.getComponentMethod("colorbar","draw")(w)}},{"../components/color":367,"../components/drawing":389,"../components/modebar":430,"../components/titles":476,"../constants/alignment":483,"../lib":515,"../lib/clear_gl_canvases":499,"../plots/cartesian/autorange":565,"../plots/cartesian/axes":566,"../plots/cartesian/constraints":574,"../plots/plots":628,"../registry":647,"@plotly/d3":58}],557:[function(v,J,Z){var p=v("../lib"),g=p.isPlainObject,b=v("./plot_schema"),y=v("../plots/plots"),e=v("../plots/attributes"),n=v("./plot_template"),t=v("./plot_config").dfltConfig;function a(h,d){h=p.extendDeep({},h);var s,x,c=Object.keys(h).sort();function T(A,I,P){if(g(I)&&g(A))a(A,I);else if(Array.isArray(I)&&Array.isArray(A)){var S=n.arrayTemplater({_template:h},P);for(x=0;x<I.length;x++){var E=I[x],D=S.newItem(E)._template;D&&a(D,E)}var R=S.defaultItems();for(x=0;x<R.length;x++)I.push(R[x]._template);for(x=0;x<I.length;x++)delete I[x].templateitemname}}for(s=0;s<c.length;s++){var _=c[s],w=h[_];if(_ in d?T(w,d[_],_):d[_]=w,r(_)===_)for(var k in d){var L=r(k);k===L||L!==_||k in h||T(w,d[k],_)}}}function r(h){return h.replace(/[0-9]+$/,"")}function m(h,d,s,x,c){var T=c&&s(c);for(var _ in h){var w=h[_],k=u(h,_,x),L=u(h,_,c),A=s(L);if(!A){var I=r(_);I!==_&&(A=s(L=u(h,I,c)))}if((!T||T!==A)&&!(!A||A._noTemplating||A.valType==="data_array"||A.arrayOk&&Array.isArray(w)))if(!A.valType&&g(w))m(w,d,s,k,L);else if(A._isLinkedToArray&&Array.isArray(w))for(var P=!1,S=0,E={},D=0;D<w.length;D++){var R=w[D];if(g(R)){var H=R.name;if(H)E[H]||(m(R,d,s,u(w,S,k),u(w,S,L)),S++,E[H]=1);else if(!P){var V=u(h,n.arrayDefaultKey(_),x),X=u(w,S,k);m(R,d,s,X,u(w,S,L));var $=p.nestedProperty(d,X);p.nestedProperty(d,V).set($.get()),$.set(null),P=!0}}}else p.nestedProperty(d,k).set(w)}}function o(h,d){return b.getLayoutValObject(h,p.nestedProperty({},d).parts)}function i(h,d){return b.getTraceValObject(h,p.nestedProperty({},d).parts)}function u(h,d,s){return s?Array.isArray(h)?s+"["+d+"]":s+"."+d:d}function f(h){for(var d=0;d<h.length;d++)if(g(h[d]))return!0}function l(h){var d;switch(h.code){case"data":d="The template has no key data.";break;case"layout":d="The template has no key layout.";break;case"missing":d=h.path?"There are no templates for item "+h.path+" with name "+h.templateitemname:"There are no templates for trace "+h.index+", of type "+h.traceType+".";break;case"unused":d=h.path?"The template item at "+h.path+" was not used in constructing the plot.":h.dataCount?"Some of the templates of type "+h.traceType+" were not used. The template has "+h.templateCount+" traces, the data only has "+h.dataCount+" of this type.":"The template has "+h.templateCount+" traces of type "+h.traceType+" but there are none in the data.";break;case"reused":d="Some of the templates of type "+h.traceType+" were used more than once. The template has "+h.templateCount+" traces, the data has "+h.dataCount+" of this type."}return h.msg=d,h}Z.makeTemplate=function(h){h=p.isPlainObject(h)?h:p.getGraphDiv(h),h=p.extendDeep({_context:t},{data:h.data,layout:h.layout}),y.supplyDefaults(h);var d=h.data||[],s=h.layout||{};s._basePlotModules=h._fullLayout._basePlotModules,s._modules=h._fullLayout._modules;var x={data:{},layout:{}};d.forEach(function(S){var E={};m(S,E,i.bind(null,S));var D=p.coerce(S,{},e,"type"),R=x.data[D];R||(R=x.data[D]=[]),R.push(E)}),m(s,x.layout,o.bind(null,s)),delete x.layout.template;var c=s.template;if(g(c)){var T,_,w,k,L,A,I=c.layout;g(I)&&a(I,x.layout);var P=c.data;if(g(P)){for(_ in x.data)if(w=P[_],Array.isArray(w)){for(A=(L=x.data[_]).length,k=w.length,T=0;T<A;T++)a(w[T%k],L[T]);for(T=A;T<k;T++)L.push(p.extendDeep({},w[T]))}for(_ in P)_ in x.data||(x.data[_]=p.extendDeep([],P[_]))}}return x},Z.validateTemplate=function(h,d){var s=p.extendDeep({},{_context:t,data:h.data,layout:h.layout}),x=s.layout||{};g(d)||(d=x.template||{});var c=d.layout,T=d.data,_=[];s.layout=x,s.layout.template=d,y.supplyDefaults(s);var w=s._fullLayout,k=s._fullData,L={};if(g(c)?(function R(H,V){for(var X in H)if(X.charAt(0)!=="_"&&g(H[X])){var $,G=r(X),W=[];for($=0;$<V.length;$++)W.push(u(H,X,V[$])),G!==X&&W.push(u(H,G,V[$]));for($=0;$<W.length;$++)L[W[$]]=1;R(H[X],W)}}(w,["layout"]),function R(H,V){for(var X in H)if(X.indexOf("defaults")===-1&&g(H[X])){var $=u(H,X,V);L[$]?R(H[X],$):_.push({code:"unused",path:$})}}(c,"layout")):_.push({code:"layout"}),g(T)){for(var A,I={},P=0;P<k.length;P++){var S=k[P];I[A=S.type]=(I[A]||0)+1,S._fullInput._template||_.push({code:"missing",index:S._fullInput.index,traceType:A})}for(A in T){var E=T[A].length,D=I[A]||0;E>D?_.push({code:"unused",traceType:A,templateCount:E,dataCount:D}):D>E&&_.push({code:"reused",traceType:A,templateCount:E,dataCount:D})}}else _.push({code:"data"});if(function R(H,V){for(var X in H)if(X.charAt(0)!=="_"){var $=H[X],G=u(H,X,V);g($)?(Array.isArray(H)&&$._template===!1&&$.templateitemname&&_.push({code:"missing",path:G,templateitemname:$.templateitemname}),R($,G)):Array.isArray($)&&f($)&&R($,G)}}({data:k,layout:w},""),_.length)return _.map(l)}},{"../lib":515,"../plots/attributes":562,"../plots/plots":628,"./plot_config":553,"./plot_schema":554,"./plot_template":555}],558:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("./plot_api"),b=v("../plots/plots"),y=v("../lib"),e=v("../snapshot/helpers"),n=v("../snapshot/tosvg"),t=v("../snapshot/svgtoimg"),a=v("../version").version,r={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};J.exports=function(m,o){var i,u,f,l;function h(D){return!(D in o)||y.validate(o[D],r[D])}if(o=o||{},y.isPlainObject(m)?(i=m.data||[],u=m.layout||{},f=m.config||{},l={}):(m=y.getGraphDiv(m),i=y.extendDeep([],m.data),u=y.extendDeep({},m.layout),f=m._context,l=m._fullLayout||{}),!h("width")&&o.width!==null||!h("height")&&o.height!==null)throw new Error("Height and width should be pixel values.");if(!h("format"))throw new Error("Export format is not "+y.join2(r.format.values,", "," or ")+".");var d={};function s(D,R){return y.coerce(o,d,r,D,R)}var x=s("format"),c=s("width"),T=s("height"),_=s("scale"),w=s("setBackground"),k=s("imageDataOnly"),L=document.createElement("div");L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);var A=y.extendFlat({},u);c?A.width=c:o.width===null&&p(l.width)&&(A.width=l.width),T?A.height=T:o.height===null&&p(l.height)&&(A.height=l.height);var I=y.extendFlat({},f,{_exportedPlot:!0,staticPlot:!0,setBackground:w}),P=e.getRedrawFunc(L);function S(){return new Promise(function(D){setTimeout(D,e.getDelay(L._fullLayout))})}function E(){return new Promise(function(D,R){var H=n(L,x,_),V=L._fullLayout.width,X=L._fullLayout.height;function $(){g.purge(L),document.body.removeChild(L)}if(x==="full-json"){var G=b.graphJson(L,!1,"keepdata","object",!0,!0);return G.version=a,G=JSON.stringify(G),$(),D(k?G:e.encodeJSON(G))}if($(),x==="svg")return D(k?H:e.encodeSVG(H));var W=document.createElement("canvas");W.id=y.randstr(),t({format:x,width:V,height:X,scale:_,canvas:W,svg:H,promise:!0}).then(D).catch(R)})}return new Promise(function(D,R){g.newPlot(L,i,A,I).then(P).then(S).then(E).then(function(H){D(function(V){return k?V.replace(e.IMAGE_URL_PREFIX,""):V}(H))}).catch(function(H){R(H)})})}},{"../lib":515,"../plots/plots":628,"../snapshot/helpers":651,"../snapshot/svgtoimg":653,"../snapshot/tosvg":655,"../version":1132,"./plot_api":552,"fast-isnumeric":190}],559:[function(v,J,Z){var p=v("../lib"),g=v("../plots/plots"),b=v("./plot_schema"),y=v("./plot_config").dfltConfig,e=p.isPlainObject,n=Array.isArray,t=p.isArrayOrTypedArray;function a(d,s,x,c,T,_){_=_||[];for(var w=Object.keys(d),k=0;k<w.length;k++){var L=w[k];if(L!=="transforms"){var A=_.slice();A.push(L);var I=d[L],P=s[L],S=f(x,L),E=(S||{}).valType,D=E==="info_array",R=E==="colorscale",H=(S||{}).items;if(u(x,L))if(e(I)&&e(P)&&E!=="any")a(I,P,S,c,T,A);else if(D&&n(I)){I.length>P.length&&c.push(i("unused",T,A.concat(P.length)));var V,X,$,G,W,te=P.length,N=Array.isArray(H);if(N&&(te=Math.min(te,H.length)),S.dimensions===2)for(X=0;X<te;X++)if(n(I[X])){I[X].length>P[X].length&&c.push(i("unused",T,A.concat(X,P[X].length)));var B=P[X].length;for(V=0;V<(N?Math.min(B,H[X].length):B);V++)$=N?H[X][V]:H,G=I[X][V],W=P[X][V],p.validate(G,$)?W!==G&&W!==+G&&c.push(i("dynamic",T,A.concat(X,V),G,W)):c.push(i("value",T,A.concat(X,V),G))}else c.push(i("array",T,A.concat(X),I[X]));else for(X=0;X<te;X++)$=N?H[X]:H,G=I[X],W=P[X],p.validate(G,$)?W!==G&&W!==+G&&c.push(i("dynamic",T,A.concat(X),G,W)):c.push(i("value",T,A.concat(X),G))}else if(S.items&&!D&&n(I)){var U,ee,j=H[Object.keys(H)[0]],Q=[];for(U=0;U<P.length;U++){var K=P[U]._index||U;if((ee=A.slice()).push(K),e(I[K])&&e(P[U])){Q.push(K);var re=I[K],ne=P[U];e(re)&&re.visible!==!1&&ne.visible===!1?c.push(i("invisible",T,ee)):a(re,ne,j,c,T,ee)}}for(U=0;U<I.length;U++)(ee=A.slice()).push(U),e(I[U])?Q.indexOf(U)===-1&&c.push(i("unused",T,ee)):c.push(i("object",T,ee,I[U]))}else!e(I)&&e(P)?c.push(i("object",T,A,I)):t(I)||!t(P)||D||R?L in s?p.validate(I,S)?S.valType==="enumerated"&&(S.coerceNumber&&I!==+P||I!==P)&&c.push(i("dynamic",T,A,I,P)):c.push(i("value",T,A,I)):c.push(i("unused",T,A,I)):c.push(i("array",T,A,I));else c.push(i("schema",T,A))}}return c}function r(d,s){for(var x=d.layout.layoutAttributes,c=0;c<s.length;c++){var T=s[c],_=d.traces[T.type],w=_.layoutAttributes;w&&(T.subplot?p.extendFlat(x[_.attributes.subplot.dflt],w):p.extendFlat(x,w))}return x}J.exports=function(d,s){d===void 0&&(d=[]),s===void 0&&(s={});var x,c,T=b.get(),_=[],w={_context:p.extendFlat({},y)};n(d)?(w.data=p.extendDeep([],d),x=d):(w.data=[],x=[],_.push(i("array","data"))),e(s)?(w.layout=p.extendDeep({},s),c=s):(w.layout={},c={},arguments.length>1&&_.push(i("object","layout"))),g.supplyDefaults(w);for(var k=w._fullData,L=x.length,A=0;A<L;A++){var I=x[A],P=["data",A];if(e(I)){var S=k[A],E=S.type,D=T.traces[E].attributes;D.type={valType:"enumerated",values:[E]},S.visible===!1&&I.visible!==!1&&_.push(i("invisible",P)),a(I,S,D,_,P);var R=I.transforms,H=S.transforms;if(R){n(R)||_.push(i("array",P,["transforms"])),P.push("transforms");for(var V=0;V<R.length;V++){var X=["transforms",V],$=R[V].type;if(e(R[V])){var G=T.transforms[$]?T.transforms[$].attributes:{};G.type={valType:"enumerated",values:Object.keys(T.transforms)},a(R[V],H[V],G,_,P,X)}else _.push(i("object",P,X))}}}else _.push(i("object",P))}var W=w._fullLayout,te=r(T,k);return a(c,W,te,_,"layout"),_.length===0?void 0:_};var m={object:function(d,s){return(d==="layout"&&s===""?"The layout argument":d[0]==="data"&&s===""?"Trace "+d[1]+" in the data argument":o(d)+"key "+s)+" must be linked to an object container"},array:function(d,s){return(d==="data"?"The data argument":o(d)+"key "+s)+" must be linked to an array container"},schema:function(d,s){return o(d)+"key "+s+" is not part of the schema"},unused:function(d,s,x){var c=e(x)?"container":"key";return o(d)+c+" "+s+" did not get coerced"},dynamic:function(d,s,x,c){return[o(d)+"key",s,"(set to '"+x+"')","got reset to","'"+c+"'","during defaults."].join(" ")},invisible:function(d,s){return(s?o(d)+"item "+s:"Trace "+d[1])+" got defaulted to be not visible"},value:function(d,s,x){return[o(d)+"key "+s,"is set to an invalid value ("+x+")"].join(" ")}};function o(d){return n(d)?"In data trace "+d[1]+", ":"In "+d+", "}function i(d,s,x,c,T){var _,w;x=x||"",n(s)?(_=s[0],w=s[1]):(_=s,w=null);var k=function(A){if(!n(A))return String(A);for(var I="",P=0;P<A.length;P++){var S=A[P];typeof S=="number"?I=I.substr(0,I.length-1)+"["+S+"]":I+=S,P<A.length-1&&(I+=".")}return I}(x),L=m[d](s,k,c,T);return p.log(L),{code:d,container:_,trace:w,path:x,astr:k,msg:L}}function u(d,s){var x=h(s),c=x.keyMinusId,T=x.id;return!!(c in d&&d[c]._isSubplotObj&&T)||s in d}function f(d,s){return s in d?d[s]:d[h(s).keyMinusId]}var l=p.counterRegex("([a-z]+)");function h(d){var s=d.match(l);return{keyMinusId:s&&s[1],id:s&&s[2]}}},{"../lib":515,"../plots/plots":628,"./plot_config":553,"./plot_schema":554}],560:[function(v,J,Z){J.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],561:[function(v,J,Z){var p=v("../lib"),g=v("../plot_api/plot_template");J.exports=function(b,y,e){var n,t,a=e.name,r=e.inclusionAttr||"visible",m=y[a],o=p.isArrayOrTypedArray(b[a])?b[a]:[],i=y[a]=[],u=g.arrayTemplater(y,a,r);for(n=0;n<o.length;n++){var f=o[n];p.isPlainObject(f)?t=u.newItem(f):(t=u.newItem({}))[r]=!1,t._index=n,t[r]!==!1&&e.handleItemDefaults(f,t,y,e),i.push(t)}var l=u.defaultItems();for(n=0;n<l.length;n++)(t=l[n])._index=i.length,e.handleItemDefaults({},t,y,e,{}),i.push(t);if(p.isArrayOrTypedArray(m)){var h=Math.min(m.length,i.length);for(n=0;n<h;n++)p.relinkPrivateKeys(i[n],m[n])}return i}},{"../lib":515,"../plot_api/plot_template":555}],562:[function(v,J,Z){var p=v("./font_attributes"),g=v("../components/fx/attributes");J.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:p({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:g.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":398,"./font_attributes":594}],563:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=g.dateTime2ms,y=g.incrementMonth,e=v("../../constants/numerical").ONEAVGMONTH;J.exports=function(n,t,a,r){if(t.type!=="date")return{vals:r};var m=n[a+"periodalignment"];if(!m)return{vals:r};var o,i=n[a+"period"];if(p(i)){if((i=+i)<=0)return{vals:r}}else if(typeof i=="string"&&i.charAt(0)==="M"){var u=+i.substring(1);if(!(u>0&&Math.round(u)===u))return{vals:r};o=u}for(var f=t.calendar,l=m==="start",h=m==="end",d=n[a+"period0"],s=b(d,f)||0,x=[],c=[],T=[],_=r.length,w=0;w<_;w++){var k,L,A,I=r[w];if(o){for(k=Math.round((I-s)/(o*e)),A=y(s,o*k,f);A>I;)A=y(A,-o,f);for(;A<=I;)A=y(A,o,f);L=y(A,-o,f)}else{for(A=s+(k=Math.round((I-s)/i))*i;A>I;)A-=i;for(;A<=I;)A+=i;L=A-i}x[w]=l?L:h?A:(L+A)/2,c[w]=L,T[w]=A}return{vals:x,starts:c,ends:T}}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],564:[function(v,J,Z){J.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],565:[function(v,J,Z){var p=v("@plotly/d3"),g=v("fast-isnumeric"),b=v("../../lib"),y=v("../../constants/numerical").FP_SAFE,e=v("../../registry"),n=v("../../components/drawing"),t=v("./axis_ids"),a=t.getFromId,r=t.isLinked;function m(c,T){var _,w,k=[],L=c._fullLayout,A=i(L,T,0),I=i(L,T,1),P=u(c,T),S=P.min,E=P.max;if(S.length===0||E.length===0)return b.simpleMap(T.range,T.r2l);var D=S[0].val,R=E[0].val;for(_=1;_<S.length&&D===R;_++)D=Math.min(D,S[_].val);for(_=1;_<E.length&&D===R;_++)R=Math.max(R,E[_].val);var H=!1;if(T.range){var V=b.simpleMap(T.range,T.r2l);H=V[1]<V[0]}T.autorange==="reversed"&&(H=!0,T.autorange=!0);var X,$,G,W,te,N,B=T.rangemode,U=B==="tozero",ee=B==="nonnegative",j=T._length,Q=j/10,K=0;for(_=0;_<S.length;_++)for(X=S[_],w=0;w<E.length;w++)(N=($=E[w]).val-X.val-o(T,X.val,$.val))>0&&((te=j-A(X)-I($))>Q?N/te>K&&(G=X,W=$,K=N/te):N/j>K&&(G={val:X.val,nopad:1},W={val:$.val,nopad:1},K=N/j));if(D===R){var re=D-1,ne=D+1;if(U)if(D===0)k=[0,1];else{var le=(D>0?E:S).reduce(function(de,se){return Math.max(de,I(se))},0),oe=D/(1-Math.min(.5,le/j));k=D>0?[0,oe]:[oe,0]}else k=ee?[Math.max(0,re),Math.max(1,ne)]:[re,ne]}else U?(G.val>=0&&(G={val:0,nopad:1}),W.val<=0&&(W={val:0,nopad:1})):ee&&(G.val-K*A(G)<0&&(G={val:0,nopad:1}),W.val<=0&&(W={val:1,nopad:1})),K=(W.val-G.val-o(T,X.val,$.val))/(j-A(G)-I(W)),k=[G.val-K*A(G),W.val+K*I(W)];return H&&k.reverse(),b.simpleMap(k,T.l2r||Number)}function o(c,T,_){var w=0;if(c.rangebreaks)for(var k=c.locateBreaks(T,_),L=0;L<k.length;L++){var A=k[L];w+=A.max-A.min}return w}function i(c,T,_){var w=.05*T._length,k=T._anchorAxis||{};if((T.ticklabelposition||"").indexOf("inside")!==-1||(k.ticklabelposition||"").indexOf("inside")!==-1){var L=T.autorange==="reversed";if(!L){var A=b.simpleMap(T.range,T.r2l);L=A[1]<A[0]}L&&(_=!_)}var I=0;return r(c,T._id)||(I=function(P,S,E){var D=0,R=S._id.charAt(0)==="x";for(var H in P._plots){var V=P._plots[H];if(S._id===V.xaxis._id||S._id===V.yaxis._id){var X=(R?V.yaxis:V.xaxis)||{};if((X.ticklabelposition||"").indexOf("inside")!==-1&&(!E&&(X.side==="left"||X.side==="bottom")||E&&(X.side==="top"||X.side==="right"))){if(X._vals){var $=b.deg2rad(X._tickAngles[X._id+"tick"]||0),G=Math.abs(Math.cos($)),W=Math.abs(Math.sin($));if(!X._vals[0].bb){var te=X._id+"tick";X._selections[te].each(function(j){var Q=p.select(this);Q.select(".text-math-group").empty()&&(j.bb=n.bBox(Q.node()))})}for(var N=0;N<X._vals.length;N++){var B=X._vals[N].bb;if(B){var U=6+B.width,ee=6+B.height;D=Math.max(D,R?Math.max(U*G,ee*W):Math.max(ee*G,U*W))}}}X.ticks==="inside"&&X.ticklabelposition==="inside"&&(D+=X.ticklen||0)}}}return D}(c,T,_)),w=Math.max(I,w),T.constrain==="domain"&&T._inputDomain&&(w*=(T._inputDomain[1]-T._inputDomain[0])/(T.domain[1]-T.domain[0])),function(P){return P.nopad?0:P.pad+(P.extrapad?w:I)}}J.exports={getAutoRange:m,makePadFn:i,doAutoRange:function(c,T,_){if(T.setScale(),T.autorange){T.range=_?_.slice():m(c,T),T._r=T.range.slice(),T._rl=b.simpleMap(T._r,T.r2l);var w=T._input,k={};k[T._attr+".range"]=T.range,k[T._attr+".autorange"]=T.autorange,e.call("_storeDirectGUIEdit",c.layout,c._fullLayout._preGUI,k),w.range=T.range.slice(),w.autorange=T.autorange}var L=T._anchorAxis;if(L&&L.rangeslider){var A=L.rangeslider[T._name];A&&A.rangemode==="auto"&&(A.range=m(c,T)),L._input.rangeslider[T._name]=b.extendFlat({},A)}},findExtremes:function(c,T,_){_||(_={}),c._m||c.setScale();var w,k,L,A,I,P,S,E,D,R=[],H=[],V=T.length,X=_.padded||!1,$=_.tozero&&(c.type==="linear"||c.type==="-"),G=c.type==="log",W=!1,te=_.vpadLinearized||!1;function N(ne){if(Array.isArray(ne))return W=!0,function(oe){return Math.max(Number(ne[oe]||0),0)};var le=Math.max(Number(ne||0),0);return function(){return le}}var B=N((c._m>0?_.ppadplus:_.ppadminus)||_.ppad||0),U=N((c._m>0?_.ppadminus:_.ppadplus)||_.ppad||0),ee=N(_.vpadplus||_.vpad),j=N(_.vpadminus||_.vpad);if(!W){if(E=1/0,D=-1/0,G)for(w=0;w<V;w++)(k=T[w])<E&&k>0&&(E=k),k>D&&k<y&&(D=k);else for(w=0;w<V;w++)(k=T[w])<E&&k>-y&&(E=k),k>D&&k<y&&(D=k);T=[E,D],V=2}var Q={tozero:$,extrapad:X};function K(ne){L=T[ne],g(L)&&(P=B(ne),S=U(ne),te?(A=c.c2l(L)-j(ne),I=c.c2l(L)+ee(ne)):(E=L-j(ne),D=L+ee(ne),G&&E<D/10&&(E=D/10),A=c.c2l(E),I=c.c2l(D)),$&&(A=Math.min(0,A),I=Math.max(0,I)),d(A)&&f(R,A,S,Q),d(I)&&l(H,I,P,Q))}var re=Math.min(6,V);for(w=0;w<re;w++)K(w);for(w=V-1;w>=re;w--)K(w);return{min:R,max:H,opts:_}},concatExtremes:u};function u(c,T,_){var w,k,L,A=T._id,I=c._fullData,P=c._fullLayout,S=[],E=[];function D($,G){for(w=0;w<G.length;w++){var W=$[G[w]],te=(W._extremes||{})[A];if(W.visible===!0&&te){for(k=0;k<te.min.length;k++)L=te.min[k],f(S,L.val,L.pad,{extrapad:L.extrapad});for(k=0;k<te.max.length;k++)L=te.max[k],l(E,L.val,L.pad,{extrapad:L.extrapad})}}}if(D(I,T._traceIndices),D(P.annotations||[],T._annIndices||[]),D(P.shapes||[],T._shapeIndices||[]),T._matchGroup&&!_){for(var R in T._matchGroup)if(R!==T._id){var H=a(c,R),V=u(c,H,!0),X=T._length/H._length;for(k=0;k<V.min.length;k++)L=V.min[k],f(S,L.val,L.pad*X,{extrapad:L.extrapad});for(k=0;k<V.max.length;k++)L=V.max[k],l(E,L.val,L.pad*X,{extrapad:L.extrapad})}}return{min:S,max:E}}function f(c,T,_,w){h(c,T,_,w,s)}function l(c,T,_,w){h(c,T,_,w,x)}function h(c,T,_,w,k){for(var L=w.tozero,A=w.extrapad,I=!0,P=0;P<c.length&&I;P++){var S=c[P];if(k(S.val,T)&&S.pad>=_&&(S.extrapad||!A)){I=!1;break}k(T,S.val)&&S.pad<=_&&(A||!S.extrapad)&&(c.splice(P,1),P--)}if(I){var E=L&&T===0;c.push({val:T,pad:E?0:_,extrapad:!E&&A})}}function d(c){return g(c)&&Math.abs(c)<y}function s(c,T){return c<=T}function x(c,T){return c>=T}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../../registry":647,"./axis_ids":570,"@plotly/d3":58,"fast-isnumeric":190}],566:[function(v,J,Z){var p=v("@plotly/d3"),g=v("fast-isnumeric"),b=v("../../plots/plots"),y=v("../../registry"),e=v("../../lib"),n=e.strTranslate,t=v("../../lib/svg_text_utils"),a=v("../../components/titles"),r=v("../../components/color"),m=v("../../components/drawing"),o=v("./layout_attributes"),i=v("./clean_ticks"),u=v("../../constants/numerical"),f=u.ONEMAXYEAR,l=u.ONEAVGYEAR,h=u.ONEMINYEAR,d=u.ONEMAXQUARTER,s=u.ONEAVGQUARTER,x=u.ONEMINQUARTER,c=u.ONEMAXMONTH,T=u.ONEAVGMONTH,_=u.ONEMINMONTH,w=u.ONEWEEK,k=u.ONEDAY,L=k/2,A=u.ONEHOUR,I=u.ONEMIN,P=u.ONESEC,S=u.MINUS_SIGN,E=u.BADNUM,D={K:"zeroline"},R={K:"gridline",L:"path"},H={K:"minor-gridline",L:"path"},V={K:"tick",L:"path"},X={K:"tick",L:"text"},$={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},G=v("../../constants/alignment"),W=G.MID_SHIFT,te=G.CAP_SHIFT,N=G.LINE_SPACING,B=G.OPPOSITE_SIDE,U=J.exports={};U.setConvert=v("./set_convert");var ee=v("./axis_autotype"),j=v("./axis_ids"),Q=j.idSort,K=j.isLinked;U.id2name=j.id2name,U.name2id=j.name2id,U.cleanId=j.cleanId,U.list=j.list,U.listIds=j.listIds,U.getFromId=j.getFromId,U.getFromTrace=j.getFromTrace;var re=v("./autorange");U.getAutoRange=re.getAutoRange,U.findExtremes=re.findExtremes;function ne(he){var xe=1e-4*(he[1]-he[0]);return[he[0]-xe,he[1]+xe]}U.coerceRef=function(he,xe,De,qe,Xe,He){var st=qe.charAt(qe.length-1),it=De._fullLayout._subplots[st+"axis"],Tt=qe+"ref",Pt={};return Xe||(Xe=it[0]||(typeof He=="string"?He:He[0])),He||(He=Xe),it=it.concat(it.map(function(rt){return rt+" domain"})),Pt[Tt]={valType:"enumerated",values:it.concat(He?typeof He=="string"?[He]:He:[]),dflt:Xe},e.coerce(he,xe,Pt,Tt)},U.getRefType=function(he){return he===void 0?he:he==="paper"?"paper":he==="pixel"?"pixel":/( domain)$/.test(he)?"domain":"range"},U.coercePosition=function(he,xe,De,qe,Xe,He){var st,it;if(U.getRefType(qe)!=="range")st=e.ensureNumber,it=De(Xe,He);else{var Tt=U.getFromId(xe,qe);it=De(Xe,He=Tt.fraction2r(He)),st=Tt.cleanPos}he[Xe]=st(it)},U.cleanPosition=function(he,xe,De){return(De==="paper"||De==="pixel"?e.ensureNumber:U.getFromId(xe,De).cleanPos)(he)},U.redrawComponents=function(he,xe){xe=xe||U.listIds(he);var De=he._fullLayout;function qe(Xe,He,st,it){for(var Tt=y.getComponentMethod(Xe,He),Pt={},rt=0;rt<xe.length;rt++)for(var ut=De[U.id2name(xe[rt])][st],Ft=0;Ft<ut.length;Ft++){var wt=ut[Ft];if(!Pt[wt]&&(Tt(he,wt),Pt[wt]=1,it))return}}qe("annotations","drawOne","_annIndices"),qe("shapes","drawOne","_shapeIndices"),qe("images","draw","_imgIndices",!0),qe("selections","drawOne","_selectionIndices")};var le=U.getDataConversions=function(he,xe,De,qe){var Xe,He=De==="x"||De==="y"||De==="z"?De:qe;if(Array.isArray(He)){if(Xe={type:ee(qe,void 0,{autotypenumbers:he._fullLayout.autotypenumbers}),_categories:[]},U.setConvert(Xe),Xe.type==="category")for(var st=0;st<qe.length;st++)Xe.d2c(qe[st])}else Xe=U.getFromTrace(he,xe,He);return Xe?{d2c:Xe.d2c,c2d:Xe.c2d}:He==="ids"?{d2c:de,c2d:de}:{d2c:oe,c2d:oe}};function oe(he){return+he}function de(he){return String(he)}function se(he,xe){return Math.abs((he/xe+.5)%1-.5)<.001}function me(he,xe){return Math.abs(he/xe-1)<.001}function Te(he){return+he.substring(1)}function _e(he){var xe=ne(e.simpleMap(he.range,he.r2l)),De=Math.min(xe[0],xe[1]),qe=Math.max(xe[0],xe[1]),Xe=he.type==="category"?he.d2l_noadd:he.d2l;he.type==="log"&&String(he.dtick).charAt(0)!=="L"&&(he.dtick="L"+Math.pow(10,Math.floor(Math.min(he.range[0],he.range[1]))-1));for(var He=[],st=0;st<=1;st++)if(!st||he.minor){var it=st?he.minor.tickvals:he.tickvals,Tt=st?[]:he.ticktext;if(it){Array.isArray(Tt)||(Tt=[]);for(var Pt=0;Pt<it.length;Pt++){var rt=Xe(it[Pt]);if(rt>De&&rt<qe){var ut=Tt[Pt]===void 0?U.tickText(he,rt):Oe(he,rt,String(Tt[Pt]));st&&(ut.minor=!0,ut.text=""),He.push(ut)}}}}return he.rangebreaks&&(He=He.filter(function(Ft){return he.maskBreaks(Ft.x)!==E})),He}U.getDataToCoordFunc=function(he,xe,De,qe){return le(he,xe,De,qe).d2c},U.counterLetter=function(he){var xe=he.charAt(0);return xe==="x"?"y":xe==="y"?"x":void 0},U.minDtick=function(he,xe,De,qe){["log","category","multicategory"].indexOf(he.type)===-1&&qe?he._minDtick===void 0?(he._minDtick=xe,he._forceTick0=De):he._minDtick&&((he._minDtick/xe+1e-6)%1<2e-6&&((De-he._forceTick0)/xe%1+1.000001)%1<2e-6?(he._minDtick=xe,he._forceTick0=De):((xe/he._minDtick+1e-6)%1>2e-6||((De-he._forceTick0)/he._minDtick%1+1.000001)%1>2e-6)&&(he._minDtick=0)):he._minDtick=0},U.saveRangeInitial=function(he,xe){for(var De=U.list(he,"",!0),qe=!1,Xe=0;Xe<De.length;Xe++){var He=De[Xe],st=He._rangeInitial===void 0,it=st||!(He.range[0]===He._rangeInitial[0]&&He.range[1]===He._rangeInitial[1]);(st&&He.autorange===!1||xe&&it)&&(He._rangeInitial=He.range.slice(),qe=!0)}return qe},U.saveShowSpikeInitial=function(he,xe){for(var De=U.list(he,"",!0),qe=!1,Xe="on",He=0;He<De.length;He++){var st=De[He],it=st._showSpikeInitial===void 0,Tt=it||st.showspikes!==st._showspikes;(it||xe&&Tt)&&(st._showSpikeInitial=st.showspikes,qe=!0),Xe!=="on"||st.showspikes||(Xe="off")}return he._fullLayout._cartesianSpikesEnabled=Xe,qe},U.autoBin=function(he,xe,De,qe,Xe,He){var st,it=e.aggNums(Math.min,null,he),Tt=e.aggNums(Math.max,null,he);if(xe.type==="category"||xe.type==="multicategory")return{start:it-.5,end:Tt+.5,size:Math.max(1,Math.round(He)||1),_dataSpan:Tt-it};if(Xe||(Xe=xe.calendar),st=xe.type==="log"?{type:"linear",range:[it,Tt]}:{type:xe.type,range:e.simpleMap([it,Tt],xe.c2r,0,Xe),calendar:Xe},U.setConvert(st),He=He&&i.dtick(He,st.type))st.dtick=He,st.tick0=i.tick0(void 0,st.type,Xe);else{var Pt;if(De)Pt=(Tt-it)/De;else{var rt=e.distinctVals(he),ut=Math.pow(10,Math.floor(Math.log(rt.minDiff)/Math.LN10)),Ft=ut*e.roundUp(rt.minDiff/ut,[.9,1.9,4.9,9.9],!0);Pt=Math.max(Ft,2*e.stdev(he)/Math.pow(he.length,qe?.25:.4)),g(Pt)||(Pt=1)}U.autoTicks(st,Pt)}var wt,Lt=st.dtick,Ae=U.tickIncrement(U.tickFirst(st),Lt,"reverse",Xe);if(typeof Lt=="number")wt=(Ae=function(Ye,nt,ft,Mt,Rt){var Gt=0,jt=0,pr=0,Ar=0;function fr(hr){return(1+100*(hr-Ye)/ft.dtick)%100<2}for(var Zt=0;Zt<nt.length;Zt++)nt[Zt]%1==0?pr++:g(nt[Zt])||Ar++,fr(nt[Zt])&&Gt++,fr(nt[Zt]+ft.dtick/2)&&jt++;var Qt=nt.length-Ar;if(pr===Qt&&ft.type!=="date")ft.dtick<1?Ye=Mt-.5*ft.dtick:(Ye-=.5)+ft.dtick<Mt&&(Ye+=ft.dtick);else if(jt<.1*Qt&&(Gt>.3*Qt||fr(Mt)||fr(Rt))){var $t=ft.dtick/2;Ye+=Ye+$t<Mt?$t:-$t}return Ye}(Ae,he,st,it,Tt))+(1+Math.floor((Tt-Ae)/Lt))*Lt;else for(st.dtick.charAt(0)==="M"&&(Ae=function(Ye,nt,ft,Mt,Rt){var Gt=e.findExactDates(nt,Rt);if(Gt.exactDays>.8){var jt=Number(ft.substr(1));Gt.exactYears>.8&&jt%12==0?Ye=U.tickIncrement(Ye,"M6","reverse")+1.5*k:Gt.exactMonths>.8?Ye=U.tickIncrement(Ye,"M1","reverse")+15.5*k:Ye-=L;var pr=U.tickIncrement(Ye,ft);if(pr<=Mt)return pr}return Ye}(Ae,he,Lt,it,Xe)),wt=Ae,0;wt<=Tt;)wt=U.tickIncrement(wt,Lt,!1,Xe);return{start:xe.c2r(Ae,0,Xe),end:xe.c2r(wt,0,Xe),size:Lt,_dataSpan:Tt-it}},U.prepMinorTicks=function(he,xe,De){if(!xe.minor.dtick){delete he.dtick;var qe,Xe=xe.dtick&&g(xe._tmin);if(Xe){var He=U.tickIncrement(xe._tmin,xe.dtick,!0);qe=[xe._tmin,.99*He+.01*xe._tmin]}else{var st=e.simpleMap(xe.range,xe.r2l);qe=[st[0],.8*st[0]+.2*st[1]]}if(he.range=e.simpleMap(qe,xe.l2r),he._isMinor=!0,U.prepTicks(he,De),Xe){var it=g(xe.dtick),Tt=g(he.dtick),Pt=it?xe.dtick:+xe.dtick.substring(1),rt=Tt?he.dtick:+he.dtick.substring(1);it&&Tt?se(Pt,rt)?Pt===2*w&&rt===2*k&&(he.dtick=w):Pt===2*w&&rt===3*k?he.dtick=w:Pt!==w||(xe._input.minor||{}).nticks?me(Pt/rt,2.5)?he.dtick=Pt/2:he.dtick=Pt:he.dtick=k:String(xe.dtick).charAt(0)==="M"?Tt?he.dtick="M1":se(Pt,rt)?Pt>=12&&rt===2&&(he.dtick="M3"):he.dtick=xe.dtick:String(he.dtick).charAt(0)==="L"?String(xe.dtick).charAt(0)==="L"?se(Pt,rt)||(he.dtick=me(Pt/rt,2.5)?xe.dtick/2:xe.dtick):he.dtick="D1":he.dtick==="D2"&&+xe.dtick>1&&(he.dtick=1)}he.range=xe.range}xe.minor._tick0Init===void 0&&(he.tick0=xe.tick0)},U.prepTicks=function(he,xe){var De=e.simpleMap(he.range,he.r2l,void 0,void 0,xe);if(he.tickmode==="auto"||!he.dtick){var qe,Xe=he.nticks;Xe||(he.type==="category"||he.type==="multicategory"?(qe=he.tickfont?e.bigFont(he.tickfont.size||12):15,Xe=he._length/qe):(qe=he._id.charAt(0)==="y"?40:80,Xe=e.constrain(he._length/qe,4,9)+1),he._name==="radialaxis"&&(Xe*=2)),he.minor&&he.minor.tickmode!=="array"||he.tickmode==="array"&&(Xe*=100),he._roughDTick=Math.abs(De[1]-De[0])/Xe,U.autoTicks(he,he._roughDTick),he._minDtick>0&&he.dtick<2*he._minDtick&&(he.dtick=he._minDtick,he.tick0=he.l2r(he._forceTick0))}he.ticklabelmode==="period"&&function(He){var st;function it(){return!(g(He.dtick)||He.dtick.charAt(0)!=="M")}var Tt=it(),Pt=U.getTickFormat(He);if(Pt){var rt=He._dtickInit!==He.dtick;/%[fLQsSMX]/.test(Pt)||(/%[HI]/.test(Pt)?(st=A,rt&&!Tt&&He.dtick<A&&(He.dtick=A)):/%p/.test(Pt)?(st=L,rt&&!Tt&&He.dtick<L&&(He.dtick=L)):/%[Aadejuwx]/.test(Pt)?(st=k,rt&&!Tt&&He.dtick<k&&(He.dtick=k)):/%[UVW]/.test(Pt)?(st=w,rt&&!Tt&&He.dtick<w&&(He.dtick=w)):/%[Bbm]/.test(Pt)?(st=T,rt&&(Tt?Te(He.dtick)<1:He.dtick<_)&&(He.dtick="M1")):/%[q]/.test(Pt)?(st=s,rt&&(Tt?Te(He.dtick)<3:He.dtick<x)&&(He.dtick="M3")):/%[Yy]/.test(Pt)&&(st=l,rt&&(Tt?Te(He.dtick)<12:He.dtick<h)&&(He.dtick="M12")))}(Tt=it())&&He.tick0===He._dowTick0&&(He.tick0=He._rawTick0),He._definedDelta=st}(he),he.tick0||(he.tick0=he.type==="date"?"2000-01-01":0),he.type==="date"&&he.dtick<.1&&(he.dtick=.1),Re(he)},U.calcTicks=function(he,xe){for(var De,qe,Xe=he.type,He=he.calendar,st=he.ticklabelstep,it=he.ticklabelmode==="period",Tt=e.simpleMap(he.range,he.r2l,void 0,void 0,xe),Pt=Tt[1]<Tt[0],rt=Math.min(Tt[0],Tt[1]),ut=Math.max(Tt[0],Tt[1]),Ft=Math.max(1e3,he._length||0),wt=[],Lt=[],Ae=[],Ye=[],nt=he.minor&&(he.minor.ticks||he.minor.showgrid),ft=1;ft>=(nt?0:1);ft--){var Mt=!ft;ft?(he._dtickInit=he.dtick,he._tick0Init=he.tick0):(he.minor._dtickInit=he.minor.dtick,he.minor._tick0Init=he.minor.tick0);var Rt=ft?he:e.extendFlat({},he,he.minor);if(Mt?U.prepMinorTicks(Rt,he,xe):U.prepTicks(Rt,xe),Rt.tickmode!=="array"){var Gt=ne(Tt),jt=Gt[0],pr=Gt[1],Ar=g(Rt.dtick),fr=Xe==="log"&&!(Ar||Rt.dtick.charAt(0)==="L"),Zt=U.tickFirst(Rt,xe);if(ft){if(he._tmin=Zt,Zt<jt!==Pt)break;Xe!=="category"&&Xe!=="multicategory"||(pr=Pt?Math.max(-.5,pr):Math.min(he._categories.length-.5,pr))}var Qt,$t,hr=null,vr=Zt;ft&&(Ar?$t=he.dtick:Xe==="date"?typeof he.dtick=="string"&&he.dtick.charAt(0)==="M"&&($t=T*he.dtick.substring(1)):$t=he._roughDTick,Qt=Math.round((he.r2l(vr)-he.r2l(he.tick0))/$t)-1);var Mr=Rt.dtick;for(Rt.rangebreaks&&Rt._tick0Init!==Rt.tick0&&(vr=Ht(vr,he),Pt||(vr=U.tickIncrement(vr,Mr,!Pt,He))),ft&&it&&(vr=U.tickIncrement(vr,Mr,!Pt,He),Qt--);Pt?vr>=pr:vr<=pr;vr=U.tickIncrement(vr,Mr,Pt,He)){if(ft&&Qt++,Rt.rangebreaks&&!Pt){if(vr<jt)continue;if(Rt.maskBreaks(vr)===E&&Ht(vr,Rt)>=ut)break}if(Ae.length>Ft||vr===hr)break;hr=vr;var Nr={value:vr};ft?(fr&&vr!==(0|vr)&&(Nr.simpleLabel=!0),st>1&&Qt%st&&(Nr.skipLabel=!0),Ae.push(Nr)):(Nr.minor=!0,Ye.push(Nr))}}else ft?(Ae=[],wt=_e(he)):(Ye=[],Lt=_e(he))}if(nt&&!(he.minor.ticks==="inside"&&he.ticks==="outside"||he.minor.ticks==="outside"&&he.ticks==="inside")){for(var Ur=Ae.map(function(On){return On.value}),Jr=[],mn=0;mn<Ye.length;mn++){var en=Ye[mn],In=en.value;if(Ur.indexOf(In)===-1){for(var vn=!1,gn=0;!vn&&gn<Ae.length;gn++)1e7+Ae[gn].value===1e7+In&&(vn=!0);vn||Jr.push(en)}}Ye=Jr}if(it&&function(On,ua,tr){for(var yr=0;yr<On.length;yr++){var Ct=On[yr].value,lr=yr,dr=yr+1;yr<On.length-1?(lr=yr,dr=yr+1):yr>0?(lr=yr-1,dr=yr):(lr=yr,dr=yr);var Fr,Rr=On[lr].value,zr=On[dr].value,Er=Math.abs(zr-Rr),xr=tr||Er,_r=0;xr>=h?_r=Er>=h&&Er<=f?Er:l:tr===s&&xr>=x?_r=Er>=x&&Er<=d?Er:s:xr>=_?_r=Er>=_&&Er<=c?Er:T:tr===w&&xr>=w?_r=w:xr>=k?_r=k:tr===L&&xr>=L?_r=L:tr===A&&xr>=A&&(_r=A),_r>=Er&&(_r=Er,Fr=!0);var kr=Ct+_r;if(ua.rangebreaks&&_r>0){for(var Cr=0,Gr=0;Gr<84;Gr++){var qr=(Gr+.5)/84;ua.maskBreaks(Ct*(1-qr)+qr*kr)!==E&&Cr++}(_r*=Cr/84)||(On[yr].drop=!0),Fr&&Er>w&&(_r=Er)}(_r>0||yr===0)&&(On[yr].periodX=Ct+_r/2)}}(Ae,he,he._definedDelta),he.rangebreaks){var Sn=he._id.charAt(0)==="y",Xn=1;he.tickmode==="auto"&&(Xn=he.tickfont?he.tickfont.size:12);var Br=NaN;for(De=Ae.length-1;De>-1;De--)if(Ae[De].drop)Ae.splice(De,1);else{Ae[De].value=Ht(Ae[De].value,he);var pn=he.c2p(Ae[De].value);(Sn?Br>pn-Xn:Br<pn+Xn)?Ae.splice(Pt?De+1:De,1):Br=pn}}ir(he)&&Math.abs(Tt[1]-Tt[0])===360&&Ae.pop(),he._tmax=(Ae[Ae.length-1]||{}).value,he._prevDateHead="",he._inCalcTicks=!0;var on,Yr,Nn=function(On){On.text="",he._prevDateHead=qe};for(Ae=Ae.concat(Ye),De=0;De<Ae.length;De++){var Hn=Ae[De].minor,xn=Ae[De].value;Hn?Lt.push({x:xn,minor:!0}):(qe=he._prevDateHead,on=U.tickText(he,xn,!1,Ae[De].simpleLabel),(Yr=Ae[De].periodX)!==void 0&&(on.periodX=Yr,(Yr>ut||Yr<rt)&&(Yr>ut&&(on.periodX=ut),Yr<rt&&(on.periodX=rt),Nn(on))),Ae[De].skipLabel&&Nn(on),wt.push(on))}return wt=wt.concat(Lt),he._inCalcTicks=!1,it&&wt.length&&(wt[0].noTick=!0),wt};var be=[2,5,10],Ce=[1,2,3,6,12],fe=[1,2,5,10,15,30],ve=[1,2,3,7,14],Me=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],ke=[-.301,0,.301,.699,1],Le=[15,30,45,90,180];function ze(he,xe,De){return xe*e.roundUp(he/xe,De)}function Re(he){var xe=he.dtick;if(he._tickexponent=0,g(xe)||typeof xe=="string"||(xe=1),he.type!=="category"&&he.type!=="multicategory"||(he._tickround=null),he.type==="date"){var De=he.r2l(he.tick0),qe=he.l2r(De).replace(/(^-|i)/g,""),Xe=qe.length;if(String(xe).charAt(0)==="M")Xe>10||qe.substr(5)!=="01-01"?he._tickround="d":he._tickround=+xe.substr(1)%12==0?"y":"m";else if(xe>=k&&Xe<=10||xe>=15*k)he._tickround="d";else if(xe>=I&&Xe<=16||xe>=A)he._tickround="M";else if(xe>=P&&Xe<=19||xe>=I)he._tickround="S";else{var He=he.l2r(De+xe).replace(/^-/,"").length;he._tickround=Math.max(Xe,He)-20,he._tickround<0&&(he._tickround=4)}}else if(g(xe)||xe.charAt(0)==="L"){var st=he.range.map(he.r2d||Number);g(xe)||(xe=Number(xe.substr(1))),he._tickround=2-Math.floor(Math.log(xe)/Math.LN10+.01);var it=Math.max(Math.abs(st[0]),Math.abs(st[1])),Tt=Math.floor(Math.log(it)/Math.LN10+.01),Pt=he.minexponent===void 0?3:he.minexponent;Math.abs(Tt)>Pt&&(Pe(he.exponentformat)&&!Ie(Tt)?he._tickexponent=3*Math.round((Tt-1)/3):he._tickexponent=Tt)}else he._tickround=null}function Oe(he,xe,De){var qe=he.tickfont||{};return{x:xe,dx:0,dy:0,text:De||"",fontSize:qe.size,font:qe.family,fontColor:qe.color}}U.autoTicks=function(he,xe,De){var qe;function Xe(ut){return Math.pow(ut,Math.floor(Math.log(xe)/Math.LN10))}if(he.type==="date"){he.tick0=e.dateTick0(he.calendar,0);var He=2*xe;if(He>l)xe/=l,qe=Xe(10),he.dtick="M"+12*ze(xe,qe,be);else if(He>T)xe/=T,he.dtick="M"+ze(xe,1,Ce);else if(He>k){if(he.dtick=ze(xe,k,he._hasDayOfWeekBreaks?[1,2,7,14]:ve),!De){var st=U.getTickFormat(he),it=he.ticklabelmode==="period";it&&(he._rawTick0=he.tick0),/%[uVW]/.test(st)?he.tick0=e.dateTick0(he.calendar,2):he.tick0=e.dateTick0(he.calendar,1),it&&(he._dowTick0=he.tick0)}}else He>A?he.dtick=ze(xe,A,Ce):He>I?he.dtick=ze(xe,I,fe):He>P?he.dtick=ze(xe,P,fe):(qe=Xe(10),he.dtick=ze(xe,qe,be))}else if(he.type==="log"){he.tick0=0;var Tt=e.simpleMap(he.range,he.r2l);if(he._isMinor&&(xe*=1.5),xe>.7)he.dtick=Math.ceil(xe);else if(Math.abs(Tt[1]-Tt[0])<1){var Pt=1.5*Math.abs((Tt[1]-Tt[0])/xe);xe=Math.abs(Math.pow(10,Tt[1])-Math.pow(10,Tt[0]))/Pt,qe=Xe(10),he.dtick="L"+ze(xe,qe,be)}else he.dtick=xe>.3?"D2":"D1"}else he.type==="category"||he.type==="multicategory"?(he.tick0=0,he.dtick=Math.ceil(Math.max(xe,1))):ir(he)?(he.tick0=0,qe=1,he.dtick=ze(xe,qe,Le)):(he.tick0=0,qe=Xe(10),he.dtick=ze(xe,qe,be));if(he.dtick===0&&(he.dtick=1),!g(he.dtick)&&typeof he.dtick!="string"){var rt=he.dtick;throw he.dtick=1,"ax.dtick error: "+String(rt)}},U.tickIncrement=function(he,xe,De,qe){var Xe=De?-1:1;if(g(xe))return e.increment(he,Xe*xe);var He=xe.charAt(0),st=Xe*Number(xe.substr(1));if(He==="M")return e.incrementMonth(he,st,qe);if(He==="L")return Math.log(Math.pow(10,he)+st)/Math.LN10;if(He==="D"){var it=xe==="D2"?ke:Me,Tt=he+.01*Xe,Pt=e.roundUp(e.mod(Tt,1),it,De);return Math.floor(Tt)+Math.log(p.round(Math.pow(10,Pt),1))/Math.LN10}throw"unrecognized dtick "+String(xe)},U.tickFirst=function(he,xe){var De=he.r2l||Number,qe=e.simpleMap(he.range,De,void 0,void 0,xe),Xe=qe[1]<qe[0],He=Xe?Math.floor:Math.ceil,st=ne(qe)[0],it=he.dtick,Tt=De(he.tick0);if(g(it)){var Pt=He((st-Tt)/it)*it+Tt;return he.type!=="category"&&he.type!=="multicategory"||(Pt=e.constrain(Pt,0,he._categories.length-1)),Pt}var rt=it.charAt(0),ut=Number(it.substr(1));if(rt==="M"){for(var Ft,wt,Lt,Ae=0,Ye=Tt;Ae<10;){if(((Ft=U.tickIncrement(Ye,it,Xe,he.calendar))-st)*(Ye-st)<=0)return Xe?Math.min(Ye,Ft):Math.max(Ye,Ft);wt=(st-(Ye+Ft)/2)/(Ft-Ye),Lt=rt+(Math.abs(Math.round(wt))||1)*ut,Ye=U.tickIncrement(Ye,Lt,wt<0?!Xe:Xe,he.calendar),Ae++}return e.error("tickFirst did not converge",he),Ye}if(rt==="L")return Math.log(He((Math.pow(10,st)-Tt)/ut)*ut+Tt)/Math.LN10;if(rt==="D"){var nt=it==="D2"?ke:Me,ft=e.roundUp(e.mod(st,1),nt,Xe);return Math.floor(st)+Math.log(p.round(Math.pow(10,ft),1))/Math.LN10}throw"unrecognized dtick "+String(it)},U.tickText=function(he,xe,De,qe){var Xe,He=Oe(he,xe),st=he.tickmode==="array",it=De||st,Tt=he.type,Pt=Tt==="category"?he.d2l_noadd:he.d2l;if(st&&Array.isArray(he.ticktext)){var rt=e.simpleMap(he.range,he.r2l),ut=(Math.abs(rt[1]-rt[0])-(he._lBreaks||0))/1e4;for(Xe=0;Xe<he.ticktext.length&&!(Math.abs(xe-Pt(he.tickvals[Xe]))<ut);Xe++);if(Xe<he.ticktext.length)return He.text=String(he.ticktext[Xe]),He}function Ft(Ae){if(Ae===void 0)return!0;if(De)return Ae==="none";var Ye={first:he._tmin,last:he._tmax}[Ae];return Ae!=="all"&&xe!==Ye}var wt=De?"never":he.exponentformat!=="none"&&Ft(he.showexponent)?"hide":"";if(Tt==="date"?function(Ae,Ye,nt,ft){var Mt=Ae._tickround,Rt=nt&&Ae.hoverformat||U.getTickFormat(Ae);ft&&(Mt=g(Mt)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[Mt]);var Gt,jt=e.formatDate(Ye.x,Rt,Mt,Ae._dateFormat,Ae.calendar,Ae._extraFormat),pr=jt.indexOf(`
`);if(pr!==-1&&(Gt=jt.substr(pr+1),jt=jt.substr(0,pr)),ft&&(jt==="00:00:00"||jt==="00:00"?(jt=Gt,Gt=""):jt.length===8&&(jt=jt.replace(/:00$/,""))),Gt)if(nt)Mt==="d"?jt+=", "+Gt:jt=Gt+(jt?", "+jt:"");else if(Ae._inCalcTicks&&Ae._prevDateHead===Gt){var Ar=Ue(Ae),fr=Ae._trueSide||Ae.side;(!Ar&&fr==="top"||Ar&&fr==="bottom")&&(jt+="<br> ")}else Ae._prevDateHead=Gt,jt+="<br>"+Gt;Ye.text=jt}(he,He,De,it):Tt==="log"?function(Ae,Ye,nt,ft,Mt){var Rt=Ae.dtick,Gt=Ye.x,jt=Ae.tickformat,pr=typeof Rt=="string"&&Rt.charAt(0);if(Mt==="never"&&(Mt=""),ft&&pr!=="L"&&(Rt="L3",pr="L"),jt||pr==="L")Ye.text=Be(Math.pow(10,Gt),Ae,Mt,ft);else if(g(Rt)||pr==="D"&&e.mod(Gt+.01,1)<.1){var Ar=Math.round(Gt),fr=Math.abs(Ar),Zt=Ae.exponentformat;Zt==="power"||Pe(Zt)&&Ie(Ar)?(Ye.text=Ar===0?1:Ar===1?"10":"10<sup>"+(Ar>1?"":S)+fr+"</sup>",Ye.fontSize*=1.25):(Zt==="e"||Zt==="E")&&fr>2?Ye.text="1"+Zt+(Ar>0?"+":S)+fr:(Ye.text=Be(Math.pow(10,Gt),Ae,"","fakehover"),Rt==="D1"&&Ae._id.charAt(0)==="y"&&(Ye.dy-=Ye.fontSize/6))}else{if(pr!=="D")throw"unrecognized dtick "+String(Rt);Ye.text=String(Math.round(Math.pow(10,e.mod(Gt,1)))),Ye.fontSize*=.75}if(Ae.dtick==="D1"){var Qt=String(Ye.text).charAt(0);Qt!=="0"&&Qt!=="1"||(Ae._id.charAt(0)==="y"?Ye.dx-=Ye.fontSize/4:(Ye.dy+=Ye.fontSize/2,Ye.dx+=(Ae.range[1]>Ae.range[0]?1:-1)*Ye.fontSize*(Gt<0?.5:.25)))}}(he,He,0,it,wt):Tt==="category"?function(Ae,Ye){var nt=Ae._categories[Math.round(Ye.x)];nt===void 0&&(nt=""),Ye.text=String(nt)}(he,He):Tt==="multicategory"?function(Ae,Ye,nt){var ft=Math.round(Ye.x),Mt=Ae._categories[ft]||[],Rt=Mt[1]===void 0?"":String(Mt[1]),Gt=Mt[0]===void 0?"":String(Mt[0]);nt?Ye.text=Gt+" - "+Rt:(Ye.text=Rt,Ye.text2=Gt)}(he,He,De):ir(he)?function(Ae,Ye,nt,ft,Mt){if(Ae.thetaunit!=="radians"||nt)Ye.text=Be(Ye.x,Ae,Mt,ft);else{var Rt=Ye.x/180;if(Rt===0)Ye.text="0";else{var Gt=function(pr){function Ar($t,hr){return Math.abs($t-hr)<=1e-6}var fr=function($t){for(var hr=1;!Ar(Math.round($t*hr)/hr,$t);)hr*=10;return hr}(pr),Zt=pr*fr,Qt=Math.abs(function $t(hr,vr){return Ar(vr,0)?hr:$t(vr,hr%vr)}(Zt,fr));return[Math.round(Zt/Qt),Math.round(fr/Qt)]}(Rt);if(Gt[1]>=100)Ye.text=Be(e.deg2rad(Ye.x),Ae,Mt,ft);else{var jt=Ye.x<0;Gt[1]===1?Gt[0]===1?Ye.text="\u03C0":Ye.text=Gt[0]+"\u03C0":Ye.text=["<sup>",Gt[0],"</sup>","\u2044","<sub>",Gt[1],"</sub>","\u03C0"].join(""),jt&&(Ye.text=S+Ye.text)}}}}(he,He,De,it,wt):function(Ae,Ye,nt,ft,Mt){Mt==="never"?Mt="":Ae.showexponent==="all"&&Math.abs(Ye.x/Ae.dtick)<1e-6&&(Mt="hide"),Ye.text=Be(Ye.x,Ae,Mt,ft)}(he,He,0,it,wt),qe||(he.tickprefix&&!Ft(he.showtickprefix)&&(He.text=he.tickprefix+He.text),he.ticksuffix&&!Ft(he.showticksuffix)&&(He.text+=he.ticksuffix)),he.tickson==="boundaries"||he.showdividers){var Lt=function(Ae){var Ye=he.l2p(Ae);return Ye>=0&&Ye<=he._length?Ae:null};He.xbnd=[Lt(He.x-.5),Lt(He.x+he.dtick-.5)]}return He},U.hoverLabelText=function(he,xe,De){De&&(he=e.extendFlat({},he,{hoverformat:De}));var qe=Array.isArray(xe)?xe[0]:xe,Xe=Array.isArray(xe)?xe[1]:void 0;if(Xe!==void 0&&Xe!==qe)return U.hoverLabelText(he,qe,De)+" - "+U.hoverLabelText(he,Xe,De);var He=he.type==="log"&&qe<=0,st=U.tickText(he,he.c2l(He?-qe:qe),"hover").text;return He?qe===0?"0":S+st:st};var Ze=["f","p","n","\u03BC","m","","k","M","G","T"];function Pe(he){return he==="SI"||he==="B"}function Ie(he){return he>14||he<-15}function Be(he,xe,De,qe){var Xe=he<0,He=xe._tickround,st=De||xe.exponentformat||"B",it=xe._tickexponent,Tt=U.getTickFormat(xe),Pt=xe.separatethousands;if(qe){var rt={exponentformat:st,minexponent:xe.minexponent,dtick:xe.showexponent==="none"?xe.dtick:g(he)&&Math.abs(he)||1,range:xe.showexponent==="none"?xe.range.map(xe.r2d):[0,he||1]};Re(rt),He=(Number(rt._tickround)||0)+4,it=rt._tickexponent,xe.hoverformat&&(Tt=xe.hoverformat)}if(Tt)return xe._numFormat(Tt)(he).replace(/-/g,S);var ut,Ft=Math.pow(10,-He)/2;if(st==="none"&&(it=0),(he=Math.abs(he))<Ft)he="0",Xe=!1;else{if(he+=Ft,it&&(he*=Math.pow(10,-it),He+=it),He===0)he=String(Math.floor(he));else if(He<0){he=(he=String(Math.round(he))).substr(0,he.length+He);for(var wt=He;wt<0;wt++)he+="0"}else{var Lt=(he=String(he)).indexOf(".")+1;Lt&&(he=he.substr(0,Lt+He).replace(/\.?0+$/,""))}he=e.numSeparate(he,xe._separators,Pt)}return it&&st!=="hide"&&(Pe(st)&&Ie(it)&&(st="power"),ut=it<0?S+-it:st!=="power"?"+"+it:String(it),st==="e"||st==="E"?he+=st+ut:st==="power"?he+="\xD710<sup>"+ut+"</sup>":st==="B"&&it===9?he+="B":Pe(st)&&(he+=Ze[it/3+5])),Xe?S+he:he}function Fe(he,xe){if(he){var De=Object.keys($).reduce(function(qe,Xe){return xe.indexOf(Xe)!==-1&&$[Xe].forEach(function(He){qe[He]=1}),qe},{});Object.keys(he).forEach(function(qe){De[qe]||(qe.length===1?he[qe]=0:delete he[qe])})}}function $e(he,xe){for(var De=[],qe={},Xe=0;Xe<xe.length;Xe++){var He=xe[Xe];qe[He.text2]?qe[He.text2].push(He.x):qe[He.text2]=[He.x]}for(var st in qe)De.push(Oe(he,e.interp(qe[st],.5),st));return De}function ot(he){return he.periodX!==void 0?he.periodX:he.x}function pt(he){return[he.text,he.x,he.axInfo,he.font,he.fontSize,he.fontColor].join("_")}function _t(he){var xe=he.title.font.size,De=(he.title.text.match(t.BR_TAG_ALL)||[]).length;return he.title.hasOwnProperty("standoff")?De?xe*(te+De*N):xe*te:De?xe*(De+1)*N:xe}function yt(he,xe){var De=he.l2p(xe);return De>1&&De<he._length-1}function tt(he){var xe=p.select(he),De=xe.select(".text-math-group");return De.empty()?xe.select("text"):De}function Ke(he){return he._id+".automargin"}function vt(he){return Ke(he)+".mirror"}function Nt(he){return he._id+".rangeslider"}function qt(he,xe){for(var De=0;De<xe.length;De++)he.indexOf(xe[De])===-1&&he.push(xe[De])}function er(he,xe,De){var qe,Xe,He=[],st=[],it=he.layout;for(qe=0;qe<xe.length;qe++)He.push(U.getFromId(he,xe[qe]));for(qe=0;qe<De.length;qe++)st.push(U.getFromId(he,De[qe]));var Tt=Object.keys(o),Pt=["anchor","domain","overlaying","position","side","tickangle","editType"],rt=["linear","log"];for(qe=0;qe<Tt.length;qe++){var ut=Tt[qe],Ft=He[0][ut],wt=st[0][ut],Lt=!0,Ae=!1,Ye=!1;if(ut.charAt(0)!=="_"&&typeof Ft!="function"&&Pt.indexOf(ut)===-1){for(Xe=1;Xe<He.length&&Lt;Xe++){var nt=He[Xe][ut];ut==="type"&&rt.indexOf(Ft)!==-1&&rt.indexOf(nt)!==-1&&Ft!==nt?Ae=!0:nt!==Ft&&(Lt=!1)}for(Xe=1;Xe<st.length&&Lt;Xe++){var ft=st[Xe][ut];ut==="type"&&rt.indexOf(wt)!==-1&&rt.indexOf(ft)!==-1&&wt!==ft?Ye=!0:st[Xe][ut]!==wt&&(Lt=!1)}Lt&&(Ae&&(it[He[0]._name].type="linear"),Ye&&(it[st[0]._name].type="linear"),Jt(it,ut,He,st,he._fullLayout._dfltTitle))}}for(qe=0;qe<he._fullLayout.annotations.length;qe++){var Mt=he._fullLayout.annotations[qe];xe.indexOf(Mt.xref)!==-1&&De.indexOf(Mt.yref)!==-1&&e.swapAttrs(it.annotations[qe],["?"])}}function Jt(he,xe,De,qe,Xe){var He,st=e.nestedProperty,it=st(he[De[0]._name],xe).get(),Tt=st(he[qe[0]._name],xe).get();for(xe==="title"&&(it&&it.text===Xe.x&&(it.text=Xe.y),Tt&&Tt.text===Xe.y&&(Tt.text=Xe.x)),He=0;He<De.length;He++)st(he,De[He]._name+"."+xe).set(Tt);for(He=0;He<qe.length;He++)st(he,qe[He]._name+"."+xe).set(it)}function ir(he){return he._id==="angularaxis"}function Ht(he,xe){for(var De=xe._rangebreaks.length,qe=0;qe<De;qe++){var Xe=xe._rangebreaks[qe];if(he>=Xe.min&&he<Xe.max)return Xe.max}return he}function Ue(he){return(he.ticklabelposition||"").indexOf("inside")!==-1}function We(he,xe){Ue(he._anchorAxis||{})&&he._hideCounterAxisInsideTickLabels&&he._hideCounterAxisInsideTickLabels(xe)}U.getTickFormat=function(he){var xe,De,qe,Xe,He,st,it,Tt;function Pt(Ft){return typeof Ft!="string"?Ft:Number(Ft.replace("M",""))*T}function rt(Ft,wt){var Lt=["L","D"];if(typeof Ft==typeof wt){if(typeof Ft=="number")return Ft-wt;var Ae=Lt.indexOf(Ft.charAt(0)),Ye=Lt.indexOf(wt.charAt(0));return Ae===Ye?Number(Ft.replace(/(L|D)/g,""))-Number(wt.replace(/(L|D)/g,"")):Ae-Ye}return typeof Ft=="number"?1:-1}function ut(Ft,wt){var Lt=wt[0]===null,Ae=wt[1]===null,Ye=rt(Ft,wt[0])>=0,nt=rt(Ft,wt[1])<=0;return(Lt||Ye)&&(Ae||nt)}if(he.tickformatstops&&he.tickformatstops.length>0)switch(he.type){case"date":case"linear":for(xe=0;xe<he.tickformatstops.length;xe++)if((qe=he.tickformatstops[xe]).enabled&&(Xe=he.dtick,He=qe.dtickrange,st=void 0,it=void 0,Tt=void 0,st=Pt||function(Ft){return Ft},it=He[0],Tt=He[1],(!it&&typeof it!="number"||st(it)<=st(Xe))&&(!Tt&&typeof Tt!="number"||st(Tt)>=st(Xe)))){De=qe;break}break;case"log":for(xe=0;xe<he.tickformatstops.length;xe++)if((qe=he.tickformatstops[xe]).enabled&&ut(he.dtick,qe.dtickrange)){De=qe;break}}return De?De.value:he.tickformat},U.getSubplots=function(he,xe){var De=he._fullLayout._subplots,qe=De.cartesian.concat(De.gl2d||[]),Xe=xe?U.findSubplotsWithAxis(qe,xe):qe;return Xe.sort(function(He,st){var it=He.substr(1).split("y"),Tt=st.substr(1).split("y");return it[0]===Tt[0]?+it[1]-+Tt[1]:+it[0]-+Tt[0]}),Xe},U.findSubplotsWithAxis=function(he,xe){for(var De=new RegExp(xe._id.charAt(0)==="x"?"^"+xe._id+"y":xe._id+"$"),qe=[],Xe=0;Xe<he.length;Xe++){var He=he[Xe];De.test(He)&&qe.push(He)}return qe},U.makeClipPaths=function(he){var xe=he._fullLayout;if(!xe._hasOnlyLargeSploms){var De,qe,Xe={_offset:0,_length:xe.width,_id:""},He={_offset:0,_length:xe.height,_id:""},st=U.list(he,"x",!0),it=U.list(he,"y",!0),Tt=[];for(De=0;De<st.length;De++)for(Tt.push({x:st[De],y:He}),qe=0;qe<it.length;qe++)De===0&&Tt.push({x:Xe,y:it[qe]}),Tt.push({x:st[De],y:it[qe]});var Pt=xe._clips.selectAll(".axesclip").data(Tt,function(rt){return rt.x._id+rt.y._id});Pt.enter().append("clipPath").classed("axesclip",!0).attr("id",function(rt){return"clip"+xe._uid+rt.x._id+rt.y._id}).append("rect"),Pt.exit().remove(),Pt.each(function(rt){p.select(this).select("rect").attr({x:rt.x._offset||0,y:rt.y._offset||0,width:rt.x._length||1,height:rt.y._length||1})})}},U.draw=function(he,xe,De){var qe=he._fullLayout;xe==="redraw"&&qe._paper.selectAll("g.subplot").each(function(He){var st=He[0],it=qe._plots[st];if(it){var Tt=it.xaxis,Pt=it.yaxis;it.xaxislayer.selectAll("."+Tt._id+"tick").remove(),it.yaxislayer.selectAll("."+Pt._id+"tick").remove(),it.xaxislayer.selectAll("."+Tt._id+"tick2").remove(),it.yaxislayer.selectAll("."+Pt._id+"tick2").remove(),it.xaxislayer.selectAll("."+Tt._id+"divider").remove(),it.yaxislayer.selectAll("."+Pt._id+"divider").remove(),it.minorGridlayer&&it.minorGridlayer.selectAll("path").remove(),it.gridlayer&&it.gridlayer.selectAll("path").remove(),it.zerolinelayer&&it.zerolinelayer.selectAll("path").remove(),qe._infolayer.select(".g-"+Tt._id+"title").remove(),qe._infolayer.select(".g-"+Pt._id+"title").remove()}});var Xe=xe&&xe!=="redraw"?xe:U.listIds(he);return e.syncOrAsync(Xe.map(function(He){return function(){if(He){var st=U.getFromId(he,He),it=U.drawOne(he,st,De);return st._r=st.range.slice(),st._rl=e.simpleMap(st._r,st.r2l),it}}}))},U.drawOne=function(he,xe,De){var qe,Xe,He;De=De||{},xe.setScale();var st=he._fullLayout,it=xe._id,Tt=it.charAt(0),Pt=U.counterLetter(it),rt=st._plots[xe._mainSubplot];if(rt){var ut=rt[Tt+"axislayer"],Ft=xe._mainLinePosition,wt=xe._mainMirrorPosition,Lt=xe._vals=U.calcTicks(xe),Ae=[xe.mirror,Ft,wt].join("_");for(qe=0;qe<Lt.length;qe++)Lt[qe].axInfo=Ae;xe._selections={},xe._tickAngles&&(xe._prevTickAngles=xe._tickAngles),xe._tickAngles={},xe._depth=null;var Ye={};if(xe.visible){var nt,ft,Mt=U.makeTransTickFn(xe),Rt=U.makeTransTickLabelFn(xe),Gt=xe.ticks==="inside",jt=xe.ticks==="outside";if(xe.tickson==="boundaries"){var pr=function(tr,yr){var Ct,lr=[],dr=function(Fr,Rr){var zr=Fr.xbnd[Rr];zr!==null&&lr.push(e.extendFlat({},Fr,{x:zr}))};if(yr.length){for(Ct=0;Ct<yr.length;Ct++)dr(yr[Ct],0);dr(yr[Ct-1],1)}return lr}(0,Lt);ft=U.clipEnds(xe,pr),nt=Gt?ft:pr}else ft=U.clipEnds(xe,Lt),nt=Gt&&xe.ticklabelmode!=="period"?ft:Lt;var Ar,fr=xe._gridVals=ft,Zt=function(tr,yr){var Ct,lr,dr=[],Fr=yr.length&&yr[yr.length-1].x<yr[0].x,Rr=function(Er,xr){var _r=Er.xbnd[xr];_r!==null&&dr.push(e.extendFlat({},Er,{x:_r}))};if(tr.showdividers&&yr.length){for(Ct=0;Ct<yr.length;Ct++){var zr=yr[Ct];zr.text2!==lr&&Rr(zr,Fr?1:0),lr=zr.text2}Rr(yr[Ct-1],Fr?0:1)}return dr}(xe,Lt);if(!st._hasOnlyLargeSploms){var Qt=xe._subplotsWith,$t={};for(qe=0;qe<Qt.length;qe++){Xe=Qt[qe];var hr=(He=st._plots[Xe])[Pt+"axis"],vr=hr._mainAxis._id;if(!$t[vr]){$t[vr]=1;var Mr=Tt==="x"?"M0,"+hr._offset+"v"+hr._length:"M"+hr._offset+",0h"+hr._length;U.drawGrid(he,xe,{vals:fr,counterAxis:hr,layer:He.gridlayer.select("."+it),minorLayer:He.minorGridlayer.select("."+it),path:Mr,transFn:Mt}),U.drawZeroLine(he,xe,{counterAxis:hr,layer:He.zerolinelayer,path:Mr,transFn:Mt})}}}var Nr=U.getTickSigns(xe),Ur=U.getTickSigns(xe,"minor");if(xe.ticks||xe.minor&&xe.minor.ticks){var Jr,mn,en,In,vn=U.makeTickPath(xe,Ft,Nr[2]),gn=U.makeTickPath(xe,Ft,Ur[2],{minor:!0});if(xe._anchorAxis&&xe.mirror&&xe.mirror!==!0?(Jr=U.makeTickPath(xe,wt,Nr[3]),mn=U.makeTickPath(xe,wt,Ur[3],{minor:!0}),en=vn+Jr,In=gn+mn):(Jr="",mn="",en=vn,In=gn),xe.showdividers&&jt&&xe.tickson==="boundaries"){var Sn={};for(qe=0;qe<Zt.length;qe++)Sn[Zt[qe].x]=1;Ar=function(tr){return Sn[tr.x]?Jr:en}}else Ar=function(tr){return tr.minor?In:en}}if(U.drawTicks(he,xe,{vals:nt,layer:ut,path:Ar,transFn:Mt}),xe.mirror==="allticks"){var Xn=Object.keys(xe._linepositions||{});for(qe=0;qe<Xn.length;qe++){Xe=Xn[qe],He=st._plots[Xe];var Br=xe._linepositions[Xe]||[],pn=Br[0],on=Br[1],Yr=Br[2],Nn=U.makeTickPath(xe,pn,Yr?Nr[0]:Ur[0],{minor:Yr})+U.makeTickPath(xe,on,Yr?Nr[1]:Ur[1],{minor:Yr});U.drawTicks(he,xe,{vals:nt,layer:He[Tt+"axislayer"],path:Nn,transFn:Mt})}}var Hn=[];if(Hn.push(function(){return U.drawLabels(he,xe,{vals:Lt,layer:ut,plotinfo:He,transFn:Rt,labelFns:U.makeLabelFns(xe,Ft)})}),xe.type==="multicategory"){var xn={x:2,y:10}[Tt];Hn.push(function(){var tr={x:"height",y:"width"}[Tt],yr=ua()[tr]+xn+(xe._tickAngles[it+"tick"]?xe.tickfont.size*N:0);return U.drawLabels(he,xe,{vals:$e(xe,Lt),layer:ut,cls:it+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:Mt,labelFns:U.makeLabelFns(xe,Ft+yr*Nr[4])})}),Hn.push(function(){return xe._depth=Nr[4]*(ua("tick2")[xe.side]-Ft),function(tr,yr,Ct){var lr=yr._id+"divider",dr=Ct.vals,Fr=Ct.layer.selectAll("path."+lr).data(dr,pt);Fr.exit().remove(),Fr.enter().insert("path",":first-child").classed(lr,1).classed("crisp",1).call(r.stroke,yr.dividercolor).style("stroke-width",m.crispRound(tr,yr.dividerwidth,1)+"px"),Fr.attr("transform",Ct.transFn).attr("d",Ct.path)}(he,xe,{vals:Zt,layer:ut,path:U.makeTickPath(xe,Ft,Nr[4],{len:xe._depth}),transFn:Mt})})}else xe.title.hasOwnProperty("standoff")&&Hn.push(function(){xe._depth=Nr[4]*(ua()[xe.side]-Ft)});var On=y.getComponentMethod("rangeslider","isVisible")(xe);return Hn.push(function(){var tr,yr,Ct,lr,dr=xe.side.charAt(0),Fr=B[xe.side].charAt(0),Rr=U.getPxPosition(he,xe),zr=jt?xe.ticklen:0;if((xe.automargin||On)&&(xe.type==="multicategory"?tr=ua("tick2"):(tr=ua(),Tt==="x"&&dr==="b"&&(xe._depth=Math.max(tr.width>0?tr.bottom-Rr:0,zr)))),xe.automargin){yr={x:0,y:0,r:0,l:0,t:0,b:0};var Er=[0,1];if(Tt==="x"){if(dr==="b"?yr[dr]=xe._depth:(yr[dr]=xe._depth=Math.max(tr.width>0?Rr-tr.top:0,zr),Er.reverse()),tr.width>0){var xr=tr.right-(xe._offset+xe._length);xr>0&&(yr.xr=1,yr.r=xr);var _r=xe._offset-tr.left;_r>0&&(yr.xl=0,yr.l=_r)}}else if(dr==="l"?yr[dr]=xe._depth=Math.max(tr.height>0?Rr-tr.left:0,zr):(yr[dr]=xe._depth=Math.max(tr.height>0?tr.right-Rr:0,zr),Er.reverse()),tr.height>0){var kr=tr.bottom-(xe._offset+xe._length);kr>0&&(yr.yb=0,yr.b=kr);var Cr=xe._offset-tr.top;Cr>0&&(yr.yt=1,yr.t=Cr)}yr[Pt]=xe.anchor==="free"?xe.position:xe._anchorAxis.domain[Er[0]],xe.title.text!==st._dfltTitle[Tt]&&(yr[dr]+=_t(xe)+(xe.title.standoff||0)),xe.mirror&&xe.anchor!=="free"&&((Ct={x:0,y:0,r:0,l:0,t:0,b:0})[Fr]=xe.linewidth,xe.mirror&&xe.mirror!==!0&&(Ct[Fr]+=zr),xe.mirror===!0||xe.mirror==="ticks"?Ct[Pt]=xe._anchorAxis.domain[Er[1]]:xe.mirror!=="all"&&xe.mirror!=="allticks"||(Ct[Pt]=[xe._counterDomainMin,xe._counterDomainMax][Er[1]]))}On&&(lr=y.getComponentMethod("rangeslider","autoMarginOpts")(he,xe)),typeof xe.automargin=="string"&&(Fe(yr,xe.automargin),Fe(Ct,xe.automargin)),b.autoMargin(he,Ke(xe),yr),b.autoMargin(he,vt(xe),Ct),b.autoMargin(he,Nt(xe),lr)}),De.skipTitle||On&&xe.side==="bottom"||Hn.push(function(){return function(tr,yr){var Ct,lr=tr._fullLayout,dr=yr._id,Fr=dr.charAt(0),Rr=yr.title.font.size;if(yr.title.hasOwnProperty("standoff"))Ct=yr._depth+yr.title.standoff+_t(yr);else{var zr=Ue(yr);if(yr.type==="multicategory")Ct=yr._depth;else{var Er=1.5*Rr;zr&&(Er=.5*Rr,yr.ticks==="outside"&&(Er+=yr.ticklen)),Ct=10+Er+(yr.linewidth?yr.linewidth-1:0)}zr||(Ct+=Fr==="x"?yr.side==="top"?Rr*(yr.showticklabels?1:0):Rr*(yr.showticklabels?1.5:.5):yr.side==="right"?Rr*(yr.showticklabels?1:.5):Rr*(yr.showticklabels?.5:0))}var xr,_r,kr,Cr,Gr=U.getPxPosition(tr,yr);if(Fr==="x"?(_r=yr._offset+yr._length/2,kr=yr.side==="top"?Gr-Ct:Gr+Ct):(kr=yr._offset+yr._length/2,_r=yr.side==="right"?Gr+Ct:Gr-Ct,xr={rotate:"-90",offset:0}),yr.type!=="multicategory"){var qr=yr._selections[yr._id+"tick"];if(Cr={selection:qr,side:yr.side},qr&&qr.node()&&qr.node().parentNode){var tn=m.getTranslate(qr.node().parentNode);Cr.offsetLeft=tn.x,Cr.offsetTop=tn.y}yr.title.hasOwnProperty("standoff")&&(Cr.pad=0)}return a.draw(tr,dr+"title",{propContainer:yr,propName:yr._name+".title.text",placeholder:lr._dfltTitle[Fr],avoid:Cr,transform:xr,attributes:{x:_r,y:kr,"text-anchor":"middle"}})}(he,xe)}),e.syncOrAsync(Hn)}}function ua(tr){var yr=it+(tr||"tick");return Ye[yr]||(Ye[yr]=function(Ct,lr){var dr,Fr,Rr,zr;return Ct._selections[lr].size()?(dr=1/0,Fr=-1/0,Rr=1/0,zr=-1/0,Ct._selections[lr].each(function(){var Er=tt(this),xr=m.bBox(Er.node().parentNode);dr=Math.min(dr,xr.top),Fr=Math.max(Fr,xr.bottom),Rr=Math.min(Rr,xr.left),zr=Math.max(zr,xr.right)})):(dr=0,Fr=0,Rr=0,zr=0),{top:dr,bottom:Fr,left:Rr,right:zr,height:Fr-dr,width:zr-Rr}}(xe,yr)),Ye[yr]}},U.getTickSigns=function(he,xe){var De=he._id.charAt(0),qe={x:"top",y:"right"}[De],Xe=he.side===qe?1:-1,He=[-1,1,Xe,-Xe];return(xe?(he.minor||{}).ticks:he.ticks)!=="inside"==(De==="x")&&(He=He.map(function(st){return-st})),he.side&&He.push({l:-1,t:-1,r:1,b:1}[he.side.charAt(0)]),He},U.makeTransTickFn=function(he){return he._id.charAt(0)==="x"?function(xe){return n(he._offset+he.l2p(xe.x),0)}:function(xe){return n(0,he._offset+he.l2p(xe.x))}},U.makeTransTickLabelFn=function(he){var xe=function(Xe){var He=Xe.ticklabelposition||"",st=function(nt){return He.indexOf(nt)!==-1},it=st("top"),Tt=st("left"),Pt=st("right"),rt=st("bottom"),ut=st("inside"),Ft=rt||Tt||it||Pt;if(!Ft&&!ut)return[0,0];var wt=Xe.side,Lt=Ft?(Xe.tickwidth||0)/2:0,Ae=3,Ye=Xe.tickfont?Xe.tickfont.size:12;return(rt||it)&&(Lt+=Ye*te,Ae+=(Xe.linewidth||0)/2),(Tt||Pt)&&(Lt+=(Xe.linewidth||0)/2,Ae+=3),ut&&wt==="top"&&(Ae-=Ye*(1-te)),(Tt||it)&&(Lt=-Lt),wt!=="bottom"&&wt!=="right"||(Ae=-Ae),[Ft?Lt:0,ut?Ae:0]}(he),De=xe[0],qe=xe[1];return he._id.charAt(0)==="x"?function(Xe){return n(De+he._offset+he.l2p(ot(Xe)),qe)}:function(Xe){return n(qe,De+he._offset+he.l2p(ot(Xe)))}},U.makeTickPath=function(he,xe,De,qe){qe||(qe={});var Xe=qe.minor;if(Xe&&!he.minor)return"";var He=qe.len!==void 0?qe.len:Xe?he.minor.ticklen:he.ticklen,st=he._id.charAt(0),it=(he.linewidth||1)/2;return st==="x"?"M0,"+(xe+it*De)+"v"+He*De:"M"+(xe+it*De)+",0h"+He*De},U.makeLabelFns=function(he,xe,De){var qe=he.ticklabelposition||"",Xe=function(Qt){return qe.indexOf(Qt)!==-1},He=Xe("top"),st=Xe("left"),it=Xe("right"),Tt=Xe("bottom")||st||He||it,Pt=Xe("inside"),rt=qe==="inside"&&he.ticks==="inside"||!Pt&&he.ticks==="outside"&&he.tickson!=="boundaries",ut=0,Ft=0,wt=rt?he.ticklen:0;if(Pt?wt*=-1:Tt&&(wt=0),rt&&(ut+=wt,De)){var Lt=e.deg2rad(De);ut=wt*Math.cos(Lt)+1,Ft=wt*Math.sin(Lt)}he.showticklabels&&(rt||he.showline)&&(ut+=.2*he.tickfont.size);var Ae,Ye,nt,ft,Mt,Rt={labelStandoff:ut+=(he.linewidth||1)/2*(Pt?-1:1),labelShift:Ft},Gt=0,jt=he.side,pr=he._id.charAt(0),Ar=he.tickangle;if(pr==="x")ft=(Mt=!Pt&&jt==="bottom"||Pt&&jt==="top")?1:-1,Pt&&(ft*=-1),Ae=Ft*ft,Ye=xe+ut*ft,nt=Mt?1:-.2,Math.abs(Ar)===90&&(Pt?nt+=W:nt=Ar===-90&&jt==="bottom"?te:Ar===90&&jt==="top"?W:.5,Gt=W/2*(Ar/90)),Rt.xFn=function(Qt){return Qt.dx+Ae+Gt*Qt.fontSize},Rt.yFn=function(Qt){return Qt.dy+Ye+Qt.fontSize*nt},Rt.anchorFn=function(Qt,$t){if(Tt){if(st)return"end";if(it)return"start"}return g($t)&&$t!==0&&$t!==180?$t*ft<0!==Pt?"end":"start":"middle"},Rt.heightFn=function(Qt,$t,hr){return $t<-60||$t>60?-.5*hr:he.side==="top"!==Pt?-hr:0};else if(pr==="y"){if(ft=(Mt=!Pt&&jt==="left"||Pt&&jt==="right")?1:-1,Pt&&(ft*=-1),Ae=ut,Ye=Ft*ft,nt=0,Pt||Math.abs(Ar)!==90||(nt=Ar===-90&&jt==="left"||Ar===90&&jt==="right"?te:.5),Pt){var fr=g(Ar)?+Ar:0;if(fr!==0){var Zt=e.deg2rad(fr);Gt=Math.abs(Math.sin(Zt))*te*ft,nt=0}}Rt.xFn=function(Qt){return Qt.dx+xe-(Ae+Qt.fontSize*nt)*ft+Gt*Qt.fontSize},Rt.yFn=function(Qt){return Qt.dy+Ye+Qt.fontSize*W},Rt.anchorFn=function(Qt,$t){return g($t)&&Math.abs($t)===90?"middle":Mt?"end":"start"},Rt.heightFn=function(Qt,$t,hr){return he.side==="right"&&($t*=-1),$t<-30?-hr:$t<30?-.5*hr:0}}return Rt},U.drawTicks=function(he,xe,De){De=De||{};var qe=xe._id+"tick",Xe=[].concat(xe.minor&&xe.minor.ticks?De.vals.filter(function(st){return st.minor&&!st.noTick}):[]).concat(xe.ticks?De.vals.filter(function(st){return!st.minor&&!st.noTick}):[]),He=De.layer.selectAll("path."+qe).data(Xe,pt);He.exit().remove(),He.enter().append("path").classed(qe,1).classed("ticks",1).classed("crisp",De.crisp!==!1).each(function(st){return r.stroke(p.select(this),st.minor?xe.minor.tickcolor:xe.tickcolor)}).style("stroke-width",function(st){return m.crispRound(he,st.minor?xe.minor.tickwidth:xe.tickwidth,1)+"px"}).attr("d",De.path).style("display",null),We(xe,[V]),He.attr("transform",De.transFn)},U.drawGrid=function(he,xe,De){De=De||{};var qe=xe._id+"grid",Xe=xe.minor&&xe.minor.showgrid,He=Xe?De.vals.filter(function(nt){return nt.minor}):[],st=xe.showgrid?De.vals.filter(function(nt){return!nt.minor}):[],it=De.counterAxis;if(it&&U.shouldShowZeroLine(he,xe,it))for(var Tt=xe.tickmode==="array",Pt=0;Pt<st.length;Pt++){var rt=st[Pt].x;if(Tt?!rt:Math.abs(rt)<xe.dtick/100){if(st=st.slice(0,Pt).concat(st.slice(Pt+1)),!Tt)break;Pt--}}xe._gw=m.crispRound(he,xe.gridwidth,1);for(var ut=Xe?m.crispRound(he,xe.minor.gridwidth,1):0,Ft=De.layer,wt=De.minorLayer,Lt=1;Lt>=0;Lt--){var Ae=Lt?Ft:wt;if(Ae){var Ye=Ae.selectAll("path."+qe).data(Lt?st:He,pt);Ye.exit().remove(),Ye.enter().append("path").classed(qe,1).classed("crisp",De.crisp!==!1),Ye.attr("transform",De.transFn).attr("d",De.path).each(function(nt){return r.stroke(p.select(this),nt.minor?xe.minor.gridcolor:xe.gridcolor||"#ddd")}).style("stroke-dasharray",function(nt){return m.dashStyle(nt.minor?xe.minor.griddash:xe.griddash,nt.minor?xe.minor.gridwidth:xe.gridwidth)}).style("stroke-width",function(nt){return(nt.minor?ut:xe._gw)+"px"}).style("display",null),typeof De.path=="function"&&Ye.attr("d",De.path)}}We(xe,[R,H])},U.drawZeroLine=function(he,xe,De){De=De||De;var qe=xe._id+"zl",Xe=U.shouldShowZeroLine(he,xe,De.counterAxis),He=De.layer.selectAll("path."+qe).data(Xe?[{x:0,id:xe._id}]:[]);He.exit().remove(),He.enter().append("path").classed(qe,1).classed("zl",1).classed("crisp",De.crisp!==!1).each(function(){De.layer.selectAll("path").sort(function(st,it){return Q(st.id,it.id)})}),He.attr("transform",De.transFn).attr("d",De.path).call(r.stroke,xe.zerolinecolor||r.defaultLine).style("stroke-width",m.crispRound(he,xe.zerolinewidth,xe._gw||1)+"px").style("display",null),We(xe,[D])},U.drawLabels=function(he,xe,De){De=De||{};var qe=he._fullLayout,Xe=xe._id,He=Xe.charAt(0),st=De.cls||Xe+"tick",it=De.vals.filter(function(ft){return ft.text}),Tt=De.labelFns,Pt=De.secondary?0:xe.tickangle,rt=(xe._prevTickAngles||{})[st],ut=De.layer.selectAll("g."+st).data(xe.showticklabels?it:[],pt),Ft=[];function wt(ft,Mt){ft.each(function(Rt){var Gt=p.select(this),jt=Gt.select(".text-math-group"),pr=Tt.anchorFn(Rt,Mt),Ar=De.transFn.call(Gt.node(),Rt)+(g(Mt)&&+Mt!=0?" rotate("+Mt+","+Tt.xFn(Rt)+","+(Tt.yFn(Rt)-Rt.fontSize/2)+")":""),fr=t.lineCount(Gt),Zt=N*Rt.fontSize,Qt=Tt.heightFn(Rt,g(Mt)?+Mt:0,(fr-1)*Zt);if(Qt&&(Ar+=n(0,Qt)),jt.empty()){var $t=Gt.select("text");$t.attr({transform:Ar,"text-anchor":pr}),$t.style("opacity",1),xe._adjustTickLabelsOverflow&&xe._adjustTickLabelsOverflow()}else{var hr=m.bBox(jt.node()).width*{end:-.5,start:.5}[pr];jt.attr("transform",Ar+n(hr,0))}})}ut.enter().append("g").classed(st,1).append("text").attr("text-anchor","middle").each(function(ft){var Mt=p.select(this),Rt=he._promises.length;Mt.call(t.positionText,Tt.xFn(ft),Tt.yFn(ft)).call(m.font,ft.font,ft.fontSize,ft.fontColor).text(ft.text).call(t.convertToTspans,he),he._promises[Rt]?Ft.push(he._promises.pop().then(function(){wt(Mt,Pt)})):wt(Mt,Pt)}),We(xe,[X]),ut.exit().remove(),De.repositionOnUpdate&&ut.each(function(ft){p.select(this).select("text").call(t.positionText,Tt.xFn(ft),Tt.yFn(ft))}),xe._adjustTickLabelsOverflow=function(){var ft=xe.ticklabeloverflow;if(ft&&ft!=="allow"){var Mt=ft.indexOf("hide")!==-1,Rt=xe._id.charAt(0)==="x",Gt=0,jt=Rt?he._fullLayout.width:he._fullLayout.height;if(ft.indexOf("domain")!==-1){var pr=e.simpleMap(xe.range,xe.r2l);Gt=xe.l2p(pr[0])+xe._offset,jt=xe.l2p(pr[1])+xe._offset}var Ar=Math.min(Gt,jt),fr=Math.max(Gt,jt),Zt=xe.side,Qt=1/0,$t=-1/0;for(var hr in ut.each(function(Nr){var Ur=p.select(this);if(Ur.select(".text-math-group").empty()){var Jr=m.bBox(Ur.node()),mn=0;Rt?(Jr.right>fr||Jr.left<Ar)&&(mn=1):(Jr.bottom>fr||Jr.top+(xe.tickangle?0:Nr.fontSize/4)<Ar)&&(mn=1);var en=Ur.select("text");mn?Mt&&en.style("opacity",0):(en.style("opacity",1),Qt=Zt==="bottom"||Zt==="right"?Math.min(Qt,Rt?Jr.top:Jr.left):-1/0,$t=Zt==="top"||Zt==="left"?Math.max($t,Rt?Jr.bottom:Jr.right):1/0)}}),qe._plots){var vr=qe._plots[hr];if(xe._id===vr.xaxis._id||xe._id===vr.yaxis._id){var Mr=Rt?vr.yaxis:vr.xaxis;Mr&&(Mr["_visibleLabelMin_"+xe._id]=Qt,Mr["_visibleLabelMax_"+xe._id]=$t)}}}},xe._hideCounterAxisInsideTickLabels=function(ft){var Mt=xe._id.charAt(0)==="x",Rt=[];for(var Gt in qe._plots){var jt=qe._plots[Gt];xe._id!==jt.xaxis._id&&xe._id!==jt.yaxis._id||Rt.push(Mt?jt.yaxis:jt.xaxis)}Rt.forEach(function(pr,Ar){pr&&Ue(pr)&&(ft||[D,H,R,V,X]).forEach(function(fr){var Zt=fr.K==="tick"&&fr.L==="text"&&xe.ticklabelmode==="period",Qt=qe._plots[xe._mainSubplot];(fr.K===D.K?Qt.zerolinelayer.selectAll("."+xe._id+"zl"):fr.K===H.K?Qt.minorGridlayer.selectAll("."+xe._id):fr.K===R.K?Qt.gridlayer.selectAll("."+xe._id):Qt[xe._id.charAt(0)+"axislayer"]).each(function(){var $t=p.select(this);fr.L&&($t=$t.selectAll(fr.L)),$t.each(function(hr){var vr=xe.l2p(Zt?ot(hr):hr.x)+xe._offset,Mr=p.select(this);vr<xe["_visibleLabelMax_"+pr._id]&&vr>xe["_visibleLabelMin_"+pr._id]?Mr.style("display","none"):fr.K!=="tick"||Ar||Mr.style("display",null)})})})})},wt(ut,rt+1?rt:Pt);var Lt=null;xe._selections&&(xe._selections[st]=ut);var Ae=[function(){return Ft.length&&Promise.all(Ft)}];xe.automargin&&qe._redrawFromAutoMarginCount&&rt===90?(Lt=90,Ae.push(function(){wt(ut,rt)})):Ae.push(function(){if(wt(ut,Pt),it.length&&He==="x"&&!g(Pt)&&(xe.type!=="log"||String(xe.dtick).charAt(0)!=="D")){Lt=0;var ft,Mt=0,Rt=[];if(ut.each(function(Ur){Mt=Math.max(Mt,Ur.fontSize);var Jr=xe.l2p(Ur.x),mn=tt(this),en=m.bBox(mn.node());Rt.push({top:0,bottom:10,height:10,left:Jr-en.width/2,right:Jr+en.width/2+2,width:en.width+2})}),xe.tickson!=="boundaries"&&!xe.showdividers||De.secondary){var Gt=it.length,jt=Math.abs((it[Gt-1].x-it[0].x)*xe._m)/(Gt-1),pr=xe.ticklabelposition||"",Ar=function(Ur){return pr.indexOf(Ur)!==-1},fr=Ar("top"),Zt=Ar("left"),Qt=Ar("right"),$t=Ar("bottom")||Zt||fr||Qt?(xe.tickwidth||0)+6:0,hr=jt<2.5*Mt||xe.type==="multicategory"||xe._name==="realaxis";for(ft=0;ft<Rt.length-1;ft++)if(e.bBoxIntersect(Rt[ft],Rt[ft+1],$t)){Lt=hr?90:30;break}}else{var vr=2;for(xe.ticks&&(vr+=xe.tickwidth/2),ft=0;ft<Rt.length;ft++){var Mr=it[ft].xbnd,Nr=Rt[ft];if(Mr[0]!==null&&Nr.left-xe.l2p(Mr[0])<vr||Mr[1]!==null&&xe.l2p(Mr[1])-Nr.right<vr){Lt=90;break}}}Lt&&wt(ut,Lt)}}),xe._tickAngles&&Ae.push(function(){xe._tickAngles[st]=Lt===null?g(Pt)?Pt:0:Lt});var Ye=xe._anchorAxis;Ye&&Ye.autorange&&Ue(xe)&&!K(qe,xe._id)&&(qe._insideTickLabelsAutorange||(qe._insideTickLabelsAutorange={}),qe._insideTickLabelsAutorange[Ye._name+".autorange"]=Ye.autorange,Ae.push(function(){ut.each(function(ft,Mt){var Rt=tt(this);Rt.select(".text-math-group").empty()&&(xe._vals[Mt].bb=m.bBox(Rt.node()))})}));var nt=e.syncOrAsync(Ae);return nt&&nt.then&&he._promises.push(nt),nt},U.getPxPosition=function(he,xe){var De,qe=he._fullLayout._size,Xe=xe._id.charAt(0),He=xe.side;return xe.anchor!=="free"?De=xe._anchorAxis:Xe==="x"?De={_offset:qe.t+(1-(xe.position||0))*qe.h,_length:0}:Xe==="y"&&(De={_offset:qe.l+(xe.position||0)*qe.w,_length:0}),He==="top"||He==="left"?De._offset:He==="bottom"||He==="right"?De._offset+De._length:void 0},U.shouldShowZeroLine=function(he,xe,De){var qe=e.simpleMap(xe.range,xe.r2l);return qe[0]*qe[1]<=0&&xe.zeroline&&(xe.type==="linear"||xe.type==="-")&&!(xe.rangebreaks&&xe.maskBreaks(0)===E)&&(yt(xe,0)||!function(Xe,He,st,it){var Tt=st._mainAxis;if(!Tt)return;var Pt=Xe._fullLayout,rt=He._id.charAt(0),ut=U.counterLetter(He._id),Ft=He._offset+(Math.abs(it[0])<Math.abs(it[1])==(rt==="x")?0:He._length);function wt(ft){if(!ft.showline||!ft.linewidth)return!1;var Mt=Math.max((ft.linewidth+He.zerolinewidth)/2,1);function Rt(pr){return typeof pr=="number"&&Math.abs(pr-Ft)<Mt}if(Rt(ft._mainLinePosition)||Rt(ft._mainMirrorPosition))return!0;var Gt=ft._linepositions||{};for(var jt in Gt)if(Rt(Gt[jt][0])||Rt(Gt[jt][1]))return!0}var Lt=Pt._plots[st._mainSubplot];if(!(Lt.mainplotinfo||Lt).overlays.length)return wt(st);for(var Ae=U.list(Xe,ut),Ye=0;Ye<Ae.length;Ye++){var nt=Ae[Ye];if(nt._mainAxis===Tt&&wt(nt))return!0}}(he,xe,De,qe)||function(Xe,He){for(var st=Xe._fullData,it=He._mainSubplot,Tt=He._id.charAt(0),Pt=0;Pt<st.length;Pt++){var rt=st[Pt];if(rt.visible===!0&&rt.xaxis+rt.yaxis===it&&(y.traceIs(rt,"bar-like")&&rt.orientation==={x:"h",y:"v"}[Tt]||rt.fill&&rt.fill.charAt(rt.fill.length-1)===Tt))return!0}return!1}(he,xe))},U.clipEnds=function(he,xe){return xe.filter(function(De){return yt(he,De.x)})},U.allowAutoMargin=function(he){for(var xe=U.list(he,"",!0),De=0;De<xe.length;De++){var qe=xe[De];qe.automargin&&(b.allowAutoMargin(he,Ke(qe)),qe.mirror&&b.allowAutoMargin(he,vt(qe))),y.getComponentMethod("rangeslider","isVisible")(qe)&&b.allowAutoMargin(he,Nt(qe))}},U.swap=function(he,xe){for(var De=function(Xe,He){var st,it,Tt=[];for(st=0;st<He.length;st++){var Pt=[],rt=Xe._fullData[He[st]].xaxis,ut=Xe._fullData[He[st]].yaxis;if(rt&&ut){for(it=0;it<Tt.length;it++)Tt[it].x.indexOf(rt)===-1&&Tt[it].y.indexOf(ut)===-1||Pt.push(it);if(Pt.length){var Ft,wt=Tt[Pt[0]];if(Pt.length>1)for(it=1;it<Pt.length;it++)Ft=Tt[Pt[it]],qt(wt.x,Ft.x),qt(wt.y,Ft.y);qt(wt.x,[rt]),qt(wt.y,[ut])}else Tt.push({x:[rt],y:[ut]})}}return Tt}(he,xe),qe=0;qe<De.length;qe++)er(he,De[qe].x,De[qe].y)}},{"../../components/color":367,"../../components/drawing":389,"../../components/titles":476,"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"./autorange":565,"./axis_autotype":567,"./axis_ids":570,"./clean_ticks":572,"./layout_attributes":579,"./set_convert":585,"@plotly/d3":58,"fast-isnumeric":190}],567:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("../../constants/numerical").BADNUM,y=g.isArrayOrTypedArray,e=g.isDateTime,n=g.cleanNumber,t=Math.round;function a(m,o){return o?p(m):typeof m=="number"}function r(m){return Math.max(1,(m-1)/1e3)}J.exports=function(m,o,i){var u=m,f=i.noMultiCategory;if(y(u)&&!u.length)return"-";if(!f&&function(x){return y(x[0])&&y(x[1])}(u))return"multicategory";if(f&&Array.isArray(u[0])){for(var l=[],h=0;h<u.length;h++)if(y(u[h]))for(var d=0;d<u[h].length;d++)l.push(u[h][d]);u=l}if(function(x,c){for(var T=x.length,_=r(T),w=0,k=0,L={},A=0;A<T;A+=_){var I=t(A),P=x[I],S=String(P);L[S]||(L[S]=1,e(P,c)&&w++,p(P)&&k++)}return w>2*k}(u,o))return"date";var s=i.autotypenumbers!=="strict";return function(x,c){for(var T=x.length,_=r(T),w=0,k=0,L={},A=0;A<T;A+=_){var I=t(A),P=x[I],S=String(P);if(!L[S]){L[S]=1;var E=typeof P;E==="boolean"?k++:(c?n(P)!==b:E==="number")?w++:E==="string"&&k++}}return k>2*w}(u,s)?"category":function(x,c){for(var T=x.length,_=0;_<T;_++)if(a(x[_],c))return!0;return!1}(u,s)?"linear":"-"}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],568:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../registry"),b=v("../../lib"),y=v("../../plot_api/plot_template"),e=v("../array_container_defaults"),n=v("./layout_attributes"),t=v("./tick_value_defaults"),a=v("./tick_mark_defaults"),r=v("./tick_label_defaults"),m=v("./prefix_suffix_defaults"),o=v("./category_order_defaults"),i=v("./line_grid_defaults"),u=v("./set_convert"),f=v("./constants").WEEKDAY_PATTERN,l=v("./constants").HOUR_PATTERN;function h(x,c,T){function _(E,D){return b.coerce(x,c,n.rangebreaks,E,D)}if(_("enabled")){var w=_("bounds");if(w&&w.length>=2){var k,L,A="";if(w.length===2){for(k=0;k<2;k++)if(L=s(w[k])){A=f;break}}var I=_("pattern",A);if(I===f)for(k=0;k<2;k++)(L=s(w[k]))&&(c.bounds[k]=w[k]=L-1);if(I)for(k=0;k<2;k++)switch(L=w[k],I){case f:if(!p(L)||(L=+L)!==Math.floor(L)||L<0||L>=7)return void(c.enabled=!1);c.bounds[k]=w[k]=L;break;case l:if(!p(L)||(L=+L)<0||L>24)return void(c.enabled=!1);c.bounds[k]=w[k]=L}if(T.autorange===!1){var P=T.range;if(P[0]<P[1]){if(w[0]<P[0]&&w[1]>P[1])return void(c.enabled=!1)}else if(w[0]>P[0]&&w[1]<P[1])return void(c.enabled=!1)}}else{var S=_("values");if(!S||!S.length)return void(c.enabled=!1);_("dvalue")}}}J.exports=function(x,c,T,_,w){var k,L=_.letter,A=_.font||{},I=_.splomStash||{},P=T("visible",!_.visibleDflt),S=c._template||{},E=c.type||S.type||"-";E==="date"&&(g.getComponentMethod("calendars","handleDefaults")(x,c,"calendar",_.calendar),_.noTicklabelmode||(k=T("ticklabelmode")));var D="";_.noTicklabelposition&&E!=="multicategory"||(D=b.coerce(x,c,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:k==="period"?["outside","inside"]:L==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),_.noTicklabeloverflow||T("ticklabeloverflow",D.indexOf("inside")!==-1?"hide past domain":E==="category"||E==="multicategory"?"allow":"hide past div"),u(c,w);var R=!c.isValidRange(x.range);R&&_.reverseDflt&&(R="reversed"),!T("autorange",R)||E!=="linear"&&E!=="-"||T("rangemode"),T("range"),c.cleanRange(),o(x,c,T,_),E==="category"||_.noHover||T("hoverformat");var H=T("color"),V=H!==n.color.dflt?H:A.color,X=I.label||w._dfltTitle[L];if(m(x,c,T,E,_),!P)return c;T("title.text",X),b.coerceFont(T,"title.font",{family:A.family,size:b.bigFont(A.size),color:V}),t(x,c,T,E);var $=_.hasMinor;if($&&(y.newContainer(c,"minor"),t(x,c,T,E,{isMinor:!0})),r(x,c,T,E,_),a(x,c,T,_),$){var G=_.isMinor;_.isMinor=!0,a(x,c,T,_),_.isMinor=G}i(x,c,T,{dfltColor:H,bgColor:_.bgColor,showGrid:_.showGrid,hasMinor:$,attributes:n}),!$||c.minor.ticks||c.minor.showgrid||delete c.minor,(c.showline||c.ticks)&&T("mirror"),_.automargin&&T("automargin");var W,te=E==="multicategory";if(_.noTickson||E!=="category"&&!te||!c.ticks&&!c.showgrid||(te&&(W="boundaries"),T("tickson",W)==="boundaries"&&delete c.ticklabelposition),te&&T("showdividers")&&(T("dividercolor"),T("dividerwidth")),E==="date")if(e(x,c,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:h}),c.rangebreaks.length){for(var N=0;N<c.rangebreaks.length;N++)if(c.rangebreaks[N].pattern===f){c._hasDayOfWeekBreaks=!0;break}if(u(c,w),w._has("scattergl")||w._has("splom"))for(var B=0;B<_.data.length;B++){var U=_.data[B];U.type!=="scattergl"&&U.type!=="splom"||(U.visible=!1,b.warn(U.type+" traces do not work on axes with rangebreaks. Setting trace "+U.index+" to `visible: false`."))}}else delete c.rangebreaks;return c};var d={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function s(x){if(typeof x=="string")return d[x.substr(0,3).toLowerCase()]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../array_container_defaults":561,"./category_order_defaults":571,"./constants":573,"./layout_attributes":579,"./line_grid_defaults":581,"./prefix_suffix_defaults":583,"./set_convert":585,"./tick_label_defaults":587,"./tick_mark_defaults":588,"./tick_value_defaults":589,"fast-isnumeric":190}],569:[function(v,J,Z){var p=v("../../constants/docs"),g=p.FORMAT_LINK,b=p.DATE_FORMAT_LINK;function y(n,t){return["Sets the "+n+" formatting rule"+(t?"for `"+t+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+g+"."].join(" ")}function e(n,t){return y(n,t)+[" And for dates see: "+b+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}J.exports={axisHoverFormat:function(n,t){return{valType:"string",dflt:"",editType:"none",description:(t?y:e)("hover text",n)+["By default the values are formatted using "+(t?"generic number format":"`"+n+"axis.hoverformat`")+"."].join(" ")}},descriptionOnlyNumbers:y,descriptionWithDates:e}},{"../../constants/docs":486}],570:[function(v,J,Z){var p=v("../../registry"),g=v("./constants");function b(y,e){if(e&&e.length){for(var n=0;n<e.length;n++)if(e[n][y])return!0}return!1}Z.id2name=function(y){if(typeof y=="string"&&y.match(g.AX_ID_PATTERN)){var e=y.split(" ")[0].substr(1);return e==="1"&&(e=""),y.charAt(0)+"axis"+e}},Z.name2id=function(y){if(y.match(g.AX_NAME_PATTERN)){var e=y.substr(5);return e==="1"&&(e=""),y.charAt(0)+e}},Z.cleanId=function(y,e,n){var t=/( domain)$/.test(y);if(typeof y=="string"&&y.match(g.AX_ID_PATTERN)&&(!e||y.charAt(0)===e)&&(!t||n)){var a=y.split(" ")[0].substr(1).replace(/^0+/,"");return a==="1"&&(a=""),y.charAt(0)+a+(t&&n?" domain":"")}},Z.list=function(y,e,n){var t=y._fullLayout;if(!t)return[];var a,r=Z.listIds(y,e),m=new Array(r.length);for(a=0;a<r.length;a++){var o=r[a];m[a]=t[o.charAt(0)+"axis"+o.substr(1)]}if(!n){var i=t._subplots.gl3d||[];for(a=0;a<i.length;a++){var u=t[i[a]];e?m.push(u[e+"axis"]):m.push(u.xaxis,u.yaxis,u.zaxis)}}return m},Z.listIds=function(y,e){var n=y._fullLayout;if(!n)return[];var t=n._subplots;return e?t[e+"axis"]:t.xaxis.concat(t.yaxis)},Z.getFromId=function(y,e,n){var t=y._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),n==="x"?e=e.replace(/y[0-9]*/,""):n==="y"&&(e=e.replace(/x[0-9]*/,"")),t[Z.id2name(e)]},Z.getFromTrace=function(y,e,n){var t=y._fullLayout,a=null;if(p.traceIs(e,"gl3d")){var r=e.scene;r.substr(0,5)==="scene"&&(a=t[r][n+"axis"])}else a=Z.getFromId(y,e[n+"axis"]||n);return a},Z.idSort=function(y,e){var n=y.charAt(0),t=e.charAt(0);return n!==t?n>t?1:-1:+(y.substr(1)||1)-+(e.substr(1)||1)},Z.ref2id=function(y){return!!/^[xyz]/.test(y)&&y.split(" ")[0]},Z.isLinked=function(y,e){return b(e,y._axisMatchGroups)||b(e,y._axisConstraintGroups)}},{"../../registry":647,"./constants":573}],571:[function(v,J,Z){J.exports=function(p,g,b,y){if(g.type==="category"){var e,n=p.categoryarray,t=Array.isArray(n)&&n.length>0;t&&(e="array");var a,r=b("categoryorder",e);r==="array"&&(a=b("categoryarray")),t||r!=="array"||(r=g.categoryorder="trace"),r==="trace"?g._initialCategories=[]:r==="array"?g._initialCategories=a.slice():(a=function(m,o){var i,u,f,l=o.dataAttr||m._id.charAt(0),h={};if(o.axData)i=o.axData;else for(i=[],u=0;u<o.data.length;u++){var d=o.data[u];d[l+"axis"]===m._id&&i.push(d)}for(u=0;u<i.length;u++){var s=i[u][l];for(f=0;f<s.length;f++){var x=s[f];x!=null&&(h[x]=1)}}return Object.keys(h)}(g,y).sort(),r==="category ascending"?g._initialCategories=a:r==="category descending"&&(g._initialCategories=a.reverse()))}}},{}],572:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("../../constants/numerical"),y=b.ONEDAY,e=b.ONEWEEK;Z.dtick=function(n,t){var a=t==="log",r=t==="date",m=t==="category",o=r?y:1;if(!n)return o;if(p(n))return(n=Number(n))<=0?o:m?Math.max(1,Math.round(n)):r?Math.max(.1,n):n;if(typeof n!="string"||!r&&!a)return o;var i=n.charAt(0),u=n.substr(1);return(u=p(u)?Number(u):0)<=0||!(r&&i==="M"&&u===Math.round(u)||a&&i==="L"||a&&i==="D"&&(u===1||u===2))?o:n},Z.tick0=function(n,t,a,r){return t==="date"?g.cleanDate(n,g.dateTick0(a,r%e==0?1:0)):r!=="D1"&&r!=="D2"?p(n)?Number(n):0:void 0}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],573:[function(v,J,Z){var p=v("../../lib/regex").counter;J.exports={idRegex:{x:p("x","( domain)?"),y:p("y","( domain)?")},attrRegex:p("[xy]axis"),xAxisMatch:p("xaxis"),yAxisMatch:p("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":532}],574:[function(v,J,Z){var p=v("../../lib"),g=v("./autorange"),b=v("./axis_ids").id2name,y=v("./layout_attributes"),e=v("./scale_zoom"),n=v("./set_convert"),t=v("../../constants/numerical").ALMOST_EQUAL,a=v("../../constants/alignment").FROM_BL;function r(h,d,s){var x=s.axIds,c=s.layoutOut,T=s.hasImage,_=c._axisConstraintGroups,w=c._axisMatchGroups,k=d._id,L=k.charAt(0),A=((c._splomAxes||{})[L]||{})[k]||{},I=d._id,P=I.charAt(0)==="x";function S(ee,j){return p.coerce(h,d,y,ee,j)}d._matchGroup=null,d._constraintGroup=null,S("constrain",T?"domain":"range"),p.coerce(h,d,{constraintoward:{valType:"enumerated",values:P?["left","center","right"]:["bottom","middle","top"],dflt:P?"center":"middle"}},"constraintoward");var E,D,R=d.type,H=[];for(E=0;E<x.length;E++)(D=x[E])!==I&&c[b(D)].type===R&&H.push(D);var V=o(_,I);if(V){var X=[];for(E=0;E<H.length;E++)V[D=H[E]]||X.push(D);H=X}var $,G,W=H.length;W&&(h.matches||A.matches)&&($=p.coerce(h,d,{matches:{valType:"enumerated",values:H,dflt:H.indexOf(A.matches)!==-1?A.matches:void 0}},"matches"));var te=T&&!P?d.anchor:void 0;if(W&&!$&&(h.scaleanchor||te)&&(G=p.coerce(h,d,{scaleanchor:{valType:"enumerated",values:H}},"scaleanchor",te)),$){d._matchGroup=i(w,I,$,1);var N=c[b($)],B=m(c,d)/m(c,N);P!==($.charAt(0)==="x")&&(B=(P?"x":"y")+B),i(_,I,$,B)}else h.matches&&x.indexOf(h.matches)!==-1&&p.warn("ignored "+d._name+'.matches: "'+h.matches+'" to avoid an infinite loop');if(G){var U=S("scaleratio");U||(U=d.scaleratio=1),i(_,I,G,U)}else h.scaleanchor&&x.indexOf(h.scaleanchor)!==-1&&p.warn("ignored "+d._name+'.scaleanchor: "'+h.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function m(h,d){var s=d.domain;return s||(s=h[b(d.overlaying)].domain),s[1]-s[0]}function o(h,d){for(var s=0;s<h.length;s++)if(h[s][d])return h[s];return null}function i(h,d,s,x){var c,T,_,w,k,L=o(h,d);L===null?((L={})[d]=1,k=h.length,h.push(L)):k=h.indexOf(L);var A=Object.keys(L);for(c=0;c<h.length;c++)if(_=h[c],c!==k&&_[s]){var I=_[s];for(T=0;T<A.length;T++)_[w=A[T]]=u(I,u(x,L[w]));return void h.splice(k,1)}if(x!==1)for(T=0;T<A.length;T++){var P=A[T];L[P]=u(x,L[P])}L[s]=1}function u(h,d){var s,x,c="",T="";typeof h=="string"&&(s=(c=h.match(/^[xy]*/)[0]).length,h=+h.substr(s)),typeof d=="string"&&(x=(T=d.match(/^[xy]*/)[0]).length,d=+d.substr(x));var _=h*d;return s||x?s&&x&&c.charAt(0)!==T.charAt(0)?s===x?_:(s>x?c.substr(x):T.substr(s))+_:c+T+h*d:_}function f(h,d){for(var s=d._size,x=s.h/s.w,c={},T=Object.keys(h),_=0;_<T.length;_++){var w=T[_],k=h[w];if(typeof k=="string"){var L=k.match(/^[xy]*/)[0],A=L.length;k=+k.substr(A);for(var I=L.charAt(0)==="y"?x:1/x,P=0;P<A;P++)k*=I}c[w]=k}return c}function l(h,d){var s=h._inputDomain,x=a[h.constraintoward],c=s[0]+(s[1]-s[0])*x;h.domain=h._input.domain=[c+(s[0]-c)/d,c+(s[1]-c)/d],h.setScale()}Z.handleDefaults=function(h,d,s){var x,c,T,_,w,k,L,A,I=s.axIds,P=s.axHasImage,S=d._axisConstraintGroups=[],E=d._axisMatchGroups=[];for(x=0;x<I.length;x++)r(w=h[_=b(I[x])],k=d[_],{axIds:I,layoutOut:d,hasImage:P[_]});function D(N,B){for(x=0;x<N.length;x++)for(T in c=N[x])d[b(T)][B]=c}for(D(E,"_matchGroup"),x=0;x<S.length;x++)for(T in c=S[x])if((k=d[b(T)]).fixedrange){for(var R in c){var H=b(R);(h[H]||{}).fixedrange===!1&&p.warn("fixedrange was specified as false for axis "+H+" but was overridden because another axis in its constraint group has fixedrange true"),d[H].fixedrange=!0}break}for(x=0;x<S.length;){for(T in c=S[x]){(k=d[b(T)])._matchGroup&&Object.keys(k._matchGroup).length===Object.keys(c).length&&(S.splice(x,1),x--);break}x++}D(S,"_constraintGroup");var V=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],X=!1,$=!1;function G(){A=k[L],L==="rangebreaks"&&($=k._hasDayOfWeekBreaks)}for(x=0;x<E.length;x++){c=E[x];for(var W=0;W<V.length;W++){var te;for(T in L=V[W],A=null,c)if(w=h[_=b(T)],k=d[_],L in k){if(!k.matches&&(te=k,L in w)){G();break}A===null&&L in w&&G()}if(L==="range"&&A&&(X=!0),L==="autorange"&&A===null&&X&&(A=!1),A===null&&L in te&&(A=te[L]),A!==null)for(T in c)(k=d[b(T)])[L]=L==="range"?A.slice():A,L==="rangebreaks"&&(k._hasDayOfWeekBreaks=$,n(k,d))}}},Z.enforce=function(h){var d,s,x,c,T,_,w,k,L=h._fullLayout,A=L._axisConstraintGroups||[];for(d=0;d<A.length;d++){x=f(A[d],L);var I=Object.keys(x),P=1/0,S=0,E=1/0,D={},R={},H=!1;for(s=0;s<I.length;s++)R[c=I[s]]=T=L[b(c)],T._inputDomain?T.domain=T._inputDomain.slice():T._inputDomain=T.domain.slice(),T._inputRange||(T._inputRange=T.range.slice()),T.setScale(),D[c]=_=Math.abs(T._m)/x[c],P=Math.min(P,_),T.constrain!=="domain"&&T._constraintShrinkable||(E=Math.min(E,_)),delete T._constraintShrinkable,S=Math.max(S,_),T.constrain==="domain"&&(H=!0);if(!(P>t*S)||H){for(s=0;s<I.length;s++)if(_=D[c=I[s]],w=(T=R[c]).constrain,_!==E||w==="domain")if(k=_/E,w==="range")e(T,k);else{var V=T._inputDomain,X=(T.domain[1]-T.domain[0])/(V[1]-V[0]),$=(T.r2l(T.range[1])-T.r2l(T.range[0]))/(T.r2l(T._inputRange[1])-T.r2l(T._inputRange[0]));if((k/=X)*$<1){T.domain=T._input.domain=V.slice(),e(T,k);continue}if($<1&&(T.range=T._input.range=T._inputRange.slice(),k*=$),T.autorange){var G=T.r2l(T.range[0]),W=T.r2l(T.range[1]),te=(G+W)/2,N=te,B=te,U=Math.abs(W-te),ee=te-U*k*1.0001,j=te+U*k*1.0001,Q=g.makePadFn(L,T,0),K=g.makePadFn(L,T,1);l(T,k);var re,ne,le=Math.abs(T._m),oe=g.concatExtremes(h,T),de=oe.min,se=oe.max;for(ne=0;ne<de.length;ne++)(re=de[ne].val-Q(de[ne])/le)>ee&&re<N&&(N=re);for(ne=0;ne<se.length;ne++)(re=se[ne].val+K(se[ne])/le)<j&&re>B&&(B=re);k/=(B-N)/(2*U),N=T.l2r(N),B=T.l2r(B),T.range=T._input.range=G<W?[N,B]:[B,N]}l(T,k)}}}},Z.getAxisGroup=function(h,d){for(var s=h._axisMatchGroups,x=0;x<s.length;x++)if(s[x][d])return"g"+x;return d},Z.clean=function(h,d){if(d._inputDomain){for(var s=!1,x=d._id,c=h._fullLayout._axisConstraintGroups,T=0;T<c.length;T++)if(c[T][x]){s=!0;break}s&&d.constrain==="domain"||(d._input.domain=d.domain=d._inputDomain,delete d._inputDomain)}}},{"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"./autorange":565,"./axis_ids":570,"./layout_attributes":579,"./scale_zoom":584,"./set_convert":585}],575:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=g.numberFormat,y=v("tinycolor2"),e=v("has-passive-events"),n=v("../../registry"),t=g.strTranslate,a=v("../../lib/svg_text_utils"),r=v("../../components/color"),m=v("../../components/drawing"),o=v("../../components/fx"),i=v("./axes"),u=v("../../lib/setcursor"),f=v("../../components/dragelement"),l=v("../../components/dragelement/helpers"),h=l.selectingOrDrawing,d=l.freeMode,s=v("../../constants/alignment").FROM_TL,x=v("../../lib/clear_gl_canvases"),c=v("../../plot_api/subroutines").redrawReglTraces,T=v("../plots"),_=v("./axis_ids").getFromId,w=v("../../components/selections").prepSelect,k=v("../../components/selections").clearOutline,L=v("../../components/selections").selectOnClick,A=v("./scale_zoom"),I=v("./constants"),P=I.MINDRAG,S=I.MINZOOM,E=!0;function D(re,ne,le,oe){var de=g.ensureSingle(re.draglayer,ne,le,function(se){se.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",re.id)});return de.call(u,oe),de.node()}function R(re,ne,le,oe,de,se,me){var Te=D(re,"rect",ne,le);return p.select(Te).call(m.setRect,oe,de,se,me),Te}function H(re,ne){for(var le=0;le<re.length;le++)if(!re[le].fixedrange)return ne;return""}function V(re,ne,le,oe,de){for(var se=0;se<re.length;se++){var me=re[se];if(!me.fixedrange)if(me.rangebreaks){var Te=me._id.charAt(0)==="y",_e=Te?1-ne:ne,be=Te?1-le:le;oe[me._name+".range[0]"]=me.l2r(me.p2l(_e*me._length)),oe[me._name+".range[1]"]=me.l2r(me.p2l(be*me._length))}else{var Ce=me._rl[0],fe=me._rl[1]-Ce;oe[me._name+".range[0]"]=me.l2r(Ce+fe*ne),oe[me._name+".range[1]"]=me.l2r(Ce+fe*le)}}if(de&&de.length){var ve=(ne+(1-le))/2;V(de,ve,1-ve,oe,[])}}function X(re,ne){for(var le=0;le<re.length;le++){var oe=re[le];if(!oe.fixedrange)if(oe.rangebreaks){var de=oe._length,se=(oe.p2l(0+ne)-oe.p2l(0)+(oe.p2l(de+ne)-oe.p2l(de)))/2;oe.range=[oe.l2r(oe._rl[0]-se),oe.l2r(oe._rl[1]-se)]}else oe.range=[oe.l2r(oe._rl[0]-ne/oe._m),oe.l2r(oe._rl[1]-ne/oe._m)]}}function $(re){return 1-(re>=0?Math.min(re,.9):1/(1/Math.max(re,-.3)+3.222))}function G(re,ne,le,oe,de){return re.append("path").attr("class","zoombox").style({fill:ne>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",t(le,oe)).attr("d",de+"Z")}function W(re,ne,le){return re.append("path").attr("class","zoombox-corners").style({fill:r.background,stroke:r.defaultLine,"stroke-width":1,opacity:0}).attr("transform",t(ne,le)).attr("d","M0,0Z")}function te(re,ne,le,oe,de,se){re.attr("d",oe+"M"+le.l+","+le.t+"v"+le.h+"h"+le.w+"v-"+le.h+"h-"+le.w+"Z"),N(re,ne,de,se)}function N(re,ne,le,oe){le||(re.transition().style("fill",oe>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ne.transition().style("opacity",1).duration(200))}function B(re){p.select(re).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function U(re){E&&re.data&&re._context.showTips&&(g.notifier(g._(re,"Double-click to zoom back out"),"long"),E=!1)}function ee(re){var ne=Math.floor(Math.min(re.b-re.t,re.r-re.l,S)/2);return"M"+(re.l-3.5)+","+(re.t-.5+ne)+"h3v"+-ne+"h"+ne+"v-3h-"+(ne+3)+"ZM"+(re.r+3.5)+","+(re.t-.5+ne)+"h-3v"+-ne+"h"+-ne+"v-3h"+(ne+3)+"ZM"+(re.r+3.5)+","+(re.b+.5-ne)+"h-3v"+ne+"h"+-ne+"v3h"+(ne+3)+"ZM"+(re.l-3.5)+","+(re.b+.5-ne)+"h3v"+ne+"h"+ne+"v3h-"+(ne+3)+"Z"}function j(re,ne,le,oe,de){for(var se,me,Te,_e,be=!1,Ce={},fe={},ve=(de||{}).xaHash,Me=(de||{}).yaHash,ke=0;ke<ne.length;ke++){var Le=ne[ke];for(se in le)if(Le[se]){for(Te in Le)de&&(ve[Te]||Me[Te])||(Te.charAt(0)==="x"?le:oe)[Te]||(Ce[Te]=se);for(me in oe)de&&(ve[me]||Me[me])||!Le[me]||(be=!0)}for(me in oe)if(Le[me])for(_e in Le)de&&(ve[_e]||Me[_e])||(_e.charAt(0)==="x"?le:oe)[_e]||(fe[_e]=me)}be&&(g.extendFlat(Ce,fe),fe={});var ze={},Re=[];for(Te in Ce){var Oe=_(re,Te);Re.push(Oe),ze[Oe._id]=Oe}var Ze={},Pe=[];for(_e in fe){var Ie=_(re,_e);Pe.push(Ie),Ze[Ie._id]=Ie}return{xaHash:ze,yaHash:Ze,xaxes:Re,yaxes:Pe,xLinks:Ce,yLinks:fe,isSubplotConstrained:be}}function Q(re,ne){if(e){var le=re.onwheel!==void 0?"wheel":"mousewheel";re._onwheel&&re.removeEventListener(le,re._onwheel),re._onwheel=ne,re.addEventListener(le,ne,{passive:!1})}else re.onwheel!==void 0?re.onwheel=ne:re.onmousewheel!==void 0?re.onmousewheel=ne:re.isAddedWheelEvent||(re.isAddedWheelEvent=!0,re.addEventListener("wheel",ne,{passive:!1}))}function K(re){var ne=[];for(var le in re)ne.push(re[le]);return ne}J.exports={makeDragBox:function(re,ne,le,oe,de,se,me,Te){var _e,be,Ce,fe,ve,Me,ke,Le,ze,Re,Oe,Ze,Pe,Ie,Be,Fe,$e,ot,pt,_t,yt,tt,Ke,vt=re._fullLayout._zoomlayer,Nt=me+Te==="nsew",qt=(me+Te).length===1;function er(){if(_e=ne.xaxis,be=ne.yaxis,ze=_e._length,Re=be._length,ke=_e._offset,Le=be._offset,(Ce={})[_e._id]=_e,(fe={})[be._id]=be,me&&Te)for(var Zt=ne.overlays,Qt=0;Qt<Zt.length;Qt++){var $t=Zt[Qt].xaxis;Ce[$t._id]=$t;var hr=Zt[Qt].yaxis;fe[hr._id]=hr}ve=K(Ce),Me=K(fe),Pe=H(ve,Te),Ie=H(Me,me),Be=!Ie&&!Pe,Ze=j(re,re._fullLayout._axisMatchGroups,Ce,fe);var vr=(Oe=j(re,re._fullLayout._axisConstraintGroups,Ce,fe,Ze)).isSubplotConstrained||Ze.isSubplotConstrained;Fe=Te||vr,$e=me||vr;var Mr=re._fullLayout;ot=Mr._has("scattergl"),pt=Mr._has("splom"),_t=Mr._has("svg")}er();var Jt=function(Zt,Qt,$t){return Zt?Zt==="nsew"?$t?"":Qt==="pan"?"move":"crosshair":Zt.toLowerCase()+"-resize":"pointer"}(Ie+Pe,re._fullLayout.dragmode,Nt),ir=R(ne,me+Te+"drag",Jt,le,oe,de,se);if(Be&&!Nt)return ir.onmousedown=null,ir.style.pointerEvents="none",ir;var Ht,Ue,We,he,xe,De,qe,Xe,He,st,it={element:ir,gd:re,plotinfo:ne};function Tt(){it.plotinfo.selection=!1,k(re)}function Pt(Zt,Qt){var $t=it.gd;if($t._fullLayout._activeShapeIndex>=0)$t._fullLayout._deactivateShape($t);else{var hr=$t._fullLayout.clickmode;if(B($t),Zt!==2||qt||Rt(),Nt)hr.indexOf("select")>-1&&L(Qt,$t,ve,Me,ne.id,it),hr.indexOf("event")>-1&&o.click($t,Qt,ne.id);else if(Zt===1&&qt){var vr=me?be:_e,Mr=me==="s"||Te==="w"?0:1,Nr=vr._name+".range["+Mr+"]",Ur=function(en,In){var vn,gn=en.range[In],Sn=Math.abs(gn-en.range[1-In]);return en.type==="date"?gn:en.type==="log"?(vn=Math.ceil(Math.max(0,-Math.log(Sn)/Math.LN10))+3,b("."+vn+"g")(Math.pow(10,gn))):(vn=Math.floor(Math.log(Math.abs(gn))/Math.LN10)-Math.floor(Math.log(Sn)/Math.LN10)+4,b("."+String(vn)+"g")(gn))}(vr,Mr),Jr="left",mn="middle";if(vr.fixedrange)return;me?(mn=me==="n"?"top":"bottom",vr.side==="right"&&(Jr="right")):Te==="e"&&(Jr="right"),$t._context.showAxisRangeEntryBoxes&&p.select(ir).call(a.makeEditable,{gd:$t,immediate:!0,background:$t._fullLayout.paper_bgcolor,text:String(Ur),fill:vr.tickfont?vr.tickfont.color:"#444",horizontalAlign:Jr,verticalAlign:mn}).on("edit",function(en){var In=vr.d2r(en);In!==void 0&&n.call("_guiRelayout",$t,Nr,In)})}}}function rt(Zt,Qt){if(re._transitioningWithDuration)return!1;var $t=Math.max(0,Math.min(ze,tt*Zt+Ht)),hr=Math.max(0,Math.min(Re,Ke*Qt+Ue)),vr=Math.abs($t-Ht),Mr=Math.abs(hr-Ue);function Nr(){qe="",We.r=We.l,We.t=We.b,He.attr("d","M0,0Z")}if(We.l=Math.min(Ht,$t),We.r=Math.max(Ht,$t),We.t=Math.min(Ue,hr),We.b=Math.max(Ue,hr),Oe.isSubplotConstrained)vr>S||Mr>S?(qe="xy",vr/ze>Mr/Re?(Mr=vr*Re/ze,Ue>hr?We.t=Ue-Mr:We.b=Ue+Mr):(vr=Mr*ze/Re,Ht>$t?We.l=Ht-vr:We.r=Ht+vr),He.attr("d",ee(We))):Nr();else if(Ze.isSubplotConstrained)if(vr>S||Mr>S){qe="xy";var Ur=Math.min(We.l/ze,(Re-We.b)/Re),Jr=Math.max(We.r/ze,(Re-We.t)/Re);We.l=Ur*ze,We.r=Jr*ze,We.b=(1-Ur)*Re,We.t=(1-Jr)*Re,He.attr("d",ee(We))}else Nr();else!Ie||Mr<Math.min(Math.max(.6*vr,P),S)?vr<P||!Pe?Nr():(We.t=0,We.b=Re,qe="x",He.attr("d",function(mn,en){return"M"+(mn.l-.5)+","+(en-S-.5)+"h-3v"+(2*S+1)+"h3ZM"+(mn.r+.5)+","+(en-S-.5)+"h3v"+(2*S+1)+"h-3Z"}(We,Ue))):!Pe||vr<Math.min(.6*Mr,S)?(We.l=0,We.r=ze,qe="y",He.attr("d",function(mn,en){return"M"+(en-S-.5)+","+(mn.t-.5)+"v-3h"+(2*S+1)+"v3ZM"+(en-S-.5)+","+(mn.b+.5)+"v3h"+(2*S+1)+"v-3Z"}(We,Ht))):(qe="xy",He.attr("d",ee(We)));We.w=We.r-We.l,We.h=We.b-We.t,qe&&(st=!0),re._dragged=st,te(Xe,He,We,xe,De,he),ut(),re.emit("plotly_relayouting",yt),De=!0}function ut(){yt={},qe!=="xy"&&qe!=="x"||(V(ve,We.l/ze,We.r/ze,yt,Oe.xaxes),ft("x",yt)),qe!=="xy"&&qe!=="y"||(V(Me,(Re-We.b)/Re,(Re-We.t)/Re,yt,Oe.yaxes),ft("y",yt))}function Ft(){ut(),B(re),Gt(),U(re)}it.prepFn=function(Zt,Qt,$t){var hr=it.dragmode,vr=re._fullLayout.dragmode;vr!==hr&&(it.dragmode=vr),er(),tt=re._fullLayout._invScaleX,Ke=re._fullLayout._invScaleY,Be||(Nt?Zt.shiftKey?vr==="pan"?vr="zoom":h(vr)||(vr="pan"):Zt.ctrlKey&&(vr="pan"):vr="pan"),d(vr)?it.minDrag=1:it.minDrag=void 0,h(vr)?(it.xaxes=ve,it.yaxes=Me,w(Zt,Qt,$t,it,vr)):(it.clickFn=Pt,h(hr)&&Tt(),Be||(vr==="zoom"?(it.moveFn=rt,it.doneFn=Ft,it.minDrag=1,function(Mr,Nr,Ur){var Jr=ir.getBoundingClientRect();Ht=Nr-Jr.left,Ue=Ur-Jr.top,re._fullLayout._calcInverseTransform(re);var mn=g.apply3DTransform(re._fullLayout._invTransform)(Ht,Ue);Ht=mn[0],Ue=mn[1],We={l:Ht,r:Ht,w:0,t:Ue,b:Ue,h:0},he=re._hmpixcount?re._hmlumcount/re._hmpixcount:y(re._fullLayout.plot_bgcolor).getLuminance(),De=!1,qe="xy",st=!1,Xe=G(vt,he,ke,Le,xe="M0,0H"+ze+"V"+Re+"H0V0"),He=W(vt,ke,Le)}(0,Qt,$t)):vr==="pan"&&(it.moveFn=nt,it.doneFn=Gt))),re._fullLayout._redrag=function(){var Mr=re._dragdata;if(Mr&&Mr.element===ir){var Nr=re._fullLayout.dragmode;h(Nr)||(er(),jt([0,0,ze,Re]),it.moveFn(Mr.dx,Mr.dy))}}},f.init(it);var wt=[0,0,ze,Re],Lt=null,Ae=I.REDRAWDELAY,Ye=ne.mainplot?re._fullLayout._plots[ne.mainplot]:ne;function nt(Zt,Qt){if(Zt*=tt,Qt*=Ke,!re._transitioningWithDuration){if(re._fullLayout._replotting=!0,Pe==="ew"||Ie==="ns"){var $t=Pe?-Zt:0,hr=Ie?-Qt:0;if(Ze.isSubplotConstrained){if(Pe&&Ie){var vr=(Zt/ze-Qt/Re)/2;$t=-(Zt=vr*ze),hr=-(Qt=-vr*Re)}Ie?$t=-hr*ze/Re:hr=-$t*Re/ze}return Pe&&(X(ve,Zt),ft("x")),Ie&&(X(Me,Qt),ft("y")),jt([$t,hr,ze,Re]),Mt(),void re.emit("plotly_relayouting",yt)}var Mr,Nr,Ur=Pe==="w"==(Ie==="n")?1:-1;if(Pe&&Ie&&(Oe.isSubplotConstrained||Ze.isSubplotConstrained)){var Jr=(Zt/ze+Ur*Qt/Re)/2;Zt=Jr*ze,Qt=Ur*Jr*Re}if(Pe==="w"?Zt=vn(ve,0,Zt):Pe==="e"?Zt=vn(ve,1,-Zt):Pe||(Zt=0),Ie==="n"?Qt=vn(Me,1,Qt):Ie==="s"?Qt=vn(Me,0,-Qt):Ie||(Qt=0),Mr=Pe==="w"?Zt:0,Nr=Ie==="n"?Qt:0,Oe.isSubplotConstrained&&!Ze.isSubplotConstrained||Ze.isSubplotConstrained&&Pe&&Ie&&Ur>0){var mn;if(Ze.isSubplotConstrained||!Pe&&Ie.length===1){for(mn=0;mn<ve.length;mn++)ve[mn].range=ve[mn]._r.slice(),A(ve[mn],1-Qt/Re);Mr=(Zt=Qt*ze/Re)/2}if(Ze.isSubplotConstrained||!Ie&&Pe.length===1){for(mn=0;mn<Me.length;mn++)Me[mn].range=Me[mn]._r.slice(),A(Me[mn],1-Zt/ze);Nr=(Qt=Zt*Re/ze)/2}}Ze.isSubplotConstrained&&Ie||ft("x"),Ze.isSubplotConstrained&&Pe||ft("y");var en=ze-Zt,In=Re-Qt;!Ze.isSubplotConstrained||Pe&&Ie||(Pe?(Nr=Mr?0:Zt*Re/ze,In=en*Re/ze):(Mr=Nr?0:Qt*ze/Re,en=In*ze/Re)),jt([Mr,Nr,en,In]),Mt(),re.emit("plotly_relayouting",yt)}function vn(gn,Sn,Xn){for(var Br,pn,on=1-Sn,Yr=0;Yr<gn.length;Yr++){var Nn=gn[Yr];if(!Nn.fixedrange){Br=Nn,pn=Nn._rl[on]+(Nn._rl[Sn]-Nn._rl[on])/$(Xn/Nn._length);var Hn=Nn.l2r(pn);Hn!==!1&&Hn!==void 0&&(Nn.range[Sn]=Hn)}}return Br._length*(Br._rl[Sn]-pn)/(Br._rl[Sn]-Br._rl[on])}}function ft(Zt,Qt){for(var $t=Ze.isSubplotConstrained?{x:Me,y:ve}[Zt]:Ze[Zt+"axes"],hr=Ze.isSubplotConstrained?{x:ve,y:Me}[Zt]:[],vr=0;vr<$t.length;vr++){var Mr=$t[vr],Nr=Mr._id,Ur=Ze.xLinks[Nr]||Ze.yLinks[Nr],Jr=hr[0]||Ce[Ur]||fe[Ur];Jr&&(Qt?(Qt[Mr._name+".range[0]"]=Qt[Jr._name+".range[0]"],Qt[Mr._name+".range[1]"]=Qt[Jr._name+".range[1]"]):Mr.range=Jr.range.slice())}}function Mt(){var Zt,Qt=[];function $t(Mr){for(Zt=0;Zt<Mr.length;Zt++)Mr[Zt].fixedrange||Qt.push(Mr[Zt]._id)}for(Fe&&($t(ve),$t(Oe.xaxes),$t(Ze.xaxes)),$e&&($t(Me),$t(Oe.yaxes),$t(Ze.yaxes)),yt={},Zt=0;Zt<Qt.length;Zt++){var hr=Qt[Zt],vr=_(re,hr);i.drawOne(re,vr,{skipTitle:!0}),yt[vr._name+".range[0]"]=vr.range[0],yt[vr._name+".range[1]"]=vr.range[1]}i.redrawComponents(re,Qt)}function Rt(){if(!re._transitioningWithDuration){var Zt=re._context.doubleClick,Qt=[];Pe&&(Qt=Qt.concat(ve)),Ie&&(Qt=Qt.concat(Me)),Ze.xaxes&&(Qt=Qt.concat(Ze.xaxes)),Ze.yaxes&&(Qt=Qt.concat(Ze.yaxes));var $t,hr,vr,Mr={};if(Zt==="reset+autosize"){for(Zt="autosize",hr=0;hr<Qt.length;hr++)if(($t=Qt[hr])._rangeInitial&&($t.range[0]!==$t._rangeInitial[0]||$t.range[1]!==$t._rangeInitial[1])||!$t._rangeInitial&&!$t.autorange){Zt="reset";break}}if(Zt==="autosize")for(hr=0;hr<Qt.length;hr++)($t=Qt[hr]).fixedrange||(Mr[$t._name+".autorange"]=!0);else if(Zt==="reset")for((Pe||Oe.isSubplotConstrained)&&(Qt=Qt.concat(Oe.xaxes)),Ie&&!Oe.isSubplotConstrained&&(Qt=Qt.concat(Oe.yaxes)),Oe.isSubplotConstrained&&(Pe?Ie||(Qt=Qt.concat(Me)):Qt=Qt.concat(ve)),hr=0;hr<Qt.length;hr++)($t=Qt[hr]).fixedrange||($t._rangeInitial?(vr=$t._rangeInitial,Mr[$t._name+".range[0]"]=vr[0],Mr[$t._name+".range[1]"]=vr[1]):Mr[$t._name+".autorange"]=!0);re.emit("plotly_doubleclick",null),n.call("_guiRelayout",re,Mr)}}function Gt(){jt([0,0,ze,Re]),g.syncOrAsync([T.previousPromises,function(){re._fullLayout._replotting=!1,n.call("_guiRelayout",re,yt)}],re)}function jt(Zt){var Qt,$t,hr,vr,Mr=re._fullLayout,Nr=Mr._plots,Ur=Mr._subplots.cartesian;if(pt&&n.subplotsRegistry.splom.drag(re),ot){for(Qt=0;Qt<Ur.length;Qt++)if(hr=($t=Nr[Ur[Qt]]).xaxis,vr=$t.yaxis,$t._scene){var Jr=g.simpleMap(hr.range,hr.r2l),mn=g.simpleMap(vr.range,vr.r2l);$t._scene.update({range:[Jr[0],mn[0],Jr[1],mn[1]]})}}if((pt||ot)&&(x(re),c(re)),_t){var en=Zt[2]/_e._length,In=Zt[3]/be._length;for(Qt=0;Qt<Ur.length;Qt++){hr=($t=Nr[Ur[Qt]]).xaxis,vr=$t.yaxis;var vn,gn,Sn,Xn,Br=(Fe||Ze.isSubplotConstrained)&&!hr.fixedrange&&Ce[hr._id],pn=($e||Ze.isSubplotConstrained)&&!vr.fixedrange&&fe[vr._id];if(Br?(vn=en,Sn=Te||Ze.isSubplotConstrained?Zt[0]:fr(hr,vn)):Ze.xaHash[hr._id]?(vn=en,Sn=Zt[0]*hr._length/_e._length):Ze.yaHash[hr._id]?(vn=In,Sn=Ie==="ns"?-Zt[1]*hr._length/be._length:fr(hr,vn,{n:"top",s:"bottom"}[Ie])):Sn=Ar(hr,vn=pr(hr,en,In)),pn?(gn=In,Xn=me||Ze.isSubplotConstrained?Zt[1]:fr(vr,gn)):Ze.yaHash[vr._id]?(gn=In,Xn=Zt[1]*vr._length/be._length):Ze.xaHash[vr._id]?(gn=en,Xn=Pe==="ew"?-Zt[0]*vr._length/_e._length:fr(vr,gn,{e:"right",w:"left"}[Pe])):Xn=Ar(vr,gn=pr(vr,en,In)),vn||gn){vn||(vn=1),gn||(gn=1);var on=hr._offset-Sn/vn,Yr=vr._offset-Xn/gn;$t.clipRect.call(m.setTranslate,Sn,Xn).call(m.setScale,vn,gn),$t.plot.call(m.setTranslate,on,Yr).call(m.setScale,1/vn,1/gn),vn===$t.xScaleFactor&&gn===$t.yScaleFactor||(m.setPointGroupScale($t.zoomScalePts,vn,gn),m.setTextPointsScale($t.zoomScaleTxt,vn,gn)),m.hideOutsideRangePoints($t.clipOnAxisFalseTraces,$t),$t.xScaleFactor=vn,$t.yScaleFactor=gn}}}}function pr(Zt,Qt,$t){return Zt.fixedrange?0:Fe&&Oe.xaHash[Zt._id]?Qt:$e&&(Oe.isSubplotConstrained?Oe.xaHash:Oe.yaHash)[Zt._id]?$t:0}function Ar(Zt,Qt){return Qt?(Zt.range=Zt._r.slice(),A(Zt,Qt),fr(Zt,Qt)):0}function fr(Zt,Qt,$t){return Zt._length*(1-Qt)*s[$t||Zt.constraintoward||"middle"]}return me.length*Te.length!=1&&Q(ir,function(Zt){if(re._context._scrollZoom.cartesian||re._fullLayout._enablescrollzoom){if(Tt(),re._transitioningWithDuration)return Zt.preventDefault(),void Zt.stopPropagation();er(),clearTimeout(Lt);var Qt=-Zt.deltaY;if(isFinite(Qt)||(Qt=Zt.wheelDelta/10),isFinite(Qt)){var $t,hr=Math.exp(-Math.min(Math.max(Qt,-20),20)/200),vr=Ye.draglayer.select(".nsewdrag").node().getBoundingClientRect(),Mr=(Zt.clientX-vr.left)/vr.width,Nr=(vr.bottom-Zt.clientY)/vr.height;if(Fe){for(Te||(Mr=.5),$t=0;$t<ve.length;$t++)Ur(ve[$t],Mr,hr);ft("x"),wt[2]*=hr,wt[0]+=wt[2]*Mr*(1/hr-1)}if($e){for(me||(Nr=.5),$t=0;$t<Me.length;$t++)Ur(Me[$t],Nr,hr);ft("y"),wt[3]*=hr,wt[1]+=wt[3]*(1-Nr)*(1/hr-1)}jt(wt),Mt(),re.emit("plotly_relayouting",yt),Lt=setTimeout(function(){re._fullLayout&&(wt=[0,0,ze,Re],Gt())},Ae),Zt.preventDefault()}else g.log("Did not find wheel motion attributes: ",Zt)}function Ur(Jr,mn,en){if(!Jr.fixedrange){var In=g.simpleMap(Jr.range,Jr.r2l),vn=In[0]+(In[1]-In[0])*mn;Jr.range=In.map(function(gn){return Jr.l2r(vn+(gn-vn)*en)})}}}),ir},makeDragger:D,makeRectDragger:R,makeZoombox:G,makeCorners:W,updateZoombox:te,xyCorners:ee,transitionZoombox:N,removeZoombox:B,showDoubleClickNotifier:U,attachWheelEventHandler:Q}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/subroutines":556,"../../registry":647,"../plots":628,"./axes":566,"./axis_ids":570,"./constants":573,"./scale_zoom":584,"@plotly/d3":58,"has-passive-events":229,tinycolor2:313}],576:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/fx"),b=v("../../components/dragelement"),y=v("../../lib/setcursor"),e=v("./dragbox").makeDragBox,n=v("./constants").DRAGGERSIZE;Z.initInteractions=function(t){var a=t._fullLayout;if(t._context.staticPlot)p.select(t).selectAll(".drag").remove();else if(a._has("cartesian")||a._has("splom")){Object.keys(a._plots||{}).sort(function(m,o){if((a._plots[m].mainplot&&!0)===(a._plots[o].mainplot&&!0)){var i=m.split("y"),u=o.split("y");return i[0]===u[0]?Number(i[1]||1)-Number(u[1]||1):Number(i[0]||1)-Number(u[0]||1)}return a._plots[m].mainplot?1:-1}).forEach(function(m){var o=a._plots[m],i=o.xaxis,u=o.yaxis;if(!o.mainplot){var f=e(t,o,i._offset,u._offset,i._length,u._length,"ns","ew");f.onmousemove=function(d){t._fullLayout._rehover=function(){t._fullLayout._hoversubplot===m&&t._fullLayout._plots[m]&&g.hover(t,d,m)},g.hover(t,d,m),t._fullLayout._lasthover=f,t._fullLayout._hoversubplot=m},f.onmouseout=function(d){t._dragging||(t._fullLayout._hoversubplot=null,b.unhover(t,d))},t._context.showAxisDragHandles&&(e(t,o,i._offset-n,u._offset-n,n,n,"n","w"),e(t,o,i._offset+i._length,u._offset-n,n,n,"n","e"),e(t,o,i._offset-n,u._offset+u._length,n,n,"s","w"),e(t,o,i._offset+i._length,u._offset+u._length,n,n,"s","e"))}if(t._context.showAxisDragHandles){if(m===i._mainSubplot){var l=i._mainLinePosition;i.side==="top"&&(l-=n),e(t,o,i._offset+.1*i._length,l,.8*i._length,n,"","ew"),e(t,o,i._offset,l,.1*i._length,n,"","w"),e(t,o,i._offset+.9*i._length,l,.1*i._length,n,"","e")}if(m===u._mainSubplot){var h=u._mainLinePosition;u.side!=="right"&&(h-=n),e(t,o,h,u._offset+.1*u._length,n,.8*u._length,"ns",""),e(t,o,h,u._offset+.9*u._length,n,.1*u._length,"s",""),e(t,o,h,u._offset,n,.1*u._length,"n","")}}});var r=a._hoverlayer.node();r.onmousemove=function(m){m.target=t._fullLayout._lasthover,g.hover(t,m,a._hoversubplot)},r.onclick=function(m){m.target=t._fullLayout._lasthover,g.click(t,m)},r.onmousedown=function(m){t._fullLayout._lasthover.onmousedown(m)},Z.updateFx(t)}},Z.updateFx=function(t){var a=t._fullLayout,r=a.dragmode==="pan"?"move":"crosshair";y(a._draggers,r)}},{"../../components/dragelement":386,"../../components/fx":407,"../../lib/setcursor":536,"./constants":573,"./dragbox":575,"@plotly/d3":58}],577:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib"),b=v("./axis_ids");J.exports=function(y){return function(e,n){var t=e[y];if(Array.isArray(t))for(var a=p.subplotsRegistry.cartesian,r=a.idRegex,m=n._subplots,o=m.xaxis,i=m.yaxis,u=m.cartesian,f=n._has("cartesian")||n._has("gl2d"),l=0;l<t.length;l++){var h=t[l];if(g.isPlainObject(h)){var d=b.cleanId(h.xref,"x",!1),s=b.cleanId(h.yref,"y",!1),x=r.x.test(d),c=r.y.test(s);if(x||c){f||g.pushUnique(n._basePlotModules,a);var T=!1;x&&o.indexOf(d)===-1&&(o.push(d),T=!0),c&&i.indexOf(s)===-1&&(i.push(s),T=!0),T&&x&&c&&u.push(d+s)}}}}}},{"../../lib":515,"../../registry":647,"./axis_ids":570}],578:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../registry"),b=v("../../lib"),y=v("../plots"),e=v("../../components/drawing"),n=v("../get_data").getModuleCalcData,t=v("./axis_ids"),a=v("./constants"),r=v("../../constants/xmlns_namespaces"),m=b.ensureSingle;function o(h,d,s){return b.ensureSingle(h,d,s,function(x){x.datum(s)})}function i(h,d,s,x,c){for(var T,_,w,k=a.traceLayerClasses,L=h._fullLayout,A=L._modules,I=[],P=[],S=0;S<A.length;S++){var E=(T=A[S]).name,D=g.modules[E].categories;if(D.svg){var R=T.layerName||E+"layer",H=T.plot;w=(_=n(s,H))[0],s=_[1],w.length&&I.push({i:k.indexOf(R),className:R,plotMethod:H,cdModule:w}),D.zoomScale&&P.push("."+R)}}I.sort(function($,G){return $.i-G.i});var V=d.plot.selectAll("g.mlayer").data(I,function($){return $.className});if(V.enter().append("g").attr("class",function($){return $.className}).classed("mlayer",!0).classed("rangeplot",d.isRangePlot),V.exit().remove(),V.order(),V.each(function($){var G=p.select(this),W=$.className;$.plotMethod(h,d,$.cdModule,G,x,c),a.clipOnAxisFalseQuery.indexOf("."+W)===-1&&e.setClipUrl(G,d.layerClipId,h)}),L._has("scattergl")&&(T=g.getModule("scattergl"),w=n(s,T)[0],T.plot(h,d,w)),!h._context.staticPlot&&(d._hasClipOnAxisFalse&&(d.clipOnAxisFalseTraces=d.plot.selectAll(a.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),P.length)){var X=d.plot.selectAll(P.join(",")).selectAll(".trace");d.zoomScalePts=X.selectAll("path.point"),d.zoomScaleTxt=X.selectAll(".textpoint")}}function u(h,d){var s=d.plotgroup,x=d.id,c=a.layerValue2layerClass[d.xaxis.layer],T=a.layerValue2layerClass[d.yaxis.layer],_=h._fullLayout._hasOnlyLargeSploms;if(d.mainplot){var w=d.mainplotinfo,k=w.plotgroup,L=x+"-x",A=x+"-y";d.minorGridlayer=w.minorGridlayer,d.gridlayer=w.gridlayer,d.zerolinelayer=w.zerolinelayer,m(w.overlinesBelow,"path",L),m(w.overlinesBelow,"path",A),m(w.overaxesBelow,"g",L),m(w.overaxesBelow,"g",A),d.plot=m(w.overplot,"g",x),m(w.overlinesAbove,"path",L),m(w.overlinesAbove,"path",A),m(w.overaxesAbove,"g",L),m(w.overaxesAbove,"g",A),d.xlines=k.select(".overlines-"+c).select("."+L),d.ylines=k.select(".overlines-"+T).select("."+A),d.xaxislayer=k.select(".overaxes-"+c).select("."+L),d.yaxislayer=k.select(".overaxes-"+T).select("."+A)}else if(_)d.xlines=m(s,"path","xlines-above"),d.ylines=m(s,"path","ylines-above"),d.xaxislayer=m(s,"g","xaxislayer-above"),d.yaxislayer=m(s,"g","yaxislayer-above");else{var I=m(s,"g","layer-subplot");d.shapelayer=m(I,"g","shapelayer"),d.imagelayer=m(I,"g","imagelayer"),d.minorGridlayer=m(s,"g","minor-gridlayer"),d.gridlayer=m(s,"g","gridlayer"),d.zerolinelayer=m(s,"g","zerolinelayer"),m(s,"path","xlines-below"),m(s,"path","ylines-below"),d.overlinesBelow=m(s,"g","overlines-below"),m(s,"g","xaxislayer-below"),m(s,"g","yaxislayer-below"),d.overaxesBelow=m(s,"g","overaxes-below"),d.plot=m(s,"g","plot"),d.overplot=m(s,"g","overplot"),d.xlines=m(s,"path","xlines-above"),d.ylines=m(s,"path","ylines-above"),d.overlinesAbove=m(s,"g","overlines-above"),m(s,"g","xaxislayer-above"),m(s,"g","yaxislayer-above"),d.overaxesAbove=m(s,"g","overaxes-above"),d.xlines=s.select(".xlines-"+c),d.ylines=s.select(".ylines-"+T),d.xaxislayer=s.select(".xaxislayer-"+c),d.yaxislayer=s.select(".yaxislayer-"+T)}_||(o(d.minorGridlayer,"g",d.xaxis._id),o(d.minorGridlayer,"g",d.yaxis._id),d.minorGridlayer.selectAll("g").map(function(P){return P[0]}).sort(t.idSort),o(d.gridlayer,"g",d.xaxis._id),o(d.gridlayer,"g",d.yaxis._id),d.gridlayer.selectAll("g").map(function(P){return P[0]}).sort(t.idSort)),d.xlines.style("fill","none").classed("crisp",!0),d.ylines.style("fill","none").classed("crisp",!0)}function f(h,d){if(h){var s={};for(var x in h.each(function(w){var k=w[0];p.select(this).remove(),l(k,d),s[k]=!0}),d._plots)for(var c=d._plots[x].overlays||[],T=0;T<c.length;T++){var _=c[T];s[_.id]&&_.plot.selectAll(".trace").remove()}}}function l(h,d){d._draggers.selectAll("g."+h).remove(),d._defs.select("#clip"+d._uid+h+"plot").remove()}Z.name="cartesian",Z.attr=["xaxis","yaxis"],Z.idRoot=["x","y"],Z.idRegex=a.idRegex,Z.attrRegex=a.attrRegex,Z.attributes=v("./attributes"),Z.layoutAttributes=v("./layout_attributes"),Z.supplyLayoutDefaults=v("./layout_defaults"),Z.transitionAxes=v("./transition_axes"),Z.finalizeSubplots=function(h,d){var s,x,c,T=d._subplots,_=T.xaxis,w=T.yaxis,k=T.cartesian,L=k.concat(T.gl2d||[]),A={},I={};for(s=0;s<L.length;s++){var P=L[s].split("y");A[P[0]]=1,I["y"+P[1]]=1}for(s=0;s<_.length;s++)A[x=_[s]]||(c=(h[t.id2name(x)]||{}).anchor,a.idRegex.y.test(c)||(c="y"),k.push(x+c),L.push(x+c),I[c]||(I[c]=1,b.pushUnique(w,c)));for(s=0;s<w.length;s++)I[c=w[s]]||(x=(h[t.id2name(c)]||{}).anchor,a.idRegex.x.test(x)||(x="x"),k.push(x+c),L.push(x+c),A[x]||(A[x]=1,b.pushUnique(_,x)));if(!L.length){for(var S in x="",c="",h)a.attrRegex.test(S)&&(S.charAt(0)==="x"?(!x||+S.substr(5)<+x.substr(5))&&(x=S):(!c||+S.substr(5)<+c.substr(5))&&(c=S));x=x?t.name2id(x):"x",c=c?t.name2id(c):"y",_.push(x),w.push(c),k.push(x+c)}},Z.plot=function(h,d,s,x){var c,T=h._fullLayout,_=T._subplots.cartesian,w=h.calcdata;if(!Array.isArray(d))for(d=[],c=0;c<w.length;c++)d.push(c);for(c=0;c<_.length;c++){for(var k,L=_[c],A=T._plots[L],I=[],P=0;P<w.length;P++){var S=w[P],E=S[0].trace;E.xaxis+E.yaxis===L&&((d.indexOf(E.index)!==-1||E.carpet)&&(k&&k[0].trace.xaxis+k[0].trace.yaxis===L&&["tonextx","tonexty","tonext"].indexOf(E.fill)!==-1&&I.indexOf(k)===-1&&I.push(k),I.push(S)),k=S)}i(h,A,I,s,x)}},Z.clean=function(h,d,s,x){var c,T,_,w=x._plots||{},k=d._plots||{},L=x._subplots||{};if(x._hasOnlyLargeSploms&&!d._hasOnlyLargeSploms)for(_ in w)(c=w[_]).plotgroup&&c.plotgroup.remove();var A=x._has&&x._has("gl"),I=d._has&&d._has("gl");if(A&&!I)for(_ in w)(c=w[_])._scene&&c._scene.destroy();if(L.xaxis&&L.yaxis){var P=t.listIds({_fullLayout:x});for(T=0;T<P.length;T++){var S=P[T];d[t.id2name(S)]||x._infolayer.selectAll(".g-"+S+"title").remove()}}var E=x._has&&x._has("cartesian"),D=d._has&&d._has("cartesian");if(E&&!D)f(x._cartesianlayer.selectAll(".subplot"),x),x._defs.selectAll(".axesclip").remove(),delete x._axisConstraintGroups,delete x._axisMatchGroups;else if(L.cartesian)for(T=0;T<L.cartesian.length;T++){var R=L.cartesian[T];if(!k[R]){var H="."+R+",."+R+"-x,."+R+"-y";x._cartesianlayer.selectAll(H).remove(),l(R,x)}}},Z.drawFramework=function(h){var d=h._fullLayout,s=function(c){var T,_,w,k,L,A,I=c._fullLayout,P=I._subplots.cartesian,S=P.length,E=[],D=[];for(T=0;T<S;T++){w=P[T],k=I._plots[w],L=k.xaxis,A=k.yaxis;var R=L._mainAxis,H=A._mainAxis,V=R._id+H._id,X=I._plots[V];k.overlays=[],V!==w&&X?(k.mainplot=V,k.mainplotinfo=X,D.push(w)):(k.mainplot=void 0,k.mainplotinfo=void 0,E.push(w))}for(T=0;T<D.length;T++)w=D[T],(k=I._plots[w]).mainplotinfo.overlays.push(k);var $=E.concat(D),G=new Array(S);for(T=0;T<S;T++){w=$[T],k=I._plots[w],L=k.xaxis,A=k.yaxis;var W=[w,L.layer,A.layer,L.overlaying||"",A.overlaying||""];for(_=0;_<k.overlays.length;_++)W.push(k.overlays[_].id);G[T]=W}return G}(h),x=d._cartesianlayer.selectAll(".subplot").data(s,String);x.enter().append("g").attr("class",function(c){return"subplot "+c[0]}),x.order(),x.exit().call(f,d),x.each(function(c){var T=c[0],_=d._plots[T];_.plotgroup=p.select(this),u(h,_),_.draglayer=m(d._draggers,"g",T)})},Z.rangePlot=function(h,d,s){u(h,d),i(h,d,s),y.style(h)},Z.toSVG=function(h){var d=h._fullLayout._glimages,s=p.select(h).selectAll(".svg-container");s.filter(function(x,c){return c===s.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var x=this.toDataURL("image/png");d.append("svg:image").attr({xmlns:r.svg,"xlink:href":x,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},Z.updateFx=v("./graph_interact").updateFx},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../registry":647,"../get_data":602,"../plots":628,"./attributes":564,"./axis_ids":570,"./constants":573,"./graph_interact":576,"./layout_attributes":579,"./layout_defaults":580,"./transition_axes":590,"@plotly/d3":58}],579:[function(v,J,Z){var p=v("../font_attributes"),g=v("../../components/color/attributes"),b=v("../../components/drawing/attributes").dash,y=v("../../lib/extend").extendFlat,e=v("../../plot_api/plot_template").templatedArray,n=v("../../plots/cartesian/axis_format_attributes").descriptionWithDates,t=v("../../constants/numerical").ONEDAY,a=v("./constants"),r=a.HOUR_PATTERN,m=a.WEEKDAY_PATTERN,o={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}};function i(k){return{valType:"integer",min:0,dflt:k?5:0,editType:"ticks"}}var u={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},f={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},l={valType:"data_array",editType:"ticks"},h={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function d(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=5),L}function s(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=1),L}var x={valType:"color",dflt:g.defaultLine,editType:"ticks"},c={valType:"color",dflt:g.lightLine,editType:"ticks"};function T(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=1),L}var _=y({},b,{editType:"ticks"}),w={valType:"boolean",editType:"ticks"};J.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:g.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:p({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[m,r,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:t},editType:"calc"}),tickmode:o,nticks:i(),tick0:u,dtick:f,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:l,ticktext:{valType:"data_array",editType:"ticks"},ticks:h,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:d(),tickwidth:s(),tickcolor:x,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:y({},b,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:p({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:n("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:n("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:g.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:w,gridcolor:c,gridwidth:T(),griddash:_,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:g.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:g.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},minor:{tickmode:o,nticks:i("minor"),tick0:u,dtick:f,tickvals:l,ticks:h,ticklen:d("minor"),tickwidth:s("minor"),tickcolor:x,gridcolor:c,gridwidth:T("minor"),griddash:_,showgrid:w,editType:"ticks"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:p({editType:"ticks"})}}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../constants/numerical":491,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../font_attributes":594,"./constants":573}],580:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/color"),b=v("../../components/fx/helpers").isUnifiedHover,y=v("../../components/fx/hovermode_defaults"),e=v("../../plot_api/plot_template"),n=v("../layout_attributes"),t=v("./layout_attributes"),a=v("./type_defaults"),r=v("./axis_defaults"),m=v("./constraints"),o=v("./position_defaults"),i=v("./axis_ids"),u=i.id2name,f=i.name2id,l=v("./constants").AX_ID_PATTERN,h=v("../../registry"),d=h.traceIs,s=h.getComponentMethod;function x(c,T,_){Array.isArray(c[T])?c[T].push(_):c[T]=[_]}J.exports=function(c,T,_){var w,k,L=T.autotypenumbers,A={},I={},P={},S={},E={},D={},R={},H={},V={},X={};for(w=0;w<_.length;w++){var $=_[w];if(d($,"cartesian")||d($,"gl2d")){var G,W;if($.xaxis)G=u($.xaxis),x(A,G,$);else if($.xaxes)for(k=0;k<$.xaxes.length;k++)x(A,u($.xaxes[k]),$);if($.yaxis)W=u($.yaxis),x(A,W,$);else if($.yaxes)for(k=0;k<$.yaxes.length;k++)x(A,u($.yaxes[k]),$);$.type==="funnel"?$.orientation==="h"?(G&&(I[G]=!0),W&&(R[W]=!0)):W&&(P[W]=!0):$.type==="image"?(W&&(H[W]=!0),G&&(H[G]=!0)):(W&&(E[W]=!0,D[W]=!0),d($,"carpet")&&($.type!=="carpet"||$._cheater)||G&&(S[G]=!0)),$.type==="carpet"&&$._cheater&&G&&(I[G]=!0),d($,"2dMap")&&(V[G]=!0,V[W]=!0),d($,"oriented")&&(X[$.orientation==="h"?W:G]=!0)}}var te=T._subplots,N=te.xaxis,B=te.yaxis,U=p.simpleMap(N,u),ee=p.simpleMap(B,u),j=U.concat(ee),Q=g.background;N.length&&B.length&&(Q=p.coerce(c,T,n,"plot_bgcolor"));var K,re,ne,le,oe,de=g.combine(Q,T.paper_bgcolor);function se(){var Ke=A[K]||[];oe._traceIndices=Ke.map(function(vt){return vt._expandedIndex}),oe._annIndices=[],oe._shapeIndices=[],oe._selectionIndices=[],oe._imgIndices=[],oe._subplotsWith=[],oe._counterAxes=[],oe._name=oe._attr=K,oe._id=re}function me(Ke,vt){return p.coerce(le,oe,t,Ke,vt)}function Te(Ke,vt){return p.coerce2(le,oe,t,Ke,vt)}function _e(Ke){return Ke==="x"?B:N}function be(Ke,vt){for(var Nt=Ke==="x"?U:ee,qt=[],er=0;er<Nt.length;er++){var Jt=Nt[er];Jt===vt||(c[Jt]||{}).overlaying||qt.push(f(Jt))}return qt}var Ce={x:_e("x"),y:_e("y")},fe=Ce.x.concat(Ce.y),ve={},Me=[];function ke(){var Ke=le.matches;l.test(Ke)&&fe.indexOf(Ke)===-1&&(ve[Ke]=le.type,Me=Object.keys(ve))}var Le=y(c,T),ze=b(Le);for(w=0;w<j.length;w++){K=j[w],re=f(K),ne=K.charAt(0),p.isPlainObject(c[K])||(c[K]={}),le=c[K],oe=e.newContainer(T,K,ne+"axis"),se();var Re=ne==="x"&&!S[K]&&I[K]||ne==="y"&&!E[K]&&P[K],Oe=ne==="y"&&(!D[K]&&R[K]||H[K]),Ze={hasMinor:!0,letter:ne,font:T.font,outerTicks:V[K],showGrid:!X[K],data:A[K]||[],bgColor:de,calendar:T.calendar,automargin:!0,visibleDflt:Re,reverseDflt:Oe,autotypenumbersDflt:L,splomStash:((T._splomAxes||{})[ne]||{})[re]};me("uirevision",T.uirevision),a(le,oe,me,Ze),r(le,oe,me,Ze,T);var Pe=ze&&ne===Le.charAt(0),Ie=Te("spikecolor",ze?oe.color:void 0),Be=Te("spikethickness",ze?1.5:void 0),Fe=Te("spikedash",ze?"dot":void 0),$e=Te("spikemode",ze?"across":void 0),ot=Te("spikesnap");me("showspikes",!!(Pe||Ie||Be||Fe||$e||ot))||(delete oe.spikecolor,delete oe.spikethickness,delete oe.spikedash,delete oe.spikemode,delete oe.spikesnap),o(le,oe,me,{letter:ne,counterAxes:Ce[ne],overlayableAxes:be(ne,K),grid:T.grid}),me("title.standoff"),ke(),oe._input=le}for(w=0;w<Me.length;){re=Me[w++],ne=(K=u(re)).charAt(0),p.isPlainObject(c[K])||(c[K]={}),le=c[K],oe=e.newContainer(T,K,ne+"axis"),se();var pt={letter:ne,font:T.font,outerTicks:V[K],showGrid:!X[K],data:[],bgColor:de,calendar:T.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:L,splomStash:((T._splomAxes||{})[ne]||{})[re]};me("uirevision",T.uirevision),oe.type=ve[re]||"linear",r(le,oe,me,pt,T),o(le,oe,me,{letter:ne,counterAxes:Ce[ne],overlayableAxes:be(ne,K),grid:T.grid}),me("fixedrange"),ke(),oe._input=le}var _t=s("rangeslider","handleDefaults"),yt=s("rangeselector","handleDefaults");for(w=0;w<U.length;w++)K=U[w],le=c[K],oe=T[K],_t(c,T,K),oe.type==="date"&&yt(le,oe,T,ee,oe.calendar),me("fixedrange");for(w=0;w<ee.length;w++){K=ee[w],le=c[K],oe=T[K];var tt=T[u(oe.anchor)];me("fixedrange",s("rangeslider","isVisible")(tt))}m.handleDefaults(c,T,{axIds:fe.concat(Me).sort(i.idSort),axHasImage:H})}},{"../../components/color":367,"../../components/fx/helpers":403,"../../components/fx/hovermode_defaults":406,"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../layout_attributes":619,"./axis_defaults":568,"./axis_ids":570,"./constants":573,"./constraints":574,"./layout_attributes":579,"./position_defaults":582,"./type_defaults":591}],581:[function(v,J,Z){var p=v("tinycolor2").mix,g=v("../../components/color/attributes"),b=v("../../lib");J.exports=function(y,e,n,t){var a=(t=t||{}).dfltColor;function r(c,T){return b.coerce2(y,e,t.attributes,c,T)}var m=r("linecolor",a),o=r("linewidth");n("showline",t.showLine||!!m||!!o)||(delete e.linecolor,delete e.linewidth);var i=r("gridcolor",p(a,t.bgColor,t.blend||g.lightFraction).toRgbString()),u=r("gridwidth"),f=r("griddash");if(n("showgrid",t.showGrid||!!i||!!u||!!f)||(delete e.gridcolor,delete e.gridwidth,delete e.griddash),t.hasMinor){var l=r("minor.gridcolor",p(e.gridcolor,t.bgColor,67).toRgbString()),h=r("minor.gridwidth",e.gridwidth||1),d=r("minor.griddash",e.griddash||"solid");n("minor.showgrid",!!l||!!h||!!d)||(delete e.minor.gridcolor,delete e.minor.gridwidth,delete e.minor.griddash)}if(!t.noZeroLine){var s=r("zerolinecolor",a),x=r("zerolinewidth");n("zeroline",t.showGrid||!!s||!!x)||(delete e.zerolinecolor,delete e.zerolinewidth)}}},{"../../components/color/attributes":366,"../../lib":515,tinycolor2:313}],582:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib");J.exports=function(b,y,e,n){var t,a,r,m,o=n.counterAxes||[],i=n.overlayableAxes||[],u=n.letter,f=n.grid;f&&(a=f._domains[u][f._axisMap[y._id]],t=f._anchors[y._id],a&&(r=f[u+"side"].split(" ")[0],m=f.domain[u][r==="right"||r==="top"?1:0])),a=a||[0,1],t=t||(p(b.position)?"free":o[0]||"free"),r=r||(u==="x"?"bottom":"left"),m=m||0,g.coerce(b,y,{anchor:{valType:"enumerated",values:["free"].concat(o),dflt:t}},"anchor")==="free"&&e("position",m),g.coerce(b,y,{side:{valType:"enumerated",values:u==="x"?["bottom","top"]:["left","right"],dflt:r}},"side");var l=!1;if(i.length&&(l=g.coerce(b,y,{overlaying:{valType:"enumerated",values:[!1].concat(i),dflt:!1}},"overlaying")),!l){var h=e("domain",a);h[0]>h[1]-1/4096&&(y.domain=a),g.noneOrAll(b.domain,y.domain,a)}return e("layer"),y}},{"../../lib":515,"fast-isnumeric":190}],583:[function(v,J,Z){var p=v("./show_dflt");J.exports=function(g,b,y,e,n){n||(n={});var t=n.tickSuffixDflt,a=p(g);y("tickprefix")&&y("showtickprefix",a),y("ticksuffix",t)&&y("showticksuffix",a)}},{"./show_dflt":586}],584:[function(v,J,Z){var p=v("../../constants/alignment").FROM_BL;J.exports=function(g,b,y){y===void 0&&(y=p[g.constraintoward||"center"]);var e=[g.r2l(g.range[0]),g.r2l(g.range[1])],n=e[0]+(e[1]-e[0])*y;g.range=g._input.range=[g.l2r(n+(e[0]-n)*b),g.l2r(n+(e[1]-n)*b)],g.setScale()}},{"../../constants/alignment":483}],585:[function(v,J,Z){var p=v("@plotly/d3"),g=v("d3-time-format").utcFormat,b=v("../../lib"),y=b.numberFormat,e=v("fast-isnumeric"),n=b.cleanNumber,t=b.ms2DateTime,a=b.dateTime2ms,r=b.ensureNumber,m=b.isArrayOrTypedArray,o=v("../../constants/numerical"),i=o.FP_SAFE,u=o.BADNUM,f=o.LOG_CLIP,l=o.ONEWEEK,h=o.ONEDAY,d=o.ONEHOUR,s=o.ONEMIN,x=o.ONESEC,c=v("./axis_ids"),T=v("./constants"),_=T.HOUR_PATTERN,w=T.WEEKDAY_PATTERN;function k(A){return Math.pow(10,A)}function L(A){return A!=null}J.exports=function(A,I){I=I||{};var P=A._id||"x",S=P.charAt(0);function E(j,Q){if(j>0)return Math.log(j)/Math.LN10;if(j<=0&&Q&&A.range&&A.range.length===2){var K=A.range[0],re=A.range[1];return .5*(K+re-2*f*Math.abs(K-re))}return u}function D(j,Q,K,re){if((re||{}).msUTC&&e(j))return+j;var ne=a(j,K||A.calendar);if(ne===u){if(!e(j))return u;j=+j;var le=Math.floor(10*b.mod(j+.05,1)),oe=Math.round(j-le/10);ne=a(new Date(oe))+le/10}return ne}function R(j,Q,K){return t(j,Q,K||A.calendar)}function H(j){return A._categories[Math.round(j)]}function V(j){if(L(j)){if(A._categoriesMap===void 0&&(A._categoriesMap={}),A._categoriesMap[j]!==void 0)return A._categoriesMap[j];A._categories.push(typeof j=="number"?String(j):j);var Q=A._categories.length-1;return A._categoriesMap[j]=Q,Q}return u}function X(j){if(A._categoriesMap)return A._categoriesMap[j]}function $(j){var Q=X(j);return Q!==void 0?Q:e(j)?+j:void 0}function G(j){return e(j)?+j:X(j)}function W(j,Q,K){return p.round(K+Q*j,2)}function te(j,Q,K){return(j-K)/Q}var N=function(j){return e(j)?W(j,A._m,A._b):u},B=function(j){return te(j,A._m,A._b)};if(A.rangebreaks){var U=S==="y";N=function(j){if(!e(j))return u;var Q=A._rangebreaks.length;if(!Q)return W(j,A._m,A._b);var K=U;A.range[0]>A.range[1]&&(K=!K);for(var re=K?-1:1,ne=re*j,le=0,oe=0;oe<Q;oe++){var de=re*A._rangebreaks[oe].min,se=re*A._rangebreaks[oe].max;if(ne<de)break;if(!(ne>se)){le=ne<(de+se)/2?oe:oe+1;break}le=oe+1}var me=A._B[le]||0;return isFinite(me)?W(j,A._m2,me):0},B=function(j){var Q=A._rangebreaks.length;if(!Q)return te(j,A._m,A._b);for(var K=0,re=0;re<Q&&!(j<A._rangebreaks[re].pmin);re++)j>A._rangebreaks[re].pmax&&(K=re+1);return te(j,A._m2,A._B[K])}}A.c2l=A.type==="log"?E:r,A.l2c=A.type==="log"?k:r,A.l2p=N,A.p2l=B,A.c2p=A.type==="log"?function(j,Q){return N(E(j,Q))}:N,A.p2c=A.type==="log"?function(j){return k(B(j))}:B,["linear","-"].indexOf(A.type)!==-1?(A.d2r=A.r2d=A.d2c=A.r2c=A.d2l=A.r2l=n,A.c2d=A.c2r=A.l2d=A.l2r=r,A.d2p=A.r2p=function(j){return A.l2p(n(j))},A.p2d=A.p2r=B,A.cleanPos=r):A.type==="log"?(A.d2r=A.d2l=function(j,Q){return E(n(j),Q)},A.r2d=A.r2c=function(j){return k(n(j))},A.d2c=A.r2l=n,A.c2d=A.l2r=r,A.c2r=E,A.l2d=k,A.d2p=function(j,Q){return A.l2p(A.d2r(j,Q))},A.p2d=function(j){return k(B(j))},A.r2p=function(j){return A.l2p(n(j))},A.p2r=B,A.cleanPos=r):A.type==="date"?(A.d2r=A.r2d=b.identity,A.d2c=A.r2c=A.d2l=A.r2l=D,A.c2d=A.c2r=A.l2d=A.l2r=R,A.d2p=A.r2p=function(j,Q,K){return A.l2p(D(j,0,K))},A.p2d=A.p2r=function(j,Q,K){return R(B(j),Q,K)},A.cleanPos=function(j){return b.cleanDate(j,u,A.calendar)}):A.type==="category"?(A.d2c=A.d2l=V,A.r2d=A.c2d=A.l2d=H,A.d2r=A.d2l_noadd=$,A.r2c=function(j){var Q=G(j);return Q!==void 0?Q:A.fraction2r(.5)},A.l2r=A.c2r=r,A.r2l=G,A.d2p=function(j){return A.l2p(A.r2c(j))},A.p2d=function(j){return H(B(j))},A.r2p=A.d2p,A.p2r=B,A.cleanPos=function(j){return typeof j=="string"&&j!==""?j:r(j)}):A.type==="multicategory"&&(A.r2d=A.c2d=A.l2d=H,A.d2r=A.d2l_noadd=$,A.r2c=function(j){var Q=$(j);return Q!==void 0?Q:A.fraction2r(.5)},A.r2c_just_indices=X,A.l2r=A.c2r=r,A.r2l=$,A.d2p=function(j){return A.l2p(A.r2c(j))},A.p2d=function(j){return H(B(j))},A.r2p=A.d2p,A.p2r=B,A.cleanPos=function(j){return Array.isArray(j)||typeof j=="string"&&j!==""?j:r(j)},A.setupMultiCategory=function(j){var Q,K,re=A._traceIndices,ne=A._matchGroup;if(ne&&A._categories.length===0){for(var le in ne)if(le!==P){var oe=I[c.id2name(le)];re=re.concat(oe._traceIndices)}}var de=[[0,{}],[0,{}]],se=[];for(Q=0;Q<re.length;Q++){var me=j[re[Q]];if(S in me){var Te=me[S],_e=me._length||b.minRowLength(Te);if(m(Te[0])&&m(Te[1]))for(K=0;K<_e;K++){var be=Te[0][K],Ce=Te[1][K];L(be)&&L(Ce)&&(se.push([be,Ce]),be in de[0][1]||(de[0][1][be]=de[0][0]++),Ce in de[1][1]||(de[1][1][Ce]=de[1][0]++))}}}for(se.sort(function(fe,ve){var Me=de[0][1],ke=Me[fe[0]]-Me[ve[0]];if(ke)return ke;var Le=de[1][1];return Le[fe[1]]-Le[ve[1]]}),Q=0;Q<se.length;Q++)V(se[Q])}),A.fraction2r=function(j){var Q=A.r2l(A.range[0]),K=A.r2l(A.range[1]);return A.l2r(Q+j*(K-Q))},A.r2fraction=function(j){var Q=A.r2l(A.range[0]),K=A.r2l(A.range[1]);return(A.r2l(j)-Q)/(K-Q)},A.cleanRange=function(j,Q){Q||(Q={}),j||(j="range");var K,re,ne=b.nestedProperty(A,j).get();if(re=(re=A.type==="date"?b.dfltRange(A.calendar):S==="y"?T.DFLTRANGEY:A._name==="realaxis"?[0,1]:Q.dfltRange||T.DFLTRANGEX).slice(),A.rangemode!=="tozero"&&A.rangemode!=="nonnegative"||(re[0]=0),ne&&ne.length===2)for(A.type!=="date"||A.autorange||(ne[0]=b.cleanDate(ne[0],u,A.calendar),ne[1]=b.cleanDate(ne[1],u,A.calendar)),K=0;K<2;K++)if(A.type==="date"){if(!b.isDateTime(ne[K],A.calendar)){A[j]=re;break}if(A.r2l(ne[0])===A.r2l(ne[1])){var le=b.constrain(A.r2l(ne[0]),b.MIN_MS+1e3,b.MAX_MS-1e3);ne[0]=A.l2r(le-1e3),ne[1]=A.l2r(le+1e3);break}}else{if(!e(ne[K])){if(!e(ne[1-K])){A[j]=re;break}ne[K]=ne[1-K]*(K?10:.1)}if(ne[K]<-i?ne[K]=-i:ne[K]>i&&(ne[K]=i),ne[0]===ne[1]){var oe=Math.max(1,Math.abs(1e-6*ne[0]));ne[0]-=oe,ne[1]+=oe}}else b.nestedProperty(A,j).set(re)},A.setScale=function(j){var Q=I._size;if(A.overlaying){var K=c.getFromId({_fullLayout:I},A.overlaying);A.domain=K.domain}var re=j&&A._r?"_r":"range",ne=A.calendar;A.cleanRange(re);var le,oe,de=A.r2l(A[re][0],ne),se=A.r2l(A[re][1],ne),me=S==="y";if(me?(A._offset=Q.t+(1-A.domain[1])*Q.h,A._length=Q.h*(A.domain[1]-A.domain[0]),A._m=A._length/(de-se),A._b=-A._m*se):(A._offset=Q.l+A.domain[0]*Q.w,A._length=Q.w*(A.domain[1]-A.domain[0]),A._m=A._length/(se-de),A._b=-A._m*de),A._rangebreaks=[],A._lBreaks=0,A._m2=0,A._B=[],A.rangebreaks&&(A._rangebreaks=A.locateBreaks(Math.min(de,se),Math.max(de,se)),A._rangebreaks.length)){for(le=0;le<A._rangebreaks.length;le++)oe=A._rangebreaks[le],A._lBreaks+=Math.abs(oe.max-oe.min);var Te=me;de>se&&(Te=!Te),Te&&A._rangebreaks.reverse();var _e=Te?-1:1;for(A._m2=_e*A._length/(Math.abs(se-de)-A._lBreaks),A._B.push(-A._m2*(me?se:de)),le=0;le<A._rangebreaks.length;le++)oe=A._rangebreaks[le],A._B.push(A._B[A._B.length-1]-_e*A._m2*(oe.max-oe.min));for(le=0;le<A._rangebreaks.length;le++)(oe=A._rangebreaks[le]).pmin=N(oe.min),oe.pmax=N(oe.max)}if(!isFinite(A._m)||!isFinite(A._b)||A._length<0)throw I._replotting=!1,new Error("Something went wrong with axis scaling")},A.maskBreaks=function(j){var Q,K,re,ne,le,oe=A.rangebreaks||[];oe._cachedPatterns||(oe._cachedPatterns=oe.map(function(be){return be.enabled&&be.bounds?b.simpleMap(be.bounds,be.pattern?n:A.d2c):null})),oe._cachedValues||(oe._cachedValues=oe.map(function(be){return be.enabled&&be.values?b.simpleMap(be.values,A.d2c).sort(b.sorterAsc):null}));for(var de=0;de<oe.length;de++){var se=oe[de];if(se.enabled){if(se.bounds){var me=se.pattern;switch(K=(Q=oe._cachedPatterns[de])[0],re=Q[1],me){case w:ne=(le=new Date(j)).getUTCDay(),K>re&&(re+=7,ne<K&&(ne+=7));break;case _:ne=(le=new Date(j)).getUTCHours()+(le.getUTCMinutes()/60+le.getUTCSeconds()/3600+le.getUTCMilliseconds()/36e5),K>re&&(re+=24,ne<K&&(ne+=24));break;case"":ne=j}if(ne>=K&&ne<re)return u}else for(var Te=oe._cachedValues[de],_e=0;_e<Te.length;_e++)if(re=(K=Te[_e])+se.dvalue,j>=K&&j<re)return u}}return j},A.locateBreaks=function(j,Q){var K,re,ne,le,oe=[];if(!A.rangebreaks)return oe;var de=A.rangebreaks.slice().sort(function(Le,ze){return Le.pattern===w&&ze.pattern===_?-1:ze.pattern===w&&Le.pattern===_?1:0}),se=function(Le,ze){if((Le=b.constrain(Le,j,Q))!==(ze=b.constrain(ze,j,Q))){for(var Re=!0,Oe=0;Oe<oe.length;Oe++){var Ze=oe[Oe];Le<Ze.max&&ze>=Ze.min&&(Le<Ze.min&&(Ze.min=Le),ze>Ze.max&&(Ze.max=ze),Re=!1)}Re&&oe.push({min:Le,max:ze})}};for(K=0;K<de.length;K++){var me=de[K];if(me.enabled)if(me.bounds){var Te=j,_e=Q;me.pattern&&(Te=Math.floor(Te)),ne=(re=b.simpleMap(me.bounds,me.pattern?n:A.r2l))[0],le=re[1];var be,Ce,fe=new Date(Te);switch(me.pattern){case w:Ce=l,be=(le-ne+(le<ne?7:0))*h,Te+=ne*h-(fe.getUTCDay()*h+fe.getUTCHours()*d+fe.getUTCMinutes()*s+fe.getUTCSeconds()*x+fe.getUTCMilliseconds());break;case _:Ce=h,be=(le-ne+(le<ne?24:0))*d,Te+=ne*d-(fe.getUTCHours()*d+fe.getUTCMinutes()*s+fe.getUTCSeconds()*x+fe.getUTCMilliseconds());break;default:Te=Math.min(re[0],re[1]),be=Ce=(_e=Math.max(re[0],re[1]))-Te}for(var ve=Te;ve<_e;ve+=Ce)se(ve,ve+be)}else for(var Me=b.simpleMap(me.values,A.d2c),ke=0;ke<Me.length;ke++)se(ne=Me[ke],le=ne+me.dvalue)}return oe.sort(function(Le,ze){return Le.min-ze.min}),oe},A.makeCalcdata=function(j,Q,K){var re,ne,le,oe,de=A.type,se=de==="date"&&j[Q+"calendar"];if(Q in j){if(re=j[Q],oe=j._length||b.minRowLength(re),b.isTypedArray(re)&&(de==="linear"||de==="log")){if(oe===re.length)return re;if(re.subarray)return re.subarray(0,oe)}if(de==="multicategory")return function(_e,be){for(var Ce=new Array(be),fe=0;fe<be;fe++){var ve=(_e[0]||[])[fe],Me=(_e[1]||[])[fe];Ce[fe]=X([ve,Me])}return Ce}(re,oe);for(ne=new Array(oe),le=0;le<oe;le++)ne[le]=A.d2c(re[le],0,se,K)}else{var me=Q+"0"in j?A.d2c(j[Q+"0"],0,se):0,Te=j["d"+Q]?Number(j["d"+Q]):1;for(re=j[{x:"y",y:"x"}[Q]],oe=j._length||re.length,ne=new Array(oe),le=0;le<oe;le++)ne[le]=me+le*Te}if(A.rangebreaks)for(le=0;le<oe;le++)ne[le]=A.maskBreaks(ne[le]);return ne},A.isValidRange=function(j){return Array.isArray(j)&&j.length===2&&e(A.r2l(j[0]))&&e(A.r2l(j[1]))},A.isPtWithinRange=function(j,Q){var K=A.c2l(j[S],null,Q),re=A.r2l(A.range[0]),ne=A.r2l(A.range[1]);return re<ne?re<=K&&K<=ne:ne<=K&&K<=re},A._emptyCategories=function(){A._categories=[],A._categoriesMap={}},A.clearCalc=function(){var j=A._matchGroup;if(j){var Q=null,K=null;for(var re in j){var ne=I[c.id2name(re)];if(ne._categories){Q=ne._categories,K=ne._categoriesMap;break}}Q&&K?(A._categories=Q,A._categoriesMap=K):A._emptyCategories()}else A._emptyCategories();if(A._initialCategories)for(var le=0;le<A._initialCategories.length;le++)V(A._initialCategories[le])},A.sortByInitialCategories=function(){var j=[];if(A._emptyCategories(),A._initialCategories)for(var Q=0;Q<A._initialCategories.length;Q++)V(A._initialCategories[Q]);j=j.concat(A._traceIndices);var K=A._matchGroup;for(var re in K)if(P!==re){var ne=I[c.id2name(re)];ne._categories=A._categories,ne._categoriesMap=A._categoriesMap,j=j.concat(ne._traceIndices)}return j};var ee=I._d3locale;A.type==="date"&&(A._dateFormat=ee?ee.timeFormat:g,A._extraFormat=I._extraFormat),A._separators=I.separators,A._numFormat=ee?ee.numberFormat:y,delete A._minDtick,delete A._forceTick0}},{"../../constants/numerical":491,"../../lib":515,"./axis_ids":570,"./constants":573,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],586:[function(v,J,Z){J.exports=function(p){var g=["showexponent","showtickprefix","showticksuffix"].filter(function(b){return p[b]!==void 0});if(g.every(function(b){return p[b]===p[g[0]]})||g.length===1)return p[g[0]]}},{}],587:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/color").contrast,b=v("./layout_attributes"),y=v("./show_dflt"),e=v("../array_container_defaults");function n(t,a){function r(m,o){return p.coerce(t,a,b.tickformatstops,m,o)}r("enabled")&&(r("dtickrange"),r("value"))}J.exports=function(t,a,r,m,o){o||(o={});var i=y(t);if(r("showticklabels")){var u=o.font||{},f=a.color,l=(a.ticklabelposition||"").indexOf("inside")!==-1?g(o.bgColor):f&&f!==b.color.dflt?f:u.color;if(p.coerceFont(r,"tickfont",{family:u.family,size:u.size,color:l}),o.noTicklabelstep||m==="multicategory"||m==="log"||r("ticklabelstep"),o.noAng||r("tickangle"),m!=="category"){var h=r("tickformat");e(t,a,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:n}),a.tickformatstops.length||delete a.tickformatstops,o.noExp||h||m==="date"||(r("showexponent",i),r("exponentformat"),r("minexponent"),r("separatethousands"))}}}},{"../../components/color":367,"../../lib":515,"../array_container_defaults":561,"./layout_attributes":579,"./show_dflt":586}],588:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes");J.exports=function(b,y,e,n){var t=n.isMinor,a=t?b.minor||{}:b,r=t?y.minor:y,m=t?g.minor:g,o=t?"minor.":"",i=p.coerce2(a,r,m,"ticklen",t?.6*(y.ticklen||5):void 0),u=p.coerce2(a,r,m,"tickwidth",t?y.tickwidth||1:void 0),f=p.coerce2(a,r,m,"tickcolor",(t?y.tickcolor:void 0)||r.color);e(o+"ticks",!t&&n.outerTicks||i||u||f?"outside":"")||(delete r.ticklen,delete r.tickwidth,delete r.tickcolor)}},{"../../lib":515,"./layout_attributes":579}],589:[function(v,J,Z){var p=v("./clean_ticks"),g=v("../../lib").isArrayOrTypedArray;J.exports=function(b,y,e,n,t){t||(t={});var a=t.isMinor,r=a?b.minor||{}:b,m=a?y.minor:y,o=a?"minor.":"";function i(s){var x=r[s];return x!==void 0?x:(m._template||{})[s]}var u=i("tick0"),f=i("dtick"),l=i("tickvals"),h=e(o+"tickmode",g(l)?"array":f?"linear":"auto");if(h==="auto")e(o+"nticks");else if(h==="linear"){var d=m.dtick=p.dtick(f,n);m.tick0=p.tick0(u,n,y.calendar,d)}else n!=="multicategory"&&(e(o+"tickvals")===void 0?m.tickmode="auto":a||e("ticktext"))}},{"../../lib":515,"./clean_ticks":572}],590:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../registry"),b=v("../../lib"),y=v("../../components/drawing"),e=v("./axes");J.exports=function(n,t,a,r){var m=n._fullLayout;if(t.length!==0){var o,i,u,f;r&&(o=r());var l=p.ease(a.easing);return n._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(f),f=null,function(){for(var s={},x=0;x<t.length;x++){var c=t[x],T=c.plotinfo.xaxis,_=c.plotinfo.yaxis;c.xr0&&(s[T._name+".range"]=c.xr0.slice()),c.yr0&&(s[_._name+".range"]=c.yr0.slice())}return g.call("relayout",n,s).then(function(){for(var w=0;w<t.length;w++)h(t[w].plotinfo)})}()}),i=Date.now(),f=window.requestAnimationFrame(function s(){u=Date.now();for(var x=Math.min(1,(u-i)/a.duration),c=l(x),T=0;T<t.length;T++)d(t[T],c);u-i>a.duration?(function(){for(var _={},w=0;w<t.length;w++){var k=t[w],L=k.plotinfo.xaxis,A=k.plotinfo.yaxis;k.xr1&&(_[L._name+".range"]=k.xr1.slice()),k.yr1&&(_[A._name+".range"]=k.yr1.slice())}o&&o(),g.call("relayout",n,_).then(function(){for(var I=0;I<t.length;I++)h(t[I].plotinfo)})}(),f=window.cancelAnimationFrame(s)):f=window.requestAnimationFrame(s)}),Promise.resolve()}function h(s){var x=s.xaxis,c=s.yaxis;m._defs.select("#"+s.clipId+"> rect").call(y.setTranslate,0,0).call(y.setScale,1,1),s.plot.call(y.setTranslate,x._offset,c._offset).call(y.setScale,1,1);var T=s.plot.selectAll(".scatterlayer .trace");T.selectAll(".point").call(y.setPointGroupScale,1,1),T.selectAll(".textpoint").call(y.setTextPointsScale,1,1),T.call(y.hideOutsideRangePoints,s)}function d(s,x){var c=s.plotinfo,T=c.xaxis,_=c.yaxis,w=T._length,k=_._length,L=!!s.xr1,A=!!s.yr1,I=[];if(L){var P=b.simpleMap(s.xr0,T.r2l),S=b.simpleMap(s.xr1,T.r2l),E=P[1]-P[0],D=S[1]-S[0];I[0]=(P[0]*(1-x)+x*S[0]-P[0])/(P[1]-P[0])*w,I[2]=w*(1-x+x*D/E),T.range[0]=T.l2r(P[0]*(1-x)+x*S[0]),T.range[1]=T.l2r(P[1]*(1-x)+x*S[1])}else I[0]=0,I[2]=w;if(A){var R=b.simpleMap(s.yr0,_.r2l),H=b.simpleMap(s.yr1,_.r2l),V=R[1]-R[0],X=H[1]-H[0];I[1]=(R[1]*(1-x)+x*H[1]-R[1])/(R[0]-R[1])*k,I[3]=k*(1-x+x*X/V),_.range[0]=T.l2r(R[0]*(1-x)+x*H[0]),_.range[1]=_.l2r(R[1]*(1-x)+x*H[1])}else I[1]=0,I[3]=k;e.drawOne(n,T,{skipTitle:!0}),e.drawOne(n,_,{skipTitle:!0}),e.redrawComponents(n,[T._id,_._id]);var $=L?w/I[2]:1,G=A?k/I[3]:1,W=L?I[0]:0,te=A?I[1]:0,N=L?I[0]/I[2]*w:0,B=A?I[1]/I[3]*k:0,U=T._offset-N,ee=_._offset-B;c.clipRect.call(y.setTranslate,W,te).call(y.setScale,1/$,1/G),c.plot.call(y.setTranslate,U,ee).call(y.setScale,$,G),y.setPointGroupScale(c.zoomScalePts,1/$,1/G),y.setTextPointsScale(c.zoomScaleTxt,1/$,1/G)}e.redrawComponents(n)}},{"../../components/drawing":389,"../../lib":515,"../../registry":647,"./axes":566,"@plotly/d3":58}],591:[function(v,J,Z){var p=v("../../registry").traceIs,g=v("./axis_autotype");function b(e){return{v:"x",h:"y"}[e.orientation||"v"]}function y(e,n){var t=b(e),a=p(e,"box-violin"),r=p(e._fullInput||{},"candlestick");return a&&!r&&n===t&&e[t]===void 0&&e[t+"0"]===void 0}J.exports=function(e,n,t,a){t("autotypenumbers",a.autotypenumbersDflt),t("type",(a.splomStash||{}).type)==="-"&&(function(r,m){if(r.type==="-"){var o,i=r._id,u=i.charAt(0);i.indexOf("scene")!==-1&&(i=u);var f=function(_,w,k){for(var L=0;L<_.length;L++){var A=_[L];if(A.type==="splom"&&A._length>0&&(A["_"+k+"axes"]||{})[w]||(A[k+"axis"]||k)===w&&(y(A,k)||(A[k]||[]).length||A[k+"0"]))return A}}(m,i,u);if(!!f){if(f.type==="histogram"&&u==={v:"y",h:"x"}[f.orientation||"v"])return void(r.type="linear");var l=u+"calendar",h=f[l],d={noMultiCategory:!p(f,"cartesian")||p(f,"noMultiCategory")};if(f.type==="box"&&f._hasPreCompStats&&u==={h:"x",v:"y"}[f.orientation||"v"]&&(d.noMultiCategory=!0),d.autotypenumbers=r.autotypenumbers,y(f,u)){var s=b(f),x=[];for(o=0;o<m.length;o++){var c=m[o];p(c,"box-violin")&&(c[u+"axis"]||u)===i&&(c[s]!==void 0?x.push(c[s][0]):c.name!==void 0?x.push(c.name):x.push("text"),c[l]!==h&&(h=void 0))}r.type=g(x,h,d)}else if(f.type==="splom"){var T=f.dimensions[f._axesDim[i]];T.visible&&(r.type=g(T.values,h,d))}else r.type=g(f[u]||[f[u+"0"]],h,d)}}}(n,a.data),n.type==="-"?n.type="linear":e.type=n.type)}},{"../../registry":647,"./axis_autotype":567}],592:[function(v,J,Z){var p=v("../registry"),g=v("../lib");function b(t,a,r){var m,o,i,u=!1;if(a.type==="data")m=t._fullData[a.traces!==null?a.traces[0]:0];else{if(a.type!=="layout")return!1;m=t._fullLayout}return o=g.nestedProperty(m,a.prop).get(),(i=r[a.type]=r[a.type]||{}).hasOwnProperty(a.prop)&&i[a.prop]!==o&&(u=!0),i[a.prop]=o,{changed:u,value:o}}function y(t,a){var r=[],m=a[0],o={};if(typeof m=="string")o[m]=a[1];else{if(!g.isPlainObject(m))return r;o=m}return n(o,function(i,u,f){r.push({type:"layout",prop:i,value:f})},"",0),r}function e(t,a){var r,m,o,i,u=[];if(m=a[0],o=a[1],r=a[2],i={},typeof m=="string")i[m]=o;else{if(!g.isPlainObject(m))return u;i=m,r===void 0&&(r=o)}return r===void 0&&(r=null),n(i,function(f,l,h){var d,s;if(Array.isArray(h)){s=h.slice();var x=Math.min(s.length,t.data.length);r&&(x=Math.min(x,r.length)),d=[];for(var c=0;c<x;c++)d[c]=r?r[c]:c}else s=h,d=r?r.slice():null;if(d===null)Array.isArray(s)&&(s=s[0]);else if(Array.isArray(d)){if(!Array.isArray(s)){var T=s;s=[];for(var _=0;_<d.length;_++)s[_]=T}s.length=Math.min(d.length,s.length)}u.push({type:"data",prop:f,traces:d,value:s})},"",0),u}function n(t,a,r,m){Object.keys(t).forEach(function(o){var i=t[o];if(o[0]!=="_"){var u=r+(m>0?".":"")+o;g.isPlainObject(i)?n(i,a,u,m+1):a(u,o,i)}})}Z.manageCommandObserver=function(t,a,r,m){var o={},i=!0;a&&a._commandObserver&&(o=a._commandObserver),o.cache||(o.cache={}),o.lookupTable={};var u=Z.hasSimpleAPICommandBindings(t,r,o.lookupTable);if(a&&a._commandObserver){if(u)return o;if(a._commandObserver.remove)return a._commandObserver.remove(),a._commandObserver=null,o}if(u){b(t,u,o.cache),o.check=function(){if(i){var h=b(t,u,o.cache);return h.changed&&m&&o.lookupTable[h.value]!==void 0&&(o.disable(),Promise.resolve(m({value:h.value,type:u.type,prop:u.prop,traces:u.traces,index:o.lookupTable[h.value]})).then(o.enable,o.enable)),h.changed}};for(var f=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],l=0;l<f.length;l++)t._internalOn(f[l],o.check);o.remove=function(){for(var h=0;h<f.length;h++)t._removeInternalListener(f[h],o.check)}}else g.log("Unable to automatically bind plot updates to API command"),o.lookupTable={},o.remove=function(){};return o.disable=function(){i=!1},o.enable=function(){i=!0},a&&(a._commandObserver=o),o},Z.hasSimpleAPICommandBindings=function(t,a,r){var m,o,i=a.length;for(m=0;m<i;m++){var u,f=a[m],l=f.method,h=f.args;if(Array.isArray(h)||(h=[]),!l)return!1;var d=Z.computeAPICommandBindings(t,l,h);if(d.length!==1)return!1;if(o){if((u=d[0]).type!==o.type||u.prop!==o.prop)return!1;if(Array.isArray(o.traces)){if(!Array.isArray(u.traces))return!1;u.traces.sort();for(var s=0;s<o.traces.length;s++)if(o.traces[s]!==u.traces[s])return!1}else if(u.prop!==o.prop)return!1}else o=d[0],Array.isArray(o.traces)&&o.traces.sort();var x=(u=d[0]).value;if(Array.isArray(x)){if(x.length!==1)return!1;x=x[0]}r&&(r[x]=m)}return o},Z.executeAPICommand=function(t,a,r){if(a==="skip")return Promise.resolve();var m=p.apiMethodRegistry[a],o=[t];Array.isArray(r)||(r=[]);for(var i=0;i<r.length;i++)o.push(r[i]);return m.apply(null,o).catch(function(u){return g.warn("API call to Plotly."+a+" rejected.",u),Promise.reject(u)})},Z.computeAPICommandBindings=function(t,a,r){var m;switch(Array.isArray(r)||(r=[]),a){case"restyle":m=e(t,r);break;case"relayout":m=y(t,r);break;case"update":m=e(t,[r[0],r[2]]).concat(y(t,[r[1]]));break;case"animate":m=function(o,i){return Array.isArray(i[0])&&i[0].length===1&&["string","number"].indexOf(typeof i[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:i[0][0].toString()}]:[]}(0,r);break;default:m=[]}return m}},{"../lib":515,"../registry":647}],593:[function(v,J,Z){var p=v("../lib/extend").extendFlat;Z.attributes=function(g,b){b=b||{};var y={valType:"info_array",editType:(g=g||{}).editType,items:[{valType:"number",min:0,max:1,editType:g.editType},{valType:"number",min:0,max:1,editType:g.editType}],dflt:[0,1]},e=(g.name&&g.name,g.trace,b.description&&b.description,{x:p({},y,{}),y:p({},y,{}),editType:g.editType});return g.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:g.editType},e.column={valType:"integer",min:0,dflt:0,editType:g.editType}),e},Z.defaults=function(g,b,y,e){var n=e&&e.x||[0,1],t=e&&e.y||[0,1],a=b.grid;if(a){var r=y("domain.column");r!==void 0&&(r<a.columns?n=a._domains.x[r]:delete g.domain.column);var m=y("domain.row");m!==void 0&&(m<a.rows?t=a._domains.y[m]:delete g.domain.row)}var o=y("domain.x",n),i=y("domain.y",t);o[0]<o[1]||(g.domain.x=n.slice()),i[0]<i[1]||(g.domain.y=t.slice())}},{"../lib/extend":505}],594:[function(v,J,Z){J.exports=function(p){var g=p.editType,b=p.colorEditType;b===void 0&&(b=g);var y={family:{valType:"string",noBlank:!0,strict:!0,editType:g},size:{valType:"number",min:1,editType:g},color:{valType:"color",editType:b},editType:g};return p.autoSize&&(y.size.dflt="auto"),p.autoColor&&(y.color.dflt="auto"),p.arrayOk&&(y.family.arrayOk=!0,y.size.arrayOk=!0,y.color.arrayOk=!0),y}},{}],595:[function(v,J,Z){J.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],596:[function(v,J,Z){Z.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},Z.axesNames=["lonaxis","lataxis"],Z.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},Z.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},Z.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},Z.clipPad=.001,Z.precision=.1,Z.landColor="#F0DC82",Z.waterColor="#3399FF",Z.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},Z.sphereSVG={type:"Sphere"},Z.fillLayers={ocean:1,land:1,lakes:1},Z.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},Z.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],Z.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],Z.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],597:[function(v,J,Z){var p=v("@plotly/d3"),g=v("d3-geo"),b=g.geoPath,y=g.geoDistance,e=v("d3-geo-projection"),n=v("../../registry"),t=v("../../lib"),a=t.strTranslate,r=v("../../components/color"),m=v("../../components/drawing"),o=v("../../components/fx"),i=v("../plots"),u=v("../cartesian/axes"),f=v("../cartesian/autorange").getAutoRange,l=v("../../components/dragelement"),h=v("../../components/selections").prepSelect,d=v("../../components/selections").clearOutline,s=v("../../components/selections").selectOnClick,x=v("./zoom"),c=v("./constants"),T=v("../../lib/geo_location_utils"),_=v("../../lib/topojson_utils"),w=v("topojson-client").feature;function k(I){this.id=I.id,this.graphDiv=I.graphDiv,this.container=I.container,this.topojsonURL=I.topojsonURL,this.isStatic=I.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var L=k.prototype;function A(I,P){var S=c.clipPad,E=I[0]+S,D=I[1]-S,R=P[0]+S,H=P[1]-S;E>0&&D<0&&(D+=360);var V=(D-E)/4;return{type:"Polygon",coordinates:[[[E,R],[E,H],[E+V,H],[E+2*V,H],[E+3*V,H],[D,H],[D,R],[D-V,R],[D-2*V,R],[D-3*V,R],[E,R]]]}}J.exports=function(I){return new k(I)},L.plot=function(I,P,S){var E=this,D=P[this.id],R=[],H=!1;for(var V in c.layerNameToAdjective)if(V!=="frame"&&D["show"+V]){H=!0;break}for(var X=0;X<I.length;X++)if(I[0][0].trace.locationmode){H=!0;break}if(H){var $=_.getTopojsonName(D);E.topojson!==null&&$===E.topojsonName||(E.topojsonName=$,PlotlyGeoAssets.topojson[E.topojsonName]===void 0&&R.push(E.fetchTopojson()))}R=R.concat(T.fetchTraceGeoData(I)),S.push(new Promise(function(G,W){Promise.all(R).then(function(){E.topojson=PlotlyGeoAssets.topojson[E.topojsonName],E.update(I,P),G()}).catch(W)}))},L.fetchTopojson=function(){var I=this,P=_.getTopojsonPath(I.topojsonURL,I.topojsonName);return new Promise(function(S,E){p.json(P,function(D,R){if(D)return D.status===404?E(new Error(["plotly.js could not find topojson file at",P+".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):E(new Error(["unexpected error while fetching topojson file at",P].join(" ")));PlotlyGeoAssets.topojson[I.topojsonName]=R,S()})})},L.update=function(I,P){var S=P[this.id];this.hasChoropleth=!1;for(var E=0;E<I.length;E++){var D=I[E],R=D[0].trace;R.type==="choropleth"&&(this.hasChoropleth=!0),R.visible===!0&&R._length>0&&R._module.calcGeoJSON(D,P)}if(!this.updateProjection(I,P)){this.viewInitial&&this.scope===S.scope||this.saveViewInitial(S),this.scope=S.scope,this.updateBaseLayers(P,S),this.updateDims(P,S),this.updateFx(P,S),i.generalUpdatePerTraceModule(this.graphDiv,this,I,S);var H=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=H.selectAll(".point"),this.dataPoints.text=H.selectAll("text"),this.dataPaths.line=H.selectAll(".js-line");var V=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=V.selectAll("path"),this.render()}},L.updateProjection=function(I,P){var S=this.graphDiv,E=P[this.id],D=P._size,R=E.domain,H=E.projection,V=E.lonaxis,X=E.lataxis,$=V._ax,G=X._ax,W=this.projection=function(fe){var ve=fe.projection,Me=ve.type,ke=c.projNames[Me];ke="geo"+t.titleCase(ke);for(var Le=(g[ke]||e[ke])(),ze=fe._isSatellite?180*Math.acos(1/ve.distance)/Math.PI:fe._isClipped?c.lonaxisSpan[Me]/2:null,Re=["center","rotate","parallels","clipExtent"],Oe=function(Ie){return Ie?Le:[]},Ze=0;Ze<Re.length;Ze++){var Pe=Re[Ze];typeof Le[Pe]!="function"&&(Le[Pe]=Oe)}return Le.isLonLatOverEdges=function(Ie){if(Le(Ie)===null)return!0;if(ze){var Be=Le.rotate();return y(Ie,[-Be[0],-Be[1]])>ze*Math.PI/180}return!1},Le.getPath=function(){return b().projection(Le)},Le.getBounds=function(Ie){return Le.getPath().bounds(Ie)},Le.precision(c.precision),fe._isSatellite&&Le.tilt(ve.tilt).distance(ve.distance),ze&&Le.clipAngle(ze-c.clipPad),Le}(E),te=[[D.l+D.w*R.x[0],D.t+D.h*(1-R.y[1])],[D.l+D.w*R.x[1],D.t+D.h*(1-R.y[0])]],N=E.center||{},B=H.rotation||{},U=V.range||[],ee=X.range||[];if(E.fitbounds){$._length=te[1][0]-te[0][0],G._length=te[1][1]-te[0][1],$.range=f(S,$),G.range=f(S,G);var j=($.range[0]+$.range[1])/2,Q=(G.range[0]+G.range[1])/2;if(E._isScoped)N={lon:j,lat:Q};else if(E._isClipped){N={lon:j,lat:Q},B={lon:j,lat:Q,roll:B.roll};var K=H.type,re=c.lonaxisSpan[K]/2||180,ne=c.lataxisSpan[K]/2||90;U=[j-re,j+re],ee=[Q-ne,Q+ne]}else N={lon:j,lat:Q},B={lon:j,lat:B.lat,roll:B.roll}}W.center([N.lon-B.lon,N.lat-B.lat]).rotate([-B.lon,-B.lat,B.roll]).parallels(H.parallels);var le=A(U,ee);W.fitExtent(te,le);var oe=this.bounds=W.getBounds(le),de=this.fitScale=W.scale(),se=W.translate();if(E.fitbounds){var me=W.getBounds(A($.range,G.range)),Te=Math.min((oe[1][0]-oe[0][0])/(me[1][0]-me[0][0]),(oe[1][1]-oe[0][1])/(me[1][1]-me[0][1]));isFinite(Te)?W.scale(Te*de):t.warn("Something went wrong during"+this.id+"fitbounds computations.")}else W.scale(H.scale*de);var _e=this.midPt=[(oe[0][0]+oe[1][0])/2,(oe[0][1]+oe[1][1])/2];if(W.translate([se[0]+(_e[0]-se[0]),se[1]+(_e[1]-se[1])]).clipExtent(oe),E._isAlbersUsa){var be=W([N.lon,N.lat]),Ce=W.translate();W.translate([Ce[0]-(be[0]-Ce[0]),Ce[1]-(be[1]-Ce[1])])}},L.updateBaseLayers=function(I,P){var S=this,E=S.topojson,D=S.layers,R=S.basePaths;function H(W){return W==="lonaxis"||W==="lataxis"}function V(W){return Boolean(c.lineLayers[W])}function X(W){return Boolean(c.fillLayers[W])}var $=(this.hasChoropleth?c.layersForChoropleth:c.layers).filter(function(W){return V(W)||X(W)?P["show"+W]:!H(W)||P[W].showgrid}),G=S.framework.selectAll(".layer").data($,String);G.exit().each(function(W){delete D[W],delete R[W],p.select(this).remove()}),G.enter().append("g").attr("class",function(W){return"layer "+W}).each(function(W){var te=D[W]=p.select(this);W==="bg"?S.bgRect=te.append("rect").style("pointer-events","all"):H(W)?R[W]=te.append("path").style("fill","none"):W==="backplot"?te.append("g").classed("choroplethlayer",!0):W==="frontplot"?te.append("g").classed("scatterlayer",!0):V(W)?R[W]=te.append("path").style("fill","none").style("stroke-miterlimit",2):X(W)&&(R[W]=te.append("path").style("stroke","none"))}),G.order(),G.each(function(W){var te=R[W],N=c.layerNameToAdjective[W];W==="frame"?te.datum(c.sphereSVG):V(W)||X(W)?te.datum(w(E,E.objects[W])):H(W)&&te.datum(function(B,U,ee){var j,Q,K,re=U[B],ne=c.scopeDefaults[U.scope];B==="lonaxis"?(j=ne.lonaxisRange,Q=ne.lataxisRange,K=function(Ce,fe){return[Ce,fe]}):B==="lataxis"&&(j=ne.lataxisRange,Q=ne.lonaxisRange,K=function(Ce,fe){return[fe,Ce]});var le={type:"linear",range:[j[0],j[1]-1e-6],tick0:re.tick0,dtick:re.dtick};u.setConvert(le,ee);var oe=u.calcTicks(le);U.isScoped||B!=="lonaxis"||oe.pop();for(var de=oe.length,se=new Array(de),me=0;me<de;me++)for(var Te=oe[me].x,_e=se[me]=[],be=Q[0];be<Q[1]+2.5;be+=2.5)_e.push(K(Te,be));return{type:"MultiLineString",coordinates:se}}(W,P,I)).call(r.stroke,P[W].gridcolor).call(m.dashLine,P[W].griddash,P[W].gridwidth),V(W)?te.call(r.stroke,P[N+"color"]).call(m.dashLine,"",P[N+"width"]):X(W)&&te.call(r.fill,P[N+"color"])})},L.updateDims=function(I,P){var S=this.bounds,E=(P.framewidth||0)/2,D=S[0][0]-E,R=S[0][1]-E,H=S[1][0]-D+E,V=S[1][1]-R+E;m.setRect(this.clipRect,D,R,H,V),this.bgRect.call(m.setRect,D,R,H,V).call(r.fill,P.bgcolor),this.xaxis._offset=D,this.xaxis._length=H,this.yaxis._offset=R,this.yaxis._length=V},L.updateFx=function(I,P){var S=this,E=S.graphDiv,D=S.bgRect,R=I.dragmode,H=I.clickmode;if(!S.isStatic){var V={element:S.bgRect.node(),gd:E,plotinfo:{id:S.id,xaxis:S.xaxis,yaxis:S.yaxis,fillRangeItems:function($,G){G.isRect?($.range={})[S.id]=[X([G.xmin,G.ymin]),X([G.xmax,G.ymax])]:($.lassoPoints={})[S.id]=G.map(X)}},xaxes:[S.xaxis],yaxes:[S.yaxis],subplot:S.id,clickFn:function($){$===2&&d(E)}};R==="pan"?(D.node().onmousedown=null,D.call(x(S,P)),D.on("dblclick.zoom",function(){var $=S.viewInitial,G={};for(var W in $)G[S.id+"."+W]=$[W];n.call("_guiRelayout",E,G),E.emit("plotly_doubleclick",null)}),E._context._scrollZoom.geo||D.on("wheel.zoom",null)):R!=="select"&&R!=="lasso"||(D.on(".zoom",null),V.prepFn=function($,G,W){h($,G,W,V,R)},l.init(V)),D.on("mousemove",function(){var $=S.projection.invert(t.getPositionFromD3Event());if(!$)return l.unhover(E,p.event);S.xaxis.p2c=function(){return $[0]},S.yaxis.p2c=function(){return $[1]},o.hover(E,p.event,S.id)}),D.on("mouseout",function(){E._dragging||l.unhover(E,p.event)}),D.on("click",function(){R!=="select"&&R!=="lasso"&&(H.indexOf("select")>-1&&s(p.event,E,[S.xaxis],[S.yaxis],S.id,V),H.indexOf("event")>-1&&o.click(E,p.event))})}function X($){return S.projection.invert([$[0]+S.xaxis._offset,$[1]+S.yaxis._offset])}},L.makeFramework=function(){var I=this,P=I.graphDiv,S=P._fullLayout,E="clip"+S._uid+I.id;I.clipDef=S._clips.append("clipPath").attr("id",E),I.clipRect=I.clipDef.append("rect"),I.framework=p.select(I.container).append("g").attr("class","geo "+I.id).call(m.setClipUrl,E,P),I.project=function(D){var R=I.projection(D);return R?[R[0]-I.xaxis._offset,R[1]-I.yaxis._offset]:[null,null]},I.xaxis={_id:"x",c2p:function(D){return I.project(D)[0]}},I.yaxis={_id:"y",c2p:function(D){return I.project(D)[1]}},I.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},u.setConvert(I.mockAxis,S)},L.saveViewInitial=function(I){var P,S=I.center||{},E=I.projection,D=E.rotation||{};this.viewInitial={fitbounds:I.fitbounds,"projection.scale":E.scale},P=I._isScoped?{"center.lon":S.lon,"center.lat":S.lat}:I._isClipped?{"projection.rotation.lon":D.lon,"projection.rotation.lat":D.lat}:{"center.lon":S.lon,"center.lat":S.lat,"projection.rotation.lon":D.lon},t.extendFlat(this.viewInitial,P)},L.render=function(){var I,P=this.projection,S=P.getPath();function E(R){var H=P(R.lonlat);return H?a(H[0],H[1]):null}function D(R){return P.isLonLatOverEdges(R.lonlat)?"none":null}for(I in this.basePaths)this.basePaths[I].attr("d",S);for(I in this.dataPaths)this.dataPaths[I].attr("d",function(R){return S(R.geojson)});for(I in this.dataPoints)this.dataPoints[I].attr("display",D).attr("transform",E)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../registry":647,"../cartesian/autorange":565,"../cartesian/axes":566,"../plots":628,"./constants":596,"./zoom":601,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":316}],598:[function(v,J,Z){var p=v("../../plots/get_data").getSubplotCalcData,g=v("../../lib").counterRegex,b=v("./geo"),y="geo",e=g(y),n={};n.geo={valType:"subplotid",dflt:y,editType:"calc"},J.exports={attr:y,name:y,idRoot:y,idRegex:e,attrRegex:e,attributes:n,layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),plot:function(t){for(var a=t._fullLayout,r=t.calcdata,m=a._subplots.geo,o=0;o<m.length;o++){var i=m[o],u=p(r,y,i),f=a[i]._subplot;f||(f=b({id:i,graphDiv:t,container:a._geolayer.node(),topojsonURL:t._context.topojsonURL,staticPlot:t._context.staticPlot}),a[i]._subplot=f),f.plot(u,a,t._promises)}},updateFx:function(t){for(var a=t._fullLayout,r=a._subplots.geo,m=0;m<r.length;m++){var o=a[r[m]];o._subplot.updateFx(a,o)}},clean:function(t,a,r,m){for(var o=m._subplots.geo||[],i=0;i<o.length;i++){var u=o[i],f=m[u]._subplot;!a[u]&&f&&(f.framework.remove(),f.clipDef.remove())}}}},{"../../lib":515,"../../plots/get_data":602,"./geo":597,"./layout_attributes":599,"./layout_defaults":600}],599:[function(v,J,Z){var p=v("../../components/color/attributes"),g=v("../domain").attributes,b=v("../../components/drawing/attributes").dash,y=v("./constants"),e=v("../../plot_api/edit_types").overrideAll,n=v("../../lib/sort_object_keys"),t={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:p.lightLine},gridwidth:{valType:"number",min:0,dflt:1},griddash:b};(J.exports=e({domain:g({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:n(y.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:n(y.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:p.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:y.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:y.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:y.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:y.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:p.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:p.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:p.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:p.background},lonaxis:t,lataxis:t},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../domain":593,"./constants":596}],600:[function(v,J,Z){var p=v("../../lib"),g=v("../subplot_defaults"),b=v("../get_data").getSubplotData,y=v("./constants"),e=v("./layout_attributes"),n=y.axesNames;function t(a,r,m,o){var i=b(o.fullData,"geo",o.id).map(function(B){return B._expandedIndex}),u=m("resolution"),f=m("scope"),l=y.scopeDefaults[f],h=m("projection.type",l.projType),d=r._isAlbersUsa=h==="albers usa";d&&(f=r.scope="usa");var s=r._isScoped=f!=="world",x=r._isSatellite=h==="satellite",c=r._isConic=h.indexOf("conic")!==-1||h==="albers",T=r._isClipped=!!y.lonaxisSpan[h];if(a.visible===!1){var _=p.extendDeep({},r._template);_.showcoastlines=!1,_.showcountries=!1,_.showframe=!1,_.showlakes=!1,_.showland=!1,_.showocean=!1,_.showrivers=!1,_.showsubunits=!1,_.lonaxis&&(_.lonaxis.showgrid=!1),_.lataxis&&(_.lataxis.showgrid=!1),r._template=_}for(var w=m("visible"),k=0;k<n.length;k++){var L,A=n[k],I=[30,10][k];if(s)L=l[A+"Range"];else{var P=y[A+"Span"],S=(P[h]||P["*"])/2,E=m("projection.rotation."+A.substr(0,3),l.projRotate[k]);L=[E-S,E+S]}var D=m(A+".range",L);m(A+".tick0"),m(A+".dtick",I),m(A+".showgrid",!!w&&void 0)&&(m(A+".gridcolor"),m(A+".gridwidth"),m(A+".griddash")),r[A]._ax={type:"linear",_id:A.slice(0,3),_traceIndices:i,setScale:p.identity,c2l:p.identity,r2l:p.identity,autorange:!0,range:D.slice(),_m:1,_input:{}}}var R=r.lonaxis.range,H=r.lataxis.range,V=R[0],X=R[1];V>0&&X<0&&(X+=360);var $,G,W,te=(V+X)/2;if(!d){var N=s?l.projRotate:[te,0,0];$=m("projection.rotation.lon",N[0]),m("projection.rotation.lat",N[1]),m("projection.rotation.roll",N[2]),m("showcoastlines",!s&&w)&&(m("coastlinecolor"),m("coastlinewidth")),m("showocean",!!w&&void 0)&&m("oceancolor")}d?(G=-96.6,W=38.7):(G=s?te:$,W=(H[0]+H[1])/2),m("center.lon",G),m("center.lat",W),x&&(m("projection.tilt"),m("projection.distance")),c&&m("projection.parallels",l.projParallels||[0,60]),m("projection.scale"),m("showland",!!w&&void 0)&&m("landcolor"),m("showlakes",!!w&&void 0)&&m("lakecolor"),m("showrivers",!!w&&void 0)&&(m("rivercolor"),m("riverwidth")),m("showcountries",s&&f!=="usa"&&w)&&(m("countrycolor"),m("countrywidth")),(f==="usa"||f==="north america"&&u===50)&&(m("showsubunits",w),m("subunitcolor"),m("subunitwidth")),s||m("showframe",w)&&(m("framecolor"),m("framewidth")),m("bgcolor"),m("fitbounds")&&(delete r.projection.scale,s?(delete r.center.lon,delete r.center.lat):T?(delete r.center.lon,delete r.center.lat,delete r.projection.rotation.lon,delete r.projection.rotation.lat,delete r.lonaxis.range,delete r.lataxis.range):(delete r.center.lon,delete r.center.lat,delete r.projection.rotation.lon))}J.exports=function(a,r,m){g(a,r,m,{type:"geo",attributes:e,handleDefaults:t,fullData:m,partition:"y"})}},{"../../lib":515,"../get_data":602,"../subplot_defaults":641,"./constants":596,"./layout_attributes":599}],601:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../registry"),y=Math.PI/180,e=180/Math.PI,n={cursor:"pointer"},t={cursor:"auto"};function a(w,k){return p.behavior.zoom().translate(k.translate()).scale(k.scale())}function r(w,k,L){var A=w.id,I=w.graphDiv,P=I.layout,S=P[A],E=I._fullLayout,D=E[A],R={},H={};function V(X,$){R[A+"."+X]=g.nestedProperty(S,X).get(),b.call("_storeDirectGUIEdit",P,E._preGUI,R);var G=g.nestedProperty(D,X);G.get()!==$&&(G.set($),g.nestedProperty(S,X).set($),H[A+"."+X]=$)}L(V),V("projection.scale",k.scale()/w.fitScale),V("fitbounds",!1),I.emit("plotly_relayout",H)}function m(w,k){var L=a(0,k);function A(I){var P=k.invert(w.midPt);I("center.lon",P[0]),I("center.lat",P[1])}return L.on("zoomstart",function(){p.select(this).style(n)}).on("zoom",function(){k.scale(p.event.scale).translate(p.event.translate),w.render();var I=k.invert(w.midPt);w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/w.fitScale,"geo.center.lon":I[0],"geo.center.lat":I[1]})}).on("zoomend",function(){p.select(this).style(t),r(w,k,A)}),L}function o(w,k){var L,A,I,P,S,E,D,R,H,V=a(0,k);function X(G){return k.invert(G)}function $(G){var W=k.rotate(),te=k.invert(w.midPt);G("projection.rotation.lon",-W[0]),G("center.lon",te[0]),G("center.lat",te[1])}return V.on("zoomstart",function(){p.select(this).style(n),L=p.mouse(this),A=k.rotate(),I=k.translate(),P=A,S=X(L)}).on("zoom",function(){if(E=p.mouse(this),function(te){var N=X(te);if(!N)return!0;var B=k(N);return Math.abs(B[0]-te[0])>2||Math.abs(B[1]-te[1])>2}(L))return V.scale(k.scale()),void V.translate(k.translate());k.scale(p.event.scale),k.translate([I[0],p.event.translate[1]]),S?X(E)&&(R=X(E),D=[P[0]+(R[0]-S[0]),A[1],A[2]],k.rotate(D),P=D):S=X(L=E),H=!0,w.render();var G=k.rotate(),W=k.invert(w.midPt);w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/w.fitScale,"geo.center.lon":W[0],"geo.center.lat":W[1],"geo.projection.rotation.lon":-G[0]})}).on("zoomend",function(){p.select(this).style(t),H&&r(w,k,$)}),V}function i(w,k){var L;k.rotate(),k.scale();var A=a(0,k),I=function(V){for(var X=0,$=arguments.length,G=[];++X<$;)G.push(arguments[X]);var W=p.dispatch.apply(null,G);return W.of=function(te,N){return function(B){var U;try{U=B.sourceEvent=p.event,B.target=V,p.event=B,W[B.type].apply(te,N)}finally{p.event=U}}},W}(A,"zoomstart","zoom","zoomend"),P=0,S=A.on;function E(V){P++||V({type:"zoomstart"})}function D(V){V({type:"zoom"})}function R(V){--P||V({type:"zoomend"})}function H(V){var X=k.rotate();V("projection.rotation.lon",-X[0]),V("projection.rotation.lat",-X[1])}return A.on("zoomstart",function(){p.select(this).style(n);var V=p.mouse(this),X=k.rotate(),$=X,G=k.translate(),W=f(X);L=u(k,V),S.call(A,"zoom",function(){var te=p.mouse(this);if(k.scale(p.event.scale),L){if(u(k,te)){k.rotate(X).translate(G);var N=u(k,te),B=h(L,N),U=T(l(W,B)),ee=d(U,L,$);isFinite(ee[0])&&isFinite(ee[1])&&isFinite(ee[2])||(ee=$),k.rotate(ee),$=ee}}else L=u(k,V=te);D(I.of(this,arguments))}),E(I.of(this,arguments))}).on("zoomend",function(){p.select(this).style(t),S.call(A,"zoom",null),R(I.of(this,arguments)),r(w,k,H)}).on("zoom.redraw",function(){w.render();var V=k.rotate();w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/w.fitScale,"geo.projection.rotation.lon":-V[0],"geo.projection.rotation.lat":-V[1]})}),p.rebind(A,I,"on")}function u(w,k){var L=w.invert(k);return L&&isFinite(L[0])&&isFinite(L[1])&&function(A){var I=A[0]*y,P=A[1]*y,S=Math.cos(P);return[S*Math.cos(I),S*Math.sin(I),Math.sin(P)]}(L)}function f(w){var k=.5*w[0]*y,L=.5*w[1]*y,A=.5*w[2]*y,I=Math.sin(k),P=Math.cos(k),S=Math.sin(L),E=Math.cos(L),D=Math.sin(A),R=Math.cos(A);return[P*E*R+I*S*D,I*E*R-P*S*D,P*S*R+I*E*D,P*E*D-I*S*R]}function l(w,k){var L=w[0],A=w[1],I=w[2],P=w[3],S=k[0],E=k[1],D=k[2],R=k[3];return[L*S-A*E-I*D-P*R,L*E+A*S+I*R-P*D,L*D-A*R+I*S+P*E,L*R+A*D-I*E+P*S]}function h(w,k){if(w&&k){var L=function(S,E){return[S[1]*E[2]-S[2]*E[1],S[2]*E[0]-S[0]*E[2],S[0]*E[1]-S[1]*E[0]]}(w,k),A=Math.sqrt(_(L,L)),I=.5*Math.acos(Math.max(-1,Math.min(1,_(w,k)))),P=Math.sin(I)/A;return A&&[Math.cos(I),L[2]*P,-L[1]*P,L[0]*P]}}function d(w,k,L){var A=c(k,2,w[0]);A=c(A,1,w[1]),A=c(A,0,w[2]-L[2]);var I,P,S=k[0],E=k[1],D=k[2],R=A[0],H=A[1],V=A[2],X=Math.atan2(E,S)*e,$=Math.sqrt(S*S+E*E);Math.abs(H)>$?(P=(H>0?90:-90)-X,I=0):(P=Math.asin(H/$)*e-X,I=Math.sqrt($*$-H*H));var G=180-P-2*X,W=(Math.atan2(V,R)-Math.atan2(D,I))*e,te=(Math.atan2(V,R)-Math.atan2(D,-I))*e;return s(L[0],L[1],P,W)<=s(L[0],L[1],G,te)?[P,W,L[2]]:[G,te,L[2]]}function s(w,k,L,A){var I=x(L-w),P=x(A-k);return Math.sqrt(I*I+P*P)}function x(w){return(w%360+540)%360-180}function c(w,k,L){var A=L*y,I=w.slice(),P=k===0?1:0,S=k===2?1:2,E=Math.cos(A),D=Math.sin(A);return I[P]=w[P]*E-w[S]*D,I[S]=w[S]*E+w[P]*D,I}function T(w){return[Math.atan2(2*(w[0]*w[1]+w[2]*w[3]),1-2*(w[1]*w[1]+w[2]*w[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(w[0]*w[2]-w[3]*w[1]))))*e,Math.atan2(2*(w[0]*w[3]+w[1]*w[2]),1-2*(w[2]*w[2]+w[3]*w[3]))*e]}function _(w,k){for(var L=0,A=0,I=w.length;A<I;++A)L+=w[A]*k[A];return L}J.exports=function(w,k){var L=w.projection;return(k._isScoped?m:k._isClipped?i:o)(w,L)}},{"../../lib":515,"../../registry":647,"@plotly/d3":58}],602:[function(v,J,Z){var p=v("../registry"),g=v("./cartesian/constants").SUBPLOT_PATTERN;Z.getSubplotCalcData=function(b,y,e){var n=p.subplotsRegistry[y];if(!n)return[];for(var t=n.attr,a=[],r=0;r<b.length;r++){var m=b[r];m[0].trace[t]===e&&a.push(m)}return a},Z.getModuleCalcData=function(b,y){var e,n=[],t=[];if(!(e=typeof y=="string"?p.getModule(y).plot:typeof y=="function"?y:y.plot))return[n,b];for(var a=0;a<b.length;a++){var r=b[a],m=r[0].trace;m.visible===!0&&m._length!==0&&(m._module.plot===e?n.push(r):t.push(r))}return[n,t]},Z.getSubplotData=function(b,y,e){if(!p.subplotsRegistry[y])return[];var n,t,a,r=p.subplotsRegistry[y].attr,m=[];if(y==="gl2d"){var o=e.match(g);t="x"+o[1],a="y"+o[2]}for(var i=0;i<b.length;i++)n=b[i],y==="gl2d"&&p.traceIs(n,"gl2d")?n[r[0]]===t&&n[r[1]]===a&&m.push(n):n[r]===e&&m.push(n);return m}},{"../registry":647,"./cartesian/constants":573}],603:[function(v,J,Z){var p=v("mouse-change"),g=v("mouse-wheel"),b=v("mouse-event-offset"),y=v("../cartesian/constants"),e=v("has-passive-events");function n(t,a){this.element=t,this.plot=a,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}J.exports=function(t){var a=t.mouseContainer,r=t.glplot,m=new n(a,r);function o(){t.xaxis.autorange=!1,t.yaxis.autorange=!1}function i(u,f,l){var h,d,s=t.calcDataBox(),x=r.viewBox,c=m.lastPos[0],T=m.lastPos[1],_=y.MINDRAG*r.pixelRatio,w=y.MINZOOM*r.pixelRatio;function k(E,D,R){var H=Math.min(D,R),V=Math.max(D,R);H!==V?(s[E]=H,s[E+2]=V,m.dataBox=s,t.setRanges(s)):(t.selectBox.selectBox=[0,0,1,1],t.glplot.setDirty())}switch(f*=r.pixelRatio,l*=r.pixelRatio,l=x[3]-x[1]-l,t.fullLayout.dragmode){case"zoom":if(u){var L=f/(x[2]-x[0])*(s[2]-s[0])+s[0],A=l/(x[3]-x[1])*(s[3]-s[1])+s[1];m.boxInited||(m.boxStart[0]=L,m.boxStart[1]=A,m.dragStart[0]=f,m.dragStart[1]=l),m.boxEnd[0]=L,m.boxEnd[1]=A,m.boxInited=!0,m.boxEnabled||m.boxStart[0]===m.boxEnd[0]&&m.boxStart[1]===m.boxEnd[1]||(m.boxEnabled=!0);var I=Math.abs(m.dragStart[0]-f)<w,P=Math.abs(m.dragStart[1]-l)<w;if(!function(){for(var E=t.graphDiv._fullLayout._axisConstraintGroups,D=t.xaxis._id,R=t.yaxis._id,H=0;H<E.length;H++)if(E[H][D]!==-1){if(E[H][R]!==-1)return!0;break}return!1}()||I&&P)I&&(m.boxEnd[0]=m.boxStart[0]),P&&(m.boxEnd[1]=m.boxStart[1]);else{h=m.boxEnd[0]-m.boxStart[0],d=m.boxEnd[1]-m.boxStart[1];var S=(s[3]-s[1])/(s[2]-s[0]);Math.abs(h*S)>Math.abs(d)?(m.boxEnd[1]=m.boxStart[1]+Math.abs(h)*S*(d>=0?1:-1),m.boxEnd[1]<s[1]?(m.boxEnd[1]=s[1],m.boxEnd[0]=m.boxStart[0]+(s[1]-m.boxStart[1])/Math.abs(S)):m.boxEnd[1]>s[3]&&(m.boxEnd[1]=s[3],m.boxEnd[0]=m.boxStart[0]+(s[3]-m.boxStart[1])/Math.abs(S))):(m.boxEnd[0]=m.boxStart[0]+Math.abs(d)/S*(h>=0?1:-1),m.boxEnd[0]<s[0]?(m.boxEnd[0]=s[0],m.boxEnd[1]=m.boxStart[1]+(s[0]-m.boxStart[0])*Math.abs(S)):m.boxEnd[0]>s[2]&&(m.boxEnd[0]=s[2],m.boxEnd[1]=m.boxStart[1]+(s[2]-m.boxStart[0])*Math.abs(S)))}}else m.boxEnabled?(h=m.boxStart[0]!==m.boxEnd[0],d=m.boxStart[1]!==m.boxEnd[1],h||d?(h&&(k(0,m.boxStart[0],m.boxEnd[0]),t.xaxis.autorange=!1),d&&(k(1,m.boxStart[1],m.boxEnd[1]),t.yaxis.autorange=!1),t.relayoutCallback()):t.glplot.setDirty(),m.boxEnabled=!1,m.boxInited=!1):m.boxInited&&(m.boxInited=!1);break;case"pan":m.boxEnabled=!1,m.boxInited=!1,u?(m.panning||(m.dragStart[0]=f,m.dragStart[1]=l),Math.abs(m.dragStart[0]-f)<_&&(f=m.dragStart[0]),Math.abs(m.dragStart[1]-l)<_&&(l=m.dragStart[1]),h=(c-f)*(s[2]-s[0])/(r.viewBox[2]-r.viewBox[0]),d=(T-l)*(s[3]-s[1])/(r.viewBox[3]-r.viewBox[1]),s[0]+=h,s[2]+=h,s[1]+=d,s[3]+=d,t.setRanges(s),m.panning=!0,m.lastInputTime=Date.now(),o(),t.cameraChanged(),t.handleAnnotations()):m.panning&&(m.panning=!1,t.relayoutCallback())}m.lastPos[0]=f,m.lastPos[1]=l}return m.mouseListener=p(a,i),a.addEventListener("touchstart",function(u){var f=b(u.changedTouches[0],a);i(0,f[0],f[1]),i(1,f[0],f[1]),u.preventDefault()},!!e&&{passive:!1}),a.addEventListener("touchmove",function(u){u.preventDefault();var f=b(u.changedTouches[0],a);i(1,f[0],f[1]),u.preventDefault()},!!e&&{passive:!1}),a.addEventListener("touchend",function(u){i(0,m.lastPos[0],m.lastPos[1]),u.preventDefault()},!!e&&{passive:!1}),m.wheelListener=g(a,function(u,f){if(!t.scrollZoom)return!1;var l=t.calcDataBox(),h=r.viewBox,d=m.lastPos[0],s=m.lastPos[1],x=Math.exp(5*f/(h[3]-h[1])),c=d/(h[2]-h[0])*(l[2]-l[0])+l[0],T=s/(h[3]-h[1])*(l[3]-l[1])+l[1];return l[0]=(l[0]-c)*x+c,l[2]=(l[2]-c)*x+c,l[1]=(l[1]-T)*x+T,l[3]=(l[3]-T)*x+T,t.setRanges(l),m.lastInputTime=Date.now(),o(),t.cameraChanged(),t.handleAnnotations(),t.relayoutCallback(),!0},!0),m}},{"../cartesian/constants":573,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],604:[function(v,J,Z){var p=v("../cartesian/axes"),g=v("../../lib/str2rgbarray");function b(n){this.scene=n,this.gl=n.gl,this.pixelRatio=n.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var y=b.prototype,e=["xaxis","yaxis"];y.merge=function(n){var t,a,r,m,o,i,u,f,l,h,d;for(this.titleEnable=!1,this.backgroundColor=g(n.plot_bgcolor),h=0;h<2;++h){var s=(t=e[h]).charAt(0);for(r=(a=n[this.scene[t]._name]).title.text===this.scene.fullLayout._dfltTitle[s]?"":a.title.text,d=0;d<=2;d+=2)this.labelEnable[h+d]=!1,this.labels[h+d]=r,this.labelColor[h+d]=g(a.title.font.color),this.labelFont[h+d]=a.title.font.family,this.labelSize[h+d]=a.title.font.size,this.labelPad[h+d]=this.getLabelPad(t,a),this.tickEnable[h+d]=!1,this.tickColor[h+d]=g((a.tickfont||{}).color),this.tickAngle[h+d]=a.tickangle==="auto"?0:Math.PI*-a.tickangle/180,this.tickPad[h+d]=this.getTickPad(a),this.tickMarkLength[h+d]=0,this.tickMarkWidth[h+d]=a.tickwidth||0,this.tickMarkColor[h+d]=g(a.tickcolor),this.borderLineEnable[h+d]=!1,this.borderLineColor[h+d]=g(a.linecolor),this.borderLineWidth[h+d]=a.linewidth||0;u=this.hasSharedAxis(a),o=this.hasAxisInDfltPos(t,a)&&!u,i=this.hasAxisInAltrPos(t,a)&&!u,m=a.mirror||!1,f=u?String(m).indexOf("all")!==-1:!!m,l=u?m==="allticks":String(m).indexOf("ticks")!==-1,o?this.labelEnable[h]=!0:i&&(this.labelEnable[h+2]=!0),o?this.tickEnable[h]=a.showticklabels:i&&(this.tickEnable[h+2]=a.showticklabels),(o||f)&&(this.borderLineEnable[h]=a.showline),(i||f)&&(this.borderLineEnable[h+2]=a.showline),(o||l)&&(this.tickMarkLength[h]=this.getTickMarkLength(a)),(i||l)&&(this.tickMarkLength[h+2]=this.getTickMarkLength(a)),this.gridLineEnable[h]=a.showgrid,this.gridLineColor[h]=g(a.gridcolor),this.gridLineWidth[h]=a.gridwidth,this.zeroLineEnable[h]=a.zeroline,this.zeroLineColor[h]=g(a.zerolinecolor),this.zeroLineWidth[h]=a.zerolinewidth}},y.hasSharedAxis=function(n){var t=this.scene,a=t.fullLayout._subplots.gl2d;return p.findSubplotsWithAxis(a,n).indexOf(t.id)!==0},y.hasAxisInDfltPos=function(n,t){var a=t.side;return n==="xaxis"?a==="bottom":n==="yaxis"?a==="left":void 0},y.hasAxisInAltrPos=function(n,t){var a=t.side;return n==="xaxis"?a==="top":n==="yaxis"?a==="right":void 0},y.getLabelPad=function(n,t){var a=t.title.font.size,r=t.showticklabels;return n==="xaxis"?t.side==="top"?a*(1.5+(r?1:0))-10:a*(1.5+(r?.5:0))-10:n==="yaxis"?t.side==="right"?10+a*(1.5+(r?1:.5)):10+a*(1.5+(r?.5:0)):void 0},y.getTickPad=function(n){return n.ticks==="outside"?10+n.ticklen:15},y.getTickMarkLength=function(n){if(!n.ticks)return 0;var t=n.ticklen;return n.ticks==="inside"?-t:t},J.exports=function(n){return new b(n)}},{"../../lib/str2rgbarray":540,"../cartesian/axes":566}],605:[function(v,J,Z){var p=v("../../plot_api/edit_types").overrideAll,g=v("./scene2d"),b=v("../layout_attributes"),y=v("../../constants/xmlns_namespaces"),e=v("../cartesian/constants"),n=v("../cartesian"),t=v("../../components/fx/layout_attributes"),a=v("../get_data").getSubplotData;Z.name="gl2d",Z.attr=["xaxis","yaxis"],Z.idRoot=["x","y"],Z.idRegex=e.idRegex,Z.attrRegex=e.attrRegex,Z.attributes=v("../cartesian/attributes"),Z.supplyLayoutDefaults=function(r,m,o){m._has("cartesian")||n.supplyLayoutDefaults(r,m,o)},Z.layoutAttrOverrides=p(n.layoutAttributes,"plot","from-root"),Z.baseLayoutAttrOverrides=p({plot_bgcolor:b.plot_bgcolor,hoverlabel:t.hoverlabel},"plot","nested"),Z.plot=function(r){for(var m=r._fullLayout,o=r._fullData,i=m._subplots.gl2d,u=0;u<i.length;u++){var f=i[u],l=m._plots[f],h=a(o,"gl2d",f),d=l._scene2d;d===void 0&&(d=new g({id:f,graphDiv:r,container:r.querySelector(".gl-container"),staticPlot:r._context.staticPlot,plotGlPixelRatio:r._context.plotGlPixelRatio},m),l._scene2d=d),d.plot(h,r.calcdata,m,r.layout)}},Z.clean=function(r,m,o,i){for(var u=i._subplots.gl2d||[],f=0;f<u.length;f++){var l=u[f],h=i._plots[l];if(h._scene2d){var d=a(r,"gl2d",l);d.length===0&&(h._scene2d.destroy(),delete i._plots[l])}}n.clean.apply(this,arguments)},Z.drawFramework=function(r){r._context.staticPlot||n.drawFramework(r)},Z.toSVG=function(r){for(var m=r._fullLayout,o=m._subplots.gl2d,i=0;i<o.length;i++){var u=m._plots[o[i]]._scene2d,f=u.toImage("png");m._glimages.append("svg:image").attr({xmlns:y.svg,"xlink:href":f,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),u.destroy()}},Z.updateFx=function(r){for(var m=r._fullLayout,o=m._subplots.gl2d,i=0;i<o.length;i++)m._plots[o[i]]._scene2d.updateFx(m.dragmode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../plot_api/edit_types":548,"../cartesian":578,"../cartesian/attributes":564,"../cartesian/constants":573,"../get_data":602,"../layout_attributes":619,"./scene2d":606}],606:[function(v,J,Z){var p,g,b=v("../../registry"),y=v("../../plots/cartesian/axes"),e=v("../../components/fx"),n=v("../../../stackgl_modules").gl_plot2d,t=v("../../../stackgl_modules").gl_spikes2d,a=v("../../../stackgl_modules").gl_select_box,r=v("webgl-context"),m=v("./convert"),o=v("./camera"),i=v("../../lib/show_no_webgl_msg"),u=v("../cartesian/constraints"),f=u.enforce,l=u.clean,h=v("../cartesian/autorange").doAutoRange,d=v("../../components/dragelement/helpers"),s=d.drawMode,x=d.selectMode,c=["xaxis","yaxis"],T=v("../cartesian/constants").SUBPLOT_PATTERN;function _(k,L){this.container=k.container,this.graphDiv=k.graphDiv,this.pixelRatio=k.plotGlPixelRatio||window.devicePixelRatio,this.id=k.id,this.staticPlot=!!k.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(L),this.makeFramework(),this.stopped||(this.glplotOptions=m(this),this.glplotOptions.merge(L),this.glplot=n(this.glplotOptions),this.camera=o(this),this.traces={},this.spikes=t(this.glplot),this.selectBox=a(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}J.exports=_;var w=_.prototype;w.makeFramework=function(){if(this.staticPlot){if(!(g||(p=document.createElement("canvas"),g=r({canvas:p,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=p,this.gl=g}else{var k=this.container.querySelector(".gl-canvas-focus"),L=r({canvas:k,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!L)return i(this),void(this.stopped=!0);this.canvas=k,this.gl=L}var A=this.canvas;A.style.width="100%",A.style.height="100%",A.style.position="absolute",A.style.top="0px",A.style.left="0px",A.style["pointer-events"]="none",this.updateSize(A);var I=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");I.style.position="absolute",I.style.top=I.style.left="0px",I.style.width=I.style.height="100%",I.style["z-index"]=20,I.style["pointer-events"]="none";var P=this.mouseContainer=document.createElement("div");P.style.position="absolute",P.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var S=this.container;S.appendChild(I),S.appendChild(P);var E=this;P.addEventListener("mouseout",function(){E.isMouseOver=!1,E.unhover()}),P.addEventListener("mouseover",function(){E.isMouseOver=!0})},w.toImage=function(k){k||(k="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(p),this.updateSize(this.canvas);var L=this.glplot.gl,A=L.drawingBufferWidth,I=L.drawingBufferHeight;L.clearColor(1,1,1,0),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(A*I*4);L.readPixels(0,0,A,I,L.RGBA,L.UNSIGNED_BYTE,P);for(var S=0,E=I-1;S<E;++S,--E)for(var D=0;D<A;++D)for(var R=0;R<4;++R){var H=P[4*(A*S+D)+R];P[4*(A*S+D)+R]=P[4*(A*E+D)+R],P[4*(A*E+D)+R]=H}var V=document.createElement("canvas");V.width=A,V.height=I;var X,$=V.getContext("2d",{willReadFrequently:!0}),G=$.createImageData(A,I);switch(G.data.set(P),$.putImageData(G,0,0),k){case"jpeg":X=V.toDataURL("image/jpeg");break;case"webp":X=V.toDataURL("image/webp");break;default:X=V.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(p),X},w.updateSize=function(k){k||(k=this.canvas);var L=this.pixelRatio,A=this.fullLayout,I=A.width,P=A.height,S=0|Math.ceil(L*I),E=0|Math.ceil(L*P);return k.width===S&&k.height===E||(k.width=S,k.height=E),k},w.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var k=[y.calcTicks(this.xaxis),y.calcTicks(this.yaxis)],L=0;L<2;++L)for(var A=0;A<k[L].length;++A)k[L][A].text=k[L][A].text+"";return k},w.updateRefs=function(k){this.fullLayout=k;var L=this.id.match(T),A="xaxis"+L[1],I="yaxis"+L[2];this.xaxis=this.fullLayout[A],this.yaxis=this.fullLayout[I]},w.relayoutCallback=function(){var k=this.graphDiv,L=this.xaxis,A=this.yaxis,I=k.layout,P={},S=P[L._name+".range"]=L.range.slice(),E=P[A._name+".range"]=A.range.slice();P[L._name+".autorange"]=L.autorange,P[A._name+".autorange"]=A.autorange,b.call("_storeDirectGUIEdit",k.layout,k._fullLayout._preGUI,P);var D=I[L._name];D.range=S,D.autorange=L.autorange;var R=I[A._name];R.range=E,R.autorange=A.autorange,P.lastInputTime=this.camera.lastInputTime,k.emit("plotly_relayout",P)},w.cameraChanged=function(){var k=this.camera;this.glplot.setDataBox(this.calcDataBox());var L=this.computeTickMarks();(function(A,I){for(var P=0;P<2;++P){var S=A[P],E=I[P];if(S.length!==E.length)return!0;for(var D=0;D<S.length;++D)if(S[D].x!==E[D].x)return!0}return!1})(L,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=L,this.glplotOptions.dataBox=k.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},w.handleAnnotations=function(){for(var k=this.graphDiv,L=this.fullLayout.annotations,A=0;A<L.length;A++){var I=L[A];I.xref===this.xaxis._id&&I.yref===this.yaxis._id&&b.getComponentMethod("annotations","drawOne")(k,A)}},w.destroy=function(){if(this.glplot){var k=this.traces;k&&Object.keys(k).map(function(L){k[L].dispose(),delete k[L]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},w.plot=function(k,L,A){var I=this.glplot;this.updateRefs(A),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(k,L),this.updateFx(A.dragmode);var P=A.width,S=A.height;this.updateSize(this.canvas);var E=this.glplotOptions;E.merge(A),E.screenBox=[0,0,P,S];var D={_fullLayout:{_axisConstraintGroups:A._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:A._size}};l(D,this.xaxis),l(D,this.yaxis);var R,H,V=A._size,X=this.xaxis.domain,$=this.yaxis.domain;for(E.viewBox=[V.l+X[0]*V.w,V.b+$[0]*V.h,P-V.r-(1-X[1])*V.w,S-V.t-(1-$[1])*V.h],this.mouseContainer.style.width=V.w*(X[1]-X[0])+"px",this.mouseContainer.style.height=V.h*($[1]-$[0])+"px",this.mouseContainer.height=V.h*($[1]-$[0]),this.mouseContainer.style.left=V.l+X[0]*V.w+"px",this.mouseContainer.style.top=V.t+(1-$[1])*V.h+"px",H=0;H<2;++H)(R=this[c[H]])._length=E.viewBox[H+2]-E.viewBox[H],h(this.graphDiv,R),R.setScale();f(D),E.ticks=this.computeTickMarks(),E.dataBox=this.calcDataBox(),E.merge(A),I.update(E),this.glplot.draw()},w.calcDataBox=function(){var k=this.xaxis,L=this.yaxis,A=k.range,I=L.range,P=k.r2l,S=L.r2l;return[P(A[0]),S(I[0]),P(A[1]),S(I[1])]},w.setRanges=function(k){var L=this.xaxis,A=this.yaxis,I=L.l2r,P=A.l2r;L.range=[I(k[0]),I(k[2])],A.range=[P(k[1]),P(k[3])]},w.updateTraces=function(k,L){var A,I,P,S=Object.keys(this.traces);this.fullData=k;e:for(A=0;A<S.length;A++){var E=S[A],D=this.traces[E];for(I=0;I<k.length;I++)if((P=k[I]).uid===E&&P.type===D.type)continue e;D.dispose(),delete this.traces[E]}for(A=0;A<k.length;A++){P=k[A];var R=L[A],H=this.traces[P.uid];H?H.update(P,R):(H=P._module.plot(this,P,R),this.traces[P.uid]=H)}this.glplot.objects.sort(function(V,X){return V._trace.index-X._trace.index})},w.updateFx=function(k){x(k)||s(k)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor=k==="pan"?"move":k==="zoom"?"crosshair":null},w.emitPointAction=function(k,L){for(var A,I=k.trace.uid,P=k.pointIndex,S=0;S<this.fullData.length;S++)this.fullData[S].uid===I&&(A=this.fullData[S]);var E={x:k.traceCoord[0],y:k.traceCoord[1],curveNumber:A.index,pointNumber:P,data:A._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};e.appendArrayPointValue(E,A,P),this.graphDiv.emit(L,{points:[E]})},w.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var k=this.glplot,L=this.camera,A=L.mouseListener,I=this.lastButtonState===1&&A.buttons===0,P=this.fullLayout;this.lastButtonState=A.buttons,this.cameraChanged();var S,E=A.x*k.pixelRatio,D=this.canvas.height-k.pixelRatio*A.y;if(L.boxEnabled&&P.dragmode==="zoom"){this.selectBox.enabled=!0;for(var R=this.selectBox.selectBox=[Math.min(L.boxStart[0],L.boxEnd[0]),Math.min(L.boxStart[1],L.boxEnd[1]),Math.max(L.boxStart[0],L.boxEnd[0]),Math.max(L.boxStart[1],L.boxEnd[1])],H=0;H<2;H++)L.boxStart[H]===L.boxEnd[H]&&(R[H]=k.dataBox[H],R[H+2]=k.dataBox[H+2]);k.setDirty()}else if(!L.panning&&this.isMouseOver){this.selectBox.enabled=!1;var V=P._size,X=this.xaxis.domain,$=this.yaxis.domain,G=(S=k.pick(E/k.pixelRatio+V.l+X[0]*V.w,D/k.pixelRatio-(V.t+(1-$[1])*V.h)))&&S.object._trace.handlePick(S);if(G&&I&&this.emitPointAction(G,"plotly_click"),S&&S.object._trace.hoverinfo!=="skip"&&P.hovermode&&G&&(!this.lastPickResult||this.lastPickResult.traceUid!==G.trace.uid||this.lastPickResult.dataCoord[0]!==G.dataCoord[0]||this.lastPickResult.dataCoord[1]!==G.dataCoord[1])){var W=G;this.lastPickResult={traceUid:G.trace?G.trace.uid:null,dataCoord:G.dataCoord.slice()},this.spikes.update({center:S.dataCoord}),W.screenCoord=[((k.viewBox[2]-k.viewBox[0])*(S.dataCoord[0]-k.dataBox[0])/(k.dataBox[2]-k.dataBox[0])+k.viewBox[0])/k.pixelRatio,(this.canvas.height-(k.viewBox[3]-k.viewBox[1])*(S.dataCoord[1]-k.dataBox[1])/(k.dataBox[3]-k.dataBox[1])-k.viewBox[1])/k.pixelRatio],this.emitPointAction(G,"plotly_hover");var te=this.fullData[W.trace.index]||{},N=W.pointIndex,B=e.castHoverinfo(te,P,N);if(B&&B!=="all"){var U=B.split("+");U.indexOf("x")===-1&&(W.traceCoord[0]=void 0),U.indexOf("y")===-1&&(W.traceCoord[1]=void 0),U.indexOf("z")===-1&&(W.traceCoord[2]=void 0),U.indexOf("text")===-1&&(W.textLabel=void 0),U.indexOf("name")===-1&&(W.name=void 0)}e.loneHover({x:W.screenCoord[0],y:W.screenCoord[1],xLabel:this.hoverFormatter("xaxis",W.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",W.traceCoord[1]),zLabel:W.traceCoord[2],text:W.textLabel,name:W.name,color:e.castHoverOption(te,N,"bgcolor")||W.color,borderColor:e.castHoverOption(te,N,"bordercolor"),fontFamily:e.castHoverOption(te,N,"font.family"),fontSize:e.castHoverOption(te,N,"font.size"),fontColor:e.castHoverOption(te,N,"font.color"),nameLength:e.castHoverOption(te,N,"namelength"),textAlign:e.castHoverOption(te,N,"align")},{container:this.svgContainer,gd:this.graphDiv})}}S||this.unhover(),k.draw()}},w.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))},w.hoverFormatter=function(k,L){if(L!==void 0){var A=this[k];return y.tickText(A,A.c2l(L),"hover").text}}},{"../../../stackgl_modules":1133,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../lib/show_no_webgl_msg":537,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/constants":573,"../cartesian/constraints":574,"./camera":603,"./convert":604,"webgl-context":332}],607:[function(v,J,Z){var p=v("../../plot_api/edit_types").overrideAll,g=v("../../components/fx/layout_attributes"),b=v("./scene"),y=v("../get_data").getSubplotData,e=v("../../lib"),n=v("../../constants/xmlns_namespaces");Z.name="gl3d",Z.attr="scene",Z.idRoot="scene",Z.idRegex=Z.attrRegex=e.counterRegex("scene"),Z.attributes=v("./layout/attributes"),Z.layoutAttributes=v("./layout/layout_attributes"),Z.baseLayoutAttrOverrides=p({hoverlabel:g.hoverlabel},"plot","nested"),Z.supplyLayoutDefaults=v("./layout/defaults"),Z.plot=function(t){for(var a=t._fullLayout,r=t._fullData,m=a._subplots.gl3d,o=0;o<m.length;o++){var i=m[o],u=y(r,"gl3d",i),f=a[i],l=f.camera,h=f._scene;h||(h=new b({id:i,graphDiv:t,container:t.querySelector(".gl-container"),staticPlot:t._context.staticPlot,plotGlPixelRatio:t._context.plotGlPixelRatio,camera:l},a),f._scene=h),h.viewInitial||(h.viewInitial={up:{x:l.up.x,y:l.up.y,z:l.up.z},eye:{x:l.eye.x,y:l.eye.y,z:l.eye.z},center:{x:l.center.x,y:l.center.y,z:l.center.z}}),h.plot(u,a,t.layout)}},Z.clean=function(t,a,r,m){for(var o=m._subplots.gl3d||[],i=0;i<o.length;i++){var u=o[i];!a[u]&&m[u]._scene&&(m[u]._scene.destroy(),m._infolayer&&m._infolayer.selectAll(".annotation-"+u).remove())}},Z.toSVG=function(t){for(var a=t._fullLayout,r=a._subplots.gl3d,m=a._size,o=0;o<r.length;o++){var i=a[r[o]],u=i.domain,f=i._scene,l=f.toImage("png");a._glimages.append("svg:image").attr({xmlns:n.svg,"xlink:href":l,x:m.l+m.w*u.x[0],y:m.t+m.h*(1-u.y[1]),width:m.w*(u.x[1]-u.x[0]),height:m.h*(u.y[1]-u.y[0]),preserveAspectRatio:"none"}),f.destroy()}},Z.cleanId=function(t){if(t.match(/^scene[0-9]*$/)){var a=t.substr(5);return a==="1"&&(a=""),"scene"+a}},Z.updateFx=function(t){for(var a=t._fullLayout,r=a._subplots.gl3d,m=0;m<r.length;m++)a[r[m]]._scene.updateFx(a.dragmode,a.hovermode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../plot_api/edit_types":548,"../get_data":602,"./layout/attributes":608,"./layout/defaults":612,"./layout/layout_attributes":613,"./scene":617}],608:[function(v,J,Z){J.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],609:[function(v,J,Z){var p=v("../../../components/color"),g=v("../../cartesian/layout_attributes"),b=v("../../../lib/extend").extendFlat,y=v("../../../plot_api/edit_types").overrideAll;J.exports=y({visible:g.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:p.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:g.color,categoryorder:g.categoryorder,categoryarray:g.categoryarray,title:{text:g.title.text,font:g.title.font},type:b({},g.type,{values:["-","linear","log","date","category"]}),autotypenumbers:g.autotypenumbers,autorange:g.autorange,rangemode:g.rangemode,range:b({},g.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:g.ticks,mirror:g.mirror,ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,showticklabels:g.showticklabels,tickfont:g.tickfont,tickangle:g.tickangle,tickprefix:g.tickprefix,showtickprefix:g.showtickprefix,ticksuffix:g.ticksuffix,showticksuffix:g.showticksuffix,showexponent:g.showexponent,exponentformat:g.exponentformat,minexponent:g.minexponent,separatethousands:g.separatethousands,tickformat:g.tickformat,tickformatstops:g.tickformatstops,hoverformat:g.hoverformat,showline:g.showline,linecolor:g.linecolor,linewidth:g.linewidth,showgrid:g.showgrid,gridcolor:b({},g.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:g.gridwidth,zeroline:g.zeroline,zerolinecolor:g.zerolinecolor,zerolinewidth:g.zerolinewidth,_deprecated:{title:g._deprecated.title,titlefont:g._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":367,"../../../lib/extend":505,"../../../plot_api/edit_types":548,"../../cartesian/layout_attributes":579}],610:[function(v,J,Z){var p=v("tinycolor2").mix,g=v("../../../lib"),b=v("../../../plot_api/plot_template"),y=v("./axis_attributes"),e=v("../../cartesian/type_defaults"),n=v("../../cartesian/axis_defaults"),t=["xaxis","yaxis","zaxis"];J.exports=function(a,r,m){var o,i;function u(h,d){return g.coerce(o,i,y,h,d)}for(var f=0;f<t.length;f++){var l=t[f];o=a[l]||{},(i=b.newContainer(r,l))._id=l[0]+m.scene,i._name=l,e(o,i,u,m),n(o,i,u,{font:m.font,letter:l[0],data:m.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:m.bgColor,calendar:m.calendar},m.fullLayout),u("gridcolor",p(i.color,m.bgColor,13600/187).toRgbString()),u("title.text",l[0]),i.setScale=g.noop,u("showspikes")&&(u("spikesides"),u("spikethickness"),u("spikecolor",i.color)),u("showaxeslabels"),u("showbackground")&&u("backgroundcolor")}}},{"../../../lib":515,"../../../plot_api/plot_template":555,"../../cartesian/axis_defaults":568,"../../cartesian/type_defaults":591,"./axis_attributes":609,tinycolor2:313}],611:[function(v,J,Z){var p=v("../../../lib/str2rgbarray"),g=v("../../../lib"),b=["xaxis","yaxis","zaxis"];function y(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}y.prototype.merge=function(e,n){for(var t=0;t<3;++t){var a=n[b[t]];a.visible?(this.labels[t]=e._meta?g.templateString(a.title.text,e._meta):a.title.text,"font"in a.title&&(a.title.font.color&&(this.labelColor[t]=p(a.title.font.color)),a.title.font.family&&(this.labelFont[t]=a.title.font.family),a.title.font.size&&(this.labelSize[t]=a.title.font.size)),"showline"in a&&(this.lineEnable[t]=a.showline),"linecolor"in a&&(this.lineColor[t]=p(a.linecolor)),"linewidth"in a&&(this.lineWidth[t]=a.linewidth),"showgrid"in a&&(this.gridEnable[t]=a.showgrid),"gridcolor"in a&&(this.gridColor[t]=p(a.gridcolor)),"gridwidth"in a&&(this.gridWidth[t]=a.gridwidth),a.type==="log"?this.zeroEnable[t]=!1:"zeroline"in a&&(this.zeroEnable[t]=a.zeroline),"zerolinecolor"in a&&(this.zeroLineColor[t]=p(a.zerolinecolor)),"zerolinewidth"in a&&(this.zeroLineWidth[t]=a.zerolinewidth),"ticks"in a&&a.ticks?this.lineTickEnable[t]=!0:this.lineTickEnable[t]=!1,"ticklen"in a&&(this.lineTickLength[t]=this._defaultLineTickLength[t]=a.ticklen),"tickcolor"in a&&(this.lineTickColor[t]=p(a.tickcolor)),"tickwidth"in a&&(this.lineTickWidth[t]=a.tickwidth),"tickangle"in a&&(this.tickAngle[t]=a.tickangle==="auto"?-3600:Math.PI*-a.tickangle/180),"showticklabels"in a&&(this.tickEnable[t]=a.showticklabels),"tickfont"in a&&(a.tickfont.color&&(this.tickColor[t]=p(a.tickfont.color)),a.tickfont.family&&(this.tickFont[t]=a.tickfont.family),a.tickfont.size&&(this.tickSize[t]=a.tickfont.size)),"mirror"in a?["ticks","all","allticks"].indexOf(a.mirror)!==-1?(this.lineTickMirror[t]=!0,this.lineMirror[t]=!0):a.mirror===!0?(this.lineTickMirror[t]=!1,this.lineMirror[t]=!0):(this.lineTickMirror[t]=!1,this.lineMirror[t]=!1):this.lineMirror[t]=!1,"showbackground"in a&&a.showbackground!==!1?(this.backgroundEnable[t]=!0,this.backgroundColor[t]=p(a.backgroundcolor)):this.backgroundEnable[t]=!1):(this.tickEnable[t]=!1,this.labelEnable[t]=!1,this.lineEnable[t]=!1,this.lineTickEnable[t]=!1,this.gridEnable[t]=!1,this.zeroEnable[t]=!1,this.backgroundEnable[t]=!1)}},J.exports=function(e,n){var t=new y;return t.merge(e,n),t}},{"../../../lib":515,"../../../lib/str2rgbarray":540}],612:[function(v,J,Z){var p=v("../../../lib"),g=v("../../../components/color"),b=v("../../../registry"),y=v("../../subplot_defaults"),e=v("./axis_defaults"),n=v("./layout_attributes"),t=v("../../get_data").getSubplotData;function a(r,m,o,i){for(var u=o("bgcolor"),f=g.combine(u,i.paper_bgcolor),l=["up","center","eye"],h=0;h<l.length;h++)o("camera."+l[h]+".x"),o("camera."+l[h]+".y"),o("camera."+l[h]+".z");o("camera.projection.type");var d=!!o("aspectratio.x")&&!!o("aspectratio.y")&&!!o("aspectratio.z"),s=o("aspectmode",d?"manual":"auto");d||(r.aspectratio=m.aspectratio={x:1,y:1,z:1},s==="manual"&&(m.aspectmode="auto"),r.aspectmode=m.aspectmode);var x=t(i.fullData,"gl3d",i.id);e(r,m,{font:i.font,scene:i.id,data:x,bgColor:f,calendar:i.calendar,autotypenumbersDflt:i.autotypenumbersDflt,fullLayout:i.fullLayout}),b.getComponentMethod("annotations3d","handleDefaults")(r,m,i);var c=i.getDfltFromLayout("dragmode");if(c!==!1&&!c)if(c="orbit",r.camera&&r.camera.up){var T=r.camera.up.x,_=r.camera.up.y,w=r.camera.up.z;w!==0&&(T&&_&&w?w/Math.sqrt(T*T+_*_+w*w)>.999&&(c="turntable"):c="turntable")}else c="turntable";o("dragmode",c),o("hovermode",i.getDfltFromLayout("hovermode"))}J.exports=function(r,m,o){var i=m._basePlotModules.length>1;y(r,m,o,{type:"gl3d",attributes:n,handleDefaults:a,fullLayout:m,font:m.font,fullData:o,getDfltFromLayout:function(u){if(!i)return p.validate(r[u],n[u])?r[u]:void 0},autotypenumbersDflt:m.autotypenumbers,paper_bgcolor:m.paper_bgcolor,calendar:m.calendar})}},{"../../../components/color":367,"../../../lib":515,"../../../registry":647,"../../get_data":602,"../../subplot_defaults":641,"./axis_defaults":610,"./layout_attributes":613}],613:[function(v,J,Z){var p=v("./axis_attributes"),g=v("../../domain").attributes,b=v("../../../lib/extend").extendFlat,y=v("../../../lib").counterRegex;function e(n,t,a){return{x:{valType:"number",dflt:n,editType:"camera"},y:{valType:"number",dflt:t,editType:"camera"},z:{valType:"number",dflt:a,editType:"camera"},editType:"camera"}}J.exports={_arrayAttrRegexps:[y("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:b(e(0,0,1),{}),center:b(e(0,0,0),{}),eye:b(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:g({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:p,yaxis:p,zaxis:p,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":515,"../../../lib/extend":505,"../../domain":593,"./axis_attributes":609}],614:[function(v,J,Z){var p=v("../../../lib/str2rgbarray"),g=["xaxis","yaxis","zaxis"];function b(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}b.prototype.merge=function(y){for(var e=0;e<3;++e){var n=y[g[e]];n.visible?(this.enabled[e]=n.showspikes,this.colors[e]=p(n.spikecolor),this.drawSides[e]=n.spikesides,this.lineWidth[e]=n.spikethickness):(this.enabled[e]=!1,this.drawSides[e]=!1)}},J.exports=function(y){var e=new b;return e.merge(y),e}},{"../../../lib/str2rgbarray":540}],615:[function(v,J,Z){J.exports=function(e){for(var n=e.axesOptions,t=e.glplot.axesPixels,a=e.fullSceneLayout,r=[[],[],[]],m=0;m<3;++m){var o=a[b[m]];if(o._length=(t[m].hi-t[m].lo)*t[m].pixelsPerDataUnit/e.dataScale[m],Math.abs(o._length)===1/0||isNaN(o._length))r[m]=[];else{o._input_range=o.range.slice(),o.range[0]=t[m].lo/e.dataScale[m],o.range[1]=t[m].hi/e.dataScale[m],o._m=1/(e.dataScale[m]*t[m].pixelsPerDataUnit),o.range[0]===o.range[1]&&(o.range[0]-=1,o.range[1]+=1);var i=o.tickmode;if(o.tickmode==="auto"){o.tickmode="linear";var u=o.nticks||g.constrain(o._length/40,4,9);p.autoTicks(o,Math.abs(o.range[1]-o.range[0])/u)}for(var f=p.calcTicks(o,{msUTC:!0}),l=0;l<f.length;++l)f[l].x=f[l].x*e.dataScale[m],o.type==="date"&&(f[l].text=f[l].text.replace(/\<br\>/g," "));r[m]=f,o.tickmode=i}}for(n.ticks=r,m=0;m<3;++m)for(y[m]=.5*(e.glplot.bounds[0][m]+e.glplot.bounds[1][m]),l=0;l<2;++l)n.bounds[l][m]=e.glplot.bounds[l][m];e.contourLevels=function(h){for(var d=new Array(3),s=0;s<3;++s){for(var x=h[s],c=new Array(x.length),T=0;T<x.length;++T)c[T]=x[T].x;d[s]=c}return d}(r)};var p=v("../../cartesian/axes"),g=v("../../../lib"),b=["xaxis","yaxis","zaxis"],y=[0,0,0]},{"../../../lib":515,"../../cartesian/axes":566}],616:[function(v,J,Z){function p(g,b){var y,e,n=[0,0,0,0];for(y=0;y<4;++y)for(e=0;e<4;++e)n[e]+=g[4*y+e]*b[y];return n}J.exports=function(g,b){return p(g.projection,p(g.view,p(g.model,[b[0],b[1],b[2],1])))}},{}],617:[function(v,J,Z){var p,g,b=v("../../../stackgl_modules").gl_plot3d,y=b.createCamera,e=b.createScene,n=v("webgl-context"),t=v("has-passive-events"),a=v("../../registry"),r=v("../../lib"),m=r.preserveDrawingBuffer(),o=v("../../plots/cartesian/axes"),i=v("../../components/fx"),u=v("../../lib/str2rgbarray"),f=v("../../lib/show_no_webgl_msg"),l=v("./project"),h=v("./layout/convert"),d=v("./layout/spikes"),s=v("./layout/tick_marks");function x(k,L){var A=document.createElement("div"),I=k.container;this.graphDiv=k.graphDiv;var P=document.createElementNS("http://www.w3.org/2000/svg","svg");P.style.position="absolute",P.style.top=P.style.left="0px",P.style.width=P.style.height="100%",P.style["z-index"]=20,P.style["pointer-events"]="none",A.appendChild(P),this.svgContainer=P,A.id=k.id,A.style.position="absolute",A.style.top=A.style.left="0px",A.style.width=A.style.height="100%",I.appendChild(A),this.fullLayout=L,this.id=k.id||"scene",this.fullSceneLayout=L[this.id],this.plotArgs=[[],{},{}],this.axesOptions=h(L,L[this.id]),this.spikeOptions=d(L[this.id]),this.container=A,this.staticMode=!!k.staticPlot,this.pixelRatio=this.pixelRatio||k.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=a.getComponentMethod("annotations3d","convert"),this.drawAnnotations=a.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var c=x.prototype;c.prepareOptions=function(){var k={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:m,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(g||(p=document.createElement("canvas"),g=n({canvas:p,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");k.gl=g,k.canvas=p}return k};var T=!0;c.tryCreatePlot=function(){var k=this.prepareOptions(),L=!0;try{this.glplot=e(k)}catch{if(this.staticMode||!T||m)L=!1;else{r.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{m=k.glOptions.preserveDrawingBuffer=!0,this.glplot=e(k)}catch{m=k.glOptions.preserveDrawingBuffer=!1,L=!1}}}return T=!1,L},c.initializeGLCamera=function(){var k=this.fullSceneLayout.camera,L=k.projection.type==="orthographic";this.camera=y(this.container,{center:[k.center.x,k.center.y,k.center.z],eye:[k.eye.x,k.eye.y,k.eye.z],up:[k.up.x,k.up.y,k.up.z],_ortho:L,zoomMin:.01,zoomMax:100,mode:"orbit"})},c.initializeGLPlot=function(){var k=this;if(k.initializeGLCamera(),!k.tryCreatePlot())return f(k);k.traces={},k.make4thDimension();var L=k.graphDiv,A=L.layout,I=function(){var S={};return k.isCameraChanged(A)&&(S[k.id+".camera"]=k.getCamera()),k.isAspectChanged(A)&&(S[k.id+".aspectratio"]=k.glplot.getAspectratio(),A[k.id].aspectmode!=="manual"&&(k.fullSceneLayout.aspectmode=A[k.id].aspectmode=S[k.id+".aspectmode"]="manual")),S},P=function(S){if(S.fullSceneLayout.dragmode!==!1){var E=I();S.saveLayout(A),S.graphDiv.emit("plotly_relayout",E)}};return k.glplot.canvas&&(k.glplot.canvas.addEventListener("mouseup",function(){P(k)}),k.glplot.canvas.addEventListener("wheel",function(S){if(L._context._scrollZoom.gl3d){if(k.camera._ortho){var E=S.deltaX>S.deltaY?1.1:.9090909090909091,D=k.glplot.getAspectratio();k.glplot.setAspectratio({x:E*D.x,y:E*D.y,z:E*D.z})}P(k)}},!!t&&{passive:!1}),k.glplot.canvas.addEventListener("mousemove",function(){if(k.fullSceneLayout.dragmode!==!1&&k.camera.mouseListener.buttons!==0){var S=I();k.graphDiv.emit("plotly_relayouting",S)}}),k.staticMode||k.glplot.canvas.addEventListener("webglcontextlost",function(S){L&&L.emit&&L.emit("plotly_webglcontextlost",{event:S,layer:k.id})},!1)),k.glplot.oncontextloss=function(){k.recoverContext()},k.glplot.onrender=function(){k.render()},!0},c.render=function(){var k,L=this,A=L.graphDiv,I=L.svgContainer,P=L.container.getBoundingClientRect();A._fullLayout._calcInverseTransform(A);var S=A._fullLayout._invScaleX,E=A._fullLayout._invScaleY,D=P.width*S,R=P.height*E;I.setAttributeNS(null,"viewBox","0 0 "+D+" "+R),I.setAttributeNS(null,"width",D),I.setAttributeNS(null,"height",R),s(L),L.glplot.axes.update(L.axesOptions);for(var H=Object.keys(L.traces),V=null,X=L.glplot.selection,$=0;$<H.length;++$)(k=L.traces[H[$]]).data.hoverinfo!=="skip"&&k.handlePick(X)&&(V=k),k.setContourLevels&&k.setContourLevels();function G(oe,de,se){var me=L.fullSceneLayout[oe+"axis"];return me.type!=="log"&&(de=me.d2l(de)),o.hoverLabelText(me,de,se)}if(V!==null){var W=l(L.glplot.cameraParams,X.dataCoordinate);k=V.data;var te,N=A._fullData[k.index],B=X.index,U={xLabel:G("x",X.traceCoordinate[0],k.xhoverformat),yLabel:G("y",X.traceCoordinate[1],k.yhoverformat),zLabel:G("z",X.traceCoordinate[2],k.zhoverformat)},ee=i.castHoverinfo(N,L.fullLayout,B),j=(ee||"").split("+"),Q=ee&&ee==="all";N.hovertemplate||Q||(j.indexOf("x")===-1&&(U.xLabel=void 0),j.indexOf("y")===-1&&(U.yLabel=void 0),j.indexOf("z")===-1&&(U.zLabel=void 0),j.indexOf("text")===-1&&(X.textLabel=void 0),j.indexOf("name")===-1&&(V.name=void 0));var K=[];k.type==="cone"||k.type==="streamtube"?(U.uLabel=G("x",X.traceCoordinate[3],k.uhoverformat),(Q||j.indexOf("u")!==-1)&&K.push("u: "+U.uLabel),U.vLabel=G("y",X.traceCoordinate[4],k.vhoverformat),(Q||j.indexOf("v")!==-1)&&K.push("v: "+U.vLabel),U.wLabel=G("z",X.traceCoordinate[5],k.whoverformat),(Q||j.indexOf("w")!==-1)&&K.push("w: "+U.wLabel),U.normLabel=X.traceCoordinate[6].toPrecision(3),(Q||j.indexOf("norm")!==-1)&&K.push("norm: "+U.normLabel),k.type==="streamtube"&&(U.divergenceLabel=X.traceCoordinate[7].toPrecision(3),(Q||j.indexOf("divergence")!==-1)&&K.push("divergence: "+U.divergenceLabel)),X.textLabel&&K.push(X.textLabel),te=K.join("<br>")):k.type==="isosurface"||k.type==="volume"?(U.valueLabel=o.hoverLabelText(L._mockAxis,L._mockAxis.d2l(X.traceCoordinate[3]),k.valuehoverformat),K.push("value: "+U.valueLabel),X.textLabel&&K.push(X.textLabel),te=K.join("<br>")):te=X.textLabel;var re={x:X.traceCoordinate[0],y:X.traceCoordinate[1],z:X.traceCoordinate[2],data:N._input,fullData:N,curveNumber:N.index,pointNumber:B};i.appendArrayPointValue(re,N,B),k._module.eventData&&(re=N._module.eventData(re,X,N,{},B));var ne={points:[re]};if(L.fullSceneLayout.hovermode){var le=[];i.loneHover({trace:N,x:(.5+.5*W[0]/W[3])*D,y:(.5-.5*W[1]/W[3])*R,xLabel:U.xLabel,yLabel:U.yLabel,zLabel:U.zLabel,text:te,name:V.name,color:i.castHoverOption(N,B,"bgcolor")||V.color,borderColor:i.castHoverOption(N,B,"bordercolor"),fontFamily:i.castHoverOption(N,B,"font.family"),fontSize:i.castHoverOption(N,B,"font.size"),fontColor:i.castHoverOption(N,B,"font.color"),nameLength:i.castHoverOption(N,B,"namelength"),textAlign:i.castHoverOption(N,B,"align"),hovertemplate:r.castOption(N,B,"hovertemplate"),hovertemplateLabels:r.extendFlat({},re,U),eventData:[re]},{container:I,gd:A,inOut_bbox:le}),re.bbox=le[0]}X.buttons&&X.distance<5?A.emit("plotly_click",ne):A.emit("plotly_hover",ne),this.oldEventData=ne}else i.loneUnhover(I),this.oldEventData&&A.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;L.drawAnnotations(L)},c.recoverContext=function(){var k=this;k.glplot.dispose();var L=function(){k.glplot.gl.isContextLost()?requestAnimationFrame(L):k.initializeGLPlot()?k.plot.apply(k,k.plotArgs):r.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(L)};var _=["xaxis","yaxis","zaxis"];function w(k,L,A){for(var I=k.fullSceneLayout,P=0;P<3;P++){var S=_[P],E=S.charAt(0),D=I[S],R=L[E],H=L[E+"calendar"],V=L["_"+E+"length"];if(r.isArrayOrTypedArray(R))for(var X,$=0;$<(V||R.length);$++)if(r.isArrayOrTypedArray(R[$]))for(var G=0;G<R[$].length;++G)X=D.d2l(R[$][G],0,H),!isNaN(X)&&isFinite(X)&&(A[0][P]=Math.min(A[0][P],X),A[1][P]=Math.max(A[1][P],X));else X=D.d2l(R[$],0,H),!isNaN(X)&&isFinite(X)&&(A[0][P]=Math.min(A[0][P],X),A[1][P]=Math.max(A[1][P],X));else A[0][P]=Math.min(A[0][P],0),A[1][P]=Math.max(A[1][P],V-1)}}c.plot=function(k,L,A){if(this.plotArgs=[k,L,A],!this.glplot.contextLost){var I,P,S,E,D,R,H=L[this.id],V=A[this.id];this.fullLayout=L,this.fullSceneLayout=H,this.axesOptions.merge(L,H),this.spikeOptions.merge(H),this.setViewport(H),this.updateFx(H.dragmode,H.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(u(H.bgcolor)),this.setConvert(D),k?Array.isArray(k)||(k=[k]):k=[];var X=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(S=0;S<k.length;++S)(I=k[S]).visible===!0&&I._length!==0&&w(this,I,X);(function(Me,ke){for(var Le=Me.fullSceneLayout,ze=Le.annotations||[],Re=0;Re<3;Re++)for(var Oe=_[Re],Ze=Oe.charAt(0),Pe=Le[Oe],Ie=0;Ie<ze.length;Ie++){var Be=ze[Ie];if(Be.visible){var Fe=Pe.r2l(Be[Ze]);!isNaN(Fe)&&isFinite(Fe)&&(ke[0][Re]=Math.min(ke[0][Re],Fe),ke[1][Re]=Math.max(ke[1][Re],Fe))}}})(this,X);var $=[1,1,1];for(E=0;E<3;++E)X[1][E]===X[0][E]?$[E]=1:$[E]=1/(X[1][E]-X[0][E]);for(this.dataScale=$,this.convertAnnotations(this),S=0;S<k.length;++S)(I=k[S]).visible===!0&&I._length!==0&&((P=this.traces[I.uid])?P.data.type===I.type?P.update(I):(P.dispose(),P=I._module.plot(this,I),this.traces[I.uid]=P):(P=I._module.plot(this,I),this.traces[I.uid]=P),P.name=I.name);var G=Object.keys(this.traces);e:for(S=0;S<G.length;++S){for(E=0;E<k.length;++E)if(k[E].uid===G[S]&&k[E].visible===!0&&k[E]._length!==0)continue e;(P=this.traces[G[S]]).dispose(),delete this.traces[G[S]]}this.glplot.objects.sort(function(Me,ke){return Me._trace.data.index-ke._trace.data.index});var W,te=[[0,0,0],[0,0,0]],N=[],B={};for(S=0;S<3;++S){if((R=(D=H[_[S]]).type)in B?(B[R].acc*=$[S],B[R].count+=1):B[R]={acc:$[S],count:1},D.autorange){te[0][S]=1/0,te[1][S]=-1/0;var U=this.glplot.objects,ee=this.fullSceneLayout.annotations||[],j=D._name.charAt(0);for(E=0;E<U.length;E++){var Q=U[E],K=Q.bounds,re=Q._trace.data._pad||0;Q.constructor.name==="ErrorBars"&&D._lowerLogErrorBound?te[0][S]=Math.min(te[0][S],D._lowerLogErrorBound):te[0][S]=Math.min(te[0][S],K[0][S]/$[S]-re),te[1][S]=Math.max(te[1][S],K[1][S]/$[S]+re)}for(E=0;E<ee.length;E++){var ne=ee[E];if(ne.visible){var le=D.r2l(ne[j]);te[0][S]=Math.min(te[0][S],le),te[1][S]=Math.max(te[1][S],le)}}if("rangemode"in D&&D.rangemode==="tozero"&&(te[0][S]=Math.min(te[0][S],0),te[1][S]=Math.max(te[1][S],0)),te[0][S]>te[1][S])te[0][S]=-1,te[1][S]=1;else{var oe=te[1][S]-te[0][S];te[0][S]-=oe/32,te[1][S]+=oe/32}if(D.autorange==="reversed"){var de=te[0][S];te[0][S]=te[1][S],te[1][S]=de}}else{var se=D.range;te[0][S]=D.r2l(se[0]),te[1][S]=D.r2l(se[1])}te[0][S]===te[1][S]&&(te[0][S]-=1,te[1][S]+=1),N[S]=te[1][S]-te[0][S],this.glplot.setBounds(S,{min:te[0][S]*$[S],max:te[1][S]*$[S]})}var me=H.aspectmode;if(me==="cube")W=[1,1,1];else if(me==="manual"){var Te=H.aspectratio;W=[Te.x,Te.y,Te.z]}else{if(me!=="auto"&&me!=="data")throw new Error("scene.js aspectRatio was not one of the enumerated types");var _e=[1,1,1];for(S=0;S<3;++S){var be=B[R=(D=H[_[S]]).type];_e[S]=Math.pow(be.acc,1/be.count)/$[S]}W=me==="data"||Math.max.apply(null,_e)/Math.min.apply(null,_e)<=4?_e:[1,1,1]}H.aspectratio.x=V.aspectratio.x=W[0],H.aspectratio.y=V.aspectratio.y=W[1],H.aspectratio.z=V.aspectratio.z=W[2],this.glplot.setAspectratio(H.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:H.aspectratio.x,y:H.aspectratio.y,z:H.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=H.aspectmode);var Ce=H.domain||null,fe=L._size||null;if(Ce&&fe){var ve=this.container.style;ve.position="absolute",ve.left=fe.l+Ce.x[0]*fe.w+"px",ve.top=fe.t+(1-Ce.y[1])*fe.h+"px",ve.width=fe.w*(Ce.x[1]-Ce.x[0])+"px",ve.height=fe.h*(Ce.y[1]-Ce.y[0])+"px"}this.glplot.redraw()}},c.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},c.getCamera=function(){var k;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(k=this.camera).up[0],y:k.up[1],z:k.up[2]},center:{x:k.center[0],y:k.center[1],z:k.center[2]},eye:{x:k.eye[0],y:k.eye[1],z:k.eye[2]},projection:{type:k._ortho===!0?"orthographic":"perspective"}}},c.setViewport=function(k){var L,A=k.camera;this.camera.lookAt.apply(this,[[(L=A).eye.x,L.eye.y,L.eye.z],[L.center.x,L.center.y,L.center.z],[L.up.x,L.up.y,L.up.z]]),this.glplot.setAspectratio(k.aspectratio),A.projection.type==="orthographic"!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},c.isCameraChanged=function(k){var L=this.getCamera(),A=r.nestedProperty(k,this.id+".camera").get();function I(D,R,H,V){var X=["up","center","eye"],$=["x","y","z"];return R[X[H]]&&D[X[H]][$[V]]===R[X[H]][$[V]]}var P=!1;if(A===void 0)P=!0;else{for(var S=0;S<3;S++)for(var E=0;E<3;E++)if(!I(L,A,S,E)){P=!0;break}(!A.projection||L.projection&&L.projection.type!==A.projection.type)&&(P=!0)}return P},c.isAspectChanged=function(k){var L=this.glplot.getAspectratio(),A=r.nestedProperty(k,this.id+".aspectratio").get();return A===void 0||A.x!==L.x||A.y!==L.y||A.z!==L.z},c.saveLayout=function(k){var L,A,I,P,S,E,D=this.fullLayout,R=this.isCameraChanged(k),H=this.isAspectChanged(k),V=R||H;if(V){var X={};R&&(L=this.getCamera(),I=(A=r.nestedProperty(k,this.id+".camera")).get(),X[this.id+".camera"]=I),H&&(P=this.glplot.getAspectratio(),E=(S=r.nestedProperty(k,this.id+".aspectratio")).get(),X[this.id+".aspectratio"]=E),a.call("_storeDirectGUIEdit",k,D._preGUI,X),R&&(A.set(L),r.nestedProperty(D,this.id+".camera").set(L)),H&&(S.set(P),r.nestedProperty(D,this.id+".aspectratio").set(P),this.glplot.redraw())}return V},c.updateFx=function(k,L){var A=this.camera;if(A)if(k==="orbit")A.mode="orbit",A.keyBindingMode="rotate";else if(k==="turntable"){A.up=[0,0,1],A.mode="turntable",A.keyBindingMode="rotate";var I=this.graphDiv,P=I._fullLayout,S=this.fullSceneLayout.camera,E=S.up.x,D=S.up.y,R=S.up.z;if(R/Math.sqrt(E*E+D*D+R*R)<.999){var H=this.id+".camera.up",V={x:0,y:0,z:1},X={};X[H]=V;var $=I.layout;a.call("_storeDirectGUIEdit",$,P._preGUI,X),S.up=V,r.nestedProperty($,H).set(V)}}else A.keyBindingMode=k;this.fullSceneLayout.hovermode=L},c.toImage=function(k){k||(k="png"),this.staticMode&&this.container.appendChild(p),this.glplot.redraw();var L=this.glplot.gl,A=L.drawingBufferWidth,I=L.drawingBufferHeight;L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(A*I*4);L.readPixels(0,0,A,I,L.RGBA,L.UNSIGNED_BYTE,P),function(H,V,X){for(var $=0,G=X-1;$<G;++$,--G)for(var W=0;W<V;++W)for(var te=0;te<4;++te){var N=4*(V*$+W)+te,B=4*(V*G+W)+te,U=H[N];H[N]=H[B],H[B]=U}}(P,A,I),function(H,V,X){for(var $=0;$<X;++$)for(var G=0;G<V;++G){var W=4*(V*$+G),te=H[W+3];if(te>0)for(var N=255/te,B=0;B<3;++B)H[W+B]=Math.min(N*H[W+B],255)}}(P,A,I);var S=document.createElement("canvas");S.width=A,S.height=I;var E,D=S.getContext("2d",{willReadFrequently:!0}),R=D.createImageData(A,I);switch(R.data.set(P),D.putImageData(R,0,0),k){case"jpeg":E=S.toDataURL("image/jpeg");break;case"webp":E=S.toDataURL("image/webp");break;default:E=S.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(p),E},c.setConvert=function(){for(var k=0;k<3;k++){var L=this.fullSceneLayout[_[k]];o.setConvert(L,this.fullLayout),L.setScale=r.noop}},c.make4thDimension=function(){var k=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},o.setConvert(this._mockAxis,k)},J.exports=x},{"../../../stackgl_modules":1133,"../../components/fx":407,"../../lib":515,"../../lib/show_no_webgl_msg":537,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../../registry":647,"./layout/convert":611,"./layout/spikes":614,"./layout/tick_marks":615,"./project":616,"has-passive-events":229,"webgl-context":332}],618:[function(v,J,Z){J.exports=function(p,g,b,y){y=y||p.length;for(var e=new Array(y),n=0;n<y;n++)e[n]=[p[n],g[n],b[n]];return e}},{}],619:[function(v,J,Z){var p=v("./font_attributes"),g=v("./animation_attributes"),b=v("../components/color/attributes"),y=v("../components/shapes/draw_newshape/attributes"),e=v("../components/selections/draw_newselection/attributes"),n=v("./pad_attributes"),t=v("../lib/extend").extendFlat,a=p({editType:"calc"});a.family.dflt='"Open Sans", verdana, arial, sans-serif',a.size.dflt=12,a.color.dflt=b.defaultLine,J.exports={font:a,title:{text:{valType:"string",editType:"layoutstyle"},font:p({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:t(n({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:b.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:b.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:b.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:y.newshape,activeshape:y.activeshape,newselection:e.newselection,activeselection:e.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:t({},g.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:p({editType:"layoutstyle"})}}},{"../components/color/attributes":366,"../components/selections/draw_newselection/attributes":451,"../components/shapes/draw_newshape/attributes":463,"../lib/extend":505,"./animation_attributes":560,"./font_attributes":594,"./pad_attributes":627}],620:[function(v,J,Z){var p=v("../../lib/sort_object_keys"),g='\xA9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',b=['\xA9 <a target="_blank" href="https://carto.com/">Carto</a>',g].join(" "),y=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),e={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:g,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:b,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:b,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:y,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:y,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},n=p(e);J.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:e,styleValuesNonMapbox:n,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.10.1."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",n.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":538}],621:[function(v,J,Z){var p=v("../../lib");J.exports=function(g,b){var y=g.split(" "),e=y[0],n=y[1],t=p.isArrayOrTypedArray(b)?p.mean(b):b,a=.5+t/100,r=1.5+t/100,m=["",""],o=[0,0];switch(e){case"top":m[0]="top",o[1]=-r;break;case"bottom":m[0]="bottom",o[1]=r}switch(n){case"left":m[1]="right",o[0]=-a;break;case"right":m[1]="left",o[0]=a}return{anchor:m[0]&&m[1]?m.join("-"):m[0]?m[0]:m[1]?m[1]:"center",offset:o}}},{"../../lib":515}],622:[function(v,J,Z){var p=v("mapbox-gl/dist/mapbox-gl-unminified"),g=v("../../lib"),b=g.strTranslate,y=g.strScale,e=v("../../plots/get_data").getSubplotCalcData,n=v("../../constants/xmlns_namespaces"),t=v("@plotly/d3"),a=v("../../components/drawing"),r=v("../../lib/svg_text_utils"),m=v("./mapbox"),o=Z.constants=v("./constants");function i(u){return typeof u=="string"&&(o.styleValuesMapbox.indexOf(u)!==-1||u.indexOf("mapbox://")===0)}Z.name="mapbox",Z.attr="subplot",Z.idRoot="mapbox",Z.idRegex=Z.attrRegex=g.counterRegex("mapbox"),Z.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},Z.layoutAttributes=v("./layout_attributes"),Z.supplyLayoutDefaults=v("./layout_defaults"),Z.plot=function(u){var f=u._fullLayout,l=u.calcdata,h=f._subplots.mapbox;if(p.version!==o.requiredVersion)throw new Error(o.wrongVersionErrorMsg);var d=function(w,k){var L=w._fullLayout;if(w._context.mapboxAccessToken==="")return"";for(var A=[],I=[],P=!1,S=!1,E=0;E<k.length;E++){var D=L[k[E]],R=D.accesstoken;i(D.style)&&(R?g.pushUnique(A,R):(i(D._input.style)&&(g.error("Uses Mapbox map style, but did not set an access token."),P=!0),S=!0)),R&&g.pushUnique(I,R)}if(S){var H=P?o.noAccessTokenErrorMsg:o.missingStyleErrorMsg;throw g.error(H),new Error(H)}return A.length?(A.length>1&&g.warn(o.multipleTokensErrorMsg),A[0]):(I.length&&g.log(["Listed mapbox access token(s)",I.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(u,h);p.accessToken=d;for(var s=0;s<h.length;s++){var x=h[s],c=e(l,"mapbox",x),T=f[x],_=T._subplot;_||(_=new m(u,x),f[x]._subplot=_),_.viewInitial||(_.viewInitial={center:g.extendFlat({},T.center),zoom:T.zoom,bearing:T.bearing,pitch:T.pitch}),_.plot(c,f,u._promises)}},Z.clean=function(u,f,l,h){for(var d=h._subplots.mapbox||[],s=0;s<d.length;s++){var x=d[s];!f[x]&&h[x]._subplot&&h[x]._subplot.destroy()}},Z.toSVG=function(u){for(var f=u._fullLayout,l=f._subplots.mapbox,h=f._size,d=0;d<l.length;d++){var s=f[l[d]],x=s.domain,c=s._subplot.toImage("png");f._glimages.append("svg:image").attr({xmlns:n.svg,"xlink:href":c,x:h.l+h.w*x.x[0],y:h.t+h.h*(1-x.y[1]),width:h.w*(x.x[1]-x.x[0]),height:h.h*(x.y[1]-x.y[0]),preserveAspectRatio:"none"});var T=t.select(s._subplot.div);if(T.select(".mapboxgl-ctrl-logo").node().offsetParent!==null){var _=f._glimages.append("g");_.attr("transform",b(h.l+h.w*x.x[0]+10,h.t+h.h*(1-x.y[0])-31)),_.append("path").attr("d",o.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),_.append("path").attr("d",o.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),_.append("path").attr("d",o.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),_.append("polygon").attr("points",o.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var w=T.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),k=f._glimages.append("g"),L=k.append("text");L.text(w).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":w});var A=a.bBox(L.node()),I=h.w*(x.x[1]-x.x[0]);if(A.width>I/2){var P=w.split("|").join("<br>");L.text(P).attr("data-unformatted",P).call(r.convertToTspans,u),A=a.bBox(L.node())}L.attr("transform",b(-3,8-A.height)),k.insert("rect",".static-attribution").attr({x:-A.width-6,y:-A.height-3,width:A.width+6,height:A.height+3,fill:"rgba(255, 255, 255, 0.75)"});var S=1;A.width+6>I&&(S=I/(A.width+6));var E=[h.l+h.w*x.x[1],h.t+h.h*(1-x.y[0])];k.attr("transform",b(E[0],E[1])+y(S))}},Z.updateFx=function(u){for(var f=u._fullLayout,l=f._subplots.mapbox,h=0;h<l.length;h++)f[l[h]]._subplot.updateFx(f)}},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/get_data":602,"./constants":620,"./layout_attributes":624,"./layout_defaults":625,"./mapbox":626,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],623:[function(v,J,Z){var p=v("../../lib"),g=v("../../lib/svg_text_utils").sanitizeHTML,b=v("./convert_text_opts"),y=v("./constants");function e(r,m){this.subplot=r,this.uid=r.uid+"-"+m,this.index=m,this.idSource="source-"+this.uid,this.idLayer=y.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var n=e.prototype;function t(r){if(!r.visible)return!1;var m=r.source;if(Array.isArray(m)&&m.length>0){for(var o=0;o<m.length;o++)if(typeof m[o]!="string"||m[o].length===0)return!1;return!0}return p.isPlainObject(m)||typeof m=="string"&&m.length>0}function a(r){var m={},o={};switch(r.type){case"circle":p.extendFlat(o,{"circle-radius":r.circle.radius,"circle-color":r.color,"circle-opacity":r.opacity});break;case"line":p.extendFlat(o,{"line-width":r.line.width,"line-color":r.color,"line-opacity":r.opacity,"line-dasharray":r.line.dash});break;case"fill":p.extendFlat(o,{"fill-color":r.color,"fill-outline-color":r.fill.outlinecolor,"fill-opacity":r.opacity});break;case"symbol":var i=r.symbol,u=b(i.textposition,i.iconsize);p.extendFlat(m,{"icon-image":i.icon+"-15","icon-size":i.iconsize/10,"text-field":i.text,"text-size":i.textfont.size,"text-anchor":u.anchor,"text-offset":u.offset,"symbol-placement":i.placement}),p.extendFlat(o,{"icon-color":r.color,"text-color":i.textfont.color,"text-opacity":r.opacity});break;case"raster":p.extendFlat(o,{"raster-fade-duration":0,"raster-opacity":r.opacity})}return{layout:m,paint:o}}n.update=function(r){this.visible?this.needsNewImage(r)?this.updateImage(r):this.needsNewSource(r)?(this.removeLayer(),this.updateSource(r),this.updateLayer(r)):this.needsNewLayer(r)?this.updateLayer(r):this.updateStyle(r):(this.updateSource(r),this.updateLayer(r)),this.visible=t(r)},n.needsNewImage=function(r){return this.subplot.map.getSource(this.idSource)&&this.sourceType==="image"&&r.sourcetype==="image"&&(this.source!==r.source||JSON.stringify(this.coordinates)!==JSON.stringify(r.coordinates))},n.needsNewSource=function(r){return this.sourceType!==r.sourcetype||JSON.stringify(this.source)!==JSON.stringify(r.source)||this.layerType!==r.type},n.needsNewLayer=function(r){return this.layerType!==r.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},n.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},n.updateImage=function(r){this.subplot.map.getSource(this.idSource).updateImage({url:r.source,coordinates:r.coordinates});var m=this.findFollowingMapboxLayerId(this.lookupBelow());m!==null&&this.subplot.map.moveLayer(this.idLayer,m)},n.updateSource=function(r){var m=this.subplot.map;if(m.getSource(this.idSource)&&m.removeSource(this.idSource),this.sourceType=r.sourcetype,this.source=r.source,t(r)){var o=function(i){var u,f=i.sourcetype,l=i.source,h={type:f};return f==="geojson"?u="data":f==="vector"?u=typeof l=="string"?"url":"tiles":f==="raster"?(u="tiles",h.tileSize=256):f==="image"&&(u="url",h.coordinates=i.coordinates),h[u]=l,i.sourceattribution&&(h.attribution=g(i.sourceattribution)),h}(r);m.addSource(this.idSource,o)}},n.findFollowingMapboxLayerId=function(r){if(r==="traces")for(var m=this.subplot.getMapLayers(),o=0;o<m.length;o++){var i=m[o].id;if(typeof i=="string"&&i.indexOf(y.traceLayerPrefix)===0){r=i;break}}return r},n.updateLayer=function(r){var m=this.subplot,o=a(r),i=this.lookupBelow(),u=this.findFollowingMapboxLayerId(i);this.removeLayer(),t(r)&&m.addLayer({id:this.idLayer,source:this.idSource,"source-layer":r.sourcelayer||"",type:r.type,minzoom:r.minzoom,maxzoom:r.maxzoom,layout:o.layout,paint:o.paint},u),this.layerType=r.type,this.below=i},n.updateStyle=function(r){if(t(r)){var m=a(r);this.subplot.setOptions(this.idLayer,"setLayoutProperty",m.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",m.paint)}},n.removeLayer=function(){var r=this.subplot.map;r.getLayer(this.idLayer)&&r.removeLayer(this.idLayer)},n.dispose=function(){var r=this.subplot.map;r.getLayer(this.idLayer)&&r.removeLayer(this.idLayer),r.getSource(this.idSource)&&r.removeSource(this.idSource)},J.exports=function(r,m,o){var i=new e(r,m);return i.update(o),i}},{"../../lib":515,"../../lib/svg_text_utils":541,"./constants":620,"./convert_text_opts":621}],624:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/color").defaultLine,b=v("../domain").attributes,y=v("../font_attributes"),e=v("../../traces/scatter/attributes").textposition,n=v("../../plot_api/edit_types").overrideAll,t=v("../../plot_api/plot_template").templatedArray,a=v("./constants"),r=y({});r.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(J.exports=n({_arrayAttrRegexps:[p.counterRegex("mapbox",".layers",!0)],domain:b({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:a.styleValuesMapbox.concat(a.styleValuesNonMapbox),dflt:a.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:t("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:g},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:g}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:r,textposition:p.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":367,"../../lib":515,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../domain":593,"../font_attributes":594,"./constants":620}],625:[function(v,J,Z){var p=v("../../lib"),g=v("../subplot_defaults"),b=v("../array_container_defaults"),y=v("./layout_attributes");function e(t,a,r,m){r("accesstoken",m.accessToken),r("style"),r("center.lon"),r("center.lat"),r("zoom"),r("bearing"),r("pitch"),b(t,a,{name:"layers",handleItemDefaults:n}),a._input=t}function n(t,a){function r(f,l){return p.coerce(t,a,y.layers,f,l)}if(r("visible")){var m,o=r("sourcetype"),i=o==="raster"||o==="image";r("source"),r("sourceattribution"),o==="vector"&&r("sourcelayer"),o==="image"&&r("coordinates"),i&&(m="raster");var u=r("type",m);i&&u!=="raster"&&(u=a.type="raster",p.log("Source types *raster* and *image* must drawn *raster* layer type.")),r("below"),r("color"),r("opacity"),r("minzoom"),r("maxzoom"),u==="circle"&&r("circle.radius"),u==="line"&&(r("line.width"),r("line.dash")),u==="fill"&&r("fill.outlinecolor"),u==="symbol"&&(r("symbol.icon"),r("symbol.iconsize"),r("symbol.text"),p.coerceFont(r,"symbol.textfont"),r("symbol.textposition"),r("symbol.placement"))}}J.exports=function(t,a,r){g(t,a,r,{type:"mapbox",attributes:y,handleDefaults:e,partition:"y",accessToken:a._mapboxAccessToken})}},{"../../lib":515,"../array_container_defaults":561,"../subplot_defaults":641,"./layout_attributes":624}],626:[function(v,J,Z){var p=v("mapbox-gl/dist/mapbox-gl-unminified"),g=v("../../lib"),b=v("../../lib/geo_location_utils"),y=v("../../registry"),e=v("../cartesian/axes"),n=v("../../components/dragelement"),t=v("../../components/fx"),a=v("../../components/dragelement/helpers"),r=a.drawMode,m=a.selectMode,o=v("../../components/selections").prepSelect,i=v("../../components/selections").clearOutline,u=v("../../components/selections").clearSelectionsCache,f=v("../../components/selections").selectOnClick,l=v("./constants"),h=v("./layers");function d(w,k){this.id=k,this.gd=w;var L=w._fullLayout,A=w._context;this.container=L._glcontainer.node(),this.isStatic=A.staticPlot,this.uid=L._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(L),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var s=d.prototype;s.plot=function(w,k,L){var A,I=this,P=k[I.id];I.map&&P.accesstoken!==I.accessToken&&(I.map.remove(),I.map=null,I.styleObj=null,I.traceHash={},I.layerList=[]),A=I.map?new Promise(function(S,E){I.updateMap(w,k,S,E)}):new Promise(function(S,E){I.createMap(w,k,S,E)}),L.push(A)},s.createMap=function(w,k,L,A){var I=this,P=k[I.id],S=I.styleObj=c(P.style);I.accessToken=P.accesstoken;var E=I.map=new p.Map({container:I.div,style:S.style,center:_(P.center),zoom:P.zoom,bearing:P.bearing,pitch:P.pitch,interactive:!I.isStatic,preserveDrawingBuffer:I.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new p.AttributionControl({compact:!0}));E._canvas.style.left="0px",E._canvas.style.top="0px",I.rejectOnError(A),I.isStatic||I.initFx(w,k);var D=[];D.push(new Promise(function(R){E.once("load",R)})),D=D.concat(b.fetchTraceGeoData(w)),Promise.all(D).then(function(){I.fillBelowLookup(w,k),I.updateData(w),I.updateLayout(k),I.resolveOnRender(L)}).catch(A)},s.updateMap=function(w,k,L,A){var I=this,P=I.map,S=k[this.id];I.rejectOnError(A);var E=[],D=c(S.style);JSON.stringify(I.styleObj)!==JSON.stringify(D)&&(I.styleObj=D,P.setStyle(D.style),I.traceHash={},E.push(new Promise(function(R){P.once("styledata",R)}))),E=E.concat(b.fetchTraceGeoData(w)),Promise.all(E).then(function(){I.fillBelowLookup(w,k),I.updateData(w),I.updateLayout(k),I.resolveOnRender(L)}).catch(A)},s.fillBelowLookup=function(w,k){var L,A,I=k[this.id].layers,P=this.belowLookup={},S=!1;for(L=0;L<w.length;L++){var E=w[L][0].trace,D=E._module;typeof E.below=="string"?A=E.below:D.getBelow&&(A=D.getBelow(E,this)),A===""&&(S=!0),P["trace-"+E.uid]=A||""}for(L=0;L<I.length;L++){var R=I[L];A=typeof R.below=="string"?R.below:S?"traces":"",P["layout-"+L]=A}var H,V,X={};for(H in P)X[A=P[H]]?X[A].push(H):X[A]=[H];for(A in X){var $=X[A];if($.length>1)for(L=0;L<$.length;L++)(H=$[L]).indexOf("trace-")===0?(V=H.split("trace-")[1],this.traceHash[V]&&(this.traceHash[V].below=null)):H.indexOf("layout-")===0&&(V=H.split("layout-")[1],this.layerList[V]&&(this.layerList[V].below=null))}};var x={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function c(w){var k={};return g.isPlainObject(w)?(k.id=w.id,k.style=w):typeof w=="string"?(k.id=w,l.styleValuesMapbox.indexOf(w)!==-1?k.style=T(w):l.stylesNonMapbox[w]?k.style=l.stylesNonMapbox[w]:k.style=w):(k.id=l.styleValueDflt,k.style=T(l.styleValueDflt)),k.transition={duration:0,delay:0},k}function T(w){return l.styleUrlPrefix+w+"-"+l.styleUrlSuffix}function _(w){return[w.lon,w.lat]}s.updateData=function(w){var k,L,A,I,P=this.traceHash,S=w.slice().sort(function(V,X){return x[V[0].trace.type]-x[X[0].trace.type]});for(A=0;A<S.length;A++){var E=S[A],D=!1;(k=P[(L=E[0].trace).uid])&&(k.type===L.type?(k.update(E),D=!0):k.dispose()),!D&&L._module&&(P[L.uid]=L._module.plot(this,E))}var R=Object.keys(P);e:for(A=0;A<R.length;A++){var H=R[A];for(I=0;I<w.length;I++)if(H===(L=w[I][0].trace).uid)continue e;(k=P[H]).dispose(),delete P[H]}},s.updateLayout=function(w){var k=this.map,L=w[this.id];this.dragging||this.wheeling||(k.setCenter(_(L.center)),k.setZoom(L.zoom),k.setBearing(L.bearing),k.setPitch(L.pitch)),this.updateLayers(w),this.updateFramework(w),this.updateFx(w),this.map.resize(),this.gd._context._scrollZoom.mapbox?k.scrollZoom.enable():k.scrollZoom.disable()},s.resolveOnRender=function(w){var k=this.map;k.on("render",function L(){k.loaded()&&(k.off("render",L),setTimeout(w,10))})},s.rejectOnError=function(w){var k=this.map;function L(){w(new Error(l.mapOnErrorMsg))}k.once("error",L),k.once("style.error",L),k.once("source.error",L),k.once("tile.error",L),k.once("layer.error",L)},s.createFramework=function(w){var k=this,L=k.div=document.createElement("div");L.id=k.uid,L.style.position="absolute",k.container.appendChild(L),k.xaxis={_id:"x",c2p:function(A){return k.project(A).x}},k.yaxis={_id:"y",c2p:function(A){return k.project(A).y}},k.updateFramework(w),k.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(k.mockAxis,w)},s.initFx=function(w,k){var L=this,A=L.gd,I=L.map;function P(){t.loneUnhover(k._hoverlayer)}function S(){var E=L.getView();A.emit("plotly_relayouting",L.getViewEditsWithDerived(E))}I.on("moveend",function(E){if(L.map){var D=A._fullLayout;if(E.originalEvent||L.wheeling){var R=D[L.id];y.call("_storeDirectGUIEdit",A.layout,D._preGUI,L.getViewEdits(R));var H=L.getView();R._input.center=R.center=H.center,R._input.zoom=R.zoom=H.zoom,R._input.bearing=R.bearing=H.bearing,R._input.pitch=R.pitch=H.pitch,A.emit("plotly_relayout",L.getViewEditsWithDerived(H))}E.originalEvent&&E.originalEvent.type==="mouseup"?L.dragging=!1:L.wheeling&&(L.wheeling=!1),D._rehover&&D._rehover()}}),I.on("wheel",function(){L.wheeling=!0}),I.on("mousemove",function(E){var D=L.div.getBoundingClientRect(),R=[E.originalEvent.offsetX,E.originalEvent.offsetY];E.target.getBoundingClientRect=function(){return D},L.xaxis.p2c=function(){return I.unproject(R).lng},L.yaxis.p2c=function(){return I.unproject(R).lat},A._fullLayout._rehover=function(){A._fullLayout._hoversubplot===L.id&&A._fullLayout[L.id]&&t.hover(A,E,L.id)},t.hover(A,E,L.id),A._fullLayout._hoversubplot=L.id}),I.on("dragstart",function(){L.dragging=!0,P()}),I.on("zoomstart",P),I.on("mouseout",function(){A._fullLayout._hoversubplot=null}),I.on("drag",S),I.on("zoom",S),I.on("dblclick",function(){var E=A._fullLayout[L.id];y.call("_storeDirectGUIEdit",A.layout,A._fullLayout._preGUI,L.getViewEdits(E));var D=L.viewInitial;I.setCenter(_(D.center)),I.setZoom(D.zoom),I.setBearing(D.bearing),I.setPitch(D.pitch);var R=L.getView();E._input.center=E.center=R.center,E._input.zoom=E.zoom=R.zoom,E._input.bearing=E.bearing=R.bearing,E._input.pitch=E.pitch=R.pitch,A.emit("plotly_doubleclick",null),A.emit("plotly_relayout",L.getViewEditsWithDerived(R))}),L.clearOutline=function(){u(L.dragOptions),i(L.dragOptions.gd)},L.onClickInPanFn=function(E){return function(D){var R=A._fullLayout.clickmode;R.indexOf("select")>-1&&f(D.originalEvent,A,[L.xaxis],[L.yaxis],L.id,E),R.indexOf("event")>-1&&t.click(A,D.originalEvent)}}},s.updateFx=function(w){var k=this,L=k.map,A=k.gd;if(!k.isStatic){var I,P=w.dragmode;I=function(D,R){R.isRect?(D.range={})[k.id]=[E([R.xmin,R.ymin]),E([R.xmax,R.ymax])]:(D.lassoPoints={})[k.id]=R.map(E)};var S=k.dragOptions;k.dragOptions=g.extendDeep(S||{},{dragmode:w.dragmode,element:k.div,gd:A,plotinfo:{id:k.id,domain:w[k.id].domain,xaxis:k.xaxis,yaxis:k.yaxis,fillRangeItems:I},xaxes:[k.xaxis],yaxes:[k.yaxis],subplot:k.id}),L.off("click",k.onClickInPanHandler),m(P)||r(P)?(L.dragPan.disable(),L.on("zoomstart",k.clearSelect),k.dragOptions.prepFn=function(D,R,H){o(D,R,H,k.dragOptions,P)},n.init(k.dragOptions)):(L.dragPan.enable(),L.off("zoomstart",k.clearSelect),k.div.onmousedown=null,k.onClickInPanHandler=k.onClickInPanFn(k.dragOptions),L.on("click",k.onClickInPanHandler))}function E(D){var R=k.map.unproject(D);return[R.lng,R.lat]}},s.updateFramework=function(w){var k=w[this.id].domain,L=w._size,A=this.div.style;A.width=L.w*(k.x[1]-k.x[0])+"px",A.height=L.h*(k.y[1]-k.y[0])+"px",A.left=L.l+k.x[0]*L.w+"px",A.top=L.t+(1-k.y[1])*L.h+"px",this.xaxis._offset=L.l+k.x[0]*L.w,this.xaxis._length=L.w*(k.x[1]-k.x[0]),this.yaxis._offset=L.t+(1-k.y[1])*L.h,this.yaxis._length=L.h*(k.y[1]-k.y[0])},s.updateLayers=function(w){var k,L=w[this.id].layers,A=this.layerList;if(L.length!==A.length){for(k=0;k<A.length;k++)A[k].dispose();for(A=this.layerList=[],k=0;k<L.length;k++)A.push(h(this,k,L[k]))}else for(k=0;k<L.length;k++)A[k].update(L[k])},s.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},s.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},s.setOptions=function(w,k,L){for(var A in L)this.map[k](w,A,L[A])},s.getMapLayers=function(){return this.map.getStyle().layers},s.addLayer=function(w,k){var L=this.map;if(typeof k=="string"){if(k==="")return void L.addLayer(w,k);for(var A=this.getMapLayers(),I=0;I<A.length;I++)if(k===A[I].id)return void L.addLayer(w,k);g.warn(["Trying to add layer with *below* value",k,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}L.addLayer(w)},s.project=function(w){return this.map.project(new p.LngLat(w[0],w[1]))},s.getView=function(){var w=this.map,k=w.getCenter(),L={lon:k.lng,lat:k.lat},A=w.getCanvas(),I=parseInt(A.style.width),P=parseInt(A.style.height);return{center:L,zoom:w.getZoom(),bearing:w.getBearing(),pitch:w.getPitch(),_derived:{coordinates:[w.unproject([0,0]).toArray(),w.unproject([I,0]).toArray(),w.unproject([I,P]).toArray(),w.unproject([0,P]).toArray()]}}},s.getViewEdits=function(w){for(var k=this.id,L=["center","zoom","bearing","pitch"],A={},I=0;I<L.length;I++){var P=L[I];A[k+"."+P]=w[P]}return A},s.getViewEditsWithDerived=function(w){var k=this.id,L=this.getViewEdits(w);return L[k+"._derived"]=w._derived,L},J.exports=d},{"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../registry":647,"../cartesian/axes":566,"./constants":620,"./layers":623,"mapbox-gl/dist/mapbox-gl-unminified":239}],627:[function(v,J,Z){J.exports=function(p){var g=p.editType;return{t:{valType:"number",dflt:0,editType:g},r:{valType:"number",dflt:0,editType:g},b:{valType:"number",dflt:0,editType:g},l:{valType:"number",dflt:0,editType:g},editType:g}}},{}],628:[function(v,J,Z){var p=v("@plotly/d3"),g=v("d3-time-format").timeFormatLocale,b=v("d3-format").formatLocale,y=v("fast-isnumeric"),e=v("../registry"),n=v("../plot_api/plot_schema"),t=v("../plot_api/plot_template"),a=v("../lib"),r=v("../components/color"),m=v("../constants/numerical").BADNUM,o=v("./cartesian/axis_ids"),i=v("../components/shapes/handle_outline").clearOutline,u=v("./animation_attributes"),f=v("./frame_attributes"),l=v("../plots/get_data").getModuleCalcData,h=a.relinkPrivateKeys,d=a._,s=J.exports={};a.extendFlat(s,e),s.attributes=v("./attributes"),s.attributes.type.values=s.allTypes,s.fontAttrs=v("./font_attributes"),s.layoutAttributes=v("./layout_attributes"),s.fontWeight="normal";var x=s.transformsRegistry,c=v("./command");s.executeAPICommand=c.executeAPICommand,s.computeAPICommandBindings=c.computeAPICommandBindings,s.manageCommandObserver=c.manageCommandObserver,s.hasSimpleAPICommandBindings=c.hasSimpleAPICommandBindings,s.redrawText=function(V){return V=a.getGraphDiv(V),new Promise(function(X){setTimeout(function(){V._fullLayout&&(e.getComponentMethod("annotations","draw")(V),e.getComponentMethod("legend","draw")(V),e.getComponentMethod("colorbar","draw")(V),X(s.previousPromises(V)))},300)})},s.resize=function(V){var X;V=a.getGraphDiv(V);var $=new Promise(function(G,W){V&&!a.isHidden(V)||W(new Error("Resize must be passed a displayed plot div element.")),V._redrawTimer&&clearTimeout(V._redrawTimer),V._resolveResize&&(X=V._resolveResize),V._resolveResize=G,V._redrawTimer=setTimeout(function(){if(!V.layout||V.layout.width&&V.layout.height||a.isHidden(V))G(V);else{delete V.layout.width,delete V.layout.height;var te=V.changed;V.autoplay=!0,e.call("relayout",V,{autosize:!0}).then(function(){V.changed=te,V._resolveResize===G&&(delete V._resolveResize,G(V))})}},100)});return X&&X($),$},s.previousPromises=function(V){if((V._promises||[]).length)return Promise.all(V._promises).then(function(){V._promises=[]})},s.addLinks=function(V){if(V._context.showLink||V._context.showSources){var X=V._fullLayout,$=a.ensureSingle(X._paper,"text","js-plot-link-container",function(U){U.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:r.defaultLine,"pointer-events":"all"}).each(function(){var ee=p.select(this);ee.append("tspan").classed("js-link-to-tool",!0),ee.append("tspan").classed("js-link-spacer",!0),ee.append("tspan").classed("js-sourcelinks",!0)})}),G=$.node(),W={y:X._paper.attr("height")-9};document.body.contains(G)&&G.getComputedTextLength()>=X.width-20?(W["text-anchor"]="start",W.x=5):(W["text-anchor"]="end",W.x=X._paper.attr("width")-7),$.attr(W);var te=$.select(".js-link-to-tool"),N=$.select(".js-link-spacer"),B=$.select(".js-sourcelinks");V._context.showSources&&V._context.showSources(V),V._context.showLink&&function(U,ee){ee.text("");var j=ee.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(U._context.linkText+" "+String.fromCharCode(187));if(U._context.sendData)j.on("click",function(){s.sendDataToCloud(U)});else{var Q=window.location.pathname.split("/"),K=window.location.search;j.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+Q[2].split(".")[0]+"/"+Q[1]+K})}}(V,te),N.text(te.text()&&B.text()?" - ":"")}},s.sendDataToCloud=function(V){var X=(window.PLOTLYENV||{}).BASE_URL||V._context.plotlyServerURL;if(X){V.emit("plotly_beforeexport");var $=p.select(V).append("div").attr("id","hiddenform").style("display","none"),G=$.append("form").attr({action:X+"/external",method:"post",target:"_blank"});return G.append("input").attr({type:"text",name:"data"}).node().value=s.graphJson(V,!1,"keepdata"),G.node().submit(),$.remove(),V.emit("plotly_afterexport"),!1}};var T=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],_=["year","month","dayMonth","dayMonthYear"];function w(V,X){var $=V._context.locale;$||($="en-US");var G=!1,W={};function te(Q){for(var K=!0,re=0;re<X.length;re++){var ne=X[re];W[ne]||(Q[ne]?W[ne]=Q[ne]:K=!1)}K&&(G=!0)}for(var N=0;N<2;N++){for(var B=V._context.locales,U=0;U<2;U++){var ee=(B[$]||{}).format;if(ee&&(te(ee),G))break;B=e.localeRegistry}var j=$.split("-")[0];if(G||j===$)break;$=j}return G||te(e.localeRegistry.en.format),W}function k(V,X){var $={_fullLayout:X},G=V._id.charAt(0)==="x",W=V._mainAxis._anchorAxis,te="",N="",B="";if(W&&(B=W._mainAxis._id,te=G?V._id+B:B+V._id),!te||!X._plots[te]){te="";for(var U=V._counterAxes,ee=0;ee<U.length;ee++){var j=U[ee],Q=G?V._id+j:j+V._id;N||(N=Q);var K=o.getFromId($,j);if(B&&K.overlaying===B){te=Q;break}}}return te||N}function L(V){var X=V.transforms;if(Array.isArray(X)&&X.length)for(var $=0;$<X.length;$++){var G=X[$],W=G._module||x[G.type];if(W&&W.makesData)return!0}return!1}function A(V,X,$,G){for(var W=V.transforms,te=[V],N=0;N<W.length;N++){var B=W[N],U=x[B.type];U&&U.transform&&(te=U.transform(te,{transform:B,fullTrace:V,fullData:X,layout:$,fullLayout:G,transformIndex:N}))}return te}function I(V){return typeof V=="string"&&V.substr(V.length-2)==="px"&&parseFloat(V)}function P(V){var X=V.margin;if(!V._size){var $=V._size={l:Math.round(X.l),r:Math.round(X.r),t:Math.round(X.t),b:Math.round(X.b),p:Math.round(X.pad)};$.w=Math.round(V.width)-$.l-$.r,$.h=Math.round(V.height)-$.t-$.b}V._pushmargin||(V._pushmargin={}),V._pushmarginIds||(V._pushmarginIds={})}s.supplyDefaults=function(V,X){var $=X&&X.skipUpdateCalc,G=V._fullLayout||{};if(G._skipDefaults)delete G._skipDefaults;else{var W,te=V._fullLayout={},N=V.layout||{},B=V._fullData||[],U=V._fullData=[],ee=V.data||[],j=V.calcdata||[],Q=V._context||{};V._transitionData||s.createTransitionData(V),te._dfltTitle={plot:d(V,"Click to enter Plot title"),x:d(V,"Click to enter X axis title"),y:d(V,"Click to enter Y axis title"),colorbar:d(V,"Click to enter Colorscale title"),annotation:d(V,"new text")},te._traceWord=d(V,"trace");var K=w(V,T);if(te._mapboxAccessToken=Q.mapboxAccessToken,G._initialAutoSizeIsDone){var re=G.width,ne=G.height;s.supplyLayoutGlobalDefaults(N,te,K),N.width||(te.width=re),N.height||(te.height=ne),s.sanitizeMargins(te)}else{s.supplyLayoutGlobalDefaults(N,te,K);var le=!N.width||!N.height,oe=te.autosize,de=Q.autosizable;le&&(oe||de)?s.plotAutoSize(V,N,te):le&&s.sanitizeMargins(te),!oe&&le&&(N.width=te.width,N.height=te.height)}te._d3locale=function(Ie,Be){return Ie.decimal=Be.charAt(0),Ie.thousands=Be.charAt(1),{numberFormat:function(Fe){try{Fe=b(Ie).format(a.adjustFormat(Fe))}catch{return a.warnBadFormat(Fe),a.noFormat}return Fe},timeFormat:g(Ie).utcFormat}}(K,te.separators),te._extraFormat=w(V,_),te._initialAutoSizeIsDone=!0,te._dataLength=ee.length,te._modules=[],te._visibleModules=[],te._basePlotModules=[];var se=te._subplots=function(){var Ie,Be,Fe=e.collectableSubplotTypes,$e={};if(!Fe){Fe=[];var ot=e.subplotsRegistry;for(var pt in ot){var _t=ot[pt].attr;if(_t&&(Fe.push(pt),Array.isArray(_t)))for(Be=0;Be<_t.length;Be++)a.pushUnique(Fe,_t[Be])}}for(Ie=0;Ie<Fe.length;Ie++)$e[Fe[Ie]]=[];return $e}(),me=te._splomAxes={x:{},y:{}},Te=te._splomSubplots={};te._splomGridDflt={},te._scatterStackOpts={},te._firstScatter={},te._alignmentOpts={},te._colorAxes={},te._requestRangeslider={},te._traceUids=function(Ie,Be){var Fe,$e,ot=Be.length,pt=[];for(Fe=0;Fe<Ie.length;Fe++){var _t=Ie[Fe]._fullInput;_t!==$e&&pt.push(_t),$e=_t}var yt=pt.length,tt=new Array(ot),Ke={};function vt(er,Jt){tt[Jt]=er,Ke[er]=1}function Nt(er,Jt){if(er&&typeof er=="string"&&!Ke[er])return vt(er,Jt),!0}for(Fe=0;Fe<ot;Fe++){var qt=Be[Fe].uid;typeof qt=="number"&&(qt=String(qt)),Nt(qt,Fe)||Fe<yt&&Nt(pt[Fe].uid,Fe)||vt(a.randstr(Ke),Fe)}return tt}(B,ee),te._globalTransforms=(V._context||{}).globalTransforms,s.supplyDataDefaults(ee,U,N,te);var _e=Object.keys(me.x),be=Object.keys(me.y);if(_e.length>1&&be.length>1){for(e.getComponentMethod("grid","sizeDefaults")(N,te),W=0;W<_e.length;W++)a.pushUnique(se.xaxis,_e[W]);for(W=0;W<be.length;W++)a.pushUnique(se.yaxis,be[W]);for(var Ce in Te)a.pushUnique(se.cartesian,Ce)}if(te._has=s._hasPlotType.bind(te),B.length===U.length)for(W=0;W<U.length;W++)h(U[W],B[W]);s.supplyLayoutModuleDefaults(N,te,U,V._transitionData);var fe=te._visibleModules,ve=[];for(W=0;W<fe.length;W++){var Me=fe[W].crossTraceDefaults;Me&&a.pushUnique(ve,Me)}for(W=0;W<ve.length;W++)ve[W](U,te);te._hasOnlyLargeSploms=te._basePlotModules.length===1&&te._basePlotModules[0].name==="splom"&&_e.length>15&&be.length>15&&te.shapes.length===0&&te.images.length===0,s.linkSubplots(U,te,B,G),s.cleanPlot(U,te,B,G);var ke=!(!G._has||!G._has("gl2d")),Le=!(!te._has||!te._has("gl2d")),ze=!(!G._has||!G._has("cartesian"))||ke,Re=!(!te._has||!te._has("cartesian"))||Le;ze&&!Re?G._bgLayer.remove():Re&&!ze&&(te._shouldCreateBgLayer=!0),G._zoomlayer&&!V._dragging&&i({_fullLayout:G}),function(Ie,Be){var Fe,$e=[];Be.meta&&(Fe=Be._meta={meta:Be.meta,layout:{meta:Be.meta}});for(var ot=0;ot<Ie.length;ot++){var pt=Ie[ot];pt.meta?$e[pt.index]=pt._meta={meta:pt.meta}:Be.meta&&(pt._meta={meta:Be.meta}),Be.meta&&(pt._meta.layout={meta:Be.meta})}$e.length&&(Fe||(Fe=Be._meta={}),Fe.data=$e)}(U,te),h(te,G),e.getComponentMethod("colorscale","crossTraceDefaults")(U,te),te._preGUI||(te._preGUI={}),te._tracePreGUI||(te._tracePreGUI={});var Oe,Ze=te._tracePreGUI,Pe={};for(Oe in Ze)Pe[Oe]="old";for(W=0;W<U.length;W++)Pe[Oe=U[W]._fullInput.uid]||(Ze[Oe]={}),Pe[Oe]="new";for(Oe in Pe)Pe[Oe]==="old"&&delete Ze[Oe];P(te),e.getComponentMethod("rangeslider","makeData")(te),$||j.length!==U.length||s.supplyDefaultsUpdateCalc(j,U)}},s.supplyDefaultsUpdateCalc=function(V,X){for(var $=0;$<X.length;$++){var G=X[$],W=(V[$]||[])[0];if(W&&W.trace){var te=W.trace;if(te._hasCalcTransform){var N,B,U,ee=te._arrayAttrs;for(N=0;N<ee.length;N++)B=ee[N],U=a.nestedProperty(te,B).get().slice(),a.nestedProperty(G,B).set(U)}W.trace=G}}},s.createTransitionData=function(V){V._transitionData||(V._transitionData={}),V._transitionData._frames||(V._transitionData._frames=[]),V._transitionData._frameHash||(V._transitionData._frameHash={}),V._transitionData._counter||(V._transitionData._counter=0),V._transitionData._interruptCallbacks||(V._transitionData._interruptCallbacks=[])},s._hasPlotType=function(V){var X,$=this._basePlotModules||[];for(X=0;X<$.length;X++)if($[X].name===V)return!0;var G=this._modules||[];for(X=0;X<G.length;X++){var W=G[X].name;if(W===V)return!0;var te=e.modules[W];if(te&&te.categories[V])return!0}return!1},s.cleanPlot=function(V,X,$,G){var W,te,N=G._basePlotModules||[];for(W=0;W<N.length;W++){var B=N[W];B.clean&&B.clean(V,X,$,G)}var U=G._has&&G._has("gl"),ee=X._has&&X._has("gl");U&&!ee&&G._glcontainer!==void 0&&(G._glcontainer.selectAll(".gl-canvas").remove(),G._glcontainer.selectAll(".no-webgl").remove(),G._glcanvas=null);var j=!!G._infolayer;e:for(W=0;W<$.length;W++){var Q=$[W].uid;for(te=0;te<V.length;te++)if(Q===V[te].uid)continue e;j&&G._infolayer.select(".cb"+Q).remove()}},s.linkSubplots=function(V,X,$,G){var W,te,N=G._plots||{},B=X._plots={},U=X._subplots,ee={_fullData:V,_fullLayout:X},j=U.cartesian.concat(U.gl2d||[]);for(W=0;W<j.length;W++){var Q,K=j[W],re=N[K],ne=o.getFromId(ee,K,"x"),le=o.getFromId(ee,K,"y");for(re?Q=B[K]=re:(Q=B[K]={}).id=K,ne._counterAxes.push(le._id),le._counterAxes.push(ne._id),ne._subplotsWith.push(K),le._subplotsWith.push(K),Q.xaxis=ne,Q.yaxis=le,Q._hasClipOnAxisFalse=!1,te=0;te<V.length;te++){var oe=V[te];if(oe.xaxis===Q.xaxis._id&&oe.yaxis===Q.yaxis._id&&oe.cliponaxis===!1){Q._hasClipOnAxisFalse=!0;break}}}var de,se=o.list(ee,null,!0);for(W=0;W<se.length;W++){var me=null;(de=se[W]).overlaying&&(me=o.getFromId(ee,de.overlaying))&&me.overlaying&&(de.overlaying=!1,me=null),de._mainAxis=me||de,me&&(de.domain=me.domain.slice()),de._anchorAxis=de.anchor==="free"?null:o.getFromId(ee,de.anchor)}for(W=0;W<se.length;W++)if((de=se[W])._counterAxes.sort(o.idSort),de._subplotsWith.sort(a.subplotSort),de._mainSubplot=k(de,X),de._counterAxes.length&&(de.spikemode&&de.spikemode.indexOf("across")!==-1||de.automargin&&de.mirror&&de.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(de))){var Te=1,_e=0;for(te=0;te<de._counterAxes.length;te++){var be=o.getFromId(ee,de._counterAxes[te]);Te=Math.min(Te,be.domain[0]),_e=Math.max(_e,be.domain[1])}Te<_e&&(de._counterDomainMin=Te,de._counterDomainMax=_e)}},s.clearExpandedTraceDefaultColors=function(V){var X,$,G;for($=[],(X=V._module._colorAttrs)||(V._module._colorAttrs=X=[],n.crawl(V._module.attributes,function(W,te,N,B){$[B]=te,$.length=B+1,W.valType==="color"&&W.dflt===void 0&&X.push($.join("."))})),G=0;G<X.length;G++)a.nestedProperty(V,"_input."+X[G]).get()||a.nestedProperty(V,X[G]).set(null)},s.supplyDataDefaults=function(V,X,$,G){var W,te,N,B=G._modules,U=G._visibleModules,ee=G._basePlotModules,j=0,Q=0;function K(Ce){X.push(Ce);var fe=Ce._module;fe&&(a.pushUnique(B,fe),Ce.visible===!0&&a.pushUnique(U,fe),a.pushUnique(ee,Ce._module.basePlotModule),j++,Ce._input.visible!==!1&&Q++)}G._transformModules=[];var re={},ne=[],le=($.template||{}).data||{},oe=t.traceTemplater(le);for(W=0;W<V.length;W++){if(N=V[W],(te=oe.newTrace(N)).uid=G._traceUids[W],s.supplyTraceDefaults(N,te,Q,G,W),te.index=W,te._input=N,te._expandedIndex=j,te.transforms&&te.transforms.length)for(var de=N.visible!==!1&&te.visible===!1,se=A(te,X,$,G),me=0;me<se.length;me++){var Te=se[me],_e={_template:te._template,type:te.type,uid:te.uid+me};de&&Te.visible===!1&&delete Te.visible,s.supplyTraceDefaults(Te,_e,j,G,W),h(_e,Te),_e.index=W,_e._input=N,_e._fullInput=te,_e._expandedIndex=j,_e._expandedInput=Te,K(_e)}else te._fullInput=te,te._expandedInput=te,K(te);e.traceIs(te,"carpetAxis")&&(re[te.carpet]=te),e.traceIs(te,"carpetDependent")&&ne.push(W)}for(W=0;W<ne.length;W++)if((te=X[ne[W]]).visible){var be=re[te.carpet];te._carpet=be,be&&be.visible?(te.xaxis=be.xaxis,te.yaxis=be.yaxis):te.visible=!1}},s.supplyAnimationDefaults=function(V){var X;V=V||{};var $={};function G(W,te){return a.coerce(V||{},$,u,W,te)}if(G("mode"),G("direction"),G("fromcurrent"),Array.isArray(V.frame))for($.frame=[],X=0;X<V.frame.length;X++)$.frame[X]=s.supplyAnimationFrameDefaults(V.frame[X]||{});else $.frame=s.supplyAnimationFrameDefaults(V.frame||{});if(Array.isArray(V.transition))for($.transition=[],X=0;X<V.transition.length;X++)$.transition[X]=s.supplyAnimationTransitionDefaults(V.transition[X]||{});else $.transition=s.supplyAnimationTransitionDefaults(V.transition||{});return $},s.supplyAnimationFrameDefaults=function(V){var X={};function $(G,W){return a.coerce(V||{},X,u.frame,G,W)}return $("duration"),$("redraw"),X},s.supplyAnimationTransitionDefaults=function(V){var X={};function $(G,W){return a.coerce(V||{},X,u.transition,G,W)}return $("duration"),$("easing"),X},s.supplyFrameDefaults=function(V){var X={};function $(G,W){return a.coerce(V,X,f,G,W)}return $("group"),$("name"),$("traces"),$("baseframe"),$("data"),$("layout"),X},s.supplyTraceDefaults=function(V,X,$,G,W){var te,N=G.colorway||r.defaults,B=N[$%N.length];function U(se,me){return a.coerce(V,X,s.attributes,se,me)}var ee=U("visible");U("type"),U("name",G._traceWord+" "+W),U("uirevision",G.uirevision);var j=s.getModule(X);if(X._module=j,j){var Q=j.basePlotModule,K=Q.attr,re=Q.attributes;if(K&&re){var ne=G._subplots,le="";if(ee||Q.name!=="gl2d"){if(Array.isArray(K))for(te=0;te<K.length;te++){var oe=K[te],de=a.coerce(V,X,re,oe);ne[oe]&&a.pushUnique(ne[oe],de),le+=de}else le=a.coerce(V,X,re,K);ne[Q.name]&&a.pushUnique(ne[Q.name],le)}}}return ee&&(U("customdata"),U("ids"),U("meta"),e.traceIs(X,"showLegend")?(a.coerce(V,X,j.attributes.showlegend?j.attributes:s.attributes,"showlegend"),U("legendgroup"),U("legendgrouptitle.text"),U("legendrank"),X._dfltShowLegend=!0):X._dfltShowLegend=!1,j&&j.supplyDefaults(V,X,B,G),e.traceIs(X,"noOpacity")||U("opacity"),e.traceIs(X,"notLegendIsolatable")&&(X.visible=!!X.visible),e.traceIs(X,"noHover")||(X.hovertemplate||a.coerceHoverinfo(V,X,G),X.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(V,X,B,G)),j&&j.selectPoints&&U("selectedpoints"),s.supplyTransformDefaults(V,X,G)),X},s.hasMakesDataTransform=L,s.supplyTransformDefaults=function(V,X,$){if(X._length||L(V)){var G=$._globalTransforms||[],W=$._transformModules||[];if(Array.isArray(V.transforms)||G.length!==0)for(var te=V.transforms||[],N=G.concat(te),B=X.transforms=[],U=0;U<N.length;U++){var ee,j=N[U],Q=j.type,K=x[Q],re=!(j._module&&j._module===K),ne=K&&typeof K.transform=="function";K||a.warn("Unrecognized transform type "+Q+"."),K&&K.supplyDefaults&&(re||ne)?((ee=K.supplyDefaults(j,X,$,V)).type=Q,ee._module=K,a.pushUnique(W,K)):ee=a.extendFlat({},j),B.push(ee)}}},s.supplyLayoutGlobalDefaults=function(V,X,$){function G(U,ee){return a.coerce(V,X,s.layoutAttributes,U,ee)}var W=V.template;a.isPlainObject(W)&&(X.template=W,X._template=W.layout,X._dataTemplate=W.data),G("autotypenumbers");var te=a.coerceFont(G,"font"),N=te.size;a.coerceFont(G,"title.font",a.extendFlat({},te,{size:Math.round(1.4*N)})),G("title.text",X._dfltTitle.plot),G("title.xref"),G("title.yref"),G("title.x"),G("title.y"),G("title.xanchor"),G("title.yanchor"),G("title.pad.t"),G("title.pad.r"),G("title.pad.b"),G("title.pad.l"),G("uniformtext.mode")&&G("uniformtext.minsize"),G("autosize",!(V.width&&V.height)),G("width"),G("height"),G("margin.l"),G("margin.r"),G("margin.t"),G("margin.b"),G("margin.pad"),G("margin.autoexpand"),V.width&&V.height&&s.sanitizeMargins(X),e.getComponentMethod("grid","sizeDefaults")(V,X),G("paper_bgcolor"),G("separators",$.decimal+$.thousands),G("hidesources"),G("colorway"),G("datarevision");var B=G("uirevision");G("editrevision",B),G("selectionrevision",B),e.getComponentMethod("modebar","supplyLayoutDefaults")(V,X),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(V,X,G),e.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(V,X,G),G("meta"),a.isPlainObject(V.transition)&&(G("transition.duration"),G("transition.easing"),G("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(V,X,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(V,X,G)},s.plotAutoSize=function(V,X,$){var G,W,te=V._context||{},N=te.frameMargins,B=a.isPlotDiv(V);if(B&&V.emit("plotly_autosize"),te.fillFrame)G=window.innerWidth,W=window.innerHeight,document.body.style.overflow="hidden";else{var U=B?window.getComputedStyle(V):{};if(G=I(U.width)||I(U.maxWidth)||$.width,W=I(U.height)||I(U.maxHeight)||$.height,y(N)&&N>0){var ee=1-2*N;G=Math.round(ee*G),W=Math.round(ee*W)}}var j=s.layoutAttributes.width.min,Q=s.layoutAttributes.height.min;G<j&&(G=j),W<Q&&(W=Q);var K=!X.width&&Math.abs($.width-G)>1,re=!X.height&&Math.abs($.height-W)>1;(re||K)&&(K&&($.width=G),re&&($.height=W)),V._initialAutoSize||(V._initialAutoSize={width:G,height:W}),s.sanitizeMargins($)},s.supplyLayoutModuleDefaults=function(V,X,$,G){var W,te,N,B=e.componentsRegistry,U=X._basePlotModules,ee=e.subplotsRegistry.cartesian;for(W in B)(N=B[W]).includeBasePlot&&N.includeBasePlot(V,X);for(var j in U.length||U.push(ee),X._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(V,X),ee.finalizeSubplots(V,X)),X._subplots)X._subplots[j].sort(a.subplotSort);for(te=0;te<U.length;te++)(N=U[te]).supplyLayoutDefaults&&N.supplyLayoutDefaults(V,X,$);var Q=X._modules;for(te=0;te<Q.length;te++)(N=Q[te]).supplyLayoutDefaults&&N.supplyLayoutDefaults(V,X,$);var K=X._transformModules;for(te=0;te<K.length;te++)(N=K[te]).supplyLayoutDefaults&&N.supplyLayoutDefaults(V,X,$,G);for(W in B)(N=B[W]).supplyLayoutDefaults&&N.supplyLayoutDefaults(V,X,$)},s.purge=function(V){var X=V._fullLayout||{};X._glcontainer!==void 0&&(X._glcontainer.selectAll(".gl-canvas").remove(),X._glcontainer.remove(),X._glcanvas=null),X._modeBar&&X._modeBar.destroy(),V._transitionData&&(V._transitionData._interruptCallbacks&&(V._transitionData._interruptCallbacks.length=0),V._transitionData._animationRaf&&window.cancelAnimationFrame(V._transitionData._animationRaf)),a.clearThrottle(),a.clearResponsive(V),delete V.data,delete V.layout,delete V._fullData,delete V._fullLayout,delete V.calcdata,delete V.empty,delete V.fid,delete V.undoqueue,delete V.undonum,delete V.autoplay,delete V.changed,delete V._promises,delete V._redrawTimer,delete V._hmlumcount,delete V._hmpixcount,delete V._transitionData,delete V._transitioning,delete V._initialAutoSize,delete V._transitioningWithDuration,delete V._dragging,delete V._dragged,delete V._dragdata,delete V._hoverdata,delete V._snapshotInProgress,delete V._editing,delete V._mouseDownTime,delete V._legendMouseDownTime,V.removeAllListeners&&V.removeAllListeners()},s.style=function(V){var X,$=V._fullLayout._visibleModules,G=[];for(X=0;X<$.length;X++){var W=$[X];W.style&&a.pushUnique(G,W.style)}for(X=0;X<G.length;X++)G[X](V)},s.sanitizeMargins=function(V){if(V&&V.margin){var X,$=V.width,G=V.height,W=V.margin,te=$-(W.l+W.r),N=G-(W.t+W.b);te<0&&(X=($-1)/(W.l+W.r),W.l=Math.floor(X*W.l),W.r=Math.floor(X*W.r)),N<0&&(X=(G-1)/(W.t+W.b),W.t=Math.floor(X*W.t),W.b=Math.floor(X*W.b))}},s.clearAutoMarginIds=function(V){V._fullLayout._pushmarginIds={}},s.allowAutoMargin=function(V,X){V._fullLayout._pushmarginIds[X]=1},s.autoMargin=function(V,X,$){var G=V._fullLayout,W=G.width,te=G.height,N=G.margin,B=a.constrain(W-N.l-N.r,2,64),U=a.constrain(te-N.t-N.b,2,64),ee=Math.max(0,W-B),j=Math.max(0,te-U),Q=G._pushmargin,K=G._pushmarginIds;if(N.autoexpand!==!1){if($){var re=$.pad;if(re===void 0&&(re=Math.min(12,N.l,N.r,N.t,N.b)),ee){var ne=($.l+$.r)/ee;ne>1&&($.l/=ne,$.r/=ne)}if(j){var le=($.t+$.b)/j;le>1&&($.t/=le,$.b/=le)}var oe=$.xl!==void 0?$.xl:$.x,de=$.xr!==void 0?$.xr:$.x,se=$.yt!==void 0?$.yt:$.y,me=$.yb!==void 0?$.yb:$.y;Q[X]={l:{val:oe,size:$.l+re},r:{val:de,size:$.r+re},b:{val:me,size:$.b+re},t:{val:se,size:$.t+re}},K[X]=1}else delete Q[X],delete K[X];if(!G._replotting)return s.doAutoMargin(V)}},s.doAutoMargin=function(V){var X=V._fullLayout,$=X.width,G=X.height;X._size||(X._size={}),P(X);var W=X._size,te=X.margin,N=a.extendFlat({},W),B=te.l,U=te.r,ee=te.t,j=te.b,Q=X._pushmargin,K=X._pushmarginIds;if(X.margin.autoexpand!==!1){for(var re in Q)K[re]||delete Q[re];for(var ne in Q.base={l:{val:0,size:B},r:{val:1,size:U},t:{val:1,size:ee},b:{val:0,size:j}},Q){var le=Q[ne].l||{},oe=Q[ne].b||{},de=le.val,se=le.size,me=oe.val,Te=oe.size;for(var _e in Q){if(y(se)&&Q[_e].r){var be=Q[_e].r.val,Ce=Q[_e].r.size;if(be>de){var fe=(se*be+(Ce-$)*de)/(be-de),ve=(Ce*(1-de)+(se-$)*(1-be))/(be-de);fe+ve>B+U&&(B=fe,U=ve)}}if(y(Te)&&Q[_e].t){var Me=Q[_e].t.val,ke=Q[_e].t.size;if(Me>me){var Le=(Te*Me+(ke-G)*me)/(Me-me),ze=(ke*(1-me)+(Te-G)*(1-Me))/(Me-me);Le+ze>j+ee&&(j=Le,ee=ze)}}}}}var Re=a.constrain($-te.l-te.r,2,64),Oe=a.constrain(G-te.t-te.b,2,64),Ze=Math.max(0,$-Re),Pe=Math.max(0,G-Oe);if(Ze){var Ie=(B+U)/Ze;Ie>1&&(B/=Ie,U/=Ie)}if(Pe){var Be=(j+ee)/Pe;Be>1&&(j/=Be,ee/=Be)}if(W.l=Math.round(B),W.r=Math.round(U),W.t=Math.round(ee),W.b=Math.round(j),W.p=Math.round(te.pad),W.w=Math.round($)-W.l-W.r,W.h=Math.round(G)-W.t-W.b,!X._replotting&&s.didMarginChange(N,W)){"_redrawFromAutoMarginCount"in X?X._redrawFromAutoMarginCount++:X._redrawFromAutoMarginCount=1;var Fe=3*(1+Object.keys(K).length);if(X._redrawFromAutoMarginCount<Fe)return e.call("_doPlot",V);X._size=N,a.warn("Too many auto-margin redraws.")}(function($e){var ot=o.list($e,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(pt){for(var _t=0;_t<ot.length;_t++){var yt=ot[_t][pt];yt&&yt()}})})(V)};var S=["l","r","t","b","p","w","h"];function E(V,X,$){var G=!1,W=[s.previousPromises,function(){if(V._transitionData)return V._transitioning=!1,function(N){var B=Promise.resolve();if(!N)return B;for(;N.length;)B=B.then(N.shift());return B}(V._transitionData._interruptCallbacks)},$.prepareFn,s.rehover,s.reselect,function(){return V.emit("plotly_transitioning",[]),new Promise(function(N){V._transitioning=!0,X.duration>0&&(V._transitioningWithDuration=!0),V._transitionData._interruptCallbacks.push(function(){G=!0}),$.redraw&&V._transitionData._interruptCallbacks.push(function(){return e.call("redraw",V)}),V._transitionData._interruptCallbacks.push(function(){V.emit("plotly_transitioninterrupted",[])});var B=0,U=0;function ee(){return B++,function(){U++,G||U!==B||function(j){!V._transitionData||(function(Q){if(Q)for(;Q.length;)Q.shift()}(V._transitionData._interruptCallbacks),Promise.resolve().then(function(){if($.redraw)return e.call("redraw",V)}).then(function(){V._transitioning=!1,V._transitioningWithDuration=!1,V.emit("plotly_transitioned",[])}).then(j))}(N)}}$.runFn(ee),setTimeout(ee())})}],te=a.syncOrAsync(W,V);return te&&te.then||(te=Promise.resolve()),te.then(function(){return V})}s.didMarginChange=function(V,X){for(var $=0;$<S.length;$++){var G=S[$],W=V[G],te=X[G];if(!y(W)||Math.abs(te-W)>1)return!0}return!1},s.graphJson=function(V,X,$,G,W,te){(W&&X&&!V._fullData||W&&!X&&!V._fullLayout)&&s.supplyDefaults(V);var N=W?V._fullData:V.data,B=W?V._fullLayout:V.layout,U=(V._transitionData||{})._frames;function ee(K,re){if(typeof K=="function")return re?"_function_":null;if(a.isPlainObject(K)){var ne,le={};return Object.keys(K).sort().forEach(function(oe){if(["_","["].indexOf(oe.charAt(0))===-1)if(typeof K[oe]!="function"){if($==="keepdata"){if(oe.substr(oe.length-3)==="src")return}else if($==="keepstream"){if(typeof(ne=K[oe+"src"])=="string"&&ne.indexOf(":")>0&&!a.isPlainObject(K.stream))return}else if($!=="keepall"&&typeof(ne=K[oe+"src"])=="string"&&ne.indexOf(":")>0)return;le[oe]=ee(K[oe],re)}else re&&(le[oe]="_function")}),le}return Array.isArray(K)?K.map(function(oe){return ee(oe,re)}):a.isTypedArray(K)?a.simpleMap(K,a.identity):a.isJSDate(K)?a.ms2DateTimeLocal(+K):K}var j={data:(N||[]).map(function(K){var re=ee(K);return X&&delete re.fit,re})};if(!X&&(j.layout=ee(B),W)){var Q=B._size;j.layout.computed={margin:{b:Q.b,l:Q.l,r:Q.r,t:Q.t}}}return U&&(j.frames=ee(U)),te&&(j.config=ee(V._context,!0)),G==="object"?j:JSON.stringify(j)},s.modifyFrames=function(V,X){var $,G,W,te=V._transitionData._frames,N=V._transitionData._frameHash;for($=0;$<X.length;$++)switch((G=X[$]).type){case"replace":W=G.value;var B=(te[G.index]||{}).name,U=W.name;te[G.index]=N[U]=W,U!==B&&(delete N[B],N[U]=W);break;case"insert":N[(W=G.value).name]=W,te.splice(G.index,0,W);break;case"delete":delete N[(W=te[G.index]).name],te.splice(G.index,1)}return Promise.resolve()},s.computeFrame=function(V,X){var $,G,W,te,N=V._transitionData._frameHash;if(!X)throw new Error("computeFrame must be given a string frame name");var B=N[X.toString()];if(!B)return!1;for(var U=[B],ee=[B.name];B.baseframe&&(B=N[B.baseframe.toString()])&&ee.indexOf(B.name)===-1;)U.push(B),ee.push(B.name);for(var j={};B=U.pop();)if(B.layout&&(j.layout=s.extendLayout(j.layout,B.layout)),B.data){if(j.data||(j.data=[]),!(G=B.traces))for(G=[],$=0;$<B.data.length;$++)G[$]=$;for(j.traces||(j.traces=[]),$=0;$<B.data.length;$++)(W=G[$])!=null&&((te=j.traces.indexOf(W))===-1&&(te=j.data.length,j.traces[te]=W),j.data[te]=s.extendTrace(j.data[te],B.data[$]))}return j},s.recomputeFrameHash=function(V){for(var X=V._transitionData._frameHash={},$=V._transitionData._frames,G=0;G<$.length;G++){var W=$[G];W&&W.name&&(X[W.name]=W)}},s.extendObjectWithContainers=function(V,X,$){var G,W,te,N,B,U,ee,j=a.extendDeepNoArrays({},X||{}),Q=a.expandObjectPaths(j),K={};if($&&$.length)for(te=0;te<$.length;te++)(W=(G=a.nestedProperty(Q,$[te])).get())===void 0?a.nestedProperty(K,$[te]).set(null):(G.set(null),a.nestedProperty(K,$[te]).set(W));if(V=a.extendDeepNoArrays(V||{},Q),$&&$.length){for(te=0;te<$.length;te++)if(U=a.nestedProperty(K,$[te]).get()){for(ee=(B=a.nestedProperty(V,$[te])).get(),Array.isArray(ee)||(ee=[],B.set(ee)),N=0;N<U.length;N++){var re=U[N];ee[N]=re===null?null:s.extendObjectWithContainers(ee[N],re)}B.set(ee)}}return V},s.dataArrayContainers=["transforms","dimensions"],s.layoutArrayContainers=e.layoutArrayContainers,s.extendTrace=function(V,X){return s.extendObjectWithContainers(V,X,s.dataArrayContainers)},s.extendLayout=function(V,X){return s.extendObjectWithContainers(V,X,s.layoutArrayContainers)},s.transition=function(V,X,$,G,W,te){var N={redraw:W.redraw},B={},U=[];return N.prepareFn=function(){for(var ee=Array.isArray(X)?X.length:0,j=G.slice(0,ee),Q=0;Q<j.length;Q++){var K=j[Q],re=V._fullData[K]._module;if(re){if(re.animatable){var ne=re.basePlotModule.name;B[ne]||(B[ne]=[]),B[ne].push(K)}V.data[j[Q]]=s.extendTrace(V.data[j[Q]],X[Q])}}var le=a.expandObjectPaths(a.extendDeepNoArrays({},$)),oe=/^[xy]axis[0-9]*$/;for(var de in le)oe.test(de)&&delete le[de].range;s.extendLayout(V.layout,le),delete V.calcdata,s.supplyDefaults(V),s.doCalcdata(V);var se=a.expandObjectPaths($);if(se){var me=V._fullLayout._plots;for(var Te in me){var _e=me[Te],be=_e.xaxis,Ce=_e.yaxis,fe=be.range.slice(),ve=Ce.range.slice(),Me=null,ke=null,Le=null,ze=null;Array.isArray(se[be._name+".range"])?Me=se[be._name+".range"].slice():Array.isArray((se[be._name]||{}).range)&&(Me=se[be._name].range.slice()),Array.isArray(se[Ce._name+".range"])?ke=se[Ce._name+".range"].slice():Array.isArray((se[Ce._name]||{}).range)&&(ke=se[Ce._name].range.slice()),fe&&Me&&(be.r2l(fe[0])!==be.r2l(Me[0])||be.r2l(fe[1])!==be.r2l(Me[1]))&&(Le={xr0:fe,xr1:Me}),ve&&ke&&(Ce.r2l(ve[0])!==Ce.r2l(ke[0])||Ce.r2l(ve[1])!==Ce.r2l(ke[1]))&&(ze={yr0:ve,yr1:ke}),(Le||ze)&&U.push(a.extendFlat({plotinfo:_e},Le,ze))}}return Promise.resolve()},N.runFn=function(ee){var j,Q,K=V._fullLayout._basePlotModules,re=U.length;if($)for(Q=0;Q<K.length;Q++)K[Q].transitionAxes&&K[Q].transitionAxes(V,U,te,ee);for(var ne in re?((j=a.extendFlat({},te)).duration=0,delete B.cartesian):j=te,B){var le=B[ne];V._fullData[le[0]]._module.basePlotModule.plot(V,le,j,ee)}},E(V,te,N)},s.transitionFromReact=function(V,X,$,G){var W=V._fullLayout,te=W.transition,N={},B=[];return N.prepareFn=function(){var U=W._plots;for(var ee in N.redraw=!1,X.anim==="some"&&(N.redraw=!0),$.anim==="some"&&(N.redraw=!0),U){var j=U[ee],Q=j.xaxis,K=j.yaxis,re=G[Q._name].range.slice(),ne=G[K._name].range.slice(),le=Q.range.slice(),oe=K.range.slice();Q.setScale(),K.setScale();var de=null,se=null;Q.r2l(re[0])===Q.r2l(le[0])&&Q.r2l(re[1])===Q.r2l(le[1])||(de={xr0:re,xr1:le}),K.r2l(ne[0])===K.r2l(oe[0])&&K.r2l(ne[1])===K.r2l(oe[1])||(se={yr0:ne,yr1:oe}),(de||se)&&B.push(a.extendFlat({plotinfo:j},de,se))}return Promise.resolve()},N.runFn=function(U){for(var ee,j,Q,K=V._fullData,re=V._fullLayout._basePlotModules,ne=[],le=0;le<K.length;le++)ne.push(le);function oe(){if(V._fullLayout)for(var se=0;se<re.length;se++)re[se].transitionAxes&&re[se].transitionAxes(V,B,ee,U)}function de(){if(V._fullLayout)for(var se=0;se<re.length;se++)re[se].plot(V,Q,j,U)}B.length&&X.anim?te.ordering==="traces first"?(ee=a.extendFlat({},te,{duration:0}),Q=ne,j=te,setTimeout(oe,te.duration),de()):(ee=te,Q=null,j=a.extendFlat({},te,{duration:0}),setTimeout(de,ee.duration),oe()):B.length?(ee=te,oe()):X.anim&&(Q=ne,j=te,de())},E(V,te,N)},s.doCalcdata=function(V,X){var $,G,W,te,N=o.list(V),B=V._fullData,U=V._fullLayout,ee=new Array(B.length),j=(V.calcdata||[]).slice();for(V.calcdata=ee,U._numBoxes=0,U._numViolins=0,U._violinScaleGroupStats={},V._hmpixcount=0,V._hmlumcount=0,U._piecolormap={},U._sunburstcolormap={},U._treemapcolormap={},U._iciclecolormap={},U._funnelareacolormap={},W=0;W<B.length;W++)Array.isArray(X)&&X.indexOf(W)===-1&&(ee[W]=j[W]);for(W=0;W<B.length;W++)($=B[W])._arrayAttrs=n.findArrayAttributes($),$._extremes={};var Q=U._subplots.polar||[];for(W=0;W<Q.length;W++)N.push(U[Q[W]].radialaxis,U[Q[W]].angularaxis);for(var K in U._colorAxes){var re=U[K];re.cauto!==!1&&(delete re.cmin,delete re.cmax)}var ne=!1;function le(se){if($=B[se],G=$._module,$.visible===!0&&$.transforms){if(G&&G.calc){var me=G.calc(V,$);me[0]&&me[0].t&&me[0].t._scene&&delete me[0].t._scene.dirty}for(te=0;te<$.transforms.length;te++){var Te=$.transforms[te];(G=x[Te.type])&&G.calcTransform&&($._hasCalcTransform=!0,ne=!0,G.calcTransform(V,$,Te))}}}function oe(se,me){if($=B[se],!!(G=$._module).isContainer===me){var Te=[];if($.visible===!0&&$._length!==0){delete $._indexToPoints;var _e=$.transforms||[];for(te=_e.length-1;te>=0;te--)if(_e[te].enabled){$._indexToPoints=_e[te]._indexToPoints;break}G&&G.calc&&(Te=G.calc(V,$))}Array.isArray(Te)&&Te[0]||(Te=[{x:m,y:m}]),Te[0].t||(Te[0].t={}),Te[0].trace=$,ee[se]=Te}}for(R(N,B,U),W=0;W<B.length;W++)oe(W,!0);for(W=0;W<B.length;W++)le(W);for(ne&&R(N,B,U),W=0;W<B.length;W++)oe(W,!0);for(W=0;W<B.length;W++)oe(W,!1);H(V);var de=function(se,me){var Te,_e,be,Ce,fe,ve=[];function Me(Ht,Ue,We){var he=Ue._id.charAt(0);if(Ht==="histogram2dcontour"){var xe=Ue._counterAxes[0],De=o.getFromId(me,xe),qe=he==="x"||xe==="x"&&De.type==="category",Xe=he==="y"||xe==="y"&&De.type==="category";return function(He,st){return He===0||st===0||qe&&He===We[st].length-1||Xe&&st===We.length-1?-1:(he==="y"?st:He)-1}}return function(He,st){return he==="y"?st:He}}var ke={min:function(Ht){return a.aggNums(Math.min,null,Ht)},max:function(Ht){return a.aggNums(Math.max,null,Ht)},sum:function(Ht){return a.aggNums(function(Ue,We){return Ue+We},null,Ht)},total:function(Ht){return a.aggNums(function(Ue,We){return Ue+We},null,Ht)},mean:function(Ht){return a.mean(Ht)},median:function(Ht){return a.median(Ht)}};for(Te=0;Te<se.length;Te++){var Le=se[Te];if(Le.type==="category"){var ze=Le.categoryorder.match(D);if(ze){var Re=ze[1],Oe=ze[2],Ze=Le._id.charAt(0),Pe=Ze==="x",Ie=[];for(_e=0;_e<Le._categories.length;_e++)Ie.push([Le._categories[_e],[]]);for(_e=0;_e<Le._traceIndices.length;_e++){var Be=Le._traceIndices[_e],Fe=me._fullData[Be];if(Fe.visible===!0){var $e=Fe.type;e.traceIs(Fe,"histogram")&&(delete Fe._xautoBinFinished,delete Fe._yautoBinFinished);var ot=$e==="splom",pt=$e==="scattergl",_t=me.calcdata[Be];for(be=0;be<_t.length;be++){var yt,tt,Ke=_t[be];if(ot){var vt=Fe._axesDim[Le._id];if(!Pe){var Nt=Fe._diag[vt][0];Nt&&(Le=me._fullLayout[o.id2name(Nt)])}var qt=Ke.trace.dimensions[vt].values;for(Ce=0;Ce<qt.length;Ce++)for(yt=Le._categoriesMap[qt[Ce]],fe=0;fe<Ke.trace.dimensions.length;fe++)if(fe!==vt){var er=Ke.trace.dimensions[fe];Ie[yt][1].push(er.values[Ce])}}else if(pt){for(Ce=0;Ce<Ke.t.x.length;Ce++)Pe?(yt=Ke.t.x[Ce],tt=Ke.t.y[Ce]):(yt=Ke.t.y[Ce],tt=Ke.t.x[Ce]),Ie[yt][1].push(tt);Ke.t&&Ke.t._scene&&delete Ke.t._scene.dirty}else if(Ke.hasOwnProperty("z")){tt=Ke.z;var Jt=Me(Fe.type,Le,tt);for(Ce=0;Ce<tt.length;Ce++)for(fe=0;fe<tt[Ce].length;fe++)(yt=Jt(fe,Ce))+1&&Ie[yt][1].push(tt[Ce][fe])}else for((yt=Ke.p)===void 0&&(yt=Ke[Ze]),(tt=Ke.s)===void 0&&(tt=Ke.v),tt===void 0&&(tt=Pe?Ke.y:Ke.x),Array.isArray(tt)||(tt=tt===void 0?[]:[tt]),Ce=0;Ce<tt.length;Ce++)Ie[yt][1].push(tt[Ce])}}}Le._categoriesValue=Ie;var ir=[];for(_e=0;_e<Ie.length;_e++)ir.push([Ie[_e][0],ke[Re](Ie[_e][1])]);ir.sort(function(Ht,Ue){return Ht[1]-Ue[1]}),Le._categoriesAggregatedValue=ir,Le._initialCategories=ir.map(function(Ht){return Ht[0]}),Oe==="descending"&&Le._initialCategories.reverse(),ve=ve.concat(Le.sortByInitialCategories())}}}return ve}(N,V);if(de.length){for(U._numBoxes=0,U._numViolins=0,W=0;W<de.length;W++)oe(de[W],!0);for(W=0;W<de.length;W++)oe(de[W],!1);H(V)}e.getComponentMethod("fx","calc")(V),e.getComponentMethod("errorbars","calc")(V)};var D=/(total|sum|min|max|mean|median) (ascending|descending)/;function R(V,X,$){var G={};function W(U){U.clearCalc(),U.type==="multicategory"&&U.setupMultiCategory(X),G[U._id]=1}a.simpleMap(V,W);for(var te=$._axisMatchGroups||[],N=0;N<te.length;N++)for(var B in te[N])G[B]||W($[o.id2name(B)])}function H(V){var X,$,G,W=V._fullLayout,te=W._visibleModules,N={};for($=0;$<te.length;$++){var B=te[$],U=B.crossTraceCalc;if(U){var ee=B.basePlotModule.name;N[ee]?a.pushUnique(N[ee],U):N[ee]=[U]}}for(G in N){var j=N[G],Q=W._subplots[G];if(Array.isArray(Q))for(X=0;X<Q.length;X++){var K=Q[X],re=G==="cartesian"?W._plots[K]:W[K];for($=0;$<j.length;$++)j[$](V,re,K)}else for($=0;$<j.length;$++)j[$](V)}}s.rehover=function(V){V._fullLayout._rehover&&V._fullLayout._rehover()},s.redrag=function(V){V._fullLayout._redrag&&V._fullLayout._redrag()},s.reselect=function(V){var X=V._fullLayout,$=(V.layout||{}).selections,G=X._previousSelections;X._previousSelections=$;var W=X._reselect||JSON.stringify($)!==JSON.stringify(G);e.getComponentMethod("selections","reselect")(V,W)},s.generalUpdatePerTraceModule=function(V,X,$,G){var W,te=X.traceHash,N={};for(W=0;W<$.length;W++){var B=$[W],U=B[0].trace;U.visible&&(N[U.type]=N[U.type]||[],N[U.type].push(B))}for(var ee in te)if(!N[ee]){var j=te[ee][0];j[0].trace.visible=!1,N[ee]=[j]}for(var Q in N){var K=N[Q];K[0][0].trace._module.plot(V,X,a.filterVisible(K),G)}X.traceHash=N},s.plotBasePlot=function(V,X,$,G,W){var te=e.getModule(V),N=l(X.calcdata,te)[0];te.plot(X,N,G,W)},s.cleanBasePlot=function(V,X,$,G,W){var te=W._has&&W._has(V),N=$._has&&$._has(V);te&&!N&&W["_"+V+"layer"].selectAll("g.trace").remove()}},{"../components/color":367,"../components/shapes/handle_outline":468,"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plot_api/plot_template":555,"../plots/get_data":602,"../registry":647,"./animation_attributes":560,"./attributes":562,"./cartesian/axis_ids":570,"./command":592,"./font_attributes":594,"./frame_attributes":595,"./layout_attributes":619,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],629:[function(v,J,Z){J.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],630:[function(v,J,Z){var p=v("../../lib"),g=v("../../lib/polygon").tester,b=p.findIndexOfMin,y=p.isAngleInsideSector,e=p.angleDelta,n=p.angleDist;function t(o,i,u,f){var l,h,d=f[0],s=f[1],x=r(Math.sin(i)-Math.sin(o)),c=r(Math.cos(i)-Math.cos(o)),T=Math.tan(u),_=r(1/T),w=x/c,k=s-w*d;return _?x&&c?h=T*(l=k/(T-w)):c?(l=s*_,h=s):(l=d,h=d*T):x&&c?(l=0,h=k):c?(l=0,h=s):l=h=NaN,[l,h]}function a(o,i,u,f){return p.isFullCircle([i,u])?function(l,h){var d,s=h.length,x=new Array(s+1);for(d=0;d<s;d++){var c=h[d];x[d]=[l*Math.cos(c),l*Math.sin(c)]}return x[d]=x[0].slice(),x}(o,f):function(l,h,d,s){var x,c,T=s.length,_=[];function w(R){return[l*Math.cos(R),l*Math.sin(R)]}function k(R,H,V){return t(R,H,V,w(R))}function L(R){return p.mod(R,T)}function A(R){return y(R,[h,d])}var I=b(s,function(R){return A(R)?n(R,h):1/0}),P=k(s[I],s[L(I-1)],h);for(_.push(P),x=I,c=0;c<T;x++,c++){var S=s[L(x)];if(!A(S))break;_.push(w(S))}var E=b(s,function(R){return A(R)?n(R,d):1/0}),D=k(s[E],s[L(E+1)],d);return _.push(D),_.push([0,0]),_.push(_[0].slice()),_}(o,i,u,f)}function r(o){return Math.abs(o)>1e-10?o:0}function m(o,i,u){i=i||0,u=u||0;for(var f=o.length,l=new Array(f),h=0;h<f;h++){var d=o[h];l[h]=[i+d[0],u-d[1]]}return l}J.exports={isPtInsidePolygon:function(o,i,u,f,l){if(!y(i,f))return!1;var h,d;u[0]<u[1]?(h=u[0],d=u[1]):(h=u[1],d=u[0]);var s=g(a(h,f[0],f[1],l)),x=g(a(d,f[0],f[1],l)),c=[o*Math.cos(i),o*Math.sin(i)];return x.contains(c)&&!s.contains(c)},findPolygonOffset:function(o,i,u,f){for(var l=1/0,h=1/0,d=a(o,i,u,f),s=0;s<d.length;s++){var x=d[s];l=Math.min(l,x[0]),h=Math.min(h,-x[1])}return[l,h]},findEnclosingVertexAngles:function(o,i){var u=b(i,function(l){var h=e(l,o);return h>0?h:1/0}),f=p.mod(u+1,i.length);return[i[u],i[f]]},findIntersectionXY:t,findXYatLength:function(o,i,u,f){var l=-i*u,h=i*i+1,d=2*(i*l-u),s=l*l+u*u-o*o,x=Math.sqrt(d*d-4*h*s),c=(-d+x)/(2*h),T=(-d-x)/(2*h);return[[c,i*c+l+f],[T,i*T+l+f]]},clampTiny:r,pathPolygon:function(o,i,u,f,l,h){return"M"+m(a(o,i,u,f),l,h).join("L")},pathPolygonAnnulus:function(o,i,u,f,l,h,d){var s,x;o<i?(s=o,x=i):(s=i,x=o);var c=m(a(s,u,f,l),h,d);return"M"+m(a(x,u,f,l),h,d).reverse().join("L")+"M"+c.join("L")}}},{"../../lib":515,"../../lib/polygon":527}],631:[function(v,J,Z){var p=v("../get_data").getSubplotCalcData,g=v("../../lib").counterRegex,b=v("./polar"),y=v("./constants"),e=y.attr,n=y.name,t=g(n),a={};a[e]={valType:"subplotid",dflt:n,editType:"calc"},J.exports={attr:e,name:n,idRoot:n,idRegex:t,attrRegex:t,attributes:a,layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),plot:function(r){for(var m=r._fullLayout,o=r.calcdata,i=m._subplots[n],u=0;u<i.length;u++){var f=i[u],l=p(o,n,f),h=m[f]._subplot;h||(h=b(r,f),m[f]._subplot=h),h.plot(l,m,r._promises)}},clean:function(r,m,o,i){for(var u=i._subplots[n]||[],f=i._has&&i._has("gl"),l=m._has&&m._has("gl"),h=f&&!l,d=0;d<u.length;d++){var s=u[d],x=i[s]._subplot;if(!m[s]&&x)for(var c in x.framework.remove(),x.layers["radial-axis-title"].remove(),x.clipPaths)x.clipPaths[c].remove();h&&x._scene&&(x._scene.destroy(),x._scene=null)}},toSVG:v("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"./constants":629,"./layout_attributes":632,"./layout_defaults":633,"./polar":634}],632:[function(v,J,Z){var p=v("../../components/color/attributes"),g=v("../cartesian/layout_attributes"),b=v("../domain").attributes,y=v("../../lib").extendFlat,e=v("../../plot_api/edit_types").overrideAll,n=e({color:g.color,showline:y({},g.showline,{dflt:!0}),linecolor:g.linecolor,linewidth:g.linewidth,showgrid:y({},g.showgrid,{dflt:!0}),gridcolor:g.gridcolor,gridwidth:g.gridwidth,griddash:g.griddash},"plot","from-root"),t=e({tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:g.ticks,ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,ticklabelstep:g.ticklabelstep,showticklabels:g.showticklabels,showtickprefix:g.showtickprefix,tickprefix:g.tickprefix,showticksuffix:g.showticksuffix,ticksuffix:g.ticksuffix,showexponent:g.showexponent,exponentformat:g.exponentformat,minexponent:g.minexponent,separatethousands:g.separatethousands,tickfont:g.tickfont,tickangle:g.tickangle,tickformat:g.tickformat,tickformatstops:g.tickformatstops,layer:g.layer},"plot","from-root"),a={visible:y({},g.visible,{dflt:!0}),type:y({},g.type,{values:["-","linear","log","date","category"]}),autotypenumbers:g.autotypenumbers,autorange:y({},g.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:y({},g.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:g.categoryorder,categoryarray:g.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:y({},g.title.text,{editType:"plot",dflt:""}),font:y({},g.title.font,{editType:"plot"}),editType:"plot"},hoverformat:g.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:g._deprecated.title,titlefont:g._deprecated.titlefont}};y(a,n,t);var r={visible:y({},g.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:g.autotypenumbers,categoryorder:g.categoryorder,categoryarray:g.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:g.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};y(r,n,t),J.exports={domain:b({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:p.background},radialaxis:a,angularaxis:r,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],633:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/color"),b=v("../../plot_api/plot_template"),y=v("../subplot_defaults"),e=v("../get_data").getSubplotData,n=v("../cartesian/tick_value_defaults"),t=v("../cartesian/tick_mark_defaults"),a=v("../cartesian/tick_label_defaults"),r=v("../cartesian/prefix_suffix_defaults"),m=v("../cartesian/category_order_defaults"),o=v("../cartesian/line_grid_defaults"),i=v("../cartesian/axis_autotype"),u=v("./layout_attributes"),f=v("./set_convert"),l=v("./constants"),h=l.axisNames;function d(x,c,T,_){var w=T("bgcolor");_.bgColor=g.combine(w,_.paper_bgcolor);var k=T("sector");T("hole");var L,A=e(_.fullData,l.name,_.id),I=_.layoutOut;function P(ee,j){return T(L+"."+ee,j)}for(var S=0;S<h.length;S++){L=h[S],p.isPlainObject(x[L])||(x[L]={});var E=x[L],D=b.newContainer(c,L);D._id=D._name=L,D._attr=_.id+"."+L,D._traceIndices=A.map(function(ee){return ee._expandedIndex});var R=l.axisName2dataArray[L],H=s(E,D,P,A,R,_);m(E,D,P,{axData:A,dataAttr:R});var V=P("visible");switch(f(D,c,I),P("uirevision",c.uirevision),D._m=1,L){case"radialaxis":var X=P("autorange",!D.isValidRange(E.range));E.autorange=X,!X||H!=="linear"&&H!=="-"||P("rangemode"),X==="reversed"&&(D._m=-1),P("range"),D.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if(H==="date"){p.log("Polar plots do not support date angular axes yet.");for(var $=0;$<A.length;$++)A[$].visible=!1;H=E.type=D.type="linear"}P(H==="linear"?"thetaunit":"period");var G=P("direction");P("rotation",{counterclockwise:0,clockwise:90}[G])}if(r(E,D,P,D.type,{tickSuffixDflt:D.thetaunit==="degrees"?"\xB0":void 0}),V){var W,te,N,B,U=_.font||{};te=(W=P("color"))===E.color?W:U.color,N=U.size,B=U.family,n(E,D,P,D.type),a(E,D,P,D.type,{font:{color:te,size:N,family:B}}),t(E,D,P,{outerTicks:!0}),o(E,D,P,{dfltColor:W,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:u[L]}),P("layer"),L==="radialaxis"&&(P("side"),P("angle",k[0]),P("title.text"),p.coerceFont(P,"title.font",{color:te,size:p.bigFont(N),family:B}))}H!=="category"&&P("hoverformat"),D._input=E}c.angularaxis.type==="category"&&T("gridshape")}function s(x,c,T,_,w,k){var L=T("autotypenumbers",k.autotypenumbersDflt);if(T("type")==="-"){for(var A,I=0;I<_.length;I++)if(_[I].visible){A=_[I];break}A&&A[w]&&(c.type=i(A[w],"gregorian",{noMultiCategory:!0,autotypenumbers:L})),c.type==="-"?c.type="linear":x.type=c.type}return c.type}J.exports=function(x,c,T){y(x,c,T,{type:l.name,attributes:u,handleDefaults:d,font:c.font,autotypenumbersDflt:c.autotypenumbers,paper_bgcolor:c.paper_bgcolor,fullData:T,layoutOut:c})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/axis_autotype":567,"../cartesian/category_order_defaults":571,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../get_data":602,"../subplot_defaults":641,"./constants":629,"./layout_attributes":632,"./set_convert":635}],634:[function(v,J,Z){var p=v("@plotly/d3"),g=v("tinycolor2"),b=v("../../registry"),y=v("../../lib"),e=y.strRotate,n=y.strTranslate,t=v("../../components/color"),a=v("../../components/drawing"),r=v("../plots"),m=v("../../plots/cartesian/axes"),o=v("../cartesian/set_convert"),i=v("./set_convert"),u=v("../cartesian/autorange").doAutoRange,f=v("../cartesian/dragbox"),l=v("../../components/dragelement"),h=v("../../components/fx"),d=v("../../components/titles"),s=v("../../components/selections").prepSelect,x=v("../../components/selections").selectOnClick,c=v("../../components/selections").clearOutline,T=v("../../lib/setcursor"),_=v("../../lib/clear_gl_canvases"),w=v("../../plot_api/subroutines").redrawReglTraces,k=v("../../constants/alignment").MID_SHIFT,L=v("./constants"),A=v("./helpers"),I=v("../smith/helpers"),P=I.smith,S=I.reactanceArc,E=I.resistanceArc,D=I.smithTransform,R=y._,H=y.mod,V=y.deg2rad,X=y.rad2deg;function $(B,U,ee){this.isSmith=ee||!1,this.id=U,this.gd=B,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var j=B._fullLayout,Q="clip"+j._uid+U;this.clipIds.forTraces=Q+"-for-traces",this.clipPaths.forTraces=j._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=j["_"+(ee?"smith":"polar")+"layer"].append("g").attr("class",U),this.getHole=function(K){return this.isSmith?0:K.hole},this.getSector=function(K){return this.isSmith?[0,360]:K.sector},this.getRadial=function(K){return this.isSmith?K.realaxis:K.radialaxis},this.getAngular=function(K){return this.isSmith?K.imaginaryaxis:K.angularaxis},ee||(this.radialTickLayout=null,this.angularTickLayout=null)}var G=$.prototype;function W(B){var U=B.ticks+String(B.ticklen)+String(B.showticklabels);return"side"in B&&(U+=B.side),U}function te(B,U){return U[y.findIndexOfMin(U,function(ee){return y.angleDist(B,ee)})]}function N(B,U,ee){return U?(B.attr("display",null),B.attr(ee)):B&&B.attr("display","none"),B}J.exports=function(B,U,ee){return new $(B,U,ee)},G.plot=function(B,U){for(var ee=U[this.id],j=!1,Q=0;Q<B.length;Q++)if(B[Q][0].trace.cliponaxis===!1){j=!0;break}this._hasClipOnAxisFalse=j,this.updateLayers(U,ee),this.updateLayout(U,ee),r.generalUpdatePerTraceModule(this.gd,this,B,ee),this.updateFx(U,ee),this.isSmith&&(delete ee.realaxis.range,delete ee.imaginaryaxis.range)},G.updateLayers=function(B,U){var ee=this.isSmith,j=this.layers,Q=this.getRadial(U),K=this.getAngular(U),re=L.layerNames,ne=re.indexOf("frontplot"),le=re.slice(0,ne),oe=K.layer==="below traces",de=Q.layer==="below traces";oe&&le.push("angular-line"),de&&le.push("radial-line"),oe&&le.push("angular-axis"),de&&le.push("radial-axis"),le.push("frontplot"),oe||le.push("angular-line"),de||le.push("radial-line"),oe||le.push("angular-axis"),de||le.push("radial-axis");var se=(ee?"smith":"polar")+"sublayer",me=this.framework.selectAll("."+se).data(le,String);me.enter().append("g").attr("class",function(Te){return se+" "+Te}).each(function(Te){var _e=j[Te]=p.select(this);switch(Te){case"frontplot":ee||_e.append("g").classed("barlayer",!0),_e.append("g").classed("scatterlayer",!0);break;case"backplot":_e.append("g").classed("maplayer",!0);break;case"plotbg":j.bg=_e.append("path");break;case"radial-grid":case"angular-grid":_e.style("fill","none");break;case"radial-line":_e.append("line").style("fill","none");break;case"angular-line":_e.append("path").style("fill","none")}}),me.order()},G.updateLayout=function(B,U){var ee=this.layers,j=B._size,Q=this.getRadial(U),K=this.getAngular(U),re=U.domain.x,ne=U.domain.y;this.xOffset=j.l+j.w*re[0],this.yOffset=j.t+j.h*(1-ne[1]);var le=this.xLength=j.w*(re[1]-re[0]),oe=this.yLength=j.h*(ne[1]-ne[0]),de=this.getSector(U);this.sectorInRad=de.map(V);var se,me,Te,_e,be,Ce=this.sectorBBox=function(pt){var _t,yt,tt,Ke,vt=pt[0],Nt=pt[1]-vt,qt=H(vt,360),er=qt+Nt,Jt=Math.cos(V(qt)),ir=Math.sin(V(qt)),Ht=Math.cos(V(er)),Ue=Math.sin(V(er));return Ke=qt<=90&&er>=90||qt>90&&er>=450?1:ir<=0&&Ue<=0?0:Math.max(ir,Ue),_t=qt<=180&&er>=180||qt>180&&er>=540?-1:Jt>=0&&Ht>=0?0:Math.min(Jt,Ht),yt=qt<=270&&er>=270||qt>270&&er>=630?-1:ir>=0&&Ue>=0?0:Math.min(ir,Ue),tt=er>=360?1:Jt<=0&&Ht<=0?0:Math.max(Jt,Ht),[_t,yt,tt,Ke]}(de),fe=Ce[2]-Ce[0],ve=Ce[3]-Ce[1],Me=oe/le,ke=Math.abs(ve/fe);Me>ke?(se=le,be=(oe-(me=le*ke))/j.h/2,Te=[re[0],re[1]],_e=[ne[0]+be,ne[1]-be]):(me=oe,be=(le-(se=oe/ke))/j.w/2,Te=[re[0]+be,re[1]-be],_e=[ne[0],ne[1]]),this.xLength2=se,this.yLength2=me,this.xDomain2=Te,this.yDomain2=_e;var Le,ze=this.xOffset2=j.l+j.w*Te[0],Re=this.yOffset2=j.t+j.h*(1-_e[1]),Oe=this.radius=se/fe,Ze=this.innerRadius=this.getHole(U)*Oe,Pe=this.cx=ze-Oe*Ce[0],Ie=this.cy=Re+Oe*Ce[3],Be=this.cxx=Pe-ze,Fe=this.cyy=Ie-Re,$e=Q.side;$e==="counterclockwise"?(Le=$e,$e="top"):$e==="clockwise"&&(Le=$e,$e="bottom"),this.radialAxis=this.mockAxis(B,U,Q,{_id:"x",side:$e,_trueSide:Le,domain:[Ze/j.w,Oe/j.w]}),this.angularAxis=this.mockAxis(B,U,K,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(B,U),this.updateAngularAxis(B,U),this.updateRadialAxis(B,U),this.updateRadialAxisTitle(B,U),this.xaxis=this.mockCartesianAxis(B,U,{_id:"x",domain:Te}),this.yaxis=this.mockCartesianAxis(B,U,{_id:"y",domain:_e});var ot=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",ot).attr("transform",n(Be,Fe)),ee.frontplot.attr("transform",n(ze,Re)).call(a.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),ee.bg.attr("d",ot).attr("transform",n(Pe,Ie)).call(t.fill,U.bgcolor)},G.mockAxis=function(B,U,ee,j){var Q=y.extendFlat({},ee,j);return i(Q,U,B),Q},G.mockCartesianAxis=function(B,U,ee){var j=this,Q=j.isSmith,K=ee._id,re=y.extendFlat({type:"linear"},ee);o(re,B);var ne={x:[0,2],y:[1,3]};return re.setRange=function(){var le=j.sectorBBox,oe=ne[K],de=j.radialAxis._rl,se=(de[1]-de[0])/(1-j.getHole(U));re.range=[le[oe[0]]*se,le[oe[1]]*se]},re.isPtWithinRange=K!=="x"||Q?function(){return!0}:function(le){return j.isPtInside(le)},re.setRange(),re.setScale(),re},G.doAutoRange=function(B,U){var ee=this.gd,j=this.radialAxis,Q=this.getRadial(U);u(ee,j);var K=j.range;Q.range=K.slice(),Q._input.range=K.slice(),j._rl=[j.r2l(K[0],null,"gregorian"),j.r2l(K[1],null,"gregorian")]},G.updateRadialAxis=function(B,U){var ee=this,j=ee.gd,Q=ee.layers,K=ee.radius,re=ee.innerRadius,ne=ee.cx,le=ee.cy,oe=ee.getRadial(U),de=H(ee.getSector(U)[0],360),se=ee.radialAxis,me=re<K,Te=ee.isSmith;Te||(ee.fillViewInitialKey("radialaxis.angle",oe.angle),ee.fillViewInitialKey("radialaxis.range",se.range.slice()),se.setGeometry()),se.tickangle==="auto"&&de>90&&de<=270&&(se.tickangle=180);var _e=Te?function(Oe){var Ze=D(ee,P([Oe.x,0]));return n(Ze[0]-ne,Ze[1]-le)}:function(Oe){return n(se.l2p(Oe.x)+re,0)},be=Te?function(Oe){return E(ee,Oe.x,-1/0,1/0)}:function(Oe){return ee.pathArc(se.r2p(Oe.x)+re)},Ce=W(oe);if(ee.radialTickLayout!==Ce&&(Q["radial-axis"].selectAll(".xtick").remove(),ee.radialTickLayout=Ce),me){se.setScale();var fe=0,ve=Te?(se.tickvals||[]).filter(function(Oe){return Oe>=0}).map(function(Oe){return m.tickText(se,Oe,!0,!1)}):m.calcTicks(se),Me=Te?ve:m.clipEnds(se,ve),ke=m.getTickSigns(se)[2];Te&&((se.ticks==="top"&&se.side==="bottom"||se.ticks==="bottom"&&se.side==="top")&&(ke=-ke),se.ticks==="top"&&se.side==="top"&&(fe=-se.ticklen),se.ticks==="bottom"&&se.side==="bottom"&&(fe=se.ticklen)),m.drawTicks(j,se,{vals:ve,layer:Q["radial-axis"],path:m.makeTickPath(se,0,ke),transFn:_e,crisp:!1}),m.drawGrid(j,se,{vals:Me,layer:Q["radial-grid"],path:be,transFn:y.noop,crisp:!1}),m.drawLabels(j,se,{vals:ve,layer:Q["radial-axis"],transFn:_e,labelFns:m.makeLabelFns(se,fe)})}var Le=ee.radialAxisAngle=ee.vangles?X(te(V(oe.angle),ee.vangles)):oe.angle,ze=n(ne,le),Re=ze+e(-Le);N(Q["radial-axis"],me&&(oe.showticklabels||oe.ticks),{transform:Re}),N(Q["radial-grid"],me&&oe.showgrid,{transform:Te?"":ze}),N(Q["radial-line"].select("line"),me&&oe.showline,{x1:Te?-K:re,y1:0,x2:K,y2:0,transform:Re}).attr("stroke-width",oe.linewidth).call(t.stroke,oe.linecolor)},G.updateRadialAxisTitle=function(B,U,ee){if(!this.isSmith){var j=this.gd,Q=this.radius,K=this.cx,re=this.cy,ne=this.getRadial(U),le=this.id+"title",oe=0;if(ne.title){var de=a.bBox(this.layers["radial-axis"].node()).height,se=ne.title.font.size,me=ne.side;oe=me==="top"?se:me==="counterclockwise"?-(de+.4*se):de+.8*se}var Te=ee!==void 0?ee:this.radialAxisAngle,_e=V(Te),be=Math.cos(_e),Ce=Math.sin(_e),fe=K+Q/2*be+oe*Ce,ve=re-Q/2*Ce+oe*be;this.layers["radial-axis-title"]=d.draw(j,le,{propContainer:ne,propName:this.id+".radialaxis.title",placeholder:R(j,"Click to enter radial axis title"),attributes:{x:fe,y:ve,"text-anchor":"middle"},transform:{rotate:-Te}})}},G.updateAngularAxis=function(B,U){var ee=this,j=ee.gd,Q=ee.layers,K=ee.radius,re=ee.innerRadius,ne=ee.cx,le=ee.cy,oe=ee.getAngular(U),de=ee.angularAxis,se=ee.isSmith;se||(ee.fillViewInitialKey("angularaxis.rotation",oe.rotation),de.setGeometry(),de.setScale());var me=se?function(Oe){var Ze=D(ee,P([0,Oe.x]));return Math.atan2(Ze[0]-ne,Ze[1]-le)-Math.PI/2}:function(Oe){return de.t2g(Oe.x)};de.type==="linear"&&de.thetaunit==="radians"&&(de.tick0=X(de.tick0),de.dtick=X(de.dtick));var Te=function(Oe){return n(ne+K*Math.cos(Oe),le-K*Math.sin(Oe))},_e=se?function(Oe){var Ze=D(ee,P([0,Oe.x]));return n(Ze[0],Ze[1])}:function(Oe){return Te(me(Oe))},be=se?function(Oe){var Ze=D(ee,P([0,Oe.x])),Pe=Math.atan2(Ze[0]-ne,Ze[1]-le)-Math.PI/2;return n(Ze[0],Ze[1])+e(-X(Pe))}:function(Oe){var Ze=me(Oe);return Te(Ze)+e(-X(Ze))},Ce=se?function(Oe){return S(ee,Oe.x,0,1/0)}:function(Oe){var Ze=me(Oe),Pe=Math.cos(Ze),Ie=Math.sin(Ze);return"M"+[ne+re*Pe,le-re*Ie]+"L"+[ne+K*Pe,le-K*Ie]},fe=m.makeLabelFns(de,0).labelStandoff,ve={xFn:function(Oe){var Ze=me(Oe);return Math.cos(Ze)*fe},yFn:function(Oe){var Ze=me(Oe),Pe=Math.sin(Ze)>0?.2:1;return-Math.sin(Ze)*(fe+Oe.fontSize*Pe)+Math.abs(Math.cos(Ze))*(Oe.fontSize*k)},anchorFn:function(Oe){var Ze=me(Oe),Pe=Math.cos(Ze);return Math.abs(Pe)<.1?"middle":Pe>0?"start":"end"},heightFn:function(Oe,Ze,Pe){var Ie=me(Oe);return-.5*(1+Math.sin(Ie))*Pe}},Me=W(oe);ee.angularTickLayout!==Me&&(Q["angular-axis"].selectAll("."+de._id+"tick").remove(),ee.angularTickLayout=Me);var ke,Le=se?[1/0].concat(de.tickvals||[]).map(function(Oe){return m.tickText(de,Oe,!0,!1)}):m.calcTicks(de);if(se&&(Le[0].text="\u221E",Le[0].fontSize*=1.75),U.gridshape==="linear"?(ke=Le.map(me),y.angleDelta(ke[0],ke[1])<0&&(ke=ke.slice().reverse())):ke=null,ee.vangles=ke,de.type==="category"&&(Le=Le.filter(function(Oe){return y.isAngleInsideSector(me(Oe),ee.sectorInRad)})),de.visible){var ze=de.ticks==="inside"?-1:1,Re=(de.linewidth||1)/2;m.drawTicks(j,de,{vals:Le,layer:Q["angular-axis"],path:"M"+ze*Re+",0h"+ze*de.ticklen,transFn:be,crisp:!1}),m.drawGrid(j,de,{vals:Le,layer:Q["angular-grid"],path:Ce,transFn:y.noop,crisp:!1}),m.drawLabels(j,de,{vals:Le,layer:Q["angular-axis"],repositionOnUpdate:!0,transFn:_e,labelFns:ve})}N(Q["angular-line"].select("path"),oe.showline,{d:ee.pathSubplot(),transform:n(ne,le)}).attr("stroke-width",oe.linewidth).call(t.stroke,oe.linecolor)},G.updateFx=function(B,U){this.gd._context.staticPlot||(!this.isSmith&&(this.updateAngularDrag(B),this.updateRadialDrag(B,U,0),this.updateRadialDrag(B,U,1)),this.updateHoverAndMainDrag(B))},G.updateHoverAndMainDrag=function(B){var U,ee,j=this,Q=j.isSmith,K=j.gd,re=j.layers,ne=B._zoomlayer,le=L.MINZOOM,oe=L.OFFEDGE,de=j.radius,se=j.innerRadius,me=j.cx,Te=j.cy,_e=j.cxx,be=j.cyy,Ce=j.sectorInRad,fe=j.vangles,ve=j.radialAxis,Me=A.clampTiny,ke=A.findXYatLength,Le=A.findEnclosingVertexAngles,ze=L.cornerHalfWidth,Re=L.cornerLen/2,Oe=f.makeDragger(re,"path","maindrag",B.dragmode===!1?"none":"crosshair");p.select(Oe).attr("d",j.pathSubplot()).attr("transform",n(me,Te)),Oe.onmousemove=function(qe){h.hover(K,qe,j.id),K._fullLayout._lasthover=Oe,K._fullLayout._hoversubplot=j.id},Oe.onmouseout=function(qe){K._dragging||l.unhover(K,qe)};var Ze,Pe,Ie,Be,Fe,$e,ot,pt,_t,yt={element:Oe,gd:K,subplot:j.id,plotinfo:{id:j.id,xaxis:j.xaxis,yaxis:j.yaxis},xaxes:[j.xaxis],yaxes:[j.yaxis]};function tt(qe,Xe){return Math.sqrt(qe*qe+Xe*Xe)}function Ke(qe,Xe){return tt(qe-_e,Xe-be)}function vt(qe,Xe){return Math.atan2(be-Xe,qe-_e)}function Nt(qe,Xe){return[qe*Math.cos(Xe),qe*Math.sin(-Xe)]}function qt(qe,Xe){if(qe===0)return j.pathSector(2*ze);var He=Re/qe,st=Xe-He,it=Xe+He,Tt=Math.max(0,Math.min(qe,de)),Pt=Tt-ze,rt=Tt+ze;return"M"+Nt(Pt,st)+"A"+[Pt,Pt]+" 0,0,0 "+Nt(Pt,it)+"L"+Nt(rt,it)+"A"+[rt,rt]+" 0,0,1 "+Nt(rt,st)+"Z"}function er(qe,Xe,He){if(qe===0)return j.pathSector(2*ze);var st,it,Tt=Nt(qe,Xe),Pt=Nt(qe,He),rt=Me((Tt[0]+Pt[0])/2),ut=Me((Tt[1]+Pt[1])/2);if(rt&&ut){var Ft=ut/rt,wt=-1/Ft,Lt=ke(ze,Ft,rt,ut);st=ke(Re,wt,Lt[0][0],Lt[0][1]),it=ke(Re,wt,Lt[1][0],Lt[1][1])}else{var Ae,Ye;ut?(Ae=Re,Ye=ze):(Ae=ze,Ye=Re),st=[[rt-Ae,ut-Ye],[rt+Ae,ut-Ye]],it=[[rt-Ae,ut+Ye],[rt+Ae,ut+Ye]]}return"M"+st.join("L")+"L"+it.reverse().join("L")+"Z"}function Jt(qe,Xe){return Xe=Math.max(Math.min(Xe,de),se),qe<oe?qe=0:de-qe<oe?qe=de:Xe<oe?Xe=0:de-Xe<oe&&(Xe=de),Math.abs(Xe-qe)>le?(qe<Xe?(Ie=qe,Be=Xe):(Ie=Xe,Be=qe),!0):(Ie=null,Be=null,!1)}function ir(qe,Xe){qe=qe||Fe,Xe=Xe||"M0,0Z",pt.attr("d",qe),_t.attr("d",Xe),f.transitionZoombox(pt,_t,$e,ot),$e=!0;var He={};xe(He),K.emit("plotly_relayouting",He)}function Ht(qe,Xe){var He,st,it=Ze+(qe*=U),Tt=Pe+(Xe*=ee),Pt=Ke(Ze,Pe),rt=Math.min(Ke(it,Tt),de),ut=vt(Ze,Pe);Jt(Pt,rt)&&(He=Fe+j.pathSector(Be),Ie&&(He+=j.pathSector(Ie)),st=qt(Ie,ut)+qt(Be,ut)),ir(He,st)}function Ue(qe,Xe,He,st){var it=A.findIntersectionXY(He,st,He,[qe-_e,be-Xe]);return tt(it[0],it[1])}function We(qe,Xe){var He,st,it=Ze+qe,Tt=Pe+Xe,Pt=vt(Ze,Pe),rt=vt(it,Tt),ut=Le(Pt,fe),Ft=Le(rt,fe);Jt(Ue(Ze,Pe,ut[0],ut[1]),Math.min(Ue(it,Tt,Ft[0],Ft[1]),de))&&(He=Fe+j.pathSector(Be),Ie&&(He+=j.pathSector(Ie)),st=[er(Ie,ut[0],ut[1]),er(Be,ut[0],ut[1])].join(" ")),ir(He,st)}function he(){if(f.removeZoombox(K),Ie!==null&&Be!==null){var qe={};xe(qe),f.showDoubleClickNotifier(K),b.call("_guiRelayout",K,qe)}}function xe(qe){var Xe=ve._rl,He=(Xe[1]-Xe[0])/(1-se/de)/de,st=[Xe[0]+(Ie-se)*He,Xe[0]+(Be-se)*He];qe[j.id+".radialaxis.range"]=st}function De(qe,Xe){var He=K._fullLayout.clickmode;if(f.removeZoombox(K),qe===2){var st={};for(var it in j.viewInitial)st[j.id+"."+it]=j.viewInitial[it];K.emit("plotly_doubleclick",null),b.call("_guiRelayout",K,st)}He.indexOf("select")>-1&&qe===1&&x(Xe,K,[j.xaxis],[j.yaxis],j.id,yt),He.indexOf("event")>-1&&h.click(K,Xe,j.id)}yt.prepFn=function(qe,Xe,He){var st=K._fullLayout.dragmode,it=Oe.getBoundingClientRect();K._fullLayout._calcInverseTransform(K);var Tt=K._fullLayout._invTransform;U=K._fullLayout._invScaleX,ee=K._fullLayout._invScaleY;var Pt=y.apply3DTransform(Tt)(Xe-it.left,He-it.top);if(Ze=Pt[0],Pe=Pt[1],fe){var rt=A.findPolygonOffset(de,Ce[0],Ce[1],fe);Ze+=_e+rt[0],Pe+=be+rt[1]}switch(st){case"zoom":yt.clickFn=De,Q||(yt.moveFn=fe?We:Ht,yt.doneFn=he,function(){Ie=null,Be=null,Fe=j.pathSubplot(),$e=!1;var ut=K._fullLayout[j.id];ot=g(ut.bgcolor).getLuminance(),(pt=f.makeZoombox(ne,ot,me,Te,Fe)).attr("fill-rule","evenodd"),_t=f.makeCorners(ne,me,Te),c(K)}());break;case"select":case"lasso":s(qe,Xe,He,yt,st)}},l.init(yt)},G.updateRadialDrag=function(B,U,ee){var j=this,Q=j.gd,K=j.layers,re=j.radius,ne=j.innerRadius,le=j.cx,oe=j.cy,de=j.radialAxis,se=L.radialDragBoxSize,me=se/2;if(de.visible){var Te,_e,be,Ce=V(j.radialAxisAngle),fe=de._rl,ve=fe[0],Me=fe[1],ke=fe[ee],Le=.75*(fe[1]-fe[0])/(1-j.getHole(U))/re;ee?(Te=le+(re+me)*Math.cos(Ce),_e=oe-(re+me)*Math.sin(Ce),be="radialdrag"):(Te=le+(ne-me)*Math.cos(Ce),_e=oe-(ne-me)*Math.sin(Ce),be="radialdrag-inner");var ze,Re,Oe,Ze=f.makeRectDragger(K,be,"crosshair",-me,-me,se,se),Pe={element:Ze,gd:Q};B.dragmode===!1&&(Pe.dragmode=!1),N(p.select(Ze),de.visible&&ne<re,{transform:n(Te,_e)}),Pe.prepFn=function(){ze=null,Re=null,Oe=null,Pe.moveFn=Ie,Pe.doneFn=Be,c(Q)},Pe.clampFn=function(ot,pt){return Math.sqrt(ot*ot+pt*pt)<L.MINDRAG&&(ot=0,pt=0),[ot,pt]},l.init(Pe)}function Ie(ot,pt){if(ze)ze(ot,pt);else{var _t=[ot,-pt],yt=[Math.cos(Ce),Math.sin(Ce)],tt=Math.abs(y.dot(_t,yt)/Math.sqrt(y.dot(_t,_t)));isNaN(tt)||(ze=tt<.5?Fe:$e)}var Ke={};(function(vt){Re!==null?vt[j.id+".radialaxis.angle"]=Re:Oe!==null&&(vt[j.id+".radialaxis.range["+ee+"]"]=Oe)})(Ke),Q.emit("plotly_relayouting",Ke)}function Be(){Re!==null?b.call("_guiRelayout",Q,j.id+".radialaxis.angle",Re):Oe!==null&&b.call("_guiRelayout",Q,j.id+".radialaxis.range["+ee+"]",Oe)}function Fe(ot,pt){if(ee!==0){var _t=Te+ot,yt=_e+pt;Re=Math.atan2(oe-yt,_t-le),j.vangles&&(Re=te(Re,j.vangles)),Re=X(Re);var tt=n(le,oe)+e(-Re);K["radial-axis"].attr("transform",tt),K["radial-line"].select("line").attr("transform",tt);var Ke=j.gd._fullLayout,vt=Ke[j.id];j.updateRadialAxisTitle(Ke,vt,Re)}}function $e(ot,pt){var _t=y.dot([ot,-pt],[Math.cos(Ce),Math.sin(Ce)]);if(Oe=ke-Le*_t,Le>0==(ee?Oe>ve:Oe<Me)){var yt=Q._fullLayout,tt=yt[j.id];de.range[ee]=Oe,de._rl[ee]=Oe,j.updateRadialAxis(yt,tt),j.xaxis.setRange(),j.xaxis.setScale(),j.yaxis.setRange(),j.yaxis.setScale();var Ke=!1;for(var vt in j.traceHash){var Nt=j.traceHash[vt],qt=y.filterVisible(Nt);Nt[0][0].trace._module.plot(Q,j,qt,tt),b.traceIs(vt,"gl")&&qt.length&&(Ke=!0)}Ke&&(_(Q),w(Q))}else Oe=null}},G.updateAngularDrag=function(B){var U=this,ee=U.gd,j=U.layers,Q=U.radius,K=U.angularAxis,re=U.cx,ne=U.cy,le=U.cxx,oe=U.cyy,de=L.angularDragBoxSize,se=f.makeDragger(j,"path","angulardrag",B.dragmode===!1?"none":"move"),me={element:se,gd:ee};function Te(Pe,Ie){return Math.atan2(oe+de-Ie,Pe-le-de)}B.dragmode===!1?me.dragmode=!1:p.select(se).attr("d",U.pathAnnulus(Q,Q+de)).attr("transform",n(re,ne)).call(T,"move");var _e,be,Ce,fe,ve,Me,ke=j.frontplot.select(".scatterlayer").selectAll(".trace"),Le=ke.selectAll(".point"),ze=ke.selectAll(".textpoint");function Re(Pe,Ie){var Be=U.gd._fullLayout,Fe=Be[U.id],$e=Te(_e+Pe*B._invScaleX,be+Ie*B._invScaleY),ot=X($e-Me);if(fe=Ce+ot,j.frontplot.attr("transform",n(U.xOffset2,U.yOffset2)+e([-ot,le,oe])),U.vangles){ve=U.radialAxisAngle+ot;var pt=n(re,ne)+e(-ot),_t=n(re,ne)+e(-ve);j.bg.attr("transform",pt),j["radial-grid"].attr("transform",pt),j["radial-axis"].attr("transform",_t),j["radial-line"].select("line").attr("transform",_t),U.updateRadialAxisTitle(Be,Fe,ve)}else U.clipPaths.forTraces.select("path").attr("transform",n(le,oe)+e(ot));Le.each(function(){var qt=p.select(this),er=a.getTranslate(qt);qt.attr("transform",n(er.x,er.y)+e([ot]))}),ze.each(function(){var qt=p.select(this),er=qt.select("text"),Jt=a.getTranslate(qt);qt.attr("transform",e([ot,er.attr("x"),er.attr("y")])+n(Jt.x,Jt.y))}),K.rotation=y.modHalf(fe,360),U.updateAngularAxis(Be,Fe),U._hasClipOnAxisFalse&&!y.isFullCircle(U.sectorInRad)&&ke.call(a.hideOutsideRangePoints,U);var yt=!1;for(var tt in U.traceHash)if(b.traceIs(tt,"gl")){var Ke=U.traceHash[tt],vt=y.filterVisible(Ke);Ke[0][0].trace._module.plot(ee,U,vt,Fe),vt.length&&(yt=!0)}yt&&(_(ee),w(ee));var Nt={};Oe(Nt),ee.emit("plotly_relayouting",Nt)}function Oe(Pe){Pe[U.id+".angularaxis.rotation"]=fe,U.vangles&&(Pe[U.id+".radialaxis.angle"]=ve)}function Ze(){ze.select("text").attr("transform",null);var Pe={};Oe(Pe),b.call("_guiRelayout",ee,Pe)}me.prepFn=function(Pe,Ie,Be){var Fe=B[U.id];Ce=Fe.angularaxis.rotation;var $e=se.getBoundingClientRect();_e=Ie-$e.left,be=Be-$e.top,ee._fullLayout._calcInverseTransform(ee);var ot=y.apply3DTransform(B._invTransform)(_e,be);_e=ot[0],be=ot[1],Me=Te(_e,be),me.moveFn=Re,me.doneFn=Ze,c(ee)},U.vangles&&!y.isFullCircle(U.sectorInRad)&&(me.prepFn=y.noop,T(p.select(se),null)),l.init(me)},G.isPtInside=function(B){if(this.isSmith)return!0;var U=this.sectorInRad,ee=this.vangles,j=this.angularAxis.c2g(B.theta),Q=this.radialAxis,K=Q.c2l(B.r),re=Q._rl;return(ee?A.isPtInsidePolygon:y.isPtInsideSector)(K,j,re,U,ee)},G.pathArc=function(B){var U=this.sectorInRad,ee=this.vangles;return(ee?A.pathPolygon:y.pathArc)(B,U[0],U[1],ee)},G.pathSector=function(B){var U=this.sectorInRad,ee=this.vangles;return(ee?A.pathPolygon:y.pathSector)(B,U[0],U[1],ee)},G.pathAnnulus=function(B,U){var ee=this.sectorInRad,j=this.vangles;return(j?A.pathPolygonAnnulus:y.pathAnnulus)(B,U,ee[0],ee[1],j)},G.pathSubplot=function(){var B=this.innerRadius,U=this.radius;return B?this.pathAnnulus(B,U):this.pathSector(U)},G.fillViewInitialKey=function(B,U){B in this.viewInitial||(this.viewInitial[B]=U)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../plot_api/subroutines":556,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/dragbox":575,"../cartesian/set_convert":585,"../plots":628,"../smith/helpers":637,"./constants":629,"./helpers":630,"./set_convert":635,"@plotly/d3":58,tinycolor2:313}],635:[function(v,J,Z){var p=v("../../lib"),g=v("../cartesian/set_convert"),b=p.deg2rad,y=p.rad2deg;J.exports=function(e,n,t){switch(g(e,t),e._id){case"x":case"radialaxis":(function(a,r){var m=r._subplot;a.setGeometry=function(){var o=a._rl[0],i=a._rl[1],u=m.innerRadius,f=(m.radius-u)/(i-o),l=u/f,h=o>i?function(d){return d<=0}:function(d){return d>=0};a.c2g=function(d){var s=a.c2l(d)-o;return(h(s)?s:0)+l},a.g2c=function(d){return a.l2c(d+o-l)},a.g2p=function(d){return d*f},a.c2p=function(d){return a.g2p(a.c2g(d))}}})(e,n);break;case"angularaxis":(function(a,r){var m=a.type;if(m==="linear"){var o=a.d2c,i=a.c2d;a.d2c=function(u,f){return function(l,h){return h==="degrees"?b(l):l}(o(u),f)},a.c2d=function(u,f){return i(function(l,h){return h==="degrees"?y(l):l}(u,f))}}a.makeCalcdata=function(u,f){var l,h,d=u[f],s=u._length,x=function(k){return a.d2c(k,u.thetaunit)};if(d){if(p.isTypedArray(d)&&m==="linear"){if(s===d.length)return d;if(d.subarray)return d.subarray(0,s)}for(l=new Array(s),h=0;h<s;h++)l[h]=x(d[h])}else{var c=f+"0",T="d"+f,_=c in u?x(u[c]):0,w=u[T]?x(u[T]):(a.period||2*Math.PI)/s;for(l=new Array(s),h=0;h<s;h++)l[h]=_+h*w}return l},a.setGeometry=function(){var u,f,l,h,d=r.sector,s=d.map(b),x={clockwise:-1,counterclockwise:1}[a.direction],c=b(a.rotation),T=function(L){return x*L+c},_=function(L){return(L-c)/x};switch(m){case"linear":f=u=p.identity,h=b,l=y,a.range=p.isFullCircle(s)?[d[0],d[0]+360]:s.map(_).map(y);break;case"category":var w=a._categories.length,k=a.period?Math.max(a.period,w):w;k===0&&(k=1),f=h=function(L){return 2*L*Math.PI/k},u=l=function(L){return L*k/Math.PI/2},a.range=[0,k]}a.c2g=function(L){return T(f(L))},a.g2c=function(L){return u(_(L))},a.t2g=function(L){return T(h(L))},a.g2t=function(L){return l(_(L))}}})(e,n)}}},{"../../lib":515,"../cartesian/set_convert":585}],636:[function(v,J,Z){J.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],637:[function(v,J,Z){function p(e){return e<0?-1:e>0?1:0}function g(e){var n=e[0],t=e[1];if(!isFinite(n)||!isFinite(t))return[1,0];var a=(n+1)*(n+1)+t*t;return[(n*n+t*t-1)/a,2*t/a]}function b(e,n){var t=n[0],a=n[1];return[t*e.radius+e.cx,-a*e.radius+e.cy]}function y(e,n){return n*e.radius}J.exports={smith:g,reactanceArc:function(e,n,t,a){var r=b(e,g([t,n])),m=r[0],o=r[1],i=b(e,g([a,n])),u=i[0],f=i[1];if(n===0)return["M"+m+","+o,"L"+u+","+f].join(" ");var l=y(e,1/Math.abs(n));return["M"+m+","+o,"A"+l+","+l+" 0 0,"+(n<0?1:0)+" "+u+","+f].join(" ")},resistanceArc:function(e,n,t,a){var r=y(e,1/(n+1)),m=b(e,g([n,t])),o=m[0],i=m[1],u=b(e,g([n,a])),f=u[0],l=u[1];if(p(t)!==p(a)){var h=b(e,g([n,0]));return["M"+o+","+i,"A"+r+","+r+" 0 0,"+(0<t?0:1)+" "+h[0]+","+h[1],"A"+r+","+r+" 0 0,"+(a<0?0:1)+f+","+l].join(" ")}return["M"+o+","+i,"A"+r+","+r+" 0 0,"+(a<t?0:1)+" "+f+","+l].join(" ")},smithTransform:b}},{}],638:[function(v,J,Z){var p=v("../get_data").getSubplotCalcData,g=v("../../lib").counterRegex,b=v("../polar/polar"),y=v("./constants"),e=y.attr,n=y.name,t=g(n),a={};a[e]={valType:"subplotid",dflt:n,editType:"calc"},J.exports={attr:e,name:n,idRoot:n,idRegex:t,attrRegex:t,attributes:a,layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),plot:function(r){for(var m=r._fullLayout,o=r.calcdata,i=m._subplots[n],u=0;u<i.length;u++){var f=i[u],l=p(o,n,f),h=m[f]._subplot;h||(h=b(r,f,!0),m[f]._subplot=h),h.plot(l,m,r._promises)}},clean:function(r,m,o,i){for(var u=i._subplots[n]||[],f=0;f<u.length;f++){var l=u[f],h=i[l]._subplot;if(!m[l]&&h)for(var d in h.framework.remove(),h.clipPaths)h.clipPaths[d].remove()}},toSVG:v("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"../polar/polar":634,"./constants":636,"./layout_attributes":639,"./layout_defaults":640}],639:[function(v,J,Z){var p=v("../../components/color/attributes"),g=v("../cartesian/layout_attributes"),b=v("../domain").attributes,y=v("../../lib").extendFlat,e=v("../../plot_api/edit_types").overrideAll,n=e({color:g.color,showline:y({},g.showline,{dflt:!0}),linecolor:g.linecolor,linewidth:g.linewidth,showgrid:y({},g.showgrid,{dflt:!0}),gridcolor:g.gridcolor,gridwidth:g.gridwidth,griddash:g.griddash},"plot","from-root"),t=e({ticklen:g.ticklen,tickwidth:y({},g.tickwidth,{dflt:2}),tickcolor:g.tickcolor,showticklabels:g.showticklabels,showtickprefix:g.showtickprefix,tickprefix:g.tickprefix,showticksuffix:g.showticksuffix,ticksuffix:g.ticksuffix,tickfont:g.tickfont,tickformat:g.tickformat,hoverformat:g.hoverformat,layer:g.layer},"plot","from-root"),a=y({visible:y({},g.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:y({},g.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},n,t),r=y({visible:y({},g.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:g.ticks,editType:"calc"},n,t);J.exports={domain:b({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:p.background},realaxis:a,imaginaryaxis:r,editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],640:[function(v,J,Z){var p,g,b,y=v("../../lib"),e=v("../../components/color"),n=v("../../plot_api/plot_template"),t=v("../subplot_defaults"),a=v("../get_data").getSubplotData,r=v("../cartesian/prefix_suffix_defaults"),m=v("../cartesian/tick_label_defaults"),o=v("../cartesian/line_grid_defaults"),i=v("../cartesian/set_convert"),u=v("./layout_attributes"),f=v("./constants"),l=f.axisNames,h=(p=function(s){return s.slice().reverse().map(function(x){return-x}).concat([0]).concat(s)},g=String,b={},function(s){var x=g?g(s):s;if(x in b)return b[x];var c=p(s);return b[x]=c,c});function d(s,x,c,T){var _=c("bgcolor");T.bgColor=e.combine(_,T.paper_bgcolor);var w,k=a(T.fullData,f.name,T.id),L=T.layoutOut;function A(G,W){return c(w+"."+G,W)}for(var I=0;I<l.length;I++){w=l[I],y.isPlainObject(s[w])||(s[w]={});var P=s[w],S=n.newContainer(x,w);S._id=S._name=w,S._attr=T.id+"."+w,S._traceIndices=k.map(function(G){return G._expandedIndex});var E=A("visible");if(S.type="linear",i(S,L),r(P,S,A,S.type),E){var D,R,H,V,X=w==="realaxis";X&&A("side"),X?A("tickvals"):A("tickvals",h(x.realaxis.tickvals||u.realaxis.tickvals.dflt));var $=T.font||{};E&&(R=(D=A("color"))===P.color?D:$.color,H=$.size,V=$.family),m(P,S,A,S.type,{noTicklabelstep:!0,noAng:!X,noExp:!0,font:{color:R,size:H,family:V}}),y.coerce2(s,x,u,w+".ticklen"),y.coerce2(s,x,u,w+".tickwidth"),y.coerce2(s,x,u,w+".tickcolor",x.color),A("ticks")||(delete x[w].ticklen,delete x[w].tickwidth,delete x[w].tickcolor),o(P,S,A,{dfltColor:D,bgColor:T.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:u[w]}),A("layer")}A("hoverformat"),delete S.type,S._input=P}}J.exports=function(s,x,c){t(s,x,c,{noUirevision:!0,type:f.name,attributes:u,handleDefaults:d,font:x.font,paper_bgcolor:x.paper_bgcolor,fullData:c,layoutOut:x})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/set_convert":585,"../cartesian/tick_label_defaults":587,"../get_data":602,"../subplot_defaults":641,"./constants":636,"./layout_attributes":639}],641:[function(v,J,Z){var p=v("../lib"),g=v("../plot_api/plot_template"),b=v("./domain").defaults;J.exports=function(y,e,n,t){var a,r,m=t.type,o=t.attributes,i=t.handleDefaults,u=t.partition||"x",f=e._subplots[m],l=f.length,h=l&&f[0].replace(/\d+$/,"");function d(T,_){return p.coerce(a,r,o,T,_)}for(var s=0;s<l;s++){var x=f[s];a=y[x]?y[x]:y[x]={},r=g.newContainer(e,x,h),t.noUirevision||d("uirevision",e.uirevision);var c={};c[u]=[s/l,(s+1)/l],b(r,e,d,c),t.id=x,i(a,r,d,t)}}},{"../lib":515,"../plot_api/plot_template":555,"./domain":593}],642:[function(v,J,Z){var p=v("../constants/docs");p.FORMAT_LINK,p.DATE_FORMAT_LINK;function g(b){var y=b.description?" "+b.description:"",e=b.keys||[];if(e.length>0){for(var n=[],t=0;t<e.length;t++)n[t]="`"+e[t]+"`";y+="Finally, the template string has access to ",y=e.length===1?"variable "+n[0]:"variables "+n.slice(0,-1).join(", ")+" and "+n.slice(-1)+"."}return y}Z.hovertemplateAttrs=function(b,y){b=b||{},g(y=y||{});var e={valType:"string",dflt:"",editType:b.editType||"none"};return b.arrayOk!==!1&&(e.arrayOk=!0),e},Z.texttemplateAttrs=function(b,y){b=b||{},g(y=y||{});var e={valType:"string",dflt:"",editType:b.editType||"calc"};return b.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":486}],643:[function(v,J,Z){var p=v("./ternary"),g=v("../../plots/get_data").getSubplotCalcData,b=v("../../lib").counterRegex;Z.name="ternary";var y=Z.attr="subplot";Z.idRoot="ternary",Z.idRegex=Z.attrRegex=b("ternary"),(Z.attributes={})[y]={valType:"subplotid",dflt:"ternary",editType:"calc"},Z.layoutAttributes=v("./layout_attributes"),Z.supplyLayoutDefaults=v("./layout_defaults"),Z.plot=function(e){for(var n=e._fullLayout,t=e.calcdata,a=n._subplots.ternary,r=0;r<a.length;r++){var m=a[r],o=g(t,"ternary",m),i=n[m]._subplot;i||(i=new p({id:m,graphDiv:e,container:n._ternarylayer.node()},n),n[m]._subplot=i),i.plot(o,n,e._promises)}},Z.clean=function(e,n,t,a){for(var r=a._subplots.ternary||[],m=0;m<r.length;m++){var o=r[m],i=a[o]._subplot;!n[o]&&i&&(i.plotContainer.remove(),i.clipDef.remove(),i.clipDefRelative.remove(),i.layers["a-title"].remove(),i.layers["b-title"].remove(),i.layers["c-title"].remove())}}},{"../../lib":515,"../../plots/get_data":602,"./layout_attributes":644,"./layout_defaults":645,"./ternary":646}],644:[function(v,J,Z){var p=v("../../components/color/attributes"),g=v("../domain").attributes,b=v("../cartesian/layout_attributes"),y=v("../../plot_api/edit_types").overrideAll,e=v("../../lib/extend").extendFlat,n={title:{text:b.title.text,font:b.title.font},color:b.color,tickmode:b.tickmode,nticks:e({},b.nticks,{dflt:6,min:1}),tick0:b.tick0,dtick:b.dtick,tickvals:b.tickvals,ticktext:b.ticktext,ticks:b.ticks,ticklen:b.ticklen,tickwidth:b.tickwidth,tickcolor:b.tickcolor,ticklabelstep:b.ticklabelstep,showticklabels:b.showticklabels,showtickprefix:b.showtickprefix,tickprefix:b.tickprefix,showticksuffix:b.showticksuffix,ticksuffix:b.ticksuffix,showexponent:b.showexponent,exponentformat:b.exponentformat,minexponent:b.minexponent,separatethousands:b.separatethousands,tickfont:b.tickfont,tickangle:b.tickangle,tickformat:b.tickformat,tickformatstops:b.tickformatstops,hoverformat:b.hoverformat,showline:e({},b.showline,{dflt:!0}),linecolor:b.linecolor,linewidth:b.linewidth,showgrid:e({},b.showgrid,{dflt:!0}),gridcolor:b.gridcolor,gridwidth:b.gridwidth,griddash:b.griddash,layer:b.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:b._deprecated.title,titlefont:b._deprecated.titlefont}},t=J.exports=y({domain:g({name:"ternary"}),bgcolor:{valType:"color",dflt:p.background},sum:{valType:"number",dflt:1,min:0},aaxis:n,baxis:n,caxis:n},"plot","from-root");t.uirevision={valType:"any",editType:"none"},t.aaxis.uirevision=t.baxis.uirevision=t.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],645:[function(v,J,Z){var p=v("../../components/color"),g=v("../../plot_api/plot_template"),b=v("../../lib"),y=v("../subplot_defaults"),e=v("../cartesian/tick_label_defaults"),n=v("../cartesian/prefix_suffix_defaults"),t=v("../cartesian/tick_mark_defaults"),a=v("../cartesian/tick_value_defaults"),r=v("../cartesian/line_grid_defaults"),m=v("./layout_attributes"),o=["aaxis","baxis","caxis"];function i(f,l,h,d){var s,x,c,T=h("bgcolor"),_=h("sum");d.bgColor=p.combine(T,d.paper_bgcolor);for(var w=0;w<o.length;w++)x=f[s=o[w]]||{},(c=g.newContainer(l,s))._name=s,u(x,c,d,l);var k=l.aaxis,L=l.baxis,A=l.caxis;k.min+L.min+A.min>=_&&(k.min=0,L.min=0,A.min=0,f.aaxis&&delete f.aaxis.min,f.baxis&&delete f.baxis.min,f.caxis&&delete f.caxis.min)}function u(f,l,h,d){var s=m[l._name];function x(L,A){return b.coerce(f,l,s,L,A)}x("uirevision",d.uirevision),l.type="linear";var c=x("color"),T=c!==s.color.dflt?c:h.font.color,_=l._name.charAt(0).toUpperCase(),w="Component "+_,k=x("title.text",w);l._hovertitle=k===w?k:_,b.coerceFont(x,"title.font",{family:h.font.family,size:b.bigFont(h.font.size),color:T}),x("min"),a(f,l,x,"linear"),n(f,l,x,"linear"),e(f,l,x,"linear"),t(f,l,x,{outerTicks:!0}),x("showticklabels")&&(b.coerceFont(x,"tickfont",{family:h.font.family,size:h.font.size,color:T}),x("tickangle"),x("tickformat")),r(f,l,x,{dfltColor:c,bgColor:h.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:s}),x("hoverformat"),x("layer")}J.exports=function(f,l,h){y(f,l,h,{type:"ternary",attributes:m,handleDefaults:i,font:l.font,paper_bgcolor:l.paper_bgcolor})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../subplot_defaults":641,"./layout_attributes":644}],646:[function(v,J,Z){var p=v("@plotly/d3"),g=v("tinycolor2"),b=v("../../registry"),y=v("../../lib"),e=y.strTranslate,n=y._,t=v("../../components/color"),a=v("../../components/drawing"),r=v("../cartesian/set_convert"),m=v("../../lib/extend").extendFlat,o=v("../plots"),i=v("../cartesian/axes"),u=v("../../components/dragelement"),f=v("../../components/fx"),l=v("../../components/dragelement/helpers"),h=l.freeMode,d=l.rectMode,s=v("../../components/titles"),x=v("../../components/selections").prepSelect,c=v("../../components/selections").selectOnClick,T=v("../../components/selections").clearOutline,_=v("../../components/selections").clearSelectionsCache,w=v("../cartesian/constants");function k(H,V){this.id=H.id,this.graphDiv=H.graphDiv,this.init(V),this.makeFramework(V),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}J.exports=k;var L=k.prototype;L.init=function(H){this.container=H._ternarylayer,this.defs=H._defs,this.layoutId=H._uid,this.traceHash={},this.layers={}},L.plot=function(H,V){var X=V[this.id],$=V._size;this._hasClipOnAxisFalse=!1;for(var G=0;G<H.length;G++)if(H[G][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(X),this.adjustLayout(X,$),o.generalUpdatePerTraceModule(this.graphDiv,this,H,X),this.layers.plotbg.select("path").call(t.fill,X.bgcolor)},L.makeFramework=function(H){var V=this.graphDiv,X=H[this.id],$=this.clipId="clip"+this.layoutId+this.id,G=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=y.ensureSingleById(H._clips,"clipPath",$,function(W){W.append("path").attr("d","M0,0Z")}),this.clipDefRelative=y.ensureSingleById(H._clips,"clipPath",G,function(W){W.append("path").attr("d","M0,0Z")}),this.plotContainer=y.ensureSingle(this.container,"g",this.id),this.updateLayers(X),a.setClipUrl(this.layers.backplot,$,V),a.setClipUrl(this.layers.grids,$,V)},L.updateLayers=function(H){var V=this.layers,X=["draglayer","plotbg","backplot","grids"];H.aaxis.layer==="below traces"&&X.push("aaxis","aline"),H.baxis.layer==="below traces"&&X.push("baxis","bline"),H.caxis.layer==="below traces"&&X.push("caxis","cline"),X.push("frontplot"),H.aaxis.layer==="above traces"&&X.push("aaxis","aline"),H.baxis.layer==="above traces"&&X.push("baxis","bline"),H.caxis.layer==="above traces"&&X.push("caxis","cline");var $=this.plotContainer.selectAll("g.toplevel").data(X,String),G=["agrid","bgrid","cgrid"];$.enter().append("g").attr("class",function(W){return"toplevel "+W}).each(function(W){var te=p.select(this);V[W]=te,W==="frontplot"?te.append("g").classed("scatterlayer",!0):W==="backplot"?te.append("g").classed("maplayer",!0):W==="plotbg"?te.append("path").attr("d","M0,0Z"):W==="aline"||W==="bline"||W==="cline"?te.append("path"):W==="grids"&&G.forEach(function(N){V[N]=te.append("g").classed("grid "+N,!0)})}),$.order()};var A=Math.sqrt(4/3);L.adjustLayout=function(H,V){var X,$,G,W,te,N,B=this,U=H.domain,ee=(U.x[0]+U.x[1])/2,j=(U.y[0]+U.y[1])/2,Q=U.x[1]-U.x[0],K=U.y[1]-U.y[0],re=Q*V.w,ne=K*V.h,le=H.sum,oe=H.aaxis.min,de=H.baxis.min,se=H.caxis.min;re>A*ne?G=(W=ne)*A:W=(G=re)/A,te=Q*G/re,N=K*W/ne,X=V.l+V.w*ee-G/2,$=V.t+V.h*(1-j)-W/2,B.x0=X,B.y0=$,B.w=G,B.h=W,B.sum=le,B.xaxis={type:"linear",range:[oe+2*se-le,le-oe-2*de],domain:[ee-te/2,ee+te/2],_id:"x"},r(B.xaxis,B.graphDiv._fullLayout),B.xaxis.setScale(),B.xaxis.isPtWithinRange=function(ze){return ze.a>=B.aaxis.range[0]&&ze.a<=B.aaxis.range[1]&&ze.b>=B.baxis.range[1]&&ze.b<=B.baxis.range[0]&&ze.c>=B.caxis.range[1]&&ze.c<=B.caxis.range[0]},B.yaxis={type:"linear",range:[oe,le-de-se],domain:[j-N/2,j+N/2],_id:"y"},r(B.yaxis,B.graphDiv._fullLayout),B.yaxis.setScale(),B.yaxis.isPtWithinRange=function(){return!0};var me=B.yaxis.domain[0],Te=B.aaxis=m({},H.aaxis,{range:[oe,le-de-se],side:"left",tickangle:(+H.aaxis.tickangle||0)-30,domain:[me,me+N*A],anchor:"free",position:0,_id:"y",_length:G});r(Te,B.graphDiv._fullLayout),Te.setScale();var _e=B.baxis=m({},H.baxis,{range:[le-oe-se,de],side:"bottom",domain:B.xaxis.domain,anchor:"free",position:0,_id:"x",_length:G});r(_e,B.graphDiv._fullLayout),_e.setScale();var be=B.caxis=m({},H.caxis,{range:[le-oe-de,se],side:"right",tickangle:(+H.caxis.tickangle||0)+30,domain:[me,me+N*A],anchor:"free",position:0,_id:"y",_length:G});r(be,B.graphDiv._fullLayout),be.setScale();var Ce="M"+X+","+($+W)+"h"+G+"l-"+G/2+",-"+W+"Z";B.clipDef.select("path").attr("d",Ce),B.layers.plotbg.select("path").attr("d",Ce);var fe="M0,"+W+"h"+G+"l-"+G/2+",-"+W+"Z";B.clipDefRelative.select("path").attr("d",fe);var ve=e(X,$);B.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",ve),B.clipDefRelative.select("path").attr("transform",null);var Me=e(X-_e._offset,$+W);B.layers.baxis.attr("transform",Me),B.layers.bgrid.attr("transform",Me);var ke=e(X+G/2,$)+"rotate(30)"+e(0,-Te._offset);B.layers.aaxis.attr("transform",ke),B.layers.agrid.attr("transform",ke);var Le=e(X+G/2,$)+"rotate(-30)"+e(0,-be._offset);B.layers.caxis.attr("transform",Le),B.layers.cgrid.attr("transform",Le),B.drawAxes(!0),B.layers.aline.select("path").attr("d",Te.showline?"M"+X+","+($+W)+"l"+G/2+",-"+W:"M0,0").call(t.stroke,Te.linecolor||"#000").style("stroke-width",(Te.linewidth||0)+"px"),B.layers.bline.select("path").attr("d",_e.showline?"M"+X+","+($+W)+"h"+G:"M0,0").call(t.stroke,_e.linecolor||"#000").style("stroke-width",(_e.linewidth||0)+"px"),B.layers.cline.select("path").attr("d",be.showline?"M"+(X+G/2)+","+$+"l"+G/2+","+W:"M0,0").call(t.stroke,be.linecolor||"#000").style("stroke-width",(be.linewidth||0)+"px"),B.graphDiv._context.staticPlot||B.initInteractions(),a.setClipUrl(B.layers.frontplot,B._hasClipOnAxisFalse?null:B.clipId,B.graphDiv)},L.drawAxes=function(H){var V=this.graphDiv,X=this.id.substr(7)+"title",$=this.layers,G=this.aaxis,W=this.baxis,te=this.caxis;if(this.drawAx(G),this.drawAx(W),this.drawAx(te),H){var N=Math.max(G.showticklabels?G.tickfont.size/2:0,(te.showticklabels?.75*te.tickfont.size:0)+(te.ticks==="outside"?.87*te.ticklen:0)),B=(W.showticklabels?W.tickfont.size:0)+(W.ticks==="outside"?W.ticklen:0)+3;$["a-title"]=s.draw(V,"a"+X,{propContainer:G,propName:this.id+".aaxis.title",placeholder:n(V,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-G.title.font.size/3-N,"text-anchor":"middle"}}),$["b-title"]=s.draw(V,"b"+X,{propContainer:W,propName:this.id+".baxis.title",placeholder:n(V,"Click to enter Component B title"),attributes:{x:this.x0-B,y:this.y0+this.h+.83*W.title.font.size+B,"text-anchor":"middle"}}),$["c-title"]=s.draw(V,"c"+X,{propContainer:te,propName:this.id+".caxis.title",placeholder:n(V,"Click to enter Component C title"),attributes:{x:this.x0+this.w+B,y:this.y0+this.h+.83*te.title.font.size+B,"text-anchor":"middle"}})}},L.drawAx=function(H){var V,X=this.graphDiv,$=H._name,G=$.charAt(0),W=H._id,te=this.layers[$],N=G+"tickLayout",B=(V=H).ticks+String(V.ticklen)+String(V.showticklabels);this[N]!==B&&(te.selectAll("."+W+"tick").remove(),this[N]=B),H.setScale();var U=i.calcTicks(H),ee=i.clipEnds(H,U),j=i.makeTransTickFn(H),Q=i.getTickSigns(H)[2],K=y.deg2rad(30),re=Q*(H.linewidth||1)/2,ne=Q*H.ticklen,le=this.w,oe=this.h,de=G==="b"?"M0,"+re+"l"+Math.sin(K)*ne+","+Math.cos(K)*ne:"M"+re+",0l"+Math.cos(K)*ne+","+-Math.sin(K)*ne,se={a:"M0,0l"+oe+",-"+le/2,b:"M0,0l-"+le/2+",-"+oe,c:"M0,0l-"+oe+","+le/2}[G];i.drawTicks(X,H,{vals:H.ticks==="inside"?ee:U,layer:te,path:de,transFn:j,crisp:!1}),i.drawGrid(X,H,{vals:ee,layer:this.layers[G+"grid"],path:se,transFn:j,crisp:!1}),i.drawLabels(X,H,{vals:U,layer:te,transFn:j,labelFns:i.makeLabelFns(H,0,30)})};var I=w.MINZOOM/2+.87,P="m-0.87,.5h"+I+"v3h-"+(I+5.2)+"l"+(I/2+2.6)+",-"+(.87*I+4.5)+"l2.6,1.5l-"+I/2+","+.87*I+"Z",S="m0.87,.5h-"+I+"v3h"+(I+5.2)+"l-"+(I/2+2.6)+",-"+(.87*I+4.5)+"l-2.6,1.5l"+I/2+","+.87*I+"Z",E="m0,1l"+I/2+","+.87*I+"l2.6,-1.5l-"+(I/2+2.6)+",-"+(.87*I+4.5)+"l-"+(I/2+2.6)+","+(.87*I+4.5)+"l2.6,1.5l"+I/2+",-"+.87*I+"Z",D=!0;function R(H){p.select(H).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}L.clearOutline=function(){_(this.dragOptions),T(this.dragOptions.gd)},L.initInteractions=function(){var H,V,X,$,G,W,te,N,B,U,ee,j,Q=this,K=Q.layers.plotbg.select("path").node(),re=Q.graphDiv,ne=re._fullLayout._zoomlayer;function le(fe){var ve={};return ve[Q.id+".aaxis.min"]=fe.a,ve[Q.id+".baxis.min"]=fe.b,ve[Q.id+".caxis.min"]=fe.c,ve}function oe(fe,ve){var Me=re._fullLayout.clickmode;R(re),fe===2&&(re.emit("plotly_doubleclick",null),b.call("_guiRelayout",re,le({a:0,b:0,c:0}))),Me.indexOf("select")>-1&&fe===1&&c(ve,re,[Q.xaxis],[Q.yaxis],Q.id,Q.dragOptions),Me.indexOf("event")>-1&&f.click(re,ve,Q.id)}function de(fe,ve){return 1-ve/Q.h}function se(fe,ve){return 1-(fe+(Q.h-ve)/Math.sqrt(3))/Q.w}function me(fe,ve){return(fe-(Q.h-ve)/Math.sqrt(3))/Q.w}function Te(fe,ve){var Me=X+fe*H,ke=$+ve*V,Le=Math.max(0,Math.min(1,de(0,$),de(0,ke))),ze=Math.max(0,Math.min(1,se(X,$),se(Me,ke))),Re=Math.max(0,Math.min(1,me(X,$),me(Me,ke))),Oe=(Le/2+Re)*Q.w,Ze=(1-Le/2-ze)*Q.w,Pe=(Oe+Ze)/2,Ie=Ze-Oe,Be=(1-Le)*Q.h,Fe=Be-Ie/A;Ie<w.MINZOOM?(te=G,ee.attr("d",B),j.attr("d","M0,0Z")):(te={a:G.a+Le*W,b:G.b+ze*W,c:G.c+Re*W},ee.attr("d",B+"M"+Oe+","+Be+"H"+Ze+"L"+Pe+","+Fe+"L"+Oe+","+Be+"Z"),j.attr("d","M"+X+","+$+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+Oe+","+Be+P+"M"+Ze+","+Be+S+"M"+Pe+","+Fe+E)),U||(ee.transition().style("fill",N>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),j.transition().style("opacity",1).duration(200),U=!0),re.emit("plotly_relayouting",le(te))}function _e(){R(re),te!==G&&(b.call("_guiRelayout",re,le(te)),D&&re.data&&re._context.showTips&&(y.notifier(n(re,"Double-click to zoom back out"),"long"),D=!1))}function be(fe,ve){var Me=fe/Q.xaxis._m,ke=ve/Q.yaxis._m,Le=[(te={a:G.a-ke,b:G.b+(Me+ke)/2,c:G.c-(Me-ke)/2}).a,te.b,te.c].sort(y.sorterAsc),ze=Le.indexOf(te.a),Re=Le.indexOf(te.b),Oe=Le.indexOf(te.c);Le[0]<0&&(Le[1]+Le[0]/2<0?(Le[2]+=Le[0]+Le[1],Le[0]=Le[1]=0):(Le[2]+=Le[0]/2,Le[1]+=Le[0]/2,Le[0]=0),te={a:Le[ze],b:Le[Re],c:Le[Oe]},ve=(G.a-te.a)*Q.yaxis._m,fe=(G.c-te.c-G.b+te.b)*Q.xaxis._m);var Ze=e(Q.x0+fe,Q.y0+ve);Q.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Ze);var Pe=e(-fe,-ve);Q.clipDefRelative.select("path").attr("transform",Pe),Q.aaxis.range=[te.a,Q.sum-te.b-te.c],Q.baxis.range=[Q.sum-te.a-te.c,te.b],Q.caxis.range=[Q.sum-te.a-te.b,te.c],Q.drawAxes(!1),Q._hasClipOnAxisFalse&&Q.plotContainer.select(".scatterlayer").selectAll(".trace").call(a.hideOutsideRangePoints,Q),re.emit("plotly_relayouting",le(te))}function Ce(){b.call("_guiRelayout",re,le(te))}this.dragOptions={element:K,gd:re,plotinfo:{id:Q.id,domain:re._fullLayout[Q.id].domain,xaxis:Q.xaxis,yaxis:Q.yaxis},subplot:Q.id,prepFn:function(fe,ve,Me){Q.dragOptions.xaxes=[Q.xaxis],Q.dragOptions.yaxes=[Q.yaxis],H=re._fullLayout._invScaleX,V=re._fullLayout._invScaleY;var ke=Q.dragOptions.dragmode=re._fullLayout.dragmode;h(ke)?Q.dragOptions.minDrag=1:Q.dragOptions.minDrag=void 0,ke==="zoom"?(Q.dragOptions.moveFn=Te,Q.dragOptions.clickFn=oe,Q.dragOptions.doneFn=_e,function(Le,ze,Re){var Oe=K.getBoundingClientRect();X=ze-Oe.left,$=Re-Oe.top,re._fullLayout._calcInverseTransform(re);var Ze=re._fullLayout._invTransform,Pe=y.apply3DTransform(Ze)(X,$);X=Pe[0],$=Pe[1],G={a:Q.aaxis.range[0],b:Q.baxis.range[1],c:Q.caxis.range[1]},te=G,W=Q.aaxis.range[1]-G.a,N=g(Q.graphDiv._fullLayout[Q.id].bgcolor).getLuminance(),B="M0,"+Q.h+"L"+Q.w/2+", 0L"+Q.w+","+Q.h+"Z",U=!1,ee=ne.append("path").attr("class","zoombox").attr("transform",e(Q.x0,Q.y0)).style({fill:N>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",B),j=ne.append("path").attr("class","zoombox-corners").attr("transform",e(Q.x0,Q.y0)).style({fill:t.background,stroke:t.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),Q.clearOutline(re)}(0,ve,Me)):ke==="pan"?(Q.dragOptions.moveFn=be,Q.dragOptions.clickFn=oe,Q.dragOptions.doneFn=Ce,G={a:Q.aaxis.range[0],b:Q.baxis.range[1],c:Q.caxis.range[1]},te=G,Q.clearOutline(re)):(d(ke)||h(ke))&&x(fe,ve,Me,Q.dragOptions,ke)}},K.onmousemove=function(fe){f.hover(re,fe,Q.id),re._fullLayout._lasthover=K,re._fullLayout._hoversubplot=Q.id},K.onmouseout=function(fe){re._dragging||u.unhover(re,fe)},u.init(this.dragOptions)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../lib":515,"../../lib/extend":505,"../../registry":647,"../cartesian/axes":566,"../cartesian/constants":573,"../cartesian/set_convert":585,"../plots":628,"@plotly/d3":58,tinycolor2:313}],647:[function(v,J,Z){var p=v("./lib/loggers"),g=v("./lib/noop"),b=v("./lib/push_unique"),y=v("./lib/is_plain_object"),e=v("./lib/dom").addStyleRule,n=v("./lib/extend"),t=v("./plots/attributes"),a=v("./plots/layout_attributes"),r=n.extendFlat,m=n.extendDeepAll;function o(c){var T=c.name,_=c.categories,w=c.meta;if(Z.modules[T])p.log("Type "+T+" already registered");else{Z.subplotsRegistry[c.basePlotModule.name]||function(D){var R=D.name;if(Z.subplotsRegistry[R])return void p.log("Plot type "+R+" already registered.");for(var H in l(D),Z.subplotsRegistry[R]=D,Z.componentsRegistry)s(H,D.name)}(c.basePlotModule);for(var k={},L=0;L<_.length;L++)k[_[L]]=!0,Z.allCategories[_[L]]=!0;for(var A in Z.modules[T]={_module:c,categories:k},w&&Object.keys(w).length&&(Z.modules[T].meta=w),Z.allTypes.push(T),Z.componentsRegistry)h(A,T);c.layoutAttributes&&r(Z.traceLayoutAttributes,c.layoutAttributes);var I=c.basePlotModule,P=I.name;if(P==="mapbox"){var S=I.constants.styleRules;for(var E in S)e(".js-plotly-plot .plotly .mapboxgl-"+E,S[E])}P!=="geo"&&P!=="mapbox"||window.PlotlyGeoAssets!==void 0||(window.PlotlyGeoAssets={topojson:{}})}}function i(c){if(typeof c.name!="string")throw new Error("Component module *name* must be a string.");var T=c.name;for(var _ in Z.componentsRegistry[T]=c,c.layoutAttributes&&(c.layoutAttributes._isLinkedToArray&&b(Z.layoutArrayContainers,T),l(c)),Z.modules)h(T,_);for(var w in Z.subplotsRegistry)s(T,w);for(var k in Z.transformsRegistry)d(T,k);c.schema&&c.schema.layout&&m(a,c.schema.layout)}function u(c){if(typeof c.name!="string")throw new Error("Transform module *name* must be a string.");var T="Transform module "+c.name,_=typeof c.transform=="function",w=typeof c.calcTransform=="function";if(!_&&!w)throw new Error(T+" is missing a *transform* or *calcTransform* method.");for(var k in _&&w&&p.log([T+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),y(c.attributes)||p.log(T+" registered without an *attributes* object."),typeof c.supplyDefaults!="function"&&p.log(T+" registered without a *supplyDefaults* method."),Z.transformsRegistry[c.name]=c,Z.componentsRegistry)d(k,c.name)}function f(c){var T=c.name,_=T.split("-")[0],w=c.dictionary,k=c.format,L=w&&Object.keys(w).length,A=k&&Object.keys(k).length,I=Z.localeRegistry,P=I[T];if(P||(I[T]=P={}),_!==T){var S=I[_];S||(I[_]=S={}),L&&S.dictionary===P.dictionary&&(S.dictionary=w),A&&S.format===P.format&&(S.format=k)}L&&(P.dictionary=w),A&&(P.format=k)}function l(c){if(c.layoutAttributes){var T=c.layoutAttributes._arrayAttrRegexps;if(T)for(var _=0;_<T.length;_++)b(Z.layoutArrayRegexes,T[_])}}function h(c,T){var _=Z.componentsRegistry[c].schema;if(_&&_.traces){var w=_.traces[T];w&&m(Z.modules[T]._module.attributes,w)}}function d(c,T){var _=Z.componentsRegistry[c].schema;if(_&&_.transforms){var w=_.transforms[T];w&&m(Z.transformsRegistry[T].attributes,w)}}function s(c,T){var _=Z.componentsRegistry[c].schema;if(_&&_.subplots){var w=Z.subplotsRegistry[T],k=w.layoutAttributes,L=w.attr==="subplot"?w.name:w.attr;Array.isArray(L)&&(L=L[0]);var A=_.subplots[L];k&&A&&m(k,A)}}function x(c){return typeof c=="object"&&(c=c.type),c}Z.modules={},Z.allCategories={},Z.allTypes=[],Z.subplotsRegistry={},Z.transformsRegistry={},Z.componentsRegistry={},Z.layoutArrayContainers=[],Z.layoutArrayRegexes=[],Z.traceLayoutAttributes={},Z.localeRegistry={},Z.apiMethodRegistry={},Z.collectableSubplotTypes=null,Z.register=function(c){if(Z.collectableSubplotTypes=null,!c)throw new Error("No argument passed to Plotly.register.");c&&!Array.isArray(c)&&(c=[c]);for(var T=0;T<c.length;T++){var _=c[T];if(!_)throw new Error("Invalid module was attempted to be registered!");switch(_.moduleType){case"trace":o(_);break;case"transform":u(_);break;case"component":i(_);break;case"locale":f(_);break;case"apiMethod":var w=_.name;Z.apiMethodRegistry[w]=_.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},Z.getModule=function(c){var T=Z.modules[x(c)];return!!T&&T._module},Z.traceIs=function(c,T){if((c=x(c))==="various")return!1;var _=Z.modules[c];return _||(c&&p.log("Unrecognized trace type "+c+"."),_=Z.modules[t.type.dflt]),!!_.categories[T]},Z.getTransformIndices=function(c,T){for(var _=[],w=c.transforms||[],k=0;k<w.length;k++)w[k].type===T&&_.push(k);return _},Z.hasTransform=function(c,T){for(var _=c.transforms||[],w=0;w<_.length;w++)if(_[w].type===T)return!0;return!1},Z.getComponentMethod=function(c,T){var _=Z.componentsRegistry[c];return _&&_[T]||g},Z.call=function(){var c=arguments[0],T=[].slice.call(arguments,1);return Z.apiMethodRegistry[c].apply(null,T)}},{"./lib/dom":503,"./lib/extend":505,"./lib/is_plain_object":516,"./lib/loggers":519,"./lib/noop":524,"./lib/push_unique":530,"./plots/attributes":562,"./plots/layout_attributes":619}],648:[function(v,J,Z){var p=v("../registry"),g=v("../lib"),b=g.extendFlat,y=g.extendDeep;function e(n){var t;switch(n){case"themes__thumb":t={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":t={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:t={}}return t}J.exports=function(n,t){var a,r,m=n.data,o=n.layout,i=y([],m),u=y({},o,e(t.tileClass)),f=n._context||{};if(t.width&&(u.width=t.width),t.height&&(u.height=t.height),t.tileClass==="thumbnail"||t.tileClass==="themes__thumb"){u.annotations=[];var l=Object.keys(u);for(a=0;a<l.length;a++)r=l[a],["xaxis","yaxis","zaxis"].indexOf(r.slice(0,5))>-1&&(u[l[a]].title={text:""});for(a=0;a<i.length;a++){var h=i[a];h.showscale=!1,h.marker&&(h.marker.showscale=!1),p.traceIs(h,"pie-like")&&(h.textposition="none")}}if(Array.isArray(t.annotations))for(a=0;a<t.annotations.length;a++)u.annotations.push(t.annotations[a]);var d=Object.keys(u).filter(function(_){return _.match(/^scene\d*$/)});if(d.length){var s={};for(t.tileClass==="thumbnail"&&(s={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),a=0;a<d.length;a++){var x=u[d[a]];x.xaxis||(x.xaxis={}),x.yaxis||(x.yaxis={}),x.zaxis||(x.zaxis={}),b(x.xaxis,s),b(x.yaxis,s),b(x.zaxis,s),x._scene=null}}var c=document.createElement("div");t.tileClass&&(c.className=t.tileClass);var T={gd:c,td:c,layout:u,data:i,config:{staticPlot:t.staticPlot===void 0||t.staticPlot,plotGlPixelRatio:t.plotGlPixelRatio===void 0?2:t.plotGlPixelRatio,displaylogo:t.displaylogo||!1,showLink:t.showLink||!1,showTips:t.showTips||!1,mapboxAccessToken:f.mapboxAccessToken}};return t.setBackground!=="transparent"&&(T.config.setBackground=t.setBackground||"opaque"),T.gd.defaultLayout=e(t.tileClass),T}},{"../lib":515,"../registry":647}],649:[function(v,J,Z){var p=v("../lib"),g=v("../plot_api/to_image"),b=v("./filesaver"),y=v("./helpers");J.exports=function(e,n){var t;return p.isPlainObject(e)||(t=p.getGraphDiv(e)),(n=n||{}).format=n.format||"png",n.width=n.width||null,n.height=n.height||null,n.imageDataOnly=!0,new Promise(function(a,r){t&&t._snapshotInProgress&&r(new Error("Snapshotting already in progress.")),p.isIE()&&n.format!=="svg"&&r(new Error(y.MSG_IE_BAD_FORMAT)),t&&(t._snapshotInProgress=!0);var m=g(e,n),o=n.filename||e.fn||"newplot";o+="."+n.format.replace("-","."),m.then(function(i){return t&&(t._snapshotInProgress=!1),b(i,o,n.format)}).then(function(i){a(i)}).catch(function(i){t&&(t._snapshotInProgress=!1),r(i)})})}},{"../lib":515,"../plot_api/to_image":558,"./filesaver":650,"./helpers":651}],650:[function(v,J,Z){var p=v("../lib"),g=v("./helpers");J.exports=function(b,y,e){var n=document.createElement("a"),t="download"in n;return new Promise(function(a,r){var m,o;if(p.isIE())return m=g.createBlob(b,"svg"),window.navigator.msSaveBlob(m,y),m=null,a(y);if(t)return m=g.createBlob(b,e),o=g.createObjectURL(m),n.href=o,n.download=y,document.body.appendChild(n),n.click(),document.body.removeChild(n),g.revokeObjectURL(o),m=null,a(y);if(p.isSafari()){var i=e==="svg"?",":";base64,";return g.octetStream(i+encodeURIComponent(b)),a(y)}r(new Error("download error"))})}},{"../lib":515,"./helpers":651}],651:[function(v,J,Z){var p=v("../registry");Z.getDelay=function(b){return b._has&&(b._has("gl3d")||b._has("gl2d")||b._has("mapbox"))?500:0},Z.getRedrawFunc=function(b){return function(){p.getComponentMethod("colorbar","draw")(b)}},Z.encodeSVG=function(b){return"data:image/svg+xml,"+encodeURIComponent(b)},Z.encodeJSON=function(b){return"data:application/json,"+encodeURIComponent(b)};var g=window.URL||window.webkitURL;Z.createObjectURL=function(b){return g.createObjectURL(b)},Z.revokeObjectURL=function(b){return g.revokeObjectURL(b)},Z.createBlob=function(b,y){if(y==="svg")return new window.Blob([b],{type:"image/svg+xml;charset=utf-8"});if(y==="full-json")return new window.Blob([b],{type:"application/json;charset=utf-8"});var e=function(n){for(var t=n.length,a=new ArrayBuffer(t),r=new Uint8Array(a),m=0;m<t;m++)r[m]=n.charCodeAt(m);return a}(window.atob(b));return new window.Blob([e],{type:"image/"+y})},Z.octetStream=function(b){document.location.href="data:application/octet-stream"+b},Z.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,Z.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":647}],652:[function(v,J,Z){var p=v("./helpers"),g={getDelay:p.getDelay,getRedrawFunc:p.getRedrawFunc,clone:v("./cloneplot"),toSVG:v("./tosvg"),svgToImg:v("./svgtoimg"),toImage:v("./toimage"),downloadImage:v("./download")};J.exports=g},{"./cloneplot":648,"./download":649,"./helpers":651,"./svgtoimg":653,"./toimage":654,"./tosvg":655}],653:[function(v,J,Z){var p=v("../lib"),g=v("events").EventEmitter,b=v("./helpers");J.exports=function(y){var e=y.emitter||new g,n=new Promise(function(t,a){var r=window.Image,m=y.svg,o=y.format||"png";if(p.isIE()&&o!=="svg"){var i=new Error(b.MSG_IE_BAD_FORMAT);return a(i),y.promise?n:e.emit("error",i)}var u,f,l=y.canvas,h=y.scale||1,d=y.width||300,s=y.height||150,x=h*d,c=h*s,T=l.getContext("2d",{willReadFrequently:!0}),_=new r;o==="svg"||p.isSafari()?f=b.encodeSVG(m):(u=b.createBlob(m,"svg"),f=b.createObjectURL(u)),l.width=x,l.height=c,_.onload=function(){var w;switch(u=null,b.revokeObjectURL(f),o!=="svg"&&T.drawImage(_,0,0,x,c),o){case"jpeg":w=l.toDataURL("image/jpeg");break;case"png":w=l.toDataURL("image/png");break;case"webp":w=l.toDataURL("image/webp");break;case"svg":w=f;break;default:var k="Image format is not jpeg, png, svg or webp.";if(a(new Error(k)),!y.promise)return e.emit("error",k)}t(w),y.promise||e.emit("success",w)},_.onerror=function(w){if(u=null,b.revokeObjectURL(f),a(w),!y.promise)return e.emit("error",w)},_.src=f});return y.promise?n:e}},{"../lib":515,"./helpers":651,events:84}],654:[function(v,J,Z){var p=v("events").EventEmitter,g=v("../registry"),b=v("../lib"),y=v("./helpers"),e=v("./cloneplot"),n=v("./tosvg"),t=v("./svgtoimg");J.exports=function(a,r){var m=new p,o=e(a,{format:"png"}),i=o.gd;i.style.position="absolute",i.style.left="-5000px",document.body.appendChild(i);var u=y.getRedrawFunc(i);return g.call("_doPlot",i,o.data,o.layout,o.config).then(u).then(function(){var f=y.getDelay(i._fullLayout);setTimeout(function(){var l=n(i),h=document.createElement("canvas");h.id=b.randstr(),(m=t({format:r.format,width:i._fullLayout.width,height:i._fullLayout.height,canvas:h,emitter:m,svg:l})).clean=function(){i&&document.body.removeChild(i)}},f)}).catch(function(f){m.emit("error",f)}),m}},{"../lib":515,"../registry":647,"./cloneplot":648,"./helpers":651,"./svgtoimg":653,"./tosvg":655,events:84}],655:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../lib"),b=v("../components/drawing"),y=v("../components/color"),e=v("../constants/xmlns_namespaces"),n=/"/g,t=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");J.exports=function(a,r,m){var o,i=a._fullLayout,u=i._paper,f=i._toppaper,l=i.width,h=i.height;u.insert("rect",":first-child").call(b.setRect,0,0,l,h).call(y.fill,i.paper_bgcolor);var d=i._basePlotModules||[];for(o=0;o<d.length;o++){var s=d[o];s.toSVG&&s.toSVG(a)}if(f){var x=f.node().childNodes,c=Array.prototype.slice.call(x);for(o=0;o<c.length;o++){var T=c[o];T.childNodes.length&&u.node().appendChild(T)}}i._draggers&&i._draggers.remove(),u.node().style.background="",u.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var w=p.select(this);if(this.style.visibility!=="hidden"&&this.style.display!=="none"){w.style({visibility:null,display:null});var k=this.style.fontFamily;k&&k.indexOf('"')!==-1&&w.style("font-family",k.replace(n,"TOBESTRIPPED"))}else w.remove()}),u.selectAll(".gradient_filled,.pattern_filled").each(function(){var w=p.select(this),k=this.style.fill;k&&k.indexOf("url(")!==-1&&w.style("fill",k.replace(n,"TOBESTRIPPED"));var L=this.style.stroke;L&&L.indexOf("url(")!==-1&&w.style("stroke",L.replace(n,"TOBESTRIPPED"))}),r!=="pdf"&&r!=="eps"||u.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),u.node().setAttributeNS(e.xmlns,"xmlns",e.svg),u.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),r==="svg"&&m&&(u.attr("width",m*l),u.attr("height",m*h),u.attr("viewBox","0 0 "+l+" "+h));var _=new window.XMLSerializer().serializeToString(u.node());return _=function(w){var k=p.select("body").append("div").style({display:"none"}).html(""),L=w.replace(/(&[^;]*;)/gi,function(A){return A==="&lt;"?"&#60;":A==="&rt;"?"&#62;":A.indexOf("<")!==-1||A.indexOf(">")!==-1?"":k.html(A).text()});return k.remove(),L}(_),_=(_=_.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(t,"'"),g.isIE()&&(_=(_=(_=_.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),_}},{"../components/color":367,"../components/drawing":389,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],656:[function(v,J,Z){var p=v("../../lib");J.exports=function(g,b){for(var y=0;y<g.length;y++)g[y].i=y;p.mergeArray(b.text,g,"tx"),p.mergeArray(b.hovertext,g,"htx");var e=b.marker;if(e){p.mergeArray(e.opacity,g,"mo",!0),p.mergeArray(e.color,g,"mc");var n=e.line;n&&(p.mergeArray(n.color,g,"mlc"),p.mergeArrayCastPositive(n.width,g,"mlw"))}}},{"../../lib":515}],657:[function(v,J,Z){var p=v("../scatter/attributes"),g=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,b=v("../../plots/template_attributes").hovertemplateAttrs,y=v("../../plots/template_attributes").texttemplateAttrs,e=v("../../components/colorscale/attributes"),n=v("../../plots/font_attributes"),t=v("./constants"),a=v("../../components/drawing/attributes").pattern,r=v("../../lib/extend").extendFlat,m=n({editType:"calc",arrayOk:!0,colorEditType:"style"}),o=r({},p.marker.line.width,{dflt:0}),i=r({width:o,editType:"calc"},e("marker.line")),u=r({line:i,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:a});J.exports={x:p.x,x0:p.x0,dx:p.dx,y:p.y,y0:p.y0,dy:p.dy,xperiod:p.xperiod,yperiod:p.yperiod,xperiod0:p.xperiod0,yperiod0:p.yperiod0,xperiodalignment:p.xperiodalignment,yperiodalignment:p.yperiodalignment,xhoverformat:g("x"),yhoverformat:g("y"),text:p.text,texttemplate:y({editType:"plot"},{keys:t.eventDataKeys}),hovertext:p.hovertext,hovertemplate:b({},{keys:t.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:r({},m,{}),insidetextfont:r({},m,{}),outsidetextfont:r({},m,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:r({},p.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:u,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:p.selected.marker.opacity,color:p.selected.marker.color,editType:"style"},textfont:p.selected.textfont,editType:"style"},unselected:{marker:{opacity:p.unselected.marker.opacity,color:p.unselected.marker.color,editType:"style"},textfont:p.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936,"./constants":659}],658:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("../../plots/cartesian/align_period"),b=v("../../components/colorscale/helpers").hasColorscale,y=v("../../components/colorscale/calc"),e=v("./arrays_to_calcdata"),n=v("../scatter/calc_selection");J.exports=function(t,a){var r,m,o,i,u,f,l=p.getFromId(t,a.xaxis||"x"),h=p.getFromId(t,a.yaxis||"y"),d={msUTC:!(!a.base&&a.base!==0)};a.orientation==="h"?(r=l.makeCalcdata(a,"x",d),o=h.makeCalcdata(a,"y"),i=g(a,h,"y",o),u=!!a.yperiodalignment,f="y"):(r=h.makeCalcdata(a,"y",d),o=l.makeCalcdata(a,"x"),i=g(a,l,"x",o),u=!!a.xperiodalignment,f="x"),m=i.vals;for(var s=Math.min(m.length,r.length),x=new Array(s),c=0;c<s;c++)x[c]={p:m[c],s:r[c]},u&&(x[c].orig_p=o[c],x[c][f+"End"]=i.ends[c],x[c][f+"Start"]=i.starts[c]),a.ids&&(x[c].id=String(a.ids[c]));return b(a,"marker")&&y(t,a,{vals:a.marker.color,containerStr:"marker",cLetter:"c"}),b(a,"marker.line")&&y(t,a,{vals:a.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(x,a),n(x,a),x}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":656}],659:[function(v,J,Z){J.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],660:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib").isArrayOrTypedArray,b=v("../../constants/numerical").BADNUM,y=v("../../registry"),e=v("../../plots/cartesian/axes"),n=v("../../plots/cartesian/constraints").getAxisGroup,t=v("./sieve.js");function a(s,x,c,T,_){if(T.length){var w,k,L,A;switch(function(I,P){var S,E;for(S=0;S<P.length;S++){var D,R=P[S],H=R[0].trace,V=H.type==="funnel"?H._base:H.base,X=H.orientation==="h"?H.xcalendar:H.ycalendar,$=I.type==="category"||I.type==="multicategory"?function(){return null}:I.d2c;if(g(V)){for(E=0;E<Math.min(V.length,R.length);E++)D=$(V[E],0,X),p(D)?(R[E].b=+D,R[E].hasB=1):R[E].b=0;for(;E<R.length;E++)R[E].b=0}else{D=$(V,0,X);var G=p(D);for(D=G?D:0,E=0;E<R.length;E++)R[E].b=D,G&&(R[E].hasB=1)}}}(c,T),_.mode){case"overlay":r(x,c,T,_);break;case"group":for(w=[],k=[],L=0;L<T.length;L++)(A=T[L])[0].trace.offset===void 0?k.push(A):w.push(A);k.length&&function(I,P,S,E,D){var R=new t(E,{posAxis:P,sepNegVal:!1,overlapNoMerge:!D.norm});(function(H,V,X,$){for(var G=H._fullLayout,W=X.positions,te=X.distinctPositions,N=X.minDiff,B=X.traces,U=B.length,ee=W.length!==te.length,j=N*(1-$.gap),Q=n(G,V._id)+B[0][0].trace.orientation,K=G._alignmentOpts[Q]||{},re=0;re<U;re++){var ne,le,oe=B[re],de=oe[0].trace,se=K[de.alignmentgroup]||{},me=Object.keys(se.offsetGroups||{}).length,Te=(ne=me?j/me:ee?j/U:j)*(1-($.groupgap||0));le=me?((2*de._offsetIndex+1-me)*ne-Te)/2:ee?((2*re+1-U)*ne-Te)/2:-Te/2;var _e=oe[0].t;_e.barwidth=Te,_e.poffset=le,_e.bargroupwidth=j,_e.bardelta=N}X.binWidth=B[0][0].t.barwidth/100,o(X),i(V,X),u(V,X,ee)})(I,P,R,D),function(H,V){for(var X=H.traces,$=0;$<X.length;$++){var G=X[$];if(G[0].trace.base===void 0)for(var W=new t([G],{posAxis:V,sepNegVal:!0,overlapNoMerge:!0}),te=0;te<G.length;te++){var N=G[te];if(N.p!==b){var B=W.put(N.p,N.b+N.s);B&&(N.b=B)}}}}(R,P),D.norm?(l(R),h(S,R,D)):f(S,R)}(s,x,c,k,_),w.length&&r(x,c,w,_);break;case"stack":case"relative":for(w=[],k=[],L=0;L<T.length;L++)(A=T[L])[0].trace.base===void 0?k.push(A):w.push(A);k.length&&function(I,P,S,E,D){var R=new t(E,{posAxis:P,sepNegVal:D.mode==="relative",overlapNoMerge:!(D.norm||D.mode==="stack"||D.mode==="relative")});m(P,R,D),function(G,W,te){var N,B,U,ee,j,Q,K=d(G),re=W.traces;for(ee=0;ee<re.length;ee++)if(N=re[ee],(B=N[0].trace).type==="funnel")for(j=0;j<N.length;j++)(Q=N[j]).s!==b&&W.put(Q.p,-.5*Q.s);for(ee=0;ee<re.length;ee++){N=re[ee],B=N[0].trace,U=B.type==="funnel";var ne=[];for(j=0;j<N.length;j++)if((Q=N[j]).s!==b){var le;le=U?Q.s:Q.s+Q.b;var oe=W.put(Q.p,le),de=oe+le;Q.b=oe,Q[K]=de,te.norm||(ne.push(de),Q.hasB&&ne.push(oe))}te.norm||(B._extremes[G._id]=e.findExtremes(G,ne,{tozero:!0,padded:!0}))}}(S,R,D);for(var H=0;H<E.length;H++)for(var V=E[H],X=0;X<V.length;X++){var $=V[X];$.s!==b&&$.b+$.s===R.get($.p,$.s)&&($._outmost=!0)}D.norm&&h(S,R,D)}(0,x,c,k,_),w.length&&r(x,c,w,_)}(function(I,P){var S,E,D,R=d(P),H={},V=1/0,X=-1/0;for(S=0;S<I.length;S++)for(D=I[S],E=0;E<D.length;E++){var $=D[E].p;p($)&&(V=Math.min(V,$),X=Math.max(X,$))}var G=1e4/(X-V),W=H.round=function(Q){return String(Math.round(G*(Q-V)))};for(S=0;S<I.length;S++){(D=I[S])[0].t.extents=H;var te=D[0].t.poffset,N=Array.isArray(te);for(E=0;E<D.length;E++){var B=D[E],U=B[R]-B.w/2;if(p(U)){var ee=B[R]+B.w/2,j=W(B.p);H[j]?H[j]=[Math.min(U,H[j][0]),Math.max(ee,H[j][1])]:H[j]=[U,ee]}B.p0=B.p+(N?te[E]:te),B.p1=B.p0+B.w,B.s0=B.b,B.s1=B.s0+B.s}}})(T,x)}}function r(s,x,c,T){for(var _=0;_<c.length;_++){var w=c[_],k=new t([w],{posAxis:s,sepNegVal:!1,overlapNoMerge:!T.norm});m(s,k,T),T.norm?(l(k),h(x,k,T)):f(x,k)}}function m(s,x,c){for(var T=x.minDiff,_=x.traces,w=T*(1-c.gap),k=w*(1-(c.groupgap||0)),L=-k/2,A=0;A<_.length;A++){var I=_[A][0].t;I.barwidth=k,I.poffset=L,I.bargroupwidth=w,I.bardelta=T}x.binWidth=_[0][0].t.barwidth/100,o(x),i(s,x),u(s,x)}function o(s){var x,c,T=s.traces;for(x=0;x<T.length;x++){var _,w=T[x],k=w[0],L=k.trace,A=k.t,I=L._offset||L.offset,P=A.poffset;if(g(I)){for(_=Array.prototype.slice.call(I,0,w.length),c=0;c<_.length;c++)p(_[c])||(_[c]=P);for(c=_.length;c<w.length;c++)_.push(P);A.poffset=_}else I!==void 0&&(A.poffset=I);var S=L._width||L.width,E=A.barwidth;if(g(S)){var D=Array.prototype.slice.call(S,0,w.length);for(c=0;c<D.length;c++)p(D[c])||(D[c]=E);for(c=D.length;c<w.length;c++)D.push(E);if(A.barwidth=D,I===void 0){for(_=[],c=0;c<w.length;c++)_.push(P+(E-D[c])/2);A.poffset=_}}else S!==void 0&&(A.barwidth=S,I===void 0&&(A.poffset=P+(E-S)/2))}}function i(s,x){for(var c=x.traces,T=d(s),_=0;_<c.length;_++)for(var w=c[_],k=w[0].t,L=k.poffset,A=Array.isArray(L),I=k.barwidth,P=Array.isArray(I),S=0;S<w.length;S++){var E=w[S],D=E.w=P?I[S]:I;E[T]=E.p+(A?L[S]:L)+D/2}}function u(s,x,c){var T=x.traces,_=x.minDiff/2;e.minDtick(s,x.minDiff,x.distinctPositions[0],c);for(var w=0;w<T.length;w++){var k,L,A,I,P=T[w],S=P[0],E=S.trace,D=[];for(I=0;I<P.length;I++)L=(k=P[I]).p-_,A=k.p+_,D.push(L,A);if(E.width||E.offset){var R=S.t,H=R.poffset,V=R.barwidth,X=Array.isArray(H),$=Array.isArray(V);for(I=0;I<P.length;I++){k=P[I];var G=X?H[I]:H,W=$?V[I]:V;A=(L=k.p+G)+W,D.push(L,A)}}E._extremes[s._id]=e.findExtremes(s,D,{padded:!1})}}function f(s,x){for(var c=x.traces,T=d(s),_=0;_<c.length;_++){for(var w=c[_],k=w[0].trace,L=[],A=!1,I=0;I<w.length;I++){var P=w[I],S=P.b,E=S+P.s;P[T]=E,L.push(E),P.hasB&&L.push(S),P.hasB&&P.b||(A=!0)}k._extremes[s._id]=e.findExtremes(s,L,{tozero:A,padded:!0})}}function l(s){for(var x=s.traces,c=0;c<x.length;c++)for(var T=x[c],_=0;_<T.length;_++){var w=T[_];w.s!==b&&s.put(w.p,w.b+w.s)}}function h(s,x,c){var T=x.traces,_=d(s),w=c.norm==="fraction"?1:100,k=w/1e9,L=s.l2c(s.c2l(0)),A=c.mode==="stack"?w:L;function I(te){return p(s.c2l(te))&&(te<L-k||te>A+k||!p(L))}for(var P=0;P<T.length;P++){for(var S=T[P],E=S[0].trace,D=[],R=!1,H=!1,V=0;V<S.length;V++){var X=S[V];if(X.s!==b){var $=Math.abs(w/x.get(X.p,X.s));X.b*=$,X.s*=$;var G=X.b,W=G+X.s;X[_]=W,D.push(W),H=H||I(W),X.hasB&&(D.push(G),H=H||I(G)),X.hasB&&X.b||(R=!0)}}E._extremes[s._id]=e.findExtremes(s,D,{tozero:R,padded:H})}}function d(s){return s._id.charAt(0)}J.exports={crossTraceCalc:function(s,x){for(var c=x.xaxis,T=x.yaxis,_=s._fullLayout,w=s._fullData,k=s.calcdata,L=[],A=[],I=0;I<w.length;I++){var P=w[I];if(P.visible===!0&&y.traceIs(P,"bar")&&P.xaxis===c._id&&P.yaxis===T._id&&(P.orientation==="h"?L.push(k[I]):A.push(k[I]),P._computePh))for(var S=s.calcdata[I],E=0;E<S.length;E++)typeof S[E].ph0=="function"&&(S[E].ph0=S[E].ph0()),typeof S[E].ph1=="function"&&(S[E].ph1=S[E].ph1())}var D={xCat:c.type==="category"||c.type==="multicategory",yCat:T.type==="category"||T.type==="multicategory",mode:_.barmode,norm:_.barnorm,gap:_.bargap,groupgap:_.bargroupgap};a(s,c,T,A,D),a(s,T,c,L,D)},setGroupPositions:a}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574,"../../registry":647,"./sieve.js":670,"fast-isnumeric":190}],661:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/color"),b=v("../../registry"),y=v("../scatter/xy_defaults"),e=v("../scatter/period_defaults"),n=v("./style_defaults"),t=v("../../plots/cartesian/constraints").getAxisGroup,a=v("./attributes"),r=p.coerceFont;function m(i,u,f,l){var h=u.orientation,d=u[{v:"x",h:"y"}[h]+"axis"],s=t(f,d)+h,x=f._alignmentOpts||{},c=l("alignmentgroup"),T=x[s];T||(T=x[s]={});var _=T[c];_?_.traces.push(u):_=T[c]={traces:[u],alignmentIndex:Object.keys(T).length,offsetGroups:{}};var w=l("offsetgroup"),k=_.offsetGroups,L=k[w];w&&(L||(L=k[w]={offsetIndex:Object.keys(k).length}),u._offsetIndex=L.offsetIndex)}function o(i,u,f,l,h,d){var s=(d=d||{}).moduleHasSelected!==!1,x=d.moduleHasUnselected!==!1,c=d.moduleHasConstrain!==!1,T=d.moduleHasCliponaxis!==!1,_=d.moduleHasTextangle!==!1,w=d.moduleHasInsideanchor!==!1,k=!!d.hasPathbar,L=Array.isArray(h)||h==="auto",A=L||h==="inside",I=L||h==="outside";if(A||I){var P=r(l,"textfont",f.font),S=p.extendFlat({},P),E=!(i.textfont&&i.textfont.color);if(E&&delete S.color,r(l,"insidetextfont",S),k){var D=p.extendFlat({},P);E&&delete D.color,r(l,"pathbar.textfont",D)}I&&r(l,"outsidetextfont",P),s&&l("selected.textfont.color"),x&&l("unselected.textfont.color"),c&&l("constraintext"),T&&l("cliponaxis"),_&&l("textangle"),l("texttemplate")}A&&w&&l("insidetextanchor")}J.exports={supplyDefaults:function(i,u,f,l){function h(c,T){return p.coerce(i,u,a,c,T)}if(y(i,u,l,h)){e(i,u,l,h),h("xhoverformat"),h("yhoverformat"),h("orientation",u.x&&!u.y?"h":"v"),h("base"),h("offset"),h("width"),h("text"),h("hovertext"),h("hovertemplate");var d=h("textposition");o(i,u,l,h,d,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),n(i,u,h,f,l);var s=(u.marker.line||{}).color,x=b.getComponentMethod("errorbars","supplyDefaults");x(i,u,s||g.defaultLine,{axis:"y"}),x(i,u,s||g.defaultLine,{axis:"x",inherit:"y"}),p.coerceSelectionMarkerOpacity(u,h)}else u.visible=!1},crossTraceDefaults:function(i,u){var f;function l(d){return p.coerce(f._input,f,a,d)}if(u.barmode==="group")for(var h=0;h<i.length;h++)(f=i[h]).type==="bar"&&(f._input,m(0,f,u,l))},handleGroupingDefaults:m,handleText:o}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/constraints":574,"../../registry":647,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":657,"./style_defaults":672}],662:[function(v,J,Z){J.exports=function(p,g,b){return p.x="xVal"in g?g.xVal:g.x,p.y="yVal"in g?g.yVal:g.y,g.xa&&(p.xaxis=g.xa),g.ya&&(p.yaxis=g.ya),b.orientation==="h"?(p.label=p.y,p.value=p.x):(p.label=p.x,p.value=p.y),p}},{}],663:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("tinycolor2"),b=v("../../lib").isArrayOrTypedArray;Z.coerceString=function(y,e,n){if(typeof e=="string"){if(e||!y.noBlank)return e}else if((typeof e=="number"||e===!0)&&!y.strict)return String(e);return n!==void 0?n:y.dflt},Z.coerceNumber=function(y,e,n){if(p(e)){e=+e;var t=y.min,a=y.max;if(!(t!==void 0&&e<t||a!==void 0&&e>a))return e}return n!==void 0?n:y.dflt},Z.coerceColor=function(y,e,n){return g(e).isValid()?e:n!==void 0?n:y.dflt},Z.coerceEnumerated=function(y,e,n){return y.coerceNumber&&(e=+e),y.values.indexOf(e)!==-1?e:n!==void 0?n:y.dflt},Z.getValue=function(y,e){var n;return Array.isArray(y)?e<y.length&&(n=y[e]):n=y,n},Z.getLineWidth=function(y,e){return 0<e.mlw?e.mlw:b(y.marker.line.width)?0:y.marker.line.width}},{"../../lib":515,"fast-isnumeric":190,tinycolor2:313}],664:[function(v,J,Z){var p=v("../../components/fx"),g=v("../../registry"),b=v("../../components/color"),y=v("../../lib").fillText,e=v("./helpers").getLineWidth,n=v("../../plots/cartesian/axes").hoverLabelText,t=v("../../constants/numerical").BADNUM;function a(m,o,i,u,f){var l,h,d,s,x,c,T,_=m.cd,w=_[0].trace,k=_[0].t,L=u==="closest",A=w.type==="waterfall",I=m.maxHoverDistance,P=m.maxSpikeDistance;w.orientation==="h"?(l=i,h=o,d="y",s="x",x=N,c=W):(l=o,h=i,d="x",s="y",c=N,x=W);var S=w[d+"period"],E=L||S;function D(ne){return H(ne,-1)}function R(ne){return H(ne,1)}function H(ne,le){var oe=ne.w;return ne[d]+le*oe/2}function V(ne){return ne[d+"End"]-ne[d+"Start"]}var X=L?D:S?function(ne){return ne.p-V(ne)/2}:function(ne){return Math.min(D(ne),ne.p-k.bardelta/2)},$=L?R:S?function(ne){return ne.p+V(ne)/2}:function(ne){return Math.max(R(ne),ne.p+k.bardelta/2)};function G(ne,le,oe){return f.finiteRange&&(oe=0),p.inbox(ne-l,le-l,oe+Math.min(1,Math.abs(le-ne)/T)-1)}function W(ne){return G(X(ne),$(ne),I)}function te(ne){var le=ne[s];if(A){var oe=Math.abs(ne.rawS)||0;h>0?le+=oe:h<0&&(le-=oe)}return le}function N(ne){var le=h,oe=ne.b,de=te(ne);return p.inbox(oe-le,de-le,I+(de-le)/(de-oe)-1)}var B=m[d+"a"],U=m[s+"a"];T=Math.abs(B.r2c(B.range[1])-B.r2c(B.range[0]));var ee=p.getDistanceFunction(u,x,c,function(ne){return(x(ne)+c(ne))/2});if(p.getClosest(_,ee,m),m.index!==!1&&_[m.index].p!==t){E||(X=function(ne){return Math.min(D(ne),ne.p-k.bargroupwidth/2)},$=function(ne){return Math.max(R(ne),ne.p+k.bargroupwidth/2)});var j=_[m.index],Q=w.base?j.b+j.s:j.s;m[s+"0"]=m[s+"1"]=U.c2p(j[s],!0),m[s+"LabelVal"]=Q;var K=k.extents[k.extents.round(j.p)];m[d+"0"]=B.c2p(L?X(j):K[0],!0),m[d+"1"]=B.c2p(L?$(j):K[1],!0);var re=j.orig_p!==void 0;return m[d+"LabelVal"]=re?j.orig_p:j.p,m.labelLabel=n(B,m[d+"LabelVal"],w[d+"hoverformat"]),m.valueLabel=n(U,m[s+"LabelVal"],w[s+"hoverformat"]),m.baseLabel=n(U,j.b,w[s+"hoverformat"]),m.spikeDistance=(function(ne){var le=h,oe=ne.b,de=te(ne);return p.inbox(oe-le,de-le,P+(de-le)/(de-oe)-1)}(j)+function(ne){return G(D(ne),R(ne),P)}(j))/2,m[d+"Spike"]=B.c2p(j.p,!0),y(j,w,m),m.hovertemplate=w.hovertemplate,m}}function r(m,o){var i=o.mcc||m.marker.color,u=o.mlcc||m.marker.line.color,f=e(m,o);return b.opacity(i)?i:b.opacity(u)&&f?u:void 0}J.exports={hoverPoints:function(m,o,i,u,f){var l=a(m,o,i,u,f);if(l){var h=l.cd,d=h[0].trace,s=h[l.index];return l.color=r(d,s),g.getComponentMethod("errorbars","hoverInfo")(s,d,l),[l]}},hoverOnBars:a,getTraceColor:r}},{"../../components/color":367,"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./helpers":663}],665:[function(v,J,Z){J.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc").crossTraceCalc,colorbar:v("../scatter/marker_colorbar"),arraysToCalcdata:v("./arrays_to_calcdata"),plot:v("./plot").plot,style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"bar",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"./arrays_to_calcdata":656,"./attributes":657,"./calc":658,"./cross_trace_calc":660,"./defaults":661,"./event_data":662,"./hover":664,"./layout_attributes":666,"./layout_defaults":667,"./plot":668,"./select":669,"./style":671}],666:[function(v,J,Z){J.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],667:[function(v,J,Z){var p=v("../../registry"),g=v("../../plots/cartesian/axes"),b=v("../../lib"),y=v("./layout_attributes");J.exports=function(e,n,t){function a(d,s){return b.coerce(e,n,y,d,s)}for(var r=!1,m=!1,o=!1,i={},u=a("barmode"),f=0;f<t.length;f++){var l=t[f];if(p.traceIs(l,"bar")&&l.visible){if(r=!0,u==="group"){var h=l.xaxis+l.yaxis;i[h]&&(o=!0),i[h]=!0}l.visible&&l.type==="histogram"&&g.getFromId({_fullLayout:n},l[l.orientation==="v"?"xaxis":"yaxis"]).type!=="category"&&(m=!0)}}r?(u!=="overlay"&&a("barnorm"),a("bargap",m&&!o?0:.2),a("bargroupgap")):delete n.barmode}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./layout_attributes":666}],668:[function(v,J,Z){var p=v("@plotly/d3"),g=v("fast-isnumeric"),b=v("../../lib"),y=v("../../lib/svg_text_utils"),e=v("../../components/color"),n=v("../../components/drawing"),t=v("../../registry"),a=v("../../plots/cartesian/axes").tickText,r=v("./uniform_text"),m=r.recordMinTextSize,o=r.clearMinTextSize,i=v("./style"),u=v("./helpers"),f=v("./constants"),l=v("./attributes"),h=l.text,d=l.textposition,s=v("../../components/fx/helpers").appendArrayPointValue,x=f.TEXTPAD;function c(P){return P.id}function T(P){if(P.ids)return c}function _(P,S){return P<S?1:-1}function w(P,S,E,D){var R;return!S.uniformtext.mode&&k(E)?(D&&(R=D()),P.transition().duration(E.duration).ease(E.easing).each("end",function(){R&&R()}).each("interrupt",function(){R&&R()})):P}function k(P){return P&&P.duration>0}function L(P){return P==="auto"?0:P}function A(P,S){var E=Math.PI/180*S,D=Math.abs(Math.sin(E)),R=Math.abs(Math.cos(E));return{x:P.width*R+P.height*D,y:P.width*D+P.height*R}}function I(P,S,E,D,R,H){var V=!!H.isHorizontal,X=!!H.constrained,$=H.angle||0,G=H.anchor||"end",W=G==="end",te=G==="start",N=((H.leftToRight||0)+1)/2,B=1-N,U=R.width,ee=R.height,j=Math.abs(S-P),Q=Math.abs(D-E),K=j>2*x&&Q>2*x?x:0;j-=2*K,Q-=2*K;var re=L($);$!=="auto"||U<=j&&ee<=Q||!(U>j||ee>Q)||(U>Q||ee>j)&&U<ee==j<Q||(re+=90);var ne=A(R,re),le=1;X&&(le=Math.min(1,j/ne.x,Q/ne.y));var oe=R.left*B+R.right*N,de=(R.top+R.bottom)/2,se=(P+x)*B+(S-x)*N,me=(E+D)/2,Te=0,_e=0;if(te||W){var be=(V?ne.x:ne.y)/2,Ce=V?_(P,S):_(E,D);V?te?(se=P+Ce*K,Te=-Ce*be):(se=S-Ce*K,Te=Ce*be):te?(me=E+Ce*K,_e=-Ce*be):(me=D-Ce*K,_e=Ce*be)}return{textX:oe,textY:de,targetX:se,targetY:me,anchorX:Te,anchorY:_e,scale:le,rotate:re}}J.exports={plot:function(P,S,E,D,R,H){var V=S.xaxis,X=S.yaxis,$=P._fullLayout;R||(R={mode:$.barmode,norm:$.barmode,gap:$.bargap,groupgap:$.bargroupgap},o("bar",$));var G=b.makeTraceGroups(D,E,"trace bars").each(function(W){var te=p.select(this),N=W[0].trace,B=N.type==="waterfall",U=N.type==="funnel",ee=N.type==="bar"||U,j=0;B&&N.connector.visible&&N.connector.mode==="between"&&(j=N.connector.line.width/2);var Q=N.orientation==="h",K=k(R),re=b.ensureSingle(te,"g","points"),ne=T(N),le=re.selectAll("g.point").data(b.identity,ne);le.enter().append("g").classed("point",!0),le.exit().remove(),le.each(function(de,se){var me,Te,_e=p.select(this),be=function(Pe,Ie,Be,Fe){var $e=[],ot=[],pt=Fe?Ie:Be,_t=Fe?Be:Ie;return $e[0]=pt.c2p(Pe.s0,!0),ot[0]=_t.c2p(Pe.p0,!0),$e[1]=pt.c2p(Pe.s1,!0),ot[1]=_t.c2p(Pe.p1,!0),Fe?[$e,ot]:[ot,$e]}(de,V,X,Q),Ce=be[0][0],fe=be[0][1],ve=be[1][0],Me=be[1][1],ke=(Q?fe-Ce:Me-ve)==0;if(ke&&ee&&u.getLineWidth(N,de)&&(ke=!1),ke||(ke=!(g(Ce)&&g(fe)&&g(ve)&&g(Me))),de.isBlank=ke,ke&&(Q?fe=Ce:Me=ve),j&&!ke&&(Q?(Ce-=_(Ce,fe)*j,fe+=_(Ce,fe)*j):(ve-=_(ve,Me)*j,Me+=_(ve,Me)*j)),N.type==="waterfall"){if(!ke){var Le=N[de.dir].marker;me=Le.line.width,Te=Le.color}}else me=u.getLineWidth(N,de),Te=de.mc||N.marker.color;function ze(Pe){var Ie=p.round(me/2%1,2);return R.gap===0&&R.groupgap===0?p.round(Math.round(Pe)-Ie,2):Pe}if(!P._context.staticPlot){var Re=e.opacity(Te)<1||me>.01?ze:function(Pe,Ie,Be){return Be&&Pe===Ie?Pe:Math.abs(Pe-Ie)>=2?ze(Pe):Pe>Ie?Math.ceil(Pe):Math.floor(Pe)};Ce=Re(Ce,fe,Q),fe=Re(fe,Ce,Q),ve=Re(ve,Me,!Q),Me=Re(Me,ve,!Q)}var Oe=w(b.ensureSingle(_e,"path"),$,R,H);if(Oe.style("vector-effect","non-scaling-stroke").attr("d",isNaN((fe-Ce)*(Me-ve))||ke&&P._context.staticPlot?"M0,0Z":"M"+Ce+","+ve+"V"+Me+"H"+fe+"V"+ve+"Z").call(n.setClipUrl,S.layerClipId,P),!$.uniformtext.mode&&K){var Ze=n.makePointStyleFns(N);n.singlePointStyle(de,Oe,N,Ze,P)}(function(Pe,Ie,Be,Fe,$e,ot,pt,_t,yt,tt,Ke){var vt,Nt=Ie.xaxis,qt=Ie.yaxis,er=Pe._fullLayout;function Jt(Gt,jt,pr){return b.ensureSingle(Gt,"text").text(jt).attr({class:"bartext bartext-"+vt,"text-anchor":"middle","data-notex":1}).call(n.font,pr).call(y.convertToTspans,Pe)}var ir=Fe[0].trace,Ht=ir.orientation==="h",Ue=function(Gt,jt,pr,Ar,fr){var Zt,Qt=jt[0].trace;return Zt=Qt.texttemplate?function($t,hr,vr,Mr,Nr){var Ur=hr[0].trace,Jr=b.castOption(Ur,vr,"texttemplate");if(!Jr)return"";var mn,en,In,vn,gn=Ur.type==="histogram",Sn=Ur.type==="waterfall",Xn=Ur.type==="funnel",Br=Ur.orientation==="h";Br?(mn="y",en=Nr,In="x",vn=Mr):(mn="x",en=Mr,In="y",vn=Nr);function pn(ua){return a(vn,vn.c2l(ua),!0).text}var on=hr[vr],Yr={};Yr.label=on.p,Yr.labelLabel=Yr[mn+"Label"]=(Nn=on.p,a(en,en.c2l(Nn),!0).text);var Nn,Hn=b.castOption(Ur,on.i,"text");(Hn===0||Hn)&&(Yr.text=Hn),Yr.value=on.s,Yr.valueLabel=Yr[In+"Label"]=pn(on.s);var xn={};s(xn,Ur,on.i),(gn||xn.x===void 0)&&(xn.x=Br?Yr.value:Yr.label),(gn||xn.y===void 0)&&(xn.y=Br?Yr.label:Yr.value),(gn||xn.xLabel===void 0)&&(xn.xLabel=Br?Yr.valueLabel:Yr.labelLabel),(gn||xn.yLabel===void 0)&&(xn.yLabel=Br?Yr.labelLabel:Yr.valueLabel),Sn&&(Yr.delta=+on.rawS||on.s,Yr.deltaLabel=pn(Yr.delta),Yr.final=on.v,Yr.finalLabel=pn(Yr.final),Yr.initial=Yr.final-Yr.delta,Yr.initialLabel=pn(Yr.initial)),Xn&&(Yr.value=on.s,Yr.valueLabel=pn(Yr.value),Yr.percentInitial=on.begR,Yr.percentInitialLabel=b.formatPercent(on.begR),Yr.percentPrevious=on.difR,Yr.percentPreviousLabel=b.formatPercent(on.difR),Yr.percentTotal=on.sumR,Yr.percenTotalLabel=b.formatPercent(on.sumR));var On=b.castOption(Ur,on.i,"customdata");return On&&(Yr.customdata=On),b.texttemplateString(Jr,Yr,$t._d3locale,xn,Yr,Ur._meta||{})}(Gt,jt,pr,Ar,fr):Qt.textinfo?function($t,hr,vr,Mr){var Nr=$t[0].trace,Ur=Nr.orientation==="h",Jr=Nr.type==="waterfall",mn=Nr.type==="funnel";function en(On){return a(Ur?vr:Mr,+On,!0).text}var In,vn=Nr.textinfo,gn=$t[hr],Sn=vn.split("+"),Xn=[],Br=function(On){return Sn.indexOf(On)!==-1};Br("label")&&Xn.push((pn=$t[hr].p,a(Ur?Mr:vr,pn,!0).text));var pn;if(Br("text")&&((In=b.castOption(Nr,gn.i,"text"))===0||In)&&Xn.push(In),Jr){var on=+gn.rawS||gn.s,Yr=gn.v,Nn=Yr-on;Br("initial")&&Xn.push(en(Nn)),Br("delta")&&Xn.push(en(on)),Br("final")&&Xn.push(en(Yr))}if(mn){Br("value")&&Xn.push(en(gn.s));var Hn=0;Br("percent initial")&&Hn++,Br("percent previous")&&Hn++,Br("percent total")&&Hn++;var xn=Hn>1;Br("percent initial")&&(In=b.formatPercent(gn.begR),xn&&(In+=" of initial"),Xn.push(In)),Br("percent previous")&&(In=b.formatPercent(gn.difR),xn&&(In+=" of previous"),Xn.push(In)),Br("percent total")&&(In=b.formatPercent(gn.sumR),xn&&(In+=" of total"),Xn.push(In))}return Xn.join("<br>")}(jt,pr,Ar,fr):u.getValue(Qt.text,pr),u.coerceString(h,Zt)}(er,Fe,$e,Nt,qt);vt=function(Gt,jt){var pr=u.getValue(Gt.textposition,jt);return u.coerceEnumerated(d,pr)}(ir,$e);var We=tt.mode==="stack"||tt.mode==="relative",he=Fe[$e],xe=!We||he._outmost;if(!Ue||vt==="none"||(he.isBlank||ot===pt||_t===yt)&&(vt==="auto"||vt==="inside"))return void Be.select("text").remove();var De=er.font,qe=i.getBarColor(Fe[$e],ir),Xe=i.getInsideTextFont(ir,$e,De,qe),He=i.getOutsideTextFont(ir,$e,De),st=Be.datum();Ht?Nt.type==="log"&&st.s0<=0&&(ot=Nt.range[0]<Nt.range[1]?0:Nt._length):qt.type==="log"&&st.s0<=0&&(_t=qt.range[0]<qt.range[1]?qt._length:0);var it,Tt,Pt,rt,ut,Ft=Math.abs(pt-ot)-2*x,wt=Math.abs(yt-_t)-2*x;if(vt==="outside"&&(xe||he.hasB||(vt="inside")),vt==="auto")if(xe){vt="inside",ut=b.ensureUniformFontSize(Pe,Xe),it=Jt(Be,Ue,ut),Tt=n.bBox(it.node()),Pt=Tt.width,rt=Tt.height;var Lt=Pt<=Ft&&rt<=wt,Ae=Pt<=wt&&rt<=Ft,Ye=Ht?Ft>=Pt*(wt/rt):wt>=rt*(Ft/Pt);Pt>0&&rt>0&&(Lt||Ae||Ye)?vt="inside":(vt="outside",it.remove(),it=null)}else vt="inside";if(!it){ut=b.ensureUniformFontSize(Pe,vt==="outside"?He:Xe);var nt=(it=Jt(Be,Ue,ut)).attr("transform");if(it.attr("transform",""),Tt=n.bBox(it.node()),Pt=Tt.width,rt=Tt.height,it.attr("transform",nt),Pt<=0||rt<=0)return void it.remove()}var ft,Mt,Rt=ir.textangle;vt==="outside"?(Mt=ir.constraintext==="both"||ir.constraintext==="outside",ft=function(Gt,jt,pr,Ar,fr,Zt){var Qt,$t=!!Zt.isHorizontal,hr=!!Zt.constrained,vr=Zt.angle||0,Mr=fr.width,Nr=fr.height,Ur=Math.abs(jt-Gt),Jr=Math.abs(Ar-pr);Qt=$t?Jr>2*x?x:0:Ur>2*x?x:0;var mn=1;hr&&(mn=$t?Math.min(1,Jr/Nr):Math.min(1,Ur/Mr));var en=L(vr),In=A(fr,en),vn=($t?In.x:In.y)/2,gn=(fr.left+fr.right)/2,Sn=(fr.top+fr.bottom)/2,Xn=(Gt+jt)/2,Br=(pr+Ar)/2,pn=0,on=0,Yr=$t?_(jt,Gt):_(pr,Ar);return $t?(Xn=jt-Yr*Qt,pn=Yr*vn):(Br=Ar+Yr*Qt,on=-Yr*vn),{textX:gn,textY:Sn,targetX:Xn,targetY:Br,anchorX:pn,anchorY:on,scale:mn,rotate:en}}(ot,pt,_t,yt,Tt,{isHorizontal:Ht,constrained:Mt,angle:Rt})):(Mt=ir.constraintext==="both"||ir.constraintext==="inside",ft=I(ot,pt,_t,yt,Tt,{isHorizontal:Ht,constrained:Mt,angle:Rt,anchor:ir.insidetextanchor})),ft.fontSize=ut.size,m(ir.type==="histogram"?"bar":ir.type,ft,er),he.transform=ft,w(it,er,tt,Ke).attr("transform",b.getTextTransform(ft))})(P,S,_e,W,se,Ce,fe,ve,Me,R,H),S.layerClipId&&n.hideOutsideRangePoint(de,_e.select("text"),V,X,N.xcalendar,N.ycalendar)});var oe=N.cliponaxis===!1;n.setClipUrl(te,oe?null:S.layerClipId,P)});t.getComponentMethod("errorbars","plot")(P,G,S,R)},toMoveInsideBar:I}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx/helpers":403,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"./attributes":657,"./constants":659,"./helpers":663,"./style":671,"./uniform_text":673,"@plotly/d3":58,"fast-isnumeric":190}],669:[function(v,J,Z){function p(g,b,y,e,n){var t=b.c2p(e?g.s0:g.p0,!0),a=b.c2p(e?g.s1:g.p1,!0),r=y.c2p(e?g.p0:g.s0,!0),m=y.c2p(e?g.p1:g.s1,!0);return n?[(t+a)/2,(r+m)/2]:e?[a,(r+m)/2]:[(t+a)/2,m]}J.exports=function(g,b){var y,e=g.cd,n=g.xaxis,t=g.yaxis,a=e[0].trace,r=a.type==="funnel",m=a.orientation==="h",o=[];if(b===!1)for(y=0;y<e.length;y++)e[y].selected=0;else for(y=0;y<e.length;y++){var i=e[y],u="ct"in i?i.ct:p(i,n,t,m,r);b.contains(u,!1,y,g)?(o.push({pointNumber:y,x:n.c2d(i.x),y:t.c2d(i.y)}),i.selected=1):i.selected=0}return o}},{}],670:[function(v,J,Z){J.exports=b;var p=v("../../lib").distinctVals,g=v("../../constants/numerical").BADNUM;function b(y,e){this.traces=y,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var n=1/0,t=[],a=0;a<y.length;a++){for(var r=y[a],m=0;m<r.length;m++){var o=r[m];o.p!==g&&t.push(o.p)}r[0]&&r[0].width1&&(n=Math.min(r[0].width1,n))}this.positions=t;var i=p(t);this.distinctPositions=i.vals,i.vals.length===1&&n!==1/0?this.minDiff=n:this.minDiff=Math.min(i.minDiff,n);var u=(e.posAxis||{}).type;u!=="category"&&u!=="multicategory"||(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}b.prototype.put=function(y,e){var n=this.getLabel(y,e),t=this.bins[n]||0;return this.bins[n]=t+e,t},b.prototype.get=function(y,e){var n=this.getLabel(y,e);return this.bins[n]||0},b.prototype.getLabel=function(y,e){return(e<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?y:Math.round(y/this.binWidth))}},{"../../constants/numerical":491,"../../lib":515}],671:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/color"),b=v("../../components/drawing"),y=v("../../lib"),e=v("../../registry"),n=v("./uniform_text").resizeText,t=v("./attributes"),a=t.textfont,r=t.insidetextfont,m=t.outsidetextfont,o=v("./helpers");function i(c,T,_){b.pointStyle(c.selectAll("path"),T,_),u(c,T,_)}function u(c,T,_){c.selectAll("text").each(function(w){var k=p.select(this),L=y.ensureUniformFontSize(_,f(k,w,T,_));b.font(k,L)})}function f(c,T,_,w){var k=w._fullLayout.font,L=_.textfont;if(c.classed("bartext-inside")){var A=x(T,_);L=h(_,T.i,k,A)}else c.classed("bartext-outside")&&(L=d(_,T.i,k));return L}function l(c,T,_){return s(a,c.textfont,T,_)}function h(c,T,_,w){var k=l(c,T,_);return(c._input.textfont===void 0||c._input.textfont.color===void 0||Array.isArray(c.textfont.color)&&c.textfont.color[T]===void 0)&&(k={color:g.contrast(w),family:k.family,size:k.size}),s(r,c.insidetextfont,T,k)}function d(c,T,_){var w=l(c,T,_);return s(m,c.outsidetextfont,T,w)}function s(c,T,_,w){T=T||{};var k=o.getValue(T.family,_),L=o.getValue(T.size,_),A=o.getValue(T.color,_);return{family:o.coerceString(c.family,k,w.family),size:o.coerceNumber(c.size,L,w.size),color:o.coerceColor(c.color,A,w.color)}}function x(c,T){return T.type==="waterfall"?T[c.dir].marker.color:c.mcc||c.mc||T.marker.color}J.exports={style:function(c){var T=p.select(c).selectAll("g.barlayer").selectAll("g.trace");n(c,T,"bar");var _=T.size(),w=c._fullLayout;T.style("opacity",function(k){return k[0].trace.opacity}).each(function(k){(w.barmode==="stack"&&_>1||w.bargap===0&&w.bargroupgap===0&&!k[0].trace.marker.line.width)&&p.select(this).attr("shape-rendering","crispEdges")}),T.selectAll("g.points").each(function(k){i(p.select(this),k[0].trace,c)}),e.getComponentMethod("errorbars","style")(T)},styleTextPoints:u,styleOnSelect:function(c,T,_){var w=T[0].trace;w.selectedpoints?function(k,L,A){b.selectedPointStyle(k.selectAll("path"),L),function(I,P,S){I.each(function(E){var D,R=p.select(this);if(E.selected){D=y.ensureUniformFontSize(S,f(R,E,P,S));var H=P.selected.textfont&&P.selected.textfont.color;H&&(D.color=H),b.font(R,D)}else b.selectedTextStyle(R,P)})}(k.selectAll("text"),L,A)}(_,w,c):(i(_,w,c),e.getComponentMethod("errorbars","style")(_))},getInsideTextFont:h,getOutsideTextFont:d,getBarColor:x,resizeText:n}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../registry":647,"./attributes":657,"./helpers":663,"./uniform_text":673,"@plotly/d3":58}],672:[function(v,J,Z){var p=v("../../components/color"),g=v("../../components/colorscale/helpers").hasColorscale,b=v("../../components/colorscale/defaults"),y=v("../../lib").coercePattern;J.exports=function(e,n,t,a,r){var m=t("marker.color",a),o=g(e,"marker");o&&b(e,n,r,t,{prefix:"marker.",cLetter:"c"}),t("marker.line.color",p.defaultLine),g(e,"marker.line")&&b(e,n,r,t,{prefix:"marker.line.",cLetter:"c"}),t("marker.line.width"),t("marker.opacity"),y(t,"marker.pattern",m,o),t("selected.marker.color"),t("unselected.marker.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],673:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib");function b(y){return"_"+y+"Text_minsize"}J.exports={recordMinTextSize:function(y,e,n){if(n.uniformtext.mode){var t=b(y),a=n.uniformtext.minsize,r=e.scale*e.fontSize;e.hide=r<a,n[t]=n[t]||1/0,e.hide||(n[t]=Math.min(n[t],Math.max(r,a)))}},clearMinTextSize:function(y,e){e[b(y)]=void 0},resizeText:function(y,e,n){var t=y._fullLayout,a=t["_"+n+"Text_minsize"];if(a){var r,m=t.uniformtext.mode==="hide";switch(n){case"funnelarea":case"pie":case"sunburst":r="g.slice";break;case"treemap":case"icicle":r="g.slice, g.pathbar";break;default:r="g.points > g.point"}e.selectAll(r).each(function(o){var i=o.transform;i&&(i.scale=m&&i.hide?0:a/i.fontSize,p.select(this).select("text").attr("transform",g.getTextTransform(i)))})}}}},{"../../lib":515,"@plotly/d3":58}],674:[function(v,J,Z){var p=v("../../plots/template_attributes").hovertemplateAttrs,g=v("../../lib/extend").extendFlat,b=v("../scatterpolar/attributes"),y=v("../bar/attributes");J.exports={r:b.r,theta:b.theta,r0:b.r0,dr:b.dr,theta0:b.theta0,dtheta:b.dtheta,thetaunit:b.thetaunit,base:g({},y.base,{}),offset:g({},y.offset,{}),width:g({},y.width,{}),text:g({},y.text,{}),hovertext:g({},y.hovertext,{}),marker:y.marker,hoverinfo:b.hoverinfo,hovertemplate:p(),selected:y.selected,unselected:y.unselected}},{"../../lib/extend":505,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatterpolar/attributes":1011}],675:[function(v,J,Z){var p=v("../../components/colorscale/helpers").hasColorscale,g=v("../../components/colorscale/calc"),b=v("../bar/arrays_to_calcdata"),y=v("../bar/cross_trace_calc").setGroupPositions,e=v("../scatter/calc_selection"),n=v("../../registry").traceIs,t=v("../../lib").extendFlat;J.exports={calc:function(a,r){for(var m=a._fullLayout,o=r.subplot,i=m[o].radialaxis,u=m[o].angularaxis,f=i.makeCalcdata(r,"r"),l=u.makeCalcdata(r,"theta"),h=r._length,d=new Array(h),s=f,x=l,c=0;c<h;c++)d[c]={p:x[c],s:s[c]};function T(_){var w=r[_];w!==void 0&&(r["_"+_]=Array.isArray(w)?u.makeCalcdata(r,_):u.d2c(w,r.thetaunit))}return u.type==="linear"&&(T("width"),T("offset")),p(r,"marker")&&g(a,r,{vals:r.marker.color,containerStr:"marker",cLetter:"c"}),p(r,"marker.line")&&g(a,r,{vals:r.marker.line.color,containerStr:"marker.line",cLetter:"c"}),b(d,r),e(d,r),d},crossTraceCalc:function(a,r,m){for(var o=a.calcdata,i=[],u=0;u<o.length;u++){var f=o[u],l=f[0].trace;l.visible===!0&&n(l,"bar")&&l.subplot===m&&i.push(f)}var h=t({},r.radialaxis,{_id:"x"}),d=r.angularaxis;y(a,d,h,i,{mode:r.barmode,norm:r.barnorm,gap:r.bargap,groupgap:r.bargroupgap})}}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../lib":515,"../../registry":647,"../bar/arrays_to_calcdata":656,"../bar/cross_trace_calc":660,"../scatter/calc_selection":938}],676:[function(v,J,Z){var p=v("../../lib"),g=v("../scatterpolar/defaults").handleRThetaDefaults,b=v("../bar/style_defaults"),y=v("./attributes");J.exports=function(e,n,t,a){function r(m,o){return p.coerce(e,n,y,m,o)}g(e,n,a,r)?(r("thetaunit"),r("base"),r("offset"),r("width"),r("text"),r("hovertext"),r("hovertemplate"),b(e,n,r,t,a),p.coerceSelectionMarkerOpacity(n,r)):n.visible=!1}},{"../../lib":515,"../bar/style_defaults":672,"../scatterpolar/defaults":1013,"./attributes":674}],677:[function(v,J,Z){var p=v("../../components/fx"),g=v("../../lib"),b=v("../bar/hover").getTraceColor,y=g.fillText,e=v("../scatterpolar/hover").makeHoverPointText,n=v("../../plots/polar/helpers").isPtInsidePolygon;J.exports=function(t,a,r){var m=t.cd,o=m[0].trace,i=t.subplot,u=i.radialAxis,f=i.angularAxis,l=i.vangles,h=l?n:g.isPtInsideSector,d=t.maxHoverDistance,s=f._period||2*Math.PI,x=Math.abs(u.g2p(Math.sqrt(a*a+r*r))),c=Math.atan2(r,a);if(u.range[0]>u.range[1]&&(c+=Math.PI),p.getClosest(m,function(w){return h(x,c,[w.rp0,w.rp1],[w.thetag0,w.thetag1],l)?d+Math.min(1,Math.abs(w.thetag1-w.thetag0)/s)-1+(w.rp1-x)/(w.rp1-w.rp0)-1:1/0},t),t.index!==!1){var T=m[t.index];t.x0=t.x1=T.ct[0],t.y0=t.y1=T.ct[1];var _=g.extendFlat({},T,{r:T.s,theta:T.p});return y(T,o,t),e(_,o,i,t),t.hovertemplate=o.hovertemplate,t.color=b(o,T),t.xLabelVal=t.yLabelVal=void 0,T.s<0&&(t.idealAlign="left"),[t]}}},{"../../components/fx":407,"../../lib":515,"../../plots/polar/helpers":630,"../bar/hover":664,"../scatterpolar/hover":1015}],678:[function(v,J,Z){J.exports={moduleType:"trace",name:"barpolar",basePlotModule:v("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("../scatterpolar/format_labels"),style:v("../bar/style").style,styleOnSelect:v("../bar/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../bar/select"),meta:{}}},{"../../plots/polar":631,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"../scatterpolar/format_labels":1014,"./attributes":674,"./calc":675,"./defaults":676,"./hover":677,"./layout_attributes":679,"./layout_defaults":680,"./plot":681}],679:[function(v,J,Z){J.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],680:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes");J.exports=function(b,y,e){var n,t={};function a(o,i){return p.coerce(b[n]||{},y[n],g,o,i)}for(var r=0;r<e.length;r++){var m=e[r];m.type==="barpolar"&&m.visible===!0&&(t[n=m.subplot]||(a("barmode"),a("bargap"),t[n]=1))}}},{"../../lib":515,"./layout_attributes":679}],681:[function(v,J,Z){var p=v("@plotly/d3"),g=v("fast-isnumeric"),b=v("../../lib"),y=v("../../components/drawing"),e=v("../../plots/polar/helpers");J.exports=function(n,t,a){var r=t.xaxis,m=t.yaxis,o=t.radialAxis,i=t.angularAxis,u=function(l){var h=l.cxx,d=l.cyy;return l.vangles?function(s,x,c,T){var _,w;b.angleDelta(c,T)>0?(_=c,w=T):(_=T,w=c);var k=[e.findEnclosingVertexAngles(_,l.vangles)[0],(_+w)/2,e.findEnclosingVertexAngles(w,l.vangles)[1]];return e.pathPolygonAnnulus(s,x,_,w,k,h,d)}:function(s,x,c,T){return b.pathAnnulus(s,x,c,T,h,d)}}(t),f=t.layers.frontplot.select("g.barlayer");b.makeTraceGroups(f,a,"trace bars").each(function(){var l=p.select(this),h=b.ensureSingle(l,"g","points").selectAll("g.point").data(b.identity);h.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),h.exit().remove(),h.each(function(d){var s,x=p.select(this),c=d.rp0=o.c2p(d.s0),T=d.rp1=o.c2p(d.s1),_=d.thetag0=i.c2g(d.p0),w=d.thetag1=i.c2g(d.p1);if(g(c)&&g(T)&&g(_)&&g(w)&&c!==T&&_!==w){var k=o.c2g(d.s1),L=(_+w)/2;d.ct=[r.c2p(k*Math.cos(L)),m.c2p(k*Math.sin(L))],s=u(c,T,_,w)}else s="M0,0Z";b.ensureSingle(x,"path").attr("d",s)}),y.setClipUrl(l,t._hasClipOnAxisFalse?t.clipIds.forTraces:null,n)})}},{"../../components/drawing":389,"../../lib":515,"../../plots/polar/helpers":630,"@plotly/d3":58,"fast-isnumeric":190}],682:[function(v,J,Z){var p=v("../scatter/attributes"),g=v("../bar/attributes"),b=v("../../components/color/attributes"),y=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../plots/template_attributes").hovertemplateAttrs,n=v("../../lib/extend").extendFlat,t=p.marker,a=t.line;J.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:p.xperiod,yperiod:p.yperiod,xperiod0:p.xperiod0,yperiod0:p.yperiod0,xperiodalignment:p.xperiodalignment,yperiodalignment:p.yperiodalignment,xhoverformat:y("x"),yhoverformat:y("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:n({},t.symbol,{arrayOk:!1,editType:"plot"}),opacity:n({},t.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:n({},t.size,{arrayOk:!1,editType:"calc"}),color:n({},t.color,{arrayOk:!1,editType:"style"}),line:{color:n({},a.color,{arrayOk:!1,dflt:b.defaultLine,editType:"style"}),width:n({},a.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:p.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup,selected:{marker:p.selected.marker,editType:"style"},unselected:{marker:p.unselected.marker,editType:"style"},text:n({},p.text,{}),hovertext:n({},p.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936}],683:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../plots/cartesian/axes"),b=v("../../plots/cartesian/align_period"),y=v("../../lib"),e=v("../../constants/numerical").BADNUM,n=y._;J.exports=function(h,d){var s,x,c,T,_,w,k,L=h._fullLayout,A=g.getFromId(h,d.xaxis||"x"),I=g.getFromId(h,d.yaxis||"y"),P=[],S=d.type==="violin"?"_numViolins":"_numBoxes";d.orientation==="h"?(c=A,T="x",_=I,w="y",k=!!d.yperiodalignment):(c=I,T="y",_=A,w="x",k=!!d.xperiodalignment);var E,D,R,H,V,X,$=function(Be,Fe,$e,ot){var pt,_t=Fe+"0"in Be,yt="d"+Fe in Be;if(Fe in Be||_t&&yt){var tt=$e.makeCalcdata(Be,Fe);return[b(Be,$e,Fe,tt).vals,tt]}pt=_t?Be[Fe+"0"]:"name"in Be&&($e.type==="category"||p(Be.name)&&["linear","log"].indexOf($e.type)!==-1||y.isDateTime(Be.name)&&$e.type==="date")?Be.name:ot;for(var Ke=$e.type==="multicategory"?$e.r2c_just_indices(pt):$e.d2c(pt,0,Be[Fe+"calendar"]),vt=Be._length,Nt=new Array(vt),qt=0;qt<vt;qt++)Nt[qt]=Ke;return[Nt]}(d,w,_,L[S]),G=$[0],W=$[1],te=y.distinctVals(G,_),N=te.vals,B=te.minDiff/2,U=(d.boxpoints||d.points)==="all"?y.identity:function(Be){return Be.v<E.lf||Be.v>E.uf};if(d._hasPreCompStats){var ee=d[T],j=function(Be){return c.d2c((d[Be]||[])[s])},Q=1/0,K=-1/0;for(s=0;s<d._length;s++){var re=G[s];if(p(re)){if((E={}).pos=E[w]=re,k&&W&&(E.orig_p=W[s]),E.q1=j("q1"),E.med=j("median"),E.q3=j("q3"),D=[],ee&&y.isArrayOrTypedArray(ee[s]))for(x=0;x<ee[s].length;x++)(X=c.d2c(ee[s][x]))!==e&&(a(V={v:X,i:[s,x]},d,[s,x]),D.push(V));if(E.pts=D.sort(r),H=(R=E[T]=D.map(m)).length,E.med!==e&&E.q1!==e&&E.q3!==e&&E.med>=E.q1&&E.q3>=E.med){var ne=j("lowerfence");E.lf=ne!==e&&ne<=E.q1?ne:o(E,R,H);var le=j("upperfence");E.uf=le!==e&&le>=E.q3?le:i(E,R,H);var oe=j("mean");E.mean=oe!==e?oe:H?y.mean(R,H):(E.q1+E.q3)/2;var de=j("sd");E.sd=oe!==e&&de>=0?de:H?y.stdev(R,H,E.mean):E.q3-E.q1,E.lo=u(E),E.uo=f(E);var se=j("notchspan");se=se!==e&&se>0?se:l(E,H),E.ln=E.med-se,E.un=E.med+se;var me=E.lf,Te=E.uf;d.boxpoints&&R.length&&(me=Math.min(me,R[0]),Te=Math.max(Te,R[H-1])),d.notched&&(me=Math.min(me,E.ln),Te=Math.max(Te,E.un)),E.min=me,E.max=Te}else{var _e;y.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+E.q1,"median = "+E.med,"q3 = "+E.q3].join(`
`)),_e=E.med!==e?E.med:E.q1!==e?E.q3!==e?(E.q1+E.q3)/2:E.q1:E.q3!==e?E.q3:0,E.med=_e,E.q1=E.q3=_e,E.lf=E.uf=_e,E.mean=E.sd=_e,E.ln=E.un=_e,E.min=E.max=_e}Q=Math.min(Q,E.min),K=Math.max(K,E.max),E.pts2=D.filter(U),P.push(E)}}d._extremes[c._id]=g.findExtremes(c,[Q,K],{padded:!0})}else{var be=c.makeCalcdata(d,T),Ce=function(Be,Fe){for(var $e=Be.length,ot=new Array($e+1),pt=0;pt<$e;pt++)ot[pt]=Be[pt]-Fe;return ot[$e]=Be[$e-1]+Fe,ot}(N,B),fe=N.length,ve=function(Be){for(var Fe=new Array(Be),$e=0;$e<Be;$e++)Fe[$e]=[];return Fe}(fe);for(s=0;s<d._length;s++)if(X=be[s],p(X)){var Me=y.findBin(G[s],Ce);Me>=0&&Me<fe&&(a(V={v:X,i:s},d,s),ve[Me].push(V))}var ke=1/0,Le=-1/0,ze=d.quartilemethod,Re=ze==="exclusive",Oe=ze==="inclusive";for(s=0;s<fe;s++)if(ve[s].length>0){var Ze,Pe;(E={}).pos=E[w]=N[s],D=E.pts=ve[s].sort(r),H=(R=E[T]=D.map(m)).length,E.min=R[0],E.max=R[H-1],E.mean=y.mean(R,H),E.sd=y.stdev(R,H,E.mean),E.med=y.interp(R,.5),H%2&&(Re||Oe)?(Re?(Ze=R.slice(0,H/2),Pe=R.slice(H/2+1)):Oe&&(Ze=R.slice(0,H/2+1),Pe=R.slice(H/2)),E.q1=y.interp(Ze,.5),E.q3=y.interp(Pe,.5)):(E.q1=y.interp(R,.25),E.q3=y.interp(R,.75)),E.lf=o(E,R,H),E.uf=i(E,R,H),E.lo=u(E),E.uo=f(E);var Ie=l(E,H);E.ln=E.med-Ie,E.un=E.med+Ie,ke=Math.min(ke,E.ln),Le=Math.max(Le,E.un),E.pts2=D.filter(U),P.push(E)}d._extremes[c._id]=g.findExtremes(c,d.notched?be.concat([ke,Le]):be,{padded:!0})}return function(Be,Fe){if(y.isArrayOrTypedArray(Fe.selectedpoints))for(var $e=0;$e<Be.length;$e++){for(var ot=Be[$e].pts||[],pt={},_t=0;_t<ot.length;_t++)pt[ot[_t].i]=_t;y.tagSelected(ot,Fe,pt)}}(P,d),P.length>0?(P[0].t={num:L[S],dPos:B,posLetter:w,valLetter:T,labels:{med:n(h,"median:"),min:n(h,"min:"),q1:n(h,"q1:"),q3:n(h,"q3:"),max:n(h,"max:"),mean:d.boxmean==="sd"?n(h,"mean \xB1 \u03C3:"):n(h,"mean:"),lf:n(h,"lower fence:"),uf:n(h,"upper fence:")}},L[S]++,P):[{t:{empty:!0}}]};var t={text:"tx",hovertext:"htx"};function a(h,d,s){for(var x in t)y.isArrayOrTypedArray(d[x])&&(Array.isArray(s)?y.isArrayOrTypedArray(d[x][s[0]])&&(h[t[x]]=d[x][s[0]][s[1]]):h[t[x]]=d[x][s])}function r(h,d){return h.v-d.v}function m(h){return h.v}function o(h,d,s){return s===0?h.q1:Math.min(h.q1,d[Math.min(y.findBin(2.5*h.q1-1.5*h.q3,d,!0)+1,s-1)])}function i(h,d,s){return s===0?h.q3:Math.max(h.q3,d[Math.max(y.findBin(2.5*h.q3-1.5*h.q1,d),0)])}function u(h){return 4*h.q1-3*h.q3}function f(h){return 4*h.q3-3*h.q1}function l(h,d){return d===0?0:1.57*(h.q3-h.q1)/Math.sqrt(d)}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"fast-isnumeric":190}],684:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("../../lib"),b=v("../../plots/cartesian/constraints").getAxisGroup,y=["v","h"];function e(n,t,a,r){var m,o,i,u=t.calcdata,f=t._fullLayout,l=r._id,h=l.charAt(0),d=[],s=0;for(m=0;m<a.length;m++)for(i=u[a[m]],o=0;o<i.length;o++)d.push(r.c2l(i[o].pos,!0)),s+=(i[o].pts2||[]).length;if(d.length){var x=g.distinctVals(d);r.type!=="category"&&r.type!=="multicategory"||(x.minDiff=1);var c=x.minDiff/2;p.minDtick(r,x.minDiff,x.vals[0],!0);var T=f[n==="violin"?"_numViolins":"_numBoxes"],_=f[n+"mode"]==="group"&&T>1,w=1-f[n+"gap"],k=1-f[n+"groupgap"];for(m=0;m<a.length;m++){var L,A,I,P,S,E,D=(i=u[a[m]])[0].trace,R=i[0].t,H=D.width,V=D.side;if(H)L=A=P=H/2,I=0;else if(L=c,_){var X=b(f,r._id)+D.orientation,$=(f._alignmentOpts[X]||{})[D.alignmentgroup]||{},G=Object.keys($.offsetGroups||{}).length,W=G||T;A=L*w*k/W,I=2*L*(((G?D._offsetIndex:R.num)+.5)/W-.5)*w,P=L*w/W}else A=L*w*k,I=0,P=L;R.dPos=L,R.bPos=I,R.bdPos=A,R.wHover=P;var te,N,B,U,ee,j,Q=I+A,K=Boolean(H);if(V==="positive"?(S=L*(H?1:.5),te=Q,E=te=I):V==="negative"?(S=te=I,E=L*(H?1:.5),N=Q):(S=E=L,te=N=Q),(D.boxpoints||D.points)&&s>0){var re=D.pointpos,ne=D.jitter,le=D.marker.size/2,oe=0;re+ne>=0&&((oe=Q*(re+ne))>S?(K=!0,ee=le,B=oe):oe>te&&(ee=le,B=S)),oe<=S&&(B=S);var de=0;re-ne<=0&&((de=-Q*(re-ne))>E?(K=!0,j=le,U=de):de>N&&(j=le,U=E)),de<=E&&(U=E)}else B=S,U=E;var se=new Array(i.length);for(o=0;o<i.length;o++)se[o]=i[o].pos;D._extremes[l]=p.findExtremes(r,se,{padded:K,vpadminus:U,vpadplus:B,vpadLinearized:!0,ppadminus:{x:j,y:ee}[h],ppadplus:{x:ee,y:j}[h]})}}}J.exports={crossTraceCalc:function(n,t){for(var a=n.calcdata,r=t.xaxis,m=t.yaxis,o=0;o<y.length;o++){for(var i=y[o],u=i==="h"?m:r,f=[],l=0;l<a.length;l++){var h=a[l],d=h[0].t,s=h[0].trace;s.visible!==!0||s.type!=="box"&&s.type!=="candlestick"||d.empty||(s.orientation||"v")!==i||s.xaxis!==r._id||s.yaxis!==m._id||f.push(l)}e("box",n,f,u)}},setPositionOffset:e}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574}],685:[function(v,J,Z){var p=v("../../lib"),g=v("../../registry"),b=v("../../components/color"),y=v("../scatter/period_defaults"),e=v("../bar/defaults").handleGroupingDefaults,n=v("../../plots/cartesian/axis_autotype"),t=v("./attributes");function a(m,o,i,u){function f(V){var X=0;return V&&V.length&&(X+=1,p.isArrayOrTypedArray(V[0])&&V[0].length&&(X+=1)),X}function l(V){return p.validate(m[V],t[V])}var h,d=i("y"),s=i("x");if(o.type==="box"){var x=i("q1"),c=i("median"),T=i("q3");o._hasPreCompStats=x&&x.length&&c&&c.length&&T&&T.length,h=Math.min(p.minRowLength(x),p.minRowLength(c),p.minRowLength(T))}var _,w,k=f(d),L=f(s),A=k&&p.minRowLength(d),I=L&&p.minRowLength(s),P=u.calendar,S={autotypenumbers:u.autotypenumbers};if(o._hasPreCompStats)switch(String(L)+String(k)){case"00":var E=l("x0")||l("dx");_=(l("y0")||l("dy"))&&!E?"h":"v",w=h;break;case"10":_="v",w=Math.min(h,I);break;case"20":_="h",w=Math.min(h,s.length);break;case"01":_="h",w=Math.min(h,A);break;case"02":_="v",w=Math.min(h,d.length);break;case"12":_="v",w=Math.min(h,I,d.length);break;case"21":_="h",w=Math.min(h,s.length,A);break;case"11":w=0;break;case"22":var D,R=!1;for(D=0;D<s.length;D++)if(n(s[D],P,S)==="category"){R=!0;break}if(R)_="v",w=Math.min(h,I,d.length);else{for(D=0;D<d.length;D++)if(n(d[D],P,S)==="category"){R=!0;break}R?(_="h",w=Math.min(h,s.length,A)):(_="v",w=Math.min(h,I,d.length))}}else k>0?(_="v",w=L>0?Math.min(I,A):Math.min(A)):L>0?(_="h",w=Math.min(I)):w=0;if(w){o._length=w;var H=i("orientation",_);o._hasPreCompStats?H==="v"&&L===0?(i("x0",0),i("dx",1)):H==="h"&&k===0&&(i("y0",0),i("dy",1)):H==="v"&&L===0?i("x0"):H==="h"&&k===0&&i("y0"),g.getComponentMethod("calendars","handleTraceDefaults")(m,o,["x","y"],u)}else o.visible=!1}function r(m,o,i,u){var f=u.prefix,l=p.coerce2(m,o,t,"marker.outliercolor"),h=i("marker.line.outliercolor"),d="outliers";o._hasPreCompStats?d="all":(l||h)&&(d="suspectedoutliers");var s=i(f+"points",d);s?(i("jitter",s==="all"?.3:0),i("pointpos",s==="all"?-1.5:0),i("marker.symbol"),i("marker.opacity"),i("marker.size"),i("marker.color",o.line.color),i("marker.line.color"),i("marker.line.width"),s==="suspectedoutliers"&&(i("marker.line.outliercolor",o.marker.color),i("marker.line.outlierwidth")),i("selected.marker.color"),i("unselected.marker.color"),i("selected.marker.size"),i("unselected.marker.size"),i("text"),i("hovertext")):delete o.marker;var x=i("hoveron");x!=="all"&&x.indexOf("points")===-1||i("hovertemplate"),p.coerceSelectionMarkerOpacity(o,i)}J.exports={supplyDefaults:function(m,o,i,u){function f(T,_){return p.coerce(m,o,t,T,_)}if(a(m,o,f,u),o.visible!==!1){y(m,o,u,f),f("xhoverformat"),f("yhoverformat");var l=o._hasPreCompStats;l&&(f("lowerfence"),f("upperfence")),f("line.color",(m.marker||{}).color||i),f("line.width"),f("fillcolor",b.addOpacity(o.line.color,.5));var h=!1;if(l){var d=f("mean"),s=f("sd");d&&d.length&&(h=!0,s&&s.length&&(h="sd"))}f("boxmean",h),f("whiskerwidth"),f("width"),f("quartilemethod");var x=!1;if(l){var c=f("notchspan");c&&c.length&&(x=!0)}else p.validate(m.notchwidth,t.notchwidth)&&(x=!0);f("notched",x)&&f("notchwidth"),r(m,o,f,{prefix:"box"})}},crossTraceDefaults:function(m,o){var i,u;function f(d){return p.coerce(u._input,u,t,d)}for(var l=0;l<m.length;l++){var h=(u=m[l]).type;h!=="box"&&h!=="violin"||(i=u._input,o[h+"mode"]==="group"&&e(i,u,o,f))}},handleSampleDefaults:a,handlePointsDefaults:r}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../registry":647,"../bar/defaults":661,"../scatter/period_defaults":956,"./attributes":682}],686:[function(v,J,Z){J.exports=function(p,g){return g.hoverOnBox&&(p.hoverOnBox=g.hoverOnBox),"xVal"in g&&(p.x=g.xVal),"yVal"in g&&(p.y=g.yVal),g.xa&&(p.xaxis=g.xa),g.ya&&(p.yaxis=g.ya),p}},{}],687:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("../../lib"),b=v("../../components/fx"),y=v("../../components/color"),e=g.fillText;function n(a,r,m,o){var i,u,f,l,h,d,s,x,c,T,_,w,k,L,A=a.cd,I=a.xa,P=a.ya,S=A[0].trace,E=A[0].t,D=S.type==="violin",R=E.bdPos,H=E.wHover,V=function(_e){return f.c2l(_e.pos)+E.bPos-f.c2l(d)};D&&S.side!=="both"?(S.side==="positive"&&(c=function(_e){var be=V(_e);return b.inbox(be,be+H,T)},w=R,k=0),S.side==="negative"&&(c=function(_e){var be=V(_e);return b.inbox(be-H,be,T)},w=0,k=R)):(c=function(_e){var be=V(_e);return b.inbox(be-H,be+H,T)},w=k=R),L=D?function(_e){return b.inbox(_e.span[0]-h,_e.span[1]-h,T)}:function(_e){return b.inbox(_e.min-h,_e.max-h,T)},S.orientation==="h"?(h=r,d=m,s=L,x=c,i="y",f=P,u="x",l=I):(h=m,d=r,s=c,x=L,i="x",f=I,u="y",l=P);var X=Math.min(1,R/Math.abs(f.r2c(f.range[1])-f.r2c(f.range[0])));function $(_e){return(s(_e)+x(_e))/2}T=a.maxHoverDistance-X,_=a.maxSpikeDistance-X;var G=b.getDistanceFunction(o,s,x,$);if(b.getClosest(A,G,a),a.index===!1)return[];var W=A[a.index],te=S.line.color,N=(S.marker||{}).color;y.opacity(te)&&S.line.width?a.color=te:y.opacity(N)&&S.boxpoints?a.color=N:a.color=S.fillcolor,a[i+"0"]=f.c2p(W.pos+E.bPos-k,!0),a[i+"1"]=f.c2p(W.pos+E.bPos+w,!0),a[i+"LabelVal"]=W.orig_p!==void 0?W.orig_p:W.pos;var B=i+"Spike";a.spikeDistance=$(W)*_/T,a[B]=f.c2p(W.pos,!0);var U=S.boxmean||(S.meanline||{}).visible,ee=S.boxpoints||S.points,j=ee&&U?["max","uf","q3","med","mean","q1","lf","min"]:ee&&!U?["max","uf","q3","med","q1","lf","min"]:!ee&&U?["max","q3","med","mean","q1","min"]:["max","q3","med","q1","min"],Q=l.range[1]<l.range[0];S.orientation===(Q?"v":"h")&&j.reverse();for(var K=a.spikeDistance,re=a[B],ne=[],le=0;le<j.length;le++){var oe=j[le];if(oe in W){var de=W[oe],se=l.c2p(de,!0),me=g.extendFlat({},a);me.attr=oe,me[u+"0"]=me[u+"1"]=se,me[u+"LabelVal"]=de,me[u+"Label"]=(E.labels?E.labels[oe]+" ":"")+p.hoverLabelText(l,de,S[u+"hoverformat"]),me.hoverOnBox=!0,oe==="mean"&&"sd"in W&&S.boxmean==="sd"&&(me[u+"err"]=W.sd),me.hovertemplate=!1,ne.push(me)}}a.name="",a.spikeDistance=void 0,a[B]=void 0;for(var Te=0;Te<ne.length;Te++)ne[Te].attr!=="med"?(ne[Te].name="",ne[Te].spikeDistance=void 0,ne[Te][B]=void 0):(ne[Te].spikeDistance=K,ne[Te][B]=re);return ne}function t(a,r,m){for(var o,i,u,f=a.cd,l=a.xa,h=a.ya,d=f[0].trace,s=l.c2p(r),x=h.c2p(m),c=b.quadrature(function(D){var R=Math.max(3,D.mrc||0);return Math.max(Math.abs(l.c2p(D.x)-s)-R,1-3/R)},function(D){var R=Math.max(3,D.mrc||0);return Math.max(Math.abs(h.c2p(D.y)-x)-R,1-3/R)}),T=!1,_=0;_<f.length;_++){i=f[_];for(var w=0;w<(i.pts||[]).length;w++){var k=c(u=i.pts[w]);k<=a.distance&&(a.distance=k,T=[_,w])}}if(!T)return!1;u=(i=f[T[0]]).pts[T[1]];var L=l.c2p(u.x,!0),A=h.c2p(u.y,!0),I=u.mrc||1;o=g.extendFlat({},a,{index:u.i,color:(d.marker||{}).color,name:d.name,x0:L-I,x1:L+I,y0:A-I,y1:A+I,spikeDistance:a.distance,hovertemplate:d.hovertemplate});var P,S=i.orig_p,E=S!==void 0?S:i.pos;return d.orientation==="h"?(P=h,o.xLabelVal=u.x,o.yLabelVal=E):(P=l,o.xLabelVal=E,o.yLabelVal=u.y),o[P._id.charAt(0)+"Spike"]=P.c2p(i.pos,!0),e(u,d,o),o}J.exports={hoverPoints:function(a,r,m,o){var i,u=a.cd[0].trace.hoveron,f=[];return u.indexOf("boxes")!==-1&&(f=f.concat(n(a,r,m,o))),u.indexOf("points")!==-1&&(i=t(a,r,m)),o==="closest"?i?[i]:f:(i&&f.push(i),f)},hoverOnBoxes:n,hoverOnPoints:t}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],688:[function(v,J,Z){J.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults").supplyLayoutDefaults,calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc").crossTraceCalc,plot:v("./plot").plot,style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"box",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./attributes":682,"./calc":683,"./cross_trace_calc":684,"./defaults":685,"./event_data":686,"./hover":687,"./layout_attributes":689,"./layout_defaults":690,"./plot":691,"./select":692,"./style":693}],689:[function(v,J,Z){J.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],690:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib"),b=v("./layout_attributes");function y(e,n,t,a,r){for(var m=r+"Layout",o=!1,i=0;i<t.length;i++){var u=t[i];if(p.traceIs(u,m)){o=!0;break}}o&&(a(r+"mode"),a(r+"gap"),a(r+"groupgap"))}J.exports={supplyLayoutDefaults:function(e,n,t){y(0,0,t,function(a,r){return g.coerce(e,n,b,a,r)},"box")},_supply:y}},{"../../lib":515,"../../registry":647,"./layout_attributes":689}],691:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../components/drawing");function y(t,a,r,m){var o,i,u=r.orientation==="h",f=a.val,l=a.pos,h=!!l.rangebreaks,d=m.bPos,s=m.wdPos||0,x=m.bPosPxOffset||0,c=r.whiskerwidth||0,T=r.notched||!1,_=T?1-2*r.notchwidth:1;Array.isArray(m.bdPos)?(o=m.bdPos[0],i=m.bdPos[1]):(o=m.bdPos,i=m.bdPos);var w=t.selectAll("path.box").data(r.type!=="violin"||r.box.visible?g.identity:[]);w.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),w.exit().remove(),w.each(function(k){if(k.empty)return"M0,0Z";var L=l.c2l(k.pos+d,!0),A=l.l2p(L-o)+x,I=l.l2p(L+i)+x,P=h?(A+I)/2:l.l2p(L)+x,S=r.whiskerwidth,E=h?A*S+(1-S)*P:l.l2p(L-s)+x,D=h?I*S+(1-S)*P:l.l2p(L+s)+x,R=l.l2p(L-o*_)+x,H=l.l2p(L+i*_)+x,V=f.c2p(k.q1,!0),X=f.c2p(k.q3,!0),$=g.constrain(f.c2p(k.med,!0),Math.min(V,X)+1,Math.max(V,X)-1),G=k.lf===void 0||r.boxpoints===!1,W=f.c2p(G?k.min:k.lf,!0),te=f.c2p(G?k.max:k.uf,!0),N=f.c2p(k.ln,!0),B=f.c2p(k.un,!0);u?p.select(this).attr("d","M"+$+","+R+"V"+H+"M"+V+","+A+"V"+I+(T?"H"+N+"L"+$+","+H+"L"+B+","+I:"")+"H"+X+"V"+A+(T?"H"+B+"L"+$+","+R+"L"+N+","+A:"")+"ZM"+V+","+P+"H"+W+"M"+X+","+P+"H"+te+(c===0?"":"M"+W+","+E+"V"+D+"M"+te+","+E+"V"+D)):p.select(this).attr("d","M"+R+","+$+"H"+H+"M"+A+","+V+"H"+I+(T?"V"+N+"L"+H+","+$+"L"+I+","+B:"")+"V"+X+"H"+A+(T?"V"+B+"L"+R+","+$+"L"+A+","+N:"")+"ZM"+P+","+V+"V"+W+"M"+P+","+X+"V"+te+(c===0?"":"M"+E+","+W+"H"+D+"M"+E+","+te+"H"+D))})}function e(t,a,r,m){var o=a.x,i=a.y,u=m.bdPos,f=m.bPos,l=r.boxpoints||r.points;g.seedPseudoRandom();var h=t.selectAll("g.points").data(l?function(s){return s.forEach(function(x){x.t=m,x.trace=r}),s}:[]);h.enter().append("g").attr("class","points"),h.exit().remove();var d=h.selectAll("path").data(function(s){var x,c,T=s.pts2,_=Math.max((s.max-s.min)/10,s.q3-s.q1),w=1e-9*_,k=.01*_,L=[],A=0;if(r.jitter){if(_===0)for(A=1,L=new Array(T.length),x=0;x<T.length;x++)L[x]=1;else for(x=0;x<T.length;x++){var I=Math.max(0,x-5),P=T[I].v,S=Math.min(T.length-1,x+5),E=T[S].v;l!=="all"&&(T[x].v<s.lf?E=Math.min(E,s.lf):P=Math.max(P,s.uf));var D=Math.sqrt(k*(S-I)/(E-P+w))||0;D=g.constrain(Math.abs(D),0,1),L.push(D),A=Math.max(D,A)}c=2*r.jitter/(A||1)}for(x=0;x<T.length;x++){var R=T[x],H=R.v,V=r.jitter?c*L[x]*(g.pseudoRandom()-.5):0,X=s.pos+f+u*(r.pointpos+V);r.orientation==="h"?(R.y=X,R.x=H):(R.x=X,R.y=H),l==="suspectedoutliers"&&H<s.uo&&H>s.lo&&(R.so=!0)}return T});d.enter().append("path").classed("point",!0),d.exit().remove(),d.call(b.translatePoints,o,i)}function n(t,a,r,m){var o,i,u=a.val,f=a.pos,l=!!f.rangebreaks,h=m.bPos,d=m.bPosPxOffset||0,s=r.boxmean||(r.meanline||{}).visible;Array.isArray(m.bdPos)?(o=m.bdPos[0],i=m.bdPos[1]):(o=m.bdPos,i=m.bdPos);var x=t.selectAll("path.mean").data(r.type==="box"&&r.boxmean||r.type==="violin"&&r.box.visible&&r.meanline.visible?g.identity:[]);x.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),x.exit().remove(),x.each(function(c){var T=f.c2l(c.pos+h,!0),_=f.l2p(T-o)+d,w=f.l2p(T+i)+d,k=l?(_+w)/2:f.l2p(T)+d,L=u.c2p(c.mean,!0),A=u.c2p(c.mean-c.sd,!0),I=u.c2p(c.mean+c.sd,!0);r.orientation==="h"?p.select(this).attr("d","M"+L+","+_+"V"+w+(s==="sd"?"m0,0L"+A+","+k+"L"+L+","+_+"L"+I+","+k+"Z":"")):p.select(this).attr("d","M"+_+","+L+"H"+w+(s==="sd"?"m0,0L"+k+","+A+"L"+_+","+L+"L"+k+","+I+"Z":""))})}J.exports={plot:function(t,a,r,m){var o=a.xaxis,i=a.yaxis;g.makeTraceGroups(m,r,"trace boxes").each(function(u){var f,l,h=p.select(this),d=u[0],s=d.t,x=d.trace;s.wdPos=s.bdPos*x.whiskerwidth,x.visible!==!0||s.empty?h.remove():(x.orientation==="h"?(f=i,l=o):(f=o,l=i),y(h,{pos:f,val:l},x,s),e(h,{x:o,y:i},x,s),n(h,{pos:f,val:l},x,s))})},plotBoxAndWhiskers:y,plotPoints:e,plotBoxMean:n}},{"../../components/drawing":389,"../../lib":515,"@plotly/d3":58}],692:[function(v,J,Z){J.exports=function(p,g){var b,y,e=p.cd,n=p.xaxis,t=p.yaxis,a=[];if(g===!1)for(b=0;b<e.length;b++)for(y=0;y<(e[b].pts||[]).length;y++)e[b].pts[y].selected=0;else for(b=0;b<e.length;b++)for(y=0;y<(e[b].pts||[]).length;y++){var r=e[b].pts[y],m=n.c2p(r.x),o=t.c2p(r.y);g.contains([m,o],null,r.i,p)?(a.push({pointNumber:r.i,x:n.c2d(r.x),y:t.c2d(r.y)}),r.selected=1):r.selected=0}return a}},{}],693:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/color"),b=v("../../components/drawing");J.exports={style:function(y,e,n){var t=n||p.select(y).selectAll("g.trace.boxes");t.style("opacity",function(a){return a[0].trace.opacity}),t.each(function(a){var r=p.select(this),m=a[0].trace,o=m.line.width;function i(l,h,d,s){l.style("stroke-width",h+"px").call(g.stroke,d).call(g.fill,s)}var u=r.selectAll("path.box");if(m.type==="candlestick")u.each(function(l){if(!l.empty){var h=p.select(this),d=m[l.dir];i(h,d.line.width,d.line.color,d.fillcolor),h.style("opacity",m.selectedpoints&&!l.selected?.3:1)}});else{i(u,o,m.line.color,m.fillcolor),r.selectAll("path.mean").style({"stroke-width":o,"stroke-dasharray":2*o+"px,"+o+"px"}).call(g.stroke,m.line.color);var f=r.selectAll("path.point");b.pointStyle(f,m,y)}})},styleOnSelect:function(y,e,n){var t=e[0].trace,a=n.selectAll("path.point");t.selectedpoints?b.selectedPointStyle(a,t):b.pointStyle(a,t,y)}}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],694:[function(v,J,Z){var p=v("../../lib").extendFlat,g=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,b=v("../ohlc/attributes"),y=v("../box/attributes");function e(n){return{line:{color:p({},y.line.color,{dflt:n}),width:y.line.width,editType:"style"},fillcolor:y.fillcolor,editType:"style"}}J.exports={xperiod:b.xperiod,xperiod0:b.xperiod0,xperiodalignment:b.xperiodalignment,xhoverformat:g("x"),yhoverformat:g("y"),x:b.x,open:b.open,high:b.high,low:b.low,close:b.close,line:{width:p({},y.line.width,{}),editType:"style"},increasing:e(b.increasing.line.color.dflt),decreasing:e(b.decreasing.line.color.dflt),text:b.text,hovertext:b.hovertext,whiskerwidth:p({},y.whiskerwidth,{dflt:0}),hoverlabel:b.hoverlabel}},{"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682,"../ohlc/attributes":881}],695:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes"),b=v("../../plots/cartesian/align_period"),y=v("../ohlc/calc").calcCommon;function e(n,t,a,r){return{min:a,q1:Math.min(n,r),med:r,q3:Math.max(n,r),max:t}}J.exports=function(n,t){var a=n._fullLayout,r=g.getFromId(n,t.xaxis),m=g.getFromId(n,t.yaxis),o=r.makeCalcdata(t,"x"),i=b(t,r,"x",o).vals,u=y(n,t,o,i,m,e);return u.length?(p.extendFlat(u[0].t,{num:a._numBoxes,dPos:p.distinctVals(i).minDiff/2,posLetter:"x",valLetter:"y"}),a._numBoxes++,u):[{t:{empty:!0}}]}},{"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../ohlc/calc":882}],696:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/color"),b=v("../ohlc/ohlc_defaults"),y=v("../scatter/period_defaults"),e=v("./attributes");function n(t,a,r,m){var o=r(m+".line.color");r(m+".line.width",a.line.width),r(m+".fillcolor",g.addOpacity(o,.5))}J.exports=function(t,a,r,m){function o(i,u){return p.coerce(t,a,e,i,u)}b(t,a,o,m)?(y(t,a,m,o,{x:!0}),o("xhoverformat"),o("yhoverformat"),o("line.width"),n(t,a,o,"increasing"),n(t,a,o,"decreasing"),o("text"),o("hovertext"),o("whiskerwidth"),m._requestRangeslider[a.xaxis]=!0):a.visible=!1}},{"../../components/color":367,"../../lib":515,"../ohlc/ohlc_defaults":886,"../scatter/period_defaults":956,"./attributes":694}],697:[function(v,J,Z){J.exports={moduleType:"trace",name:"candlestick",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:v("./attributes"),layoutAttributes:v("../box/layout_attributes"),supplyLayoutDefaults:v("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:v("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("../box/plot").plot,layerName:"boxlayer",style:v("../box/style").style,hoverPoints:v("../ohlc/hover").hoverPoints,selectPoints:v("../ohlc/select")}},{"../../plots/cartesian":578,"../box/cross_trace_calc":684,"../box/layout_attributes":689,"../box/layout_defaults":690,"../box/plot":691,"../box/style":693,"../ohlc/hover":884,"../ohlc/select":888,"./attributes":694,"./calc":695,"./defaults":696}],698:[function(v,J,Z){var p=v("./axis_defaults"),g=v("../../plot_api/plot_template");J.exports=function(b,y,e,n,t){n("a")||(n("da"),n("a0")),n("b")||(n("db"),n("b0")),function(a,r,m,o){["aaxis","baxis"].forEach(function(i){var u=i.charAt(0),f=a[i]||{},l=g.newContainer(r,i),h={noTicklabelstep:!0,tickfont:"x",id:u+"axis",letter:u,font:r.font,name:i,data:a[u],calendar:r.calendar,dfltColor:o,bgColor:m.paper_bgcolor,autotypenumbersDflt:m.autotypenumbers,fullLayout:m};p(f,l,h),l._categories=l._categories||[],a[i]||f.type==="-"||(a[i]={type:f.type})})}(b,y,e,t)}},{"../../plot_api/plot_template":555,"./axis_defaults":703}],699:[function(v,J,Z){var p=v("../../lib").isArrayOrTypedArray;J.exports=function(g){return function b(y,e){if(!p(y)||e>=10)return null;for(var n=1/0,t=-1/0,a=y.length,r=0;r<a;r++){var m=y[r];if(p(m)){var o=b(m,e+1);o&&(n=Math.min(o[0],n),t=Math.max(o[1],t))}else n=Math.min(m,n),t=Math.max(m,t)}return[n,t]}(g,0)}},{"../../lib":515}],700:[function(v,J,Z){var p=v("../../plots/font_attributes"),g=v("./axis_attributes"),b=v("../../components/color/attributes"),y=p({editType:"calc"});y.family.dflt='"Open Sans", verdana, arial, sans-serif',y.size.dflt=12,y.color.dflt=b.defaultLine,J.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:g,baxis:g,font:y,color:{valType:"color",dflt:b.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":366,"../../plots/font_attributes":594,"./axis_attributes":702}],701:[function(v,J,Z){var p=v("../../lib").isArrayOrTypedArray;J.exports=function(g,b,y,e){var n,t,a,r,m,o,i,u,f,l,h,d,s,x=p(y)?"a":"b",c=(x==="a"?g.aaxis:g.baxis).smoothing,T=x==="a"?g.a2i:g.b2j,_=x==="a"?y:e,w=x==="a"?e:y,k=x==="a"?b.a.length:b.b.length,L=x==="a"?b.b.length:b.a.length,A=Math.floor(x==="a"?g.b2j(w):g.a2i(w)),I=x==="a"?function(te){return g.evalxy([],te,A)}:function(te){return g.evalxy([],A,te)};c&&(a=Math.max(0,Math.min(L-2,A)),r=A-a,t=x==="a"?function(te,N){return g.dxydi([],te,a,N,r)}:function(te,N){return g.dxydj([],a,te,r,N)});var P=T(_[0]),S=T(_[1]),E=P<S?1:-1,D=1e-8*(S-P),R=E>0?Math.floor:Math.ceil,H=E>0?Math.ceil:Math.floor,V=E>0?Math.min:Math.max,X=E>0?Math.max:Math.min,$=R(P+D),G=H(S-D),W=[[i=I(P)]];for(n=$;n*E<G*E;n+=E)m=[],h=X(P,n),s=(d=V(S,n+E))-h,o=Math.max(0,Math.min(k-2,Math.floor(.5*(h+d)))),u=I(d),c&&(f=t(o,h-o),l=t(o,d-o),m.push([i[0]+f[0]/3*s,i[1]+f[1]/3*s]),m.push([u[0]-l[0]/3*s,u[1]-l[1]/3*s])),m.push(u),W.push(m),i=u;return W}},{"../../lib":515}],702:[function(v,J,Z){var p=v("../../plots/font_attributes"),g=v("../../components/color/attributes"),b=v("../../plots/cartesian/layout_attributes"),y=v("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=v("../../plot_api/edit_types").overrideAll,n=v("../../components/drawing/attributes").dash,t=v("../../lib/extend").extendFlat;J.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:p({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:b.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:p({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:y("tick label")},tickformatstops:e(b.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:g.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},griddash:t({},n,{editType:"calc"}),showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgriddash:t({},n,{editType:"calc"}),minorgridcolor:{valType:"color",dflt:g.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:p({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],703:[function(v,J,Z){var p=v("./attributes"),g=v("../../components/color").addOpacity,b=v("../../registry"),y=v("../../lib"),e=v("../../plots/cartesian/tick_value_defaults"),n=v("../../plots/cartesian/tick_label_defaults"),t=v("../../plots/cartesian/prefix_suffix_defaults"),a=v("../../plots/cartesian/category_order_defaults"),r=v("../../plots/cartesian/set_convert"),m=v("../../plots/cartesian/axis_autotype");J.exports=function(o,i,u){var f=u.letter,l=u.font||{},h=p[f+"axis"];function d(E,D){return y.coerce(o,i,h,E,D)}function s(E,D){return y.coerce2(o,i,h,E,D)}u.name&&(i._name=u.name,i._id=u.name),d("autotypenumbers",u.autotypenumbersDflt);var x=d("type");x==="-"&&(u.data&&function(E,D){if(E.type==="-"){var R=E._id.charAt(0),H=E[R+"calendar"];E.type=m(D,H,{autotypenumbers:E.autotypenumbers})}}(i,u.data),i.type==="-"?i.type="linear":x=o.type=i.type),d("smoothing"),d("cheatertype"),d("showticklabels"),d("labelprefix",f+" = "),d("labelsuffix"),d("showtickprefix"),d("showticksuffix"),d("separatethousands"),d("tickformat"),d("exponentformat"),d("minexponent"),d("showexponent"),d("categoryorder"),d("tickmode"),d("tickvals"),d("ticktext"),d("tick0"),d("dtick"),i.tickmode==="array"&&(d("arraytick0"),d("arraydtick")),d("labelpadding"),i._hovertitle=f,x==="date"&&b.getComponentMethod("calendars","handleDefaults")(o,i,"calendar",u.calendar),r(i,u.fullLayout),i.c2p=y.identity;var c=d("color",u.dfltColor),T=c===o.color?c:l.color;d("title.text")&&(y.coerceFont(d,"title.font",{family:l.family,size:y.bigFont(l.size),color:T}),d("title.offset")),d("tickangle"),d("autorange",!i.isValidRange(o.range))&&d("rangemode"),d("range"),i.cleanRange(),d("fixedrange"),e(o,i,d,x),t(o,i,d,x,u),n(o,i,d,x,u),a(o,i,d,{data:u.data,dataAttr:f});var _=s("gridcolor",g(c,.3)),w=s("gridwidth"),k=s("griddash"),L=d("showgrid");L||(delete i.gridcolor,delete i.gridwidth,delete i.griddash);var A=s("startlinecolor",c),I=s("startlinewidth",w);d("startline",i.showgrid||!!A||!!I)||(delete i.startlinecolor,delete i.startlinewidth);var P=s("endlinecolor",c),S=s("endlinewidth",w);return d("endline",i.showgrid||!!P||!!S)||(delete i.endlinecolor,delete i.endlinewidth),L?(d("minorgridcount"),d("minorgridwidth",w),d("minorgriddash",k),d("minorgridcolor",g(_,.06)),i.minorgridcount||(delete i.minorgridwidth,delete i.minorgriddash,delete i.minorgridcolor)):(delete i.gridcolor,delete i.gridwidth,delete i.griddash),i.showticklabels==="none"&&(delete i.tickfont,delete i.tickangle,delete i.showexponent,delete i.exponentformat,delete i.minexponent,delete i.tickformat,delete i.showticksuffix,delete i.showtickprefix),i.showticksuffix||delete i.ticksuffix,i.showtickprefix||delete i.tickprefix,d("tickmode"),i}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../plots/cartesian/category_order_defaults":571,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/set_convert":585,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_value_defaults":589,"../../registry":647,"./attributes":700}],704:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("../../lib").isArray1D,b=v("./cheater_basis"),y=v("./array_minmax"),e=v("./calc_gridlines"),n=v("./calc_labels"),t=v("./calc_clippath"),a=v("../heatmap/clean_2d_array"),r=v("./smooth_fill_2d_array"),m=v("../heatmap/convert_column_xyz"),o=v("./set_convert");J.exports=function(i,u){var f=p.getFromId(i,u.xaxis),l=p.getFromId(i,u.yaxis),h=u.aaxis,d=u.baxis,s=u.x,x=u.y,c=[];s&&g(s)&&c.push("x"),x&&g(x)&&c.push("y"),c.length&&m(u,h,d,"a","b",c);var T=u._a=u._a||u.a,_=u._b=u._b||u.b;s=u._x||u.x,x=u._y||u.y;var w={};if(u._cheater){var k=h.cheatertype==="index"?T.length:T,L=d.cheatertype==="index"?_.length:_;s=b(k,L,u.cheaterslope)}u._x=s=a(s),u._y=x=a(x),r(s,T,_),r(x,T,_),o(u),u.setScale();var A=y(s),I=y(x),P=.5*(A[1]-A[0]),S=.5*(A[1]+A[0]),E=.5*(I[1]-I[0]),D=.5*(I[1]+I[0]);return A=[S-1.3*P,S+1.3*P],I=[D-1.3*E,D+1.3*E],u._extremes[f._id]=p.findExtremes(f,A,{padded:!0}),u._extremes[l._id]=p.findExtremes(l,I,{padded:!0}),e(u,"a","b"),e(u,"b","a"),n(u,h),n(u,d),w.clipsegments=t(u._xctrl,u._yctrl,h,d),w.x=s,w.y=x,w.a=T,w.b=_,[w]}},{"../../lib":515,"../../plots/cartesian/axes":566,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"./array_minmax":699,"./calc_clippath":705,"./calc_gridlines":706,"./calc_labels":707,"./cheater_basis":709,"./set_convert":722,"./smooth_fill_2d_array":723}],705:[function(v,J,Z){J.exports=function(p,g,b,y){var e,n,t,a=[],r=!!b.smoothing,m=!!y.smoothing,o=p[0].length-1,i=p.length-1;for(e=0,n=[],t=[];e<=o;e++)n[e]=p[0][e],t[e]=g[0][e];for(a.push({x:n,y:t,bicubic:r}),e=0,n=[],t=[];e<=i;e++)n[e]=p[e][o],t[e]=g[e][o];for(a.push({x:n,y:t,bicubic:m}),e=o,n=[],t=[];e>=0;e--)n[o-e]=p[i][e],t[o-e]=g[i][e];for(a.push({x:n,y:t,bicubic:r}),e=i,n=[],t=[];e>=0;e--)n[i-e]=p[e][0],t[i-e]=g[e][0];return a.push({x:n,y:t,bicubic:m}),a}},{}],706:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("../../lib/extend").extendFlat;J.exports=function(b,y,e){var n,t,a,r,m,o,i,u,f,l,h,d,s,x,c=b["_"+y],T=b[y+"axis"],_=T._gridlines=[],w=T._minorgridlines=[],k=T._boundarylines=[],L=b["_"+e],A=b[e+"axis"];T.tickmode==="array"&&(T.tickvals=c.slice());var I=b._xctrl,P=b._yctrl,S=I[0].length,E=I.length,D=b._a.length,R=b._b.length;p.prepTicks(T),T.tickmode==="array"&&delete T.tickvals;var H=T.smoothing?3:1;function V($){var G,W,te,N,B,U,ee,j,Q,K,re,ne,le=[],oe=[],de={};if(y==="b")for(W=b.b2j($),te=Math.floor(Math.max(0,Math.min(R-2,W))),N=W-te,de.length=R,de.crossLength=D,de.xy=function(se){return b.evalxy([],se,W)},de.dxy=function(se,me){return b.dxydi([],se,te,me,N)},G=0;G<D;G++)U=Math.min(D-2,G),ee=G-U,j=b.evalxy([],G,W),A.smoothing&&G>0&&(Q=b.dxydi([],G-1,te,0,N),le.push(B[0]+Q[0]/3),oe.push(B[1]+Q[1]/3),K=b.dxydi([],G-1,te,1,N),le.push(j[0]-K[0]/3),oe.push(j[1]-K[1]/3)),le.push(j[0]),oe.push(j[1]),B=j;else for(G=b.a2i($),U=Math.floor(Math.max(0,Math.min(D-2,G))),ee=G-U,de.length=D,de.crossLength=R,de.xy=function(se){return b.evalxy([],G,se)},de.dxy=function(se,me){return b.dxydj([],U,se,ee,me)},W=0;W<R;W++)te=Math.min(R-2,W),N=W-te,j=b.evalxy([],G,W),A.smoothing&&W>0&&(re=b.dxydj([],U,W-1,ee,0),le.push(B[0]+re[0]/3),oe.push(B[1]+re[1]/3),ne=b.dxydj([],U,W-1,ee,1),le.push(j[0]-ne[0]/3),oe.push(j[1]-ne[1]/3)),le.push(j[0]),oe.push(j[1]),B=j;return de.axisLetter=y,de.axis=T,de.crossAxis=A,de.value=$,de.constvar=e,de.index=u,de.x=le,de.y=oe,de.smoothing=A.smoothing,de}function X($){var G,W,te,N,B,U=[],ee=[],j={};if(j.length=c.length,j.crossLength=L.length,y==="b")for(te=Math.max(0,Math.min(R-2,$)),B=Math.min(1,Math.max(0,$-te)),j.xy=function(Q){return b.evalxy([],Q,$)},j.dxy=function(Q,K){return b.dxydi([],Q,te,K,B)},G=0;G<S;G++)U[G]=I[$*H][G],ee[G]=P[$*H][G];else for(W=Math.max(0,Math.min(D-2,$)),N=Math.min(1,Math.max(0,$-W)),j.xy=function(Q){return b.evalxy([],$,Q)},j.dxy=function(Q,K){return b.dxydj([],W,Q,N,K)},G=0;G<E;G++)U[G]=I[G][$*H],ee[G]=P[G][$*H];return j.axisLetter=y,j.axis=T,j.crossAxis=A,j.value=c[$],j.constvar=e,j.index=$,j.x=U,j.y=ee,j.smoothing=A.smoothing,j}if(T.tickmode==="array"){for(r=5e-15,o=(m=[Math.floor((c.length-1-T.arraytick0)/T.arraydtick*(1+r)),Math.ceil(-T.arraytick0/T.arraydtick/(1+r))].sort(function($,G){return $-G}))[0]-1,i=m[1]+1,u=o;u<i;u++)(t=T.arraytick0+T.arraydtick*u)<0||t>c.length-1||_.push(g(X(t),{color:T.gridcolor,width:T.gridwidth,dash:T.griddash}));for(u=o;u<i;u++)if(a=T.arraytick0+T.arraydtick*u,h=Math.min(a+T.arraydtick,c.length-1),!(a<0||a>c.length-1||h<0||h>c.length-1))for(d=c[a],s=c[h],n=0;n<T.minorgridcount;n++)(x=h-a)<=0||(l=d+(s-d)*(n+1)/(T.minorgridcount+1)*(T.arraydtick/x))<c[0]||l>c[c.length-1]||w.push(g(V(l),{color:T.minorgridcolor,width:T.minorgridwidth,dash:T.minorgriddash}));T.startline&&k.push(g(X(0),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&k.push(g(X(c.length-1),{color:T.endlinecolor,width:T.endlinewidth}))}else{for(r=5e-15,o=(m=[Math.floor((c[c.length-1]-T.tick0)/T.dtick*(1+r)),Math.ceil((c[0]-T.tick0)/T.dtick/(1+r))].sort(function($,G){return $-G}))[0],i=m[1],u=o;u<=i;u++)f=T.tick0+T.dtick*u,_.push(g(V(f),{color:T.gridcolor,width:T.gridwidth,dash:T.griddash}));for(u=o-1;u<i+1;u++)for(f=T.tick0+T.dtick*u,n=0;n<T.minorgridcount;n++)(l=f+T.dtick*(n+1)/(T.minorgridcount+1))<c[0]||l>c[c.length-1]||w.push(g(V(l),{color:T.minorgridcolor,width:T.minorgridwidth,dash:T.minorgriddash}));T.startline&&k.push(g(V(c[0]),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&k.push(g(V(c[c.length-1]),{color:T.endlinecolor,width:T.endlinewidth}))}}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],707:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("../../lib/extend").extendFlat;J.exports=function(b,y){var e,n,t,a=y._labels=[],r=y._gridlines;for(e=0;e<r.length;e++)t=r[e],["start","both"].indexOf(y.showticklabels)!==-1&&(n=p.tickText(y,t.value),g(n,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:t.xy(0),dxy:t.dxy(0,0),axis:t.axis,length:t.crossAxis.length,font:t.axis.tickfont,isFirst:e===0,isLast:e===r.length-1}),a.push(n)),["end","both"].indexOf(y.showticklabels)!==-1&&(n=p.tickText(y,t.value),g(n,{endAnchor:!1,xy:t.xy(t.crossLength-1),dxy:t.dxy(t.crossLength-2,1),axis:t.axis,length:t.crossAxis.length,font:t.axis.tickfont,isFirst:e===0,isLast:e===r.length-1}),a.push(n))}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],708:[function(v,J,Z){J.exports=function(p,g,b,y){var e=p[0]-g[0],n=p[1]-g[1],t=b[0]-g[0],a=b[1]-g[1],r=Math.pow(e*e+n*n,.25),m=Math.pow(t*t+a*a,.25),o=(m*m*e-r*r*t)*y,i=(m*m*n-r*r*a)*y,u=m*(r+m)*3,f=r*(r+m)*3;return[[g[0]+(u&&o/u),g[1]+(u&&i/u)],[g[0]-(f&&o/f),g[1]-(f&&i/f)]]}},{}],709:[function(v,J,Z){var p=v("../../lib").isArrayOrTypedArray;J.exports=function(g,b,y){var e,n,t,a,r,m,o=[],i=p(g)?g.length:g,u=p(b)?b.length:b,f=p(g)?g:null,l=p(b)?b:null;f&&(t=(f.length-1)/(f[f.length-1]-f[0])/(i-1)),l&&(a=(l.length-1)/(l[l.length-1]-l[0])/(u-1));var h=1/0,d=-1/0;for(n=0;n<u;n++)for(o[n]=[],r=l?(l[n]-l[0])*a:n/(u-1),e=0;e<i;e++)m=(f?(f[e]-f[0])*t:e/(i-1))-r*y,h=Math.min(m,h),d=Math.max(m,d),o[n][e]=m;var s=1/(d-h),x=-h*s;for(n=0;n<u;n++)for(e=0;e<i;e++)o[n][e]=s*o[n][e]+x;return o}},{"../../lib":515}],710:[function(v,J,Z){var p=v("./catmull_rom"),g=v("../../lib").ensureArray;function b(y,e,n){var t=-.5*n[0]+1.5*e[0],a=-.5*n[1]+1.5*e[1];return[(2*t+y[0])/3,(2*a+y[1])/3]}J.exports=function(y,e,n,t,a,r){var m,o,i,u,f,l,h,d,s,x,c=n[0].length,T=n.length,_=a?3*c-2:c,w=r?3*T-2:T;for(y=g(y,w),e=g(e,w),i=0;i<w;i++)y[i]=g(y[i],_),e[i]=g(e[i],_);for(o=0,u=0;o<T;o++,u+=r?3:1)for(f=y[u],l=e[u],h=n[o],d=t[o],m=0,i=0;m<c;m++,i+=a?3:1)f[i]=h[m],l[i]=d[m];if(a)for(o=0,u=0;o<T;o++,u+=r?3:1){for(m=1,i=3;m<c-1;m++,i+=3)s=p([n[o][m-1],t[o][m-1]],[n[o][m],t[o][m]],[n[o][m+1],t[o][m+1]],a),y[u][i-1]=s[0][0],e[u][i-1]=s[0][1],y[u][i+1]=s[1][0],e[u][i+1]=s[1][1];x=b([y[u][0],e[u][0]],[y[u][2],e[u][2]],[y[u][3],e[u][3]]),y[u][1]=x[0],e[u][1]=x[1],x=b([y[u][_-1],e[u][_-1]],[y[u][_-3],e[u][_-3]],[y[u][_-4],e[u][_-4]]),y[u][_-2]=x[0],e[u][_-2]=x[1]}if(r)for(i=0;i<_;i++){for(u=3;u<w-3;u+=3)s=p([y[u-3][i],e[u-3][i]],[y[u][i],e[u][i]],[y[u+3][i],e[u+3][i]],r),y[u-1][i]=s[0][0],e[u-1][i]=s[0][1],y[u+1][i]=s[1][0],e[u+1][i]=s[1][1];x=b([y[0][i],e[0][i]],[y[2][i],e[2][i]],[y[3][i],e[3][i]]),y[1][i]=x[0],e[1][i]=x[1],x=b([y[w-1][i],e[w-1][i]],[y[w-3][i],e[w-3][i]],[y[w-4][i],e[w-4][i]]),y[w-2][i]=x[0],e[w-2][i]=x[1]}if(a&&r)for(u=1;u<w;u+=(u+1)%3==0?2:1){for(i=3;i<_-3;i+=3)s=p([y[u][i-3],e[u][i-3]],[y[u][i],e[u][i]],[y[u][i+3],e[u][i+3]],a),y[u][i-1]=.5*(y[u][i-1]+s[0][0]),e[u][i-1]=.5*(e[u][i-1]+s[0][1]),y[u][i+1]=.5*(y[u][i+1]+s[1][0]),e[u][i+1]=.5*(e[u][i+1]+s[1][1]);x=b([y[u][0],e[u][0]],[y[u][2],e[u][2]],[y[u][3],e[u][3]]),y[u][1]=.5*(y[u][1]+x[0]),e[u][1]=.5*(e[u][1]+x[1]),x=b([y[u][_-1],e[u][_-1]],[y[u][_-3],e[u][_-3]],[y[u][_-4],e[u][_-4]]),y[u][_-2]=.5*(y[u][_-2]+x[0]),e[u][_-2]=.5*(e[u][_-2]+x[1])}return[y,e]}},{"../../lib":515,"./catmull_rom":708}],711:[function(v,J,Z){J.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],712:[function(v,J,Z){J.exports=function(p,g,b){return g&&b?function(y,e,n,t,a){var r,m,o,i,u,f;y||(y=[]),e*=3,n*=3;var l=t*t,h=1-t,d=h*h,s=h*t*2,x=-3*d,c=3*(d-s),T=3*(s-l),_=3*l,w=a*a,k=w*a,L=1-a,A=L*L,I=A*L;for(f=0;f<p.length;f++)r=x*(u=p[f])[n][e]+c*u[n][e+1]+T*u[n][e+2]+_*u[n][e+3],m=x*u[n+1][e]+c*u[n+1][e+1]+T*u[n+1][e+2]+_*u[n+1][e+3],o=x*u[n+2][e]+c*u[n+2][e+1]+T*u[n+2][e+2]+_*u[n+2][e+3],i=x*u[n+3][e]+c*u[n+3][e+1]+T*u[n+3][e+2]+_*u[n+3][e+3],y[f]=I*r+3*(A*a*m+L*w*o)+k*i;return y}:g?function(y,e,n,t,a){var r,m,o,i;y||(y=[]),e*=3;var u=t*t,f=1-t,l=f*f,h=f*t*2,d=-3*l,s=3*(l-h),x=3*(h-u),c=3*u,T=1-a;for(o=0;o<p.length;o++)r=d*(i=p[o])[n][e]+s*i[n][e+1]+x*i[n][e+2]+c*i[n][e+3],m=d*i[n+1][e]+s*i[n+1][e+1]+x*i[n+1][e+2]+c*i[n+1][e+3],y[o]=T*r+a*m;return y}:b?function(y,e,n,t,a){var r,m,o,i,u,f;y||(y=[]),n*=3;var l=a*a,h=l*a,d=1-a,s=d*d,x=s*d;for(u=0;u<p.length;u++)r=(f=p[u])[n][e+1]-f[n][e],m=f[n+1][e+1]-f[n+1][e],o=f[n+2][e+1]-f[n+2][e],i=f[n+3][e+1]-f[n+3][e],y[u]=x*r+3*(s*a*m+d*l*o)+h*i;return y}:function(y,e,n,t,a){var r,m,o,i;y||(y=[]);var u=1-a;for(o=0;o<p.length;o++)r=(i=p[o])[n][e+1]-i[n][e],m=i[n+1][e+1]-i[n+1][e],y[o]=u*r+a*m;return y}}},{}],713:[function(v,J,Z){J.exports=function(p,g,b){return g&&b?function(y,e,n,t,a){var r,m,o,i,u,f;y||(y=[]),e*=3,n*=3;var l=t*t,h=l*t,d=1-t,s=d*d,x=s*d,c=a*a,T=1-a,_=T*T,w=T*a*2,k=-3*_,L=3*(_-w),A=3*(w-c),I=3*c;for(f=0;f<p.length;f++)r=k*(u=p[f])[n][e]+L*u[n+1][e]+A*u[n+2][e]+I*u[n+3][e],m=k*u[n][e+1]+L*u[n+1][e+1]+A*u[n+2][e+1]+I*u[n+3][e+1],o=k*u[n][e+2]+L*u[n+1][e+2]+A*u[n+2][e+2]+I*u[n+3][e+2],i=k*u[n][e+3]+L*u[n+1][e+3]+A*u[n+2][e+3]+I*u[n+3][e+3],y[f]=x*r+3*(s*t*m+d*l*o)+h*i;return y}:g?function(y,e,n,t,a){var r,m,o,i,u,f;y||(y=[]),e*=3;var l=a*a,h=l*a,d=1-a,s=d*d,x=s*d;for(u=0;u<p.length;u++)r=(f=p[u])[n+1][e]-f[n][e],m=f[n+1][e+1]-f[n][e+1],o=f[n+1][e+2]-f[n][e+2],i=f[n+1][e+3]-f[n][e+3],y[u]=x*r+3*(s*a*m+d*l*o)+h*i;return y}:b?function(y,e,n,t,a){var r,m,o,i;y||(y=[]),n*=3;var u=1-t,f=a*a,l=1-a,h=l*l,d=l*a*2,s=-3*h,x=3*(h-d),c=3*(d-f),T=3*f;for(o=0;o<p.length;o++)r=s*(i=p[o])[n][e]+x*i[n+1][e]+c*i[n+2][e]+T*i[n+3][e],m=s*i[n][e+1]+x*i[n+1][e+1]+c*i[n+2][e+1]+T*i[n+3][e+1],y[o]=u*r+t*m;return y}:function(y,e,n,t,a){var r,m,o,i;y||(y=[]);var u=1-t;for(o=0;o<p.length;o++)r=(i=p[o])[n+1][e]-i[n][e],m=i[n+1][e+1]-i[n][e+1],y[o]=u*r+t*m;return y}}},{}],714:[function(v,J,Z){J.exports=function(p,g,b,y,e){var n=g-2,t=b-2;return y&&e?function(a,r,m){var o,i,u,f,l,h;a||(a=[]);var d=Math.max(0,Math.min(Math.floor(r),n)),s=Math.max(0,Math.min(Math.floor(m),t)),x=Math.max(0,Math.min(1,r-d)),c=Math.max(0,Math.min(1,m-s));d*=3,s*=3;var T=x*x,_=T*x,w=1-x,k=w*w,L=k*w,A=c*c,I=A*c,P=1-c,S=P*P,E=S*P;for(h=0;h<p.length;h++)o=L*(l=p[h])[s][d]+3*(k*x*l[s][d+1]+w*T*l[s][d+2])+_*l[s][d+3],i=L*l[s+1][d]+3*(k*x*l[s+1][d+1]+w*T*l[s+1][d+2])+_*l[s+1][d+3],u=L*l[s+2][d]+3*(k*x*l[s+2][d+1]+w*T*l[s+2][d+2])+_*l[s+2][d+3],f=L*l[s+3][d]+3*(k*x*l[s+3][d+1]+w*T*l[s+3][d+2])+_*l[s+3][d+3],a[h]=E*o+3*(S*c*i+P*A*u)+I*f;return a}:y?function(a,r,m){a||(a=[]);var o,i,u,f,l,h,d=Math.max(0,Math.min(Math.floor(r),n)),s=Math.max(0,Math.min(Math.floor(m),t)),x=Math.max(0,Math.min(1,r-d)),c=Math.max(0,Math.min(1,m-s));d*=3;var T=x*x,_=T*x,w=1-x,k=w*w,L=k*w,A=1-c;for(l=0;l<p.length;l++)o=A*(h=p[l])[s][d]+c*h[s+1][d],i=A*h[s][d+1]+c*h[s+1][d+1],u=A*h[s][d+2]+c*h[s+1][d+1],f=A*h[s][d+3]+c*h[s+1][d+1],a[l]=L*o+3*(k*x*i+w*T*u)+_*f;return a}:e?function(a,r,m){a||(a=[]);var o,i,u,f,l,h,d=Math.max(0,Math.min(Math.floor(r),n)),s=Math.max(0,Math.min(Math.floor(m),t)),x=Math.max(0,Math.min(1,r-d)),c=Math.max(0,Math.min(1,m-s));s*=3;var T=c*c,_=T*c,w=1-c,k=w*w,L=k*w,A=1-x;for(l=0;l<p.length;l++)o=A*(h=p[l])[s][d]+x*h[s][d+1],i=A*h[s+1][d]+x*h[s+1][d+1],u=A*h[s+2][d]+x*h[s+2][d+1],f=A*h[s+3][d]+x*h[s+3][d+1],a[l]=L*o+3*(k*c*i+w*T*u)+_*f;return a}:function(a,r,m){a||(a=[]);var o,i,u,f,l=Math.max(0,Math.min(Math.floor(r),n)),h=Math.max(0,Math.min(Math.floor(m),t)),d=Math.max(0,Math.min(1,r-l)),s=Math.max(0,Math.min(1,m-h)),x=1-s,c=1-d;for(u=0;u<p.length;u++)o=c*(f=p[u])[h][l]+d*f[h][l+1],i=c*f[h+1][l]+d*f[h+1][l+1],a[u]=x*o+s*i;return a}}},{}],715:[function(v,J,Z){var p=v("../../lib"),g=v("./xy_defaults"),b=v("./ab_defaults"),y=v("./attributes"),e=v("../../components/color/attributes");J.exports=function(n,t,a,r){function m(i,u){return p.coerce(n,t,y,i,u)}t._clipPathId="clip"+t.uid+"carpet";var o=m("color",e.defaultLine);p.coerceFont(m,"font"),m("carpet"),b(n,t,r,m,o),t.a&&t.b?(t.a.length<3&&(t.aaxis.smoothing=0),t.b.length<3&&(t.baxis.smoothing=0),g(n,t,m)||(t.visible=!1),t._cheater&&m("cheaterslope")):t.visible=!1}},{"../../components/color/attributes":366,"../../lib":515,"./ab_defaults":698,"./attributes":700,"./xy_defaults":724}],716:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),plot:v("./plot"),calc:v("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"./attributes":700,"./calc":704,"./defaults":715,"./plot":721}],717:[function(v,J,Z){J.exports=function(p,g){for(var b,y=p._fullData.length,e=0;e<y;e++){var n=p._fullData[e];if(n.index!==g.index&&n.type==="carpet"&&(b||(b=n),n.carpet===g.carpet))return n}return b}},{}],718:[function(v,J,Z){J.exports=function(p,g,b){if(p.length===0)return"";var y,e=[],n=b?3:1;for(y=0;y<p.length;y+=n)e.push(p[y]+","+g[y]),b&&y<p.length-n&&(e.push("C"),e.push([p[y+1]+","+g[y+1],p[y+2]+","+g[y+2]+" "].join(" ")));return e.join(b?"":"L")}},{}],719:[function(v,J,Z){var p=v("../../lib").isArrayOrTypedArray;J.exports=function(g,b,y){var e;for(p(g)?g.length>b.length&&(g=g.slice(0,b.length)):g=[],e=0;e<b.length;e++)g[e]=y(b[e]);return g}},{"../../lib":515}],720:[function(v,J,Z){J.exports=function(p,g,b,y,e,n){var t=e[0]*p.dpdx(g),a=e[1]*p.dpdy(b),r=1,m=1;if(n){var o=Math.sqrt(e[0]*e[0]+e[1]*e[1]),i=Math.sqrt(n[0]*n[0]+n[1]*n[1]),u=(e[0]*n[0]+e[1]*n[1])/o/i;m=Math.max(0,u)}var f=180*Math.atan2(a,t)/Math.PI;return f<-90?(f+=180,r=-r):f>90&&(f-=180,r=-r),{angle:f,flip:r,p:p.c2p(y,g,b),offsetMultplier:m}}},{}],721:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/drawing"),b=v("./map_1d_array"),y=v("./makepath"),e=v("./orient_text"),n=v("../../lib/svg_text_utils"),t=v("../../lib"),a=t.strRotate,r=t.strTranslate,m=v("../../constants/alignment");function o(h,d,s,x,c,T){var _="const-"+c+"-lines",w=s.selectAll("."+_).data(T);w.enter().append("path").classed(_,!0).style("vector-effect","non-scaling-stroke"),w.each(function(k){var L=k,A=L.x,I=L.y,P=b([],A,h.c2p),S=b([],I,d.c2p),E="M"+y(P,S,L.smoothing);p.select(this).attr("d",E).style("stroke-width",L.width).style("stroke",L.color).style("stroke-dasharray",g.dashStyle(L.dash,L.width)).style("fill","none")}),w.exit().remove()}function i(h,d,s,x,c,T,_,w){var k=T.selectAll("text."+w).data(_);k.enter().append("text").classed(w,!0);var L=0,A={};return k.each(function(I,P){var S;if(I.axis.tickangle==="auto")S=e(x,d,s,I.xy,I.dxy);else{var E=(I.axis.tickangle+180)*Math.PI/180;S=e(x,d,s,I.xy,[Math.cos(E),Math.sin(E)])}P||(A={angle:S.angle,flip:S.flip});var D=(I.endAnchor?-1:1)*S.flip,R=p.select(this).attr({"text-anchor":D>0?"start":"end","data-notex":1}).call(g.font,I.font).text(I.text).call(n.convertToTspans,h),H=g.bBox(this);R.attr("transform",r(S.p[0],S.p[1])+a(S.angle)+r(I.axis.labelpadding*D,.3*H.height)),L=Math.max(L,H.width+I.axis.labelpadding)}),k.exit().remove(),A.maxExtent=L,A}J.exports=function(h,d,s,x){var c=d.xaxis,T=d.yaxis,_=h._fullLayout._clips;t.makeTraceGroups(x,s,"trace").each(function(w){var k=p.select(this),L=w[0],A=L.trace,I=A.aaxis,P=A.baxis,S=t.ensureSingle(k,"g","minorlayer"),E=t.ensureSingle(k,"g","majorlayer"),D=t.ensureSingle(k,"g","boundarylayer"),R=t.ensureSingle(k,"g","labellayer");k.style("opacity",A.opacity),o(c,T,E,I,"a",I._gridlines),o(c,T,E,P,"b",P._gridlines),o(c,T,S,I,"a",I._minorgridlines),o(c,T,S,P,"b",P._minorgridlines),o(c,T,D,I,"a-boundary",I._boundarylines),o(c,T,D,P,"b-boundary",P._boundarylines);var H=i(h,c,T,A,L,R,I._labels,"a-label"),V=i(h,c,T,A,L,R,P._labels,"b-label");(function(X,$,G,W,te,N,B,U){var ee,j,Q,K,re=t.aggNums(Math.min,null,G.a),ne=t.aggNums(Math.max,null,G.a),le=t.aggNums(Math.min,null,G.b),oe=t.aggNums(Math.max,null,G.b);ee=.5*(re+ne),j=le,Q=G.ab2xy(ee,j,!0),K=G.dxyda_rough(ee,j),B.angle===void 0&&t.extendFlat(B,e(G,te,N,Q,G.dxydb_rough(ee,j))),l(X,$,G,W,Q,K,G.aaxis,te,N,B,"a-title"),ee=re,j=.5*(le+oe),Q=G.ab2xy(ee,j,!0),K=G.dxydb_rough(ee,j),U.angle===void 0&&t.extendFlat(U,e(G,te,N,Q,G.dxyda_rough(ee,j))),l(X,$,G,W,Q,K,G.baxis,te,N,U,"b-title")})(h,R,A,L,c,T,H,V),function(X,$,G,W,te){var N,B,U,ee,j=G.select("#"+X._clipPathId);j.size()||(j=G.append("clipPath").classed("carpetclip",!0));var Q=t.ensureSingle(j,"path","carpetboundary"),K=$.clipsegments,re=[];for(ee=0;ee<K.length;ee++)N=K[ee],B=b([],N.x,W.c2p),U=b([],N.y,te.c2p),re.push(y(B,U,N.bicubic));var ne="M"+re.join("L")+"Z";j.attr("id",X._clipPathId),Q.attr("d",ne)}(A,L,_,c,T)})};var u=m.LINE_SPACING,f=(1-m.MID_SHIFT)/u+1;function l(h,d,s,x,c,T,_,w,k,L,A){var I=[];_.title.text&&I.push(_.title.text);var P=d.selectAll("text."+A).data(I),S=L.maxExtent;P.enter().append("text").classed(A,!0),P.each(function(){var E=e(s,w,k,c,T);["start","both"].indexOf(_.showticklabels)===-1&&(S=0);var D=_.title.font.size;S+=D+_.title.offset;var R=(L.angle+(L.flip<0?180:0)-E.angle+450)%360,H=R>90&&R<270,V=p.select(this);V.text(_.title.text).call(n.convertToTspans,h),H&&(S=(-n.lineCount(V)+f)*u*D-S),V.attr("transform",r(E.p[0],E.p[1])+a(E.angle)+r(0,S)).attr("text-anchor","middle").call(g.font,_.title.font)}),P.exit().remove()}},{"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"./makepath":718,"./map_1d_array":719,"./orient_text":720,"@plotly/d3":58}],722:[function(v,J,Z){var p=v("./constants"),g=v("../../lib/search").findBin,b=v("./compute_control_points"),y=v("./create_spline_evaluator"),e=v("./create_i_derivative_evaluator"),n=v("./create_j_derivative_evaluator");J.exports=function(t){var a=t._a,r=t._b,m=a.length,o=r.length,i=t.aaxis,u=t.baxis,f=a[0],l=a[m-1],h=r[0],d=r[o-1],s=a[a.length-1]-a[0],x=r[r.length-1]-r[0],c=s*p.RELATIVE_CULL_TOLERANCE,T=x*p.RELATIVE_CULL_TOLERANCE;f-=c,l+=c,h-=T,d+=T,t.isVisible=function(_,w){return _>f&&_<l&&w>h&&w<d},t.isOccluded=function(_,w){return _<f||_>l||w<h||w>d},t.setScale=function(){var _=t._x,w=t._y,k=b(t._xctrl,t._yctrl,_,w,i.smoothing,u.smoothing);t._xctrl=k[0],t._yctrl=k[1],t.evalxy=y([t._xctrl,t._yctrl],m,o,i.smoothing,u.smoothing),t.dxydi=e([t._xctrl,t._yctrl],i.smoothing,u.smoothing),t.dxydj=n([t._xctrl,t._yctrl],i.smoothing,u.smoothing)},t.i2a=function(_){var w=Math.max(0,Math.floor(_[0]),m-2),k=_[0]-w;return(1-k)*a[w]+k*a[w+1]},t.j2b=function(_){var w=Math.max(0,Math.floor(_[1]),m-2),k=_[1]-w;return(1-k)*r[w]+k*r[w+1]},t.ij2ab=function(_){return[t.i2a(_[0]),t.j2b(_[1])]},t.a2i=function(_){var w=Math.max(0,Math.min(g(_,a),m-2)),k=a[w],L=a[w+1];return Math.max(0,Math.min(m-1,w+(_-k)/(L-k)))},t.b2j=function(_){var w=Math.max(0,Math.min(g(_,r),o-2)),k=r[w],L=r[w+1];return Math.max(0,Math.min(o-1,w+(_-k)/(L-k)))},t.ab2ij=function(_){return[t.a2i(_[0]),t.b2j(_[1])]},t.i2c=function(_,w){return t.evalxy([],_,w)},t.ab2xy=function(_,w,k){if(!k&&(_<a[0]||_>a[m-1]|w<r[0]||w>r[o-1]))return[!1,!1];var L=t.a2i(_),A=t.b2j(w),I=t.evalxy([],L,A);if(k){var P,S,E,D,R=0,H=0,V=[];_<a[0]?(P=0,S=0,R=(_-a[0])/(a[1]-a[0])):_>a[m-1]?(P=m-2,S=1,R=(_-a[m-1])/(a[m-1]-a[m-2])):S=L-(P=Math.max(0,Math.min(m-2,Math.floor(L)))),w<r[0]?(E=0,D=0,H=(w-r[0])/(r[1]-r[0])):w>r[o-1]?(E=o-2,D=1,H=(w-r[o-1])/(r[o-1]-r[o-2])):D=A-(E=Math.max(0,Math.min(o-2,Math.floor(A)))),R&&(t.dxydi(V,P,E,S,D),I[0]+=V[0]*R,I[1]+=V[1]*R),H&&(t.dxydj(V,P,E,S,D),I[0]+=V[0]*H,I[1]+=V[1]*H)}return I},t.c2p=function(_,w,k){return[w.c2p(_[0]),k.c2p(_[1])]},t.p2x=function(_,w,k){return[w.p2c(_[0]),k.p2c(_[1])]},t.dadi=function(_){var w=Math.max(0,Math.min(a.length-2,_));return a[w+1]-a[w]},t.dbdj=function(_){var w=Math.max(0,Math.min(r.length-2,_));return r[w+1]-r[w]},t.dxyda=function(_,w,k,L){var A=t.dxydi(null,_,w,k,L),I=t.dadi(_,k);return[A[0]/I,A[1]/I]},t.dxydb=function(_,w,k,L){var A=t.dxydj(null,_,w,k,L),I=t.dbdj(w,L);return[A[0]/I,A[1]/I]},t.dxyda_rough=function(_,w,k){var L=s*(k||.1),A=t.ab2xy(_+L,w,!0),I=t.ab2xy(_-L,w,!0);return[.5*(A[0]-I[0])/L,.5*(A[1]-I[1])/L]},t.dxydb_rough=function(_,w,k){var L=x*(k||.1),A=t.ab2xy(_,w+L,!0),I=t.ab2xy(_,w-L,!0);return[.5*(A[0]-I[0])/L,.5*(A[1]-I[1])/L]},t.dpdx=function(_){return _._m},t.dpdy=function(_){return _._m}}},{"../../lib/search":535,"./compute_control_points":710,"./constants":711,"./create_i_derivative_evaluator":712,"./create_j_derivative_evaluator":713,"./create_spline_evaluator":714}],723:[function(v,J,Z){var p=v("../../lib");J.exports=function(g,b,y){var e,n,t,a=[],r=[],m=g[0].length,o=g.length;function i($,G){var W,te=0,N=0;return $>0&&(W=g[G][$-1])!==void 0&&(N++,te+=W),$<m-1&&(W=g[G][$+1])!==void 0&&(N++,te+=W),G>0&&(W=g[G-1][$])!==void 0&&(N++,te+=W),G<o-1&&(W=g[G+1][$])!==void 0&&(N++,te+=W),te/Math.max(1,N)}var u,f,l,h,d,s,x,c,T,_,w,k=0;for(e=0;e<m;e++)for(n=0;n<o;n++)g[n][e]===void 0&&(a.push(e),r.push(n),g[n][e]=i(e,n)),k=Math.max(k,Math.abs(g[n][e]));if(!a.length)return g;var L=0,A=0,I=a.length;do{for(L=0,t=0;t<I;t++){e=a[t],n=r[t];var P,S,E,D,R,H,V=0,X=0;e===0?(E=b[R=Math.min(m-1,2)],D=b[1],P=g[n][R],X+=(S=g[n][1])+(S-P)*(b[0]-D)/(D-E),V++):e===m-1&&(E=b[R=Math.max(0,m-3)],D=b[m-2],P=g[n][R],X+=(S=g[n][m-2])+(S-P)*(b[m-1]-D)/(D-E),V++),(e===0||e===m-1)&&n>0&&n<o-1&&(u=y[n+1]-y[n],X+=((f=y[n]-y[n-1])*g[n+1][e]+u*g[n-1][e])/(f+u),V++),n===0?(E=y[H=Math.min(o-1,2)],D=y[1],P=g[H][e],X+=(S=g[1][e])+(S-P)*(y[0]-D)/(D-E),V++):n===o-1&&(E=y[H=Math.max(0,o-3)],D=y[o-2],P=g[H][e],X+=(S=g[o-2][e])+(S-P)*(y[o-1]-D)/(D-E),V++),(n===0||n===o-1)&&e>0&&e<m-1&&(u=b[e+1]-b[e],X+=((f=b[e]-b[e-1])*g[n][e+1]+u*g[n][e-1])/(f+u),V++),V?X/=V:(l=b[e+1]-b[e],h=b[e]-b[e-1],c=(d=y[n+1]-y[n])*(s=y[n]-y[n-1])*(d+s),X=((x=l*h*(l+h))*(s*g[n+1][e]+d*g[n-1][e])+c*(h*g[n][e+1]+l*g[n][e-1]))/(c*(h+l)+x*(s+d))),L+=(_=(T=X-g[n][e])/k)*_,w=V?0:.85,g[n][e]+=T*(1+w)}L=Math.sqrt(L)}while(A++<100&&L>1e-5);return p.log("Smoother converged to",L,"after",A,"iterations"),g}},{"../../lib":515}],724:[function(v,J,Z){var p=v("../../lib").isArray1D;J.exports=function(g,b,y){var e=y("x"),n=e&&e.length,t=y("y"),a=t&&t.length;if(!n&&!a)return!1;if(b._cheater=!e,n&&!p(e)||a&&!p(t))b._length=null;else{var r=n?e.length:1/0;a&&(r=Math.min(r,t.length)),b.a&&b.a.length&&(r=Math.min(r,b.a.length)),b.b&&b.b.length&&(r=Math.min(r,b.b.length)),b._length=r}return!0}},{"../../lib":515}],725:[function(v,J,Z){var p=v("../../plots/template_attributes").hovertemplateAttrs,g=v("../scattergeo/attributes"),b=v("../../components/colorscale/attributes"),y=v("../../plots/attributes"),e=v("../../components/color/attributes").defaultLine,n=v("../../lib/extend").extendFlat,t=g.marker.line;J.exports=n({locations:{valType:"data_array",editType:"calc"},locationmode:g.locationmode,z:{valType:"data_array",editType:"calc"},geojson:n({},g.geojson,{}),featureidkey:g.featureidkey,text:n({},g.text,{}),hovertext:n({},g.hovertext,{}),marker:{line:{color:n({},t.color,{dflt:e}),width:n({},t.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:g.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:g.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:n({},y.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:p(),showlegend:n({},y.showlegend,{dflt:!1})},b("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattergeo/attributes":978}],726:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../constants/numerical").BADNUM,b=v("../../components/colorscale/calc"),y=v("../scatter/arrays_to_calcdata"),e=v("../scatter/calc_selection");function n(t){return t&&typeof t=="string"}J.exports=function(t,a){var r,m=a._length,o=new Array(m);r=a.geojson?function(h){return n(h)||p(h)}:n;for(var i=0;i<m;i++){var u=o[i]={},f=a.locations[i],l=a.z[i];r(f)&&p(l)?(u.loc=f,u.z=l):(u.loc=null,u.z=g),u.index=i}return y(o,a),b(t,a,{vals:a.z,containerStr:"",cLetter:"z"}),e(o,a),o}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"fast-isnumeric":190}],727:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/colorscale/defaults"),b=v("./attributes");J.exports=function(y,e,n,t){function a(u,f){return p.coerce(y,e,b,u,f)}var r=a("locations"),m=a("z");if(r&&r.length&&p.isArrayOrTypedArray(m)&&m.length){e._length=Math.min(r.length,m.length);var o,i=a("geojson");(typeof i=="string"&&i!==""||p.isPlainObject(i))&&(o="geojson-id"),a("locationmode",o)==="geojson-id"&&a("featureidkey"),a("text"),a("hovertext"),a("hovertemplate"),a("marker.line.width")&&a("marker.line.color"),a("marker.opacity"),g(y,e,t,a,{prefix:"",cLetter:"z"}),p.coerceSelectionMarkerOpacity(e,a)}else e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":725}],728:[function(v,J,Z){J.exports=function(p,g,b,y,e){p.location=g.location,p.z=g.z;var n=y[e];return n.fIn&&n.fIn.properties&&(p.properties=n.fIn.properties),p.ct=n.ct,p}},{}],729:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("./attributes"),b=v("../../lib").fillText;J.exports=function(y,e,n){var t,a,r,m,o=y.cd,i=o[0].trace,u=y.subplot,f=[e,n],l=[e+360,n];for(a=0;a<o.length;a++)if(m=!1,(t=o[a])._polygons){for(r=0;r<t._polygons.length;r++)t._polygons[r].contains(f)&&(m=!m),t._polygons[r].contains(l)&&(m=!m);if(m)break}if(m&&t)return y.x0=y.x1=y.xa.c2p(t.ct),y.y0=y.y1=y.ya.c2p(t.ct),y.index=t.index,y.location=t.loc,y.z=t.z,y.zLabel=p.tickText(u.mockAxis,u.mockAxis.c2l(t.z),"hover").text,y.hovertemplate=t.hovertemplate,function(h,d,s){if(!d.hovertemplate){var x=s.hi||d.hoverinfo,c=String(s.loc),T=x==="all"?g.hoverinfo.flags:x.split("+"),_=T.indexOf("name")!==-1,w=T.indexOf("location")!==-1,k=T.indexOf("z")!==-1,L=T.indexOf("text")!==-1,A=[];!_&&w?h.nameOverride=c:(_&&(h.nameOverride=d.name),w&&A.push(c)),k&&A.push(h.zLabel),L&&b(s,d,A),h.extraText=A.join("<br>")}}(y,i,t),[y]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./attributes":725}],730:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),calc:v("./calc"),calcGeoJSON:v("./plot").calcGeoJSON,plot:v("./plot").plot,style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"choropleth",basePlotModule:v("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":598,"../heatmap/colorbar":804,"./attributes":725,"./calc":726,"./defaults":727,"./event_data":728,"./hover":729,"./plot":731,"./select":732,"./style":733}],731:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../lib/geo_location_utils"),y=v("../../lib/topojson_utils").getTopojsonFeatures,e=v("../../plots/cartesian/autorange").findExtremes,n=v("./style").style;J.exports={calcGeoJSON:function(t,a){for(var r=t[0].trace,m=a[r.geo],o=m._subplot,i=r.locationmode,u=r._length,f=i==="geojson-id"?b.extractTraceFeature(t):y(r,o.topojson),l=[],h=[],d=0;d<u;d++){var s=t[d],x=i==="geojson-id"?s.fOut:b.locationToFeature(i,s.loc,f);if(x){s.geojson=x,s.ct=x.properties.ct,s._polygons=b.feature2polygons(x);var c=b.computeBbox(x);l.push(c[0],c[2]),h.push(c[1],c[3])}else s.geojson=null}if(m.fitbounds==="geojson"&&i==="geojson-id"){var T=b.computeBbox(b.getTraceGeojson(r));l=[T[0],T[2]],h=[T[1],T[3]]}var _={padded:!0};r._extremes.lon=e(m.lonaxis._ax,l,_),r._extremes.lat=e(m.lataxis._ax,h,_)},plot:function(t,a,r){var m=a.layers.backplot.select(".choroplethlayer");g.makeTraceGroups(m,r,"trace choropleth").each(function(o){var i=p.select(this).selectAll("path.choroplethlocation").data(g.identity);i.enter().append("path").classed("choroplethlocation",!0),i.exit().remove(),n(t,o)})}}},{"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"./style":733,"@plotly/d3":58}],732:[function(v,J,Z){J.exports=function(p,g){var b,y,e,n,t,a=p.cd,r=p.xaxis,m=p.yaxis,o=[];if(g===!1)for(b=0;b<a.length;b++)a[b].selected=0;else for(b=0;b<a.length;b++)(e=(y=a[b]).ct)&&(n=r.c2p(e),t=m.c2p(e),g.contains([n,t],null,b,p)?(o.push({pointNumber:b,lon:e[0],lat:e[1]}),y.selected=1):y.selected=0);return o}},{}],733:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/color"),b=v("../../components/drawing"),y=v("../../components/colorscale");function e(n,t){var a=t[0].trace,r=t[0].node3.selectAll(".choroplethlocation"),m=a.marker||{},o=m.line||{},i=y.makeColorScaleFuncFromTrace(a);r.each(function(u){p.select(this).attr("fill",i(u.z)).call(g.stroke,u.mlc||o.color).call(b.dashLine,"",u.mlw||o.width||0).style("opacity",m.opacity)}),b.selectedPointStyle(r,a,n)}J.exports={style:function(n,t){t&&e(n,t)},styleOnSelect:function(n,t){var a=t[0].node3,r=t[0].trace;r.selectedpoints?b.selectedPointStyle(a.selectAll(".choroplethlocation"),r,n):e(n,t)}}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"@plotly/d3":58}],734:[function(v,J,Z){var p=v("../choropleth/attributes"),g=v("../../components/colorscale/attributes"),b=v("../../plots/template_attributes").hovertemplateAttrs,y=v("../../plots/attributes"),e=v("../../lib/extend").extendFlat;J.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},p.featureidkey,{}),below:{valType:"string",editType:"plot"},text:p.text,hovertext:p.hovertext,marker:{line:{color:e({},p.marker.line.color,{editType:"plot"}),width:e({},p.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},p.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},p.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},p.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:p.hoverinfo,hovertemplate:b({},{keys:["properties"]}),showlegend:e({},y.showlegend,{dflt:!1})},g("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../choropleth/attributes":725}],735:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("../../components/colorscale"),y=v("../../components/drawing"),e=v("../../lib/geojson_utils").makeBlank,n=v("../../lib/geo_location_utils");function t(a){var r,m=a[0].trace,o=m._opts;if(m.selectedpoints){for(var i=y.makeSelectedPointStyleFns(m),u=0;u<a.length;u++){var f=a[u];f.fOut&&(f.fOut.properties.mo2=i.selectedOpacityFn(f))}r={type:"identity",property:"mo2"}}else r=g.isArrayOrTypedArray(m.marker.opacity)?{type:"identity",property:"mo"}:m.marker.opacity;return g.extendFlat(o.fill.paint,{"fill-opacity":r}),g.extendFlat(o.line.paint,{"line-opacity":r}),o}J.exports={convert:function(a){var r=a[0].trace,m=r.visible===!0&&r._length!==0,o={layout:{visibility:"none"},paint:{}},i={layout:{visibility:"none"},paint:{}},u=r._opts={fill:o,line:i,geojson:e()};if(!m)return u;var f=n.extractTraceFeature(a);if(!f)return u;var l,h,d,s=b.makeColorScaleFuncFromTrace(r),x=r.marker,c=x.line||{};g.isArrayOrTypedArray(x.opacity)&&(l=function(A){var I=A.mo;return p(I)?+g.constrain(I,0,1):0}),g.isArrayOrTypedArray(c.color)&&(h=function(A){return A.mlc}),g.isArrayOrTypedArray(c.width)&&(d=function(A){return A.mlw});for(var T=0;T<a.length;T++){var _=a[T],w=_.fOut;if(w){var k=w.properties;k.fc=s(_.z),l&&(k.mo=l(_)),h&&(k.mlc=h(_)),d&&(k.mlw=d(_)),_.ct=k.ct,_._polygons=n.feature2polygons(w)}}var L=l?{type:"identity",property:"mo"}:x.opacity;return g.extendFlat(o.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),g.extendFlat(i.paint,{"line-color":h?{type:"identity",property:"mlc"}:c.color,"line-width":d?{type:"identity",property:"mlw"}:c.width,"line-opacity":L}),o.layout.visibility="visible",i.layout.visibility="visible",u.geojson={type:"FeatureCollection",features:f},t(a),u},convertOnSelect:t}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"fast-isnumeric":190}],736:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/colorscale/defaults"),b=v("./attributes");J.exports=function(y,e,n,t){function a(i,u){return p.coerce(y,e,b,i,u)}var r=a("locations"),m=a("z"),o=a("geojson");p.isArrayOrTypedArray(r)&&r.length&&p.isArrayOrTypedArray(m)&&m.length&&(typeof o=="string"&&o!==""||p.isPlainObject(o))?(a("featureidkey"),e._length=Math.min(r.length,m.length),a("below"),a("text"),a("hovertext"),a("hovertemplate"),a("marker.line.width")&&a("marker.line.color"),a("marker.opacity"),g(y,e,t,a,{prefix:"",cLetter:"z"}),p.coerceSelectionMarkerOpacity(e,a)):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":734}],737:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),calc:v("../choropleth/calc"),plot:v("./plot"),hoverPoints:v("../choropleth/hover"),eventData:v("../choropleth/event_data"),selectPoints:v("../choropleth/select"),styleOnSelect:function(p,g){g&&g[0].trace._glTrace.updateOnSelect(g)},getBelow:function(p,g){for(var b=g.getMapLayers(),y=b.length-2;y>=0;y--){var e=b[y].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var n=y+1;n<b.length;n++)if(typeof(e=b[n].id)=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:v("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":622,"../choropleth/calc":726,"../choropleth/event_data":728,"../choropleth/hover":729,"../choropleth/select":732,"../heatmap/colorbar":804,"./attributes":734,"./defaults":736,"./plot":738}],738:[function(v,J,Z){var p=v("./convert").convert,g=v("./convert").convertOnSelect,b=v("../../plots/mapbox/constants").traceLayerPrefix;function y(n,t){this.type="choroplethmapbox",this.subplot=n,this.uid=t,this.sourceId="source-"+t,this.layerList=[["fill",b+t+"-fill"],["line",b+t+"-line"]],this.below=null}var e=y.prototype;e.update=function(n){this._update(p(n))},e.updateOnSelect=function(n){this._update(g(n))},e._update=function(n){var t=this.subplot,a=this.layerList,r=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(n.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(n,r),this.below=r);for(var m=0;m<a.length;m++){var o=a[m],i=o[0],u=o[1],f=n[i];t.setOptions(u,"setLayoutProperty",f.layout),f.layout.visibility==="visible"&&t.setOptions(u,"setPaintProperty",f.paint)}},e._addLayers=function(n,t){for(var a=this.subplot,r=this.layerList,m=this.sourceId,o=0;o<r.length;o++){var i=r[o],u=i[0],f=n[u];a.addLayer({type:u,id:i[1],source:m,layout:f.layout,paint:f.paint},t)}},e._removeLayers=function(){for(var n=this.subplot.map,t=this.layerList,a=t.length-1;a>=0;a--)n.removeLayer(t[a][1])},e.dispose=function(){var n=this.subplot.map;this._removeLayers(),n.removeSource(this.sourceId)},J.exports=function(n,t){var a=t[0].trace,r=new y(n,a.uid),m=r.sourceId,o=p(t),i=r.below=n.belowLookup["trace-"+a.uid];return n.map.addSource(m,{type:"geojson",data:o.geojson}),r._addLayers(o,i),t[0].trace._glTrace=r,r}},{"../../plots/mapbox/constants":620,"./convert":735}],739:[function(v,J,Z){var p=v("../../components/colorscale/attributes"),g=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,b=v("../../plots/template_attributes").hovertemplateAttrs,y=v("../mesh3d/attributes"),e=v("../../plots/attributes"),n=v("../../lib/extend").extendFlat,t={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:b({editType:"calc"},{keys:["norm"]}),uhoverformat:g("u",1),vhoverformat:g("v",1),whoverformat:g("w",1),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),showlegend:n({},e.showlegend,{dflt:!1})};n(t,p("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){t[a]=y[a]}),t.hoverinfo=n({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),t.transforms=void 0,J.exports=t},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],740:[function(v,J,Z){var p=v("../../components/colorscale/calc");J.exports=function(g,b){for(var y=b.u,e=b.v,n=b.w,t=Math.min(b.x.length,b.y.length,b.z.length,y.length,e.length,n.length),a=-1/0,r=1/0,m=0;m<t;m++){var o=y[m],i=e[m],u=n[m],f=Math.sqrt(o*o+i*i+u*u);a=Math.max(a,f),r=Math.min(r,f)}b._len=t,b._normMax=a,p(g,b,{vals:[r,a],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],741:[function(v,J,Z){var p=v("../../../stackgl_modules").gl_cone3d,g=v("../../../stackgl_modules").gl_cone3d.createConeMesh,b=v("../../lib").simpleMap,y=v("../../lib/gl_format_color").parseColorScale,e=v("../../components/colorscale").extractOpts,n=v("../../plots/gl3d/zip3");function t(u,f){this.scene=u,this.uid=f,this.mesh=null,this.data=null}var a=t.prototype;a.handlePick=function(u){if(u.object===this.mesh){var f=u.index=u.data.index,l=this.data.x[f],h=this.data.y[f],d=this.data.z[f],s=this.data.u[f],x=this.data.v[f],c=this.data.w[f];u.traceCoordinate=[l,h,d,s,x,c,Math.sqrt(s*s+x*x+c*c)];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&T[f]!==void 0?u.textLabel=T[f]:T&&(u.textLabel=T),!0}};var r={xaxis:0,yaxis:1,zaxis:2},m={tip:1,tail:0,cm:.25,center:.5},o={tip:1,tail:1,cm:.75,center:.5};function i(u,f){var l=u.fullSceneLayout,h=u.dataScale,d={};function s(_,w){var k=l[w],L=h[r[w]];return b(_,function(A){return k.d2l(A)*L})}d.vectors=n(s(f.u,"xaxis"),s(f.v,"yaxis"),s(f.w,"zaxis"),f._len),d.positions=n(s(f.x,"xaxis"),s(f.y,"yaxis"),s(f.z,"zaxis"),f._len);var x=e(f);d.colormap=y(f),d.vertexIntensityBounds=[x.min/f._normMax,x.max/f._normMax],d.coneOffset=m[f.anchor],f.sizemode==="scaled"?d.coneSize=f.sizeref||.5:d.coneSize=f.sizeref&&f._normMax?f.sizeref/f._normMax:.5;var c=p(d),T=f.lightposition;return c.lightPosition=[T.x,T.y,T.z],c.ambient=f.lighting.ambient,c.diffuse=f.lighting.diffuse,c.specular=f.lighting.specular,c.roughness=f.lighting.roughness,c.fresnel=f.lighting.fresnel,c.opacity=f.opacity,f._pad=o[f.anchor]*c.vectorScale*c.coneScale*f._normMax,c}a.update=function(u){this.data=u;var f=i(this.scene,u);this.mesh.update(f)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},J.exports=function(u,f){var l=u.glplot.gl,h=i(u,f),d=g(l,h),s=new t(u,f.uid);return s.mesh=d,s.data=f,d._trace=s,u.glplot.add(d),s}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],742:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/colorscale/defaults"),b=v("./attributes");J.exports=function(y,e,n,t){function a(l,h){return p.coerce(y,e,b,l,h)}var r=a("u"),m=a("v"),o=a("w"),i=a("x"),u=a("y"),f=a("z");r&&r.length&&m&&m.length&&o&&o.length&&i&&i.length&&u&&u.length&&f&&f.length?(a("sizeref"),a("sizemode"),a("anchor"),a("lighting.ambient"),a("lighting.diffuse"),a("lighting.specular"),a("lighting.roughness"),a("lighting.fresnel"),a("lightposition.x"),a("lightposition.y"),a("lightposition.z"),g(y,e,t,a,{prefix:"",cLetter:"c"}),a("text"),a("hovertext"),a("hovertemplate"),a("uhoverformat"),a("vhoverformat"),a("whoverformat"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":739}],743:[function(v,J,Z){J.exports={moduleType:"trace",name:"cone",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:v("./calc"),plot:v("./convert"),eventData:function(p,g){return p.norm=g.traceCoordinate[6],p},meta:{}}},{"../../plots/gl3d":607,"./attributes":739,"./calc":740,"./convert":741,"./defaults":742}],744:[function(v,J,Z){var p=v("../heatmap/attributes"),g=v("../scatter/attributes"),b=v("../../plots/cartesian/axis_format_attributes"),y=b.axisHoverFormat,e=b.descriptionOnlyNumbers,n=v("../../components/colorscale/attributes"),t=v("../../components/drawing/attributes").dash,a=v("../../plots/font_attributes"),r=v("../../lib/extend").extendFlat,m=v("../../constants/filter_ops"),o=m.COMPARISON_OPS2,i=m.INTERVAL_OPS,u=g.line;J.exports=r({z:p.z,x:p.x,x0:p.x0,dx:p.dx,y:p.y,y0:p.y0,dy:p.dy,xperiod:p.xperiod,yperiod:p.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:p.xperiodalignment,yperiodalignment:p.yperiodalignment,text:p.text,hovertext:p.hovertext,transpose:p.transpose,xtype:p.xtype,ytype:p.ytype,xhoverformat:y("x"),yhoverformat:y("y"),zhoverformat:y("z",1),hovertemplate:p.hovertemplate,texttemplate:r({},p.texttemplate,{}),textfont:r({},p.textfont,{}),hoverongaps:p.hoverongaps,connectgaps:r({},p.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:a({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(o).concat(i),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:r({},u.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:t,smoothing:r({},u.smoothing,{}),editType:"plot"}},n("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../constants/filter_ops":487,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../heatmap/attributes":801,"../scatter/attributes":936}],745:[function(v,J,Z){var p=v("../../components/colorscale"),g=v("../heatmap/calc"),b=v("./set_contours"),y=v("./end_plus");J.exports=function(e,n){var t=g(e,n),a=t[0].z;b(n,a);var r,m=n.contours,o=p.extractOpts(n);if(m.coloring==="heatmap"&&o.auto&&n.autocontour===!1){var i=m.start,u=y(m),f=m.size||1,l=Math.floor((u-i)/f)+1;isFinite(f)||(f=1,l=1);var h=i-f/2;r=[h,h+l*f]}else r=a;return p.calc(e,n,{vals:r,cLetter:"z"}),t}},{"../../components/colorscale":379,"../heatmap/calc":802,"./end_plus":755,"./set_contours":763}],746:[function(v,J,Z){J.exports=function(p,g){var b,y=p[0],e=y.z;switch(g.type){case"levels":var n=Math.min(e[0][0],e[0][1]);for(b=0;b<p.length;b++){var t=p[b];t.prefixBoundary=!t.edgepaths.length&&(n>t.level||t.starts.length&&n===t.level)}break;case"constraint":if(y.prefixBoundary=!1,y.edgepaths.length)return;var a=y.x.length,r=y.y.length,m=-1/0,o=1/0;for(b=0;b<r;b++)o=Math.min(o,e[b][0]),o=Math.min(o,e[b][a-1]),m=Math.max(m,e[b][0]),m=Math.max(m,e[b][a-1]);for(b=1;b<a-1;b++)o=Math.min(o,e[0][b]),o=Math.min(o,e[r-1][b]),m=Math.max(m,e[0][b]),m=Math.max(m,e[r-1][b]);var i,u,f=g.value;switch(g._operation){case">":f>m&&(y.prefixBoundary=!0);break;case"<":(f<o||y.starts.length&&f===o)&&(y.prefixBoundary=!0);break;case"[]":i=Math.min(f[0],f[1]),((u=Math.max(f[0],f[1]))<o||i>m||y.starts.length&&u===o)&&(y.prefixBoundary=!0);break;case"][":i=Math.min(f[0],f[1]),u=Math.max(f[0],f[1]),i<o&&u>m&&(y.prefixBoundary=!0)}}}},{}],747:[function(v,J,Z){var p=v("../../components/colorscale"),g=v("./make_color_map"),b=v("./end_plus");J.exports={min:"zmin",max:"zmax",calc:function(y,e,n){var t=e.contours,a=e.line,r=t.size||1,m=t.coloring,o=g(e,{isColorbar:!0});if(m==="heatmap"){var i=p.extractOpts(e);n._fillgradient=i.reversescale?p.flipScale(i.colorscale):i.colorscale,n._zrange=[i.min,i.max]}else m==="fill"&&(n._fillcolor=o);n._line={color:m==="lines"?o:a.color,width:t.showlines!==!1?a.width:0,dash:a.dash},n._levels={start:t.start,end:b(t),size:r}}}},{"../../components/colorscale":379,"./end_plus":755,"./make_color_map":760}],748:[function(v,J,Z){J.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],749:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("./label_defaults"),b=v("../../components/color"),y=b.addOpacity,e=b.opacity,n=v("../../constants/filter_ops"),t=n.CONSTRAINT_REDUCTION,a=n.COMPARISON_OPS2;J.exports=function(r,m,o,i,u,f){var l,h,d,s=m.contours,x=o("contours.operation");s._operation=t[x],function(c,T){var _;a.indexOf(T.operation)===-1?(c("contours.value",[0,1]),Array.isArray(T.value)?T.value.length>2?T.value=T.value.slice(2):T.length===0?T.value=[0,1]:T.length<2?(_=parseFloat(T.value[0]),T.value=[_,_+1]):T.value=[parseFloat(T.value[0]),parseFloat(T.value[1])]:p(T.value)&&(_=parseFloat(T.value),T.value=[_,_+1])):(c("contours.value",0),p(T.value)||(Array.isArray(T.value)?T.value=parseFloat(T.value[0]):T.value=0))}(o,s),x==="="?l=s.showlines=!0:(l=o("contours.showlines"),d=o("fillcolor",y((r.line||{}).color||u,.5))),l&&(h=o("line.color",d&&e(d)?y(m.fillcolor,1):u),o("line.width",2),o("line.dash")),o("line.smoothing"),g(o,i,h,f)}},{"../../components/color":367,"../../constants/filter_ops":487,"./label_defaults":759,"fast-isnumeric":190}],750:[function(v,J,Z){var p=v("../../constants/filter_ops"),g=v("fast-isnumeric");function b(n,t){var a,r=Array.isArray(t);function m(o){return g(o)?+o:null}return p.COMPARISON_OPS2.indexOf(n)!==-1?a=m(r?t[0]:t):p.INTERVAL_OPS.indexOf(n)!==-1?a=r?[m(t[0]),m(t[1])]:[m(t),m(t)]:p.SET_OPS.indexOf(n)!==-1&&(a=r?t.map(m):[m(t)]),a}function y(n){return function(t){t=b(n,t);var a=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]);return{start:a,end:r,size:r-a}}}function e(n){return function(t){return{start:t=b(n,t),end:1/0,size:1/0}}}J.exports={"[]":y("[]"),"][":y("]["),">":e(">"),"<":e("<"),"=":e("=")}},{"../../constants/filter_ops":487,"fast-isnumeric":190}],751:[function(v,J,Z){J.exports=function(p,g,b,y){var e=y("contours.start"),n=y("contours.end"),t=e===!1||n===!1,a=b("contours.size");!(t?g.autocontour=!0:b("autocontour",!1))&&a||b("ncontours")}},{}],752:[function(v,J,Z){var p=v("../../lib");function g(b){return p.extendFlat({},b,{edgepaths:p.extendDeep([],b.edgepaths),paths:p.extendDeep([],b.paths),starts:p.extendDeep([],b.starts)})}J.exports=function(b,y){var e,n,t,a=function(o){return o.reverse()},r=function(o){return o};switch(y){case"=":case"<":return b;case">":for(b.length!==1&&p.warn("Contour data invalid for the specified inequality operation."),n=b[0],e=0;e<n.edgepaths.length;e++)n.edgepaths[e]=a(n.edgepaths[e]);for(e=0;e<n.paths.length;e++)n.paths[e]=a(n.paths[e]);for(e=0;e<n.starts.length;e++)n.starts[e]=a(n.starts[e]);return b;case"][":var m=a;a=r,r=m;case"[]":for(b.length!==2&&p.warn("Contour data invalid for the specified inequality range operation."),n=g(b[0]),t=g(b[1]),e=0;e<n.edgepaths.length;e++)n.edgepaths[e]=a(n.edgepaths[e]);for(e=0;e<n.paths.length;e++)n.paths[e]=a(n.paths[e]);for(e=0;e<n.starts.length;e++)n.starts[e]=a(n.starts[e]);for(;t.edgepaths.length;)n.edgepaths.push(r(t.edgepaths.shift()));for(;t.paths.length;)n.paths.push(r(t.paths.shift()));for(;t.starts.length;)n.starts.push(r(t.starts.shift()));return[n]}}},{"../../lib":515}],753:[function(v,J,Z){var p=v("../../lib"),g=v("../heatmap/xyz_defaults"),b=v("../scatter/period_defaults"),y=v("./constraint_defaults"),e=v("./contours_defaults"),n=v("./style_defaults"),t=v("../heatmap/label_defaults"),a=v("./attributes");J.exports=function(r,m,o,i){function u(l,h){return p.coerce(r,m,a,l,h)}if(g(r,m,u,i)){b(r,m,i,u),u("xhoverformat"),u("yhoverformat"),u("text"),u("hovertext"),u("hoverongaps"),u("hovertemplate");var f=u("contours.type")==="constraint";u("connectgaps",p.isArray1D(m.z)),f?y(r,m,u,i,o):(e(r,m,u,function(l){return p.coerce2(r,m,a,l)}),n(r,m,u,i)),m.contours&&m.contours.coloring==="heatmap"&&t(u,i)}else m.visible=!1}},{"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/xyz_defaults":816,"../scatter/period_defaults":956,"./attributes":744,"./constraint_defaults":749,"./contours_defaults":751,"./style_defaults":765}],754:[function(v,J,Z){var p=v("../../lib"),g=v("./constraint_mapping"),b=v("./end_plus");J.exports=function(y,e,n){for(var t=y.type==="constraint"?g[y._operation](y.value):y,a=t.size,r=[],m=b(t),o=n.trace._carpetTrace,i=o?{xaxis:o.aaxis,yaxis:o.baxis,x:n.a,y:n.b}:{xaxis:e.xaxis,yaxis:e.yaxis,x:n.x,y:n.y},u=t.start;u<m;u+=a)if(r.push(p.extendFlat({level:u,crossings:{},starts:[],edgepaths:[],paths:[],z:n.z,smoothing:n.trace.line.smoothing},i)),r.length>1e3){p.warn("Too many contours, clipping at 1000",y);break}return r}},{"../../lib":515,"./constraint_mapping":750,"./end_plus":755}],755:[function(v,J,Z){J.exports=function(p){return p.end+p.size/1e6}},{}],756:[function(v,J,Z){var p=v("../../lib"),g=v("./constants");function b(n,t,a,r){return Math.abs(n[0]-t[0])<a&&Math.abs(n[1]-t[1])<r}function y(n,t,a,r,m){var o,i=t.join(","),u=n.crossings[i],f=function(Q,K,re){var ne=0,le=0;return Q>20&&K?Q===208||Q===1114?ne=re[0]===0?1:-1:le=re[1]===0?1:-1:g.BOTTOMSTART.indexOf(Q)!==-1?le=1:g.LEFTSTART.indexOf(Q)!==-1?ne=1:g.TOPSTART.indexOf(Q)!==-1?le=-1:ne=-1,[ne,le]}(u,a,t),l=[e(n,t,[-f[0],-f[1]])],h=n.z.length,d=n.z[0].length,s=t.slice(),x=f.slice();for(o=0;o<1e4;o++){if(u>20?(u=g.CHOOSESADDLE[u][(f[0]||f[1])<0?0:1],n.crossings[i]=g.SADDLEREMAINDER[u]):delete n.crossings[i],!(f=g.NEWDELTA[u])){p.log("Found bad marching index:",u,t,n.level);break}l.push(e(n,t,f)),t[0]+=f[0],t[1]+=f[1],i=t.join(","),b(l[l.length-1],l[l.length-2],r,m)&&l.pop();var c=f[0]&&(t[0]<0||t[0]>d-2)||f[1]&&(t[1]<0||t[1]>h-2);if(t[0]===s[0]&&t[1]===s[1]&&f[0]===x[0]&&f[1]===x[1]||a&&c)break;u=n.crossings[i]}o===1e4&&p.log("Infinite loop in contour?");var T,_,w,k,L,A,I,P,S,E,D,R,H,V,X,$=b(l[0],l[l.length-1],r,m),G=0,W=.2*n.smoothing,te=[],N=0;for(o=1;o<l.length;o++)R=l[o],H=l[o-1],V=void 0,X=void 0,V=R[2]-H[2],X=R[3]-H[3],G+=I=Math.sqrt(V*V+X*X),te.push(I);var B=G/te.length*W;function U(Q){return l[Q%l.length]}for(o=l.length-2;o>=N;o--)if((T=te[o])<B){for(w=0,_=o-1;_>=N&&T+te[_]<B;_--)T+=te[_];if($&&o===l.length-2)for(w=0;w<_&&T+te[w]<B;w++)T+=te[w];L=o-_+w+1,A=Math.floor((o+_+w+2)/2),k=$||o!==l.length-2?$||_!==-1?L%2?U(A):[(U(A)[0]+U(A+1)[0])/2,(U(A)[1]+U(A+1)[1])/2]:l[0]:l[l.length-1],l.splice(_+1,o-_+1,k),o=_+1,w&&(N=w),$&&(o===l.length-2?l[w]=l[l.length-1]:o===0&&(l[l.length-1]=l[0]))}for(l.splice(0,N),o=0;o<l.length;o++)l[o].length=2;if(!(l.length<2))if($)l.pop(),n.paths.push(l);else{a||p.log("Unclosed interior contour?",n.level,s.join(","),l.join("L"));var ee=!1;for(P=0;P<n.edgepaths.length;P++)if(E=n.edgepaths[P],!ee&&b(E[0],l[l.length-1],r,m)){l.pop(),ee=!0;var j=!1;for(S=0;S<n.edgepaths.length;S++)if(b((D=n.edgepaths[S])[D.length-1],l[0],r,m)){j=!0,l.shift(),n.edgepaths.splice(P,1),S===P?n.paths.push(l.concat(D)):(S>P&&S--,n.edgepaths[S]=D.concat(l,E));break}j||(n.edgepaths[P]=l.concat(E))}for(P=0;P<n.edgepaths.length&&!ee;P++)b((E=n.edgepaths[P])[E.length-1],l[0],r,m)&&(l.shift(),n.edgepaths[P]=E.concat(l),ee=!0);ee||n.edgepaths.push(l)}}function e(n,t,a){var r=t[0]+Math.max(a[0],0),m=t[1]+Math.max(a[1],0),o=n.z[m][r],i=n.xaxis,u=n.yaxis;if(a[1]){var f=(n.level-o)/(n.z[m][r+1]-o),l=(f!==1?(1-f)*i.c2l(n.x[r]):0)+(f!==0?f*i.c2l(n.x[r+1]):0);return[i.c2p(i.l2c(l),!0),u.c2p(n.y[m],!0),r+f,m]}var h=(n.level-o)/(n.z[m+1][r]-o),d=(h!==1?(1-h)*u.c2l(n.y[m]):0)+(h!==0?h*u.c2l(n.y[m+1]):0);return[i.c2p(n.x[r],!0),u.c2p(u.l2c(d),!0),r,m+h]}J.exports=function(n,t,a){var r,m,o,i;for(t=t||.01,a=a||.01,m=0;m<n.length;m++){for(o=n[m],i=0;i<o.starts.length;i++)y(o,o.starts[i],"edge",t,a);for(r=0;Object.keys(o.crossings).length&&r<1e4;)r++,y(o,Object.keys(o.crossings)[0].split(",").map(Number),void 0,t,a);r===1e4&&p.log("Infinite loop in contour?")}}},{"../../lib":515,"./constants":748}],757:[function(v,J,Z){var p=v("../../components/color"),g=v("../heatmap/hover");J.exports=function(b,y,e,n,t){t||(t={}),t.isContour=!0;var a=g(b,y,e,n,t);return a&&a.forEach(function(r){var m=r.trace;m.contours.type==="constraint"&&(m.fillcolor&&p.opacity(m.fillcolor)?r.color=p.addOpacity(m.fillcolor,1):m.contours.showlines&&p.opacity(m.line.color)&&(r.color=p.addOpacity(m.line.color,1)))}),a}},{"../../components/color":367,"../heatmap/hover":808}],758:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot").plot,style:v("./style"),colorbar:v("./colorbar"),hoverPoints:v("./hover"),moduleType:"trace",name:"contour",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":744,"./calc":745,"./colorbar":747,"./defaults":753,"./hover":757,"./plot":762,"./style":764}],759:[function(v,J,Z){var p=v("../../lib");J.exports=function(g,b,y,e){if(e||(e={}),g("contours.showlabels")){var n=b.font;p.coerceFont(g,"contours.labelfont",{family:n.family,size:n.size,color:y}),g("contours.labelformat")}e.hasHover!==!1&&g("zhoverformat")}},{"../../lib":515}],760:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/colorscale"),b=v("./end_plus");J.exports=function(y){var e=y.contours,n=e.start,t=b(e),a=e.size||1,r=Math.floor((t-n)/a)+1,m=e.coloring==="lines"?0:1,o=g.extractOpts(y);isFinite(a)||(a=1,r=1);var i,u,f=o.reversescale?g.flipScale(o.colorscale):o.colorscale,l=f.length,h=new Array(l),d=new Array(l);if(e.coloring==="heatmap"){var s=o.min,x=o.max;for(u=0;u<l;u++)i=f[u],h[u]=i[0]*(x-s)+s,d[u]=i[1];var c=p.extent([s,x,e.start,e.start+a*(r-1)]),T=c[s<x?0:1],_=c[s<x?1:0];T!==s&&(h.splice(0,0,T),d.splice(0,0,d[0])),_!==x&&(h.push(_),d.push(d[d.length-1]))}else for(u=0;u<l;u++)i=f[u],h[u]=(i[0]*(r+m-1)-m/2)*a+n,d[u]=i[1];return g.makeColorScaleFunc({domain:h,range:d},{noNumericCheck:!0})}},{"../../components/colorscale":379,"./end_plus":755,"@plotly/d3":58}],761:[function(v,J,Z){var p=v("./constants");function g(b,y){var e=(y[0][0]>b?0:1)+(y[0][1]>b?0:2)+(y[1][1]>b?0:4)+(y[1][0]>b?0:8);return e===5||e===10?b>(y[0][0]+y[0][1]+y[1][0]+y[1][1])/4?e===5?713:1114:e===5?104:208:e===15?0:e}J.exports=function(b){var y,e,n,t,a,r,m,o,i,u=b[0].z,f=u.length,l=u[0].length,h=f===2||l===2;for(e=0;e<f-1;e++)for(t=[],e===0&&(t=t.concat(p.BOTTOMSTART)),e===f-2&&(t=t.concat(p.TOPSTART)),y=0;y<l-1;y++)for(n=t.slice(),y===0&&(n=n.concat(p.LEFTSTART)),y===l-2&&(n=n.concat(p.RIGHTSTART)),a=y+","+e,r=[[u[e][y],u[e][y+1]],[u[e+1][y],u[e+1][y+1]]],i=0;i<b.length;i++)(m=g((o=b[i]).level,r))&&(o.crossings[a]=m,n.indexOf(m)!==-1&&(o.starts.push([y,e]),h&&n.indexOf(m,n.indexOf(m)+1)!==-1&&o.starts.push([y,e])))}},{"./constants":748}],762:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../components/drawing"),y=v("../../components/colorscale"),e=v("../../lib/svg_text_utils"),n=v("../../plots/cartesian/axes"),t=v("../../plots/cartesian/set_convert"),a=v("../heatmap/plot"),r=v("./make_crossings"),m=v("./find_all_paths"),o=v("./empty_pathinfo"),i=v("./convert_to_constraints"),u=v("./close_boundaries"),f=v("./constants"),l=f.LABELOPTIMIZER;function h(x,c){var T,_,w,k,L,A,I,P="",S=0,E=x.edgepaths.map(function($,G){return G}),D=!0;function R($){return Math.abs($[1]-c[2][1])<.01}function H($){return Math.abs($[0]-c[0][0])<.01}function V($){return Math.abs($[0]-c[2][0])<.01}for(;E.length;){for(A=b.smoothopen(x.edgepaths[S],x.smoothing),P+=D?A:A.replace(/^M/,"L"),E.splice(E.indexOf(S),1),T=x.edgepaths[S][x.edgepaths[S].length-1],k=-1,w=0;w<4;w++){if(!T){g.log("Missing end?",S,x);break}for(I=T,Math.abs(I[1]-c[0][1])<.01&&!V(T)?_=c[1]:H(T)?_=c[0]:R(T)?_=c[3]:V(T)&&(_=c[2]),L=0;L<x.edgepaths.length;L++){var X=x.edgepaths[L][0];Math.abs(T[0]-_[0])<.01?Math.abs(T[0]-X[0])<.01&&(X[1]-T[1])*(_[1]-X[1])>=0&&(_=X,k=L):Math.abs(T[1]-_[1])<.01?Math.abs(T[1]-X[1])<.01&&(X[0]-T[0])*(_[0]-X[0])>=0&&(_=X,k=L):g.log("endpt to newendpt is not vert. or horz.",T,_,X)}if(T=_,k>=0)break;P+="L"+_}if(k===x.edgepaths.length){g.log("unclosed perimeter path");break}S=k,(D=E.indexOf(S)===-1)&&(S=E[0],P+="Z")}for(S=0;S<x.paths.length;S++)P+=b.smoothclosed(x.paths[S],x.smoothing);return P}function d(x,c,T,_){var w=c.width/2,k=c.height/2,L=x.x,A=x.y,I=x.theta,P=Math.cos(I)*w,S=Math.sin(I)*w,E=(L>_.center?_.right-L:L-_.left)/(P+Math.abs(Math.sin(I)*k)),D=(A>_.middle?_.bottom-A:A-_.top)/(Math.abs(S)+Math.cos(I)*k);if(E<1||D<1)return 1/0;var R=l.EDGECOST*(1/(E-1)+1/(D-1));R+=l.ANGLECOST*I*I;for(var H=L-P,V=A-S,X=L+P,$=A+S,G=0;G<T.length;G++){var W=T[G],te=Math.cos(W.theta)*W.width/2,N=Math.sin(W.theta)*W.width/2,B=2*g.segmentDistance(H,V,X,$,W.x-te,W.y-N,W.x+te,W.y+N)/(c.height+W.height),U=W.level===c.level,ee=U?l.SAMELEVELDISTANCE:1;if(B<=ee)return 1/0;R+=l.NEIGHBORCOST*(U?l.SAMELEVELFACTOR:1)/(B-ee)}return R}function s(x){var c,T,_=x.trace._emptypoints,w=[],k=x.z.length,L=x.z[0].length,A=[];for(c=0;c<L;c++)A.push(1);for(c=0;c<k;c++)w.push(A.slice());for(c=0;c<_.length;c++)w[(T=_[c])[0]][T[1]]=0;return x.zmask=w,w}Z.plot=function(x,c,T,_){var w=c.xaxis,k=c.yaxis;g.makeTraceGroups(_,T,"contour").each(function(L){var A=p.select(this),I=L[0],P=I.trace,S=I.x,E=I.y,D=P.contours,R=o(D,c,I),H=g.ensureSingle(A,"g","heatmapcoloring"),V=[];D.coloring==="heatmap"&&(V=[L]),a(x,c,V,H),r(R),m(R);var X=w.c2p(S[0],!0),$=w.c2p(S[S.length-1],!0),G=k.c2p(E[0],!0),W=k.c2p(E[E.length-1],!0),te=[[X,W],[$,W],[$,G],[X,G]],N=R;D.type==="constraint"&&(N=i(R,D._operation)),function(B,U,ee){var j=g.ensureSingle(B,"g","contourbg").selectAll("path").data(ee.coloring==="fill"?[0]:[]);j.enter().append("path"),j.exit().remove(),j.attr("d","M"+U.join("L")+"Z").style("stroke","none")}(A,te,D),function(B,U,ee,j){var Q=j.coloring==="fill"||j.type==="constraint"&&j._operation!=="=",K="M"+ee.join("L")+"Z";Q&&u(U,j);var re=g.ensureSingle(B,"g","contourfill").selectAll("path").data(Q?U:[]);re.enter().append("path"),re.exit().remove(),re.each(function(ne){var le=(ne.prefixBoundary?K:"")+h(ne,ee);le?p.select(this).attr("d",le).style("stroke","none"):p.select(this).remove()})}(A,N,te,D),function(B,U,ee,j,Q){var K=g.ensureSingle(B,"g","contourlines"),re=Q.showlines!==!1,ne=Q.showlabels,le=re&&ne,oe=Z.createLines(K,re||ne,U),de=Z.createLineClip(K,le,ee,j.trace.uid),se=B.selectAll("g.contourlabels").data(ne?[0]:[]);if(se.exit().remove(),se.enter().append("g").classed("contourlabels",!0),ne){var me=[],Te=[];g.clearLocationCache();var _e=Z.labelFormatter(ee,j),be=b.tester.append("text").attr("data-notex",1).call(b.font,Q.labelfont),Ce=U[0].xaxis,fe=U[0].yaxis,ve=Ce._length,Me=fe._length,ke=Ce.range,Le=fe.range,ze=g.aggNums(Math.min,null,j.x),Re=g.aggNums(Math.max,null,j.x),Oe=g.aggNums(Math.min,null,j.y),Ze=g.aggNums(Math.max,null,j.y),Pe=Math.max(Ce.c2p(ze,!0),0),Ie=Math.min(Ce.c2p(Re,!0),ve),Be=Math.max(fe.c2p(Ze,!0),0),Fe=Math.min(fe.c2p(Oe,!0),Me),$e={};ke[0]<ke[1]?($e.left=Pe,$e.right=Ie):($e.left=Ie,$e.right=Pe),Le[0]<Le[1]?($e.top=Be,$e.bottom=Fe):($e.top=Fe,$e.bottom=Be),$e.middle=($e.top+$e.bottom)/2,$e.center=($e.left+$e.right)/2,me.push([[$e.left,$e.top],[$e.right,$e.top],[$e.right,$e.bottom],[$e.left,$e.bottom]]);var ot=Math.sqrt(ve*ve+Me*Me),pt=f.LABELDISTANCE*ot/Math.max(1,U.length/f.LABELINCREASE);oe.each(function(_t){var yt=Z.calcTextOpts(_t.level,_e,be,ee);p.select(this).selectAll("path").each(function(){var tt=g.getVisibleSegment(this,$e,yt.height/2);if(tt&&!(tt.len<(yt.width+yt.height)*f.LABELMIN))for(var Ke=Math.min(Math.ceil(tt.len/pt),f.LABELMAX),vt=0;vt<Ke;vt++){var Nt=Z.findBestTextLocation(this,tt,yt,Te,$e);if(!Nt)break;Z.addLabelData(Nt,yt,Te,me)}})}),be.remove(),Z.drawLabels(se,Te,ee,de,le?me:null)}ne&&!re&&oe.remove()}(A,R,x,I,D),function(B,U,ee,j,Q){var K=j.trace,re=ee._fullLayout._clips,ne="clip"+K.uid,le=re.selectAll("#"+ne).data(K.connectgaps?[]:[0]);if(le.enter().append("clipPath").classed("contourclip",!0).attr("id",ne),le.exit().remove(),K.connectgaps===!1){var oe={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:U.xaxis,yaxis:U.yaxis,x:j.x,y:j.y,z:s(j),smoothing:0};r([oe]),m([oe]),u([oe],{type:"levels"}),g.ensureSingle(le,"path","").attr("d",(oe.prefixBoundary?"M"+Q.join("L")+"Z":"")+h(oe,Q))}else ne=null;b.setClipUrl(B,ne,ee)}(A,c,x,I,te)})},Z.createLines=function(x,c,T){var _=T[0].smoothing,w=x.selectAll("g.contourlevel").data(c?T:[]);if(w.exit().remove(),w.enter().append("g").classed("contourlevel",!0),c){var k=w.selectAll("path.openline").data(function(A){return A.pedgepaths||A.edgepaths});k.exit().remove(),k.enter().append("path").classed("openline",!0),k.attr("d",function(A){return b.smoothopen(A,_)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var L=w.selectAll("path.closedline").data(function(A){return A.ppaths||A.paths});L.exit().remove(),L.enter().append("path").classed("closedline",!0),L.attr("d",function(A){return b.smoothclosed(A,_)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return w},Z.createLineClip=function(x,c,T,_){var w=c?"clipline"+_:null,k=T._fullLayout._clips.selectAll("#"+w).data(c?[0]:[]);return k.exit().remove(),k.enter().append("clipPath").classed("contourlineclip",!0).attr("id",w),b.setClipUrl(x,w,T),k},Z.labelFormatter=function(x,c){var T=x._fullLayout,_=c.trace,w=_.contours,k={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(w.labelformat)k.tickformat=w.labelformat,t(k,T);else{var L=y.extractOpts(_);if(L&&L.colorbar&&L.colorbar._axis)k=L.colorbar._axis;else{if(w.type==="constraint"){var A=w.value;Array.isArray(A)?k.range=[A[0],A[A.length-1]]:k.range=[A,A]}else k.range=[w.start,w.end],k.nticks=(w.end-w.start)/w.size;k.range[0]===k.range[1]&&(k.range[1]+=k.range[0]||1),k.nticks||(k.nticks=1e3),t(k,T),n.prepTicks(k),k._tmin=null,k._tmax=null}}return function(I){return n.tickText(k,I).text}},Z.calcTextOpts=function(x,c,T,_){var w=c(x);T.text(w).call(e.convertToTspans,_);var k=T.node(),L=b.bBox(k,!0);return{text:w,width:L.width,height:L.height,fontSize:+k.style["font-size"].replace("px",""),level:x,dy:(L.top+L.bottom)/2}},Z.findBestTextLocation=function(x,c,T,_,w){var k,L,A,I,P,S=T.width;c.isClosed?(L=c.len/l.INITIALSEARCHPOINTS,k=c.min+L/2,A=c.max):(L=(c.len-S)/(l.INITIALSEARCHPOINTS+1),k=c.min+L+S/2,A=c.max-(L+S)/2);for(var E=1/0,D=0;D<l.ITERATIONS;D++){for(var R=k;R<A;R+=L){var H=g.getTextLocation(x,c.total,R,S),V=d(H,T,_,w);V<E&&(E=V,P=H,I=R)}if(E>2*l.MAXCOST)break;D&&(L/=2),A=(k=I-L/2)+1.5*L}if(E<=l.MAXCOST)return P},Z.addLabelData=function(x,c,T,_){var w=c.fontSize,k=c.width+w/3,L=Math.max(0,c.height-w/3),A=x.x,I=x.y,P=x.theta,S=Math.sin(P),E=Math.cos(P),D=function(H,V){return[A+H*E-V*S,I+H*S+V*E]},R=[D(-k/2,-L/2),D(-k/2,L/2),D(k/2,L/2),D(k/2,-L/2)];T.push({text:c.text,x:A,y:I,dy:c.dy,theta:P,level:c.level,width:k,height:L}),_.push(R)},Z.drawLabels=function(x,c,T,_,w){var k=x.selectAll("text").data(c,function(I){return I.text+","+I.x+","+I.y+","+I.theta});if(k.exit().remove(),k.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(I){var P=I.x+Math.sin(I.theta)*I.dy,S=I.y-Math.cos(I.theta)*I.dy;p.select(this).text(I.text).attr({x:P,y:S,transform:"rotate("+180*I.theta/Math.PI+" "+P+" "+S+")"}).call(e.convertToTspans,T)}),w){for(var L="",A=0;A<w.length;A++)L+="M"+w[A].join("L")+"Z";g.ensureSingle(_,"path","").attr("d",L)}}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/set_convert":585,"../heatmap/plot":813,"./close_boundaries":746,"./constants":748,"./convert_to_constraints":752,"./empty_pathinfo":754,"./find_all_paths":756,"./make_crossings":761,"@plotly/d3":58}],763:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("../../lib");function b(y,e,n){var t={type:"linear",range:[y,e]};return p.autoTicks(t,(e-y)/(n||15)),t}J.exports=function(y,e){var n=y.contours;if(y.autocontour){var t=y.zmin,a=y.zmax;(y.zauto||t===void 0)&&(t=g.aggNums(Math.min,null,e)),(y.zauto||a===void 0)&&(a=g.aggNums(Math.max,null,e));var r=b(t,a,y.ncontours);n.size=r.dtick,n.start=p.tickFirst(r),r.range.reverse(),n.end=p.tickFirst(r),n.start===t&&(n.start+=n.size),n.end===a&&(n.end-=n.size),n.start>n.end&&(n.start=n.end=(n.start+n.end)/2),y._input.contours||(y._input.contours={}),g.extendFlat(y._input.contours,{start:n.start,end:n.end,size:n.size}),y._input.autocontour=!0}else if(n.type!=="constraint"){var m,o=n.start,i=n.end,u=y._input.contours;o>i&&(n.start=u.start=i,i=n.end=u.end=o,o=n.start),!(n.size>0)&&(m=o===i?1:b(o,i,y.ncontours).dtick,u.size=n.size=m)}}},{"../../lib":515,"../../plots/cartesian/axes":566}],764:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/drawing"),b=v("../heatmap/style"),y=v("./make_color_map");J.exports=function(e){var n=p.select(e).selectAll("g.contour");n.style("opacity",function(t){return t[0].trace.opacity}),n.each(function(t){var a=p.select(this),r=t[0].trace,m=r.contours,o=r.line,i=m.size||1,u=m.start,f=m.type==="constraint",l=!f&&m.coloring==="lines",h=!f&&m.coloring==="fill",d=l||h?y(r):null;a.selectAll("g.contourlevel").each(function(c){p.select(this).selectAll("path").call(g.lineGroupStyle,o.width,l?d(c.level):o.color,o.dash)});var s=m.labelfont;if(a.selectAll("g.contourlabels text").each(function(c){g.font(p.select(this),{family:s.family,size:s.size,color:s.color||(l?d(c.level):o.color)})}),f)a.selectAll("g.contourfill path").style("fill",r.fillcolor);else if(h){var x;a.selectAll("g.contourfill path").style("fill",function(c){return x===void 0&&(x=c.level),d(c.level+.5*i)}),x===void 0&&(x=u),a.selectAll("g.contourbg path").style("fill",d(x-.5*i))}}),b(e)}},{"../../components/drawing":389,"../heatmap/style":814,"./make_color_map":760,"@plotly/d3":58}],765:[function(v,J,Z){var p=v("../../components/colorscale/defaults"),g=v("./label_defaults");J.exports=function(b,y,e,n,t){var a,r=e("contours.coloring"),m="";r==="fill"&&(a=e("contours.showlines")),a!==!1&&(r!=="lines"&&(m=e("line.color","#000")),e("line.width",.5),e("line.dash")),r!=="none"&&(b.showlegend!==!0&&(y.showlegend=!1),y._dfltShowLegend=!1,p(b,y,n,e,{prefix:"",cLetter:"z"})),e("line.smoothing"),g(e,n,m,t)}},{"../../components/colorscale/defaults":377,"./label_defaults":759}],766:[function(v,J,Z){var p=v("../heatmap/attributes"),g=v("../contour/attributes"),b=v("../../components/colorscale/attributes"),y=v("../../lib/extend").extendFlat,e=g.contours;J.exports=y({carpet:{valType:"string",editType:"calc"},z:p.z,a:p.x,a0:p.x0,da:p.dx,b:p.y,b0:p.y0,db:p.dy,text:p.text,hovertext:p.hovertext,transpose:p.transpose,atype:p.xtype,btype:p.ytype,fillcolor:g.fillcolor,autocontour:g.autocontour,ncontours:g.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:g.line.color,width:g.line.width,dash:g.line.dash,smoothing:g.line.smoothing,editType:"plot"},transforms:void 0},b("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../contour/attributes":744,"../heatmap/attributes":801}],767:[function(v,J,Z){var p=v("../../components/colorscale/calc"),g=v("../../lib"),b=v("../heatmap/convert_column_xyz"),y=v("../heatmap/clean_2d_array"),e=v("../heatmap/interp2d"),n=v("../heatmap/find_empties"),t=v("../heatmap/make_bound_array"),a=v("./defaults"),r=v("../carpet/lookup_carpetid"),m=v("../contour/set_contours");J.exports=function(o,i){var u=i._carpetTrace=r(o,i);if(u&&u.visible&&u.visible!=="legendonly"){if(!i.a||!i.b){var f=o.data[u.index],l=o.data[i.index];l.a||(l.a=f.a),l.b||(l.b=f.b),a(l,i,i._defaultColor,o._fullLayout)}var h=function(d,s){var x,c,T,_,w,k,L,A=s._carpetTrace,I=A.aaxis,P=A.baxis;I._minDtick=0,P._minDtick=0,g.isArray1D(s.z)&&b(s,I,P,"a","b",["z"]),x=s._a=s._a||s.a,_=s._b=s._b||s.b,x=x?I.makeCalcdata(s,"_a"):[],_=_?P.makeCalcdata(s,"_b"):[],c=s.a0||0,T=s.da||1,w=s.b0||0,k=s.db||1,L=s._z=y(s._z||s.z,s.transpose),s._emptypoints=n(L),e(L,s._emptypoints);var S=g.maxRowLength(L),E=s.xtype==="scaled"?"":x,D=t(s,E,c,T,S,I),R=s.ytype==="scaled"?"":_,H=t(s,R,w,k,L.length,P),V={a:D,b:H,z:L};return s.contours.type==="levels"&&s.contours.coloring!=="none"&&p(d,s,{vals:L,containerStr:"",cLetter:"z"}),[V]}(o,i);return m(i,i._z),h}}},{"../../components/colorscale/calc":375,"../../lib":515,"../carpet/lookup_carpetid":717,"../contour/set_contours":763,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"../heatmap/find_empties":807,"../heatmap/interp2d":810,"../heatmap/make_bound_array":812,"./defaults":768}],768:[function(v,J,Z){var p=v("../../lib"),g=v("../heatmap/xyz_defaults"),b=v("./attributes"),y=v("../contour/constraint_defaults"),e=v("../contour/contours_defaults"),n=v("../contour/style_defaults");J.exports=function(t,a,r,m){function o(i,u){return p.coerce(t,a,b,i,u)}if(o("carpet"),t.a&&t.b){if(!g(t,a,o,m,"a","b"))return void(a.visible=!1);o("text"),o("contours.type")==="constraint"?y(t,a,o,m,r,{hasHover:!1}):(e(t,a,o,function(i){return p.coerce2(t,a,b,i)}),n(t,a,o,m,{hasHover:!1}))}else a._defaultColor=r,a._length=null}},{"../../lib":515,"../contour/constraint_defaults":749,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/xyz_defaults":816,"./attributes":766}],769:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../contour/colorbar"),calc:v("./calc"),plot:v("./plot"),style:v("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"../contour/colorbar":747,"../contour/style":764,"./attributes":766,"./calc":767,"./defaults":768,"./plot":770}],770:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../carpet/map_1d_array"),b=v("../carpet/makepath"),y=v("../../components/drawing"),e=v("../../lib"),n=v("../contour/make_crossings"),t=v("../contour/find_all_paths"),a=v("../contour/plot"),r=v("../contour/constants"),m=v("../contour/convert_to_constraints"),o=v("../contour/empty_pathinfo"),i=v("../contour/close_boundaries"),u=v("../carpet/lookup_carpetid"),f=v("../carpet/axis_aligned_line");function l(s,x,c){var T=s.getPointAtLength(x),_=s.getPointAtLength(c),w=_.x-T.x,k=_.y-T.y,L=Math.sqrt(w*w+k*k);return[w/L,k/L]}function h(s){var x=Math.sqrt(s[0]*s[0]+s[1]*s[1]);return[s[0]/x,s[1]/x]}function d(s,x){var c=Math.abs(s[0]*x[0]+s[1]*x[1]);return Math.sqrt(1-c*c)/c}J.exports=function(s,x,c,T){var _=x.xaxis,w=x.yaxis;e.makeTraceGroups(T,c,"contour").each(function(k){var L=p.select(this),A=k[0],I=A.trace,P=I._carpetTrace=u(s,I),S=s.calcdata[P.index][0];if(P.visible&&P.visible!=="legendonly"){var E=A.a,D=A.b,R=I.contours,H=o(R,x,A),V=R.type==="constraint",X=R._operation,$=V?X==="="?"lines":"fill":R.coloring,G=[[E[0],D[D.length-1]],[E[E.length-1],D[D.length-1]],[E[E.length-1],D[0]],[E[0],D[0]]];n(H);var W=1e-8*(E[E.length-1]-E[0]),te=1e-8*(D[D.length-1]-D[0]);t(H,W,te);var N,B,U,ee,j=H;R.type==="constraint"&&(j=m(H,X)),function(ne,le){var oe,de,se,me,Te,_e,be,Ce,fe;for(oe=0;oe<ne.length;oe++){for(me=ne[oe],Te=me.pedgepaths=[],_e=me.ppaths=[],de=0;de<me.edgepaths.length;de++){for(fe=me.edgepaths[de],be=[],se=0;se<fe.length;se++)be[se]=le(fe[se]);Te.push(be)}for(de=0;de<me.paths.length;de++){for(fe=me.paths[de],Ce=[],se=0;se<fe.length;se++)Ce[se]=le(fe[se]);_e.push(Ce)}}}(H,re);var Q=[];for(ee=S.clipsegments.length-1;ee>=0;ee--)N=S.clipsegments[ee],B=g([],N.x,_.c2p),U=g([],N.y,w.c2p),B.reverse(),U.reverse(),Q.push(b(B,U,N.bicubic));var K="M"+Q.join("L")+"Z";(function(ne,le,oe,de,se,me){var Te,_e,be,Ce,fe=e.ensureSingle(ne,"g","contourbg").selectAll("path").data(me!=="fill"||se?[]:[0]);fe.enter().append("path"),fe.exit().remove();var ve=[];for(Ce=0;Ce<le.length;Ce++)Te=le[Ce],_e=g([],Te.x,oe.c2p),be=g([],Te.y,de.c2p),ve.push(b(_e,be,Te.bicubic));fe.attr("d","M"+ve.join("L")+"Z").style("stroke","none")})(L,S.clipsegments,_,w,V,$),function(ne,le,oe,de,se,me,Te,_e,be,Ce,fe){var ve=Ce==="fill";ve&&i(se,ne.contours);var Me=e.ensureSingle(le,"g","contourfill").selectAll("path").data(ve?se:[]);Me.enter().append("path"),Me.exit().remove(),Me.each(function(ke){var Le=(ke.prefixBoundary?fe:"")+function(ze,Re,Oe,Ze,Pe,Ie,Be,Fe){var $e,ot,pt,_t,yt,tt,Ke,vt="",Nt=Re.edgepaths.map(function(qe,Xe){return Xe}),qt=!0,er=1e-4*Math.abs(Oe[0][0]-Oe[2][0]),Jt=1e-4*Math.abs(Oe[0][1]-Oe[2][1]);function ir(qe){return Math.abs(qe[1]-Oe[0][1])<Jt}function Ht(qe){return Math.abs(qe[1]-Oe[2][1])<Jt}function Ue(qe){return Math.abs(qe[0]-Oe[0][0])<er}function We(qe){return Math.abs(qe[0]-Oe[2][0])<er}function he(qe,Xe){var He,st,it,Tt,Pt="";for(ir(qe)&&!We(qe)||Ht(qe)&&!Ue(qe)?(Tt=Pe.aaxis,it=f(Pe,Ie,[qe[0],Xe[0]],.5*(qe[1]+Xe[1]))):(Tt=Pe.baxis,it=f(Pe,Ie,.5*(qe[0]+Xe[0]),[qe[1],Xe[1]])),He=1;He<it.length;He++)for(Pt+=Tt.smoothing?"C":"L",st=0;st<it[He].length;st++){var rt=it[He][st];Pt+=[Be.c2p(rt[0]),Fe.c2p(rt[1])]+" "}return Pt}for($e=0,ot=null;Nt.length;){var xe=Re.edgepaths[$e][0];for(ot&&(vt+=he(ot,xe)),Ke=y.smoothopen(Re.edgepaths[$e].map(Ze),Re.smoothing),vt+=qt?Ke:Ke.replace(/^M/,"L"),Nt.splice(Nt.indexOf($e),1),ot=Re.edgepaths[$e][Re.edgepaths[$e].length-1],yt=-1,_t=0;_t<4;_t++){if(!ot){e.log("Missing end?",$e,Re);break}for(ir(ot)&&!We(ot)?pt=Oe[1]:Ue(ot)?pt=Oe[0]:Ht(ot)?pt=Oe[3]:We(ot)&&(pt=Oe[2]),tt=0;tt<Re.edgepaths.length;tt++){var De=Re.edgepaths[tt][0];Math.abs(ot[0]-pt[0])<er?Math.abs(ot[0]-De[0])<er&&(De[1]-ot[1])*(pt[1]-De[1])>=0&&(pt=De,yt=tt):Math.abs(ot[1]-pt[1])<Jt?Math.abs(ot[1]-De[1])<Jt&&(De[0]-ot[0])*(pt[0]-De[0])>=0&&(pt=De,yt=tt):e.log("endpt to newendpt is not vert. or horz.",ot,pt,De)}if(yt>=0)break;vt+=he(ot,pt),ot=pt}if(yt===Re.edgepaths.length){e.log("unclosed perimeter path");break}$e=yt,(qt=Nt.indexOf($e)===-1)&&($e=Nt[0],vt+=he(ot,pt)+"Z",ot=null)}for($e=0;$e<Re.paths.length;$e++)vt+=y.smoothclosed(Re.paths[$e].map(Ze),Re.smoothing);return vt}(0,ke,me,Te,_e,be,oe,de);Le?p.select(this).attr("d",Le).style("stroke","none"):p.select(this).remove()})}(I,L,_,w,j,G,re,P,S,$,K),function(ne,le,oe,de,se,me,Te){var _e=e.ensureSingle(ne,"g","contourlines"),be=se.showlines!==!1,Ce=se.showlabels,fe=be&&Ce,ve=a.createLines(_e,be||Ce,le),Me=a.createLineClip(_e,fe,oe,de.trace.uid),ke=ne.selectAll("g.contourlabels").data(Ce?[0]:[]);if(ke.exit().remove(),ke.enter().append("g").classed("contourlabels",!0),Ce){var Le=me.xaxis,ze=me.yaxis,Re=Le._length,Oe=ze._length,Ze=[[[0,0],[Re,0],[Re,Oe],[0,Oe]]],Pe=[];e.clearLocationCache();var Ie=a.labelFormatter(oe,de),Be=y.tester.append("text").attr("data-notex",1).call(y.font,se.labelfont),Fe={left:0,right:Re,center:Re/2,top:0,bottom:Oe,middle:Oe/2},$e=Math.sqrt(Re*Re+Oe*Oe),ot=r.LABELDISTANCE*$e/Math.max(1,le.length/r.LABELINCREASE);ve.each(function(pt){var _t=a.calcTextOpts(pt.level,Ie,Be,oe);p.select(this).selectAll("path").each(function(yt){var tt=e.getVisibleSegment(this,Fe,_t.height/2);if(tt&&(function(qt,er,Jt,ir,Ht,Ue){for(var We,he=0;he<Jt.pedgepaths.length;he++)er===Jt.pedgepaths[he]&&(We=Jt.edgepaths[he]);if(!We)return;var xe=Ht.a[0],De=Ht.a[Ht.a.length-1],qe=Ht.b[0],Xe=Ht.b[Ht.b.length-1];function He(rt,ut){var Ft,wt=0;return(Math.abs(rt[0]-xe)<.1||Math.abs(rt[0]-De)<.1)&&(Ft=h(Ht.dxydb_rough(rt[0],rt[1],.1)),wt=Math.max(wt,Ue*d(ut,Ft)/2)),(Math.abs(rt[1]-qe)<.1||Math.abs(rt[1]-Xe)<.1)&&(Ft=h(Ht.dxyda_rough(rt[0],rt[1],.1)),wt=Math.max(wt,Ue*d(ut,Ft)/2)),wt}var st=l(qt,0,1),it=l(qt,ir.total,ir.total-1),Tt=He(We[0],st),Pt=ir.total-He(We[We.length-1],it);ir.min<Tt&&(ir.min=Tt),ir.max>Pt&&(ir.max=Pt),ir.len=ir.max-ir.min}(this,yt,pt,tt,Te,_t.height),!(tt.len<(_t.width+_t.height)*r.LABELMIN)))for(var Ke=Math.min(Math.ceil(tt.len/ot),r.LABELMAX),vt=0;vt<Ke;vt++){var Nt=a.findBestTextLocation(this,tt,_t,Pe,Fe);if(!Nt)break;a.addLabelData(Nt,_t,Pe,Ze)}})}),Be.remove(),a.drawLabels(ke,Pe,oe,Me,fe?Ze:null)}Ce&&!be&&ve.remove()}(L,H,s,A,R,x,P),y.setClipUrl(L,P._clipPathId,s)}function re(ne){var le=P.ab2xy(ne[0],ne[1],!0);return[_.c2p(le[0]),w.c2p(le[1])]}})}},{"../../components/drawing":389,"../../lib":515,"../carpet/axis_aligned_line":701,"../carpet/lookup_carpetid":717,"../carpet/makepath":718,"../carpet/map_1d_array":719,"../contour/close_boundaries":746,"../contour/constants":748,"../contour/convert_to_constraints":752,"../contour/empty_pathinfo":754,"../contour/find_all_paths":756,"../contour/make_crossings":761,"../contour/plot":762,"@plotly/d3":58}],771:[function(v,J,Z){var p=v("../../components/colorscale/attributes"),g=v("../../plots/template_attributes").hovertemplateAttrs,b=v("../../plots/attributes"),y=v("../scattermapbox/attributes"),e=v("../../lib/extend").extendFlat;J.exports=e({lon:y.lon,lat:y.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:y.text,hovertext:y.hovertext,hoverinfo:e({},b.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:g(),showlegend:e({},b.showlegend,{dflt:!1})},p("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattermapbox/attributes":1002}],772:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib").isArrayOrTypedArray,b=v("../../constants/numerical").BADNUM,y=v("../../components/colorscale/calc"),e=v("../../lib")._;J.exports=function(n,t){for(var a=t._length,r=new Array(a),m=t.z,o=g(m)&&m.length,i=0;i<a;i++){var u=r[i]={},f=t.lon[i],l=t.lat[i];if(u.lonlat=p(f)&&p(l)?[+f,+l]:[b,b],o){var h=m[i];u.z=p(h)?h:b}}return y(n,t,{vals:o?m:[0,1],containerStr:"",cLetter:"z"}),a&&(r[0].t={labels:{lat:e(n,"lat:")+" ",lon:e(n,"lon:")+" "}}),r}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],773:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("../../components/color"),y=v("../../components/colorscale"),e=v("../../constants/numerical").BADNUM,n=v("../../lib/geojson_utils").makeBlank;J.exports=function(t){var a=t[0].trace,r=a.visible===!0&&a._length!==0,m=a._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:n()};if(!r)return m;var o,i=[],u=a.z,f=a.radius,l=g.isArrayOrTypedArray(u)&&u.length,h=g.isArrayOrTypedArray(f);for(o=0;o<t.length;o++){var d=t[o],s=d.lonlat;if(s[0]!==e){var x={};if(l){var c=d.z;x.z=c!==e?c:0}h&&(x.r=p(f[o])&&f[o]>0?+f[o]:0),i.push({type:"Feature",geometry:{type:"Point",coordinates:s},properties:x})}}var T=y.extractOpts(a),_=T.reversescale?y.flipScale(T.colorscale):T.colorscale,w=_[0][1],k=["interpolate",["linear"],["heatmap-density"],0,b.opacity(w)<1?w:b.addOpacity(w,0)];for(o=1;o<_.length;o++)k.push(_[o][0],_[o][1]);var L=["interpolate",["linear"],["get","z"],T.min,0,T.max,1];return g.extendFlat(m.heatmap.paint,{"heatmap-weight":l?L:1/(T.max-T.min),"heatmap-color":k,"heatmap-radius":h?{type:"identity",property:"r"}:a.radius,"heatmap-opacity":a.opacity}),m.geojson={type:"FeatureCollection",features:i},m.heatmap.layout.visibility="visible",m}},{"../../components/color":367,"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"fast-isnumeric":190}],774:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/colorscale/defaults"),b=v("./attributes");J.exports=function(y,e,n,t){function a(i,u){return p.coerce(y,e,b,i,u)}var r=a("lon")||[],m=a("lat")||[],o=Math.min(r.length,m.length);o?(e._length=o,a("z"),a("radius"),a("below"),a("text"),a("hovertext"),a("hovertemplate"),g(y,e,t,a,{prefix:"",cLetter:"z"})):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":771}],775:[function(v,J,Z){J.exports=function(p,g){return p.lon=g.lon,p.lat=g.lat,p.z=g.z,p}},{}],776:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("../scattermapbox/hover").hoverPoints,b=v("../scattermapbox/hover").getExtraText;J.exports=function(y,e,n){var t=g(y,e,n);if(t){var a=t[0],r=a.cd,m=r[0].trace,o=r[a.index];if(delete a.color,"z"in o){var i=a.subplot.mockAxis;a.z=o.z,a.zLabel=p.tickText(i,i.c2l(o.z),"hover").text}return a.extraText=b(m,o,r[0].t.labels),[a]}}},{"../../plots/cartesian/axes":566,"../scattermapbox/hover":1007}],777:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),formatLabels:v("../scattermapbox/format_labels"),calc:v("./calc"),plot:v("./plot"),hoverPoints:v("./hover"),eventData:v("./event_data"),getBelow:function(p,g){for(var b=g.getMapLayers(),y=0;y<b.length;y++){var e=b[y],n=e.id;if(e.type==="symbol"&&typeof n=="string"&&n.indexOf("plotly-")===-1)return n}},moduleType:"trace",name:"densitymapbox",basePlotModule:v("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":622,"../heatmap/colorbar":804,"../scattermapbox/format_labels":1006,"./attributes":771,"./calc":772,"./defaults":774,"./event_data":775,"./hover":776,"./plot":778}],778:[function(v,J,Z){var p=v("./convert"),g=v("../../plots/mapbox/constants").traceLayerPrefix;function b(e,n){this.type="densitymapbox",this.subplot=e,this.uid=n,this.sourceId="source-"+n,this.layerList=[["heatmap",g+n+"-heatmap"]],this.below=null}var y=b.prototype;y.update=function(e){var n=this.subplot,t=this.layerList,a=p(e),r=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(a.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(a,r),this.below=r);for(var m=0;m<t.length;m++){var o=t[m],i=o[0],u=o[1],f=a[i];n.setOptions(u,"setLayoutProperty",f.layout),f.layout.visibility==="visible"&&n.setOptions(u,"setPaintProperty",f.paint)}},y._addLayers=function(e,n){for(var t=this.subplot,a=this.layerList,r=this.sourceId,m=0;m<a.length;m++){var o=a[m],i=o[0],u=e[i];t.addLayer({type:i,id:o[1],source:r,layout:u.layout,paint:u.paint},n)}},y._removeLayers=function(){for(var e=this.subplot.map,n=this.layerList,t=n.length-1;t>=0;t--)e.removeLayer(n[t][1])},y.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},J.exports=function(e,n){var t=n[0].trace,a=new b(e,t.uid),r=a.sourceId,m=p(n),o=a.below=e.belowLookup["trace-"+t.uid];return e.map.addSource(r,{type:"geojson",data:m.geojson}),a._addLayers(m,o),a}},{"../../plots/mapbox/constants":620,"./convert":773}],779:[function(v,J,Z){var p=v("../../lib");J.exports=function(g,b){for(var y=0;y<g.length;y++)g[y].i=y;p.mergeArray(b.text,g,"tx"),p.mergeArray(b.hovertext,g,"htx");var e=b.marker;if(e){p.mergeArray(e.opacity,g,"mo"),p.mergeArray(e.color,g,"mc");var n=e.line;n&&(p.mergeArray(n.color,g,"mlc"),p.mergeArrayCastPositive(n.width,g,"mlw"))}}},{"../../lib":515}],780:[function(v,J,Z){var p,g=v("../bar/attributes"),b=v("../scatter/attributes").line,y=v("../../plots/attributes"),e=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,n=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../../plots/template_attributes").texttemplateAttrs,a=v("./constants"),r=v("../../lib/extend").extendFlat,m=v("../../components/color");J.exports={x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:e("x"),yhoverformat:e("y"),hovertext:g.hovertext,hovertemplate:n({},{keys:a.eventDataKeys}),hoverinfo:r({},y.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:t({editType:"plot"},{keys:a.eventDataKeys.concat(["label","value"])}),text:g.text,textposition:g.textposition,insidetextanchor:r({},g.insidetextanchor,{dflt:"middle"}),textangle:r({},g.textangle,{dflt:0}),textfont:g.textfont,insidetextfont:g.insidetextfont,outsidetextfont:g.outsidetextfont,constraintext:g.constraintext,cliponaxis:g.cliponaxis,orientation:r({},g.orientation,{}),offset:r({},g.offset,{arrayOk:!1}),width:r({},g.width,{arrayOk:!1}),marker:(p=r({},g.marker),delete p.pattern,p),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:r({},b.color,{dflt:m.defaultLine}),width:r({},b.width,{dflt:0,editType:"plot"}),dash:b.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":782}],781:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("../../plots/cartesian/align_period"),b=v("./arrays_to_calcdata"),y=v("../scatter/calc_selection"),e=v("../../constants/numerical").BADNUM;function n(t){return t===e?0:t}J.exports=function(t,a){var r,m,o,i,u,f,l,h,d=p.getFromId(t,a.xaxis||"x"),s=p.getFromId(t,a.yaxis||"y");a.orientation==="h"?(r=d.makeCalcdata(a,"x"),o=s.makeCalcdata(a,"y"),i=g(a,s,"y",o),u=!!a.yperiodalignment,f="y"):(r=s.makeCalcdata(a,"y"),o=d.makeCalcdata(a,"x"),i=g(a,d,"x",o),u=!!a.xperiodalignment,f="x"),m=i.vals;var x,c=Math.min(m.length,r.length),T=new Array(c);for(a._base=[],l=0;l<c;l++){r[l]<0&&(r[l]=e);var _=!1;r[l]!==e&&l+1<c&&r[l+1]!==e&&(_=!0),h=T[l]={p:m[l],s:r[l],cNext:_},a._base[l]=-.5*h.s,u&&(T[l].orig_p=o[l],T[l][f+"End"]=i.ends[l],T[l][f+"Start"]=i.starts[l]),a.ids&&(h.id=String(a.ids[l])),l===0&&(T[0].vTotal=0),T[0].vTotal+=n(h.s),h.begR=n(h.s)/n(T[0].s)}for(l=0;l<c;l++)(h=T[l]).s!==e&&(h.sumR=h.s/T[0].vTotal,h.difR=x!==void 0?h.s/x:1,x=h.s);return b(T,a),y(T,a),T}},{"../../constants/numerical":491,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":779}],782:[function(v,J,Z){J.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],783:[function(v,J,Z){var p=v("../bar/cross_trace_calc").setGroupPositions;J.exports=function(g,b){var y,e,n=g._fullLayout,t=g._fullData,a=g.calcdata,r=b.xaxis,m=b.yaxis,o=[],i=[],u=[];for(e=0;e<t.length;e++){var f=t[e],l=f.orientation==="h";f.visible===!0&&f.xaxis===r._id&&f.yaxis===m._id&&f.type==="funnel"&&(y=a[e],l?u.push(y):i.push(y),o.push(y))}var h={mode:n.funnelmode,norm:n.funnelnorm,gap:n.funnelgap,groupgap:n.funnelgroupgap};for(p(g,r,m,i,h),p(g,m,r,u,h),e=0;e<o.length;e++){y=o[e];for(var d=0;d<y.length;d++)d+1<y.length&&(y[d].nextP0=y[d+1].p0,y[d].nextS0=y[d+1].s0,y[d].nextP1=y[d+1].p1,y[d].nextS1=y[d+1].s1)}}},{"../bar/cross_trace_calc":660}],784:[function(v,J,Z){var p=v("../../lib"),g=v("../bar/defaults").handleGroupingDefaults,b=v("../bar/defaults").handleText,y=v("../scatter/xy_defaults"),e=v("../scatter/period_defaults"),n=v("./attributes"),t=v("../../components/color");J.exports={supplyDefaults:function(a,r,m,o){function i(h,d){return p.coerce(a,r,n,h,d)}if(y(a,r,o,i)){e(a,r,o,i),i("xhoverformat"),i("yhoverformat"),i("orientation",r.y&&!r.x?"v":"h"),i("offset"),i("width");var u=i("text");i("hovertext"),i("hovertemplate");var f=i("textposition");b(a,r,o,i,f,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),r.textposition==="none"||r.texttemplate||i("textinfo",Array.isArray(u)?"text+value":"value");var l=i("marker.color",m);i("marker.line.color",t.defaultLine),i("marker.line.width"),i("connector.visible")&&(i("connector.fillcolor",function(h){var d=p.isArrayOrTypedArray(h)?"#000":h;return t.addOpacity(d,.5*t.opacity(d))}(l)),i("connector.line.width")&&(i("connector.line.color"),i("connector.line.dash")))}else r.visible=!1},crossTraceDefaults:function(a,r){var m,o;function i(f){return p.coerce(o._input,o,n,f)}if(r.funnelmode==="group")for(var u=0;u<a.length;u++)m=(o=a[u])._input,g(m,o,r,i)}}},{"../../components/color":367,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":780}],785:[function(v,J,Z){J.exports=function(p,g){return p.x="xVal"in g?g.xVal:g.x,p.y="yVal"in g?g.yVal:g.y,"percentInitial"in g&&(p.percentInitial=g.percentInitial),"percentPrevious"in g&&(p.percentPrevious=g.percentPrevious),"percentTotal"in g&&(p.percentTotal=g.percentTotal),g.xa&&(p.xaxis=g.xa),g.ya&&(p.yaxis=g.ya),p}},{}],786:[function(v,J,Z){var p=v("../../components/color").opacity,g=v("../bar/hover").hoverOnBars,b=v("../../lib").formatPercent;J.exports=function(y,e,n,t,a){var r=g(y,e,n,t,a);if(r){var m=r.cd,o=m[0].trace,i=o.orientation==="h",u=m[r.index];r[(i?"x":"y")+"LabelVal"]=u.s,r.percentInitial=u.begR,r.percentInitialLabel=b(u.begR,1),r.percentPrevious=u.difR,r.percentPreviousLabel=b(u.difR,1),r.percentTotal=u.sumR,r.percentTotalLabel=b(u.sumR,1);var f=u.hi||o.hoverinfo,l=[];if(f&&f!=="none"&&f!=="skip"){var h=f==="all",d=f.split("+"),s=function(x){return h||d.indexOf(x)!==-1};s("percent initial")&&l.push(r.percentInitialLabel+" of initial"),s("percent previous")&&l.push(r.percentPreviousLabel+" of previous"),s("percent total")&&l.push(r.percentTotalLabel+" of total")}return r.extraText=l.join("<br>"),r.color=function(x,c){var T=x.marker,_=c.mc||T.color,w=c.mlc||T.line.color,k=c.mlw||T.line.width;if(p(_))return _;if(p(w)&&k)return w}(o,u),[r]}}},{"../../components/color":367,"../../lib":515,"../bar/hover":664}],787:[function(v,J,Z){J.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc"),plot:v("./plot"),style:v("./style").style,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":780,"./calc":781,"./cross_trace_calc":783,"./defaults":784,"./event_data":785,"./hover":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(v,J,Z){J.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],789:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes");J.exports=function(b,y,e){var n=!1;function t(m,o){return p.coerce(b,y,g,m,o)}for(var a=0;a<e.length;a++){var r=e[a];if(r.visible&&r.type==="funnel"){n=!0;break}}n&&(t("funnelmode"),t("funnelgap",.2),t("funnelgroupgap"))}},{"../../lib":515,"./layout_attributes":788}],790:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../components/drawing"),y=v("../../constants/numerical").BADNUM,e=v("../bar/plot"),n=v("../bar/uniform_text").clearMinTextSize;function t(a,r,m,o){var i=[],u=[],f=o?r:m,l=o?m:r;return i[0]=f.c2p(a.s0,!0),u[0]=l.c2p(a.p0,!0),i[1]=f.c2p(a.s1,!0),u[1]=l.c2p(a.p1,!0),i[2]=f.c2p(a.nextS0,!0),u[2]=l.c2p(a.nextP0,!0),i[3]=f.c2p(a.nextS1,!0),u[3]=l.c2p(a.nextP1,!0),o?[i,u]:[u,i]}J.exports=function(a,r,m,o){var i=a._fullLayout;n("funnel",i),function(u,f,l,h){var d=f.xaxis,s=f.yaxis;g.makeTraceGroups(h,l,"trace bars").each(function(x){var c=p.select(this),T=x[0].trace,_=g.ensureSingle(c,"g","regions");if(T.connector&&T.connector.visible){var w=T.orientation==="h",k=_.selectAll("g.region").data(g.identity);k.enter().append("g").classed("region",!0),k.exit().remove();var L=k.size();k.each(function(A,I){if(I===L-1||A.cNext){var P=t(A,d,s,w),S=P[0],E=P[1],D="";S[0]!==y&&E[0]!==y&&S[1]!==y&&E[1]!==y&&S[2]!==y&&E[2]!==y&&S[3]!==y&&E[3]!==y&&(D+=w?"M"+S[0]+","+E[1]+"L"+S[2]+","+E[2]+"H"+S[3]+"L"+S[1]+","+E[1]+"Z":"M"+S[1]+","+E[1]+"L"+S[2]+","+E[3]+"V"+E[2]+"L"+S[1]+","+E[0]+"Z"),D===""&&(D="M0,0Z"),g.ensureSingle(p.select(this),"path").attr("d",D).call(b.setClipUrl,f.layerClipId,u)}})}else _.remove()})}(a,r,m,o),function(u,f,l,h){var d=f.xaxis,s=f.yaxis;g.makeTraceGroups(h,l,"trace bars").each(function(x){var c=p.select(this),T=x[0].trace,_=g.ensureSingle(c,"g","lines");if(T.connector&&T.connector.visible&&T.connector.line.width){var w=T.orientation==="h",k=_.selectAll("g.line").data(g.identity);k.enter().append("g").classed("line",!0),k.exit().remove();var L=k.size();k.each(function(A,I){if(I===L-1||A.cNext){var P=t(A,d,s,w),S=P[0],E=P[1],D="";S[3]!==void 0&&E[3]!==void 0&&(w?(D+="M"+S[0]+","+E[1]+"L"+S[2]+","+E[2],D+="M"+S[1]+","+E[1]+"L"+S[3]+","+E[2]):(D+="M"+S[1]+","+E[1]+"L"+S[2]+","+E[3],D+="M"+S[1]+","+E[0]+"L"+S[2]+","+E[2])),D===""&&(D="M0,0Z"),g.ensureSingle(p.select(this),"path").attr("d",D).call(b.setClipUrl,f.layerClipId,u)}})}else _.remove()})}(a,r,m,o),e.plot(a,r,m,o,{mode:i.funnelmode,norm:i.funnelmode,gap:i.funnelgap,groupgap:i.funnelgroupgap})}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],791:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/drawing"),b=v("../../components/color"),y=v("../../constants/interactions").DESELECTDIM,e=v("../bar/style"),n=v("../bar/uniform_text").resizeText,t=e.styleTextPoints;J.exports={style:function(a,r,m){var o=m||p.select(a).selectAll("g.funnellayer").selectAll("g.trace");n(a,o,"funnel"),o.style("opacity",function(i){return i[0].trace.opacity}),o.each(function(i){var u=p.select(this),f=i[0].trace;u.selectAll(".point > path").each(function(l){if(!l.isBlank){var h=f.marker;p.select(this).call(b.fill,l.mc||h.color).call(b.stroke,l.mlc||h.line.color).call(g.dashLine,h.line.dash,l.mlw||h.line.width).style("opacity",f.selectedpoints&&!l.selected?y:1)}}),t(u,f,a),u.selectAll(".regions").each(function(){p.select(this).selectAll("path").style("stroke-width",0).call(b.fill,f.connector.fillcolor)}),u.selectAll(".lines").each(function(){var l=f.connector.line;g.lineGroupStyle(p.select(this).selectAll("path"),l.width,l.color,l.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],792:[function(v,J,Z){var p=v("../pie/attributes"),g=v("../../plots/attributes"),b=v("../../plots/domain").attributes,y=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../../plots/template_attributes").texttemplateAttrs,n=v("../../lib/extend").extendFlat;J.exports={labels:p.labels,label0:p.label0,dlabel:p.dlabel,values:p.values,marker:{colors:p.marker.colors,line:{color:n({},p.marker.line.color,{dflt:null}),width:n({},p.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:p.text,hovertext:p.hovertext,scalegroup:n({},p.scalegroup,{}),textinfo:n({},p.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:n({},g.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:y({},{keys:["label","color","value","text","percent"]}),textposition:n({},p.textposition,{values:["inside","none"],dflt:"inside"}),textfont:p.textfont,insidetextfont:p.insidetextfont,title:{text:p.title.text,font:p.title.font,position:n({},p.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:b({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910}],793:[function(v,J,Z){var p=v("../../plots/plots");Z.name="funnelarea",Z.plot=function(g,b,y,e){p.plotBasePlot(Z.name,g,b,y,e)},Z.clean=function(g,b,y,e){p.cleanBasePlot(Z.name,g,b,y,e)}},{"../../plots/plots":628}],794:[function(v,J,Z){var p=v("../pie/calc");J.exports={calc:function(g,b){return p.calc(g,b)},crossTraceCalc:function(g){p.crossTraceCalc(g,{type:"funnelarea"})}}},{"../pie/calc":912}],795:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes"),b=v("../../plots/domain").defaults,y=v("../bar/defaults").handleText,e=v("../pie/defaults").handleLabelsAndValues;J.exports=function(n,t,a,r){function m(x,c){return p.coerce(n,t,g,x,c)}var o=m("labels"),i=m("values"),u=e(o,i),f=u.len;if(t._hasLabels=u.hasLabels,t._hasValues=u.hasValues,!t._hasLabels&&t._hasValues&&(m("label0"),m("dlabel")),f){t._length=f,m("marker.line.width")&&m("marker.line.color",r.paper_bgcolor),m("marker.colors"),m("scalegroup");var l,h=m("text"),d=m("texttemplate");if(d||(l=m("textinfo",Array.isArray(h)?"text+percent":"percent")),m("hovertext"),m("hovertemplate"),d||l&&l!=="none"){var s=m("textposition");y(n,t,r,m,s,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}b(t,r,m),m("title.text")&&(m("title.position"),p.coerceFont(m,"title.font",r.font)),m("aspectratio"),m("baseratio")}else t.visible=!1}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"../pie/defaults":913,"./attributes":792}],796:[function(v,J,Z){J.exports={moduleType:"trace",name:"funnelarea",basePlotModule:v("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),style:v("./style"),styleOne:v("../pie/style_one"),meta:{}}},{"../pie/style_one":921,"./attributes":792,"./base_plot":793,"./calc":794,"./defaults":795,"./layout_attributes":797,"./layout_defaults":798,"./plot":799,"./style":800}],797:[function(v,J,Z){var p=v("../pie/layout_attributes").hiddenlabels;J.exports={hiddenlabels:p,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":917}],798:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes");J.exports=function(b,y){function e(n,t){return p.coerce(b,y,g,n,t)}e("hiddenlabels"),e("funnelareacolorway",y.colorway),e("extendfunnelareacolors")}},{"../../lib":515,"./layout_attributes":797}],799:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/drawing"),b=v("../../lib"),y=b.strScale,e=b.strTranslate,n=v("../../lib/svg_text_utils"),t=v("../bar/plot").toMoveInsideBar,a=v("../bar/uniform_text"),r=a.recordMinTextSize,m=a.clearMinTextSize,o=v("../pie/helpers"),i=v("../pie/plot"),u=i.attachFxHandlers,f=i.determineInsideTextFont,l=i.layoutAreas,h=i.prerenderTitles,d=i.positionTitleOutside,s=i.formatSliceLabel;function x(c,T){return"l"+(T[0]-c[0])+","+(T[1]-c[1])}J.exports=function(c,T){var _=c._fullLayout;m("funnelarea",_),h(T,c),l(T,_._size),b.makeTraceGroups(_._funnelarealayer,T,"trace").each(function(w){var k=p.select(this),L=w[0],A=L.trace;(function(I){if(!I.length)return;var P=I[0],S=P.trace,E=S.aspectratio,D=S.baseratio;D>.999&&(D=.999);var R,H=Math.pow(D,2),V=P.vTotal,X=V,$=V*H/(1-H)/V;function G(){var be,Ce={x:be=Math.sqrt($),y:-be};return[Ce.x,Ce.y]}var W,te,N=[];for(N.push(G()),W=I.length-1;W>-1;W--)if(!(te=I[W]).hidden){var B=te.v/X;$+=B,N.push(G())}var U=1/0,ee=-1/0;for(W=0;W<N.length;W++)R=N[W],U=Math.min(U,R[1]),ee=Math.max(ee,R[1]);for(W=0;W<N.length;W++)N[W][1]-=(ee+U)/2;var j=N[N.length-1][0],Q=P.r,K=(ee-U)/2,re=Q/j,ne=Q/K*E;for(P.r=ne*K,W=0;W<N.length;W++)N[W][0]*=re,N[W][1]*=ne;var le=[-(R=N[0])[0],R[1]],oe=[R[0],R[1]],de=0;for(W=I.length-1;W>-1;W--)if(!(te=I[W]).hidden){var se=N[de+=1][0],me=N[de][1];te.TL=[-se,me],te.TR=[se,me],te.BL=le,te.BR=oe,te.pxmid=(Te=te.TR,_e=te.BR,[.5*(Te[0]+_e[0]),.5*(Te[1]+_e[1])]),le=te.TL,oe=te.TR}var Te,_e})(w),k.each(function(){var I=p.select(this).selectAll("g.slice").data(w);I.enter().append("g").classed("slice",!0),I.exit().remove(),I.each(function(S,E){if(S.hidden)p.select(this).selectAll("path,g").remove();else{S.pointNumber=S.i,S.curveNumber=A.index;var D=L.cx,R=L.cy,H=p.select(this),V=H.selectAll("path.surface").data([S]);V.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),H.call(u,c,w);var X="M"+(D+S.TR[0])+","+(R+S.TR[1])+x(S.TR,S.BR)+x(S.BR,S.BL)+x(S.BL,S.TL)+"Z";V.attr("d",X),s(c,S,L);var $=o.castOption(A.textposition,S.pts),G=H.selectAll("g.slicetext").data(S.text&&$!=="none"?[0]:[]);G.enter().append("g").classed("slicetext",!0),G.exit().remove(),G.each(function(){var W=b.ensureSingle(p.select(this),"text","",function(K){K.attr("data-notex",1)}),te=b.ensureUniformFontSize(c,f(A,S,_.font));W.text(S.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(g.font,te).call(n.convertToTspans,c);var N,B,U,ee=g.bBox(W.node()),j=Math.min(S.BL[1],S.BR[1])+R,Q=Math.max(S.TL[1],S.TR[1])+R;B=Math.max(S.TL[0],S.BL[0])+D,U=Math.min(S.TR[0],S.BR[0])+D,(N=t(B,U,j,Q,ee,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=te.size,r(A.type,N,_),w[E].transform=N,W.attr("transform",b.getTextTransform(N))})}});var P=p.select(this).selectAll("g.titletext").data(A.title.text?[0]:[]);P.enter().append("g").classed("titletext",!0),P.exit().remove(),P.each(function(){var S=b.ensureSingle(p.select(this),"text","",function(R){R.attr("data-notex",1)}),E=A.title.text;A._meta&&(E=b.templateString(E,A._meta)),S.text(E).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(g.font,A.title.font).call(n.convertToTspans,c);var D=d(L,_._size);S.attr("transform",e(D.x,D.y)+y(Math.min(1,D.scale))+e(D.tx,D.ty))})})})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/plot":668,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"@plotly/d3":58}],800:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../pie/style_one"),b=v("../bar/uniform_text").resizeText;J.exports=function(y){var e=y._fullLayout._funnelarealayer.selectAll(".trace");b(y,e,"funnelarea"),e.each(function(n){var t=n[0].trace,a=p.select(this);a.style({opacity:t.opacity}),a.selectAll("path.surface").each(function(r){p.select(this).call(g,r,t)})})}},{"../bar/uniform_text":673,"../pie/style_one":921,"@plotly/d3":58}],801:[function(v,J,Z){var p=v("../scatter/attributes"),g=v("../../plots/attributes"),b=v("../../plots/font_attributes"),y=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../plots/template_attributes").hovertemplateAttrs,n=v("../../plots/template_attributes").texttemplateAttrs,t=v("../../components/colorscale/attributes"),a=v("../../lib/extend").extendFlat;J.exports=a({z:{valType:"data_array",editType:"calc"},x:a({},p.x,{impliedEdits:{xtype:"array"}}),x0:a({},p.x0,{impliedEdits:{xtype:"scaled"}}),dx:a({},p.dx,{impliedEdits:{xtype:"scaled"}}),y:a({},p.y,{impliedEdits:{ytype:"array"}}),y0:a({},p.y0,{impliedEdits:{ytype:"scaled"}}),dy:a({},p.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:a({},p.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:a({},p.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:a({},p.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:a({},p.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:a({},p.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:a({},p.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:y("x"),yhoverformat:y("y"),zhoverformat:y("z",1),hovertemplate:e(),texttemplate:n({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:b({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:a({},g.showlegend,{dflt:!1})},{transforms:void 0},t("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936}],802:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib"),b=v("../../plots/cartesian/axes"),y=v("../../plots/cartesian/align_period"),e=v("../histogram2d/calc"),n=v("../../components/colorscale/calc"),t=v("./convert_column_xyz"),a=v("./clean_2d_array"),r=v("./interp2d"),m=v("./find_empties"),o=v("./make_bound_array"),i=v("../../constants/numerical").BADNUM;function u(f){for(var l=[],h=f.length,d=0;d<h;d++){var s=f[d];s!==i&&l.push(s)}return l}J.exports=function(f,l){var h,d,s,x,c,T,_,w,k,L,A,I=b.getFromId(f,l.xaxis||"x"),P=b.getFromId(f,l.yaxis||"y"),S=p.traceIs(l,"contour"),E=p.traceIs(l,"histogram"),D=p.traceIs(l,"gl2d"),R=S?"best":l.zsmooth;if(I._minDtick=0,P._minDtick=0,E)x=(A=e(f,l)).orig_x,h=A.x,d=A.x0,s=A.dx,w=A.orig_y,c=A.y,T=A.y0,_=A.dy,k=A.z;else{var H=l.z;g.isArray1D(H)?(t(l,I,P,"x","y",["z"]),h=l._x,c=l._y,H=l._z):(x=l.x?I.makeCalcdata(l,"x"):[],w=l.y?P.makeCalcdata(l,"y"):[],h=y(l,I,"x",x).vals,c=y(l,P,"y",w).vals,l._x=h,l._y=c),d=l.x0,s=l.dx,T=l.y0,_=l.dy,k=a(H,l,I,P)}function V(K){R=l._input.zsmooth=l.zsmooth=!1,g.warn('cannot use zsmooth: "fast": '+K)}if((I.rangebreaks||P.rangebreaks)&&(k=function(K,re,ne){for(var le=[],oe=-1,de=0;de<ne.length;de++)if(re[de]!==i){oe++,le[oe]=[];for(var se=0;se<ne[de].length;se++)K[se]!==i&&le[oe].push(ne[de][se])}return le}(h,c,k),E||(h=u(h),c=u(c),l._x=h,l._y=c)),E||!S&&!l.connectgaps||(l._emptypoints=m(k),r(k,l._emptypoints)),R==="fast"){if(I.type==="log"||P.type==="log")V("log axis found");else if(!E){if(h.length){var X=(h[h.length-1]-h[0])/(h.length-1),$=Math.abs(X/100);for(L=0;L<h.length-1;L++)if(Math.abs(h[L+1]-h[L]-X)>$){V("x scale is not linear");break}}if(c.length&&R==="fast"){var G=(c[c.length-1]-c[0])/(c.length-1),W=Math.abs(G/100);for(L=0;L<c.length-1;L++)if(Math.abs(c[L+1]-c[L]-G)>W){V("y scale is not linear");break}}}}var te=g.maxRowLength(k),N=l.xtype==="scaled"?"":h,B=o(l,N,d,s,te,I),U=l.ytype==="scaled"?"":c,ee=o(l,U,T,_,k.length,P);D||(l._extremes[I._id]=b.findExtremes(I,B),l._extremes[P._id]=b.findExtremes(P,ee));var j={x:B,y:ee,z:k,text:l._text||l.text,hovertext:l._hovertext||l.hovertext};if(l.xperiodalignment&&x&&(j.orig_x=x),l.yperiodalignment&&w&&(j.orig_y=w),N&&N.length===B.length-1&&(j.xCenter=N),U&&U.length===ee.length-1&&(j.yCenter=U),E&&(j.xRanges=A.xRanges,j.yRanges=A.yRanges,j.pts=A.pts),S||n(f,l,{vals:k,cLetter:"z"}),S&&l.contours&&l.contours.coloring==="heatmap"){var Q={type:l.type==="contour"?"heatmap":"histogram2d",xcalendar:l.xcalendar,ycalendar:l.ycalendar};j.xfill=o(Q,N,d,s,te,I),j.yfill=o(Q,U,T,_,k.length,P)}return[j]}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../../registry":647,"../histogram2d/calc":835,"./clean_2d_array":803,"./convert_column_xyz":805,"./find_empties":807,"./interp2d":810,"./make_bound_array":812}],803:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("../../constants/numerical").BADNUM;J.exports=function(y,e,n,t){var a,r,m,o,i,u;function f(c){if(p(c))return+c}if(e&&e.transpose){for(a=0,i=0;i<y.length;i++)a=Math.max(a,y[i].length);if(a===0)return!1;m=function(c){return c.length},o=function(c,T,_){return(c[_]||[])[T]}}else a=y.length,m=function(c,T){return c[T].length},o=function(c,T,_){return(c[T]||[])[_]};var l=function(c,T,_){return T===b||_===b?b:o(c,T,_)};function h(c){if(e&&e.type!=="carpet"&&e.type!=="contourcarpet"&&c&&c.type==="category"&&e["_"+c._id.charAt(0)].length){var T=c._id.charAt(0),_={},w=e["_"+T+"CategoryMap"]||e[T];for(i=0;i<w.length;i++)_[w[i]]=i;return function(k){var L=_[c._categories[k]];return L+1?L:b}}return g.identity}var d=h(n),s=h(t);t&&t.type==="category"&&(a=t._categories.length);var x=new Array(a);for(i=0;i<a;i++)for(r=n&&n.type==="category"?n._categories.length:m(y,i),x[i]=new Array(r),u=0;u<r;u++)x[i][u]=f(l(y,s(i),d(u)));return x}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],804:[function(v,J,Z){J.exports={min:"zmin",max:"zmax"}},{}],805:[function(v,J,Z){var p=v("../../lib"),g=v("../../constants/numerical").BADNUM,b=v("../../plots/cartesian/align_period");J.exports=function(y,e,n,t,a,r){var m=y._length,o=e.makeCalcdata(y,t),i=n.makeCalcdata(y,a);o=b(y,e,t,o).vals,i=b(y,n,a,i).vals;var u,f,l,h,d=y.text,s=d!==void 0&&p.isArray1D(d),x=y.hovertext,c=x!==void 0&&p.isArray1D(x),T=p.distinctVals(o),_=T.vals,w=p.distinctVals(i),k=w.vals,L=[],A=k.length,I=_.length;for(u=0;u<r.length;u++)L[u]=p.init2dArray(A,I);s&&(l=p.init2dArray(A,I)),c&&(h=p.init2dArray(A,I));var P=p.init2dArray(A,I);for(u=0;u<m;u++)if(o[u]!==g&&i[u]!==g){var S=p.findBin(o[u]+T.minDiff/2,_),E=p.findBin(i[u]+w.minDiff/2,k);for(f=0;f<r.length;f++){var D=y[r[f]];L[f][E][S]=D[u],P[E][S]=u}s&&(l[E][S]=d[u]),c&&(h[E][S]=x[u])}for(y["_"+t]=_,y["_"+a]=k,f=0;f<r.length;f++)y["_"+r[f]]=L[f];s&&(y._text=l),c&&(y._hovertext=h),e&&e.type==="category"&&(y["_"+t+"CategoryMap"]=_.map(function(R){return e._categories[R]})),n&&n.type==="category"&&(y["_"+a+"CategoryMap"]=k.map(function(R){return n._categories[R]})),y._after2before=P}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563}],806:[function(v,J,Z){var p=v("../../lib"),g=v("./xyz_defaults"),b=v("./label_defaults"),y=v("../scatter/period_defaults"),e=v("./style_defaults"),n=v("../../components/colorscale/defaults"),t=v("./attributes");J.exports=function(a,r,m,o){function i(u,f){return p.coerce(a,r,t,u,f)}g(a,r,i,o)?(y(a,r,o,i),i("xhoverformat"),i("yhoverformat"),i("text"),i("hovertext"),i("hovertemplate"),b(i,o),e(a,r,i,o),i("hoverongaps"),i("connectgaps",p.isArray1D(r.z)&&r.zsmooth!==!1),n(a,r,o,i,{prefix:"",cLetter:"z"})):r.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../scatter/period_defaults":956,"./attributes":801,"./label_defaults":811,"./style_defaults":815,"./xyz_defaults":816}],807:[function(v,J,Z){var p=v("../../lib").maxRowLength;J.exports=function(g){var b,y,e,n,t,a,r,m,o=[],i={},u=[],f=g[0],l=[],h=[0,0,0],d=p(g);for(y=0;y<g.length;y++)for(b=l,l=f,f=g[y+1]||[],e=0;e<d;e++)l[e]===void 0&&((a=(l[e-1]!==void 0?1:0)+(l[e+1]!==void 0?1:0)+(b[e]!==void 0?1:0)+(f[e]!==void 0?1:0))?(y===0&&a++,e===0&&a++,y===g.length-1&&a++,e===l.length-1&&a++,a<4&&(i[[y,e]]=[y,e,a]),o.push([y,e,a])):u.push([y,e]));for(;u.length;){for(r={},m=!1,t=u.length-1;t>=0;t--)(a=((i[[(y=(n=u[t])[0])-1,e=n[1]]]||h)[2]+(i[[y+1,e]]||h)[2]+(i[[y,e-1]]||h)[2]+(i[[y,e+1]]||h)[2])/20)&&(r[n]=[y,e,a],u.splice(t,1),m=!0);if(!m)throw"findEmpties iterated with no new neighbors";for(n in r)i[n]=r[n],o.push(r[n])}return o.sort(function(s,x){return x[2]-s[2]})}},{"../../lib":515}],808:[function(v,J,Z){var p=v("../../components/fx"),g=v("../../lib"),b=v("../../plots/cartesian/axes"),y=v("../../components/colorscale").extractOpts;J.exports=function(e,n,t,a,r){r||(r={});var m,o,i,u,f=r.isContour,l=e.cd[0],h=l.trace,d=e.xa,s=e.ya,x=l.x,c=l.y,T=l.z,_=l.xCenter,w=l.yCenter,k=l.zmask,L=h.zhoverformat,A=x,I=c;if(e.index!==!1){try{i=Math.round(e.index[1]),u=Math.round(e.index[0])}catch{return void g.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index)}if(i<0||i>=T[0].length||u<0||u>T.length)return}else{if(p.inbox(n-x[0],n-x[x.length-1],0)>0||p.inbox(t-c[0],t-c[c.length-1],0)>0)return;if(f){var P;for(A=[2*x[0]-x[1]],P=1;P<x.length;P++)A.push((x[P]+x[P-1])/2);for(A.push([2*x[x.length-1]-x[x.length-2]]),I=[2*c[0]-c[1]],P=1;P<c.length;P++)I.push((c[P]+c[P-1])/2);I.push([2*c[c.length-1]-c[c.length-2]])}i=Math.max(0,Math.min(A.length-2,g.findBin(n,A))),u=Math.max(0,Math.min(I.length-2,g.findBin(t,I)))}var S,E,D=d.c2p(x[i]),R=d.c2p(x[i+1]),H=s.c2p(c[u]),V=s.c2p(c[u+1]);f?(S=l.orig_x||x,E=l.orig_y||c,R=D,m=S[i],V=H,o=E[u]):(S=l.orig_x||_||x,E=l.orig_y||w||c,m=_?S[i]:(S[i]+S[i+1])/2,o=w?E[u]:(E[u]+E[u+1])/2,d&&d.type==="category"&&(m=x[i]),s&&s.type==="category"&&(o=c[u]),h.zsmooth&&(D=R=d.c2p(m),H=V=s.c2p(o)));var X=T[u][i];if(k&&!k[u][i]&&(X=void 0),X!==void 0||h.hoverongaps){var $;Array.isArray(l.hovertext)&&Array.isArray(l.hovertext[u])?$=l.hovertext[u][i]:Array.isArray(l.text)&&Array.isArray(l.text[u])&&($=l.text[u][i]);var G=y(h),W={type:"linear",range:[G.min,G.max],hoverformat:L,_separators:d._separators,_numFormat:d._numFormat},te=b.tickText(W,X,"hover").text;return[g.extendFlat(e,{index:h._after2before?h._after2before[u][i]:[u,i],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:D,x1:R,y0:H,y1:V,xLabelVal:m,yLabelVal:o,zLabelVal:X,zLabel:te,text:$})]}}},{"../../components/colorscale":379,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],809:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),colorbar:v("./colorbar"),style:v("./style"),hoverPoints:v("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":801,"./calc":802,"./colorbar":804,"./defaults":806,"./hover":808,"./plot":813,"./style":814}],810:[function(v,J,Z){var p=v("../../lib"),g=[[-1,0],[1,0],[0,-1],[0,1]];function b(e){return .5-.25*Math.min(1,.5*e)}function y(e,n,t){var a,r,m,o,i,u,f,l,h,d,s,x,c,T=0;for(o=0;o<n.length;o++){for(r=(a=n[o])[0],m=a[1],s=e[r][m],d=0,h=0,i=0;i<4;i++)(f=e[r+(u=g[i])[0]])&&(l=f[m+u[1]])!==void 0&&(d===0?x=c=l:(x=Math.min(x,l),c=Math.max(c,l)),h++,d+=l);if(h===0)throw"iterateInterp2d order is wrong: no defined neighbors";e[r][m]=d/h,s===void 0?h<4&&(T=1):(e[r][m]=(1+t)*e[r][m]-t*s,c>x&&(T=Math.max(T,Math.abs(e[r][m]-s)/(c-x))))}return T}J.exports=function(e,n){var t,a=1;for(y(e,n),t=0;t<n.length&&!(n[t][2]<4);t++);for(n=n.slice(t),t=0;t<100&&a>.01;t++)a=y(e,n,b(a));return a>.01&&p.log("interp2d didn't converge quickly",a),e}},{"../../lib":515}],811:[function(v,J,Z){var p=v("../../lib");J.exports=function(g,b){g("texttemplate");var y=p.extendFlat({},b.font,{color:"auto",size:"auto"});p.coerceFont(g,"textfont",y)}},{"../../lib":515}],812:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib").isArrayOrTypedArray;J.exports=function(b,y,e,n,t,a){var r,m,o,i=[],u=p.traceIs(b,"contour"),f=p.traceIs(b,"histogram"),l=p.traceIs(b,"gl2d");if(g(y)&&y.length>1&&!f&&a.type!=="category"){var h=y.length;if(!(h<=t))return u?y.slice(0,t):y.slice(0,t+1);if(u||l)i=y.slice(0,t);else if(t===1)i=[y[0]-.5,y[0]+.5];else{for(i=[1.5*y[0]-.5*y[1]],o=1;o<h;o++)i.push(.5*(y[o-1]+y[o]));i.push(1.5*y[h-1]-.5*y[h-2])}if(h<t){var d=i[i.length-1],s=d-i[i.length-2];for(o=h;o<t;o++)d+=s,i.push(d)}}else{var x=b[a._id.charAt(0)+"calendar"];for(f?r=a.r2c(e,0,x):g(y)&&y.length===1?r=y[0]:e===void 0?r=0:r=(a.type==="log"?a.d2c:a.r2c)(e,0,x),m=n||1,o=u||l?0:-.5;o<t;o++)i.push(r+m*o)}return i}},{"../../lib":515,"../../registry":647}],813:[function(v,J,Z){var p=v("@plotly/d3"),g=v("tinycolor2"),b=v("../../registry"),y=v("../../components/drawing"),e=v("../../plots/cartesian/axes"),n=v("../../lib"),t=v("../../lib/svg_text_utils"),a=v("../scatter/format_labels"),r=v("../../components/color"),m=v("../../components/colorscale").extractOpts,o=v("../../components/colorscale").makeColorScaleFuncFromTrace,i=v("../../constants/xmlns_namespaces"),u=v("../../constants/alignment").LINE_SPACING;function f(x){return x.selectAll("g.heatmap-label")}function l(x){f(x).remove()}function h(x,c){var T=c.length-2,_=n.constrain(n.findBin(x,c),0,T),w=c[_],k=c[_+1],L=n.constrain(_+(x-w)/(k-w)-.5,0,T),A=Math.round(L),I=Math.abs(L-A);return L&&L!==T&&I?{bin0:A,frac:I,bin1:Math.round(A+I/(L-A))}:{bin0:A,bin1:A,frac:0}}function d(x,c){var T=c.length-1,_=n.constrain(n.findBin(x,c),0,T),w=c[_],k=(x-w)/(c[_+1]-w)||0;return k<=0?{bin0:_,bin1:_,frac:0}:k<.5?{bin0:_,bin1:_+1,frac:k}:{bin0:_+1,bin1:_,frac:1-k}}function s(x,c,T){x[c]=T[0],x[c+1]=T[1],x[c+2]=T[2],x[c+3]=Math.round(255*T[3])}J.exports=function(x,c,T,_){var w=c.xaxis,k=c.yaxis;n.makeTraceGroups(_,T,"hm").each(function(L){var A,I,P,S,E,D,R,H,V=p.select(this),X=L[0],$=X.trace,G=$.xgap||0,W=$.ygap||0,te=X.z,N=X.x,B=X.y,U=X.xCenter,ee=X.yCenter,j=b.traceIs($,"contour"),Q=j?"best":$.zsmooth,K=te.length,re=n.maxRowLength(te),ne=!1,le=!1;for(D=0;A===void 0&&D<N.length-1;)A=w.c2p(N[D]),D++;for(D=N.length-1;I===void 0&&D>0;)I=w.c2p(N[D]),D--;for(I<A&&(P=I,I=A,A=P,ne=!0),D=0;S===void 0&&D<B.length-1;)S=k.c2p(B[D]),D++;for(D=B.length-1;E===void 0&&D>0;)E=k.c2p(B[D]),D--;if(E<S&&(P=S,S=E,E=P,le=!0),j&&(U=N,ee=B,N=X.xfill,B=X.yfill),Q!=="fast"){var oe=Q==="best"?0:.5;A=Math.max(-oe*w._length,A),I=Math.min((1+oe)*w._length,I),S=Math.max(-oe*k._length,S),E=Math.min((1+oe)*k._length,E)}var de,se,me=Math.round(I-A),Te=Math.round(E-S);if(me<=0||Te<=0)return V.selectAll("image").data([]).exit().remove(),void l(V);Q==="fast"?(de=re,se=K):(de=me,se=Te);var _e=document.createElement("canvas");_e.width=de,_e.height=se;var be,Ce,fe=_e.getContext("2d"),ve=o($,{noNumericCheck:!0,returnArray:!0});Q==="fast"?(be=ne?function(vn){return re-1-vn}:n.identity,Ce=le?function(vn){return K-1-vn}:n.identity):(be=function(vn){return n.constrain(Math.round(w.c2p(N[vn])-A),0,me)},Ce=function(vn){return n.constrain(Math.round(k.c2p(B[vn])-S),0,Te)});var Me,ke,Le,ze,Re=Ce(0),Oe=[Re,Re],Ze=ne?0:1,Pe=le?0:1,Ie=0,Be=0,Fe=0,$e=0;function ot(vn,gn){if(vn!==void 0){var Sn=ve(vn);return Sn[0]=Math.round(Sn[0]),Sn[1]=Math.round(Sn[1]),Sn[2]=Math.round(Sn[2]),Ie+=gn,Be+=Sn[0]*gn,Fe+=Sn[1]*gn,$e+=Sn[2]*gn,Sn}return[0,0,0,0]}function pt(vn,gn,Sn,Xn){var Br=vn[Sn.bin0];if(Br===void 0)return ot(void 0,1);var pn,on=vn[Sn.bin1],Yr=gn[Sn.bin0],Nn=gn[Sn.bin1],Hn=on-Br||0,xn=Yr-Br||0;return pn=on===void 0?Nn===void 0?0:Yr===void 0?2*(Nn-Br):2*(2*Nn-Yr-Br)/3:Nn===void 0?Yr===void 0?0:2*(2*Br-on-Yr)/3:Yr===void 0?2*(2*Nn-on-Br)/3:Nn+Br-on-Yr,ot(Br+Sn.frac*Hn+Xn.frac*(xn+Sn.frac*pn))}if(Q){var _t,yt=0;try{_t=new Uint8Array(me*Te*4)}catch{_t=new Array(me*Te*4)}if(Q==="best"){var tt,Ke,vt,Nt=U||N,qt=ee||B,er=new Array(Nt.length),Jt=new Array(qt.length),ir=new Array(me),Ht=U?d:h,Ue=ee?d:h;for(D=0;D<Nt.length;D++)er[D]=Math.round(w.c2p(Nt[D])-A);for(D=0;D<qt.length;D++)Jt[D]=Math.round(k.c2p(qt[D])-S);for(D=0;D<me;D++)ir[D]=Ht(D,er);for(R=0;R<Te;R++)for(Ke=te[(tt=Ue(R,Jt)).bin0],vt=te[tt.bin1],D=0;D<me;D++,yt+=4)s(_t,yt,ze=pt(Ke,vt,ir[D],tt))}else for(R=0;R<K;R++)for(Le=te[R],Oe=Ce(R),D=0;D<me;D++)ze=ot(Le[D],1),s(_t,yt=4*(Oe*me+be(D)),ze);var We=fe.createImageData(me,Te);try{We.data.set(_t)}catch{var he=We.data,xe=he.length;for(R=0;R<xe;R++)he[R]=_t[R]}fe.putImageData(We,0,0)}else{var De=Math.floor(G/2),qe=Math.floor(W/2);for(R=0;R<K;R++)if(Le=te[R],Oe.reverse(),Oe[Pe]=Ce(R+1),Oe[0]!==Oe[1]&&Oe[0]!==void 0&&Oe[1]!==void 0)for(Me=[ke=be(0),ke],D=0;D<re;D++)Me.reverse(),Me[Ze]=be(D+1),Me[0]!==Me[1]&&Me[0]!==void 0&&Me[1]!==void 0&&(ze=ot(Le[D],(Me[1]-Me[0])*(Oe[1]-Oe[0])),fe.fillStyle="rgba("+ze.join(",")+")",fe.fillRect(Me[0]+De,Oe[0]+qe,Me[1]-Me[0]-G,Oe[1]-Oe[0]-W))}Be=Math.round(Be/Ie),Fe=Math.round(Fe/Ie),$e=Math.round($e/Ie);var Xe=g("rgb("+Be+","+Fe+","+$e+")");x._hmpixcount=(x._hmpixcount||0)+Ie,x._hmlumcount=(x._hmlumcount||0)+Ie*Xe.getLuminance();var He=V.selectAll("image").data(L);He.enter().append("svg:image").attr({xmlns:i.svg,preserveAspectRatio:"none"}),He.attr({height:Te,width:me,x:A,y:S,"xlink:href":_e.toDataURL("image/png")}),l(V);var st=$.texttemplate;if(st){var it=m($),Tt={type:"linear",range:[it.min,it.max],_separators:w._separators,_numFormat:w._numFormat},Pt=$.type==="histogram2dcontour",rt=$.type==="contour",ut=rt?K-1:K,Ft=rt?1:0,wt=rt?re-1:re,Lt=[];for(D=rt?1:0;D<ut;D++){var Ae;if(rt)Ae=X.y[D];else if(Pt){if(D===0||D===K-1)continue;Ae=X.y[D]}else if(X.yCenter)Ae=X.yCenter[D];else{if(D+1===K&&X.y[D+1]===void 0)continue;Ae=(X.y[D]+X.y[D+1])/2}var Ye=Math.round(k.c2p(Ae));if(!(0>Ye||Ye>k._length))for(R=Ft;R<wt;R++){var nt;if(rt)nt=X.x[R];else if(Pt){if(R===0||R===re-1)continue;nt=X.x[R]}else if(X.xCenter)nt=X.xCenter[R];else{if(R+1===re&&X.x[R+1]===void 0)continue;nt=(X.x[R]+X.x[R+1])/2}var ft=Math.round(w.c2p(nt));if(!(0>ft||ft>w._length)){var Mt=a({x:nt,y:Ae},$,x._fullLayout);Mt.x=nt,Mt.y=Ae;var Rt=X.z[D][R];Rt===void 0?(Mt.z="",Mt.zLabel=""):(Mt.z=Rt,Mt.zLabel=e.tickText(Tt,Rt,"hover").text);var Gt=X.text&&X.text[D]&&X.text[D][R];Gt!==void 0&&Gt!==!1||(Gt=""),Mt.text=Gt;var jt=n.texttemplateString(st,Mt,x._fullLayout._d3locale,Mt,$._meta||{});if(jt){var pr=jt.split("<br>"),Ar=pr.length,fr=0;for(H=0;H<Ar;H++)fr=Math.max(fr,pr[H].length);Lt.push({l:Ar,c:fr,t:jt,x:ft,y:Ye,z:Rt})}}}}var Zt=$.textfont,Qt=Zt.family,$t=Zt.size,hr=x._fullLayout.font.size;if(!$t||$t==="auto"){var vr=1/0,Mr=1/0,Nr=0,Ur=0;for(H=0;H<Lt.length;H++){var Jr=Lt[H];if(Nr=Math.max(Nr,Jr.l),Ur=Math.max(Ur,Jr.c),H<Lt.length-1){var mn=Lt[H+1],en=Math.abs(mn.x-Jr.x),In=Math.abs(mn.y-Jr.y);en&&(vr=Math.min(vr,en)),In&&(Mr=Math.min(Mr,In))}}isFinite(vr)&&isFinite(Mr)?(vr-=G,Mr-=W,vr/=Ur,Mr/=Nr,vr/=u/2,Mr/=u,$t=Math.min(Math.floor(vr),Math.floor(Mr),hr)):$t=hr}if($t<=0||!isFinite($t))return;f(V).data(Lt).enter().append("g").classed("heatmap-label",1).append("text").attr("text-anchor","middle").each(function(vn){var gn=p.select(this),Sn=Zt.color;Sn&&Sn!=="auto"||(Sn=r.contrast("rgba("+ve(vn.z).join()+")")),gn.attr("data-notex",1).call(t.positionText,function(Xn){return Xn.x}(vn),function(Xn){return Xn.y-$t*(Xn.l*u/2-1)}(vn)).call(y.font,Qt,$t,Sn).text(vn.t).call(t.convertToTspans,x)})}})}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"../../constants/alignment":483,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../scatter/format_labels":945,"@plotly/d3":58,tinycolor2:313}],814:[function(v,J,Z){var p=v("@plotly/d3");J.exports=function(g){p.select(g).selectAll(".hm image").style("opacity",function(b){return b.trace.opacity})}},{"@plotly/d3":58}],815:[function(v,J,Z){J.exports=function(p,g,b){b("zsmooth")===!1&&(b("xgap"),b("ygap")),b("zhoverformat")}},{}],816:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("../../registry");function y(e,n){var t=n(e);return(t?n(e+"type","array"):"scaled")==="scaled"&&(n(e+"0"),n("d"+e)),t}J.exports=function(e,n,t,a,r,m){var o,i,u=t("z");if(r=r||"x",m=m||"y",u===void 0||!u.length)return 0;if(g.isArray1D(e.z)){o=t(r),i=t(m);var f=g.minRowLength(o),l=g.minRowLength(i);if(f===0||l===0)return 0;n._length=Math.min(f,l,u.length)}else{if(o=y(r,t),i=y(m,t),!function(h){for(var d,s=!0,x=!1,c=!1,T=0;T<h.length;T++){if(d=h[T],!g.isArrayOrTypedArray(d)){s=!1;break}d.length>0&&(x=!0);for(var _=0;_<d.length;_++)if(p(d[_])){c=!0;break}}return s&&x&&c}(u))return 0;t("transpose"),n._length=null}return e.type==="heatmapgl"||b.getComponentMethod("calendars","handleTraceDefaults")(e,n,[r,m],a),!0}},{"../../lib":515,"../../registry":647,"fast-isnumeric":190}],817:[function(v,J,Z){for(var p=v("../heatmap/attributes"),g=v("../../components/colorscale/attributes"),b=v("../../lib/extend").extendFlat,y=v("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],n={},t=0;t<e.length;t++){var a=e[t];n[a]=p[a]}n.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},b(n,g("",{cLetter:"z",autoColorDflt:!1})),J.exports=y(n,"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../heatmap/attributes":801}],818:[function(v,J,Z){var p=v("../../../stackgl_modules").gl_heatmap2d,g=v("../../plots/cartesian/axes"),b=v("../../lib/str2rgbarray");function y(n,t){this.scene=n,this.uid=t,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=p(n.glplot,this.options),this.heatmap._trace=this}var e=y.prototype;e.handlePick=function(n){var t=this.options,a=t.shape,r=n.pointId,m=r%a[0],o=Math.floor(r/a[0]),i=r;return{trace:this,dataCoord:n.dataCoord,traceCoord:[t.x[m],t.y[o],t.z[i]],textLabel:this.textLabels[r],name:this.name,pointIndex:[o,m],hoverinfo:this.hoverinfo}},e.update=function(n,t){var a=t[0];this.index=n.index,this.name=n.name,this.hoverinfo=n.hoverinfo;var r=a.z;this.options.z=[].concat.apply([],r);var m=r[0].length,o=r.length;this.options.shape=[m,o],this.options.x=a.x,this.options.y=a.y,this.options.zsmooth=n.zsmooth;var i=function(d){for(var s=d.colorscale,x=d.zmin,c=d.zmax,T=s.length,_=new Array(T),w=new Array(4*T),k=0;k<T;k++){var L=s[k],A=b(L[1]);_[k]=x+L[0]*(c-x);for(var I=0;I<4;I++)w[4*k+I]=A[I]}return{colorLevels:_,colorValues:w}}(n);this.options.colorLevels=i.colorLevels,this.options.colorValues=i.colorValues,this.textLabels=[].concat.apply([],n.text),this.heatmap.update(this.options);var u,f,l=this.scene.xaxis,h=this.scene.yaxis;n.zsmooth===!1&&(u={ppad:a.x[1]-a.x[0]},f={ppad:a.y[1]-a.y[0]}),n._extremes[l._id]=g.findExtremes(l,a.x,u),n._extremes[h._id]=g.findExtremes(h,a.y,f)},e.dispose=function(){this.heatmap.dispose()},J.exports=function(n,t,a){var r=new y(n,t.uid);return r.update(t,a),r}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566}],819:[function(v,J,Z){var p=v("../../lib"),g=v("../heatmap/xyz_defaults"),b=v("../../components/colorscale/defaults"),y=v("./attributes");J.exports=function(e,n,t,a){function r(m,o){return p.coerce(e,n,y,m,o)}g(e,n,r,a)?(r("text"),r("zsmooth"),b(e,n,a,r,{prefix:"",cLetter:"z"})):n.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/xyz_defaults":816,"./attributes":817}],820:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),calc:v("../heatmap/calc"),plot:v("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:v("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":605,"../heatmap/calc":802,"../heatmap/colorbar":804,"./attributes":817,"./convert":818,"./defaults":819}],821:[function(v,J,Z){var p=v("../bar/attributes"),g=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,b=v("../../plots/template_attributes").hovertemplateAttrs,y=v("../../plots/template_attributes").texttemplateAttrs,e=v("../../plots/font_attributes"),n=v("./bin_attributes"),t=v("./constants"),a=v("../../lib/extend").extendFlat;J.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:g("x"),yhoverformat:g("y"),text:a({},p.text,{}),hovertext:a({},p.hovertext,{}),orientation:p.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:n("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:n("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:b({},{keys:t.eventDataKeys}),texttemplate:y({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:a({},p.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:p.insidetextanchor,textangle:p.textangle,cliponaxis:p.cliponaxis,constraintext:p.constraintext,marker:p.marker,offsetgroup:p.offsetgroup,alignmentgroup:p.alignmentgroup,selected:p.selected,unselected:p.unselected,_deprecated:{bardir:p._deprecated.bardir}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../bar/attributes":657,"./bin_attributes":823,"./constants":827}],822:[function(v,J,Z){J.exports=function(p,g){for(var b=p.length,y=0,e=0;e<b;e++)g[e]?(p[e]/=g[e],y+=p[e]):p[e]=null;return y}},{}],823:[function(v,J,Z){J.exports=function(p,g){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],824:[function(v,J,Z){var p=v("fast-isnumeric");J.exports={count:function(g,b,y){return y[g]++,1},sum:function(g,b,y,e){var n=e[b];return p(n)?(n=Number(n),y[g]+=n,n):0},avg:function(g,b,y,e,n){var t=e[b];return p(t)&&(t=Number(t),y[g]+=t,n[g]++),0},min:function(g,b,y,e){var n=e[b];if(p(n)){if(n=Number(n),!p(y[g]))return y[g]=n,n;if(y[g]>n){var t=n-y[g];return y[g]=n,t}}return 0},max:function(g,b,y,e){var n=e[b];if(p(n)){if(n=Number(n),!p(y[g]))return y[g]=n,n;if(y[g]<n){var t=n-y[g];return y[g]=n,t}}return 0}}},{"fast-isnumeric":190}],825:[function(v,J,Z){var p=v("../../constants/numerical"),g=p.ONEAVGYEAR,b=p.ONEAVGMONTH,y=p.ONEDAY,e=p.ONEHOUR,n=p.ONEMIN,t=p.ONESEC,a=v("../../plots/cartesian/axes").tickIncrement;function r(u,f,l,h){if(u*f<=0)return 1/0;for(var d=Math.abs(f-u),s=l.type==="date",x=m(d,s),c=0;c<10;c++){var T=m(80*x,s);if(x===T||!o(T,u,f,s,l,h))break;x=T}return x}function m(u,f){return f&&u>t?u>y?u>1.1*g?g:u>1.1*b?b:y:u>e?e:u>n?n:t:Math.pow(10,Math.floor(Math.log(u)/Math.LN10))}function o(u,f,l,h,d,s){if(h&&u>y){var x=i(f,d,s),c=i(l,d,s),T=u===g?0:1;return x[T]!==c[T]}return Math.floor(l/u)-Math.floor(f/u)>.1}function i(u,f,l){var h=f.c2d(u,g,l).split("-");return h[0]===""&&(h.unshift(),h[0]="-"+h[0]),h}J.exports=function(u,f,l,h,d){var s,x,c=-1.1*f,T=-.1*f,_=u-T,w=l[0],k=l[1],L=Math.min(r(w+T,w+_,h,d),r(k+T,k+_,h,d)),A=Math.min(r(w+c,w+T,h,d),r(k+c,k+T,h,d));if(L>A&&A<Math.abs(k-w)/4e3?(s=L,x=!1):(s=Math.min(L,A),x=!0),h.type==="date"&&s>y){var I=s===g?1:6,P=s===g?"M12":"M1";return function(S,E){var D=h.c2d(S,g,d),R=D.indexOf("-",I);R>0&&(D=D.substr(0,R));var H=h.d2c(D,0,d);if(H<S){var V=a(H,P,!1,d);(H+V)/2<S+u&&(H=V)}return E&&x?a(H,P,!0,d):H}}return function(S,E){var D=s*Math.round(S/s);return D+s/10<S&&D+.9*s<S+u&&(D+=s),E&&x&&(D-=s),D}}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566}],826:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("../../registry"),y=v("../../plots/cartesian/axes"),e=v("../bar/arrays_to_calcdata"),n=v("./bin_functions"),t=v("./norm_functions"),a=v("./average"),r=v("./bin_label_vals");function m(o,i,u,f,l){var h,d,s,x,c,T,_,w=f+"bins",k=o._fullLayout,L=i["_"+f+"bingroup"],A=k._histogramBinOpts[L],I=k.barmode==="overlay",P=function(se){return u.r2c(se,0,x)},S=function(se){return u.c2r(se,0,x)},E=u.type==="date"?function(se){return se||se===0?g.cleanDate(se,null,x):null}:function(se){return p(se)?Number(se):null};function D(se,me,Te){me[se+"Found"]?(me[se]=E(me[se]),me[se]===null&&(me[se]=Te[se])):(T[se]=me[se]=Te[se],g.nestedProperty(d[0],w+"."+se).set(Te[se]))}if(i["_"+f+"autoBinFinished"])delete i["_"+f+"autoBinFinished"];else{d=A.traces;var R=[],H=!0,V=!1,X=!1;for(h=0;h<d.length;h++)if((s=d[h]).visible){var $=A.dirs[h];c=s["_"+$+"pos0"]=u.makeCalcdata(s,$),R=g.concat(R,c),delete s["_"+f+"autoBinFinished"],i.visible===!0&&(H?H=!1:(delete s._autoBin,s["_"+f+"autoBinFinished"]=1),b.traceIs(s,"2dMap")&&(V=!0),s.type==="histogram2dcontour"&&(X=!0))}x=d[0][f+"calendar"];var G=y.autoBin(R,u,A.nbins,V,x,A.sizeFound&&A.size),W=d[0]._autoBin={};if(T=W[A.dirs[0]]={},X&&(A.size||(G.start=S(y.tickIncrement(P(G.start),G.size,!0,x))),A.end===void 0&&(G.end=S(y.tickIncrement(P(G.end),G.size,!1,x)))),I&&!b.traceIs(i,"2dMap")&&G._dataSpan===0&&u.type!=="category"&&u.type!=="multicategory"){if(l)return[G,c,!0];G=function(se,me,Te,_e,be){var Ce,fe,ve,Me=se._fullLayout,ke=function(pt,_t){for(var yt=_t.xaxis,tt=_t.yaxis,Ke=_t.orientation,vt=[],Nt=pt._fullData,qt=0;qt<Nt.length;qt++){var er=Nt[qt];er.type==="histogram"&&er.visible===!0&&er.orientation===Ke&&er.xaxis===yt&&er.yaxis===tt&&vt.push(er)}return vt}(se,me),Le=!1,ze=1/0,Re=[me];for(Ce=0;Ce<ke.length;Ce++)if((fe=ke[Ce])===me)Le=!0;else if(Le){var Oe=m(se,fe,Te,_e,!0),Ze=Oe[0],Pe=Oe[2];fe["_"+_e+"autoBinFinished"]=1,fe["_"+_e+"pos0"]=Oe[1],Pe?Re.push(fe):ze=Math.min(ze,Ze.size)}else ve=Me._histogramBinOpts[fe["_"+_e+"bingroup"]],ze=Math.min(ze,ve.size||fe[be].size);var Ie=new Array(Re.length);for(Ce=0;Ce<Re.length;Ce++)for(var Be=Re[Ce]["_"+_e+"pos0"],Fe=0;Fe<Be.length;Fe++)if(Be[Fe]!==void 0){Ie[Ce]=Be[Fe];break}for(isFinite(ze)||(ze=g.distinctVals(Ie).minDiff),Ce=0;Ce<Re.length;Ce++){var $e=(fe=Re[Ce])[_e+"calendar"],ot={start:Te.c2r(Ie[Ce]-ze/2,0,$e),end:Te.c2r(Ie[Ce]+ze/2,0,$e),size:ze};fe._input[be]=fe[be]=ot,(ve=Me._histogramBinOpts[fe["_"+_e+"bingroup"]])&&g.extendFlat(ve,ot)}return me[be]}(o,i,u,f,w)}(_=s.cumulative||{}).enabled&&_.currentbin!=="include"&&(_.direction==="decreasing"?G.start=S(y.tickIncrement(P(G.start),G.size,!0,x)):G.end=S(y.tickIncrement(P(G.end),G.size,!1,x))),A.size=G.size,A.sizeFound||(T.size=G.size,g.nestedProperty(d[0],w+".size").set(G.size)),D("start",A,G),D("end",A,G)}c=i["_"+f+"pos0"],delete i["_"+f+"pos0"];var te=i._input[w]||{},N=g.extendFlat({},A),B=A.start,U=u.r2l(te.start),ee=U!==void 0;if((A.startFound||ee)&&U!==u.r2l(B)){var j=ee?U:g.aggNums(Math.min,null,c),Q={type:u.type==="category"||u.type==="multicategory"?"linear":u.type,r2l:u.r2l,dtick:A.size,tick0:B,calendar:x,range:[j,y.tickIncrement(j,A.size,!1,x)].map(u.l2r)},K=y.tickFirst(Q);K>u.r2l(j)&&(K=y.tickIncrement(K,A.size,!0,x)),N.start=u.l2r(K),ee||g.nestedProperty(i,w+".start").set(N.start)}var re=A.end,ne=u.r2l(te.end),le=ne!==void 0;if((A.endFound||le)&&ne!==u.r2l(re)){var oe=le?ne:g.aggNums(Math.max,null,c);N.end=u.l2r(oe),le||g.nestedProperty(i,w+".start").set(N.end)}var de="autobin"+f;return i._input[de]===!1&&(i._input[w]=g.extendFlat({},i[w]||{}),delete i._input[de],delete i[de]),[N,c]}J.exports={calc:function(o,i){var u,f,l,h,d=[],s=[],x=i.orientation==="h",c=y.getFromId(o,x?i.yaxis:i.xaxis),T=x?"y":"x",_={x:"y",y:"x"}[T],w=i[T+"calendar"],k=i.cumulative,L=m(o,i,c,T),A=L[0],I=L[1],P=typeof A.size=="string",S=[],E=P?S:A,D=[],R=[],H=[],V=0,X=i.histnorm,$=i.histfunc,G=X.indexOf("density")!==-1;k.enabled&&G&&(X=X.replace(/ ?density$/,""),G=!1);var W,te=$==="max"||$==="min"?null:0,N=n.count,B=t[X],U=!1,ee=function(fe){return c.r2c(fe,0,w)};for(g.isArrayOrTypedArray(i[_])&&$!=="count"&&(W=i[_],U=$==="avg",N=n[$]),u=ee(A.start),l=ee(A.end)+(u-y.tickIncrement(u,A.size,!1,w))/1e6;u<l&&d.length<1e6&&(f=y.tickIncrement(u,A.size,!1,w),d.push((u+f)/2),s.push(te),H.push([]),S.push(u),G&&D.push(1/(f-u)),U&&R.push(0),!(f<=u));)u=f;S.push(u),P||c.type!=="date"||(E={start:ee(E.start),end:ee(E.end),size:E.size}),o._fullLayout._roundFnOpts||(o._fullLayout._roundFnOpts={});var j=i["_"+T+"bingroup"],Q={leftGap:1/0,rightGap:1/0};j&&(o._fullLayout._roundFnOpts[j]||(o._fullLayout._roundFnOpts[j]=Q),Q=o._fullLayout._roundFnOpts[j]);var K,re=s.length,ne=!0,le=Q.leftGap,oe=Q.rightGap,de={};for(u=0;u<I.length;u++){var se=I[u];(h=g.findBin(se,E))>=0&&h<re&&(V+=N(h,u,s,W,R),ne&&H[h].length&&se!==I[H[h][0]]&&(ne=!1),H[h].push(u),de[u]=h,le=Math.min(le,se-S[h]),oe=Math.min(oe,S[h+1]-se))}Q.leftGap=le,Q.rightGap=oe,ne||(K=function(fe,ve){return function(){var Me=o._fullLayout._roundFnOpts[j];return r(Me.leftGap,Me.rightGap,S,c,w)(fe,ve)}}),U&&(V=a(s,R)),B&&B(s,V,D),k.enabled&&function(fe,ve,Me){var ke,Le,ze;function Re(Ze){ze=fe[Ze],fe[Ze]/=2}function Oe(Ze){Le=fe[Ze],fe[Ze]=ze+Le/2,ze+=Le}if(Me==="half")if(ve==="increasing")for(Re(0),ke=1;ke<fe.length;ke++)Oe(ke);else for(Re(fe.length-1),ke=fe.length-2;ke>=0;ke--)Oe(ke);else if(ve==="increasing"){for(ke=1;ke<fe.length;ke++)fe[ke]+=fe[ke-1];Me==="exclude"&&(fe.unshift(0),fe.pop())}else{for(ke=fe.length-2;ke>=0;ke--)fe[ke]+=fe[ke+1];Me==="exclude"&&(fe.push(0),fe.shift())}}(s,k.direction,k.currentbin);var me=Math.min(d.length,s.length),Te=[],_e=0,be=me-1;for(u=0;u<me;u++)if(s[u]){_e=u;break}for(u=me-1;u>=_e;u--)if(s[u]){be=u;break}for(u=_e;u<=be;u++)if(p(d[u])&&p(s[u])){var Ce={p:d[u],s:s[u],b:0};k.enabled||(Ce.pts=H[u],ne?Ce.ph0=Ce.ph1=H[u].length?I[H[u][0]]:d[u]:(i._computePh=!0,Ce.ph0=K(S[u]),Ce.ph1=K(S[u+1],!0))),Te.push(Ce)}return Te.length===1&&(Te[0].width1=y.tickIncrement(Te[0].p,A.size,!1,w)-Te[0].p),e(Te,i),g.isArrayOrTypedArray(i.selectedpoints)&&g.tagSelected(Te,i,de),Te},calcAllAutoBins:m}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"../bar/arrays_to_calcdata":656,"./average":822,"./bin_functions":824,"./bin_label_vals":825,"./norm_functions":833,"fast-isnumeric":190}],827:[function(v,J,Z){J.exports={eventDataKeys:["binNumber"]}},{}],828:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axis_ids"),b=v("../../registry").traceIs,y=v("../bar/defaults").handleGroupingDefaults,e=p.nestedProperty,n=v("../../plots/cartesian/constraints").getAxisGroup,t=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],a=["x","y"];J.exports=function(r,m){var o,i,u,f,l,h,d,s=m._histogramBinOpts={},x=[],c={},T=[];function _(G,W){return p.coerce(o._input,o,o._module.attributes,G,W)}function w(G){return G.orientation==="v"?"x":"y"}function k(G,W,te){var N=G.uid+"__"+te;W||(W=N);var B=function(Q,K){return g.getFromTrace({_fullLayout:m},Q,K).type}(G,te),U=G[te+"calendar"]||"",ee=s[W],j=!0;ee&&(B===ee.axType&&U===ee.calendar?(j=!1,ee.traces.push(G),ee.dirs.push(te)):(W=N,B!==ee.axType&&p.warn(["Attempted to group the bins of trace",G.index,"set on a","type:"+B,"axis","with bins on","type:"+ee.axType,"axis."].join(" ")),U!==ee.calendar&&p.warn(["Attempted to group the bins of trace",G.index,"set with a",U,"calendar","with bins",ee.calendar?"on a "+ee.calendar+" calendar":"w/o a set calendar"].join(" ")))),j&&(s[W]={traces:[G],dirs:[te],axType:B,calendar:G[te+"calendar"]||""}),G["_"+te+"bingroup"]=W}for(l=0;l<r.length;l++)o=r[l],b(o,"histogram")&&(x.push(o),delete o._xautoBinFinished,delete o._yautoBinFinished,b(o,"2dMap")||y(o._input,o,m,_));var L=m._alignmentOpts||{};for(l=0;l<x.length;l++){if(o=x[l],u="",!b(o,"2dMap")){if(f=w(o),m.barmode==="group"&&o.alignmentgroup){var A=o[f+"axis"],I=n(m,A)+o.orientation;(L[I]||{})[o.alignmentgroup]&&(u=I)}u||m.barmode==="overlay"||(u=n(m,o.xaxis)+n(m,o.yaxis)+w(o))}u?(c[u]||(c[u]=[]),c[u].push(o)):T.push(o)}for(u in c)if((i=c[u]).length!==1){var P=!1;for(i.length&&(o=i[0],P=_("bingroup")),u=P||u,l=0;l<i.length;l++){var S=(o=i[l])._input.bingroup;S&&S!==u&&p.warn(["Trace",o.index,"must match","within bingroup",u+".","Ignoring its bingroup:",S,"setting."].join(" ")),o.bingroup=u,k(o,u,w(o))}}else T.push(i[0]);for(l=0;l<T.length;l++){o=T[l];var E=_("bingroup");if(b(o,"2dMap"))for(d=0;d<2;d++){var D=_((f=a[d])+"bingroup",E?E+"__"+f:null);k(o,D,f)}else k(o,E,w(o))}for(u in s){var R=s[u];for(i=R.traces,h=0;h<t.length;h++){var H,V,X=t[h],$=X.name;if($!=="nbins"||!R.sizeFound){for(l=0;l<i.length;l++){if(o=i[l],f=R.dirs[l],H=X.aStr[f],e(o._input,H).get()!==void 0){R[$]=_(H),R[$+"Found"]=!0;break}(V=(o._autoBin||{})[f]||{})[$]&&e(o,H).set(V[$])}if($==="start"||$==="end")for(;l<i.length;l++)(o=i[l])["_"+f+"bingroup"]&&_(H,(V=(o._autoBin||{})[f]||{})[$]);$!=="nbins"||R.sizeFound||R.nbinsFound||(o=i[0],R[$]=_(H))}}}}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/cartesian/constraints":574,"../../registry":647,"../bar/defaults":661}],829:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib"),b=v("../../components/color"),y=v("../bar/defaults").handleText,e=v("../bar/style_defaults"),n=v("./attributes");J.exports=function(t,a,r,m){function o(T,_){return g.coerce(t,a,n,T,_)}var i=o("x"),u=o("y");o("cumulative.enabled")&&(o("cumulative.direction"),o("cumulative.currentbin")),o("text");var f=o("textposition");y(t,a,m,o,f,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),o("hovertext"),o("hovertemplate"),o("xhoverformat"),o("yhoverformat");var l=o("orientation",u&&!i?"h":"v"),h=l==="v"?"x":"y",d=l==="v"?"y":"x",s=i&&u?Math.min(g.minRowLength(i)&&g.minRowLength(u)):g.minRowLength(a[h]||[]);if(s){a._length=s,p.getComponentMethod("calendars","handleTraceDefaults")(t,a,["x","y"],m),a[d]&&o("histfunc"),o("histnorm"),o("autobin"+h),e(t,a,o,r,m),g.coerceSelectionMarkerOpacity(a,o);var x=(a.marker.line||{}).color,c=p.getComponentMethod("errorbars","supplyDefaults");c(t,a,x||b.defaultLine,{axis:"y"}),c(t,a,x||b.defaultLine,{axis:"x",inherit:"y"})}else a.visible=!1}},{"../../components/color":367,"../../lib":515,"../../registry":647,"../bar/defaults":661,"../bar/style_defaults":672,"./attributes":821}],830:[function(v,J,Z){J.exports=function(p,g,b,y,e){if(p.x="xVal"in g?g.xVal:g.x,p.y="yVal"in g?g.yVal:g.y,"zLabelVal"in g&&(p.z=g.zLabelVal),g.xa&&(p.xaxis=g.xa),g.ya&&(p.yaxis=g.ya),!(b.cumulative||{}).enabled){var n,t=Array.isArray(e)?y[0].pts[e[0]][e[1]]:y[e].pts;if(p.pointNumbers=t,p.binNumber=p.pointNumber,delete p.pointNumber,delete p.pointIndex,b._indexToPoints){n=[];for(var a=0;a<t.length;a++)n=n.concat(b._indexToPoints[t[a]])}else n=t;p.pointIndices=n}return p}},{}],831:[function(v,J,Z){var p=v("../bar/hover").hoverPoints,g=v("../../plots/cartesian/axes").hoverLabelText;J.exports=function(b,y,e,n,t){var a=p(b,y,e,n,t);if(a){var r=(b=a[0]).cd[b.index],m=b.cd[0].trace;if(!m.cumulative.enabled){var o=m.orientation==="h"?"y":"x";b[o+"Label"]=g(b[o+"a"],[r.ph0,r.ph1],m[o+"hoverformat"])}return a}}},{"../../plots/cartesian/axes":566,"../bar/hover":664}],832:[function(v,J,Z){J.exports={attributes:v("./attributes"),layoutAttributes:v("../bar/layout_attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("./cross_trace_defaults"),supplyLayoutDefaults:v("../bar/layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("../bar/cross_trace_calc").crossTraceCalc,plot:v("../bar/plot").plot,layerName:"barlayer",style:v("../bar/style").style,styleOnSelect:v("../bar/style").styleOnSelect,colorbar:v("../scatter/marker_colorbar"),hoverPoints:v("./hover"),selectPoints:v("../bar/select"),eventData:v("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../bar/cross_trace_calc":660,"../bar/layout_attributes":666,"../bar/layout_defaults":667,"../bar/plot":668,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"./attributes":821,"./calc":826,"./cross_trace_defaults":828,"./defaults":829,"./event_data":830,"./hover":831}],833:[function(v,J,Z){J.exports={percent:function(p,g){for(var b=p.length,y=100/g,e=0;e<b;e++)p[e]*=y},probability:function(p,g){for(var b=p.length,y=0;y<b;y++)p[y]/=g},density:function(p,g,b,y){var e=p.length;y=y||1;for(var n=0;n<e;n++)p[n]*=b[n]*y},"probability density":function(p,g,b,y){var e=p.length;y&&(g/=y);for(var n=0;n<e;n++)p[n]*=b[n]/g}}},{}],834:[function(v,J,Z){var p=v("../histogram/attributes"),g=v("../histogram/bin_attributes"),b=v("../heatmap/attributes"),y=v("../../plots/attributes"),e=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,n=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../../plots/template_attributes").texttemplateAttrs,a=v("../../components/colorscale/attributes"),r=v("../../lib/extend").extendFlat;J.exports=r({x:p.x,y:p.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:p.histnorm,histfunc:p.histfunc,nbinsx:p.nbinsx,xbins:g("x"),nbinsy:p.nbinsy,ybins:g("y"),autobinx:p.autobinx,autobiny:p.autobiny,bingroup:r({},p.bingroup,{}),xbingroup:r({},p.bingroup,{}),ybingroup:r({},p.bingroup,{}),xgap:b.xgap,ygap:b.ygap,zsmooth:b.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:n({},{keys:"z"}),texttemplate:t({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:b.textfont,showlegend:r({},y.showlegend,{dflt:!1})},a("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../heatmap/attributes":801,"../histogram/attributes":821,"../histogram/bin_attributes":823}],835:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes"),b=v("../histogram/bin_functions"),y=v("../histogram/norm_functions"),e=v("../histogram/average"),n=v("../histogram/bin_label_vals"),t=v("../histogram/calc").calcAllAutoBins;function a(o,i,u,f){var l,h=new Array(o);if(f)for(l=0;l<o;l++)h[l]=1/(i[l+1]-i[l]);else{var d=1/u;for(l=0;l<o;l++)h[l]=d}return h}function r(o,i){return{start:o(i.start),end:o(i.end),size:i.size}}function m(o,i,u,f,l,h){var d,s=o.length-1,x=new Array(s),c=n(u,f,o,l,h);for(d=0;d<s;d++){var T=(i||[])[d];x[d]=T===void 0?[c(o[d]),c(o[d+1],!0)]:[T,T]}return x}J.exports=function(o,i){var u,f,l,h,d=g.getFromId(o,i.xaxis),s=g.getFromId(o,i.yaxis),x=i.xcalendar,c=i.ycalendar,T=function(tt){return d.r2c(tt,0,x)},_=function(tt){return s.r2c(tt,0,c)},w=t(o,i,d,"x"),k=w[0],L=w[1],A=t(o,i,s,"y"),I=A[0],P=A[1],S=i._length;L.length>S&&L.splice(S,L.length-S),P.length>S&&P.splice(S,P.length-S);var E=[],D=[],R=[],H=typeof k.size=="string",V=typeof I.size=="string",X=[],$=[],G=H?X:k,W=V?$:I,te=0,N=[],B=[],U=i.histnorm,ee=i.histfunc,j=U.indexOf("density")!==-1,Q=ee==="max"||ee==="min"?null:0,K=b.count,re=y[U],ne=!1,le=[],oe=[],de="z"in i?i.z:"marker"in i&&Array.isArray(i.marker.color)?i.marker.color:"";de&&ee!=="count"&&(ne=ee==="avg",K=b[ee]);var se=k.size,me=T(k.start),Te=T(k.end)+(me-g.tickIncrement(me,se,!1,x))/1e6;for(u=me;u<Te;u=g.tickIncrement(u,se,!1,x))D.push(Q),X.push(u),ne&&R.push(0);X.push(u);var _e,be=D.length,Ce=(u-me)/be,fe=(_e=me+Ce/2,d.c2r(_e,0,x)),ve=I.size,Me=_(I.start),ke=_(I.end)+(Me-g.tickIncrement(Me,ve,!1,c))/1e6;for(u=Me;u<ke;u=g.tickIncrement(u,ve,!1,c)){E.push(D.slice()),$.push(u);var Le=new Array(be);for(f=0;f<be;f++)Le[f]=[];B.push(Le),ne&&N.push(R.slice())}$.push(u);var ze=E.length,Re=(u-Me)/ze,Oe=function(tt){return s.c2r(tt,0,c)}(Me+Re/2);j&&(le=a(D.length,G,Ce,H),oe=a(E.length,W,Re,V)),H||d.type!=="date"||(G=r(T,G)),V||s.type!=="date"||(W=r(_,W));var Ze=!0,Pe=!0,Ie=new Array(be),Be=new Array(ze),Fe=1/0,$e=1/0,ot=1/0,pt=1/0;for(u=0;u<S;u++){var _t=L[u],yt=P[u];l=p.findBin(_t,G),h=p.findBin(yt,W),l>=0&&l<be&&h>=0&&h<ze&&(te+=K(l,u,E[h],de,N[h]),B[h][l].push(u),Ze&&(Ie[l]===void 0?Ie[l]=_t:Ie[l]!==_t&&(Ze=!1)),Pe&&(Be[h]===void 0?Be[h]=yt:Be[h]!==yt&&(Pe=!1)),Fe=Math.min(Fe,_t-X[l]),$e=Math.min($e,X[l+1]-_t),ot=Math.min(ot,yt-$[h]),pt=Math.min(pt,$[h+1]-yt))}if(ne)for(h=0;h<ze;h++)te+=e(E[h],N[h]);if(re)for(h=0;h<ze;h++)re(E[h],te,le,oe[h]);return{x:L,xRanges:m(X,Ze&&Ie,Fe,$e,d,x),x0:fe,dx:Ce,y:P,yRanges:m($,Pe&&Be,ot,pt,s,c),y0:Oe,dy:Re,z:E,pts:B}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../histogram/average":822,"../histogram/bin_functions":824,"../histogram/bin_label_vals":825,"../histogram/calc":826,"../histogram/norm_functions":833}],836:[function(v,J,Z){var p=v("../../lib"),g=v("./sample_defaults"),b=v("../heatmap/style_defaults"),y=v("../../components/colorscale/defaults"),e=v("../heatmap/label_defaults"),n=v("./attributes");J.exports=function(t,a,r,m){function o(i,u){return p.coerce(t,a,n,i,u)}g(t,a,o,m),a.visible!==!1&&(b(t,a,o,m),y(t,a,m,o,{prefix:"",cLetter:"z"}),o("hovertemplate"),e(o,m),o("xhoverformat"),o("yhoverformat"))}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/style_defaults":815,"./attributes":834,"./sample_defaults":839}],837:[function(v,J,Z){var p=v("../heatmap/hover"),g=v("../../plots/cartesian/axes").hoverLabelText;J.exports=function(b,y,e,n,t){var a=p(b,y,e,n,t);if(a){var r=(b=a[0]).index,m=r[0],o=r[1],i=b.cd[0],u=i.trace,f=i.xRanges[o],l=i.yRanges[m];return b.xLabel=g(b.xa,[f[0],f[1]],u.xhoverformat),b.yLabel=g(b.ya,[l[0],l[1]],u.yhoverformat),a}}},{"../../plots/cartesian/axes":566,"../heatmap/hover":808}],838:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../histogram/cross_trace_defaults"),calc:v("../heatmap/calc"),plot:v("../heatmap/plot"),layerName:"heatmaplayer",colorbar:v("../heatmap/colorbar"),style:v("../heatmap/style"),hoverPoints:v("./hover"),eventData:v("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../heatmap/calc":802,"../heatmap/colorbar":804,"../heatmap/plot":813,"../heatmap/style":814,"../histogram/cross_trace_defaults":828,"../histogram/event_data":830,"./attributes":834,"./defaults":836,"./hover":837}],839:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib");J.exports=function(b,y,e,n){var t=e("x"),a=e("y"),r=g.minRowLength(t),m=g.minRowLength(a);r&&m?(y._length=Math.min(r,m),p.getComponentMethod("calendars","handleTraceDefaults")(b,y,["x","y"],n),(e("z")||e("marker.color"))&&e("histfunc"),e("histnorm"),e("autobinx"),e("autobiny")):y.visible=!1}},{"../../lib":515,"../../registry":647}],840:[function(v,J,Z){var p=v("../histogram2d/attributes"),g=v("../contour/attributes"),b=v("../../components/colorscale/attributes"),y=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../lib/extend").extendFlat;J.exports=e({x:p.x,y:p.y,z:p.z,marker:p.marker,histnorm:p.histnorm,histfunc:p.histfunc,nbinsx:p.nbinsx,xbins:p.xbins,nbinsy:p.nbinsy,ybins:p.ybins,autobinx:p.autobinx,autobiny:p.autobiny,bingroup:p.bingroup,xbingroup:p.xbingroup,ybingroup:p.ybingroup,autocontour:g.autocontour,ncontours:g.ncontours,contours:g.contours,line:{color:g.line.color,width:e({},g.line.width,{dflt:.5}),dash:g.line.dash,smoothing:g.line.smoothing,editType:"plot"},xhoverformat:y("x"),yhoverformat:y("y"),zhoverformat:y("z",1),hovertemplate:p.hovertemplate,texttemplate:g.texttemplate,textfont:g.textfont},b("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../contour/attributes":744,"../histogram2d/attributes":834}],841:[function(v,J,Z){var p=v("../../lib"),g=v("../histogram2d/sample_defaults"),b=v("../contour/contours_defaults"),y=v("../contour/style_defaults"),e=v("../heatmap/label_defaults"),n=v("./attributes");J.exports=function(t,a,r,m){function o(i,u){return p.coerce(t,a,n,i,u)}g(t,a,o,m),a.visible!==!1&&(b(t,a,o,function(i){return p.coerce2(t,a,n,i)}),y(t,a,o,m),o("xhoverformat"),o("yhoverformat"),o("hovertemplate"),a.contours&&a.contours.coloring==="heatmap"&&e(o,m))}},{"../../lib":515,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/label_defaults":811,"../histogram2d/sample_defaults":839,"./attributes":840}],842:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../histogram/cross_trace_defaults"),calc:v("../contour/calc"),plot:v("../contour/plot").plot,layerName:"contourlayer",style:v("../contour/style"),colorbar:v("../contour/colorbar"),hoverPoints:v("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../contour/calc":745,"../contour/colorbar":747,"../contour/hover":757,"../contour/plot":762,"../contour/style":764,"../histogram/cross_trace_defaults":828,"./attributes":840,"./defaults":841}],843:[function(v,J,Z){var p=v("../../plots/template_attributes").hovertemplateAttrs,g=v("../../plots/template_attributes").texttemplateAttrs,b=v("../../components/colorscale/attributes"),y=v("../../plots/domain").attributes,e=v("../pie/attributes"),n=v("../sunburst/attributes"),t=v("../treemap/attributes"),a=v("../treemap/constants"),r=v("../../lib/extend").extendFlat;J.exports={labels:n.labels,parents:n.parents,values:n.values,branchvalues:n.branchvalues,count:n.count,level:n.level,maxdepth:n.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:t.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:r({colors:n.marker.colors,line:n.marker.line,editType:"calc"},b("marker",{colorAttr:"colors",anim:!1})),leaf:n.leaf,pathbar:t.pathbar,text:e.text,textinfo:n.textinfo,texttemplate:g({editType:"plot"},{keys:a.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:n.hoverinfo,hovertemplate:p({},{keys:a.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:t.outsidetextfont,textposition:t.textposition,sort:e.sort,root:n.root,domain:y({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"../treemap/attributes":1084,"../treemap/constants":1087}],844:[function(v,J,Z){var p=v("../../plots/plots");Z.name="icicle",Z.plot=function(g,b,y,e){p.plotBasePlot(Z.name,g,b,y,e)},Z.clean=function(g,b,y,e){p.cleanBasePlot(Z.name,g,b,y,e)}},{"../../plots/plots":628}],845:[function(v,J,Z){var p=v("../sunburst/calc");Z.calc=function(g,b){return p.calc(g,b)},Z.crossTraceCalc=function(g){return p._runCrossTraceCalc("icicle",g)}},{"../sunburst/calc":1060}],846:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes"),b=v("../../components/color"),y=v("../../plots/domain").defaults,e=v("../bar/defaults").handleText,n=v("../bar/constants").TEXTPAD,t=v("../../components/colorscale"),a=t.hasColorscale,r=t.handleDefaults;J.exports=function(m,o,i,u){function f(T,_){return p.coerce(m,o,g,T,_)}var l=f("labels"),h=f("parents");if(l&&l.length&&h&&h.length){var d=f("values");d&&d.length?f("branchvalues"):f("count"),f("level"),f("maxdepth"),f("tiling.orientation"),f("tiling.flip"),f("tiling.pad");var s=f("text");f("texttemplate"),o.texttemplate||f("textinfo",Array.isArray(s)?"text+label":"label"),f("hovertext"),f("hovertemplate");var x=f("pathbar.visible");e(m,o,u,f,"auto",{hasPathbar:x,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),f("textposition"),f("marker.line.width")&&f("marker.line.color",u.paper_bgcolor),f("marker.colors");var c=o._hasColorscale=a(m,"marker","colors")||(m.marker||{}).coloraxis;c&&r(m,o,u,f,{prefix:"marker.",cLetter:"c"}),f("leaf.opacity",c?1:.7),o._hovered={marker:{line:{width:2,color:b.contrast(u.paper_bgcolor)}}},x&&(f("pathbar.thickness",o.pathbar.textfont.size+2*n),f("pathbar.side"),f("pathbar.edgeshape")),f("sort"),f("root.color"),y(o,u,f),o._length=null}else o.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":843}],847:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../components/drawing"),y=v("../../lib/svg_text_utils"),e=v("./partition"),n=v("./style").styleOne,t=v("../treemap/constants"),a=v("../sunburst/helpers"),r=v("../sunburst/fx"),m=v("../sunburst/plot").formatSliceLabel;J.exports=function(o,i,u,f,l){var h=l.width,d=l.height,s=l.viewX,x=l.viewY,c=l.pathSlice,T=l.toMoveInsideSlice,_=l.strTransform,w=l.hasTransition,k=l.handleSlicesExit,L=l.makeUpdateSliceInterpolator,A=l.makeUpdateTextInterpolator,I=l.prevEntry,P=o._fullLayout,S=i[0].trace,E=S.textposition.indexOf("left")!==-1,D=S.textposition.indexOf("right")!==-1,R=S.textposition.indexOf("bottom")!==-1,H=e(u,[h,d],{flipX:S.tiling.flip.indexOf("x")>-1,flipY:S.tiling.flip.indexOf("y")>-1,orientation:S.tiling.orientation,pad:{inner:S.tiling.pad},maxDepth:S._maxDepth}).descendants(),V=1/0,X=-1/0;H.forEach(function(N){var B=N.depth;B>=S._maxDepth?(N.x0=N.x1=(N.x0+N.x1)/2,N.y0=N.y1=(N.y0+N.y1)/2):(V=Math.min(V,B),X=Math.max(X,B))}),f=f.data(H,a.getPtId),S._maxVisibleLayers=isFinite(X)?X-V+1:0,f.enter().append("g").classed("slice",!0),k(f,!1,{},[h,d],c),f.order();var $=null;if(w&&I){var G=a.getPtId(I);f.each(function(N){$===null&&a.getPtId(N)===G&&($={x0:N.x0,x1:N.x1,y0:N.y0,y1:N.y1})})}var W=function(){return $||{x0:0,x1:h,y0:0,y1:d}},te=f;return w&&(te=te.transition().each("end",function(){var N=p.select(this);a.setSliceCursor(N,o,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),te.each(function(N){N._x0=s(N.x0),N._x1=s(N.x1),N._y0=x(N.y0),N._y1=x(N.y1),N._hoverX=s(N.x1-S.tiling.pad),N._hoverY=x(R?N.y1-S.tiling.pad/2:N.y0+S.tiling.pad/2);var B=p.select(this),U=g.ensureSingle(B,"path","surface",function(K){K.style("pointer-events","all")});w?U.transition().attrTween("d",function(K){var re=L(K,!1,W(),[h,d],{orientation:S.tiling.orientation,flipX:S.tiling.flip.indexOf("x")>-1,flipY:S.tiling.flip.indexOf("y")>-1});return function(ne){return c(re(ne))}}):U.attr("d",c),B.call(r,u,o,i,{styleOne:n,eventDataKeys:t.eventDataKeys,transitionTime:t.CLICK_TRANSITION_TIME,transitionEasing:t.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,o,{isTransitioning:o._transitioning}),U.call(n,N,S,{hovered:!1}),N.x0===N.x1||N.y0===N.y1?N._text="":N._text=m(N,u,S,i,P)||"";var ee=g.ensureSingle(B,"g","slicetext"),j=g.ensureSingle(ee,"text","",function(K){K.attr("data-notex",1)}),Q=g.ensureUniformFontSize(o,a.determineTextFont(S,N,P.font));j.text(N._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":E?"start":"middle").call(b.font,Q).call(y.convertToTspans,o),N.textBB=b.bBox(j.node()),N.transform=T(N,{fontSize:Q.size}),N.transform.fontSize=Q.size,w?j.transition().attrTween("transform",function(K){var re=A(K,!1,W(),[h,d]);return function(ne){return _(re(ne))}}):j.attr("transform",_(N))}),$}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"../treemap/constants":1087,"./partition":851,"./style":853,"@plotly/d3":58}],848:[function(v,J,Z){J.exports={moduleType:"trace",name:"icicle",basePlotModule:v("./base_plot"),categories:[],animatable:!0,attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),style:v("./style").style,colorbar:v("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":843,"./base_plot":844,"./calc":845,"./defaults":846,"./layout_attributes":849,"./layout_defaults":850,"./plot":852,"./style":853}],849:[function(v,J,Z){J.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],850:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes");J.exports=function(b,y){function e(n,t){return p.coerce(b,y,g,n,t)}e("iciclecolorway",y.colorway),e("extendiciclecolors")}},{"../../lib":515,"./layout_attributes":849}],851:[function(v,J,Z){var p=v("d3-hierarchy"),g=v("../treemap/flip_tree");J.exports=function(b,y,e){var n=e.flipX,t=e.flipY,a=e.orientation==="h",r=e.maxDepth,m=y[0],o=y[1];r&&(m=(b.height+1)*y[0]/Math.min(b.height+1,r),o=(b.height+1)*y[1]/Math.min(b.height+1,r));var i=p.partition().padding(e.pad.inner).size(a?[y[1],m]:[y[0],o])(b);return(a||n||t)&&g(i,y,{swapXY:a,flipX:n,flipY:t}),i}},{"../treemap/flip_tree":1092,"d3-hierarchy":115}],852:[function(v,J,Z){var p=v("../treemap/draw"),g=v("./draw_descendants");J.exports=function(b,y,e,n){return p(b,y,e,n,{type:"icicle",drawDescendants:g})}},{"../treemap/draw":1089,"./draw_descendants":847}],853:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/color"),b=v("../../lib"),y=v("../bar/uniform_text").resizeText;function e(n,t,a){var r=t.data.data,m=!t.children,o=r.i,i=b.castOption(a,o,"marker.line.color")||g.defaultLine,u=b.castOption(a,o,"marker.line.width")||0;n.style("stroke-width",u).call(g.fill,r.color).call(g.stroke,i).style("opacity",m?a.leaf.opacity:null)}J.exports={style:function(n){var t=n._fullLayout._iciclelayer.selectAll(".trace");y(n,t,"icicle"),t.each(function(a){var r=p.select(this),m=a[0].trace;r.style("opacity",m.opacity),r.selectAll("path.surface").each(function(o){p.select(this).call(e,o,m)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],854:[function(v,J,Z){for(var p=v("../../plots/attributes"),g=v("../../plots/template_attributes").hovertemplateAttrs,b=v("../../lib/extend").extendFlat,y=v("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],n=[],t=[],a=0;a<e.length;a++){var r=y[e[a]];n.push("For the `"+e[a]+"` colormodel, it is ["+(r.zminDflt||r.min).join(", ")+"]."),t.push("For the `"+e[a]+"` colormodel, it is ["+(r.zmaxDflt||r.max).join(", ")+"].")}J.exports=b({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:b({},p.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:g({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"./constants":856}],855:[function(v,J,Z){var p=v("../../lib"),g=v("./constants"),b=v("fast-isnumeric"),y=v("../../plots/cartesian/axes"),e=v("../../lib").maxRowLength,n=v("./helpers").getImageSize;function t(r,m,o,i){return function(u){return p.constrain((u-r)*m,o,i)}}function a(r,m){return function(o){return p.constrain(o,r,m)}}J.exports=function(r,m){var o,i;if(m._hasZ)o=m.z.length,i=e(m.z);else if(m._hasSource){var u=n(m.source);o=u.height,i=u.width}var f,l=y.getFromId(r,m.xaxis||"x"),h=y.getFromId(r,m.yaxis||"y"),d=l.d2c(m.x0)-m.dx/2,s=h.d2c(m.y0)-m.dy/2,x=[d,d+i*m.dx],c=[s,s+o*m.dy];if(l&&l.type==="log")for(f=0;f<i;f++)x.push(d+f*m.dx);if(h&&h.type==="log")for(f=0;f<o;f++)c.push(s+f*m.dy);return m._extremes[l._id]=y.findExtremes(l,x),m._extremes[h._id]=y.findExtremes(h,c),m._scaler=function(T){var _=g.colormodel[T.colormodel],w=(_.colormodel||T.colormodel).length;T._sArray=[];for(var k=0;k<w;k++)_.min[k]!==T.zmin[k]||_.max[k]!==T.zmax[k]?T._sArray.push(t(T.zmin[k],(_.max[k]-_.min[k])/(T.zmax[k]-T.zmin[k]),_.min[k],_.max[k])):T._sArray.push(a(_.min[k],_.max[k]));return function(L){for(var A=L.slice(0,w),I=0;I<w;I++){var P=A[I];if(!b(P))return!1;A[I]=T._sArray[I](P)}return A}}(m),[{x0:d,y0:s,z:m.z,w:i,h:o}]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":856,"./helpers":859,"fast-isnumeric":190}],856:[function(v,J,Z){J.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(p){return p.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(p){return p.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(p){return p.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(p){var g=p.slice(0,3);return g[1]=g[1]+"%",g[2]=g[2]+"%",g},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(p){var g=p.slice(0,4);return g[1]=g[1]+"%",g[2]=g[2]+"%",g},suffix:["\xB0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],857:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes"),b=v("./constants"),y=v("../../snapshot/helpers").IMAGE_URL_PREFIX;J.exports=function(e,n){function t(m,o){return p.coerce(e,n,g,m,o)}t("source"),n.source&&!n.source.match(y)&&delete n.source,n._hasSource=!!n.source;var a,r=t("z");n._hasZ=!(r===void 0||!r.length||!r[0]||!r[0].length),n._hasZ||n._hasSource?(t("x0"),t("y0"),t("dx"),t("dy"),n._hasZ?(t("colormodel","rgb"),t("zmin",(a=b.colormodel[n.colormodel]).zminDflt||a.min),t("zmax",a.zmaxDflt||a.max)):n._hasSource&&(n.colormodel="rgba256",a=b.colormodel[n.colormodel],n.zmin=a.zminDflt,n.zmax=a.zmaxDflt),t("zsmooth"),t("text"),t("hovertext"),t("hovertemplate"),n._length=null):n.visible=!1}},{"../../lib":515,"../../snapshot/helpers":651,"./attributes":854,"./constants":856}],858:[function(v,J,Z){J.exports=function(p,g){return"xVal"in g&&(p.x=g.xVal),"yVal"in g&&(p.y=g.yVal),g.xa&&(p.xaxis=g.xa),g.ya&&(p.yaxis=g.ya),p.color=g.color,p.colormodel=g.trace.colormodel,p.z||(p.z=g.color),p}},{}],859:[function(v,J,Z){var p=v("probe-image-size/sync"),g=v("../../snapshot/helpers").IMAGE_URL_PREFIX,b=v("buffer/").Buffer;Z.getImageSize=function(y){var e=y.replace(g,""),n=new b(e,"base64");return p(n)}},{"../../snapshot/helpers":651,"buffer/":85,"probe-image-size/sync":277}],860:[function(v,J,Z){var p=v("../../components/fx"),g=v("../../lib"),b=v("./constants");J.exports=function(y,e,n){var t=y.cd[0],a=t.trace,r=y.xa,m=y.ya;if(!(p.inbox(e-t.x0,e-(t.x0+t.w*a.dx),0)>0||p.inbox(n-t.y0,n-(t.y0+t.h*a.dy),0)>0)){var o,i=Math.floor((e-t.x0)/a.dx),u=Math.floor(Math.abs(n-t.y0)/a.dy);if(a._hasZ?o=t.z[u][i]:a._hasSource&&(o=a._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(i,u,1,1).data),o){var f,l=t.hi||a.hoverinfo;if(l){var h=l.split("+");h.indexOf("all")!==-1&&(h=["color"]),h.indexOf("color")!==-1&&(f=!0)}var d,s=b.colormodel[a.colormodel],x=s.colormodel||a.colormodel,c=x.length,T=a._scaler(o),_=s.suffix,w=[];(a.hovertemplate||f)&&(w.push("["+[T[0]+_[0],T[1]+_[1],T[2]+_[2]].join(", ")),c===4&&w.push(", "+T[3]+_[3]),w.push("]"),w=w.join(""),y.extraText=x.toUpperCase()+": "+w),Array.isArray(a.hovertext)&&Array.isArray(a.hovertext[u])?d=a.hovertext[u][i]:Array.isArray(a.text)&&Array.isArray(a.text[u])&&(d=a.text[u][i]);var k=m.c2p(t.y0+(u+.5)*a.dy),L=t.x0+(i+.5)*a.dx,A=t.y0+(u+.5)*a.dy,I="["+o.slice(0,a.colormodel.length).join(", ")+"]";return[g.extendFlat(y,{index:[u,i],x0:r.c2p(t.x0+i*a.dx),x1:r.c2p(t.x0+(i+1)*a.dx),y0:k,y1:k,color:T,xVal:L,xLabelVal:L,yVal:A,yLabelVal:A,zLabelVal:I,text:d,hovertemplateLabels:{zLabel:I,colorLabel:w,"color[0]Label":T[0]+_[0],"color[1]Label":T[1]+_[1],"color[2]Label":T[2]+_[2],"color[3]Label":T[3]+_[3]}})]}}}},{"../../components/fx":407,"../../lib":515,"./constants":856}],861:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),style:v("./style"),hoverPoints:v("./hover"),eventData:v("./event_data"),moduleType:"trace",name:"image",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":578,"./attributes":854,"./calc":855,"./defaults":857,"./event_data":858,"./hover":860,"./plot":862,"./style":863}],862:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=g.strTranslate,y=v("../../constants/xmlns_namespaces"),e=v("./constants"),n=g.isIOS()||g.isSafari()||g.isIE();J.exports=function(t,a,r,m){var o=a.xaxis,i=a.yaxis,u=!(n||t._context._exportedPlot);g.makeTraceGroups(m,r,"im").each(function(f){var l=p.select(this),h=f[0],d=h.trace,s=(d.zsmooth==="fast"||d.zsmooth===!1&&u)&&!d._hasZ&&d._hasSource&&o.type==="linear"&&i.type==="linear";d._realImage=s;var x,c,T,_,w,k,L=h.z,A=h.x0,I=h.y0,P=h.w,S=h.h,E=d.dx,D=d.dy;for(k=0;x===void 0&&k<P;)x=o.c2p(A+k*E),k++;for(k=P;c===void 0&&k>0;)c=o.c2p(A+k*E),k--;for(k=0;_===void 0&&k<S;)_=i.c2p(I+k*D),k++;for(k=S;w===void 0&&k>0;)w=i.c2p(I+k*D),k--;c<x&&(T=c,c=x,x=T),w<_&&(T=_,_=w,w=T),!s&&(x=Math.max(-.5*o._length,x),c=Math.min(1.5*o._length,c),_=Math.max(-.5*i._length,_),w=Math.min(1.5*i._length,w));var R=Math.round(c-x),H=Math.round(w-_);if(R<=0||H<=0)l.selectAll("image").data([]).exit().remove();else{var V=l.selectAll("image").data([f]);V.enter().append("svg:image").attr({xmlns:y.svg,preserveAspectRatio:"none"}),V.exit().remove();var X=d.zsmooth===!1?e.pixelatedStyle:"";if(s){var $=g.simpleMap(o.range,o.r2l),G=g.simpleMap(i.range,i.r2l),W=$[1]<$[0],te=G[1]>G[0];if(W||te){var N=x+R/2,B=_+H/2;X+="transform:"+b(N+"px",B+"px")+"scale("+(W?-1:1)+","+(te?-1:1)+")"+b(-N+"px",-B+"px")+";"}}V.attr("style",X);var U=new Promise(function(j){if(d._hasZ)j();else if(d._hasSource)if(d._canvas&&d._canvas.el.width===P&&d._canvas.el.height===S&&d._canvas.source===d.source)j();else{var Q=document.createElement("canvas");Q.width=P,Q.height=S;var K=Q.getContext("2d",{willReadFrequently:!0});d._image=d._image||new Image;var re=d._image;re.onload=function(){K.drawImage(re,0,0),d._canvas={el:Q,source:d.source},j()},re.setAttribute("src",d.source)}}).then(function(){var j;if(d._hasZ)j=ee(function(K,re){return L[re][K]}).toDataURL("image/png");else if(d._hasSource)if(s)j=d.source;else{var Q=d._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,P,S).data;j=ee(function(K,re){var ne=4*(re*P+K);return[Q[ne],Q[ne+1],Q[ne+2],Q[ne+3]]}).toDataURL("image/png")}V.attr({"xlink:href":j,height:H,width:R,x,y:_})});t._promises.push(U)}function ee(j){var Q=document.createElement("canvas");Q.width=R,Q.height=H;var K,re=Q.getContext("2d",{willReadFrequently:!0}),ne=function(fe){return g.constrain(Math.round(o.c2p(A+fe*E)-x),0,R)},le=function(fe){return g.constrain(Math.round(i.c2p(I+fe*D)-_),0,H)},oe=e.colormodel[d.colormodel],de=oe.colormodel||d.colormodel,se=oe.fmt;for(k=0;k<h.w;k++){var me=ne(k),Te=ne(k+1);if(Te!==me&&!isNaN(Te)&&!isNaN(me))for(var _e=0;_e<h.h;_e++){var be=le(_e),Ce=le(_e+1);Ce===be||isNaN(Ce)||isNaN(be)||!j(k,_e)||(K=d._scaler(j(k,_e)),re.fillStyle=K?de+"("+se(K).join(",")+")":"rgba(0,0,0,0)",re.fillRect(me,be,Te-me,Ce-be))}}return Q}})}},{"../../constants/xmlns_namespaces":492,"../../lib":515,"./constants":856,"@plotly/d3":58}],863:[function(v,J,Z){var p=v("@plotly/d3");J.exports=function(g){p.select(g).selectAll(".im image").style("opacity",function(b){return b[0].trace.opacity})}},{"@plotly/d3":58}],864:[function(v,J,Z){var p=v("../../lib/extend").extendFlat,g=v("../../lib/extend").extendDeep,b=v("../../plot_api/edit_types").overrideAll,y=v("../../plots/font_attributes"),e=v("../../components/color/attributes"),n=v("../../plots/domain").attributes,t=v("../../plots/cartesian/layout_attributes"),a=v("../../plot_api/plot_template").templatedArray,r=v("../../constants/delta.js"),m=v("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,o=y({editType:"plot",colorEditType:"plot"}),i={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},u={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},f=a("step",g({},i,{range:u}));J.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:n({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:p({},o,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:m("value")},font:p({},o,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:m("value")},increasing:{symbol:{valType:"string",dflt:r.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:r.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:r.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:r.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:p({},o,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:g({},i,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:b({range:u,visible:p({},t.visible,{dflt:!0}),tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:p({},t.ticks,{dflt:"outside"}),ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,ticklabelstep:t.ticklabelstep,showticklabels:t.showticklabels,tickfont:y({}),tickangle:t.tickangle,tickformat:t.tickformat,tickformatstops:t.tickformatstops,tickprefix:t.tickprefix,showtickprefix:t.showtickprefix,ticksuffix:t.ticksuffix,showticksuffix:t.showticksuffix,separatethousands:t.separatethousands,exponentformat:t.exponentformat,minexponent:t.minexponent,showexponent:t.showexponent,editType:"plot"},"plot"),steps:f,threshold:{line:{color:p({},i.line.color,{}),width:p({},i.line.width,{dflt:1}),editType:"plot"},thickness:p({},i.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":366,"../../constants/delta.js":485,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],865:[function(v,J,Z){var p=v("../../plots/plots");Z.name="indicator",Z.plot=function(g,b,y,e){p.plotBasePlot(Z.name,g,b,y,e)},Z.clean=function(g,b,y,e){p.cleanBasePlot(Z.name,g,b,y,e)}},{"../../plots/plots":628}],866:[function(v,J,Z){J.exports={calc:function(p,g){var b=[],y=g.value;typeof g._lastValue!="number"&&(g._lastValue=g.value);var e=g._lastValue,n=e;return g._hasDelta&&typeof g.delta.reference=="number"&&(n=g.delta.reference),b[0]={y,lastY:e,delta:y-n,relativeDelta:(y-n)/n},b}}},{}],867:[function(v,J,Z){J.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],868:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes"),b=v("../../plots/domain").defaults,y=v("../../plot_api/plot_template"),e=v("../../plots/array_container_defaults"),n=v("./constants.js"),t=v("../../plots/cartesian/tick_value_defaults"),a=v("../../plots/cartesian/tick_mark_defaults"),r=v("../../plots/cartesian/tick_label_defaults"),m=v("../../plots/cartesian/prefix_suffix_defaults");function o(i,u){function f(l,h){return p.coerce(i,u,g.gauge.steps,l,h)}f("color"),f("line.color"),f("line.width"),f("range"),f("thickness")}J.exports={supplyDefaults:function(i,u,f,l){function h(P,S){return p.coerce(i,u,g,P,S)}b(u,l,h),h("mode"),u._hasNumber=u.mode.indexOf("number")!==-1,u._hasDelta=u.mode.indexOf("delta")!==-1,u._hasGauge=u.mode.indexOf("gauge")!==-1;var d=h("value");u._range=[0,typeof d=="number"?1.5*d:1];var s,x,c,T,_,w,k=new Array(2);function L(P,S){return p.coerce(c,T,g.gauge,P,S)}function A(P,S){return p.coerce(_,w,g.gauge.axis,P,S)}if(u._hasNumber&&(h("number.valueformat"),h("number.font.color",l.font.color),h("number.font.family",l.font.family),h("number.font.size"),u.number.font.size===void 0&&(u.number.font.size=n.defaultNumberFontSize,k[0]=!0),h("number.prefix"),h("number.suffix"),s=u.number.font.size),u._hasDelta&&(h("delta.font.color",l.font.color),h("delta.font.family",l.font.family),h("delta.font.size"),u.delta.font.size===void 0&&(u.delta.font.size=(u._hasNumber?.5:1)*(s||n.defaultNumberFontSize),k[1]=!0),h("delta.reference",u.value),h("delta.relative"),h("delta.valueformat",u.delta.relative?"2%":""),h("delta.increasing.symbol"),h("delta.increasing.color"),h("delta.decreasing.symbol"),h("delta.decreasing.color"),h("delta.position"),h("delta.prefix"),h("delta.suffix"),x=u.delta.font.size),u._scaleNumbers=(!u._hasNumber||k[0])&&(!u._hasDelta||k[1])||!1,h("title.font.color",l.font.color),h("title.font.family",l.font.family),h("title.font.size",.25*(s||x||n.defaultNumberFontSize)),h("title.text"),u._hasGauge){(c=i.gauge)||(c={}),T=y.newContainer(u,"gauge"),L("shape"),(u._isBullet=u.gauge.shape==="bullet")||h("title.align","center"),(u._isAngular=u.gauge.shape==="angular")||h("align","center"),L("bgcolor",l.paper_bgcolor),L("borderwidth"),L("bordercolor"),L("bar.color"),L("bar.line.color"),L("bar.line.width"),L("bar.thickness",n.valueThickness*(u.gauge.shape==="bullet"?.5:1)),e(c,T,{name:"steps",handleItemDefaults:o}),L("threshold.value"),L("threshold.thickness"),L("threshold.line.width"),L("threshold.line.color"),_={},c&&(_=c.axis||{}),w=y.newContainer(T,"axis"),A("visible"),u._range=A("range",u._range);var I={outerTicks:!0};t(_,w,A,"linear"),m(_,w,A,"linear",I),r(_,w,A,"linear",I),a(_,w,A,I)}else h("title.align","center"),h("align","center"),u._isAngular=u._isBullet=!1;u._length=null}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"../../plots/domain":593,"./attributes":864,"./constants.js":867}],869:[function(v,J,Z){J.exports={moduleType:"trace",name:"indicator",basePlotModule:v("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,calc:v("./calc").calc,plot:v("./plot"),meta:{}}},{"./attributes":864,"./base_plot":865,"./calc":866,"./defaults":868,"./plot":870}],870:[function(v,J,Z){var p=v("@plotly/d3"),g=v("d3-interpolate").interpolate,b=v("d3-interpolate").interpolateNumber,y=v("../../lib"),e=y.strScale,n=y.strTranslate,t=y.rad2deg,a=v("../../constants/alignment").MID_SHIFT,r=v("../../components/drawing"),m=v("./constants"),o=v("../../lib/svg_text_utils"),i=v("../../plots/cartesian/axes"),u=v("../../plots/cartesian/axis_defaults"),f=v("../../plots/cartesian/position_defaults"),l=v("../../plots/cartesian/layout_attributes"),h=v("../../components/color"),d={left:"start",center:"middle",right:"end"},s={left:0,center:.5,right:1},x=/[yzafpn\xb5mkMGTPEZY]/;function c(A){return A&&A.duration>0}function T(A){A.each(function(I){h.stroke(p.select(this),I.line.color)}).each(function(I){h.fill(p.select(this),I.color)}).style("stroke-width",function(I){return I.line.width})}function _(A,I,P){var S=A._fullLayout,E=y.extendFlat({type:"linear",ticks:"outside",range:P,showline:!0},I),D={type:"linear",_id:"x"+I._id},R={letter:"x",font:S.font,noHover:!0,noTickson:!0};function H(V,X){return y.coerce(E,D,l,V,X)}return u(E,D,H,R,S),f(E,D,H,R),D}function w(A,I,P){return[Math.min(I/A.width,P/A.height),A,I+"x"+P]}function k(A,I,P,S){var E=document.createElementNS("http://www.w3.org/2000/svg","text"),D=p.select(E);return D.text(A).attr("x",0).attr("y",0).attr("text-anchor",P).attr("data-unformatted",A).call(o.convertToTspans,S).call(r.font,I),r.bBox(D.node())}function L(A,I,P,S,E,D){var R="_cache"+I;A[R]&&A[R].key===E||(A[R]={key:E,value:P});var H=y.aggNums(D,null,[A[R].value,S],2);return A[R].value=H,H}J.exports=function(A,I,P,S){var E,D=A._fullLayout;c(P)&&S&&(E=S()),y.makeTraceGroups(D._indicatorlayer,I,"trace").each(function(R){var H,V,X,$,G,W=R[0].trace,te=p.select(this),N=W._hasGauge,B=W._isAngular,U=W._isBullet,ee=W.domain,j={w:D._size.w*(ee.x[1]-ee.x[0]),h:D._size.h*(ee.y[1]-ee.y[0]),l:D._size.l+D._size.w*ee.x[0],r:D._size.r+D._size.w*(1-ee.x[1]),t:D._size.t+D._size.h*(1-ee.y[1]),b:D._size.b+D._size.h*ee.y[0]},Q=j.l+j.w/2,K=j.t+j.h/2,re=Math.min(j.w/2,j.h),ne=m.innerRadius*re,le=W.align||"center";if(V=K,N){if(B&&(H=Q,V=K+re/2,X=function(Ce){return function(fe,ve){var Me=Math.sqrt(fe.width/2*(fe.width/2)+fe.height*fe.height);return[ve/Me,fe,ve]}(Ce,.9*ne)}),U){var oe=m.bulletPadding,de=1-m.bulletNumberDomainSize+oe;H=j.l+(de+(1-de)*s[le])*j.w,X=function(Ce){return w(Ce,(m.bulletNumberDomainSize-oe)*j.w,j.h)}}}else H=j.l+s[le]*j.w,X=function(Ce){return w(Ce,j.w,j.h)};(function(Ce,fe,ve,Me){var ke,Le,ze,Re=ve[0].trace,Oe=Me.numbersX,Ze=Me.numbersY,Pe=Re.align||"center",Ie=d[Pe],Be=Me.transitionOpts,Fe=Me.onComplete,$e=y.ensureSingle(fe,"g","numbers"),ot=[];Re._hasNumber&&ot.push("number"),Re._hasDelta&&(ot.push("delta"),Re.delta.position==="left"&&ot.reverse());var pt=$e.selectAll("text").data(ot);function _t(Jt,ir,Ht,Ue){if(!Jt.match("s")||Ht>=0==Ue>=0||ir(Ht).slice(-1).match(x)||ir(Ue).slice(-1).match(x))return ir;var We=Jt.slice().replace("s","f").replace(/\d+/,function(xe){return parseInt(xe)-1}),he=_(Ce,{tickformat:We});return function(xe){return Math.abs(xe)<1?i.tickText(he,xe).text:ir(xe)}}pt.enter().append("text"),pt.attr("text-anchor",function(){return Ie}).attr("class",function(Jt){return Jt}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),pt.exit().remove();var yt,tt=Re.mode+Re.align;if(Re._hasDelta&&(yt=function(){var Jt=_(Ce,{tickformat:Re.delta.valueformat},Re._range);Jt.setScale(),i.prepTicks(Jt);var ir=function(Xe){return i.tickText(Jt,Xe).text},Ht=Re.delta.suffix,Ue=Re.delta.prefix,We=function(Xe){return Re.delta.relative?Xe.relativeDelta:Xe.delta},he=function(Xe,He){return Xe===0||typeof Xe!="number"||isNaN(Xe)?"-":(Xe>0?Re.delta.increasing.symbol:Re.delta.decreasing.symbol)+Ue+He(Xe)+Ht},xe=function(Xe){return Xe.delta>=0?Re.delta.increasing.color:Re.delta.decreasing.color};Re._deltaLastValue===void 0&&(Re._deltaLastValue=We(ve[0]));var De=$e.select("text.delta");function qe(){De.text(he(We(ve[0]),ir)).call(h.fill,xe(ve[0])).call(o.convertToTspans,Ce)}return De.call(r.font,Re.delta.font).call(h.fill,xe({delta:Re._deltaLastValue})),c(Be)?De.transition().duration(Be.duration).ease(Be.easing).tween("text",function(){var Xe=p.select(this),He=We(ve[0]),st=Re._deltaLastValue,it=_t(Re.delta.valueformat,ir,st,He),Tt=b(st,He);return Re._deltaLastValue=He,function(Pt){Xe.text(he(Tt(Pt),it)),Xe.call(h.fill,xe({delta:Tt(Pt)}))}}).each("end",function(){qe(),Fe&&Fe()}).each("interrupt",function(){qe(),Fe&&Fe()}):qe(),Le=k(he(We(ve[0]),ir),Re.delta.font,Ie,Ce),De}(),tt+=Re.delta.position+Re.delta.font.size+Re.delta.font.family+Re.delta.valueformat,tt+=Re.delta.increasing.symbol+Re.delta.decreasing.symbol,ze=Le),Re._hasNumber&&(function(){var Jt=_(Ce,{tickformat:Re.number.valueformat},Re._range);Jt.setScale(),i.prepTicks(Jt);var ir=function(xe){return i.tickText(Jt,xe).text},Ht=Re.number.suffix,Ue=Re.number.prefix,We=$e.select("text.number");function he(){var xe=typeof ve[0].y=="number"?Ue+ir(ve[0].y)+Ht:"-";We.text(xe).call(r.font,Re.number.font).call(o.convertToTspans,Ce)}c(Be)?We.transition().duration(Be.duration).ease(Be.easing).each("end",function(){he(),Fe&&Fe()}).each("interrupt",function(){he(),Fe&&Fe()}).attrTween("text",function(){var xe=p.select(this),De=b(ve[0].lastY,ve[0].y);Re._lastValue=ve[0].y;var qe=_t(Re.number.valueformat,ir,ve[0].lastY,ve[0].y);return function(Xe){xe.text(Ue+qe(De(Xe))+Ht)}}):he(),ke=k(Ue+ir(ve[0].y)+Ht,Re.number.font,Ie,Ce)}(),tt+=Re.number.font.size+Re.number.font.family+Re.number.valueformat+Re.number.suffix+Re.number.prefix,ze=ke),Re._hasDelta&&Re._hasNumber){var Ke,vt,Nt=[(ke.left+ke.right)/2,(ke.top+ke.bottom)/2],qt=[(Le.left+Le.right)/2,(Le.top+Le.bottom)/2],er=.75*Re.delta.font.size;Re.delta.position==="left"&&(Ke=L(Re,"deltaPos",0,-1*(ke.width*s[Re.align]+Le.width*(1-s[Re.align])+er),tt,Math.min),vt=Nt[1]-qt[1],ze={width:ke.width+Le.width+er,height:Math.max(ke.height,Le.height),left:Le.left+Ke,right:ke.right,top:Math.min(ke.top,Le.top+vt),bottom:Math.max(ke.bottom,Le.bottom+vt)}),Re.delta.position==="right"&&(Ke=L(Re,"deltaPos",0,ke.width*(1-s[Re.align])+Le.width*s[Re.align]+er,tt,Math.max),vt=Nt[1]-qt[1],ze={width:ke.width+Le.width+er,height:Math.max(ke.height,Le.height),left:ke.left,right:Le.right+Ke,top:Math.min(ke.top,Le.top+vt),bottom:Math.max(ke.bottom,Le.bottom+vt)}),Re.delta.position==="bottom"&&(Ke=null,vt=Le.height,ze={width:Math.max(ke.width,Le.width),height:ke.height+Le.height,left:Math.min(ke.left,Le.left),right:Math.max(ke.right,Le.right),top:ke.bottom-ke.height,bottom:ke.bottom+Le.height}),Re.delta.position==="top"&&(Ke=null,vt=ke.top,ze={width:Math.max(ke.width,Le.width),height:ke.height+Le.height,left:Math.min(ke.left,Le.left),right:Math.max(ke.right,Le.right),top:ke.bottom-ke.height-Le.height,bottom:ke.bottom}),yt.attr({dx:Ke,dy:vt})}(Re._hasNumber||Re._hasDelta)&&$e.attr("transform",function(){var Jt=Me.numbersScaler(ze);tt+=Jt[2];var ir,Ht=L(Re,"numbersScale",1,Jt[0],tt,Math.min);Re._scaleNumbers||(Ht=1),ir=Re._isAngular?Ze-Ht*ze.bottom:Ze-Ht*(ze.top+ze.bottom)/2,Re._numbersTop=Ht*ze.top+ir;var Ue=ze[Pe];Pe==="center"&&(Ue=(ze.left+ze.right)/2);var We=Oe-Ht*Ue;return We=L(Re,"numbersTranslate",0,We,tt,Math.max),n(We,ir)+e(Ht)})})(A,te,R,{numbersX:H,numbersY:V,numbersScaler:X,transitionOpts:P,onComplete:E}),N&&($={range:W.gauge.axis.range,color:W.gauge.bgcolor,line:{color:W.gauge.bordercolor,width:0},thickness:1},G={range:W.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:W.gauge.bordercolor,width:W.gauge.borderwidth},thickness:1});var se=te.selectAll("g.angular").data(B?R:[]);se.exit().remove();var me=te.selectAll("g.angularaxis").data(B?R:[]);me.exit().remove(),B&&function(Ce,fe,ve,Me){var ke,Le,ze,Re,Oe=ve[0].trace,Ze=Me.size,Pe=Me.radius,Ie=Me.innerRadius,Be=Me.gaugeBg,Fe=Me.gaugeOutline,$e=[Ze.l+Ze.w/2,Ze.t+Ze.h/2+Pe/2],ot=Me.gauge,pt=Me.layer,_t=Me.transitionOpts,yt=Me.onComplete,tt=Math.PI/2;function Ke(Pt){var rt=Oe.gauge.axis.range[0],ut=(Pt-rt)/(Oe.gauge.axis.range[1]-rt)*Math.PI-tt;return ut<-tt?-tt:ut>tt?tt:ut}function vt(Pt){return p.svg.arc().innerRadius((Ie+Pe)/2-Pt/2*(Pe-Ie)).outerRadius((Ie+Pe)/2+Pt/2*(Pe-Ie)).startAngle(-tt)}function Nt(Pt){Pt.attr("d",function(rt){return vt(rt.thickness).startAngle(Ke(rt.range[0])).endAngle(Ke(rt.range[1]))()})}ot.enter().append("g").classed("angular",!0),ot.attr("transform",n($e[0],$e[1])),pt.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),pt.selectAll("g.xangularaxistick,path,text").remove(),(ke=_(Ce,Oe.gauge.axis)).type="linear",ke.range=Oe.gauge.axis.range,ke._id="xangularaxis",ke.ticklabeloverflow="allow",ke.setScale();var qt=function(Pt){return(ke.range[0]-Pt.x)/(ke.range[1]-ke.range[0])*Math.PI+Math.PI},er={},Jt=i.makeLabelFns(ke,0).labelStandoff;er.xFn=function(Pt){var rt=qt(Pt);return Math.cos(rt)*Jt},er.yFn=function(Pt){var rt=qt(Pt),ut=Math.sin(rt)>0?.2:1;return-Math.sin(rt)*(Jt+Pt.fontSize*ut)+Math.abs(Math.cos(rt))*(Pt.fontSize*a)},er.anchorFn=function(Pt){var rt=qt(Pt),ut=Math.cos(rt);return Math.abs(ut)<.1?"middle":ut>0?"start":"end"},er.heightFn=function(Pt,rt,ut){var Ft=qt(Pt);return-.5*(1+Math.sin(Ft))*ut};var ir=function(Pt){return n($e[0]+Pe*Math.cos(Pt),$e[1]-Pe*Math.sin(Pt))};if(ze=function(Pt){return ir(qt(Pt))},Le=i.calcTicks(ke),Re=i.getTickSigns(ke)[2],ke.visible){Re=ke.ticks==="inside"?-1:1;var Ht=(ke.linewidth||1)/2;i.drawTicks(Ce,ke,{vals:Le,layer:pt,path:"M"+Re*Ht+",0h"+Re*ke.ticklen,transFn:function(Pt){var rt=qt(Pt);return ir(rt)+"rotate("+-t(rt)+")"}}),i.drawLabels(Ce,ke,{vals:Le,layer:pt,transFn:ze,labelFns:er})}var Ue=[Be].concat(Oe.gauge.steps),We=ot.selectAll("g.bg-arc").data(Ue);We.enter().append("g").classed("bg-arc",!0).append("path"),We.select("path").call(Nt).call(T),We.exit().remove();var he=vt(Oe.gauge.bar.thickness),xe=ot.selectAll("g.value-arc").data([Oe.gauge.bar]);xe.enter().append("g").classed("value-arc",!0).append("path");var De=xe.select("path");c(_t)?(De.transition().duration(_t.duration).ease(_t.easing).each("end",function(){yt&&yt()}).each("interrupt",function(){yt&&yt()}).attrTween("d",(qe=he,Xe=Ke(ve[0].lastY),He=Ke(ve[0].y),function(){var Pt=g(Xe,He);return function(rt){return qe.endAngle(Pt(rt))()}})),Oe._lastValue=ve[0].y):De.attr("d",typeof ve[0].y=="number"?he.endAngle(Ke(ve[0].y)):"M0,0Z");var qe,Xe,He;De.call(T),xe.exit().remove(),Ue=[];var st=Oe.gauge.threshold.value;(st||st===0)&&Ue.push({range:[st,st],color:Oe.gauge.threshold.color,line:{color:Oe.gauge.threshold.line.color,width:Oe.gauge.threshold.line.width},thickness:Oe.gauge.threshold.thickness});var it=ot.selectAll("g.threshold-arc").data(Ue);it.enter().append("g").classed("threshold-arc",!0).append("path"),it.select("path").call(Nt).call(T),it.exit().remove();var Tt=ot.selectAll("g.gauge-outline").data([Fe]);Tt.enter().append("g").classed("gauge-outline",!0).append("path"),Tt.select("path").call(Nt).call(T),Tt.exit().remove()}(A,0,R,{radius:re,innerRadius:ne,gauge:se,layer:me,size:j,gaugeBg:$,gaugeOutline:G,transitionOpts:P,onComplete:E});var Te=te.selectAll("g.bullet").data(U?R:[]);Te.exit().remove();var _e=te.selectAll("g.bulletaxis").data(U?R:[]);_e.exit().remove(),U&&function(Ce,fe,ve,Me){var ke,Le,ze,Re,Oe,Ze=ve[0].trace,Pe=Me.gauge,Ie=Me.layer,Be=Me.gaugeBg,Fe=Me.gaugeOutline,$e=Me.size,ot=Ze.domain,pt=Me.transitionOpts,_t=Me.onComplete;Pe.enter().append("g").classed("bullet",!0),Pe.attr("transform",n($e.l,$e.t)),Ie.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),Ie.selectAll("g.xbulletaxistick,path,text").remove();var yt=$e.h,tt=Ze.gauge.bar.thickness*yt,Ke=ot.x[0],vt=ot.x[0]+(ot.x[1]-ot.x[0])*(Ze._hasNumber||Ze._hasDelta?1-m.bulletNumberDomainSize:1);(ke=_(Ce,Ze.gauge.axis))._id="xbulletaxis",ke.domain=[Ke,vt],ke.setScale(),Le=i.calcTicks(ke),ze=i.makeTransTickFn(ke),Re=i.getTickSigns(ke)[2],Oe=$e.t+$e.h,ke.visible&&(i.drawTicks(Ce,ke,{vals:ke.ticks==="inside"?i.clipEnds(ke,Le):Le,layer:Ie,path:i.makeTickPath(ke,Oe,Re),transFn:ze}),i.drawLabels(Ce,ke,{vals:Le,layer:Ie,transFn:ze,labelFns:i.makeLabelFns(ke,Oe)}));function Nt(We){We.attr("width",function(he){return Math.max(0,ke.c2p(he.range[1])-ke.c2p(he.range[0]))}).attr("x",function(he){return ke.c2p(he.range[0])}).attr("y",function(he){return .5*(1-he.thickness)*yt}).attr("height",function(he){return he.thickness*yt})}var qt=[Be].concat(Ze.gauge.steps),er=Pe.selectAll("g.bg-bullet").data(qt);er.enter().append("g").classed("bg-bullet",!0).append("rect"),er.select("rect").call(Nt).call(T),er.exit().remove();var Jt=Pe.selectAll("g.value-bullet").data([Ze.gauge.bar]);Jt.enter().append("g").classed("value-bullet",!0).append("rect"),Jt.select("rect").attr("height",tt).attr("y",(yt-tt)/2).call(T),c(pt)?Jt.select("rect").transition().duration(pt.duration).ease(pt.easing).each("end",function(){_t&&_t()}).each("interrupt",function(){_t&&_t()}).attr("width",Math.max(0,ke.c2p(Math.min(Ze.gauge.axis.range[1],ve[0].y)))):Jt.select("rect").attr("width",typeof ve[0].y=="number"?Math.max(0,ke.c2p(Math.min(Ze.gauge.axis.range[1],ve[0].y))):0),Jt.exit().remove();var ir=ve.filter(function(){return Ze.gauge.threshold.value||Ze.gauge.threshold.value===0}),Ht=Pe.selectAll("g.threshold-bullet").data(ir);Ht.enter().append("g").classed("threshold-bullet",!0).append("line"),Ht.select("line").attr("x1",ke.c2p(Ze.gauge.threshold.value)).attr("x2",ke.c2p(Ze.gauge.threshold.value)).attr("y1",(1-Ze.gauge.threshold.thickness)/2*yt).attr("y2",(1-(1-Ze.gauge.threshold.thickness)/2)*yt).call(h.stroke,Ze.gauge.threshold.line.color).style("stroke-width",Ze.gauge.threshold.line.width),Ht.exit().remove();var Ue=Pe.selectAll("g.gauge-outline").data([Fe]);Ue.enter().append("g").classed("gauge-outline",!0).append("rect"),Ue.select("rect").call(Nt).call(T),Ue.exit().remove()}(A,0,R,{gauge:Te,layer:_e,size:j,gaugeBg:$,gaugeOutline:G,transitionOpts:P,onComplete:E});var be=te.selectAll("text.title").data(R);be.exit().remove(),be.enter().append("text").classed("title",!0),be.attr("text-anchor",function(){return U?d.right:d[W.title.align]}).text(W.title.text).call(r.font,W.title.font).call(o.convertToTspans,A),be.attr("transform",function(){var Ce,fe=j.l+j.w*s[W.title.align],ve=m.titlePadding,Me=r.bBox(be.node());return N?(B&&(W.gauge.axis.visible?Ce=r.bBox(me.node()).top-ve-Me.bottom:Ce=j.t+j.h/2-re/2-Me.bottom-ve),U&&(Ce=V-(Me.top+Me.bottom)/2,fe=j.l-m.bulletPadding*j.w)):Ce=W._numbersTop-ve-Me.bottom,n(fe,Ce)})})}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"./constants":867,"@plotly/d3":58,"d3-interpolate":116}],871:[function(v,J,Z){var p=v("../../components/colorscale/attributes"),g=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,b=v("../../plots/template_attributes").hovertemplateAttrs,y=v("../mesh3d/attributes"),e=v("../../plots/attributes"),n=v("../../lib/extend").extendFlat,t=v("../../plot_api/edit_types").overrideAll,a=J.exports=t(n({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:b(),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),valuehoverformat:g("value",1),showlegend:n({},e.showlegend,{dflt:!1})},p("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:y.opacity,lightposition:y.lightposition,lighting:y.lighting,flatshading:y.flatshading,contour:y.contour,hoverinfo:n({},e.hoverinfo)}),"calc","nested");a.flatshading.dflt=!0,a.lighting.facenormalsepsilon.dflt=0,a.x.editType=a.y.editType=a.z.editType=a.value.editType="calc+clearAxisTypes",a.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],872:[function(v,J,Z){var p=v("../../components/colorscale/calc"),g=v("../streamtube/calc").processGrid,b=v("../streamtube/calc").filter;J.exports=function(y,e){e._len=Math.min(e.x.length,e.y.length,e.z.length,e.value.length),e._x=b(e.x,e._len),e._y=b(e.y,e._len),e._z=b(e.z,e._len),e._value=b(e.value,e._len);var n=g(e);e._gridFill=n.fill,e._Xs=n.Xs,e._Ys=n.Ys,e._Zs=n.Zs,e._len=n.len;for(var t=1/0,a=-1/0,r=0;r<e._len;r++){var m=e._value[r];t=Math.min(t,m),a=Math.max(a,m)}e._minValues=t,e._maxValues=a,e._vMin=e.isomin===void 0||e.isomin===null?t:e.isomin,e._vMax=e.isomax===void 0||e.isomin===null?a:e.isomax,p(y,e,{vals:[e._vMin,e._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375,"../streamtube/calc":1054}],873:[function(v,J,Z){var p=v("../../../stackgl_modules").gl_mesh3d,g=v("../../lib/gl_format_color").parseColorScale,b=v("../../lib/str2rgbarray"),y=v("../../components/colorscale").extractOpts,e=v("../../plots/gl3d/zip3"),n=function(o,i){for(var u=i.length-1;u>0;u--){var f=Math.min(i[u],i[u-1]),l=Math.max(i[u],i[u-1]);if(l>f&&f<o&&o<=l)return{id:u,distRatio:(l-o)/(l-f)}}return{id:0,distRatio:0}};function t(o,i,u){this.scene=o,this.uid=u,this.mesh=i,this.name="",this.data=null,this.showContour=!1}var a=t.prototype;a.handlePick=function(o){if(o.object===this.mesh){var i=o.data.index,u=this.data._meshX[i],f=this.data._meshY[i],l=this.data._meshZ[i],h=this.data._Ys.length,d=this.data._Zs.length,s=n(u,this.data._Xs).id,x=n(f,this.data._Ys).id,c=n(l,this.data._Zs).id,T=o.index=c+d*x+d*h*s;o.traceCoordinate=[this.data._meshX[T],this.data._meshY[T],this.data._meshZ[T],this.data._value[T]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[T]!==void 0?o.textLabel=_[T]:_&&(o.textLabel=_),!0}},a.update=function(o){var i=this.scene,u=i.fullSceneLayout;function f(d,s,x,c){return s.map(function(T){return d.d2l(T,0,c)*x})}this.data=m(o);var l={positions:e(f(u.xaxis,o._meshX,i.dataScale[0],o.xcalendar),f(u.yaxis,o._meshY,i.dataScale[1],o.ycalendar),f(u.zaxis,o._meshZ,i.dataScale[2],o.zcalendar)),cells:e(o._meshI,o._meshJ,o._meshK),lightPosition:[o.lightposition.x,o.lightposition.y,o.lightposition.z],ambient:o.lighting.ambient,diffuse:o.lighting.diffuse,specular:o.lighting.specular,roughness:o.lighting.roughness,fresnel:o.lighting.fresnel,vertexNormalsEpsilon:o.lighting.vertexnormalsepsilon,faceNormalsEpsilon:o.lighting.facenormalsepsilon,opacity:o.opacity,contourEnable:o.contour.show,contourColor:b(o.contour.color).slice(0,3),contourWidth:o.contour.width,useFacetNormals:o.flatshading},h=y(o);l.vertexIntensity=o._meshIntensity,l.vertexIntensityBounds=[h.min,h.max],l.colormap=g(o),this.mesh.update(l)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var r=["xyz","xzy","yxz","yzx","zxy","zyx"];function m(o){o._meshI=[],o._meshJ=[],o._meshK=[];var i,u,f,l,h,d,s,x=o.surface.show,c=o.spaceframe.show,T=o.surface.fill,_=o.spaceframe.fill,w=!1,k=!1,L=0,A=o._Xs,I=o._Ys,P=o._Zs,S=A.length,E=I.length,D=P.length,R=r.indexOf(o._gridFill.replace(/-/g,"").replace(/\+/g,"")),H=function(Pe,Ie,Be){switch(R){case 5:return Be+D*Ie+D*E*Pe;case 4:return Be+D*Pe+D*S*Ie;case 3:return Ie+E*Be+E*D*Pe;case 2:return Ie+E*Pe+E*S*Be;case 1:return Pe+S*Be+S*D*Ie;default:return Pe+S*Ie+S*E*Be}},V=o._minValues,X=o._maxValues,$=o._vMin,G=o._vMax;function W(Pe,Ie,Be){for(var Fe=d.length,$e=u;$e<Fe;$e++)if(Pe===f[$e]&&Ie===l[$e]&&Be===h[$e])return $e;return-1}function te(){u=i}function N(){f=[],l=[],h=[],d=[],i=0,te()}function B(Pe,Ie,Be,Fe){return f.push(Pe),l.push(Ie),h.push(Be),d.push(Fe),++i-1}function U(Pe,Ie,Be){for(var Fe=[],$e=0;$e<Pe.length;$e++)Fe[$e]=Pe[$e]*(1-Be)+Be*Ie[$e];return Fe}function ee(Pe){s=Pe}function j(Pe,Ie){return Pe==="all"||Pe===null||Pe.indexOf(Ie)>-1}function Q(Pe,Ie){return Pe===null?Ie:Pe}function K(Pe,Ie,Be){te();var Fe,$e,ot,pt=[Ie],_t=[Be];if(s>=1)pt=[Ie],_t=[Be];else if(s>0){var yt=function(Ht,Ue){var We=Ht[0],he=Ht[1],xe=Ht[2],De=function(rt,ut,Ft){for(var wt=[],Lt=0;Lt<rt.length;Lt++)wt[Lt]=(rt[Lt]+ut[Lt]+Ft[Lt])/3;return wt}(We,he,xe),qe=Math.sqrt(1-s),Xe=U(De,We,qe),He=U(De,he,qe),st=U(De,xe,qe),it=Ue[0],Tt=Ue[1],Pt=Ue[2];return{xyzv:[[We,he,He],[He,Xe,We],[he,xe,st],[st,He,he],[xe,We,Xe],[Xe,st,xe]],abc:[[it,Tt,-1],[-1,-1,it],[Tt,Pt,-1],[-1,-1,Tt],[Pt,it,-1],[-1,-1,Pt]]}}(Ie,Be);pt=yt.xyzv,_t=yt.abc}for(var tt=0;tt<pt.length;tt++){Ie=pt[tt],Be=_t[tt];for(var Ke=[],vt=0;vt<3;vt++){var Nt=Ie[vt][0],qt=Ie[vt][1],er=Ie[vt][2],Jt=Ie[vt][3],ir=Be[vt]>-1?Be[vt]:W(Nt,qt,er);Ke[vt]=ir>-1?ir:B(Nt,qt,er,Q(Pe,Jt))}Fe=Ke[0],$e=Ke[1],ot=Ke[2],o._meshI.push(Fe),o._meshJ.push($e),o._meshK.push(ot),++L}}function re(Pe,Ie,Be,Fe){var $e=Pe[3];$e<Be&&($e=Be),$e>Fe&&($e=Fe);for(var ot=(Pe[3]-$e)/(Pe[3]-Ie[3]+1e-9),pt=[],_t=0;_t<4;_t++)pt[_t]=(1-ot)*Pe[_t]+ot*Ie[_t];return pt}function ne(Pe,Ie,Be){return Pe>=Ie&&Pe<=Be}function le(Pe){var Ie=.001*(G-$);return Pe>=$-Ie&&Pe<=G+Ie}function oe(Pe){for(var Ie=[],Be=0;Be<4;Be++){var Fe=Pe[Be];Ie.push([o._x[Fe],o._y[Fe],o._z[Fe],o._value[Fe]])}return Ie}function de(Pe,Ie,Be,Fe,$e,ot){ot||(ot=1),Be=[-1,-1,-1];var pt=!1,_t=[ne(Ie[0][3],Fe,$e),ne(Ie[1][3],Fe,$e),ne(Ie[2][3],Fe,$e)];if(!_t[0]&&!_t[1]&&!_t[2])return!1;var yt=function(Ke,vt,Nt){return le(vt[0][3])&&le(vt[1][3])&&le(vt[2][3])?(K(Ke,vt,Nt),!0):ot<3&&de(Ke,vt,Nt,$,G,++ot)};if(_t[0]&&_t[1]&&_t[2])return yt(Pe,Ie,Be)||pt;var tt=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(Ke){if(_t[Ke[0]]&&_t[Ke[1]]&&!_t[Ke[2]]){var vt=Ie[Ke[0]],Nt=Ie[Ke[1]],qt=Ie[Ke[2]],er=re(qt,vt,Fe,$e),Jt=re(qt,Nt,Fe,$e);pt=yt(Pe,[Jt,er,vt],[-1,-1,Be[Ke[0]]])||pt,pt=yt(Pe,[vt,Nt,Jt],[Be[Ke[0]],Be[Ke[1]],-1])||pt,tt=!0}}),tt||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(Ke){if(_t[Ke[0]]&&!_t[Ke[1]]&&!_t[Ke[2]]){var vt=Ie[Ke[0]],Nt=Ie[Ke[1]],qt=Ie[Ke[2]],er=re(Nt,vt,Fe,$e),Jt=re(qt,vt,Fe,$e);pt=yt(Pe,[Jt,er,vt],[-1,-1,Be[Ke[0]]])||pt,tt=!0}}),pt}function se(Pe,Ie,Be,Fe){var $e=!1,ot=oe(Ie),pt=[ne(ot[0][3],Be,Fe),ne(ot[1][3],Be,Fe),ne(ot[2][3],Be,Fe),ne(ot[3][3],Be,Fe)];if(!(pt[0]||pt[1]||pt[2]||pt[3]))return $e;if(pt[0]&&pt[1]&&pt[2]&&pt[3])return k&&($e=function(yt,tt,Ke){var vt=function(Nt,qt,er){K(yt,[tt[Nt],tt[qt],tt[er]],[Ke[Nt],Ke[qt],Ke[er]])};vt(0,1,2),vt(3,0,1),vt(2,3,0),vt(1,2,3)}(Pe,ot,Ie)||$e),$e;var _t=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(yt){if(pt[yt[0]]&&pt[yt[1]]&&pt[yt[2]]&&!pt[yt[3]]){var tt=ot[yt[0]],Ke=ot[yt[1]],vt=ot[yt[2]],Nt=ot[yt[3]];if(k)$e=K(Pe,[tt,Ke,vt],[Ie[yt[0]],Ie[yt[1]],Ie[yt[2]]])||$e;else{var qt=re(Nt,tt,Be,Fe),er=re(Nt,Ke,Be,Fe),Jt=re(Nt,vt,Be,Fe);$e=K(null,[qt,er,Jt],[-1,-1,-1])||$e}_t=!0}}),_t||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(yt){if(pt[yt[0]]&&pt[yt[1]]&&!pt[yt[2]]&&!pt[yt[3]]){var tt=ot[yt[0]],Ke=ot[yt[1]],vt=ot[yt[2]],Nt=ot[yt[3]],qt=re(vt,tt,Be,Fe),er=re(vt,Ke,Be,Fe),Jt=re(Nt,Ke,Be,Fe),ir=re(Nt,tt,Be,Fe);k?($e=K(Pe,[tt,ir,qt],[Ie[yt[0]],-1,-1])||$e,$e=K(Pe,[Ke,er,Jt],[Ie[yt[1]],-1,-1])||$e):$e=function(Ht,Ue,We){var he=function(xe,De,qe){K(Ht,[Ue[xe],Ue[De],Ue[qe]],[We[xe],We[De],We[qe]])};he(0,1,2),he(2,3,0)}(null,[qt,er,Jt,ir],[-1,-1,-1,-1])||$e,_t=!0}}),_t||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(yt){if(pt[yt[0]]&&!pt[yt[1]]&&!pt[yt[2]]&&!pt[yt[3]]){var tt=ot[yt[0]],Ke=ot[yt[1]],vt=ot[yt[2]],Nt=ot[yt[3]],qt=re(Ke,tt,Be,Fe),er=re(vt,tt,Be,Fe),Jt=re(Nt,tt,Be,Fe);k?($e=K(Pe,[tt,qt,er],[Ie[yt[0]],-1,-1])||$e,$e=K(Pe,[tt,er,Jt],[Ie[yt[0]],-1,-1])||$e,$e=K(Pe,[tt,Jt,qt],[Ie[yt[0]],-1,-1])||$e):$e=K(null,[qt,er,Jt],[-1,-1,-1])||$e,_t=!0}})),$e}function me(Pe,Ie,Be,Fe,$e,ot,pt,_t,yt,tt,Ke){var vt=!1;return w&&(j(Pe,"A")&&(vt=se(null,[Ie,Be,Fe,ot],tt,Ke)||vt),j(Pe,"B")&&(vt=se(null,[Be,Fe,$e,yt],tt,Ke)||vt),j(Pe,"C")&&(vt=se(null,[Be,ot,pt,yt],tt,Ke)||vt),j(Pe,"D")&&(vt=se(null,[Fe,ot,_t,yt],tt,Ke)||vt),j(Pe,"E")&&(vt=se(null,[Be,Fe,ot,yt],tt,Ke)||vt)),k&&(vt=se(Pe,[Be,Fe,ot,yt],tt,Ke)||vt),vt}function Te(Pe,Ie,Be,Fe,$e,ot,pt,_t){return[_t[0]===!0||de(Pe,oe([Ie,Be,Fe]),[Ie,Be,Fe],ot,pt),_t[1]===!0||de(Pe,oe([Fe,$e,Ie]),[Fe,$e,Ie],ot,pt)]}function _e(Pe,Ie,Be,Fe,$e,ot,pt,_t,yt){return _t?Te(Pe,Ie,Be,$e,Fe,ot,pt,yt):Te(Pe,Be,$e,Fe,Ie,ot,pt,yt)}function be(Pe,Ie,Be,Fe,$e,ot,pt){var _t,yt,tt,Ke,vt=!1,Nt=function(){vt=de(Pe,[_t,yt,tt],[-1,-1,-1],$e,ot)||vt,vt=de(Pe,[tt,Ke,_t],[-1,-1,-1],$e,ot)||vt},qt=pt[0],er=pt[1],Jt=pt[2];return qt&&(_t=U(oe([H(Ie,Be-0,Fe-0)])[0],oe([H(Ie-1,Be-0,Fe-0)])[0],qt),yt=U(oe([H(Ie,Be-0,Fe-1)])[0],oe([H(Ie-1,Be-0,Fe-1)])[0],qt),tt=U(oe([H(Ie,Be-1,Fe-1)])[0],oe([H(Ie-1,Be-1,Fe-1)])[0],qt),Ke=U(oe([H(Ie,Be-1,Fe-0)])[0],oe([H(Ie-1,Be-1,Fe-0)])[0],qt),Nt()),er&&(_t=U(oe([H(Ie-0,Be,Fe-0)])[0],oe([H(Ie-0,Be-1,Fe-0)])[0],er),yt=U(oe([H(Ie-0,Be,Fe-1)])[0],oe([H(Ie-0,Be-1,Fe-1)])[0],er),tt=U(oe([H(Ie-1,Be,Fe-1)])[0],oe([H(Ie-1,Be-1,Fe-1)])[0],er),Ke=U(oe([H(Ie-1,Be,Fe-0)])[0],oe([H(Ie-1,Be-1,Fe-0)])[0],er),Nt()),Jt&&(_t=U(oe([H(Ie-0,Be-0,Fe)])[0],oe([H(Ie-0,Be-0,Fe-1)])[0],Jt),yt=U(oe([H(Ie-0,Be-1,Fe)])[0],oe([H(Ie-0,Be-1,Fe-1)])[0],Jt),tt=U(oe([H(Ie-1,Be-1,Fe)])[0],oe([H(Ie-1,Be-1,Fe-1)])[0],Jt),Ke=U(oe([H(Ie-1,Be-0,Fe)])[0],oe([H(Ie-1,Be-0,Fe-1)])[0],Jt),Nt()),vt}function Ce(Pe,Ie,Be,Fe,$e,ot,pt,_t,yt,tt,Ke,vt){var Nt=Pe;return vt?(w&&Pe==="even"&&(Nt=null),me(Nt,Ie,Be,Fe,$e,ot,pt,_t,yt,tt,Ke)):(w&&Pe==="odd"&&(Nt=null),me(Nt,yt,_t,pt,ot,$e,Fe,Be,Ie,tt,Ke))}function fe(Pe,Ie,Be,Fe,$e){for(var ot=[],pt=0,_t=0;_t<Ie.length;_t++)for(var yt=Ie[_t],tt=1;tt<D;tt++)for(var Ke=1;Ke<E;Ke++)ot.push(_e(Pe,H(yt,Ke-1,tt-1),H(yt,Ke-1,tt),H(yt,Ke,tt-1),H(yt,Ke,tt),Be,Fe,(yt+Ke+tt)%2,$e&&$e[pt]?$e[pt]:[])),pt++;return ot}function ve(Pe,Ie,Be,Fe,$e){for(var ot=[],pt=0,_t=0;_t<Ie.length;_t++)for(var yt=Ie[_t],tt=1;tt<S;tt++)for(var Ke=1;Ke<D;Ke++)ot.push(_e(Pe,H(tt-1,yt,Ke-1),H(tt,yt,Ke-1),H(tt-1,yt,Ke),H(tt,yt,Ke),Be,Fe,(tt+yt+Ke)%2,$e&&$e[pt]?$e[pt]:[])),pt++;return ot}function Me(Pe,Ie,Be,Fe,$e){for(var ot=[],pt=0,_t=0;_t<Ie.length;_t++)for(var yt=Ie[_t],tt=1;tt<E;tt++)for(var Ke=1;Ke<S;Ke++)ot.push(_e(Pe,H(Ke-1,tt-1,yt),H(Ke-1,tt,yt),H(Ke,tt-1,yt),H(Ke,tt,yt),Be,Fe,(Ke+tt+yt)%2,$e&&$e[pt]?$e[pt]:[])),pt++;return ot}function ke(Pe,Ie,Be){for(var Fe=1;Fe<D;Fe++)for(var $e=1;$e<E;$e++)for(var ot=1;ot<S;ot++)Ce(Pe,H(ot-1,$e-1,Fe-1),H(ot-1,$e-1,Fe),H(ot-1,$e,Fe-1),H(ot-1,$e,Fe),H(ot,$e-1,Fe-1),H(ot,$e-1,Fe),H(ot,$e,Fe-1),H(ot,$e,Fe),Ie,Be,(ot+$e+Fe)%2)}function Le(Pe,Ie,Be){w=!0,ke(Pe,Ie,Be),w=!1}function ze(Pe,Ie,Be,Fe,$e,ot){for(var pt=[],_t=0,yt=0;yt<Ie.length;yt++)for(var tt=Ie[yt],Ke=1;Ke<D;Ke++)for(var vt=1;vt<E;vt++)pt.push(be(Pe,tt,vt,Ke,Be,Fe,$e[yt],ot&&ot[_t]&&ot[_t])),_t++;return pt}function Re(Pe,Ie,Be,Fe,$e,ot){for(var pt=[],_t=0,yt=0;yt<Ie.length;yt++)for(var tt=Ie[yt],Ke=1;Ke<S;Ke++)for(var vt=1;vt<D;vt++)pt.push(be(Pe,Ke,tt,vt,Be,Fe,$e[yt],ot&&ot[_t]&&ot[_t])),_t++;return pt}function Oe(Pe,Ie,Be,Fe,$e,ot){for(var pt=[],_t=0,yt=0;yt<Ie.length;yt++)for(var tt=Ie[yt],Ke=1;Ke<E;Ke++)for(var vt=1;vt<S;vt++)pt.push(be(Pe,vt,Ke,tt,Be,Fe,$e[yt],ot&&ot[_t]&&ot[_t])),_t++;return pt}function Ze(Pe,Ie){for(var Be=[],Fe=Pe;Fe<Ie;Fe++)Be.push(Fe);return Be}return function(){if(N(),function(){for(var _t=0;_t<S;_t++)for(var yt=0;yt<E;yt++)for(var tt=0;tt<D;tt++){var Ke=H(_t,yt,tt);B(o._x[Ke],o._y[Ke],o._z[Ke],o._value[Ke])}}(),c&&_&&(ee(_),k=!0,ke(null,$,G),k=!1),x&&T){ee(T);for(var Pe=o.surface.pattern,Ie=o.surface.count,Be=0;Be<Ie;Be++){var Fe=Ie===1?.5:Be/(Ie-1),$e=(1-Fe)*$+Fe*G,ot=Math.abs($e-V)>Math.abs($e-X)?[V,$e]:[$e,X];Le(Pe,ot[0],ot[1])}}var pt=[[Math.min($,X),Math.max($,X)],[Math.min(V,G),Math.max(V,G)]];["x","y","z"].forEach(function(_t){for(var yt=[],tt=0;tt<pt.length;tt++){var Ke=0,vt=pt[tt][0],Nt=pt[tt][1],qt=o.slices[_t];if(qt.show&&qt.fill){ee(qt.fill);var er=[],Jt=[],ir=[];if(qt.locations.length)for(var Ht=0;Ht<qt.locations.length;Ht++){var Ue=n(qt.locations[Ht],_t==="x"?A:_t==="y"?I:P);Ue.distRatio===0?er.push(Ue.id):Ue.id>0&&(Jt.push(Ue.id),_t==="x"?ir.push([Ue.distRatio,0,0]):_t==="y"?ir.push([0,Ue.distRatio,0]):ir.push([0,0,Ue.distRatio]))}else er=Ze(1,_t==="x"?S-1:_t==="y"?E-1:D-1);Jt.length>0&&(yt[Ke]=_t==="x"?ze(null,Jt,vt,Nt,ir,yt[Ke]):_t==="y"?Re(null,Jt,vt,Nt,ir,yt[Ke]):Oe(null,Jt,vt,Nt,ir,yt[Ke]),Ke++),er.length>0&&(yt[Ke]=_t==="x"?fe(null,er,vt,Nt,yt[Ke]):_t==="y"?ve(null,er,vt,Nt,yt[Ke]):Me(null,er,vt,Nt,yt[Ke]),Ke++)}var We=o.caps[_t];We.show&&We.fill&&(ee(We.fill),yt[Ke]=_t==="x"?fe(null,[0,S-1],vt,Nt,yt[Ke]):_t==="y"?ve(null,[0,E-1],vt,Nt,yt[Ke]):Me(null,[0,D-1],vt,Nt,yt[Ke]),Ke++)}}),L===0&&N(),o._meshX=f,o._meshY=l,o._meshZ=h,o._meshIntensity=d,o._Xs=A,o._Ys=I,o._Zs=P}(),o}J.exports={findNearestOnAxis:n,generateIsoMeshes:m,createIsosurfaceTrace:function(o,i){var u=o.glplot.gl,f=p({gl:u}),l=new t(o,f,i.uid);return f._trace=l,l.update(i),o.glplot.add(f),l}}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],874:[function(v,J,Z){var p=v("../../lib"),g=v("../../registry"),b=v("./attributes"),y=v("../../components/colorscale/defaults");function e(n,t,a,r,m){var o=m("isomin"),i=m("isomax");i!=null&&o!=null&&o>i&&(t.isomin=null,t.isomax=null);var u=m("x"),f=m("y"),l=m("z"),h=m("value");u&&u.length&&f&&f.length&&l&&l.length&&h&&h.length?(g.getComponentMethod("calendars","handleTraceDefaults")(n,t,["x","y","z"],r),m("valuehoverformat"),["x","y","z"].forEach(function(d){m(d+"hoverformat");var s="caps."+d;m(s+".show")&&m(s+".fill");var x="slices."+d;m(x+".show")&&(m(x+".fill"),m(x+".locations"))}),m("spaceframe.show")&&m("spaceframe.fill"),m("surface.show")&&(m("surface.count"),m("surface.fill"),m("surface.pattern")),m("contour.show")&&(m("contour.color"),m("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(d){m(d)}),y(n,t,r,m,{prefix:"",cLetter:"c"}),t._length=null):t.visible=!1}J.exports={supplyDefaults:function(n,t,a,r){e(n,t,a,r,function(m,o){return p.coerce(n,t,b,m,o)})},supplyIsoDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":871}],875:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,calc:v("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:v("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":871,"./calc":872,"./convert":873,"./defaults":874}],876:[function(v,J,Z){var p=v("../../components/colorscale/attributes"),g=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,b=v("../../plots/template_attributes").hovertemplateAttrs,y=v("../surface/attributes"),e=v("../../plots/attributes"),n=v("../../lib/extend").extendFlat;J.exports=n({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:b({editType:"calc"}),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},p("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:y.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:n({},y.contours.x.show,{}),color:y.contours.x.color,width:y.contours.x.width,editType:"calc"},lightposition:{x:n({},y.lightposition.x,{dflt:1e5}),y:n({},y.lightposition.y,{dflt:1e5}),z:n({},y.lightposition.z,{dflt:0}),editType:"calc"},lighting:n({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},y.lighting),hoverinfo:n({},e.hoverinfo,{editType:"calc"}),showlegend:n({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../surface/attributes":1070}],877:[function(v,J,Z){var p=v("../../components/colorscale/calc");J.exports=function(g,b){b.intensity&&p(g,b,{vals:b.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],878:[function(v,J,Z){var p=v("../../../stackgl_modules").gl_mesh3d,g=v("../../../stackgl_modules").delaunay_triangulate,b=v("../../../stackgl_modules").alpha_shape,y=v("../../../stackgl_modules").convex_hull,e=v("../../lib/gl_format_color").parseColorScale,n=v("../../lib/str2rgbarray"),t=v("../../components/colorscale").extractOpts,a=v("../../plots/gl3d/zip3");function r(l,h,d){this.scene=l,this.uid=d,this.mesh=h,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var m=r.prototype;function o(l){for(var h=[],d=l.length,s=0;s<d;s++)h[s]=n(l[s]);return h}function i(l,h,d,s){for(var x=[],c=h.length,T=0;T<c;T++)x[T]=l.d2l(h[T],0,s)*d;return x}function u(l){for(var h=[],d=l.length,s=0;s<d;s++)h[s]=Math.round(l[s]);return h}function f(l,h){for(var d=l.length,s=0;s<d;s++)if(l[s]<=-.5||l[s]>=h-.5)return!1;return!0}m.handlePick=function(l){if(l.object===this.mesh){var h=l.index=l.data.index;l.data._cellCenter?l.traceCoordinate=l.data.dataCoordinate:l.traceCoordinate=[this.data.x[h],this.data.y[h],this.data.z[h]];var d=this.data.hovertext||this.data.text;return Array.isArray(d)&&d[h]!==void 0?l.textLabel=d[h]:d&&(l.textLabel=d),!0}},m.update=function(l){var h=this.scene,d=h.fullSceneLayout;this.data=l;var s,x=l.x.length,c=a(i(d.xaxis,l.x,h.dataScale[0],l.xcalendar),i(d.yaxis,l.y,h.dataScale[1],l.ycalendar),i(d.zaxis,l.z,h.dataScale[2],l.zcalendar));if(l.i&&l.j&&l.k){if(l.i.length!==l.j.length||l.j.length!==l.k.length||!f(l.i,x)||!f(l.j,x)||!f(l.k,x))return;s=a(u(l.i),u(l.j),u(l.k))}else s=l.alphahull===0?y(c):l.alphahull>0?b(l.alphahull,c):function(k,L){for(var A=["x","y","z"].indexOf(k),I=[],P=L.length,S=0;S<P;S++)I[S]=[L[S][(A+1)%3],L[S][(A+2)%3]];return g(I)}(l.delaunayaxis,c);var T={positions:c,cells:s,lightPosition:[l.lightposition.x,l.lightposition.y,l.lightposition.z],ambient:l.lighting.ambient,diffuse:l.lighting.diffuse,specular:l.lighting.specular,roughness:l.lighting.roughness,fresnel:l.lighting.fresnel,vertexNormalsEpsilon:l.lighting.vertexnormalsepsilon,faceNormalsEpsilon:l.lighting.facenormalsepsilon,opacity:l.opacity,contourEnable:l.contour.show,contourColor:n(l.contour.color).slice(0,3),contourWidth:l.contour.width,useFacetNormals:l.flatshading};if(l.intensity){var _=t(l);this.color="#fff";var w=l.intensitymode;T[w+"Intensity"]=l.intensity,T[w+"IntensityBounds"]=[_.min,_.max],T.colormap=e(l)}else l.vertexcolor?(this.color=l.vertexcolor[0],T.vertexColors=o(l.vertexcolor)):l.facecolor?(this.color=l.facecolor[0],T.cellColors=o(l.facecolor)):(this.color=l.color,T.meshColor=n(l.color));this.mesh.update(T)},m.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},J.exports=function(l,h){var d=l.glplot.gl,s=p({gl:d}),x=new r(l,s,h.uid);return s._trace=x,x.update(h),l.glplot.add(s),x}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],879:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib"),b=v("../../components/colorscale/defaults"),y=v("./attributes");J.exports=function(e,n,t,a){function r(o,i){return g.coerce(e,n,y,o,i)}function m(o){var i=o.map(function(u){var f=r(u);return f&&g.isArrayOrTypedArray(f)?f:null});return i.every(function(u){return u&&u.length===i[0].length})&&i}m(["x","y","z"])?(m(["i","j","k"]),(!n.i||n.j&&n.k)&&(!n.j||n.k&&n.i)&&(!n.k||n.i&&n.j)?(p.getComponentMethod("calendars","handleTraceDefaults")(e,n,["x","y","z"],a),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(o){r(o)}),r("contour.show")&&(r("contour.color"),r("contour.width")),"intensity"in e?(r("intensity"),r("intensitymode"),b(e,n,a,r,{prefix:"",cLetter:"c"})):(n.showscale=!1,"facecolor"in e?r("facecolor"):"vertexcolor"in e?r("vertexcolor"):r("color",t)),r("text"),r("hovertext"),r("hovertemplate"),r("xhoverformat"),r("yhoverformat"),r("zhoverformat"),n._length=null):n.visible=!1):n.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":876}],880:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:v("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":876,"./calc":877,"./convert":878,"./defaults":879}],881:[function(v,J,Z){var p=v("../../lib").extendFlat,g=v("../scatter/attributes"),b=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=v("../../components/drawing/attributes").dash,e=v("../../components/fx/attributes"),n=v("../../constants/delta.js"),t=n.INCREASING.COLOR,a=n.DECREASING.COLOR,r=g.line;function m(o){return{line:{color:p({},r.color,{dflt:o}),width:r.width,dash:y,editType:"style"},editType:"style"}}J.exports={xperiod:g.xperiod,xperiod0:g.xperiod0,xperiodalignment:g.xperiodalignment,xhoverformat:b("x"),yhoverformat:b("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:p({},r.width,{}),dash:p({},y,{}),editType:"style"},increasing:m(t),decreasing:m(a),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:p({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":388,"../../components/fx/attributes":398,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936}],882:[function(v,J,Z){var p=v("../../lib"),g=p._,b=v("../../plots/cartesian/axes"),y=v("../../plots/cartesian/align_period"),e=v("../../constants/numerical").BADNUM;function n(a,r,m,o){return{o:a,h:r,l:m,c:o}}function t(a,r,m,o,i,u){for(var f=i.makeCalcdata(r,"open"),l=i.makeCalcdata(r,"high"),h=i.makeCalcdata(r,"low"),d=i.makeCalcdata(r,"close"),s=Array.isArray(r.text),x=Array.isArray(r.hovertext),c=!0,T=null,_=!!r.xperiodalignment,w=[],k=0;k<o.length;k++){var L=o[k],A=f[k],I=l[k],P=h[k],S=d[k];if(L!==e&&A!==e&&I!==e&&P!==e&&S!==e){S===A?T!==null&&S!==T&&(c=S>T):c=S>A,T=S;var E=u(A,I,P,S);E.pos=L,E.yc=(A+S)/2,E.i=k,E.dir=c?"increasing":"decreasing",E.x=E.pos,E.y=[P,I],_&&(E.orig_p=m[k]),s&&(E.tx=r.text[k]),x&&(E.htx=r.hovertext[k]),w.push(E)}else w.push({pos:L,empty:!0})}return r._extremes[i._id]=b.findExtremes(i,p.concat(h,l),{padded:!0}),w.length&&(w[0].t={labels:{open:g(a,"open:")+" ",high:g(a,"high:")+" ",low:g(a,"low:")+" ",close:g(a,"close:")+" "}}),w}J.exports={calc:function(a,r){var m=b.getFromId(a,r.xaxis),o=b.getFromId(a,r.yaxis),i=function(d,s,x){var c=x._minDiff;if(!c){var T,_=d._fullData,w=[];for(c=1/0,T=0;T<_.length;T++){var k=_[T];if(k.type==="ohlc"&&k.visible===!0&&k.xaxis===s._id){w.push(k);var L=s.makeCalcdata(k,"x");k._origX=L;var A=y(x,s,"x",L).vals;k._xcalc=A;var I=p.distinctVals(A).minDiff;I&&isFinite(I)&&(c=Math.min(c,I))}}for(c===1/0&&(c=1),T=0;T<w.length;T++)w[T]._minDiff=c}return c*x.tickwidth}(a,m,r),u=r._minDiff;r._minDiff=null;var f=r._origX;r._origX=null;var l=r._xcalc;r._xcalc=null;var h=t(a,r,f,l,o,n);return r._extremes[m._id]=b.findExtremes(m,l,{vpad:u/2}),h.length?(p.extendFlat(h[0].t,{wHover:u/2,tickLen:i}),h):[{t:{empty:!0}}]},calcCommon:t}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566}],883:[function(v,J,Z){var p=v("../../lib"),g=v("./ohlc_defaults"),b=v("../scatter/period_defaults"),y=v("./attributes");function e(n,t,a,r){a(r+".line.color"),a(r+".line.width",t.line.width),a(r+".line.dash",t.line.dash)}J.exports=function(n,t,a,r){function m(o,i){return p.coerce(n,t,y,o,i)}g(n,t,m,r)?(b(n,t,r,m,{x:!0}),m("xhoverformat"),m("yhoverformat"),m("line.width"),m("line.dash"),e(n,t,m,"increasing"),e(n,t,m,"decreasing"),m("text"),m("hovertext"),m("tickwidth"),r._requestRangeslider[t.xaxis]=!0):t.visible=!1}},{"../../lib":515,"../scatter/period_defaults":956,"./attributes":881,"./ohlc_defaults":886}],884:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("../../lib"),b=v("../../components/fx"),y=v("../../components/color"),e=v("../../lib").fillText,n=v("../../constants/delta.js"),t={increasing:n.INCREASING.SYMBOL,decreasing:n.DECREASING.SYMBOL};function a(o,i,u,f){var l,h,d=o.cd,s=o.xa,x=d[0].trace,c=d[0].t,T=x.type,_=T==="ohlc"?"l":"min",w=T==="ohlc"?"h":"max",k=c.bPos||0,L=c.bdPos||c.tickLen,A=c.wHover,I=Math.min(1,L/Math.abs(s.r2c(s.range[1])-s.r2c(s.range[0])));function P(X){var $=function(G){return G.pos+k-i}(X);return b.inbox($-A,$+A,l)}function S(X){var $=X[_],G=X[w];return $===G||b.inbox($-u,G-u,l)}function E(X){return(P(X)+S(X))/2}l=o.maxHoverDistance-I,h=o.maxSpikeDistance-I;var D=b.getDistanceFunction(f,P,S,E);if(b.getClosest(d,D,o),o.index===!1)return null;var R=d[o.index];if(R.empty)return null;var H=x[R.dir],V=H.line.color;return y.opacity(V)&&H.line.width?o.color=V:o.color=H.fillcolor,o.x0=s.c2p(R.pos+k-L,!0),o.x1=s.c2p(R.pos+k+L,!0),o.xLabelVal=R.orig_p!==void 0?R.orig_p:R.pos,o.spikeDistance=E(R)*h/l,o.xSpike=s.c2p(R.pos,!0),o}function r(o,i,u,f){var l=o.cd,h=o.ya,d=l[0].trace,s=l[0].t,x=[],c=a(o,i,u,f);if(!c)return[];var T=l[c.index].hi||d.hoverinfo,_=T.split("+");if(!(T==="all"||_.indexOf("y")!==-1))return[];for(var w=["high","open","close","low"],k={},L=0;L<w.length;L++){var A,I=w[L],P=d[I][c.index],S=h.c2p(P,!0);P in k?(A=k[P]).yLabel+="<br>"+s.labels[I]+p.hoverLabelText(h,P,d.yhoverformat):((A=g.extendFlat({},c)).y0=A.y1=S,A.yLabelVal=P,A.yLabel=s.labels[I]+p.hoverLabelText(h,P,d.yhoverformat),A.name="",x.push(A),k[P]=A)}return x}function m(o,i,u,f){var l=o.cd,h=o.ya,d=l[0].trace,s=l[0].t,x=a(o,i,u,f);if(!x)return[];var c=l[x.index],T=x.index=c.i,_=c.dir;function w(E){return s.labels[E]+p.hoverLabelText(h,d[E][T],d.yhoverformat)}var k=c.hi||d.hoverinfo,L=k.split("+"),A=k==="all",I=A||L.indexOf("y")!==-1,P=A||L.indexOf("text")!==-1,S=I?[w("open"),w("high"),w("low"),w("close")+"  "+t[_]]:[];return P&&e(c,d,S),x.extraText=S.join("<br>"),x.y0=x.y1=h.c2p(c.yc,!0),[x]}J.exports={hoverPoints:function(o,i,u,f){return o.cd[0].trace.hoverlabel.split?r(o,i,u,f):m(o,i,u,f)},hoverSplit:r,hoverOnPoints:m}},{"../../components/color":367,"../../components/fx":407,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axes":566}],885:[function(v,J,Z){J.exports={moduleType:"trace",name:"ohlc",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc").calc,plot:v("./plot"),style:v("./style"),hoverPoints:v("./hover").hoverPoints,selectPoints:v("./select")}},{"../../plots/cartesian":578,"./attributes":881,"./calc":882,"./defaults":883,"./hover":884,"./plot":887,"./select":888,"./style":889}],886:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib");J.exports=function(b,y,e,n){var t=e("x"),a=e("open"),r=e("high"),m=e("low"),o=e("close");if(e("hoverlabel.split"),p.getComponentMethod("calendars","handleTraceDefaults")(b,y,["x"],n),a&&r&&m&&o){var i=Math.min(a.length,r.length,m.length,o.length);return t&&(i=Math.min(i,g.minRowLength(t))),y._length=i,i}}},{"../../lib":515,"../../registry":647}],887:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib");J.exports=function(b,y,e,n){var t=y.yaxis,a=y.xaxis,r=!!a.rangebreaks;g.makeTraceGroups(n,e,"trace ohlc").each(function(m){var o=p.select(this),i=m[0],u=i.t;if(i.trace.visible!==!0||u.empty)o.remove();else{var f=u.tickLen,l=o.selectAll("path").data(g.identity);l.enter().append("path"),l.exit().remove(),l.attr("d",function(h){if(h.empty)return"M0,0Z";var d=a.c2p(h.pos-f,!0),s=a.c2p(h.pos+f,!0),x=r?(d+s)/2:a.c2p(h.pos,!0);return"M"+d+","+t.c2p(h.o,!0)+"H"+x+"M"+x+","+t.c2p(h.h,!0)+"V"+t.c2p(h.l,!0)+"M"+s+","+t.c2p(h.c,!0)+"H"+x})}})}},{"../../lib":515,"@plotly/d3":58}],888:[function(v,J,Z){J.exports=function(p,g){var b,y=p.cd,e=p.xaxis,n=p.yaxis,t=[],a=y[0].t.bPos||0;if(g===!1)for(b=0;b<y.length;b++)y[b].selected=0;else for(b=0;b<y.length;b++){var r=y[b];g.contains([e.c2p(r.pos+a),n.c2p(r.yc)],null,r.i,p)?(t.push({pointNumber:r.i,x:e.c2d(r.pos),y:n.c2d(r.yc)}),r.selected=1):r.selected=0}return t}},{}],889:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/drawing"),b=v("../../components/color");J.exports=function(y,e,n){var t=n||p.select(y).selectAll("g.ohlclayer").selectAll("g.trace");t.style("opacity",function(a){return a[0].trace.opacity}),t.each(function(a){var r=a[0].trace;p.select(this).selectAll("path").each(function(m){if(!m.empty){var o=r[m.dir].line;p.select(this).style("fill","none").call(b.stroke,o.color).call(g.dashLine,o.dash,o.width).style("opacity",r.selectedpoints&&!m.selected?.3:1)}})})}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],890:[function(v,J,Z){var p=v("../../lib/extend").extendFlat,g=v("../../plots/attributes"),b=v("../../plots/font_attributes"),y=v("../../components/colorscale/attributes"),e=v("../../plots/template_attributes").hovertemplateAttrs,n=v("../../plots/domain").attributes,t=p({editType:"calc"},y("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});J.exports={domain:n({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:p({},g.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:b({editType:"calc"}),tickfont:b({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:t,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],891:[function(v,J,Z){var p=v("../../plots/get_data").getModuleCalcData,g=v("./plot");Z.name="parcats",Z.plot=function(b,y,e,n){var t=p(b.calcdata,"parcats");if(t.length){var a=t[0];g(b,a,e,n)}},Z.clean=function(b,y,e,n){var t=n._has&&n._has("parcats"),a=y._has&&y._has("parcats");t&&!a&&n._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":602,"./plot":896}],892:[function(v,J,Z){var p=v("../../lib/gup").wrap,g=v("../../components/colorscale/helpers").hasColorscale,b=v("../../components/colorscale/calc"),y=v("../../lib/filter_unique.js"),e=v("../../components/drawing"),n=v("../../lib"),t=v("fast-isnumeric");function a(o,i,u){o.valueInds.push(i),o.count+=u}function r(o,i,u){return{categoryInds:o,color:i,rawColor:u,valueInds:[],count:0}}function m(o,i,u){o.valueInds.push(i),o.count+=u}J.exports=function(o,i){var u=n.filterVisible(i.dimensions);if(u.length===0)return[];var f,l,h,d=u.map(function(W){var te;if(W.categoryorder==="trace")te=null;else if(W.categoryorder==="array")te=W.categoryarray;else{te=y(W.values);for(var N=!0,B=0;B<te.length;B++)if(!t(te[B])){N=!1;break}te.sort(N?n.sorterAsc:void 0),W.categoryorder==="category descending"&&(te=te.reverse())}return function(U,ee){ee=ee==null?[]:ee.map(function(de){return de});var j={},Q={},K=[];ee.forEach(function(de,se){j[de]=0,Q[de]=se});for(var re=0;re<U.length;re++){var ne,le=U[re];j[le]===void 0?(j[le]=1,ne=ee.push(le)-1,Q[le]=ne):(j[le]++,ne=Q[le]),K.push(ne)}var oe=ee.map(function(de){return j[de]});return{uniqueValues:ee,uniqueCounts:oe,inds:K}}(W.values,te)});f=n.isArrayOrTypedArray(i.counts)?i.counts:[i.counts],function(W){var te;if(function(N){for(var B=new Array(N.length),U=0;U<N.length;U++){if(N[U]<0||N[U]>=N.length||B[N[U]]!==void 0)return!1;B[N[U]]=!0}return!0}(W.map(function(N){return N.displayindex})))for(te=0;te<W.length;te++)W[te]._displayindex=W[te].displayindex;else for(te=0;te<W.length;te++)W[te]._displayindex=te}(u),u.forEach(function(W,te){(function(N,B){N._categoryarray=B.uniqueValues,N.ticktext===null||N.ticktext===void 0?N._ticktext=[]:N._ticktext=N.ticktext.slice();for(var U=N._ticktext.length;U<B.uniqueValues.length;U++)N._ticktext.push(B.uniqueValues[U])})(W,d[te])});var s,x=i.line;x?(g(i,"line")&&b(o,i,{vals:i.line.color,containerStr:"line",cLetter:"c"}),s=e.tryColorscale(x)):s=n.identity;var c,T,_,w,k,L=u[0].values.length,A={},I=d.map(function(W){return W.inds});for(h=0,c=0;c<L;c++){var P=[];for(T=0;T<I.length;T++)P.push(I[T][c]);l=f[c%f.length],h+=l;var S=(_=c,w=void 0,k=void 0,n.isArrayOrTypedArray(x.color)?k=w=x.color[_%x.color.length]:w=x.color,{color:s(w),rawColor:k}),E=P+"-"+S.rawColor;A[E]===void 0&&(A[E]=r(P,S.color,S.rawColor)),m(A[E],c,l)}var D,R=u.map(function(W,te){return function(N,B,U,ee,j){return{dimensionInd:N,containerInd:B,displayInd:U,dimensionLabel:ee,count:j,categories:[],dragX:null}}(te,W._index,W._displayindex,W.label,h)});for(c=0;c<L;c++)for(l=f[c%f.length],T=0;T<R.length;T++){var H=R[T].containerInd,V=d[T].inds[c],X=R[T].categories;if(X[V]===void 0){var $=i.dimensions[H]._categoryarray[V],G=i.dimensions[H]._ticktext[V];X[V]={dimensionInd:T,categoryInd:D=V,categoryValue:$,displayInd:D,categoryLabel:G,valueInds:[],count:0,dragY:null}}a(X[V],c,l)}return p(function(W,te,N){var B=W.map(function(U){return U.categories.length}).reduce(function(U,ee){return Math.max(U,ee)});return{dimensions:W,paths:te,trace:void 0,maxCats:B,count:N}}(R,A,h))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../components/drawing":389,"../../lib":515,"../../lib/filter_unique.js":506,"../../lib/gup":512,"fast-isnumeric":190}],893:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/colorscale/helpers").hasColorscale,b=v("../../components/colorscale/defaults"),y=v("../../plots/domain").defaults,e=v("../../plots/array_container_defaults"),n=v("./attributes"),t=v("../parcoords/merge_length");function a(r,m){function o(s,x){return p.coerce(r,m,n.dimensions,s,x)}var i=o("values"),u=o("visible");if(i&&i.length||(u=m.visible=!1),u){o("label"),o("displayindex",m._index);var f,l=r.categoryarray,h=Array.isArray(l)&&l.length>0;h&&(f="array");var d=o("categoryorder",f);d==="array"?(o("categoryarray"),o("ticktext")):(delete r.categoryarray,delete r.ticktext),h||d!=="array"||(m.categoryorder="trace")}}J.exports=function(r,m,o,i){function u(s,x){return p.coerce(r,m,n,s,x)}var f=e(r,m,{name:"dimensions",handleItemDefaults:a}),l=function(s,x,c,T,_){_("line.shape"),_("line.hovertemplate");var w=_("line.color",T.colorway[0]);if(g(s,"line")&&p.isArrayOrTypedArray(w)){if(w.length)return _("line.colorscale"),b(s,x,T,_,{prefix:"line.",cLetter:"c"}),w.length;x.line.color=c}return 1/0}(r,m,o,i,u);y(m,i,u),Array.isArray(f)&&f.length||(m.visible=!1),t(m,f,"values",l),u("hoveron"),u("hovertemplate"),u("arrangement"),u("bundlecolors"),u("sortpaths"),u("counts");var h={family:i.font.family,size:Math.round(i.font.size),color:i.font.color};p.coerceFont(u,"labelfont",h);var d={family:i.font.family,size:Math.round(i.font.size/1.2),color:i.font.color};p.coerceFont(u,"tickfont",d)}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/domain":593,"../parcoords/merge_length":907,"./attributes":890}],894:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:v("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":890,"./base_plot":891,"./calc":892,"./defaults":893,"./plot":896}],895:[function(v,J,Z){var p=v("@plotly/d3"),g=v("d3-interpolate").interpolateNumber,b=v("../../plot_api/plot_api"),y=v("../../components/fx"),e=v("../../lib"),n=e.strTranslate,t=v("../../components/drawing"),a=v("tinycolor2"),r=v("../../lib/svg_text_utils");function m(N,B,U,ee){var j=N.map(X.bind(0,B,U)),Q=ee.selectAll("g.parcatslayer").data([null]);Q.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var K=Q.selectAll("g.trace.parcats").data(j,o),re=K.enter().append("g").attr("class","trace parcats");K.attr("transform",function(be){return n(be.x,be.y)}),re.append("g").attr("class","paths");var ne=K.select("g.paths").selectAll("path.path").data(function(be){return be.paths},o);ne.attr("fill",function(be){return be.model.color});var le=ne.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(be){return be.model.color}).attr("fill-opacity",0);x(le),ne.attr("d",function(be){return be.svgD}),le.empty()||ne.sort(u),ne.exit().remove(),ne.on("mouseover",f).on("mouseout",l).on("click",s),re.append("g").attr("class","dimensions");var oe=K.select("g.dimensions").selectAll("g.dimension").data(function(be){return be.dimensions},o);oe.enter().append("g").attr("class","dimension"),oe.attr("transform",function(be){return n(be.x,0)}),oe.exit().remove();var de=oe.selectAll("g.category").data(function(be){return be.categories},o),se=de.enter().append("g").attr("class","category");de.attr("transform",function(be){return n(0,be.y)}),se.append("rect").attr("class","catrect").attr("pointer-events","none"),de.select("rect.catrect").attr("fill","none").attr("width",function(be){return be.width}).attr("height",function(be){return be.height}),T(se);var me=de.selectAll("rect.bandrect").data(function(be){return be.bands},o);me.each(function(){e.raiseToTop(this)}),me.attr("fill",function(be){return be.color});var Te=me.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(be){return be.color}).attr("fill-opacity",0);me.attr("fill",function(be){return be.color}).attr("width",function(be){return be.width}).attr("height",function(be){return be.height}).attr("y",function(be){return be.y}).attr("cursor",function(be){return be.parcatsViewModel.arrangement==="fixed"?"default":be.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),_(Te),me.exit().remove(),se.append("text").attr("class","catlabel").attr("pointer-events","none");var _e=B._fullLayout.paper_bgcolor;de.select("text.catlabel").attr("text-anchor",function(be){return i(be)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",r.makeTextShadow(_e)).style("fill","rgb(0, 0, 0)").attr("x",function(be){return i(be)?be.width+5:-5}).attr("y",function(be){return be.height/2}).text(function(be){return be.model.categoryLabel}).each(function(be){t.font(p.select(this),be.parcatsViewModel.categorylabelfont),r.convertToTspans(p.select(this),B)}),se.append("text").attr("class","dimlabel"),de.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(be){return be.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(be){return be.width/2}).attr("y",-5).text(function(be,Ce){return Ce===0?be.parcatsViewModel.model.dimensions[be.model.dimensionInd].dimensionLabel:null}).each(function(be){t.font(p.select(this),be.parcatsViewModel.labelfont)}),de.selectAll("rect.bandrect").on("mouseover",I).on("mouseout",P),de.exit().remove(),oe.call(p.behavior.drag().origin(function(be){return{x:be.x,y:0}}).on("dragstart",S).on("drag",E).on("dragend",D)),K.each(function(be){be.traceSelection=p.select(this),be.pathSelection=p.select(this).selectAll("g.paths").selectAll("path.path"),be.dimensionSelection=p.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),K.exit().remove()}function o(N){return N.key}function i(N){var B=N.parcatsViewModel.dimensions.length,U=N.parcatsViewModel.dimensions[B-1].model.dimensionInd;return N.model.dimensionInd===U}function u(N,B){return N.model.rawColor>B.model.rawColor?1:N.model.rawColor<B.model.rawColor?-1:0}function f(N){if(!N.parcatsViewModel.dragDimension&&N.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),c(p.select(this));var B=h(N),U=d(N);if(N.parcatsViewModel.graphDiv.emit("plotly_hover",{points:B,event:p.event,constraints:U}),N.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var ee,j,Q,K=p.mouse(this)[0],re=N.parcatsViewModel.graphDiv,ne=N.parcatsViewModel.trace,le=re._fullLayout,oe=le._paperdiv.node().getBoundingClientRect(),de=N.parcatsViewModel.graphDiv.getBoundingClientRect();for(Q=0;Q<N.leftXs.length-1;Q++)if(N.leftXs[Q]+N.dimWidths[Q]-2<=K&&K<=N.leftXs[Q+1]+2){var se=N.parcatsViewModel.dimensions[Q],me=N.parcatsViewModel.dimensions[Q+1];ee=(se.x+se.width+me.x)/2,j=(N.topYs[Q]+N.topYs[Q+1]+N.height)/2;break}var Te=N.parcatsViewModel.x+ee,_e=N.parcatsViewModel.y+j,be=a.mostReadable(N.model.color,["black","white"]),Ce=N.model.count,fe=Ce/N.parcatsViewModel.model.count,ve={countLabel:Ce,probabilityLabel:fe.toFixed(3)},Me=[];N.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Me.push(["Count:",ve.countLabel].join(" ")),N.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&Me.push(["P:",ve.probabilityLabel].join(" "));var ke=Me.join("<br>"),Le=p.mouse(re)[0];y.loneHover({trace:ne,x:Te-oe.left+de.left,y:_e-oe.top+de.top,text:ke,color:N.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:be,idealAlign:Le<Te?"right":"left",hovertemplate:(ne.line||{}).hovertemplate,hovertemplateLabels:ve,eventData:[{data:ne._input,fullData:ne,count:Ce,probability:fe}]},{container:le._hoverlayer.node(),outerContainer:le._paper.node(),gd:re})}}}function l(N){if(!N.parcatsViewModel.dragDimension&&(x(p.select(this)),y.loneUnhover(N.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),N.parcatsViewModel.pathSelection.sort(u),N.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var B=h(N),U=d(N);N.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:B,event:p.event,constraints:U})}}function h(N){for(var B=[],U=R(N.parcatsViewModel),ee=0;ee<N.model.valueInds.length;ee++){var j=N.model.valueInds[ee];B.push({curveNumber:U,pointNumber:j})}return B}function d(N){for(var B={},U=N.parcatsViewModel.model.dimensions,ee=0;ee<U.length;ee++){var j=U[ee],Q=j.categories[N.model.categoryInds[ee]];B[j.containerInd]=Q.categoryValue}return N.model.rawColor!==void 0&&(B.color=N.model.rawColor),B}function s(N){if(N.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var B=h(N),U=d(N);N.parcatsViewModel.graphDiv.emit("plotly_click",{points:B,event:p.event,constraints:U})}}function x(N){N.attr("fill",function(B){return B.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function c(N){N.attr("fill-opacity",.8).attr("stroke",function(B){return a.mostReadable(B.model.color,["black","white"])}).attr("stroke-width",.3)}function T(N){N.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function _(N){N.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function w(N){var B=N.parcatsViewModel.pathSelection,U=N.categoryViewModel.model.dimensionInd,ee=N.categoryViewModel.model.categoryInd;return B.filter(function(j){return j.model.categoryInds[U]===ee&&j.model.color===N.color})}function k(N,B,U){var ee=p.select(N).datum(),j=ee.categoryViewModel.model,Q=ee.parcatsViewModel.graphDiv,K=p.select(N.parentNode).selectAll("rect.bandrect"),re=[];K.each(function(le){w(le).each(function(oe){Array.prototype.push.apply(re,h(oe))})});var ne={};ne[j.dimensionInd]=j.categoryValue,Q.emit(B,{points:re,event:U,constraints:ne})}function L(N,B,U){var ee=p.select(N).datum(),j=ee.categoryViewModel.model,Q=ee.parcatsViewModel.graphDiv,K=w(ee),re=[];K.each(function(le){Array.prototype.push.apply(re,h(le))});var ne={};ne[j.dimensionInd]=j.categoryValue,ee.rawColor!==void 0&&(ne.color=ee.rawColor),Q.emit(B,{points:re,event:U,constraints:ne})}function A(N,B,U){N._fullLayout._calcInverseTransform(N);var ee,j,Q=N._fullLayout._invScaleX,K=N._fullLayout._invScaleY,re=p.select(U.parentNode).select("rect.catrect"),ne=re.node().getBoundingClientRect(),le=re.datum(),oe=le.parcatsViewModel,de=oe.model.dimensions[le.model.dimensionInd],se=oe.trace,me=ne.top+ne.height/2;oe.dimensions.length>1&&de.displayInd===oe.dimensions.length-1?(ee=ne.left,j="left"):(ee=ne.left+ne.width,j="right");var Te=le.model.count,_e=le.model.categoryLabel,be=Te/le.parcatsViewModel.model.count,Ce={countLabel:Te,categoryLabel:_e,probabilityLabel:be.toFixed(3)},fe=[];le.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&fe.push(["Count:",Ce.countLabel].join(" ")),le.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&fe.push(["P("+Ce.categoryLabel+"):",Ce.probabilityLabel].join(" "));var ve=fe.join("<br>");return{trace:se,x:Q*(ee-B.left),y:K*(me-B.top),text:ve,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:j,hovertemplate:se.hovertemplate,hovertemplateLabels:Ce,eventData:[{data:se._input,fullData:se,count:Te,category:_e,probability:be}]}}function I(N){if(!N.parcatsViewModel.dragDimension&&N.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){if(p.mouse(this)[1]<-1)return;var B,U=N.parcatsViewModel.graphDiv,ee=U._fullLayout,j=ee._paperdiv.node().getBoundingClientRect(),Q=N.parcatsViewModel.hoveron;Q==="color"?(function(K){var re=p.select(K).datum(),ne=w(re);c(ne),ne.each(function(){e.raiseToTop(this)}),p.select(K.parentNode).selectAll("rect.bandrect").filter(function(le){return le.color===re.color}).each(function(){e.raiseToTop(this),p.select(this).attr("stroke","black").attr("stroke-width",1.5)})}(this),L(this,"plotly_hover",p.event)):(function(K){p.select(K.parentNode).selectAll("rect.bandrect").each(function(re){var ne=w(re);c(ne),ne.each(function(){e.raiseToTop(this)})}),p.select(K.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),k(this,"plotly_hover",p.event)),N.parcatsViewModel.hoverinfoItems.indexOf("none")===-1&&(Q==="category"?B=A(U,j,this):Q==="color"?B=function(K,re,ne){K._fullLayout._calcInverseTransform(K);var le,oe,de=K._fullLayout._invScaleX,se=K._fullLayout._invScaleY,me=ne.getBoundingClientRect(),Te=p.select(ne).datum(),_e=Te.categoryViewModel,be=_e.parcatsViewModel,Ce=be.model.dimensions[_e.model.dimensionInd],fe=be.trace,ve=me.y+me.height/2;be.dimensions.length>1&&Ce.displayInd===be.dimensions.length-1?(le=me.left,oe="left"):(le=me.left+me.width,oe="right");var Me=_e.model.categoryLabel,ke=Te.parcatsViewModel.model.count,Le=0;Te.categoryViewModel.bands.forEach(function(ot){ot.color===Te.color&&(Le+=ot.count)});var ze=_e.model.count,Re=0;be.pathSelection.each(function(ot){ot.model.color===Te.color&&(Re+=ot.model.count)});var Oe=Le/ke,Ze=Le/Re,Pe=Le/ze,Ie={countLabel:ke,categoryLabel:Me,probabilityLabel:Oe.toFixed(3)},Be=[];_e.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Be.push(["Count:",Ie.countLabel].join(" ")),_e.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(Be.push("P(color \u2229 "+Me+"): "+Ie.probabilityLabel),Be.push("P("+Me+" | color): "+Ze.toFixed(3)),Be.push("P(color | "+Me+"): "+Pe.toFixed(3)));var Fe=Be.join("<br>"),$e=a.mostReadable(Te.color,["black","white"]);return{trace:fe,x:de*(le-re.left),y:se*(ve-re.top),text:Fe,color:Te.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:$e,fontSize:10,idealAlign:oe,hovertemplate:fe.hovertemplate,hovertemplateLabels:Ie,eventData:[{data:fe._input,fullData:fe,category:Me,count:ke,probability:Oe,categorycount:ze,colorcount:Re,bandcolorcount:Le}]}}(U,j,this):Q==="dimension"&&(B=function(K,re,ne){var le=[];return p.select(ne.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){le.push(A(K,re,this))}),le}(U,j,this)),B&&y.loneHover(B,{container:ee._hoverlayer.node(),outerContainer:ee._paper.node(),gd:U}))}}function P(N){var B=N.parcatsViewModel;!B.dragDimension&&(x(B.pathSelection),T(B.dimensionSelection.selectAll("g.category")),_(B.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),y.loneUnhover(B.graphDiv._fullLayout._hoverlayer.node()),B.pathSelection.sort(u),B.hoverinfoItems.indexOf("skip")===-1)&&(N.parcatsViewModel.hoveron==="color"?L(this,"plotly_unhover",p.event):k(this,"plotly_unhover",p.event))}function S(N){N.parcatsViewModel.arrangement!=="fixed"&&(N.dragDimensionDisplayInd=N.model.displayInd,N.initialDragDimensionDisplayInds=N.parcatsViewModel.model.dimensions.map(function(B){return B.displayInd}),N.dragHasMoved=!1,N.dragCategoryDisplayInd=null,p.select(this).selectAll("g.category").select("rect.catrect").each(function(B){var U=p.mouse(this)[0],ee=p.mouse(this)[1];-2<=U&&U<=B.width+2&&-2<=ee&&ee<=B.height+2&&(N.dragCategoryDisplayInd=B.model.displayInd,N.initialDragCategoryDisplayInds=N.model.categories.map(function(j){return j.displayInd}),B.model.dragY=B.y,e.raiseToTop(this.parentNode),p.select(this.parentNode).selectAll("rect.bandrect").each(function(j){j.y<ee&&ee<=j.y+j.height&&(N.potentialClickBand=this)}))}),N.parcatsViewModel.dragDimension=N,y.loneUnhover(N.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function E(N){if(N.parcatsViewModel.arrangement!=="fixed"&&(N.dragHasMoved=!0,N.dragDimensionDisplayInd!==null)){var B=N.dragDimensionDisplayInd,U=B-1,ee=B+1,j=N.parcatsViewModel.dimensions[B];if(N.dragCategoryDisplayInd!==null){var Q=j.categories[N.dragCategoryDisplayInd];Q.model.dragY+=p.event.dy;var K=Q.model.dragY,re=Q.model.displayInd,ne=j.categories,le=ne[re-1],oe=ne[re+1];le!==void 0&&K<le.y+le.height/2&&(Q.model.displayInd=le.model.displayInd,le.model.displayInd=re),oe!==void 0&&K+Q.height>oe.y+oe.height/2&&(Q.model.displayInd=oe.model.displayInd,oe.model.displayInd=re),N.dragCategoryDisplayInd=Q.model.displayInd}if(N.dragCategoryDisplayInd===null||N.parcatsViewModel.arrangement==="freeform"){j.model.dragX=p.event.x;var de=N.parcatsViewModel.dimensions[U],se=N.parcatsViewModel.dimensions[ee];de!==void 0&&j.model.dragX<de.x+de.width&&(j.model.displayInd=de.model.displayInd,de.model.displayInd=B),se!==void 0&&j.model.dragX+j.width>se.x&&(j.model.displayInd=se.model.displayInd,se.model.displayInd=N.dragDimensionDisplayInd),N.dragDimensionDisplayInd=j.model.displayInd}W(N.parcatsViewModel),G(N.parcatsViewModel),V(N.parcatsViewModel),H(N.parcatsViewModel)}}function D(N){if(N.parcatsViewModel.arrangement!=="fixed"&&N.dragDimensionDisplayInd!==null){p.select(this).selectAll("text").attr("font-weight","normal");var B={},U=R(N.parcatsViewModel),ee=N.parcatsViewModel.model.dimensions.map(function(oe){return oe.displayInd}),j=N.initialDragDimensionDisplayInds.some(function(oe,de){return oe!==ee[de]});j&&ee.forEach(function(oe,de){var se=N.parcatsViewModel.model.dimensions[de].containerInd;B["dimensions["+se+"].displayindex"]=oe});var Q=!1;if(N.dragCategoryDisplayInd!==null){var K=N.model.categories.map(function(oe){return oe.displayInd});if(Q=N.initialDragCategoryDisplayInds.some(function(oe,de){return oe!==K[de]})){var re=N.model.categories.slice().sort(function(oe,de){return oe.displayInd-de.displayInd}),ne=re.map(function(oe){return oe.categoryValue}),le=re.map(function(oe){return oe.categoryLabel});B["dimensions["+N.model.containerInd+"].categoryarray"]=[ne],B["dimensions["+N.model.containerInd+"].ticktext"]=[le],B["dimensions["+N.model.containerInd+"].categoryorder"]="array"}}N.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!N.dragHasMoved&&N.potentialClickBand&&(N.parcatsViewModel.hoveron==="color"?L(N.potentialClickBand,"plotly_click",p.event.sourceEvent):k(N.potentialClickBand,"plotly_click",p.event.sourceEvent)),N.model.dragX=null,N.dragCategoryDisplayInd!==null&&(N.parcatsViewModel.dimensions[N.dragDimensionDisplayInd].categories[N.dragCategoryDisplayInd].model.dragY=null,N.dragCategoryDisplayInd=null),N.dragDimensionDisplayInd=null,N.parcatsViewModel.dragDimension=null,N.dragHasMoved=null,N.potentialClickBand=null,W(N.parcatsViewModel),G(N.parcatsViewModel),p.transition().duration(300).ease("cubic-in-out").each(function(){V(N.parcatsViewModel,!0),H(N.parcatsViewModel,!0)}).each("end",function(){(j||Q)&&b.restyle(N.parcatsViewModel.graphDiv,B,[U])})}}function R(N){for(var B,U=N.graphDiv._fullData,ee=0;ee<U.length;ee++)if(N.key===U[ee].uid){B=ee;break}return B}function H(N,B){var U;B===void 0&&(B=!1),N.pathSelection.data(function(ee){return ee.paths},o),(U=N.pathSelection,B?U.transition():U).attr("d",function(ee){return ee.svgD})}function V(N,B){function U(K){return B?K.transition():K}B===void 0&&(B=!1),N.dimensionSelection.data(function(K){return K.dimensions},o);var ee=N.dimensionSelection.selectAll("g.category").data(function(K){return K.categories},o);U(N.dimensionSelection).attr("transform",function(K){return n(K.x,0)}),U(ee).attr("transform",function(K){return n(0,K.y)}),ee.select(".dimlabel").text(function(K,re){return re===0?K.parcatsViewModel.model.dimensions[K.model.dimensionInd].dimensionLabel:null}),ee.select(".catlabel").attr("text-anchor",function(K){return i(K)?"start":"end"}).attr("x",function(K){return i(K)?K.width+5:-5}).each(function(K){var re,ne;i(K)?(re=K.width+5,ne="start"):(re=-5,ne="end"),p.select(this).selectAll("tspan").attr("x",re).attr("text-anchor",ne)});var j=ee.selectAll("rect.bandrect").data(function(K){return K.bands},o),Q=j.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(K){return K.color}).attr("fill-opacity",0);j.attr("fill",function(K){return K.color}).attr("width",function(K){return K.width}).attr("height",function(K){return K.height}).attr("y",function(K){return K.y}),_(Q),j.each(function(){e.raiseToTop(this)}),j.exit().remove()}function X(N,B,U){var ee,j=U[0],Q=B.margin||{l:80,r:80,t:100,b:80},K=j.trace,re=K.domain,ne=B.width,le=B.height,oe=Math.floor(ne*(re.x[1]-re.x[0])),de=Math.floor(le*(re.y[1]-re.y[0])),se=re.x[0]*ne+Q.l,me=B.height-re.y[1]*B.height+Q.t,Te=K.line.shape;ee=K.hoverinfo==="all"?["count","probability"]:(K.hoverinfo||"").split("+");var _e={trace:K,key:K.uid,model:j,x:se,y:me,width:oe,height:de,hoveron:K.hoveron,hoverinfoItems:ee,arrangement:K.arrangement,bundlecolors:K.bundlecolors,sortpaths:K.sortpaths,labelfont:K.labelfont,categorylabelfont:K.tickfont,pathShape:Te,dragDimension:null,margin:Q,paths:[],dimensions:[],graphDiv:N,traceSelection:null,pathSelection:null,dimensionSelection:null};return j.dimensions&&(W(_e),G(_e)),_e}function $(N,B,U,ee,j){var Q,K,re=[],ne=[];for(K=0;K<U.length-1;K++)Q=g(U[K]+N[K],N[K+1]),re.push(Q(j)),ne.push(Q(1-j));var le="M "+N[0]+","+B[0];for(le+="l"+U[0]+",0 ",K=1;K<U.length;K++)le+="C"+re[K-1]+","+B[K-1]+" "+ne[K-1]+","+B[K]+" "+N[K]+","+B[K],le+="l"+U[K]+",0 ";for(le+="l0,"+ee+" ",le+="l -"+U[U.length-1]+",0 ",K=U.length-2;K>=0;K--)le+="C"+ne[K]+","+(B[K+1]+ee)+" "+re[K]+","+(B[K]+ee)+" "+(N[K]+U[K])+","+(B[K]+ee),le+="l-"+U[K]+",0 ";return le+="Z"}function G(N){var B=N.dimensions,U=N.model,ee=B.map(function(Be){return Be.categories.map(function(Fe){return Fe.y})}),j=N.model.dimensions.map(function(Be){return Be.categories.map(function(Fe){return Fe.displayInd})}),Q=N.model.dimensions.map(function(Be){return Be.displayInd}),K=N.dimensions.map(function(Be){return Be.model.dimensionInd}),re=B.map(function(Be){return Be.x}),ne=B.map(function(Be){return Be.width}),le=[];for(var oe in U.paths)U.paths.hasOwnProperty(oe)&&le.push(U.paths[oe]);function de(Be){var Fe=Be.categoryInds.map(function($e,ot){return j[ot][$e]});return K.map(function($e){return Fe[$e]})}le.sort(function(Be,Fe){var $e=de(Be),ot=de(Fe);return N.sortpaths==="backward"&&($e.reverse(),ot.reverse()),$e.push(Be.valueInds[0]),ot.push(Fe.valueInds[0]),N.bundlecolors&&($e.unshift(Be.rawColor),ot.unshift(Fe.rawColor)),$e<ot?-1:$e>ot?1:0});for(var se=new Array(le.length),me=B[0].model.count,Te=B[0].categories.map(function(Be){return Be.height}).reduce(function(Be,Fe){return Be+Fe}),_e=0;_e<le.length;_e++){var be,Ce=le[_e];be=me>0?Te*(Ce.count/me):0;for(var fe,ve=new Array(ee.length),Me=0;Me<Ce.categoryInds.length;Me++){var ke=Ce.categoryInds[Me],Le=j[Me][ke],ze=Q[Me];ve[ze]=ee[ze][Le],ee[ze][Le]+=be;var Re=N.dimensions[ze].categories[Le],Oe=Re.bands.length,Ze=Re.bands[Oe-1];if(Ze===void 0||Ce.rawColor!==Ze.rawColor){var Pe=Ze===void 0?0:Ze.y+Ze.height;Re.bands.push({key:Pe,color:Ce.color,rawColor:Ce.rawColor,height:be,width:Re.width,count:Ce.count,y:Pe,categoryViewModel:Re,parcatsViewModel:N})}else{var Ie=Re.bands[Oe-1];Ie.height+=be,Ie.count+=Ce.count}}fe=N.pathShape==="hspline"?$(re,ve,ne,be,.5):$(re,ve,ne,be,0),se[_e]={key:Ce.valueInds[0],model:Ce,height:be,leftXs:re,topYs:ve,dimWidths:ne,svgD:fe,parcatsViewModel:N}}N.paths=se}function W(N){var B=N.model.dimensions.map(function(K){return{displayInd:K.displayInd,dimensionInd:K.dimensionInd}});B.sort(function(K,re){return K.displayInd-re.displayInd});var U=[];for(var ee in B){var j=B[ee].dimensionInd,Q=N.model.dimensions[j];U.push(te(N,Q))}N.dimensions=U}function te(N,B){var U,ee=N.model.dimensions.length,j=B.displayInd;U=40+(ee>1?(N.width-80-16)/(ee-1):0)*j;var Q,K,re,ne,le,oe=[],de=N.model.maxCats,se=B.categories.length,me=B.count,Te=N.height-8*(de-1),_e=8*(de-se)/2,be=B.categories.map(function(Ce){return{displayInd:Ce.displayInd,categoryInd:Ce.categoryInd}});for(be.sort(function(Ce,fe){return Ce.displayInd-fe.displayInd}),le=0;le<se;le++)ne=be[le].categoryInd,K=B.categories[ne],Q=me>0?K.count/me*Te:0,re={key:K.valueInds[0],model:K,width:16,height:Q,y:K.dragY!==null?K.dragY:_e,bands:[],parcatsViewModel:N},_e=_e+Q+8,oe.push(re);return{key:B.dimensionInd,x:B.dragX!==null?B.dragX:U,y:0,width:16,model:B,categories:oe,parcatsViewModel:N,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}J.exports=function(N,B,U,ee){m(U,N,ee,B)}},{"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_api":552,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:313}],896:[function(v,J,Z){var p=v("./parcats");J.exports=function(g,b,y,e){var n=g._fullLayout,t=n._paper,a=n._size;p(g,t,b,{width:a.w,height:a.h,margin:{t:a.t,r:a.r,b:a.b,l:a.l}},y,e)}},{"./parcats":895}],897:[function(v,J,Z){var p=v("../../components/colorscale/attributes"),g=v("../../plots/cartesian/layout_attributes"),b=v("../../plots/font_attributes"),y=v("../../plots/domain").attributes,e=v("../../lib/extend").extendFlat,n=v("../../plot_api/plot_template").templatedArray;J.exports={domain:y({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:b({editType:"plot"}),tickfont:b({editType:"plot"}),rangefont:b({editType:"plot"}),dimensions:n("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},g.tickvals,{editType:"plot"}),ticktext:e({},g.ticktext,{editType:"plot"}),tickformat:e({},g.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},p("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"})),unselected:{line:{color:{valType:"color",dflt:"#7f7f7f",editType:"plot"},opacity:{valType:"number",min:0,max:1,dflt:"auto",editType:"plot"},editType:"plot"},editType:"plot"}}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],898:[function(v,J,Z){var p=v("./constants"),g=v("@plotly/d3"),b=v("../../lib/gup").keyFun,y=v("../../lib/gup").repeat,e=v("../../lib").sorterAsc,n=v("../../lib").strTranslate,t=p.bar.snapRatio;function a(A,I){return A*(1-t)+I*t}var r=p.bar.snapClose;function m(A,I){return A*(1-r)+I*r}function o(A,I,P,S){if(function(te,N){for(var B=0;B<N.length;B++)if(te>=N[B][0]&&te<=N[B][1])return!0;return!1}(P,S))return P;var E=A?-1:1,D=0,R=I.length-1;if(E<0){var H=D;D=R,R=H}for(var V=I[D],X=V,$=D;E*$<E*R;$+=E){var G=$+E,W=I[G];if(E*P<E*m(V,W))return a(V,X);if(E*P<E*W||G===R)return a(W,V);X=V,V=W}}function i(A){A.attr("x",-p.bar.captureWidth/2).attr("width",p.bar.captureWidth)}function u(A){A.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function f(A){if(!A.brush.filterSpecified)return"0,"+A.height;for(var I,P,S,E=l(A.brush.filter.getConsolidated(),A.height),D=[0],R=E.length?E[0][0]:null,H=0;H<E.length;H++)P=(I=E[H])[1]-I[0],D.push(R),D.push(P),(S=H+1)<E.length&&(R=E[S][0]-I[1]);return D.push(A.height),D}function l(A,I){return A.map(function(P){return P.map(function(S){return Math.max(0,S*I)}).sort(e)})}function h(){g.select(document.body).style("cursor",null)}function d(A){A.attr("stroke-dasharray",f)}function s(A,I){var P=g.select(A).selectAll(".highlight, .highlight-shadow");d(I?P.transition().duration(p.bar.snapDuration).each("end",I):P)}function x(A,I){var P,S=A.brush,E=NaN,D={};if(S.filterSpecified){var R=A.height,H=S.filter.getConsolidated(),V=l(H,R),X=NaN,$=NaN,G=NaN;for(P=0;P<=V.length;P++){var W=V[P];if(W&&W[0]<=I&&I<=W[1]){X=P;break}if($=P?P-1:NaN,W&&W[0]>I){G=P;break}}if(E=X,isNaN(E)&&(E=isNaN($)||isNaN(G)?isNaN($)?G:$:I-V[$][1]<V[G][0]-I?$:G),!isNaN(E)){var te=V[E],N=function(j,Q){var K=p.bar.handleHeight;if(!(Q>j[1]+K||Q<j[0]-K))return Q>=.9*j[1]+.1*j[0]?"n":Q<=.9*j[0]+.1*j[1]?"s":"ns"}(te,I);N&&(D.interval=H[E],D.intervalPix=te,D.region=N)}}if(A.ordinal&&!D.region){var B=A.unitTickvals,U=A.unitToPaddedPx.invert(I);for(P=0;P<B.length;P++){var ee=[.25*B[Math.max(P-1,0)]+.75*B[P],.25*B[Math.min(P+1,B.length-1)]+.75*B[P]];if(U>=ee[0]&&U<=ee[1]){D.clickableOrdinalRange=ee;break}}}return D}function c(A,I){g.event.sourceEvent.stopPropagation();var P=I.height-g.mouse(A)[1]-2*p.verticalPadding,S=I.brush.svgBrush;S.wasDragged=!0,S._dragging=!0,S.grabbingBar?S.newExtent=[P-S.grabPoint,P+S.barLength-S.grabPoint].map(I.unitToPaddedPx.invert):S.newExtent=[S.startExtent,I.unitToPaddedPx.invert(P)].sort(e),I.brush.filterSpecified=!0,S.extent=S.stayingIntervals.concat([S.newExtent]),S.brushCallback(I),s(A.parentNode)}function T(A,I){var P=x(I,I.height-g.mouse(A)[1]-2*p.verticalPadding),S="crosshair";P.clickableOrdinalRange?S="pointer":P.region&&(S=P.region+"-resize"),g.select(document.body).style("cursor",S)}function _(A){A.on("mousemove",function(I){g.event.preventDefault(),I.parent.inBrushDrag||T(this,I)}).on("mouseleave",function(I){I.parent.inBrushDrag||h()}).call(g.behavior.drag().on("dragstart",function(I){(function(P,S){g.event.sourceEvent.stopPropagation();var E=S.height-g.mouse(P)[1]-2*p.verticalPadding,D=S.unitToPaddedPx.invert(E),R=S.brush,H=x(S,E),V=H.interval,X=R.svgBrush;if(X.wasDragged=!1,X.grabbingBar=H.region==="ns",X.grabbingBar){var $=V.map(S.unitToPaddedPx);X.grabPoint=E-$[0]-p.verticalPadding,X.barLength=$[1]-$[0]}X.clickableOrdinalRange=H.clickableOrdinalRange,X.stayingIntervals=S.multiselect&&R.filterSpecified?R.filter.getConsolidated():[],V&&(X.stayingIntervals=X.stayingIntervals.filter(function(G){return G[0]!==V[0]&&G[1]!==V[1]})),X.startExtent=H.region?V[H.region==="s"?1:0]:D,S.parent.inBrushDrag=!0,X.brushStartCallback()})(this,I)}).on("drag",function(I){c(this,I)}).on("dragend",function(I){(function(P,S){var E=S.brush,D=E.filter,R=E.svgBrush;R._dragging||(T(P,S),c(P,S),S.brush.svgBrush.wasDragged=!1),R._dragging=!1,g.event.sourceEvent.stopPropagation();var H=R.grabbingBar;if(R.grabbingBar=!1,R.grabLocation=void 0,S.parent.inBrushDrag=!1,h(),!R.wasDragged)return R.wasDragged=void 0,R.clickableOrdinalRange?E.filterSpecified&&S.multiselect?R.extent.push(R.clickableOrdinalRange):(R.extent=[R.clickableOrdinalRange],E.filterSpecified=!0):H?(R.extent=R.stayingIntervals,R.extent.length===0&&k(E)):k(E),R.brushCallback(S),s(P.parentNode),void R.brushEndCallback(E.filterSpecified?D.getConsolidated():[]);var V=function(){D.set(D.getConsolidated())};if(S.ordinal){var X=S.unitTickvals;X[X.length-1]<X[0]&&X.reverse(),R.newExtent=[o(0,X,R.newExtent[0],R.stayingIntervals),o(1,X,R.newExtent[1],R.stayingIntervals)];var $=R.newExtent[1]>R.newExtent[0];R.extent=R.stayingIntervals.concat($?[R.newExtent]:[]),R.extent.length||k(E),R.brushCallback(S),$?s(P.parentNode,V):(V(),s(P.parentNode))}else V();R.brushEndCallback(E.filterSpecified?D.getConsolidated():[])})(this,I)}))}function w(A,I){return A[0]-I[0]}function k(A){A.filterSpecified=!1,A.svgBrush.extent=[[-1/0,1/0]]}function L(A){for(var I,P=A.slice(),S=[],E=P.shift();E;){for(I=E.slice();(E=P.shift())&&E[0]<=I[1];)I[1]=Math.max(I[1],E[1]);S.push(I)}return S.length===1&&S[0][0]>S[0][1]&&(S=[]),S}J.exports={makeBrush:function(A,I,P,S,E,D){var R,H=function(){var V,X,$=[];return{set:function(G){($=G.map(function(W){return W.slice().sort(e)}).sort(w)).length===1&&$[0][0]===-1/0&&$[0][1]===1/0&&($=[[0,-1]]),V=L($),X=$.reduce(function(W,te){return[Math.min(W[0],te[0]),Math.max(W[1],te[1])]},[1/0,-1/0])},get:function(){return $.slice()},getConsolidated:function(){return V},getBounds:function(){return X}}}();return H.set(P),{filter:H,filterSpecified:I,svgBrush:{extent:[],brushStartCallback:S,brushCallback:(R=E,function(V){var X=V.brush,$=function(G){return G.svgBrush.extent.map(function(W){return W.slice()})}(X).slice();X.filter.set($),R()}),brushEndCallback:D}}},ensureAxisBrush:function(A,I){var P=A.selectAll("."+p.cn.axisBrush).data(y,b);P.enter().append("g").classed(p.cn.axisBrush,!0),function(S,E){var D=S.selectAll(".background").data(y);D.enter().append("rect").classed("background",!0).call(i).call(u).style("pointer-events","auto").attr("transform",n(0,p.verticalPadding)),D.call(_).attr("height",function(V){return V.height-p.verticalPadding});var R=S.selectAll(".highlight-shadow").data(y);R.enter().append("line").classed("highlight-shadow",!0).attr("x",-p.bar.width/2).attr("stroke-width",p.bar.width+p.bar.strokeWidth).attr("stroke",E).attr("opacity",p.bar.strokeOpacity).attr("stroke-linecap","butt"),R.attr("y1",function(V){return V.height}).call(d);var H=S.selectAll(".highlight").data(y);H.enter().append("line").classed("highlight",!0).attr("x",-p.bar.width/2).attr("stroke-width",p.bar.width-p.bar.strokeWidth).attr("stroke",p.bar.fillColor).attr("opacity",p.bar.fillOpacity).attr("stroke-linecap","butt"),H.attr("y1",function(V){return V.height}).call(d)}(P,I)},cleanRanges:function(A,I){if(Array.isArray(A[0])?(A=A.map(function(S){return S.sort(e)}),A=I.multiselect?L(A.sort(w)):[A[0]]):A=[A.sort(e)],I.tickvals){var P=I.tickvals.slice().sort(e);if(!(A=A.map(function(S){var E=[o(0,P,S[0],[]),o(1,P,S[1],[])];if(E[1]>E[0])return E}).filter(function(S){return S})).length)return}return A.length>1?A:A[0]}}},{"../../lib":515,"../../lib/gup":512,"./constants":902,"@plotly/d3":58}],899:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:v("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":897,"./base_plot":900,"./calc":901,"./defaults":903}],900:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../plots/get_data").getModuleCalcData,b=v("./plot"),y=v("../../constants/xmlns_namespaces");Z.name="parcoords",Z.plot=function(e){var n=g(e.calcdata,"parcoords")[0];n.length&&b(e,n)},Z.clean=function(e,n,t,a){var r=a._has&&a._has("parcoords"),m=n._has&&n._has("parcoords");r&&!m&&(a._paperdiv.selectAll(".parcoords").remove(),a._glimages.selectAll("*").remove())},Z.toSVG=function(e){var n=e._fullLayout._glimages,t=p.select(e).selectAll(".svg-container");t.filter(function(a,r){return r===t.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var a=this.toDataURL("image/png");n.append("svg:image").attr({xmlns:y.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){p.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":492,"../../plots/get_data":602,"./plot":909,"@plotly/d3":58}],901:[function(v,J,Z){var p=v("../../lib").isArrayOrTypedArray,g=v("../../components/colorscale"),b=v("../../lib/gup").wrap;J.exports=function(y,e){var n,t;return g.hasColorscale(e,"line")&&p(e.line.color)?(n=e.line.color,t=g.extractOpts(e.line).colorscale,g.calc(y,e,{vals:n,containerStr:"line",cLetter:"c"})):(n=function(a){for(var r=new Array(a),m=0;m<a;m++)r[m]=.5;return r}(e._length),t=[[0,e.line.color],[1,e.line.color]]),b({lineColor:n,cscale:t})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512}],902:[function(v,J,Z){J.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],903:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/colorscale/helpers").hasColorscale,b=v("../../components/colorscale/defaults"),y=v("../../plots/domain").defaults,e=v("../../plots/array_container_defaults"),n=v("../../plots/cartesian/axes"),t=v("./attributes"),a=v("./axisbrush"),r=v("./constants").maxDimensionCount,m=v("./merge_length");function o(i,u,f,l){function h(T,_){return p.coerce(i,u,t.dimensions,T,_)}var d=h("values"),s=h("visible");if(d&&d.length||(s=u.visible=!1),s){h("label"),h("tickvals"),h("ticktext"),h("tickformat");var x=h("range");u._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:x},n.setConvert(u._ax,l.layout),h("multiselect");var c=h("constraintrange");c&&(u.constraintrange=a.cleanRanges(c,u))}}J.exports=function(i,u,f,l){function h(T,_){return p.coerce(i,u,t,T,_)}var d=i.dimensions;Array.isArray(d)&&d.length>r&&(p.log("parcoords traces support up to "+r+" dimensions at the moment"),d.splice(r));var s=e(i,u,{name:"dimensions",layout:l,handleItemDefaults:o}),x=function(T,_,w,k,L){var A=L("line.color",w);if(g(T,"line")&&p.isArrayOrTypedArray(A)){if(A.length)return L("line.colorscale"),b(T,_,k,L,{prefix:"line.",cLetter:"c"}),A.length;_.line.color=w}return 1/0}(i,u,f,l,h);y(u,l,h),Array.isArray(s)&&s.length||(u.visible=!1),m(u,s,"values",x);var c={family:l.font.family,size:Math.round(l.font.size/1.2),color:l.font.color};p.coerceFont(h,"labelfont",c),p.coerceFont(h,"tickfont",c),p.coerceFont(h,"rangefont",c),h("labelangle"),h("labelside"),h("unselected.line.color"),h("unselected.line.opacity")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../../plots/domain":593,"./attributes":897,"./axisbrush":898,"./constants":902,"./merge_length":907}],904:[function(v,J,Z){var p=v("../../lib").isTypedArray;Z.convertTypedArray=function(g){return p(g)?Array.prototype.slice.call(g):g},Z.isOrdinal=function(g){return!!g.tickvals},Z.isVisible=function(g){return g.visible||!("visible"in g)}},{"../../lib":515}],905:[function(v,J,Z){var p=v("./base_index");p.plot=v("./plot"),J.exports=p},{"./base_index":899,"./plot":909}],906:[function(v,J,Z){var p=v("glslify"),g=p([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),b=p([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),y=v("./constants").maxDimensionCount,e=v("../../lib"),n=new Uint8Array(4),t=new Uint8Array(4),a={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function r(s,x,c,T,_){var w=s._gl;w.enable(w.SCISSOR_TEST),w.scissor(x,c,T,_),s.clear({color:[0,0,0,0],depth:1})}function m(s,x,c,T,_,w){var k=w.key;c.drawCompleted||(function(L){L.read({x:0,y:0,width:1,height:1,data:n})}(s),c.drawCompleted=!0),function L(A){var I=Math.min(T,_-A*T);A===0&&(window.cancelAnimationFrame(c.currentRafs[k]),delete c.currentRafs[k],r(s,w.scissorX,w.scissorY,w.scissorWidth,w.viewBoxSize[1])),c.clearOnly||(w.count=2*I,w.offset=2*A*T,x(w),A*T+I<_&&(c.currentRafs[k]=window.requestAnimationFrame(function(){L(A+1)})),c.drawCompleted=!1)}(0)}function o(s,x){for(var c=new Array(256),T=0;T<256;T++)c[T]=s(T/255).concat(x);return c}function i(s,x){return(s>>>8*x)%256/255}function u(s,x,c){for(var T=new Array(8*x),_=0,w=0;w<x;w++)for(var k=0;k<2;k++)for(var L=0;L<4;L++){var A=4*s+L,I=c[64*w+A];A===63&&k===0&&(I*=-1),T[_++]=I}return T}function f(s){var x="0"+s;return x.substr(x.length-2)}function l(s){return s<y?"p"+f(s+1)+"_"+f(s+4):"colors"}function h(s,x,c,T,_,w,k,L,A,I,P,S,E,D){for(var R=[[],[]],H=0;H<64;H++)R[0][H]=H===_?1:0,R[1][H]=H===w?1:0;k*=D,L*=D,A*=D,I*=D;var V=s.lines.canvasOverdrag*D,X=s.domain,$=s.canvasWidth*D,G=s.canvasHeight*D,W=s.pad.l*D,te=s.pad.b*D,N=s.layoutHeight*D,B=s.layoutWidth*D,U=s.deselectedLines.color,ee=s.deselectedLines.opacity;return e.extendFlat({key:P,resolution:[$,G],viewBoxPos:[k+V,L],viewBoxSize:[A,I],i0:_,i1:w,dim0A:R[0].slice(0,16),dim0B:R[0].slice(16,32),dim0C:R[0].slice(32,48),dim0D:R[0].slice(48,64),dim1A:R[1].slice(0,16),dim1B:R[1].slice(16,32),dim1C:R[1].slice(32,48),dim1D:R[1].slice(48,64),drwLayer:S,contextColor:[U[0]/255,U[1]/255,U[2]/255,ee!=="auto"?U[3]*ee:Math.max(1/255,Math.pow(1/s.lines.color.length,1/3))],scissorX:(T===x?0:k+V)+(W-V)+B*X.x[0],scissorWidth:(T===c?$-k+V:A+.5)+(T===x?k+V:0),scissorY:L+te+N*X.y[0],scissorHeight:I,viewportX:W-V+B*X.x[0],viewportY:te+N*X.y[0],viewportWidth:$,viewportHeight:G},E)}function d(s){var x=Math.max(0,Math.floor(2047*s[0]),0),c=Math.min(2047,Math.ceil(2047*s[1]),2047);return[Math.min(x,c),Math.max(x,c)]}J.exports=function(s,x){var c,T,_,w,k,L=x.context,A=x.pick,I=x.regl,P=I._gl,S=P.getParameter(P.ALIASED_LINE_WIDTH_RANGE),E=Math.max(S[0],Math.min(S[1],x.viewModel.plotGlPixelRatio)),D={currentRafs:{},drawCompleted:!0,clearOnly:!1},R=function(G){for(var W={},te=0;te<=y;te+=4)W[l(te)]=G.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return W}(I),H=I.texture(a),V=[];$(x);var X=I({profile:!1,blend:{enable:L,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!L,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:I.prop("scissorX"),y:I.prop("scissorY"),width:I.prop("scissorWidth"),height:I.prop("scissorHeight")}},viewport:{x:I.prop("viewportX"),y:I.prop("viewportY"),width:I.prop("viewportWidth"),height:I.prop("viewportHeight")},dither:!1,vert:g,frag:b,primitive:"lines",lineWidth:E,attributes:R,uniforms:{resolution:I.prop("resolution"),viewBoxPos:I.prop("viewBoxPos"),viewBoxSize:I.prop("viewBoxSize"),dim0A:I.prop("dim0A"),dim1A:I.prop("dim1A"),dim0B:I.prop("dim0B"),dim1B:I.prop("dim1B"),dim0C:I.prop("dim0C"),dim1C:I.prop("dim1C"),dim0D:I.prop("dim0D"),dim1D:I.prop("dim1D"),loA:I.prop("loA"),hiA:I.prop("hiA"),loB:I.prop("loB"),hiB:I.prop("hiB"),loC:I.prop("loC"),hiC:I.prop("hiC"),loD:I.prop("loD"),hiD:I.prop("hiD"),palette:H,contextColor:I.prop("contextColor"),maskTexture:I.prop("maskTexture"),drwLayer:I.prop("drwLayer"),maskHeight:I.prop("maskHeight")},offset:I.prop("offset"),count:I.prop("count")});function $(G){c=G.model,T=G.viewModel,_=T.dimensions.slice(),w=_[0]?_[0].values.length:0;var W=c.lines,te=A?W.color.map(function(B,U){return U/W.color.length}):W.color,N=function(B,U,ee){for(var j,Q=new Array(B*(y+4)),K=0,re=0;re<B;re++){for(var ne=0;ne<y;ne++)Q[K++]=ne<U.length?U[ne].paddedUnitValues[re]:.5;Q[K++]=i(re,2),Q[K++]=i(re,1),Q[K++]=i(re,0),Q[K++]=(j=ee[re],Math.max(1e-6,Math.min(.999999,j)))}return Q}(w,_,te);(function(B,U,ee){for(var j=0;j<=y;j+=4)B[l(j)](u(j/4,U,ee))})(R,w,N),L||A||(H=I.texture(e.extendFlat({data:o(c.unitToColor,255)},a)))}return{render:function(G,W,te){var N,B,U,ee=G.length,j=1/0,Q=-1/0;for(N=0;N<ee;N++)G[N].dim0.canvasX<j&&(j=G[N].dim0.canvasX,B=N),G[N].dim1.canvasX>Q&&(Q=G[N].dim1.canvasX,U=N);ee===0&&r(I,0,0,c.canvasWidth,c.canvasHeight);var K=function(be){var Ce,fe,ve,Me=[[],[]];for(ve=0;ve<64;ve++){var ke=!be&&ve<_.length?_[ve].brush.filter.getBounds():[-1/0,1/0];Me[0][ve]=ke[0],Me[1][ve]=ke[1]}var Le=new Array(16384);for(Ce=0;Ce<16384;Ce++)Le[Ce]=255;if(!be)for(Ce=0;Ce<_.length;Ce++){var ze=Ce%8,Re=(Ce-ze)/8,Oe=Math.pow(2,ze),Ze=_[Ce].brush.filter.get();if(!(Ze.length<2)){var Pe=d(Ze[0])[1];for(fe=1;fe<Ze.length;fe++){var Ie=d(Ze[fe]);for(ve=Pe+1;ve<Ie[0];ve++)Le[8*ve+Re]&=~Oe;Pe=Math.max(Pe,Ie[1])}}}var Be={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:Le};return k?k(Be):k=I.texture(Be),{maskTexture:k,maskHeight:2048,loA:Me[0].slice(0,16),loB:Me[0].slice(16,32),loC:Me[0].slice(32,48),loD:Me[0].slice(48,64),hiA:Me[1].slice(0,16),hiB:Me[1].slice(16,32),hiC:Me[1].slice(32,48),hiD:Me[1].slice(48,64)}}(L);for(N=0;N<ee;N++){var re=G[N],ne=re.dim0.crossfilterDimensionIndex,le=re.dim1.crossfilterDimensionIndex,oe=re.canvasX,de=re.canvasY,se=oe+re.panelSizeX,me=re.plotGlPixelRatio;if(W||!V[ne]||V[ne][0]!==oe||V[ne][1]!==se){V[ne]=[oe,se];var Te=h(c,B,U,N,ne,le,oe,de,re.panelSizeX,re.panelSizeY,re.dim0.crossfilterDimensionIndex,L?0:A?2:1,K,me);D.clearOnly=te;var _e=W?c.lines.blockLineCount:w;m(I,X,D,_e,w,Te)}}},readPixel:function(G,W){return I.read({x:G,y:W,width:1,height:1,data:t}),t},readPixels:function(G,W,te,N){var B=new Uint8Array(4*te*N);return I.read({x:G,y:W,width:te,height:N,data:B}),B},destroy:function(){for(var G in s.style["pointer-events"]="none",H.destroy(),k&&k.destroy(),R)R[G].destroy()},update:$}}},{"../../lib":515,"./constants":902,glslify:227}],907:[function(v,J,Z){J.exports=function(p,g,b,y){var e,n;for(y||(y=1/0),e=0;e<g.length;e++)(n=g[e]).visible&&(y=Math.min(y,n[b].length));for(y===1/0&&(y=0),p._length=y,e=0;e<g.length;e++)(n=g[e]).visible&&(n._length=y);return y}},{}],908:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=g.numberFormat,y=v("color-rgba"),e=v("../../plots/cartesian/axes"),n=g.strRotate,t=g.strTranslate,a=v("../../lib/svg_text_utils"),r=v("../../components/drawing"),m=v("../../components/colorscale"),o=v("../../lib/gup"),i=o.keyFun,u=o.repeat,f=o.unwrap,l=v("./helpers"),h=v("./constants"),d=v("./axisbrush"),s=v("./lines");function x(V,X,$){return g.aggNums(V,null,X,$)}function c(V,X){return _(x(Math.min,V,X),x(Math.max,V,X))}function T(V){var X=V.range;return X?_(X[0],X[1]):c(V.values,V._length)}function _(V,X){return!isNaN(V)&&isFinite(V)||(V=0),!isNaN(X)&&isFinite(X)||(X=0),V===X&&(V===0?(V-=1,X+=1):(V*=.9,X*=1.1)),[V,X]}function w(V,X,$,G,W){var te,N,B=T($);return G?p.scale.ordinal().domain(G.map((te=b($.tickformat),N=W,N?function(U,ee){var j=N[ee];return j==null?te(U):j}:te))).range(G.map(function(U){var ee=(U-B[0])/(B[1]-B[0]);return V-X+ee*(2*X-V)})):p.scale.linear().domain(B).range([V-X,X])}function k(V){if(V.tickvals){var X=T(V);return p.scale.ordinal().domain(V.tickvals).range(V.tickvals.map(function($){return($-X[0])/(X[1]-X[0])}))}}function L(V){var X=V.map(function(W){return W[0]}),$=V.map(function(W){var te=y(W[1]);return p.rgb("rgb("+te[0]+","+te[1]+","+te[2]+")")}),G="rgb".split("").map(function(W){return p.scale.linear().clamp(!0).domain(X).range($.map((te=W,function(N){return N[te]})));var te});return function(W){return G.map(function(te){return te(W)})}}function A(V){return V.dimensions.some(function(X){return X.brush.filterSpecified})}function I(V,X,$){var G=f(X),W=G.trace,te=l.convertTypedArray(G.lineColor),N=W.line,B={color:y(W.unselected.line.color),opacity:W.unselected.line.opacity},U=m.extractOpts(N),ee=U.reversescale?m.flipScale(G.cscale):G.cscale,j=W.domain,Q=W.dimensions,K=V.width,re=W.labelangle,ne=W.labelside,le=W.labelfont,oe=W.tickfont,de=W.rangefont,se=g.extendDeepNoArrays({},N,{color:te.map(p.scale.linear().domain(T({values:te,range:[U.min,U.max],_length:W._length}))),blockLineCount:h.blockLineCount,canvasOverdrag:h.overdrag*h.canvasPixelRatio}),me=Math.floor(K*(j.x[1]-j.x[0])),Te=Math.floor(V.height*(j.y[1]-j.y[0])),_e=V.margin||{l:80,r:80,t:100,b:80},be=me,Ce=Te;return{key:$,colCount:Q.filter(l.isVisible).length,dimensions:Q,tickDistance:h.tickDistance,unitToColor:L(ee),lines:se,deselectedLines:B,labelAngle:re,labelSide:ne,labelFont:le,tickFont:oe,rangeFont:de,layoutWidth:K,layoutHeight:V.height,domain:j,translateX:j.x[0]*K,translateY:V.height-j.y[1]*V.height,pad:_e,canvasWidth:be*h.canvasPixelRatio+2*se.canvasOverdrag,canvasHeight:Ce*h.canvasPixelRatio,width:be,height:Ce,canvasPixelRatio:h.canvasPixelRatio}}function P(V,X,$){var G=$.width,W=$.height,te=$.dimensions,N=$.canvasPixelRatio,B=function(K){return G*K/Math.max(1,$.colCount-1)},U=h.verticalPadding/W,ee=function(K,re){return p.scale.linear().range([re,K-re])}(W,h.verticalPadding),j={key:$.key,xScale:B,model:$,inBrushDrag:!1},Q={};return j.dimensions=te.filter(l.isVisible).map(function(K,re){var ne=function(Le,ze){return p.scale.linear().domain(T(Le)).range([ze,1-ze])}(K,U),le=Q[K.label];Q[K.label]=(le||0)+1;var oe=K.label+(le?"__"+le:""),de=K.constraintrange,se=de&&de.length;se&&!Array.isArray(de[0])&&(de=[de]);var me=se?de.map(function(Le){return Le.map(ne)}):[[-1/0,1/0]],Te=K.values;Te.length>K._length&&(Te=Te.slice(0,K._length));var _e,be=K.tickvals;function Ce(Le,ze){return{val:Le,text:_e[ze]}}function fe(Le,ze){return Le.val-ze.val}if(Array.isArray(be)&&be.length){_e=K.ticktext,Array.isArray(_e)&&_e.length?_e.length>be.length?_e=_e.slice(0,be.length):be.length>_e.length&&(be=be.slice(0,_e.length)):_e=be.map(b(K.tickformat));for(var ve=1;ve<be.length;ve++)if(be[ve]<be[ve-1]){for(var Me=be.map(Ce).sort(fe),ke=0;ke<be.length;ke++)be[ke]=Me[ke].val,_e[ke]=Me[ke].text;break}}else be=void 0;return Te=l.convertTypedArray(Te),{key:oe,label:K.label,tickFormat:K.tickformat,tickvals:be,ticktext:_e,ordinal:l.isOrdinal(K),multiselect:K.multiselect,xIndex:re,crossfilterDimensionIndex:re,visibleIndex:K._index,height:W,values:Te,paddedUnitValues:Te.map(ne),unitTickvals:be&&be.map(ne),xScale:B,x:B(re),canvasX:B(re)*N,unitToPaddedPx:ee,domainScale:w(W,h.verticalPadding,K,be,_e),ordinalScale:k(K),parent:j,model:$,brush:d.makeBrush(V,se,me,function(){V.linePickActive(!1)},function(){var Le=j;Le.focusLayer&&Le.focusLayer.render(Le.panels,!0);var ze=A(Le);!V.contextShown()&&ze?(Le.contextLayer&&Le.contextLayer.render(Le.panels,!0),V.contextShown(!0)):V.contextShown()&&!ze&&(Le.contextLayer&&Le.contextLayer.render(Le.panels,!0,!0),V.contextShown(!1))},function(Le){if(j.focusLayer.render(j.panels,!0),j.pickLayer&&j.pickLayer.render(j.panels,!0),V.linePickActive(!0),X&&X.filterChanged){var ze=ne.invert,Re=Le.map(function(Oe){return Oe.map(ze).sort(g.sorterAsc)}).sort(function(Oe,Ze){return Oe[0]-Ze[0]});X.filterChanged(j.key,K._index,Re)}})}}),j}function S(V){V.classed(h.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function E(V,X){var $=X==="top"?1:-1,G=V*Math.PI/180;return{dir:$,dx:Math.sin(G),dy:Math.cos(G),degrees:V}}function D(V,X,$){for(var G=X.panels||(X.panels=[]),W=V.data(),te=0;te<W.length-1;te++){var N=G[te]||(G[te]={}),B=W[te],U=W[te+1];N.dim0=B,N.dim1=U,N.canvasX=B.canvasX,N.panelSizeX=U.canvasX-B.canvasX,N.panelSizeY=X.model.canvasHeight,N.y=0,N.canvasY=0,N.plotGlPixelRatio=$}}function R(V,X){return e.tickText(V._ax,X,!1).text}function H(V,X){if(V.ordinal)return"";var $=V.domainScale.domain(),G=$[X?$.length-1:0];return R(V.model.dimensions[V.visibleIndex],G)}J.exports=function(V,X,$,G){var W=V._fullLayout,te=W._toppaper,N=W._glcontainer,B=V._context.plotGlPixelRatio,U=V._fullLayout.paper_bgcolor;(function(ke){for(var Le=0;Le<ke.length;Le++)for(var ze=0;ze<ke[Le].length;ze++)for(var Re=ke[Le][ze].trace,Oe=Re.dimensions,Ze=0;Ze<Oe.length;Ze++){var Pe=Oe[Ze].values,Ie=Oe[Ze]._ax;Ie&&(Ie.range?Ie.range=_(Ie.range[0],Ie.range[1]):Ie.range=c(Pe,Re._length),Ie.dtick||(Ie.dtick=.01*(Math.abs(Ie.range[1]-Ie.range[0])||1)),Ie.tickformat=Oe[Ze].tickformat,e.calcTicks(Ie),Ie.cleanRange())}})(X);var ee,j,Q=(ee=!0,j=!1,{linePickActive:function(ke){return arguments.length?ee=!!ke:ee},contextShown:function(ke){return arguments.length?j=!!ke:j}}),K=X.filter(function(ke){return f(ke).trace.visible}).map(I.bind(0,$)).map(P.bind(0,Q,G));N.each(function(ke,Le){return g.extendFlat(ke,K[Le])});var re=N.selectAll(".gl-canvas").each(function(ke){ke.viewModel=K[0],ke.viewModel.plotGlPixelRatio=B,ke.viewModel.paperColor=U,ke.model=ke.viewModel?ke.viewModel.model:null}),ne=null;re.filter(function(ke){return ke.pick}).style("pointer-events","auto").on("mousemove",function(ke){if(Q.linePickActive()&&ke.lineLayer&&G&&G.hover){var Le=p.event,ze=this.width,Re=this.height,Oe=p.mouse(this),Ze=Oe[0],Pe=Oe[1];if(Ze<0||Pe<0||Ze>=ze||Pe>=Re)return;var Ie=ke.lineLayer.readPixel(Ze,Re-1-Pe),Be=Ie[3]!==0,Fe=Be?Ie[2]+256*(Ie[1]+256*Ie[0]):null,$e={x:Ze,y:Pe,clientX:Le.clientX,clientY:Le.clientY,dataIndex:ke.model.key,curveNumber:Fe};Fe!==ne&&(Be?G.hover($e):G.unhover&&G.unhover($e),ne=Fe)}}),re.style("opacity",function(ke){return ke.pick?0:1}),te.style("background","rgba(255, 255, 255, 0)");var le=te.selectAll("."+h.cn.parcoords).data(K,i);le.exit().remove(),le.enter().append("g").classed(h.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),le.attr("transform",function(ke){return t(ke.model.translateX,ke.model.translateY)});var oe=le.selectAll("."+h.cn.parcoordsControlView).data(u,i);oe.enter().append("g").classed(h.cn.parcoordsControlView,!0),oe.attr("transform",function(ke){return t(ke.model.pad.l,ke.model.pad.t)});var de=oe.selectAll("."+h.cn.yAxis).data(function(ke){return ke.dimensions},i);de.enter().append("g").classed(h.cn.yAxis,!0),oe.each(function(ke){D(de,ke,B)}),re.each(function(ke){if(ke.viewModel){!ke.lineLayer||G?ke.lineLayer=s(this,ke):ke.lineLayer.update(ke),(ke.key||ke.key===0)&&(ke.viewModel[ke.key]=ke.lineLayer);var Le=!ke.context||G;ke.lineLayer.render(ke.viewModel.panels,Le)}}),de.attr("transform",function(ke){return t(ke.xScale(ke.xIndex),0)}),de.call(p.behavior.drag().origin(function(ke){return ke}).on("drag",function(ke){var Le=ke.parent;Q.linePickActive(!1),ke.x=Math.max(-h.overdrag,Math.min(ke.model.width+h.overdrag,p.event.x)),ke.canvasX=ke.x*ke.model.canvasPixelRatio,de.sort(function(ze,Re){return ze.x-Re.x}).each(function(ze,Re){ze.xIndex=Re,ze.x=ke===ze?ze.x:ze.xScale(ze.xIndex),ze.canvasX=ze.x*ze.model.canvasPixelRatio}),D(de,Le,B),de.filter(function(ze){return Math.abs(ke.xIndex-ze.xIndex)!==0}).attr("transform",function(ze){return t(ze.xScale(ze.xIndex),0)}),p.select(this).attr("transform",t(ke.x,0)),de.each(function(ze,Re,Oe){Oe===ke.parent.key&&(Le.dimensions[Re]=ze)}),Le.contextLayer&&Le.contextLayer.render(Le.panels,!1,!A(Le)),Le.focusLayer.render&&Le.focusLayer.render(Le.panels)}).on("dragend",function(ke){var Le=ke.parent;ke.x=ke.xScale(ke.xIndex),ke.canvasX=ke.x*ke.model.canvasPixelRatio,D(de,Le,B),p.select(this).attr("transform",function(ze){return t(ze.x,0)}),Le.contextLayer&&Le.contextLayer.render(Le.panels,!1,!A(Le)),Le.focusLayer&&Le.focusLayer.render(Le.panels),Le.pickLayer&&Le.pickLayer.render(Le.panels,!0),Q.linePickActive(!0),G&&G.axesMoved&&G.axesMoved(Le.key,Le.dimensions.map(function(ze){return ze.crossfilterDimensionIndex}))})),de.exit().remove();var se=de.selectAll("."+h.cn.axisOverlays).data(u,i);se.enter().append("g").classed(h.cn.axisOverlays,!0),se.selectAll("."+h.cn.axis).remove();var me=se.selectAll("."+h.cn.axis).data(u,i);me.enter().append("g").classed(h.cn.axis,!0),me.each(function(ke){var Le=ke.model.height/ke.model.tickDistance,ze=ke.domainScale,Re=ze.domain();p.select(this).call(p.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Le,ke.tickFormat).tickValues(ke.ordinal?Re:null).tickFormat(function(Oe){return l.isOrdinal(ke)?Oe:R(ke.model.dimensions[ke.visibleIndex],Oe)}).scale(ze)),r.font(me.selectAll("text"),ke.model.tickFont)}),me.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),me.selectAll("text").style("text-shadow",a.makeTextShadow(U)).style("cursor","default");var Te=se.selectAll("."+h.cn.axisHeading).data(u,i);Te.enter().append("g").classed(h.cn.axisHeading,!0);var _e=Te.selectAll("."+h.cn.axisTitle).data(u,i);_e.enter().append("text").classed(h.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),_e.text(function(ke){return ke.label}).each(function(ke){var Le=p.select(this);r.font(Le,ke.model.labelFont),a.convertToTspans(Le,V)}).attr("transform",function(ke){var Le=E(ke.model.labelAngle,ke.model.labelSide),ze=h.axisTitleOffset;return(Le.dir>0?"":t(0,2*ze+ke.model.height))+n(Le.degrees)+t(-ze*Le.dx,-ze*Le.dy)}).attr("text-anchor",function(ke){var Le=E(ke.model.labelAngle,ke.model.labelSide);return 2*Math.abs(Le.dx)>Math.abs(Le.dy)?Le.dir*Le.dx<0?"start":"end":"middle"});var be=se.selectAll("."+h.cn.axisExtent).data(u,i);be.enter().append("g").classed(h.cn.axisExtent,!0);var Ce=be.selectAll("."+h.cn.axisExtentTop).data(u,i);Ce.enter().append("g").classed(h.cn.axisExtentTop,!0),Ce.attr("transform",t(0,-h.axisExtentOffset));var fe=Ce.selectAll("."+h.cn.axisExtentTopText).data(u,i);fe.enter().append("text").classed(h.cn.axisExtentTopText,!0).call(S),fe.text(function(ke){return H(ke,!0)}).each(function(ke){r.font(p.select(this),ke.model.rangeFont)});var ve=be.selectAll("."+h.cn.axisExtentBottom).data(u,i);ve.enter().append("g").classed(h.cn.axisExtentBottom,!0),ve.attr("transform",function(ke){return t(0,ke.model.height+h.axisExtentOffset)});var Me=ve.selectAll("."+h.cn.axisExtentBottomText).data(u,i);Me.enter().append("text").classed(h.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(S),Me.text(function(ke){return H(ke,!1)}).each(function(ke){r.font(p.select(this),ke.model.rangeFont)}),d.ensureAxisBrush(se,U)}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"./axisbrush":898,"./constants":902,"./helpers":904,"./lines":906,"@plotly/d3":58,"color-rgba":91}],909:[function(v,J,Z){var p=v("./parcoords"),g=v("../../lib/prepare_regl"),b=v("./helpers").isVisible,y={};function e(n,t,a){var r=t.indexOf(a),m=n.indexOf(r);return m===-1&&(m+=t.length),m}(J.exports=function(n,t){var a=n._fullLayout;if(g(n,[],y)){var r={},m={},o={},i={},u=a._size;t.forEach(function(f,l){var h=f[0].trace;o[l]=h.index;var d=i[l]=h._fullInput.index;r[l]=n.data[d].dimensions,m[l]=n.data[d].dimensions.slice()}),p(n,t,{width:u.w,height:u.h,margin:{t:u.t,r:u.r,b:u.b,l:u.l}},{filterChanged:function(f,l,h){var d=m[f][l],s=h.map(function(k){return k.slice()}),x="dimensions["+l+"].constraintrange",c=a._tracePreGUI[n._fullData[o[f]]._fullInput.uid];if(c[x]===void 0){var T=d.constraintrange;c[x]=T||null}var _=n._fullData[o[f]].dimensions[l];s.length?(s.length===1&&(s=s[0]),d.constraintrange=s,_.constraintrange=s.slice(),s=[s]):(delete d.constraintrange,delete _.constraintrange,s=null);var w={};w[x]=s,n.emit("plotly_restyle",[w,[i[f]]])},hover:function(f){n.emit("plotly_hover",f)},unhover:function(f){n.emit("plotly_unhover",f)},axesMoved:function(f,l){var h=function(d,s){return function(x,c){return e(d,s,x)-e(d,s,c)}}(l,m[f].filter(b));r[f].sort(h),m[f].filter(function(d){return!b(d)}).sort(function(d){return m[f].indexOf(d)}).forEach(function(d){r[f].splice(r[f].indexOf(d),1),r[f].splice(m[f].indexOf(d),0,d)}),n.emit("plotly_restyle",[{dimensions:[r[f]]},[i[f]]])}})}}).reglPrecompiled=y},{"../../lib/prepare_regl":528,"./helpers":904,"./parcoords":908}],910:[function(v,J,Z){var p=v("../../plots/attributes"),g=v("../../plots/domain").attributes,b=v("../../plots/font_attributes"),y=v("../../components/color/attributes"),e=v("../../plots/template_attributes").hovertemplateAttrs,n=v("../../plots/template_attributes").texttemplateAttrs,t=v("../../lib/extend").extendFlat,a=b({editType:"plot",arrayOk:!0,colorEditType:"plot"});J.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:y.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:t({},p.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:n({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:t({},a,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:t({},a,{}),outsidetextfont:t({},a,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:t({},a,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:g({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:t({},a,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],911:[function(v,J,Z){var p=v("../../plots/plots");Z.name="pie",Z.plot=function(g,b,y,e){p.plotBasePlot(Z.name,g,b,y,e)},Z.clean=function(g,b,y,e){p.cleanBasePlot(Z.name,g,b,y,e)}},{"../../plots/plots":628}],912:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("tinycolor2"),b=v("../../components/color"),y={};function e(t){return function(a,r){return!!a&&!!(a=g(a)).isValid()&&(a=b.addOpacity(a,a.getAlpha()),t[r]||(t[r]=a),a)}}function n(t,a){var r,m=JSON.stringify(t),o=a[m];if(!o){for(o=t.slice(),r=0;r<t.length;r++)o.push(g(t[r]).lighten(20).toHexString());for(r=0;r<t.length;r++)o.push(g(t[r]).darken(20).toHexString());a[m]=o}return o}J.exports={calc:function(t,a){var r,m,o=[],i=t._fullLayout,u=i.hiddenlabels||[],f=a.labels,l=a.marker.colors||[],h=a.values,d=a._length,s=a._hasValues&&d;if(a.dlabel)for(f=new Array(d),r=0;r<d;r++)f[r]=String(a.label0+r*a.dlabel);var x={},c=e(i["_"+a.type+"colormap"]),T=0,_=!1;for(r=0;r<d;r++){var w,k,L;if(s){if(w=h[r],!p(w))continue;w=+w}else w=1;(k=f[r])!==void 0&&k!==""||(k=r);var A=x[k=String(k)];A===void 0?(x[k]=o.length,(L=u.indexOf(k)!==-1)||(T+=w),o.push({v:w,label:k,color:c(l[r],k),i:r,pts:[r],hidden:L})):(_=!0,(m=o[A]).v+=w,m.pts.push(r),m.hidden||(T+=w),m.color===!1&&l[r]&&(m.color=c(l[r],k)))}return o=o.filter(function(I){return I.v>=0}),(a.type==="funnelarea"?_:a.sort)&&o.sort(function(I,P){return P.v-I.v}),o[0]&&(o[0].vTotal=T),o},crossTraceCalc:function(t,a){var r=(a||{}).type;r||(r="pie");var m=t._fullLayout,o=t.calcdata,i=m[r+"colorway"],u=m["_"+r+"colormap"];m["extend"+r+"colors"]&&(i=n(i,y));for(var f=0,l=0;l<o.length;l++){var h=o[l];if(h[0].trace.type===r)for(var d=0;d<h.length;d++){var s=h[d];s.color===!1&&(u[s.label]?s.color=u[s.label]:(u[s.label]=s.color=i[f%i.length],f++))}}},makePullColorFn:e,generateExtendedColors:n}},{"../../components/color":367,"fast-isnumeric":190,tinycolor2:313}],913:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("./attributes"),y=v("../../plots/domain").defaults,e=v("../bar/defaults").handleText;function n(t,a){var r=Array.isArray(t),m=g.isArrayOrTypedArray(a),o=Math.min(r?t.length:1/0,m?a.length:1/0);if(isFinite(o)||(o=0),o&&m){for(var i,u=0;u<o;u++){var f=a[u];if(p(f)&&f>0){i=!0;break}}i||(o=0)}return{hasLabels:r,hasValues:m,len:o}}J.exports={handleLabelsAndValues:n,supplyDefaults:function(t,a,r,m){function o(c,T){return g.coerce(t,a,b,c,T)}var i=n(o("labels"),o("values")),u=i.len;if(a._hasLabels=i.hasLabels,a._hasValues=i.hasValues,!a._hasLabels&&a._hasValues&&(o("label0"),o("dlabel")),u){a._length=u,o("marker.line.width")&&o("marker.line.color"),o("marker.colors"),o("scalegroup");var f,l=o("text"),h=o("texttemplate");if(h||(f=o("textinfo",Array.isArray(l)?"text+percent":"percent")),o("hovertext"),o("hovertemplate"),h||f&&f!=="none"){var d=o("textposition");e(t,a,m,o,d,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(d)||d==="auto"||d==="outside")&&o("automargin"),(d==="inside"||d==="auto"||Array.isArray(d))&&o("insidetextorientation")}y(a,m,o);var s=o("hole");if(o("title.text")){var x=o("title.position",s?"middle center":"top center");s||x!=="middle center"||(a.title.position="top center"),g.coerceFont(o,"title.font",m.font)}o("sort"),o("direction"),o("rotation"),o("pull")}else a.visible=!1}}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":910,"fast-isnumeric":190}],914:[function(v,J,Z){var p=v("../../components/fx/helpers").appendArrayMultiPointValues;J.exports=function(g,b){var y={curveNumber:b.index,pointNumbers:g.pts,data:b._input,fullData:b,label:g.label,color:g.color,value:g.v,percent:g.percent,text:g.text,bbox:g.bbox,v:g.v};return g.pts.length===1&&(y.pointNumber=y.i=g.pts[0]),p(y,b,g.pts),b.type==="funnelarea"&&(delete y.v,delete y.i),y}},{"../../components/fx/helpers":403}],915:[function(v,J,Z){var p=v("../../lib");function g(b){return b.indexOf("e")!==-1?b.replace(/[.]?0+e/,"e"):b.indexOf(".")!==-1?b.replace(/[.]?0+$/,""):b}Z.formatPiePercent=function(b,y){var e=g((100*b).toPrecision(3));return p.numSeparate(e,y)+"%"},Z.formatPieValue=function(b,y){var e=g(b.toPrecision(10));return p.numSeparate(e,y)},Z.getFirstFilled=function(b,y){if(Array.isArray(b))for(var e=0;e<y.length;e++){var n=b[y[e]];if(n||n===0||n==="")return n}},Z.castOption=function(b,y){return Array.isArray(b)?Z.getFirstFilled(b,y):b||void 0},Z.getRotationAngle=function(b){return(b==="auto"?0:b)*Math.PI/180}},{"../../lib":515}],916:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,supplyLayoutDefaults:v("./layout_defaults"),layoutAttributes:v("./layout_attributes"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot").plot,style:v("./style"),styleOne:v("./style_one"),moduleType:"trace",name:"pie",basePlotModule:v("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":910,"./base_plot":911,"./calc":912,"./defaults":913,"./layout_attributes":917,"./layout_defaults":918,"./plot":919,"./style":920,"./style_one":921}],917:[function(v,J,Z){J.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],918:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes");J.exports=function(b,y){function e(n,t){return p.coerce(b,y,g,n,t)}e("hiddenlabels"),e("piecolorway",y.colorway),e("extendpiecolors")}},{"../../lib":515,"./layout_attributes":917}],919:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../plots/plots"),b=v("../../components/fx"),y=v("../../components/color"),e=v("../../components/drawing"),n=v("../../lib"),t=n.strScale,a=n.strTranslate,r=v("../../lib/svg_text_utils"),m=v("../bar/uniform_text"),o=m.recordMinTextSize,i=m.clearMinTextSize,u=v("../bar/constants").TEXTPAD,f=v("./helpers"),l=v("./event_data"),h=v("../../lib").isValidTextValue;function d(X,$,G){var W=G[0],te=W.cx,N=W.cy,B=W.trace,U=B.type==="funnelarea";"_hasHoverLabel"in B||(B._hasHoverLabel=!1),"_hasHoverEvent"in B||(B._hasHoverEvent=!1),X.on("mouseover",function(ee){var j=$._fullLayout,Q=$._fullData[B.index];if(!$._dragging&&j.hovermode!==!1){var K=Q.hoverinfo;if(Array.isArray(K)&&(K=b.castHoverinfo({hoverinfo:[f.castOption(K,ee.pts)],_module:B._module},j,0)),K==="all"&&(K="label+text+value+percent+name"),Q.hovertemplate||K!=="none"&&K!=="skip"&&K){var re=ee.rInscribed||0,ne=te+ee.pxmid[0]*(1-re),le=N+ee.pxmid[1]*(1-re),oe=j.separators,de=[];if(K&&K.indexOf("label")!==-1&&de.push(ee.label),ee.text=f.castOption(Q.hovertext||Q.text,ee.pts),K&&K.indexOf("text")!==-1){var se=ee.text;n.isValidTextValue(se)&&de.push(se)}ee.value=ee.v,ee.valueLabel=f.formatPieValue(ee.v,oe),K&&K.indexOf("value")!==-1&&de.push(ee.valueLabel),ee.percent=ee.v/W.vTotal,ee.percentLabel=f.formatPiePercent(ee.percent,oe),K&&K.indexOf("percent")!==-1&&de.push(ee.percentLabel);var me=Q.hoverlabel,Te=me.font,_e=[];b.loneHover({trace:B,x0:ne-re*W.r,x1:ne+re*W.r,y:le,_x0:U?te+ee.TL[0]:ne-re*W.r,_x1:U?te+ee.TR[0]:ne+re*W.r,_y0:U?N+ee.TL[1]:le-re*W.r,_y1:U?N+ee.BL[1]:le+re*W.r,text:de.join("<br>"),name:Q.hovertemplate||K.indexOf("name")!==-1?Q.name:void 0,idealAlign:ee.pxmid[0]<0?"left":"right",color:f.castOption(me.bgcolor,ee.pts)||ee.color,borderColor:f.castOption(me.bordercolor,ee.pts),fontFamily:f.castOption(Te.family,ee.pts),fontSize:f.castOption(Te.size,ee.pts),fontColor:f.castOption(Te.color,ee.pts),nameLength:f.castOption(me.namelength,ee.pts),textAlign:f.castOption(me.align,ee.pts),hovertemplate:f.castOption(Q.hovertemplate,ee.pts),hovertemplateLabels:ee,eventData:[l(ee,Q)]},{container:j._hoverlayer.node(),outerContainer:j._paper.node(),gd:$,inOut_bbox:_e}),ee.bbox=_e[0],B._hasHoverLabel=!0}B._hasHoverEvent=!0,$.emit("plotly_hover",{points:[l(ee,Q)],event:p.event})}}),X.on("mouseout",function(ee){var j=$._fullLayout,Q=$._fullData[B.index],K=p.select(this).datum();B._hasHoverEvent&&(ee.originalEvent=p.event,$.emit("plotly_unhover",{points:[l(K,Q)],event:p.event}),B._hasHoverEvent=!1),B._hasHoverLabel&&(b.loneUnhover(j._hoverlayer.node()),B._hasHoverLabel=!1)}),X.on("click",function(ee){var j=$._fullLayout,Q=$._fullData[B.index];$._dragging||j.hovermode===!1||($._hoverdata=[l(ee,Q)],b.click($,p.event))})}function s(X,$,G){var W=f.castOption(X.insidetextfont.color,$.pts);!W&&X._input.textfont&&(W=f.castOption(X._input.textfont.color,$.pts));var te=f.castOption(X.insidetextfont.family,$.pts)||f.castOption(X.textfont.family,$.pts)||G.family,N=f.castOption(X.insidetextfont.size,$.pts)||f.castOption(X.textfont.size,$.pts)||G.size;return{color:W||y.contrast($.color),family:te,size:N}}function x(X,$){for(var G,W,te=0;te<X.length;te++)if((W=(G=X[te][0]).trace).title.text){var N=W.title.text;W._meta&&(N=n.templateString(N,W._meta));var B=e.tester.append("text").attr("data-notex",1).text(N).call(e.font,W.title.font).call(r.convertToTspans,$),U=e.bBox(B.node(),!0);G.titleBox={width:U.width,height:U.height},B.remove()}}function c(X,$,G){var W=G.r||$.rpx1,te=$.rInscribed;if($.startangle===$.stopangle)return{rCenter:1-te,scale:0,rotate:0,textPosAngle:0};var N,B=$.ring,U=B===1&&Math.abs($.startangle-$.stopangle)===2*Math.PI,ee=$.halfangle,j=$.midangle,Q=G.trace.insidetextorientation,K=Q==="horizontal",re=Q==="tangential",ne=Q==="radial",le=Q==="auto",oe=[];if(!le){var de,se=function(fe,ve){if(function(ze,Re){var Oe=ze.startangle,Ze=ze.stopangle;return Oe>Re&&Re>Ze||Oe<Re&&Re<Ze}($,fe)){var Me=Math.abs(fe-$.startangle),ke=Math.abs(fe-$.stopangle),Le=Me<ke?Me:ke;(N=ve==="tan"?_(X,W,B,Le,0):T(X,W,B,Le,Math.PI/2)).textPosAngle=fe,oe.push(N)}};if(K||re){for(de=4;de>=-4;de-=2)se(Math.PI*de,"tan");for(de=4;de>=-4;de-=2)se(Math.PI*(de+1),"tan")}if(K||ne){for(de=4;de>=-4;de-=2)se(Math.PI*(de+1.5),"rad");for(de=4;de>=-4;de-=2)se(Math.PI*(de+.5),"rad")}}if(U||le||K){var me=Math.sqrt(X.width*X.width+X.height*X.height);if((N={scale:te*W*2/me,rCenter:1-te,rotate:0}).textPosAngle=($.startangle+$.stopangle)/2,N.scale>=1)return N;oe.push(N)}(le||ne)&&((N=T(X,W,B,ee,j)).textPosAngle=($.startangle+$.stopangle)/2,oe.push(N)),(le||re)&&((N=_(X,W,B,ee,j)).textPosAngle=($.startangle+$.stopangle)/2,oe.push(N));for(var Te=0,_e=0,be=0;be<oe.length;be++){var Ce=oe[be].scale;if(_e<Ce&&(_e=Ce,Te=be),!le&&_e>=1)break}return oe[Te]}function T(X,$,G,W,te){$=Math.max(0,$-2*u);var N=X.width/X.height,B=L(N,W,$,G);return{scale:2*B/X.height,rCenter:w(N,B/$),rotate:k(te)}}function _(X,$,G,W,te){$=Math.max(0,$-2*u);var N=X.height/X.width,B=L(N,W,$,G);return{scale:2*B/X.width,rCenter:w(N,B/$),rotate:k(te+Math.PI/2)}}function w(X,$){return Math.cos($)-X*$}function k(X){return(180/Math.PI*X+720)%180-90}function L(X,$,G,W){var te=X+1/(2*Math.tan($));return G*Math.min(1/(Math.sqrt(te*te+.5)+te),W/(Math.sqrt(X*X+W/2)+X))}function A(X,$){return X.v!==$.vTotal||$.trace.hole?Math.min(1/(1+1/Math.sin(X.halfangle)),X.ring/2):1}function I(X,$){var G=$.pxmid[0],W=$.pxmid[1],te=X.width/2,N=X.height/2;return G<0&&(te*=-1),W<0&&(N*=-1),{scale:1,rCenter:1,rotate:0,x:te+Math.abs(N)*(te>0?1:-1)/2,y:N/(1+G*G/(W*W)),outside:!0}}function P(X,$){var G,W,te,N=X.trace,B={x:X.cx,y:X.cy},U={tx:0,ty:0};U.ty+=N.title.font.size,te=E(N),N.title.position.indexOf("top")!==-1?(B.y-=(1+te)*X.r,U.ty-=X.titleBox.height):N.title.position.indexOf("bottom")!==-1&&(B.y+=(1+te)*X.r);var ee,j,Q=(ee=X.r,j=X.trace.aspectratio,ee/(j===void 0?1:j)),K=$.w*(N.domain.x[1]-N.domain.x[0])/2;return N.title.position.indexOf("left")!==-1?(K+=Q,B.x-=(1+te)*Q,U.tx+=X.titleBox.width/2):N.title.position.indexOf("center")!==-1?K*=2:N.title.position.indexOf("right")!==-1&&(K+=Q,B.x+=(1+te)*Q,U.tx-=X.titleBox.width/2),G=K/X.titleBox.width,W=S(X,$)/X.titleBox.height,{x:B.x,y:B.y,scale:Math.min(G,W),tx:U.tx,ty:U.ty}}function S(X,$){var G=X.trace,W=$.h*(G.domain.y[1]-G.domain.y[0]);return Math.min(X.titleBox.height,W/2)}function E(X){var $,G=X.pull;if(!G)return 0;if(Array.isArray(G))for(G=0,$=0;$<X.pull.length;$++)X.pull[$]>G&&(G=X.pull[$]);return G}function D(X,$){for(var G=[],W=0;W<X.length;W++){var te=X[W][0],N=te.trace,B=N.domain,U=$.w*(B.x[1]-B.x[0]),ee=$.h*(B.y[1]-B.y[0]);N.title.text&&N.title.position!=="middle center"&&(ee-=S(te,$));var j=U/2,Q=ee/2;N.type!=="funnelarea"||N.scalegroup||(Q/=N.aspectratio),te.r=Math.min(j,Q)/(1+E(N)),te.cx=$.l+$.w*(N.domain.x[1]+N.domain.x[0])/2,te.cy=$.t+$.h*(1-N.domain.y[0])-ee/2,N.title.text&&N.title.position.indexOf("bottom")!==-1&&(te.cy-=S(te,$)),N.scalegroup&&G.indexOf(N.scalegroup)===-1&&G.push(N.scalegroup)}(function(K,re){for(var ne,le,oe,de=0;de<re.length;de++){var se=1/0,me=re[de];for(le=0;le<K.length;le++)if(ne=K[le][0],(oe=ne.trace).scalegroup===me){var Te;if(oe.type==="pie")Te=ne.r*ne.r;else if(oe.type==="funnelarea"){var _e,be;oe.aspectratio>1?(_e=ne.r,be=_e/oe.aspectratio):(be=ne.r,_e=be*oe.aspectratio),_e*=(1+oe.baseratio)/2,Te=_e*be}se=Math.min(se,Te/ne.vTotal)}for(le=0;le<K.length;le++)if(ne=K[le][0],(oe=ne.trace).scalegroup===me){var Ce=se*ne.vTotal;oe.type==="funnelarea"&&(Ce/=(1+oe.baseratio)/2,Ce/=oe.aspectratio),ne.r=Math.sqrt(Ce)}}})(X,G)}function R(X,$){return[X*Math.sin($),-X*Math.cos($)]}function H(X,$,G){var W=X._fullLayout,te=G.trace,N=te.texttemplate,B=te.textinfo;if(!N&&B&&B!=="none"){var U,ee=B.split("+"),j=function(Te){return ee.indexOf(Te)!==-1},Q=j("label"),K=j("text"),re=j("value"),ne=j("percent"),le=W.separators;if(U=Q?[$.label]:[],K){var oe=f.getFirstFilled(te.text,$.pts);h(oe)&&U.push(oe)}re&&U.push(f.formatPieValue($.v,le)),ne&&U.push(f.formatPiePercent($.v/G.vTotal,le)),$.text=U.join("<br>")}if(N){var de=n.castOption(te,$.i,"texttemplate");if(de){var se=function(Te){return{label:Te.label,value:Te.v,valueLabel:f.formatPieValue(Te.v,W.separators),percent:Te.v/G.vTotal,percentLabel:f.formatPiePercent(Te.v/G.vTotal,W.separators),color:Te.color,text:Te.text,customdata:n.castOption(te,Te.i,"customdata")}}($),me=f.getFirstFilled(te.text,$.pts);(h(me)||me==="")&&(se.text=me),$.text=n.texttemplateString(de,se,X._fullLayout._d3locale,se,te._meta||{})}else $.text=""}}function V(X,$){var G=X.rotate*Math.PI/180,W=Math.cos(G),te=Math.sin(G),N=($.left+$.right)/2,B=($.top+$.bottom)/2;X.textX=N*W-B*te,X.textY=N*te+B*W,X.noCenter=!0}J.exports={plot:function(X,$){var G=X._fullLayout,W=G._size;i("pie",G),x($,X),D($,W);var te=n.makeTraceGroups(G._pielayer,$,"trace").each(function(N){var B=p.select(this),U=N[0],ee=U.trace;(function(j){var Q,K,re,ne=j[0],le=ne.r,oe=ne.trace,de=f.getRotationAngle(oe.rotation),se=2*Math.PI/ne.vTotal,me="px0",Te="px1";if(oe.direction==="counterclockwise"){for(Q=0;Q<j.length&&j[Q].hidden;Q++);if(Q===j.length)return;de+=se*j[Q].v,se*=-1,me="px1",Te="px0"}for(re=R(le,de),Q=0;Q<j.length;Q++)(K=j[Q]).hidden||(K[me]=re,K.startangle=de,de+=se*K.v/2,K.pxmid=R(le,de),K.midangle=de,de+=se*K.v/2,re=R(le,de),K.stopangle=de,K[Te]=re,K.largeArc=K.v>ne.vTotal/2?1:0,K.halfangle=Math.PI*Math.min(K.v/ne.vTotal,.5),K.ring=1-oe.hole,K.rInscribed=A(K,ne))})(N),B.attr("stroke-linejoin","round"),B.each(function(){var j=p.select(this).selectAll("g.slice").data(N);j.enter().append("g").classed("slice",!0),j.exit().remove();var Q=[[[],[]],[[],[]]],K=!1;j.each(function(Te,_e){if(Te.hidden)p.select(this).selectAll("path,g").remove();else{Te.pointNumber=Te.i,Te.curveNumber=ee.index,Q[Te.pxmid[1]<0?0:1][Te.pxmid[0]<0?0:1].push(Te);var be=U.cx,Ce=U.cy,fe=p.select(this),ve=fe.selectAll("path.surface").data([Te]);if(ve.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),fe.call(d,X,N),ee.pull){var Me=+f.castOption(ee.pull,Te.pts)||0;Me>0&&(be+=Me*Te.pxmid[0],Ce+=Me*Te.pxmid[1])}Te.cxFinal=be,Te.cyFinal=Ce;var ke=ee.hole;if(Te.v===U.vTotal){var Le="M"+(be+Te.px0[0])+","+(Ce+Te.px0[1])+Pe(Te.px0,Te.pxmid,!0,1)+Pe(Te.pxmid,Te.px0,!0,1)+"Z";ke?ve.attr("d","M"+(be+ke*Te.px0[0])+","+(Ce+ke*Te.px0[1])+Pe(Te.px0,Te.pxmid,!1,ke)+Pe(Te.pxmid,Te.px0,!1,ke)+"Z"+Le):ve.attr("d",Le)}else{var ze=Pe(Te.px0,Te.px1,!0,1);if(ke){var Re=1-ke;ve.attr("d","M"+(be+ke*Te.px1[0])+","+(Ce+ke*Te.px1[1])+Pe(Te.px1,Te.px0,!1,ke)+"l"+Re*Te.px0[0]+","+Re*Te.px0[1]+ze+"Z")}else ve.attr("d","M"+be+","+Ce+"l"+Te.px0[0]+","+Te.px0[1]+ze+"Z")}H(X,Te,U);var Oe=f.castOption(ee.textposition,Te.pts),Ze=fe.selectAll("g.slicetext").data(Te.text&&Oe!=="none"?[0]:[]);Ze.enter().append("g").classed("slicetext",!0),Ze.exit().remove(),Ze.each(function(){var Ie=n.ensureSingle(p.select(this),"text","",function(tt){tt.attr("data-notex",1)}),Be=n.ensureUniformFontSize(X,Oe==="outside"?function(tt,Ke,vt){var Nt=f.castOption(tt.outsidetextfont.color,Ke.pts)||f.castOption(tt.textfont.color,Ke.pts)||vt.color,qt=f.castOption(tt.outsidetextfont.family,Ke.pts)||f.castOption(tt.textfont.family,Ke.pts)||vt.family,er=f.castOption(tt.outsidetextfont.size,Ke.pts)||f.castOption(tt.textfont.size,Ke.pts)||vt.size;return{color:Nt,family:qt,size:er}}(ee,Te,G.font):s(ee,Te,G.font));Ie.text(Te.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,Be).call(r.convertToTspans,X);var Fe,$e=e.bBox(Ie.node());if(Oe==="outside")Fe=I($e,Te);else if(Fe=c($e,Te,U),Oe==="auto"&&Fe.scale<1){var ot=n.ensureUniformFontSize(X,ee.outsidetextfont);Ie.call(e.font,ot),Fe=I($e=e.bBox(Ie.node()),Te)}var pt=Fe.textPosAngle,_t=pt===void 0?Te.pxmid:R(U.r,pt);if(Fe.targetX=be+_t[0]*Fe.rCenter+(Fe.x||0),Fe.targetY=Ce+_t[1]*Fe.rCenter+(Fe.y||0),V(Fe,$e),Fe.outside){var yt=Fe.targetY;Te.yLabelMin=yt-$e.height/2,Te.yLabelMid=yt,Te.yLabelMax=yt+$e.height/2,Te.labelExtraX=0,Te.labelExtraY=0,K=!0}Fe.fontSize=Be.size,o(ee.type,Fe,G),N[_e].transform=Fe,Ie.attr("transform",n.getTextTransform(Fe))})}function Pe(Ie,Be,Fe,$e){var ot=$e*(Be[0]-Ie[0]),pt=$e*(Be[1]-Ie[1]);return"a"+$e*U.r+","+$e*U.r+" 0 "+Te.largeArc+(Fe?" 1 ":" 0 ")+ot+","+pt}});var re=p.select(this).selectAll("g.titletext").data(ee.title.text?[0]:[]);if(re.enter().append("g").classed("titletext",!0),re.exit().remove(),re.each(function(){var Te,_e=n.ensureSingle(p.select(this),"text","",function(Ce){Ce.attr("data-notex",1)}),be=ee.title.text;ee._meta&&(be=n.templateString(be,ee._meta)),_e.text(be).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,ee.title.font).call(r.convertToTspans,X),Te=ee.title.position==="middle center"?function(Ce){var fe=Math.sqrt(Ce.titleBox.width*Ce.titleBox.width+Ce.titleBox.height*Ce.titleBox.height);return{x:Ce.cx,y:Ce.cy,scale:Ce.trace.hole*Ce.r*2/fe,tx:0,ty:-Ce.titleBox.height/2+Ce.trace.title.font.size}}(U):P(U,W),_e.attr("transform",a(Te.x,Te.y)+t(Math.min(1,Te.scale))+a(Te.tx,Te.ty))}),K&&function(Te,_e){var be,Ce,fe,ve,Me,ke,Le,ze,Re,Oe,Ze,Pe,Ie;function Be(pt,_t){return pt.pxmid[1]-_t.pxmid[1]}function Fe(pt,_t){return _t.pxmid[1]-pt.pxmid[1]}function $e(pt,_t){_t||(_t={});var yt,tt,Ke,vt,Nt=_t.labelExtraY+(Ce?_t.yLabelMax:_t.yLabelMin),qt=Ce?pt.yLabelMin:pt.yLabelMax,er=Ce?pt.yLabelMax:pt.yLabelMin,Jt=pt.cyFinal+Me(pt.px0[1],pt.px1[1]),ir=Nt-qt;if(ir*Le>0&&(pt.labelExtraY=ir),Array.isArray(_e.pull))for(tt=0;tt<Oe.length;tt++)(Ke=Oe[tt])===pt||(f.castOption(_e.pull,pt.pts)||0)>=(f.castOption(_e.pull,Ke.pts)||0)||((pt.pxmid[1]-Ke.pxmid[1])*Le>0?(ir=Ke.cyFinal+Me(Ke.px0[1],Ke.px1[1])-qt-pt.labelExtraY)*Le>0&&(pt.labelExtraY+=ir):(er+pt.labelExtraY-Jt)*Le>0&&(yt=3*ke*Math.abs(tt-Oe.indexOf(pt)),(vt=Ke.cxFinal+ve(Ke.px0[0],Ke.px1[0])+yt-(pt.cxFinal+pt.pxmid[0])-pt.labelExtraX)*ke>0&&(pt.labelExtraX+=vt)))}for(Ce=0;Ce<2;Ce++)for(fe=Ce?Be:Fe,Me=Ce?Math.max:Math.min,Le=Ce?1:-1,be=0;be<2;be++){for(ve=be?Math.max:Math.min,ke=be?1:-1,(ze=Te[Ce][be]).sort(fe),Re=Te[1-Ce][be],Oe=Re.concat(ze),Pe=[],Ze=0;Ze<ze.length;Ze++)ze[Ze].yLabelMid!==void 0&&Pe.push(ze[Ze]);for(Ie=!1,Ze=0;Ce&&Ze<Re.length;Ze++)if(Re[Ze].yLabelMid!==void 0){Ie=Re[Ze];break}for(Ze=0;Ze<Pe.length;Ze++){var ot=Ze&&Pe[Ze-1];Ie&&!Ze&&(ot=Ie),$e(Pe[Ze],ot)}}}(Q,ee),function(Te,_e){Te.each(function(be){var Ce=p.select(this);if(be.labelExtraX||be.labelExtraY){var fe=Ce.select("g.slicetext text");be.transform.targetX+=be.labelExtraX,be.transform.targetY+=be.labelExtraY,fe.attr("transform",n.getTextTransform(be.transform));var ve=be.cxFinal+be.pxmid[0],Me="M"+ve+","+(be.cyFinal+be.pxmid[1]),ke=(be.yLabelMax-be.yLabelMin)*(be.pxmid[0]<0?-1:1)/4;if(be.labelExtraX){var Le=be.labelExtraX*be.pxmid[1]/be.pxmid[0],ze=be.yLabelMid+be.labelExtraY-(be.cyFinal+be.pxmid[1]);Math.abs(Le)>Math.abs(ze)?Me+="l"+ze*be.pxmid[0]/be.pxmid[1]+","+ze+"H"+(ve+be.labelExtraX+ke):Me+="l"+be.labelExtraX+","+Le+"v"+(ze-Le)+"h"+ke}else Me+="V"+(be.yLabelMid+be.labelExtraY)+"h"+ke;n.ensureSingle(Ce,"path","textline").call(y.stroke,_e.outsidetextfont.color).attr({"stroke-width":Math.min(2,_e.outsidetextfont.size/8),d:Me,fill:"none"})}else Ce.select("path.textline").remove()})}(j,ee),K&&ee.automargin){var ne=e.bBox(B.node()),le=ee.domain,oe=W.w*(le.x[1]-le.x[0]),de=W.h*(le.y[1]-le.y[0]),se=(.5*oe-U.r)/W.w,me=(.5*de-U.r)/W.h;g.autoMargin(X,"pie."+ee.uid+".automargin",{xl:le.x[0]-se,xr:le.x[1]+se,yb:le.y[0]-me,yt:le.y[1]+me,l:Math.max(U.cx-U.r-ne.left,0),r:Math.max(ne.right-(U.cx+U.r),0),b:Math.max(ne.bottom-(U.cy+U.r),0),t:Math.max(U.cy-U.r-ne.top,0),pad:5})}})});setTimeout(function(){te.selectAll("tspan").each(function(){var N=p.select(this);N.attr("dy")&&N.attr("dy",N.attr("dy"))})},0)},formatSliceLabel:H,transformInsideText:c,determineInsideTextFont:s,positionTitleOutside:P,prerenderTitles:x,layoutAreas:D,attachFxHandlers:d,computeTransform:V}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../bar/constants":659,"../bar/uniform_text":673,"./event_data":914,"./helpers":915,"@plotly/d3":58}],920:[function(v,J,Z){var p=v("@plotly/d3"),g=v("./style_one"),b=v("../bar/uniform_text").resizeText;J.exports=function(y){var e=y._fullLayout._pielayer.selectAll(".trace");b(y,e,"pie"),e.each(function(n){var t=n[0].trace,a=p.select(this);a.style({opacity:t.opacity}),a.selectAll("path.surface").each(function(r){p.select(this).call(g,r,t)})})}},{"../bar/uniform_text":673,"./style_one":921,"@plotly/d3":58}],921:[function(v,J,Z){var p=v("../../components/color"),g=v("./helpers").castOption;J.exports=function(b,y,e){var n=e.marker.line,t=g(n.color,y.pts)||p.defaultLine,a=g(n.width,y.pts)||0;b.style("stroke-width",a).call(p.fill,y.color).call(p.stroke,t)}},{"../../components/color":367,"./helpers":915}],922:[function(v,J,Z){var p=v("../scatter/attributes");J.exports={x:p.x,y:p.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:p.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":936}],923:[function(v,J,Z){var p=v("../../../stackgl_modules").gl_pointcloud2d,g=v("../../lib/str2rgbarray"),b=v("../../plots/cartesian/autorange").findExtremes,y=v("../scatter/get_trace_color");function e(t,a){this.scene=t,this.uid=a,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=p(t.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var n=e.prototype;n.handlePick=function(t){var a=this.idToIndex[t.pointId];return{trace:this,dataCoord:t.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*a],this.pickXYData[2*a+1]]:[this.pickXData[a],this.pickYData[a]],textLabel:Array.isArray(this.textLabels)?this.textLabels[a]:this.textLabels,color:this.color,name:this.name,pointIndex:a,hoverinfo:this.hoverinfo}},n.update=function(t){this.index=t.index,this.textLabels=t.text,this.name=t.name,this.hoverinfo=t.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(t),this.color=y(t,{})},n.updateFast=function(t){var a,r,m,o,i,u,f=this.xData=this.pickXData=t.x,l=this.yData=this.pickYData=t.y,h=this.pickXYData=t.xy,d=t.xbounds&&t.ybounds,s=t.indices,x=this.bounds;if(h){if(m=h,a=h.length>>>1,d)x[0]=t.xbounds[0],x[2]=t.xbounds[1],x[1]=t.ybounds[0],x[3]=t.ybounds[1];else for(u=0;u<a;u++)o=m[2*u],i=m[2*u+1],o<x[0]&&(x[0]=o),o>x[2]&&(x[2]=o),i<x[1]&&(x[1]=i),i>x[3]&&(x[3]=i);if(s)r=s;else for(r=new Int32Array(a),u=0;u<a;u++)r[u]=u}else for(a=f.length,m=new Float32Array(2*a),r=new Int32Array(a),u=0;u<a;u++)o=f[u],i=l[u],r[u]=u,m[2*u]=o,m[2*u+1]=i,o<x[0]&&(x[0]=o),o>x[2]&&(x[2]=o),i<x[1]&&(x[1]=i),i>x[3]&&(x[3]=i);this.idToIndex=r,this.pointcloudOptions.idToIndex=r,this.pointcloudOptions.positions=m;var c=g(t.marker.color),T=g(t.marker.border.color),_=t.opacity*t.marker.opacity;c[3]*=_,this.pointcloudOptions.color=c;var w=t.marker.blend;w===null&&(w=f.length<100||l.length<100),this.pointcloudOptions.blend=w,T[3]*=_,this.pointcloudOptions.borderColor=T;var k=t.marker.sizemin,L=Math.max(t.marker.sizemax,t.marker.sizemin);this.pointcloudOptions.sizeMin=k,this.pointcloudOptions.sizeMax=L,this.pointcloudOptions.areaRatio=t.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var A=this.scene.xaxis,I=this.scene.yaxis,P=L/2||.5;t._extremes[A._id]=b(A,[x[0],x[2]],{ppad:P}),t._extremes[I._id]=b(I,[x[1],x[3]],{ppad:P})},n.dispose=function(){this.pointcloud.dispose()},J.exports=function(t,a){var r=new e(t,a.uid);return r.update(a),r}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/autorange":565,"../scatter/get_trace_color":946}],924:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes");J.exports=function(b,y,e){function n(t,a){return p.coerce(b,y,g,t,a)}n("x"),n("y"),n("xbounds"),n("ybounds"),b.xy&&b.xy instanceof Float32Array&&(y.xy=b.xy),b.indices&&b.indices instanceof Int32Array&&(y.indices=b.indices),n("text"),n("marker.color",e),n("marker.opacity"),n("marker.blend"),n("marker.sizemin"),n("marker.sizemax"),n("marker.border.color",e),n("marker.border.arearatio"),y._length=null}},{"../../lib":515,"./attributes":922}],925:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("../scatter3d/calc"),plot:v("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:v("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":605,"../scatter3d/calc":965,"./attributes":922,"./convert":923,"./defaults":924}],926:[function(v,J,Z){var p=v("../../plots/font_attributes"),g=v("../../plots/attributes"),b=v("../../components/color/attributes"),y=v("../../components/fx/attributes"),e=v("../../plots/domain").attributes,n=v("../../plots/template_attributes").hovertemplateAttrs,t=v("../../components/colorscale/attributes"),a=v("../../plot_api/plot_template").templatedArray,r=v("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,m=v("../../lib/extend").extendFlat,o=v("../../plot_api/edit_types").overrideAll;(J.exports=o({hoverinfo:m({},g.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:y.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:r("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:p({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:b.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:y.hoverlabel,hovertemplate:n({},{keys:["value","label"]})},link:{arrowlen:{valType:"number",min:0,dflt:0},label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:b.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:y.hoverlabel,hovertemplate:n({},{keys:["value","label"]}),colorscales:a("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:m(t().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../components/fx/attributes":398,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],927:[function(v,J,Z){var p=v("../../plot_api/edit_types").overrideAll,g=v("../../plots/get_data").getModuleCalcData,b=v("./plot"),y=v("../../components/fx/layout_attributes"),e=v("../../lib/setcursor"),n=v("../../components/dragelement"),t=v("../../components/selections").prepSelect,a=v("../../lib"),r=v("../../registry");function m(o,i){var u=o._fullData[i],f=o._fullLayout,l=f.dragmode,h=f.dragmode==="pan"?"move":"crosshair",d=u._bgRect;if(d&&l!=="pan"&&l!=="zoom"){e(d,h);var s={_id:"x",c2p:a.identity,_offset:u._sankey.translateX,_length:u._sankey.width},x={_id:"y",c2p:a.identity,_offset:u._sankey.translateY,_length:u._sankey.height},c={gd:o,element:d.node(),plotinfo:{id:i,xaxis:s,yaxis:x,fillRangeItems:a.noop},subplot:i,xaxes:[s],yaxes:[x],doneFnCompleted:function(T){var _,w=o._fullData[i],k=w.node.groups.slice(),L=[];function A(E){for(var D=w._sankey.graph.nodes,R=0;R<D.length;R++)if(D[R].pointNumber===E)return D[R]}for(var I=0;I<T.length;I++){var P=A(T[I].pointNumber);if(P)if(P.group){for(var S=0;S<P.childrenNodes.length;S++)L.push(P.childrenNodes[S].pointNumber);k[P.pointNumber-w.node._count]=!1}else L.push(P.pointNumber)}_=k.filter(Boolean).concat([L]),r.call("_guiRestyle",o,{"node.groups":[_]},i)},prepFn:function(T,_,w){t(T,_,w,c,l)}};n.init(c)}}Z.name="sankey",Z.baseLayoutAttrOverrides=p({hoverlabel:y.hoverlabel},"plot","nested"),Z.plot=function(o){var i=g(o.calcdata,"sankey")[0];b(o,i),Z.updateFx(o)},Z.clean=function(o,i,u,f){var l=f._has&&f._has("sankey"),h=i._has&&i._has("sankey");l&&!h&&(f._paperdiv.selectAll(".sankey").remove(),f._paperdiv.selectAll(".bgsankey").remove())},Z.updateFx=function(o){for(var i=0;i<o._fullData.length;i++)m(o,i)}},{"../../components/dragelement":386,"../../components/fx/layout_attributes":408,"../../components/selections":455,"../../lib":515,"../../lib/setcursor":536,"../../plot_api/edit_types":548,"../../plots/get_data":602,"../../registry":647,"./plot":932}],928:[function(v,J,Z){var p=v("strongly-connected-components"),g=v("../../lib"),b=v("../../lib/gup").wrap,y=g.isArrayOrTypedArray,e=g.isIndex,n=v("../../components/colorscale");function t(a){var r,m=a.node,o=a.link,i=[],u=y(o.color),f=y(o.customdata),l={},h={},d=o.colorscales.length;for(r=0;r<d;r++){var s=o.colorscales[r],x=n.extractScale(s,{cLetter:"c"}),c=n.makeColorScaleFunc(x);h[s.label]=c}var T=0;for(r=0;r<o.value.length;r++)o.source[r]>T&&(T=o.source[r]),o.target[r]>T&&(T=o.target[r]);var _,w=T+1;a.node._count=w;var k=a.node.groups,L={};for(r=0;r<k.length;r++){var A=k[r];for(_=0;_<A.length;_++){var I=A[_],P=w+r;L.hasOwnProperty(I)?g.warn("Node "+I+" is already part of a group."):L[I]=P}}var S={source:[],target:[]};for(r=0;r<o.value.length;r++){var E=o.value[r],D=o.source[r],R=o.target[r];if(E>0&&e(D,w)&&e(R,w)&&(!L.hasOwnProperty(D)||!L.hasOwnProperty(R)||L[D]!==L[R])){L.hasOwnProperty(R)&&(R=L[R]),L.hasOwnProperty(D)&&(D=L[D]),R=+R,l[D=+D]=l[R]=!0;var H="";o.label&&o.label[r]&&(H=o.label[r]);var V=null;H&&h.hasOwnProperty(H)&&(V=h[H]),i.push({pointNumber:r,label:H,color:u?o.color[r]:o.color,customdata:f?o.customdata[r]:o.customdata,concentrationscale:V,source:D,target:R,value:+E}),S.source.push(D),S.target.push(R)}}var X=w+k.length,$=y(m.color),G=y(m.customdata),W=[];for(r=0;r<X;r++)if(l[r]){var te=m.label[r];W.push({group:r>w-1,childrenNodes:[],pointNumber:r,label:te,color:$?m.color[r]:m.color,customdata:G?m.customdata[r]:m.customdata})}var N=!1;return function(B,U,ee){for(var j=g.init2dArray(B,0),Q=0;Q<Math.min(U.length,ee.length);Q++)if(g.isIndex(U[Q],B)&&g.isIndex(ee[Q],B)){if(U[Q]===ee[Q])return!0;j[U[Q]].push(ee[Q])}return p(j).components.some(function(K){return K.length>1})}(X,S.source,S.target)&&(N=!0),{circular:N,links:i,nodes:W,groups:k,groupLookup:L}}J.exports=function(a,r){var m=t(r);return b({circular:m.circular,_nodes:m.nodes,_links:m.links,_groups:m.groups,_groupLookup:m.groupLookup})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512,"strongly-connected-components":307}],929:[function(v,J,Z){J.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],930:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes"),b=v("../../components/color"),y=v("tinycolor2"),e=v("../../plots/domain").defaults,n=v("../../components/fx/hoverlabel_defaults"),t=v("../../plot_api/plot_template"),a=v("../../plots/array_container_defaults");function r(m,o){function i(u,f){return p.coerce(m,o,g.link.colorscales,u,f)}i("label"),i("cmin"),i("cmax"),i("colorscale")}J.exports=function(m,o,i,u){function f(L,A){return p.coerce(m,o,g,L,A)}var l=p.extendDeep(u.hoverlabel,m.hoverlabel),h=m.node,d=t.newContainer(o,"node");function s(L,A){return p.coerce(h,d,g.node,L,A)}s("label"),s("groups"),s("x"),s("y"),s("pad"),s("thickness"),s("line.color"),s("line.width"),s("hoverinfo",m.hoverinfo),n(h,d,s,l),s("hovertemplate");var x=u.colorway;s("color",d.label.map(function(L,A){return b.addOpacity(function(I){return x[I%x.length]}(A),.8)})),s("customdata");var c=m.link||{},T=t.newContainer(o,"link");function _(L,A){return p.coerce(c,T,g.link,L,A)}_("label"),_("arrowlen"),_("source"),_("target"),_("value"),_("line.color"),_("line.width"),_("hoverinfo",m.hoverinfo),n(c,T,_,l),_("hovertemplate");var w,k=y(u.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";_("color",p.repeat(k,T.value.length)),_("customdata"),a(c,T,{name:"colorscales",handleItemDefaults:r}),e(o,u,f),f("orientation"),f("valueformat"),f("valuesuffix"),d.x.length&&d.y.length&&(w="freeform"),f("arrangement",w),p.coerceFont(f,"textfont",p.extendFlat({},u.font)),o._length=null}},{"../../components/color":367,"../../components/fx/hoverlabel_defaults":405,"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/domain":593,"./attributes":926,tinycolor2:313}],931:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),moduleType:"trace",name:"sankey",basePlotModule:v("./base_plot"),selectPoints:v("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":926,"./base_plot":927,"./calc":928,"./defaults":930,"./plot":932,"./select.js":934}],932:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=g.numberFormat,y=v("./render"),e=v("../../components/fx"),n=v("../../components/color"),t=v("./constants").cn,a=g._;function r(c){return c!==""}function m(c,T){return c.filter(function(_){return _.key===T.traceId})}function o(c,T){p.select(c).select("path").style("fill-opacity",T),p.select(c).select("rect").style("fill-opacity",T)}function i(c){p.select(c).select("text.name").style("fill","black")}function u(c){return function(T){return c.node.sourceLinks.indexOf(T.link)!==-1||c.node.targetLinks.indexOf(T.link)!==-1}}function f(c){return function(T){return T.node.sourceLinks.indexOf(c.link)!==-1||T.node.targetLinks.indexOf(c.link)!==-1}}function l(c,T,_){T&&_&&m(_,T).selectAll("."+t.sankeyLink).filter(u(T)).call(d.bind(0,T,_,!1))}function h(c,T,_){T&&_&&m(_,T).selectAll("."+t.sankeyLink).filter(u(T)).call(s.bind(0,T,_,!1))}function d(c,T,_,w){var k=w.datum().link.label;w.style("fill-opacity",function(L){if(!L.link.concentrationscale)return .4}),k&&m(T,c).selectAll("."+t.sankeyLink).filter(function(L){return L.link.label===k}).style("fill-opacity",function(L){if(!L.link.concentrationscale)return .4}),_&&m(T,c).selectAll("."+t.sankeyNode).filter(f(c)).call(l)}function s(c,T,_,w){var k=w.datum().link.label;w.style("fill-opacity",function(L){return L.tinyColorAlpha}),k&&m(T,c).selectAll("."+t.sankeyLink).filter(function(L){return L.link.label===k}).style("fill-opacity",function(L){return L.tinyColorAlpha}),_&&m(T,c).selectAll(t.sankeyNode).filter(f(c)).call(h)}function x(c,T){var _=c.hoverlabel||{},w=g.nestedProperty(_,T).get();return!Array.isArray(w)&&w}J.exports=function(c,T){for(var _=c._fullLayout,w=_._paper,k=_._size,L=0;L<c._fullData.length;L++)if(c._fullData[L].visible&&c._fullData[L].type===t.sankey&&!c._fullData[L]._viewInitial){var A=c._fullData[L].node;c._fullData[L]._viewInitial={node:{groups:A.groups.slice(),x:A.x.slice(),y:A.y.slice()}}}var I=a(c,"source:")+" ",P=a(c,"target:")+" ",S=a(c,"concentration:")+" ",E=a(c,"incoming flow count:")+" ",D=a(c,"outgoing flow count:")+" ";y(c,w,T,{width:k.w,height:k.h,margin:{t:k.t,r:k.r,b:k.b,l:k.l}},{linkEvents:{hover:function(R,H,V){c._fullLayout.hovermode!==!1&&(p.select(R).call(d.bind(0,H,V,!0)),H.link.trace.link.hoverinfo!=="skip"&&(H.link.fullData=H.link.trace,c.emit("plotly_hover",{event:p.event,points:[H.link]})))},follow:function(R,H){if(c._fullLayout.hovermode!==!1){var V=H.link.trace.link;if(V.hoverinfo!=="none"&&V.hoverinfo!=="skip"){for(var X=[],$=0,G=0;G<H.flow.links.length;G++){var W=H.flow.links[G];if(c._fullLayout.hovermode!=="closest"||H.link.pointNumber===W.pointNumber){H.link.pointNumber===W.pointNumber&&($=G),W.fullData=W.trace,V=H.link.trace.link;var te=B(W),N={valueLabel:b(H.valueFormat)(W.value)+H.valueSuffix};X.push({x:te[0],y:te[1],name:N.valueLabel,text:[W.label||"",I+W.source.label,P+W.target.label,W.concentrationscale?S+b("%0.2f")(W.flow.labelConcentration):""].filter(r).join("<br>"),color:x(V,"bgcolor")||n.addOpacity(W.color,1),borderColor:x(V,"bordercolor"),fontFamily:x(V,"font.family"),fontSize:x(V,"font.size"),fontColor:x(V,"font.color"),nameLength:x(V,"namelength"),textAlign:x(V,"align"),idealAlign:p.event.x<te[0]?"right":"left",hovertemplate:V.hovertemplate,hovertemplateLabels:N,eventData:[W]})}}e.loneHover(X,{container:_._hoverlayer.node(),outerContainer:_._paper.node(),gd:c,anchorIndex:$}).each(function(){H.link.concentrationscale||o(this,.65),i(this)})}}function B(U){var ee,j;U.circular?(ee=(U.circularPathData.leftInnerExtent+U.circularPathData.rightInnerExtent)/2,j=U.circularPathData.verticalFullExtent):(ee=(U.source.x1+U.target.x0)/2,j=(U.y0+U.y1)/2);var Q=[ee,j];return U.trace.orientation==="v"&&Q.reverse(),Q[0]+=H.parent.translateX,Q[1]+=H.parent.translateY,Q}},unhover:function(R,H,V){c._fullLayout.hovermode!==!1&&(p.select(R).call(s.bind(0,H,V,!0)),H.link.trace.link.hoverinfo!=="skip"&&(H.link.fullData=H.link.trace,c.emit("plotly_unhover",{event:p.event,points:[H.link]})),e.loneUnhover(_._hoverlayer.node()))},select:function(R,H){var V=H.link;V.originalEvent=p.event,c._hoverdata=[V],e.click(c,{target:!0})}},nodeEvents:{hover:function(R,H,V){c._fullLayout.hovermode!==!1&&(p.select(R).call(l,H,V),H.node.trace.node.hoverinfo!=="skip"&&(H.node.fullData=H.node.trace,c.emit("plotly_hover",{event:p.event,points:[H.node]})))},follow:function(R,H){if(c._fullLayout.hovermode!==!1){var V=H.node.trace.node;if(V.hoverinfo!=="none"&&V.hoverinfo!=="skip"){var X=p.select(R).select("."+t.nodeRect),$=c._fullLayout._paperdiv.node().getBoundingClientRect(),G=X.node().getBoundingClientRect(),W=G.left-2-$.left,te=G.right+2-$.left,N=G.top+G.height/4-$.top,B={valueLabel:b(H.valueFormat)(H.node.value)+H.valueSuffix};H.node.fullData=H.node.trace,c._fullLayout._calcInverseTransform(c);var U=c._fullLayout._invScaleX,ee=c._fullLayout._invScaleY,j=e.loneHover({x0:U*W,x1:U*te,y:ee*N,name:b(H.valueFormat)(H.node.value)+H.valueSuffix,text:[H.node.label,E+H.node.targetLinks.length,D+H.node.sourceLinks.length].filter(r).join("<br>"),color:x(V,"bgcolor")||H.tinyColorHue,borderColor:x(V,"bordercolor"),fontFamily:x(V,"font.family"),fontSize:x(V,"font.size"),fontColor:x(V,"font.color"),nameLength:x(V,"namelength"),textAlign:x(V,"align"),idealAlign:"left",hovertemplate:V.hovertemplate,hovertemplateLabels:B,eventData:[H.node]},{container:_._hoverlayer.node(),outerContainer:_._paper.node(),gd:c});o(j,.85),i(j)}}},unhover:function(R,H,V){c._fullLayout.hovermode!==!1&&(p.select(R).call(h,H,V),H.node.trace.node.hoverinfo!=="skip"&&(H.node.fullData=H.node.trace,c.emit("plotly_unhover",{event:p.event,points:[H.node]})),e.loneUnhover(_._hoverlayer.node()))},select:function(R,H,V){var X=H.node;X.originalEvent=p.event,c._hoverdata=[X],p.select(R).call(h,H,V),e.click(c,{target:!0})}}})}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"./constants":929,"./render":933,"@plotly/d3":58}],933:[function(v,J,Z){var p=v("d3-force"),g=v("d3-interpolate").interpolateNumber,b=v("@plotly/d3"),y=v("@plotly/d3-sankey"),e=v("@plotly/d3-sankey-circular"),n=v("./constants"),t=v("tinycolor2"),a=v("../../components/color"),r=v("../../components/drawing"),m=v("../../lib"),o=m.strTranslate,i=m.strRotate,u=v("../../lib/gup"),f=u.keyFun,l=u.repeat,h=u.unwrap,d=v("../../lib/svg_text_utils"),s=v("../../registry"),x=v("../../constants/alignment"),c=x.CAP_SHIFT,T=x.LINE_SPACING;function _(G,W,te){var N,B=h(W),U=B.trace,ee=U.domain,j=U.orientation==="h",Q=U.node.pad,K=U.node.thickness,re=G.width*(ee.x[1]-ee.x[0]),ne=G.height*(ee.y[1]-ee.y[0]),le=B._nodes,oe=B._links,de=B.circular;(N=de?e.sankeyCircular().circularLinkGap(0):y.sankey()).iterations(n.sankeyIterations).size(j?[re,ne]:[ne,re]).nodeWidth(K).nodePadding(Q).nodeId(function(Le){return Le.pointNumber}).nodes(le).links(oe);var se,me,Te,_e=N();for(var be in N.nodePadding()<Q&&m.warn("node.pad was reduced to ",N.nodePadding()," to fit within the figure."),B._groupLookup){var Ce,fe=parseInt(B._groupLookup[be]);for(se=0;se<_e.nodes.length;se++)if(_e.nodes[se].pointNumber===fe){Ce=_e.nodes[se];break}if(Ce){var ve={pointNumber:parseInt(be),x0:Ce.x0,x1:Ce.x1,y0:Ce.y0,y1:Ce.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};_e.nodes.unshift(ve),Ce.childrenNodes.unshift(ve)}}if(function(){for(se=0;se<_e.nodes.length;se++){var Le,ze,Re=_e.nodes[se],Oe={};for(me=0;me<Re.targetLinks.length;me++)Le=(ze=Re.targetLinks[me]).source.pointNumber+":"+ze.target.pointNumber,Oe.hasOwnProperty(Le)||(Oe[Le]=[]),Oe[Le].push(ze);var Ze=Object.keys(Oe);for(me=0;me<Ze.length;me++){var Pe=Oe[Le=Ze[me]],Ie=0,Be={};for(Te=0;Te<Pe.length;Te++)Be[(ze=Pe[Te]).label]||(Be[ze.label]=0),Be[ze.label]+=ze.value,Ie+=ze.value;for(Te=0;Te<Pe.length;Te++)(ze=Pe[Te]).flow={value:Ie,labelConcentration:Be[ze.label]/Ie,concentration:ze.value/Ie,links:Pe},ze.concentrationscale&&(ze.color=t(ze.concentrationscale(ze.flow.labelConcentration)))}var Fe=0;for(me=0;me<Re.sourceLinks.length;me++)Fe+=Re.sourceLinks[me].value;for(me=0;me<Re.sourceLinks.length;me++)(ze=Re.sourceLinks[me]).concentrationOut=ze.value/Fe;var $e=0;for(me=0;me<Re.targetLinks.length;me++)$e+=Re.targetLinks[me].value;for(me=0;me<Re.targetLinks.length;me++)(ze=Re.targetLinks[me]).concenrationIn=ze.value/$e}}(),U.node.x.length&&U.node.y.length){for(se=0;se<Math.min(U.node.x.length,U.node.y.length,_e.nodes.length);se++)if(U.node.x[se]&&U.node.y[se]){var Me=[U.node.x[se]*re,U.node.y[se]*ne];_e.nodes[se].x0=Me[0]-K/2,_e.nodes[se].x1=Me[0]+K/2;var ke=_e.nodes[se].y1-_e.nodes[se].y0;_e.nodes[se].y0=Me[1]-ke/2,_e.nodes[se].y1=Me[1]+ke/2}U.arrangement==="snap"&&function(Le){Le.forEach(function(ze){var Re,Oe,Ze,Pe=0,Ie=ze.length;for(ze.sort(function(Be,Fe){return Be.y0-Fe.y0}),Ze=0;Ze<Ie;++Ze)(Re=ze[Ze]).y0>=Pe||(Oe=Pe-Re.y0)>1e-6&&(Re.y0+=Oe,Re.y1+=Oe),Pe=Re.y1+Q})}(function(Le){var ze,Re,Oe=Le.map(function(Fe,$e){return{x0:Fe.x0,index:$e}}).sort(function(Fe,$e){return Fe.x0-$e.x0}),Ze=[],Pe=-1,Ie=-1/0;for(se=0;se<Oe.length;se++){var Be=Le[Oe[se].index];Be.x0>Ie+K&&(Pe+=1,ze=Be.x0),Ie=Be.x0,Ze[Pe]||(Ze[Pe]=[]),Ze[Pe].push(Be),Re=ze-Be.x0,Be.x0+=Re,Be.x1+=Re}return Ze}(le=_e.nodes)),N.update(_e)}return{circular:de,key:te,trace:U,guid:m.randstr(),horizontal:j,width:re,height:ne,nodePad:U.node.pad,nodeLineColor:U.node.line.color,nodeLineWidth:U.node.line.width,linkLineColor:U.link.line.color,linkLineWidth:U.link.line.width,linkArrowLength:U.link.arrowlen,valueFormat:U.valueformat,valueSuffix:U.valuesuffix,textFont:U.textfont,translateX:ee.x[0]*G.width+G.margin.l,translateY:G.height-ee.y[1]*G.height+G.margin.t,dragParallel:j?ne:re,dragPerpendicular:j?re:ne,arrangement:U.arrangement,sankey:N,graph:_e,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function w(G,W,te){var N=t(W.color),B=W.source.label+"|"+W.target.label+"__"+te;return W.trace=G.trace,W.curveNumber=G.trace.index,{circular:G.circular,key:B,traceId:G.key,pointNumber:W.pointNumber,link:W,tinyColorHue:a.tinyRGB(N),tinyColorAlpha:N.getAlpha(),linkPath:k,linkLineColor:G.linkLineColor,linkLineWidth:G.linkLineWidth,linkArrowLength:G.linkArrowLength,valueFormat:G.valueFormat,valueSuffix:G.valueSuffix,sankey:G.sankey,parent:G,interactionState:G.interactionState,flow:W.flow}}function k(){return function(G){var W=G.linkArrowLength;if(G.link.circular)return function(me,Te){var _e=me.width/2,be=me.circularPathData;return me.circularLinkType==="top"?"M "+(be.targetX-Te)+" "+(be.targetY+_e)+" L"+(be.rightInnerExtent-Te)+" "+(be.targetY+_e)+"A"+(be.rightLargeArcRadius+_e)+" "+(be.rightSmallArcRadius+_e)+" 0 0 1 "+(be.rightFullExtent-_e-Te)+" "+(be.targetY-be.rightSmallArcRadius)+"L"+(be.rightFullExtent-_e-Te)+" "+be.verticalRightInnerExtent+"A"+(be.rightLargeArcRadius+_e)+" "+(be.rightLargeArcRadius+_e)+" 0 0 1 "+(be.rightInnerExtent-Te)+" "+(be.verticalFullExtent-_e)+"L"+be.leftInnerExtent+" "+(be.verticalFullExtent-_e)+"A"+(be.leftLargeArcRadius+_e)+" "+(be.leftLargeArcRadius+_e)+" 0 0 1 "+(be.leftFullExtent+_e)+" "+be.verticalLeftInnerExtent+"L"+(be.leftFullExtent+_e)+" "+(be.sourceY-be.leftSmallArcRadius)+"A"+(be.leftLargeArcRadius+_e)+" "+(be.leftSmallArcRadius+_e)+" 0 0 1 "+be.leftInnerExtent+" "+(be.sourceY+_e)+"L"+be.sourceX+" "+(be.sourceY+_e)+"L"+be.sourceX+" "+(be.sourceY-_e)+"L"+be.leftInnerExtent+" "+(be.sourceY-_e)+"A"+(be.leftLargeArcRadius-_e)+" "+(be.leftSmallArcRadius-_e)+" 0 0 0 "+(be.leftFullExtent-_e)+" "+(be.sourceY-be.leftSmallArcRadius)+"L"+(be.leftFullExtent-_e)+" "+be.verticalLeftInnerExtent+"A"+(be.leftLargeArcRadius-_e)+" "+(be.leftLargeArcRadius-_e)+" 0 0 0 "+be.leftInnerExtent+" "+(be.verticalFullExtent+_e)+"L"+(be.rightInnerExtent-Te)+" "+(be.verticalFullExtent+_e)+"A"+(be.rightLargeArcRadius-_e)+" "+(be.rightLargeArcRadius-_e)+" 0 0 0 "+(be.rightFullExtent+_e-Te)+" "+be.verticalRightInnerExtent+"L"+(be.rightFullExtent+_e-Te)+" "+(be.targetY-be.rightSmallArcRadius)+"A"+(be.rightLargeArcRadius-_e)+" "+(be.rightSmallArcRadius-_e)+" 0 0 0 "+(be.rightInnerExtent-Te)+" "+(be.targetY-_e)+"L"+(be.targetX-Te)+" "+(be.targetY-_e)+(Te>0?"L"+be.targetX+" "+be.targetY:"")+"Z":"M "+(be.targetX-Te)+" "+(be.targetY-_e)+" L"+(be.rightInnerExtent-Te)+" "+(be.targetY-_e)+"A"+(be.rightLargeArcRadius+_e)+" "+(be.rightSmallArcRadius+_e)+" 0 0 0 "+(be.rightFullExtent-_e-Te)+" "+(be.targetY+be.rightSmallArcRadius)+"L"+(be.rightFullExtent-_e-Te)+" "+be.verticalRightInnerExtent+"A"+(be.rightLargeArcRadius+_e)+" "+(be.rightLargeArcRadius+_e)+" 0 0 0 "+(be.rightInnerExtent-Te)+" "+(be.verticalFullExtent+_e)+"L"+be.leftInnerExtent+" "+(be.verticalFullExtent+_e)+"A"+(be.leftLargeArcRadius+_e)+" "+(be.leftLargeArcRadius+_e)+" 0 0 0 "+(be.leftFullExtent+_e)+" "+be.verticalLeftInnerExtent+"L"+(be.leftFullExtent+_e)+" "+(be.sourceY+be.leftSmallArcRadius)+"A"+(be.leftLargeArcRadius+_e)+" "+(be.leftSmallArcRadius+_e)+" 0 0 0 "+be.leftInnerExtent+" "+(be.sourceY-_e)+"L"+be.sourceX+" "+(be.sourceY-_e)+"L"+be.sourceX+" "+(be.sourceY+_e)+"L"+be.leftInnerExtent+" "+(be.sourceY+_e)+"A"+(be.leftLargeArcRadius-_e)+" "+(be.leftSmallArcRadius-_e)+" 0 0 1 "+(be.leftFullExtent-_e)+" "+(be.sourceY+be.leftSmallArcRadius)+"L"+(be.leftFullExtent-_e)+" "+be.verticalLeftInnerExtent+"A"+(be.leftLargeArcRadius-_e)+" "+(be.leftLargeArcRadius-_e)+" 0 0 1 "+be.leftInnerExtent+" "+(be.verticalFullExtent-_e)+"L"+(be.rightInnerExtent-Te)+" "+(be.verticalFullExtent-_e)+"A"+(be.rightLargeArcRadius-_e)+" "+(be.rightLargeArcRadius-_e)+" 0 0 1 "+(be.rightFullExtent+_e-Te)+" "+be.verticalRightInnerExtent+"L"+(be.rightFullExtent+_e-Te)+" "+(be.targetY+be.rightSmallArcRadius)+"A"+(be.rightLargeArcRadius-_e)+" "+(be.rightSmallArcRadius-_e)+" 0 0 1 "+(be.rightInnerExtent-Te)+" "+(be.targetY+_e)+"L"+(be.targetX-Te)+" "+(be.targetY+_e)+(Te>0?"L"+be.targetX+" "+be.targetY:"")+"Z"}(G.link,W);var te=Math.abs((G.link.target.x0-G.link.source.x1)/2);W>te&&(W=te);var N=G.link.source.x1,B=G.link.target.x0-W,U=g(N,B),ee=U(.5),j=U(.5),Q=G.link.y0-G.link.width/2,K=G.link.y0+G.link.width/2,re=G.link.y1-G.link.width/2,ne=G.link.y1+G.link.width/2,le="M"+N+","+Q,oe="C"+ee+","+Q+" "+j+","+re+" "+B+","+re,de="C"+j+","+ne+" "+ee+","+K+" "+N+","+K,se=W>0?"L"+(B+W)+","+(re+G.link.width/2):"";return le+oe+(se+="L"+B+","+ne)+de+"Z"}}function L(G,W){var te=t(W.color),N=n.nodePadAcross,B=G.nodePad/2;W.dx=W.x1-W.x0,W.dy=W.y1-W.y0;var U=W.dx,ee=Math.max(.5,W.dy),j="node_"+W.pointNumber;return W.group&&(j=m.randstr()),W.trace=G.trace,W.curveNumber=G.trace.index,{index:W.pointNumber,key:j,partOfGroup:W.partOfGroup||!1,group:W.group,traceId:G.key,trace:G.trace,node:W,nodePad:G.nodePad,nodeLineColor:G.nodeLineColor,nodeLineWidth:G.nodeLineWidth,textFont:G.textFont,size:G.horizontal?G.height:G.width,visibleWidth:Math.ceil(U),visibleHeight:ee,zoneX:-N,zoneY:-B,zoneWidth:U+2*N,zoneHeight:ee+2*B,labelY:G.horizontal?W.dy/2+1:W.dx/2+1,left:W.originalLayer===1,sizeAcross:G.width,forceLayouts:G.forceLayouts,horizontal:G.horizontal,darkBackground:te.getBrightness()<=128,tinyColorHue:a.tinyRGB(te),tinyColorAlpha:te.getAlpha(),valueFormat:G.valueFormat,valueSuffix:G.valueSuffix,sankey:G.sankey,graph:G.graph,arrangement:G.arrangement,uniqueNodeLabelPathId:[G.guid,G.key,j].join("_"),interactionState:G.interactionState,figure:G}}function A(G){G.attr("transform",function(W){return o(W.node.x0.toFixed(3),W.node.y0.toFixed(3))})}function I(G){G.call(A)}function P(G,W){G.call(I),W.attr("d",k())}function S(G){G.attr("width",function(W){return W.node.x1-W.node.x0}).attr("height",function(W){return W.visibleHeight})}function E(G){return G.link.width>1||G.linkLineWidth>0}function D(G){return o(G.translateX,G.translateY)+(G.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function R(G,W,te){G.on(".basic",null).on("mouseover.basic",function(N){N.interactionState.dragInProgress||N.partOfGroup||(te.hover(this,N,W),N.interactionState.hovered=[this,N])}).on("mousemove.basic",function(N){N.interactionState.dragInProgress||N.partOfGroup||(te.follow(this,N),N.interactionState.hovered=[this,N])}).on("mouseout.basic",function(N){N.interactionState.dragInProgress||N.partOfGroup||(te.unhover(this,N,W),N.interactionState.hovered=!1)}).on("click.basic",function(N){N.interactionState.hovered&&(te.unhover(this,N,W),N.interactionState.hovered=!1),N.interactionState.dragInProgress||N.partOfGroup||te.select(this,N,W)})}function H(G,W,te,N){var B=b.behavior.drag().origin(function(U){return{x:U.node.x0+U.visibleWidth/2,y:U.node.y0+U.visibleHeight/2}}).on("dragstart",function(U){if(U.arrangement!=="fixed"&&(m.ensureSingle(N._fullLayout._infolayer,"g","dragcover",function(j){N._fullLayout._dragCover=j}),m.raiseToTop(this),U.interactionState.dragInProgress=U.node,X(U.node),U.interactionState.hovered&&(te.nodeEvents.unhover.apply(0,U.interactionState.hovered),U.interactionState.hovered=!1),U.arrangement==="snap")){var ee=U.traceId+"|"+U.key;U.forceLayouts[ee]?U.forceLayouts[ee].alpha(1):function(j,Q,K,re){(function(le){for(var oe=0;oe<le.length;oe++)le[oe].y=(le[oe].y0+le[oe].y1)/2,le[oe].x=(le[oe].x0+le[oe].x1)/2})(K.graph.nodes);var ne=K.graph.nodes.filter(function(le){return le.originalX===K.node.originalX}).filter(function(le){return!le.partOfGroup});K.forceLayouts[Q]=p.forceSimulation(ne).alphaDecay(0).force("collide",p.forceCollide().radius(function(le){return le.dy/2+K.nodePad/2}).strength(1).iterations(n.forceIterations)).force("constrain",function(le,oe,de,se){return function(){for(var me=0,Te=0;Te<de.length;Te++){var _e=de[Te];_e===se.interactionState.dragInProgress?(_e.x=_e.lastDraggedX,_e.y=_e.lastDraggedY):(_e.vx=(_e.originalX-_e.x)/n.forceTicksPerFrame,_e.y=Math.min(se.size-_e.dy/2,Math.max(_e.dy/2,_e.y))),me=Math.max(me,Math.abs(_e.vx),Math.abs(_e.vy))}!se.interactionState.dragInProgress&&me<.1&&se.forceLayouts[oe].alpha()>0&&se.forceLayouts[oe].alpha(0)}}(0,Q,ne,K)).stop()}(0,ee,U),function(j,Q,K,re,ne){window.requestAnimationFrame(function le(){var oe;for(oe=0;oe<n.forceTicksPerFrame;oe++)K.forceLayouts[re].tick();if(function(se){for(var me=0;me<se.length;me++)se[me].y0=se[me].y-se[me].dy/2,se[me].y1=se[me].y0+se[me].dy,se[me].x0=se[me].x-se[me].dx/2,se[me].x1=se[me].x0+se[me].dx}(K.graph.nodes),K.sankey.update(K.graph),P(j.filter($(K)),Q),K.forceLayouts[re].alpha()>0)window.requestAnimationFrame(le);else{var de=K.node.originalX;K.node.x0=de-K.visibleWidth/2,K.node.x1=de+K.visibleWidth/2,V(K,ne)}})}(G,W,U,ee,N)}}).on("drag",function(U){if(U.arrangement!=="fixed"){var ee=b.event.x,j=b.event.y;U.arrangement==="snap"?(U.node.x0=ee-U.visibleWidth/2,U.node.x1=ee+U.visibleWidth/2,U.node.y0=j-U.visibleHeight/2,U.node.y1=j+U.visibleHeight/2):(U.arrangement==="freeform"&&(U.node.x0=ee-U.visibleWidth/2,U.node.x1=ee+U.visibleWidth/2),j=Math.max(0,Math.min(U.size-U.visibleHeight/2,j)),U.node.y0=j-U.visibleHeight/2,U.node.y1=j+U.visibleHeight/2),X(U.node),U.arrangement!=="snap"&&(U.sankey.update(U.graph),P(G.filter($(U)),W))}}).on("dragend",function(U){if(U.arrangement!=="fixed"){U.interactionState.dragInProgress=!1;for(var ee=0;ee<U.node.childrenNodes.length;ee++)U.node.childrenNodes[ee].x=U.node.x,U.node.childrenNodes[ee].y=U.node.y;U.arrangement!=="snap"&&V(U,N)}});G.on(".drag",null).call(B)}function V(G,W){for(var te=[],N=[],B=0;B<G.graph.nodes.length;B++){var U=(G.graph.nodes[B].x0+G.graph.nodes[B].x1)/2,ee=(G.graph.nodes[B].y0+G.graph.nodes[B].y1)/2;te.push(U/G.figure.width),N.push(ee/G.figure.height)}s.call("_guiRestyle",W,{"node.x":[te],"node.y":[N]},G.trace.index).then(function(){W._fullLayout._dragCover&&W._fullLayout._dragCover.remove()})}function X(G){G.lastDraggedX=G.x0+G.dx/2,G.lastDraggedY=G.y0+G.dy/2}function $(G){return function(W){return W.node.originalX===G.node.originalX}}J.exports=function(G,W,te,N,B){var U=!1;m.ensureSingle(G._fullLayout._infolayer,"g","first-render",function(){U=!0});var ee=G._fullLayout._dragCover,j=te.filter(function(se){return h(se).trace.visible}).map(_.bind(null,N)),Q=W.selectAll("."+n.cn.sankey).data(j,f);Q.exit().remove(),Q.enter().append("g").classed(n.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",D),Q.each(function(se,me){G._fullData[me]._sankey=se;var Te="bgsankey-"+se.trace.uid+"-"+me;m.ensureSingle(G._fullLayout._draggers,"rect",Te),G._fullData[me]._bgRect=b.select("."+Te),G._fullData[me]._bgRect.style("pointer-events","all").attr("width",se.width).attr("height",se.height).attr("x",se.translateX).attr("y",se.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),Q.transition().ease(n.ease).duration(n.duration).attr("transform",D);var K=Q.selectAll("."+n.cn.sankeyLinks).data(l,f);K.enter().append("g").classed(n.cn.sankeyLinks,!0).style("fill","none");var re=K.selectAll("."+n.cn.sankeyLink).data(function(se){return se.graph.links.filter(function(me){return me.value}).map(w.bind(null,se))},f);re.enter().append("path").classed(n.cn.sankeyLink,!0).call(R,Q,B.linkEvents),re.style("stroke",function(se){return E(se)?a.tinyRGB(t(se.linkLineColor)):se.tinyColorHue}).style("stroke-opacity",function(se){return E(se)?a.opacity(se.linkLineColor):se.tinyColorAlpha}).style("fill",function(se){return se.tinyColorHue}).style("fill-opacity",function(se){return se.tinyColorAlpha}).style("stroke-width",function(se){return E(se)?se.linkLineWidth:1}).attr("d",k()),re.style("opacity",function(){return G._context.staticPlot||U||ee?1:0}).transition().ease(n.ease).duration(n.duration).style("opacity",1),re.exit().transition().ease(n.ease).duration(n.duration).style("opacity",0).remove();var ne=Q.selectAll("."+n.cn.sankeyNodeSet).data(l,f);ne.enter().append("g").classed(n.cn.sankeyNodeSet,!0),ne.style("cursor",function(se){switch(se.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var le=ne.selectAll("."+n.cn.sankeyNode).data(function(se){var me=se.graph.nodes;return function(Te){var _e,be=[];for(_e=0;_e<Te.length;_e++)Te[_e].originalX=(Te[_e].x0+Te[_e].x1)/2,Te[_e].originalY=(Te[_e].y0+Te[_e].y1)/2,be.indexOf(Te[_e].originalX)===-1&&be.push(Te[_e].originalX);for(be.sort(function(Ce,fe){return Ce-fe}),_e=0;_e<Te.length;_e++)Te[_e].originalLayerIndex=be.indexOf(Te[_e].originalX),Te[_e].originalLayer=Te[_e].originalLayerIndex/(be.length-1)}(me),me.map(L.bind(null,se))},f);le.enter().append("g").classed(n.cn.sankeyNode,!0).call(A).style("opacity",function(se){return!G._context.staticPlot&&!U||se.partOfGroup?0:1}),le.call(R,Q,B.nodeEvents).call(H,re,B,G),le.transition().ease(n.ease).duration(n.duration).call(A).style("opacity",function(se){return se.partOfGroup?0:1}),le.exit().transition().ease(n.ease).duration(n.duration).style("opacity",0).remove();var oe=le.selectAll("."+n.cn.nodeRect).data(l);oe.enter().append("rect").classed(n.cn.nodeRect,!0).call(S),oe.style("stroke-width",function(se){return se.nodeLineWidth}).style("stroke",function(se){return a.tinyRGB(t(se.nodeLineColor))}).style("stroke-opacity",function(se){return a.opacity(se.nodeLineColor)}).style("fill",function(se){return se.tinyColorHue}).style("fill-opacity",function(se){return se.tinyColorAlpha}),oe.transition().ease(n.ease).duration(n.duration).call(S);var de=le.selectAll("."+n.cn.nodeLabel).data(l);de.enter().append("text").classed(n.cn.nodeLabel,!0).style("cursor","default"),de.attr("data-notex",1).text(function(se){return se.node.label}).each(function(se){var me=b.select(this);r.font(me,se.textFont),d.convertToTspans(me,G)}).style("text-shadow",d.makeTextShadow(G._fullLayout.paper_bgcolor)).attr("text-anchor",function(se){return se.horizontal&&se.left?"end":"start"}).attr("transform",function(se){var me=b.select(this),Te=d.lineCount(me),_e=se.textFont.size*((Te-1)*T-c),be=se.nodeLineWidth/2+3,Ce=((se.horizontal?se.visibleHeight:se.visibleWidth)-_e)/2;se.horizontal&&(se.left?be=-be:be+=se.visibleWidth);var fe=se.horizontal?"":"scale(-1,1)"+i(90);return o(se.horizontal?be:Ce,se.horizontal?Ce:be)+fe}),de.transition().ease(n.ease).duration(n.duration)}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../registry":647,"./constants":929,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:313}],934:[function(v,J,Z){J.exports=function(p,g){for(var b=[],y=p.cd[0].trace,e=y._sankey.graph.nodes,n=0;n<e.length;n++){var t=e[n];if(!t.partOfGroup){var a=[(t.x0+t.x1)/2,(t.y0+t.y1)/2];y.orientation==="v"&&a.reverse(),g&&g.contains(a,!1,n,p)&&b.push({pointNumber:t.pointNumber})}}return b}},{}],935:[function(v,J,Z){var p=v("../../lib");J.exports=function(g,b){for(var y=0;y<g.length;y++)g[y].i=y;p.mergeArray(b.text,g,"tx"),p.mergeArray(b.texttemplate,g,"txt"),p.mergeArray(b.hovertext,g,"htx"),p.mergeArray(b.customdata,g,"data"),p.mergeArray(b.textposition,g,"tp"),b.textfont&&(p.mergeArrayCastPositive(b.textfont.size,g,"ts"),p.mergeArray(b.textfont.color,g,"tc"),p.mergeArray(b.textfont.family,g,"tf"));var e=b.marker;if(e){p.mergeArrayCastPositive(e.size,g,"ms"),p.mergeArrayCastPositive(e.opacity,g,"mo"),p.mergeArray(e.symbol,g,"mx"),p.mergeArray(e.color,g,"mc");var n=e.line;e.line&&(p.mergeArray(n.color,g,"mlc"),p.mergeArrayCastPositive(n.width,g,"mlw"));var t=e.gradient;t&&t.type!=="none"&&(p.mergeArray(t.type,g,"mgt"),p.mergeArray(t.color,g,"mgc"))}}},{"../../lib":515}],936:[function(v,J,Z){var p=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,g=v("../../plots/template_attributes").texttemplateAttrs,b=v("../../plots/template_attributes").hovertemplateAttrs,y=v("../../components/colorscale/attributes"),e=v("../../plots/font_attributes"),n=v("../../components/drawing/attributes").dash,t=v("../../components/drawing/attributes").pattern,a=v("../../components/drawing"),r=v("./constants"),m=v("../../lib/extend").extendFlat;J.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},xhoverformat:p("x"),yhoverformat:p("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:g({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:b({},{keys:r.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:m({},n,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:t,marker:m({symbol:{valType:"enumerated",values:a.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:m({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},y("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},y("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":374,"../../components/drawing":389,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"./constants":940}],937:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("../../plots/cartesian/axes"),y=v("../../plots/cartesian/align_period"),e=v("../../constants/numerical").BADNUM,n=v("./subtypes"),t=v("./colorscale_calc"),a=v("./arrays_to_calcdata"),r=v("./calc_selection");function m(l,h,d,s,x,c,T){var _=h._length,w=l._fullLayout,k=d._id,L=s._id,A=w._firstScatter[u(h)]===h.uid,I=(f(h,w,d,s)||{}).orientation,P=h.fill;d._minDtick=0,s._minDtick=0;var S={padded:!0},E={padded:!0};T&&(S.ppad=E.ppad=T);var D=_<2||x[0]!==x[_-1]||c[0]!==c[_-1];D&&(P==="tozerox"||P==="tonextx"&&(A||I==="h"))?S.tozero=!0:(h.error_y||{}).visible||P!=="tonexty"&&P!=="tozeroy"&&(n.hasMarkers(h)||n.hasText(h))||(S.padded=!1,S.ppad=0),D&&(P==="tozeroy"||P==="tonexty"&&(A||I==="v"))?E.tozero=!0:P!=="tonextx"&&P!=="tozerox"||(E.padded=!1),k&&(h._extremes[k]=b.findExtremes(d,x,S)),L&&(h._extremes[L]=b.findExtremes(s,c,E))}function o(l,h){if(n.hasMarkers(l)){var d,s=l.marker,x=1.6*(l.marker.sizeref||1);if(d=l.marker.sizemode==="area"?function(k){return Math.max(Math.sqrt((k||0)/x),3)}:function(k){return Math.max((k||0)/x,3)},g.isArrayOrTypedArray(s.size)){var c={type:"linear"};b.setConvert(c);for(var T=c.makeCalcdata(l.marker,"size"),_=new Array(h),w=0;w<h;w++)_[w]=d(T[w]);return _}return d(s.size)}}function i(l,h){var d=u(h),s=l._firstScatter;s[d]||(s[d]=h.uid)}function u(l){var h=l.stackgroup;return l.xaxis+l.yaxis+l.type+(h?"-"+h:"")}function f(l,h,d,s){var x=l.stackgroup;if(x){var c=h._scatterStackOpts[d._id+s._id][x],T=c.orientation==="v"?s:d;return T.type==="linear"||T.type==="log"?c:void 0}}J.exports={calc:function(l,h){var d,s,x,c,T,_,w=l._fullLayout,k=b.getFromId(l,h.xaxis||"x"),L=b.getFromId(l,h.yaxis||"y"),A=k.makeCalcdata(h,"x"),I=L.makeCalcdata(h,"y"),P=y(h,k,"x",A),S=y(h,L,"y",I),E=P.vals,D=S.vals,R=h._length,H=new Array(R),V=h.ids,X=f(h,w,k,L),$=!1;i(w,h);var G,W="x",te="y";X?(g.pushUnique(X.traceIndices,h._expandedIndex),(d=X.orientation==="v")?(te="s",G="x"):(W="s",G="y"),T=X.stackgaps==="interpolate"):m(l,h,k,L,E,D,o(h,R));var N=!!h.xperiodalignment,B=!!h.yperiodalignment;for(s=0;s<R;s++){var U=H[s]={},ee=p(E[s]),j=p(D[s]);ee&&j?(U[W]=E[s],U[te]=D[s],N&&(U.orig_x=A[s],U.xEnd=P.ends[s],U.xStart=P.starts[s]),B&&(U.orig_y=I[s],U.yEnd=S.ends[s],U.yStart=S.starts[s])):X&&(d?ee:j)?(U[G]=d?E[s]:D[s],U.gap=!0,T?(U.s=e,$=!0):U.s=0):U[W]=U[te]=e,V&&(U.id=String(V[s]))}if(a(H,h),t(l,h),r(H,h),X){for(s=0;s<H.length;)H[s][G]===e?H.splice(s,1):s++;if(g.sort(H,function(ne,le){return ne[G]-le[G]||ne.i-le.i}),$){for(s=0;s<H.length-1&&H[s].gap;)s++;for((_=H[s].s)||(_=H[s].s=0),x=0;x<s;x++)H[x].s=_;for(c=H.length-1;c>s&&H[c].gap;)c--;for(_=H[c].s,x=H.length-1;x>c;x--)H[x].s=_;for(;s<c;)if(H[++s].gap){for(x=s+1;H[x].gap;)x++;for(var Q=H[s-1][G],K=H[s-1].s,re=(H[x].s-K)/(H[x][G]-Q);s<x;)H[s].s=K+(H[s][G]-Q)*re,s++}}}return H},calcMarkerSize:o,calcAxisExpansion:m,setFirstScatter:i,getStackOpts:f}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"./arrays_to_calcdata":935,"./calc_selection":938,"./colorscale_calc":939,"./subtypes":961,"fast-isnumeric":190}],938:[function(v,J,Z){var p=v("../../lib");J.exports=function(g,b){p.isArrayOrTypedArray(b.selectedpoints)&&p.tagSelected(g,b)}},{"../../lib":515}],939:[function(v,J,Z){var p=v("../../components/colorscale/helpers").hasColorscale,g=v("../../components/colorscale/calc"),b=v("./subtypes");J.exports=function(y,e){b.hasLines(e)&&p(e,"line")&&g(y,e,{vals:e.line.color,containerStr:"line",cLetter:"c"}),b.hasMarkers(e)&&(p(e,"marker")&&g(y,e,{vals:e.marker.color,containerStr:"marker",cLetter:"c"}),p(e,"marker.line")&&g(y,e,{vals:e.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"./subtypes":961}],940:[function(v,J,Z){J.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],941:[function(v,J,Z){var p=v("./calc");function g(b,y,e,n,t,a,r){t[n]=!0;var m={i:null,gap:!0,s:0};if(m[r]=e,b.splice(y,0,m),y&&e===b[y-1][r]){var o=b[y-1];m.s=o.s,m.i=o.i,m.gap=o.gap}else a&&(m.s=function(i,u,f,l){var h=i[u-1],d=i[u+1];return d?h?h.s+(d.s-h.s)*(f-h[l])/(d[l]-h[l]):d.s:h.s}(b,y,e,r));y||(b[0].t=b[1].t,b[0].trace=b[1].trace,delete b[1].t,delete b[1].trace)}J.exports=function(b,y){var e=y.xaxis,n=y.yaxis,t=e._id+n._id,a=b._fullLayout._scatterStackOpts[t];if(a){var r,m,o,i,u,f,l,h,d,s,x,c,T,_,w,k=b.calcdata;for(var L in a){var A=(s=a[L]).traceIndices;if(A.length){for(x=s.stackgaps==="interpolate",c=s.groupnorm,s.orientation==="v"?(T="x",_="y"):(T="y",_="x"),w=new Array(A.length),r=0;r<w.length;r++)w[r]=!1;f=k[A[0]];var I=new Array(f.length);for(r=0;r<f.length;r++)I[r]=f[r][T];for(r=1;r<A.length;r++){for(u=k[A[r]],m=o=0;m<u.length;m++){for(l=u[m][T];l>I[o]&&o<I.length;o++)g(u,m,I[o],r,w,x,T),m++;if(l!==I[o]){for(i=0;i<r;i++)g(k[A[i]],o,l,i,w,x,T);I.splice(o,0,l)}o++}for(;o<I.length;o++)g(u,m,I[o],r,w,x,T),m++}var P=I.length;for(m=0;m<f.length;m++){for(h=f[m][_]=f[m].s,r=1;r<A.length;r++)(u=k[A[r]])[0].trace._rawLength=u[0].trace._length,u[0].trace._length=P,h+=u[m].s,u[m][_]=h;if(c)for(d=(c==="fraction"?h:h/100)||1,r=0;r<A.length;r++){var S=k[A[r]][m];S[_]/=d,S.sNorm=S.s/d}}for(r=0;r<A.length;r++){var E=(u=k[A[r]])[0].trace,D=p.calcMarkerSize(E,E._rawLength),R=Array.isArray(D);if(D&&w[r]||R){var H=D;for(D=new Array(P),m=0;m<P;m++)D[m]=u[m].gap?0:R?H[u[m].i]:H}var V=new Array(P),X=new Array(P);for(m=0;m<P;m++)V[m]=u[m].x,X[m]=u[m].y;p.calcAxisExpansion(b,E,e,n,V,X,D),u[0].t.orientation=s.orientation}}}}}},{"./calc":937}],942:[function(v,J,Z){J.exports=function(p){for(var g=0;g<p.length;g++){var b=p[g];if(b.type==="scatter"){var y=b.fill;if(y!=="none"&&y!=="toself"&&(b.opacity=void 0,y==="tonexty"||y==="tonextx"))for(var e=g-1;e>=0;e--){var n=p[e];if(n.type==="scatter"&&n.xaxis===b.xaxis&&n.yaxis===b.yaxis){n.opacity=void 0;break}}}}}},{}],943:[function(v,J,Z){var p=v("../../lib"),g=v("../../registry"),b=v("./attributes"),y=v("./constants"),e=v("./subtypes"),n=v("./xy_defaults"),t=v("./period_defaults"),a=v("./stack_defaults"),r=v("./marker_defaults"),m=v("./line_defaults"),o=v("./line_shape_defaults"),i=v("./text_defaults"),u=v("./fillcolor_defaults"),f=v("../../lib").coercePattern;J.exports=function(l,h,d,s){function x(I,P){return p.coerce(l,h,b,I,P)}var c=n(l,h,s,x);if(c||(h.visible=!1),h.visible){t(l,h,s,x),x("xhoverformat"),x("yhoverformat");var T=a(l,h,s,x),_=!T&&c<y.PTS_LINESONLY?"lines+markers":"lines";x("text"),x("hovertext"),x("mode",_),e.hasLines(h)&&(m(l,h,d,s,x),o(l,h,x),x("connectgaps"),x("line.simplify")),e.hasMarkers(h)&&r(l,h,d,s,x,{gradient:!0}),e.hasText(h)&&(x("texttemplate"),i(l,h,s,x));var w=[];(e.hasMarkers(h)||e.hasText(h))&&(x("cliponaxis"),x("marker.maxdisplayed"),w.push("points")),x("fill",T?T.fillDflt:"none"),h.fill!=="none"&&(u(l,h,d,x),e.hasLines(h)||o(l,h,x),f(x,"fillpattern",h.fillcolor,!1));var k=(h.line||{}).color,L=(h.marker||{}).color;h.fill!=="tonext"&&h.fill!=="toself"||w.push("fills"),x("hoveron",w.join("+")||"points"),h.hoveron!=="fills"&&x("hovertemplate");var A=g.getComponentMethod("errorbars","supplyDefaults");A(l,h,k||L||d,{axis:"y"}),A(l,h,k||L||d,{axis:"x",inherit:"y"}),p.coerceSelectionMarkerOpacity(h,x)}}},{"../../lib":515,"../../registry":647,"./attributes":936,"./constants":940,"./fillcolor_defaults":944,"./line_defaults":949,"./line_shape_defaults":951,"./marker_defaults":955,"./period_defaults":956,"./stack_defaults":959,"./subtypes":961,"./text_defaults":962,"./xy_defaults":963}],944:[function(v,J,Z){var p=v("../../components/color"),g=v("../../lib").isArrayOrTypedArray;J.exports=function(b,y,e,n){var t=!1;if(y.marker){var a=y.marker.color,r=(y.marker.line||{}).color;a&&!g(a)?t=a:r&&!g(r)&&(t=r)}n("fillcolor",p.addOpacity((y.line||{}).color||t||e,.5))}},{"../../components/color":367,"../../lib":515}],945:[function(v,J,Z){var p=v("../../plots/cartesian/axes");J.exports=function(g,b,y){var e={},n={_fullLayout:y},t=p.getFromTrace(n,b,"x"),a=p.getFromTrace(n,b,"y");return e.xLabel=p.tickText(t,t.c2l(g.x),!0).text,e.yLabel=p.tickText(a,a.c2l(g.y),!0).text,e}},{"../../plots/cartesian/axes":566}],946:[function(v,J,Z){var p=v("../../components/color"),g=v("./subtypes");J.exports=function(b,y){var e,n;if(b.mode==="lines")return(e=b.line.color)&&p.opacity(e)?e:b.fillcolor;if(b.mode==="none")return b.fill?b.fillcolor:"";var t=y.mcc||(b.marker||{}).color,a=y.mlcc||((b.marker||{}).line||{}).color;return(n=t&&p.opacity(t)?t:a&&p.opacity(a)&&(y.mlw||((b.marker||{}).line||{}).width)?a:"")?p.opacity(n)<.3?p.addOpacity(n,.3):n:(e=(b.line||{}).color)&&p.opacity(e)&&g.hasLines(b)&&b.line.width?e:b.fillcolor}},{"../../components/color":367,"./subtypes":961}],947:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/fx"),b=v("../../registry"),y=v("./get_trace_color"),e=v("../../components/color"),n=p.fillText;J.exports=function(t,a,r,m){var o=t.cd,i=o[0].trace,u=t.xa,f=t.ya,l=u.c2p(a),h=f.c2p(r),d=[l,h],s=i.hoveron||"",x=i.mode.indexOf("markers")!==-1?3:.5,c=!!i.xperiodalignment,T=!!i.yperiodalignment;if(s.indexOf("points")!==-1){var _=function(oe){var de=Math.max(x,oe.mrc||0),se=u.c2p(oe.x)-l,me=f.c2p(oe.y)-h;return Math.max(Math.sqrt(se*se+me*me)-de,1-x/de)},w=g.getDistanceFunction(m,function(oe){if(c){var de=u.c2p(oe.xStart),se=u.c2p(oe.xEnd);return l>=Math.min(de,se)&&l<=Math.max(de,se)?0:1/0}var me=Math.max(3,oe.mrc||0),Te=1-1/me,_e=Math.abs(u.c2p(oe.x)-l);return _e<me?Te*_e/me:_e-me+Te},function(oe){if(T){var de=f.c2p(oe.yStart),se=f.c2p(oe.yEnd);return h>=Math.min(de,se)&&h<=Math.max(de,se)?0:1/0}var me=Math.max(3,oe.mrc||0),Te=1-1/me,_e=Math.abs(f.c2p(oe.y)-h);return _e<me?Te*_e/me:_e-me+Te},_);if(g.getClosest(o,w,t),t.index!==!1){var k=o[t.index],L=u.c2p(k.x,!0),A=f.c2p(k.y,!0),I=k.mrc||1;t.index=k.i;var P=o[0].t.orientation,S=P&&(k.sNorm||k.s),E=P==="h"?S:k.orig_x!==void 0?k.orig_x:k.x,D=P==="v"?S:k.orig_y!==void 0?k.orig_y:k.y;return p.extendFlat(t,{color:y(i,k),x0:L-I,x1:L+I,xLabelVal:E,y0:A-I,y1:A+I,yLabelVal:D,spikeDistance:_(k),hovertemplate:i.hovertemplate}),n(k,i,t),b.getComponentMethod("errorbars","hoverInfo")(k,i,t),[t]}}if(s.indexOf("fills")!==-1&&i._polygons){var R,H,V,X,$,G,W,te,N,B=i._polygons,U=[],ee=!1,j=1/0,Q=-1/0,K=1/0,re=-1/0;for(R=0;R<B.length;R++)(V=B[R]).contains(d)&&(ee=!ee,U.push(V),K=Math.min(K,V.ymin),re=Math.max(re,V.ymax));if(ee){var ne=((K=Math.max(K,0))+(re=Math.min(re,f._length)))/2;for(R=0;R<U.length;R++)for(X=U[R].pts,H=1;H<X.length;H++)(te=X[H-1][1])>ne!=(N=X[H][1])>=ne&&(G=X[H-1][0],W=X[H][0],N-te&&($=G+(W-G)*(ne-te)/(N-te),j=Math.min(j,$),Q=Math.max(Q,$)));j=Math.max(j,0),Q=Math.min(Q,u._length);var le=e.defaultLine;return e.opacity(i.fillcolor)?le=i.fillcolor:e.opacity((i.line||{}).color)&&(le=i.line.color),p.extendFlat(t,{distance:t.maxHoverDistance,x0:j,x1:Q,y0:ne,y1:ne,color:le,hovertemplate:!1}),delete t.index,i.text&&!Array.isArray(i.text)?t.text=String(i.text):t.text=i.name,[t]}}}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../registry":647,"./get_trace_color":946}],948:[function(v,J,Z){var p=v("./subtypes");J.exports={hasLines:p.hasLines,hasMarkers:p.hasMarkers,hasText:p.hasText,isBubble:p.isBubble,attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("./cross_trace_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./cross_trace_calc"),arraysToCalcdata:v("./arrays_to_calcdata"),plot:v("./plot"),colorbar:v("./marker_colorbar"),formatLabels:v("./format_labels"),style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./arrays_to_calcdata":935,"./attributes":936,"./calc":937,"./cross_trace_calc":941,"./cross_trace_defaults":942,"./defaults":943,"./format_labels":945,"./hover":947,"./marker_colorbar":954,"./plot":957,"./select":958,"./style":960,"./subtypes":961}],949:[function(v,J,Z){var p=v("../../lib").isArrayOrTypedArray,g=v("../../components/colorscale/helpers").hasColorscale,b=v("../../components/colorscale/defaults");J.exports=function(y,e,n,t,a,r){var m=(y.marker||{}).color;a("line.color",n),g(y,"line")?b(y,e,t,a,{prefix:"line.",cLetter:"c"}):a("line.color",!p(m)&&m||n),a("line.width"),(r||{}).noDash||a("line.dash")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],950:[function(v,J,Z){var p=v("../../constants/numerical"),g=p.BADNUM,b=p.LOG_CLIP,y=b+.5,e=b-.5,n=v("../../lib"),t=n.segmentsIntersect,a=n.constrain,r=v("./constants");J.exports=function(m,o){var i,u,f,l,h,d,s,x,c,T,_,w,k,L,A,I,P,S,E=o.xaxis,D=o.yaxis,R=E.type==="log",H=D.type==="log",V=E._length,X=D._length,$=o.connectGaps,G=o.baseTolerance,W=o.shape,te=W==="linear",N=o.fill&&o.fill!=="none",B=[],U=r.minTolerance,ee=m.length,j=new Array(ee),Q=0;function K(Fe){var $e=m[Fe];if(!$e)return!1;var ot=o.linearized?E.l2p($e.x):E.c2p($e.x),pt=o.linearized?D.l2p($e.y):D.c2p($e.y);if(ot===g){if(R&&(ot=E.c2p($e.x,!0)),ot===g)return!1;H&&pt===g&&(ot*=Math.abs(E._m*X*(E._m>0?y:e)/(D._m*V*(D._m>0?y:e)))),ot*=1e3}if(pt===g){if(H&&(pt=D.c2p($e.y,!0)),pt===g)return!1;pt*=1e3}return[ot,pt]}function re(Fe,$e,ot,pt){var _t=ot-Fe,yt=pt-$e,tt=.5-Fe,Ke=.5-$e,vt=_t*_t+yt*yt,Nt=_t*tt+yt*Ke;if(Nt>0&&Nt<vt){var qt=tt*yt-Ke*_t;if(qt*qt<vt)return!0}}function ne(Fe,$e){var ot=Fe[0]/V,pt=Fe[1]/X,_t=Math.max(0,-ot,ot-1,-pt,pt-1);return _t&&P!==void 0&&re(ot,pt,P,S)&&(_t=0),_t&&$e&&re(ot,pt,$e[0]/V,$e[1]/X)&&(_t=0),(1+r.toleranceGrowth*_t)*G}function le(Fe,$e){var ot=Fe[0]-$e[0],pt=Fe[1]-$e[1];return Math.sqrt(ot*ot+pt*pt)}var oe,de,se,me,Te,_e,be,Ce=r.maxScreensAway,fe=-V*Ce,ve=V*(1+Ce),Me=-X*Ce,ke=X*(1+Ce),Le=[[fe,Me,ve,Me],[ve,Me,ve,ke],[ve,ke,fe,ke],[fe,ke,fe,Me]];function ze(Fe){if(Fe[0]<fe||Fe[0]>ve||Fe[1]<Me||Fe[1]>ke)return[a(Fe[0],fe,ve),a(Fe[1],Me,ke)]}function Re(Fe,$e){return Fe[0]===$e[0]&&(Fe[0]===fe||Fe[0]===ve)||Fe[1]===$e[1]&&(Fe[1]===Me||Fe[1]===ke)||void 0}function Oe(Fe,$e,ot){return function(pt,_t){var yt=ze(pt),tt=ze(_t),Ke=[];if(yt&&tt&&Re(yt,tt))return Ke;yt&&Ke.push(yt),tt&&Ke.push(tt);var vt=2*n.constrain((pt[Fe]+_t[Fe])/2,$e,ot)-((yt||pt)[Fe]+(tt||_t)[Fe]);return vt&&((yt&&tt?vt>0==yt[Fe]>tt[Fe]?yt:tt:yt||tt)[Fe]+=vt),Ke}}function Ze(Fe){var $e=Fe[0],ot=Fe[1],pt=$e===j[Q-1][0],_t=ot===j[Q-1][1];if(!pt||!_t)if(Q>1){var yt=$e===j[Q-2][0],tt=ot===j[Q-2][1];pt&&($e===fe||$e===ve)&&yt?tt?Q--:j[Q-1]=Fe:_t&&(ot===Me||ot===ke)&&tt?yt?Q--:j[Q-1]=Fe:j[Q++]=Fe}else j[Q++]=Fe}function Pe(Fe){j[Q-1][0]!==Fe[0]&&j[Q-1][1]!==Fe[1]&&Ze([se,me]),Ze(Fe),Te=null,se=me=0}function Ie(Fe){if(P=Fe[0]/V,S=Fe[1]/X,oe=Fe[0]<fe?fe:Fe[0]>ve?ve:0,de=Fe[1]<Me?Me:Fe[1]>ke?ke:0,oe||de){if(Q)if(Te){var $e=be(Te,Fe);$e.length>1&&(Pe($e[0]),j[Q++]=$e[1])}else _e=be(j[Q-1],Fe)[0],j[Q++]=_e;else j[Q++]=[oe||Fe[0],de||Fe[1]];var ot=j[Q-1];oe&&de&&(ot[0]!==oe||ot[1]!==de)?(Te&&(se!==oe&&me!==de?Ze(se&&me?(pt=Te,yt=(_t=Fe)[0]-pt[0],tt=(_t[1]-pt[1])/yt,(pt[1]*_t[0]-_t[1]*pt[0])/yt>0?[tt>0?fe:ve,ke]:[tt>0?ve:fe,Me]):[se||oe,me||de]):se&&me&&Ze([se,me])),Ze([oe,de])):se-oe&&me-de&&Ze([oe||se,de||me]),Te=Fe,se=oe,me=de}else Te&&Pe(be(Te,Fe)[0]),j[Q++]=Fe;var pt,_t,yt,tt}for(W==="linear"||W==="spline"?be=function(Fe,$e){for(var ot=[],pt=0,_t=0;_t<4;_t++){var yt=Le[_t],tt=t(Fe[0],Fe[1],$e[0],$e[1],yt[0],yt[1],yt[2],yt[3]);tt&&(!pt||Math.abs(tt.x-ot[0][0])>1||Math.abs(tt.y-ot[0][1])>1)&&(tt=[tt.x,tt.y],pt&&le(tt,Fe)<le(ot[0],Fe)?ot.unshift(tt):ot.push(tt),pt++)}return ot}:W==="hv"||W==="vh"?be=function(Fe,$e){var ot=[],pt=ze(Fe),_t=ze($e);return pt&&_t&&Re(pt,_t)||(pt&&ot.push(pt),_t&&ot.push(_t)),ot}:W==="hvh"?be=Oe(0,fe,ve):W==="vhv"&&(be=Oe(1,Me,ke)),i=0;i<ee;i++)if(u=K(i)){for(Q=0,Te=null,Ie(u),i++;i<ee;i++){if(!(l=K(i))){if($)continue;break}if(te&&o.simplify){var Be=K(i+1);if(T=le(l,u),N&&(Q===0||Q===ee-1)||!(T<ne(l,Be)*U)){for(x=[(l[0]-u[0])/T,(l[1]-u[1])/T],h=u,_=T,w=L=A=0,s=!1,f=l,i++;i<m.length;i++){if(d=Be,Be=K(i+1),!d){if($)continue;break}if(I=(c=[d[0]-u[0],d[1]-u[1]])[0]*x[1]-c[1]*x[0],L=Math.min(L,I),(A=Math.max(A,I))-L>ne(d,Be))break;f=d,(k=c[0]*x[0]+c[1]*x[1])>_?(_=k,l=d,s=!1):k<w&&(w=k,h=d,s=!0)}if(s?(Ie(l),f!==h&&Ie(h)):(h!==u&&Ie(h),f!==l&&Ie(l)),Ie(f),i>=m.length||!d)break;Ie(d),u=d}}else Ie(l)}Te&&Ze([se||Te[0],me||Te[1]]),B.push(j.slice(0,Q))}return B}},{"../../constants/numerical":491,"../../lib":515,"./constants":940}],951:[function(v,J,Z){J.exports=function(p,g,b){b("line.shape")==="spline"&&b("line.smoothing")}},{}],952:[function(v,J,Z){var p={tonextx:1,tonexty:1,tonext:1};J.exports=function(g,b,y){var e,n,t,a,r,m={},o=!1,i=-1,u=0,f=-1;for(n=0;n<y.length;n++)(t=(e=y[n][0].trace).stackgroup||"")?t in m?r=m[t]:(r=m[t]=u,u++):e.fill in p&&f>=0?r=f:(r=f=u,u++),r<i&&(o=!0),e._groupIndex=i=r;var l=y.slice();o&&l.sort(function(d,s){var x=d[0].trace,c=s[0].trace;return x._groupIndex-c._groupIndex||x.index-c.index});var h={};for(n=0;n<l.length;n++)t=(e=l[n][0].trace).stackgroup||"",e.visible===!0?(e._nexttrace=null,e.fill in p&&(a=h[t],e._prevtrace=a||null,a&&(a._nexttrace=e)),e._ownfill=e.fill&&(e.fill.substr(0,6)==="tozero"||e.fill==="toself"||e.fill.substr(0,2)==="to"&&!e._prevtrace),h[t]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return l}},{}],953:[function(v,J,Z){var p=v("fast-isnumeric");J.exports=function(g,b){b||(b=2);var y=g.marker,e=y.sizeref||1,n=y.sizemin||0,t=y.sizemode==="area"?function(a){return Math.sqrt(a/e)}:function(a){return a/e};return function(a){var r=t(a/b);return p(r)&&r>0?Math.max(r,n):0}}},{"fast-isnumeric":190}],954:[function(v,J,Z){J.exports={container:"marker",min:"cmin",max:"cmax"}},{}],955:[function(v,J,Z){var p=v("../../components/color"),g=v("../../components/colorscale/helpers").hasColorscale,b=v("../../components/colorscale/defaults"),y=v("./subtypes");J.exports=function(e,n,t,a,r,m){var o=y.isBubble(e),i=(e.line||{}).color;m=m||{},i&&(t=i),r("marker.symbol"),r("marker.opacity",o?.7:1),r("marker.size"),r("marker.color",t),g(e,"marker")&&b(e,n,a,r,{prefix:"marker.",cLetter:"c"}),m.noSelect||(r("selected.marker.color"),r("unselected.marker.color"),r("selected.marker.size"),r("unselected.marker.size")),m.noLine||(r("marker.line.color",i&&!Array.isArray(i)&&n.marker.color!==i?i:o?p.background:p.defaultLine),g(e,"marker.line")&&b(e,n,a,r,{prefix:"marker.line.",cLetter:"c"}),r("marker.line.width",o?1:0)),o&&(r("marker.sizeref"),r("marker.sizemin"),r("marker.sizemode")),m.gradient&&r("marker.gradient.type")!=="none"&&r("marker.gradient.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"./subtypes":961}],956:[function(v,J,Z){var p=v("../../lib").dateTick0,g=v("../../constants/numerical").ONEWEEK;function b(y,e){return p(e,y%g==0?1:0)}J.exports=function(y,e,n,t,a){if(a||(a={x:!0,y:!0}),a.x){var r=t("xperiod");r&&(t("xperiod0",b(r,e.xcalendar)),t("xperiodalignment"))}if(a.y){var m=t("yperiod");m&&(t("yperiod0",b(m,e.ycalendar)),t("yperiodalignment"))}}},{"../../constants/numerical":491,"../../lib":515}],957:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../registry"),b=v("../../lib"),y=b.ensureSingle,e=b.identity,n=v("../../components/drawing"),t=v("./subtypes"),a=v("./line_points"),r=v("./link_traces"),m=v("../../lib/polygon").tester;function o(i,u,f,l,h,d,s){var x;(function(ve,Me,ke,Le,ze){var Re=ke.xaxis,Oe=ke.yaxis,Ze=p.extent(b.simpleMap(Re.range,Re.r2c)),Pe=p.extent(b.simpleMap(Oe.range,Oe.r2c)),Ie=Le[0].trace;if(!!t.hasMarkers(Ie)){var Be=Ie.marker.maxdisplayed;if(Be!==0){var Fe=Le.filter(function(_t){return _t.x>=Ze[0]&&_t.x<=Ze[1]&&_t.y>=Pe[0]&&_t.y<=Pe[1]}),$e=Math.ceil(Fe.length/Be),ot=0;ze.forEach(function(_t,yt){var tt=_t[0].trace;t.hasMarkers(tt)&&tt.marker.maxdisplayed>0&&yt<Me&&ot++});var pt=Math.round(ot*$e/3+Math.floor(ot/3)*$e/7.1);Le.forEach(function(_t){delete _t.vis}),Fe.forEach(function(_t,yt){Math.round((yt+pt)%$e)===0&&(_t.vis=!0)})}}})(0,u,f,l,h);var c=!!s&&s.duration>0;function T(ve){return c?ve.transition():ve}var _=f.xaxis,w=f.yaxis,k=l[0].trace,L=k.line,A=p.select(d),I=y(A,"g","errorbars"),P=y(A,"g","lines"),S=y(A,"g","points"),E=y(A,"g","text");if(g.getComponentMethod("errorbars","plot")(i,I,f,s),k.visible===!0){var D,R;T(A).style("opacity",k.opacity);var H=k.fill.charAt(k.fill.length-1);H!=="x"&&H!=="y"&&(H=""),l[0][f.isRangePlot?"nodeRangePlot3":"node3"]=A;var V,X,$="",G=[],W=k._prevtrace;W&&($=W._prevRevpath||"",R=W._nextFill,G=W._polygons);var te,N,B,U,ee,j,Q,K="",re="",ne=[],le=b.noop;if(D=k._ownFill,t.hasLines(k)||k.fill!=="none"){for(R&&R.datum(l),["hv","vh","hvh","vhv"].indexOf(L.shape)!==-1?(te=n.steps(L.shape),N=n.steps(L.shape.split("").reverse().join(""))):te=N=L.shape==="spline"?function(ve){var Me=ve[ve.length-1];return ve.length>1&&ve[0][0]===Me[0]&&ve[0][1]===Me[1]?n.smoothclosed(ve.slice(1),L.smoothing):n.smoothopen(ve,L.smoothing)}:function(ve){return"M"+ve.join("L")},B=function(ve){return N(ve.reverse())},ne=a(l,{xaxis:_,yaxis:w,connectGaps:k.connectgaps,baseTolerance:Math.max(L.width||1,3)/4,shape:L.shape,simplify:L.simplify,fill:k.fill}),Q=k._polygons=new Array(ne.length),x=0;x<ne.length;x++)k._polygons[x]=m(ne[x]);ne.length&&(U=ne[0][0],j=(ee=ne[ne.length-1])[ee.length-1]),le=function(ve){return function(Me){if(V=te(Me),X=B(Me),K?H?(K+="L"+V.substr(1),re=X+"L"+re.substr(1)):(K+="Z"+V,re=X+"Z"+re):(K=V,re=X),t.hasLines(k)&&Me.length>1){var ke=p.select(this);if(ke.datum(l),ve)T(ke.style("opacity",0).attr("d",V).call(n.lineGroupStyle)).style("opacity",1);else{var Le=T(ke);Le.attr("d",V),n.singleLineStyle(l,Le)}}}}}var oe=P.selectAll(".js-line").data(ne);T(oe.exit()).style("opacity",0).remove(),oe.each(le(!1)),oe.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(n.lineGroupStyle).each(le(!0)),n.setClipUrl(oe,f.layerClipId,i),ne.length?(D?(D.datum(l),U&&j&&(H?(H==="y"?U[1]=j[1]=w.c2p(0,!0):H==="x"&&(U[0]=j[0]=_.c2p(0,!0)),T(D).attr("d","M"+j+"L"+U+"L"+K.substr(1)).call(n.singleFillStyle,i)):T(D).attr("d",K+"Z").call(n.singleFillStyle,i))):R&&(k.fill.substr(0,6)==="tonext"&&K&&$?(k.fill==="tonext"?T(R).attr("d",K+"Z"+$+"Z").call(n.singleFillStyle,i):T(R).attr("d",K+"L"+$.substr(1)+"Z").call(n.singleFillStyle,i),k._polygons=k._polygons.concat(G)):(se(R),k._polygons=null)),k._prevRevpath=re,k._prevPolygons=Q):(D?se(D):R&&se(R),k._polygons=k._prevRevpath=k._prevPolygons=null),S.datum(l),E.datum(l),function(ve,Me,ke){var Le,ze=ke[0].trace,Re=t.hasMarkers(ze),Oe=t.hasText(ze),Ze=Ce(ze),Pe=fe,Ie=fe;if(Re||Oe){var Be=e,Fe=ze.stackgroup,$e=Fe&&i._fullLayout._scatterStackOpts[_._id+w._id][Fe].stackgaps==="infer zero";ze.marker.maxdisplayed||ze._needsCull?Be=$e?Te:me:Fe&&!$e&&(Be=_e),Re&&(Pe=Be),Oe&&(Ie=Be)}var ot,pt=(Le=ve.selectAll("path.point").data(Pe,Ze)).enter().append("path").classed("point",!0);c&&pt.call(n.pointStyle,ze,i).call(n.translatePoints,_,w).style("opacity",0).transition().style("opacity",1),Le.order(),Re&&(ot=n.makePointStyleFns(ze)),Le.each(function(_t){var yt=p.select(this),tt=T(yt);n.translatePoint(_t,tt,_,w)?(n.singlePointStyle(_t,tt,ze,ot,i),f.layerClipId&&n.hideOutsideRangePoint(_t,tt,_,w,ze.xcalendar,ze.ycalendar),ze.customdata&&yt.classed("plotly-customdata",_t.data!==null&&_t.data!==void 0)):tt.remove()}),c?Le.exit().transition().style("opacity",0).remove():Le.exit().remove(),(Le=Me.selectAll("g").data(Ie,Ze)).enter().append("g").classed("textpoint",!0).append("text"),Le.order(),Le.each(function(_t){var yt=p.select(this),tt=T(yt.select("text"));n.translatePoint(_t,tt,_,w)?f.layerClipId&&n.hideOutsideRangePoint(_t,yt,_,w,ze.xcalendar,ze.ycalendar):yt.remove()}),Le.selectAll("text").call(n.textPointStyle,ze,i).each(function(_t){var yt=_.c2p(_t.x),tt=w.c2p(_t.y);p.select(this).selectAll("tspan.line").each(function(){T(p.select(this)).attr({x:yt,y:tt})})}),Le.exit().remove()}(S,E,l);var de=k.cliponaxis===!1?null:f.layerClipId;n.setClipUrl(S,de,i),n.setClipUrl(E,de,i)}function se(ve){T(ve).attr("d","M0,0Z")}function me(ve){return ve.filter(function(Me){return!Me.gap&&Me.vis})}function Te(ve){return ve.filter(function(Me){return Me.vis})}function _e(ve){return ve.filter(function(Me){return!Me.gap})}function be(ve){return ve.id}function Ce(ve){if(ve.ids)return be}function fe(){return!1}}J.exports=function(i,u,f,l,h,d){var s,x,c=!h,T=!!h&&h.duration>0,_=r(i,u,f);(s=l.selectAll("g.trace").data(_,function(w){return w[0].trace.uid})).enter().append("g").attr("class",function(w){return"trace scatter trace"+w[0].trace.uid}).style("stroke-miterlimit",2),s.order(),function(w,k,L){k.each(function(A){var I=y(p.select(this),"g","fills");n.setClipUrl(I,L.layerClipId,w);var P=A[0].trace,S=[];P._ownfill&&S.push("_ownFill"),P._nexttrace&&S.push("_nextFill");var E=I.selectAll("g").data(S,e);E.enter().append("g"),E.exit().each(function(D){P[D]=null}).remove(),E.order().each(function(D){P[D]=y(p.select(this),"path","js-fill")})})}(i,s,u),T?(d&&(x=d()),p.transition().duration(h.duration).ease(h.easing).each("end",function(){x&&x()}).each("interrupt",function(){x&&x()}).each(function(){l.selectAll("g.trace").each(function(w,k){o(i,k,u,w,_,this,h)})})):s.each(function(w,k){o(i,k,u,w,_,this,h)}),c&&s.exit().remove(),l.selectAll("path:not([d])").remove()}},{"../../components/drawing":389,"../../lib":515,"../../lib/polygon":527,"../../registry":647,"./line_points":950,"./link_traces":952,"./subtypes":961,"@plotly/d3":58}],958:[function(v,J,Z){var p=v("./subtypes");J.exports=function(g,b){var y,e,n,t,a=g.cd,r=g.xaxis,m=g.yaxis,o=[],i=a[0].trace;if(!p.hasMarkers(i)&&!p.hasText(i))return[];if(b===!1)for(y=0;y<a.length;y++)a[y].selected=0;else for(y=0;y<a.length;y++)e=a[y],n=r.c2p(e.x),t=m.c2p(e.y),e.i!==null&&b.contains([n,t],!1,y,g)?(o.push({pointNumber:e.i,x:r.c2d(e.x),y:m.c2d(e.y)}),e.selected=1):e.selected=0;return o}},{"./subtypes":961}],959:[function(v,J,Z){var p=["orientation","groupnorm","stackgaps"];J.exports=function(g,b,y,e){var n=y._scatterStackOpts,t=e("stackgroup");if(t){var a=b.xaxis+b.yaxis,r=n[a];r||(r=n[a]={});var m=r[t],o=!1;m?m.traces.push(b):(m=r[t]={traceIndices:[],traces:[b]},o=!0);for(var i={orientation:b.x&&!b.y?"h":"v"},u=0;u<p.length;u++){var f=p[u],l=f+"Found";if(!m[l]){var h=g[f]!==void 0,d=f==="orientation";if((h||o)&&(m[f]=e(f,i[f]),d&&(m.fillDflt=m[f]==="h"?"tonextx":"tonexty"),h&&(m[l]=!0,!o&&(delete m.traces[0][f],d))))for(var s=0;s<m.traces.length-1;s++){var x=m.traces[s];x._input.fill!==x.fill&&(x.fill=m.fillDflt)}}}return m}}},{}],960:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/drawing"),b=v("../../registry");function y(n,t,a){g.pointStyle(n.selectAll("path.point"),t,a)}function e(n,t,a){g.textPointStyle(n.selectAll("text"),t,a)}J.exports={style:function(n){var t=p.select(n).selectAll("g.trace.scatter");t.style("opacity",function(a){return a[0].trace.opacity}),t.selectAll("g.points").each(function(a){y(p.select(this),a.trace||a[0].trace,n)}),t.selectAll("g.text").each(function(a){e(p.select(this),a.trace||a[0].trace,n)}),t.selectAll("g.trace path.js-line").call(g.lineGroupStyle),t.selectAll("g.trace path.js-fill").call(g.fillGroupStyle,n),b.getComponentMethod("errorbars","style")(t)},stylePoints:y,styleText:e,styleOnSelect:function(n,t,a){var r=t[0].trace;r.selectedpoints?(g.selectedPointStyle(a.selectAll("path.point"),r),g.selectedTextStyle(a.selectAll("text"),r)):(y(a,r,n),e(a,r,n))}}},{"../../components/drawing":389,"../../registry":647,"@plotly/d3":58}],961:[function(v,J,Z){var p=v("../../lib");J.exports={hasLines:function(g){return g.visible&&g.mode&&g.mode.indexOf("lines")!==-1},hasMarkers:function(g){return g.visible&&(g.mode&&g.mode.indexOf("markers")!==-1||g.type==="splom")},hasText:function(g){return g.visible&&g.mode&&g.mode.indexOf("text")!==-1},isBubble:function(g){return p.isPlainObject(g.marker)&&p.isArrayOrTypedArray(g.marker.size)}}},{"../../lib":515}],962:[function(v,J,Z){var p=v("../../lib");J.exports=function(g,b,y,e,n){n=n||{},e("textposition"),p.coerceFont(e,"textfont",y.font),n.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":515}],963:[function(v,J,Z){var p=v("../../lib"),g=v("../../registry");J.exports=function(b,y,e,n){var t,a=n("x"),r=n("y");if(g.getComponentMethod("calendars","handleTraceDefaults")(b,y,["x","y"],e),a){var m=p.minRowLength(a);r?t=Math.min(m,p.minRowLength(r)):(t=m,n("y0"),n("dy"))}else{if(!r)return 0;t=p.minRowLength(r),n("x0"),n("dx")}return y._length=t,t}},{"../../lib":515,"../../registry":647}],964:[function(v,J,Z){var p=v("../scatter/attributes"),g=v("../../components/colorscale/attributes"),b=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../../plots/template_attributes").texttemplateAttrs,n=v("../../plots/attributes"),t=v("../../constants/gl3d_dashes"),a=v("../../constants/gl3d_markers"),r=v("../../lib/extend").extendFlat,m=v("../../plot_api/edit_types").overrideAll,o=v("../../lib/sort_object_keys"),i=p.line,u=p.marker,f=u.line,l=r({width:i.width,dash:{valType:"enumerated",values:o(t),dflt:"solid"}},g("line")),h=J.exports=m({x:p.x,y:p.y,z:{valType:"data_array"},text:r({},p.text,{}),texttemplate:e({},{}),hovertext:r({},p.hovertext,{}),hovertemplate:y(),xhoverformat:b("x"),yhoverformat:b("y"),zhoverformat:b("z"),mode:r({},p.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:p.connectgaps,line:l,marker:r({symbol:{valType:"enumerated",values:o(a),dflt:"circle",arrayOk:!0},size:r({},u.size,{dflt:8}),sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,opacity:r({},u.opacity,{arrayOk:!1}),colorbar:u.colorbar,line:r({width:r({},f.width,{arrayOk:!1})},g("marker.line"))},g("marker")),textposition:r({},p.textposition,{dflt:"top center"}),textfont:{color:p.textfont.color,size:p.textfont.size,family:r({},p.textfont.family,{arrayOk:!1})},opacity:n.opacity,hoverinfo:r({},n.hoverinfo)},"calc","nested");h.x.editType=h.y.editType=h.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":374,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../scatter/attributes":936}],965:[function(v,J,Z){var p=v("../scatter/arrays_to_calcdata"),g=v("../scatter/colorscale_calc");J.exports=function(b,y){var e=[{x:!1,y:!1,trace:y,t:{}}];return p(e,y),g(b,y),e}},{"../scatter/arrays_to_calcdata":935,"../scatter/colorscale_calc":939}],966:[function(v,J,Z){var p=v("../../registry");function g(b,y,e,n){if(!y||!y.visible)return null;for(var t=p.getComponentMethod("errorbars","makeComputeError")(y),a=new Array(b.length),r=0;r<b.length;r++){var m=t(+b[r],r);if(n.type==="log"){var o=n.c2l(b[r]),i=b[r]-m[0],u=b[r]+m[1];if(a[r]=[(n.c2l(i,!0)-o)*e,(n.c2l(u,!0)-o)*e],i>0){var f=n.c2l(i);n._lowerLogErrorBound||(n._lowerLogErrorBound=f),n._lowerErrorBound=Math.min(n._lowerLogErrorBound,f)}}else a[r]=[-m[0]*e,m[1]*e]}return a}J.exports=function(b,y,e){var n=[g(b.x,b.error_x,y[0],e.xaxis),g(b.y,b.error_y,y[1],e.yaxis),g(b.z,b.error_z,y[2],e.zaxis)],t=function(u){for(var f=0;f<u.length;f++)if(u[f])return u[f].length;return 0}(n);if(t===0)return null;for(var a=new Array(t),r=0;r<t;r++){for(var m=[[0,0,0],[0,0,0]],o=0;o<3;o++)if(n[o])for(var i=0;i<2;i++)m[i][o]=n[o][r][i];a[r]=m}return a}},{"../../registry":647}],967:[function(v,J,Z){var p=v("../../../stackgl_modules").gl_line3d,g=v("../../../stackgl_modules").gl_scatter3d,b=v("../../../stackgl_modules").gl_error3d,y=v("../../../stackgl_modules").gl_mesh3d,e=v("../../../stackgl_modules").delaunay_triangulate,n=v("../../lib"),t=v("../../lib/str2rgbarray"),a=v("../../lib/gl_format_color").formatColor,r=v("../scatter/make_bubble_size_func"),m=v("../../constants/gl3d_dashes"),o=v("../../constants/gl3d_markers"),i=v("../../plots/cartesian/axes"),u=v("../../components/fx/helpers").appendArrayPointValue,f=v("./calc_errors");function l(L,A){this.scene=L,this.uid=A,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var h=l.prototype;function d(L){return L==null?0:L.indexOf("left")>-1?-1:L.indexOf("right")>-1?1:0}function s(L){return L==null?0:L.indexOf("top")>-1?-1:L.indexOf("bottom")>-1?1:0}function x(L,A){return A(4*L)}function c(L){return o[L]}function T(L,A,I,P,S){var E=null;if(n.isArrayOrTypedArray(L)){E=[];for(var D=0;D<A;D++)L[D]===void 0?E[D]=P:E[D]=I(L[D],S)}else E=I(L,n.identity);return E}function _(L,A){var I,P,S,E,D,R,H=[],V=L.fullSceneLayout,X=L.dataScale,$=V.xaxis,G=V.yaxis,W=V.zaxis,te=A.marker,N=A.line,B=A.x||[],U=A.y||[],ee=A.z||[],j=B.length,Q=A.xcalendar,K=A.ycalendar,re=A.zcalendar;for(D=0;D<j;D++)I=$.d2l(B[D],0,Q)*X[0],P=G.d2l(U[D],0,K)*X[1],S=W.d2l(ee[D],0,re)*X[2],H[D]=[I,P,S];if(Array.isArray(A.text))R=A.text;else if(A.text!==void 0)for(R=new Array(j),D=0;D<j;D++)R[D]=A.text;function ne(Le,ze){var Re=V[Le];return i.tickText(Re,Re.d2l(ze),!0).text}var le=A.texttemplate;if(le){var oe=L.fullLayout._d3locale,de=Array.isArray(le),se=de?Math.min(le.length,j):j,me=de?function(Le){return le[Le]}:function(){return le};for(R=new Array(se),D=0;D<se;D++){var Te={x:B[D],y:U[D],z:ee[D]},_e={xLabel:ne("xaxis",B[D]),yLabel:ne("yaxis",U[D]),zLabel:ne("zaxis",ee[D])},be={};u(be,A,D);var Ce=A._meta||{};R[D]=n.texttemplateString(me(D),_e,oe,be,Te,Ce)}}if(E={position:H,mode:A.mode,text:R},"line"in A&&(E.lineColor=a(N,1,j),E.lineWidth=N.width,E.lineDashes=N.dash),"marker"in A){var fe=r(A);E.scatterColor=a(te,1,j),E.scatterSize=T(te.size,j,x,20,fe),E.scatterMarker=T(te.symbol,j,c,"\u25CF"),E.scatterLineWidth=te.line.width,E.scatterLineColor=a(te.line,1,j),E.scatterAngle=0}"textposition"in A&&(E.textOffset=function(Le){var ze=[0,0];if(Array.isArray(Le))for(var Re=0;Re<Le.length;Re++)ze[Re]=[0,0],Le[Re]&&(ze[Re][0]=d(Le[Re]),ze[Re][1]=s(Le[Re]));else ze[0]=d(Le),ze[1]=s(Le);return ze}(A.textposition),E.textColor=a(A.textfont,1,j),E.textSize=T(A.textfont.size,j,n.identity,12),E.textFont=A.textfont.family,E.textAngle=0);var ve=["x","y","z"];for(E.project=[!1,!1,!1],E.projectScale=[1,1,1],E.projectOpacity=[1,1,1],D=0;D<3;++D){var Me=A.projection[ve[D]];(E.project[D]=Me.show)&&(E.projectOpacity[D]=Me.opacity,E.projectScale[D]=Me.scale)}E.errorBounds=f(A,X,V);var ke=function(Le){for(var ze=[0,0,0],Re=[[0,0,0],[0,0,0],[0,0,0]],Oe=[1,1,1],Ze=0;Ze<3;Ze++){var Pe=Le[Ze];Pe&&Pe.copy_zstyle!==!1&&Le[2].visible!==!1&&(Pe=Le[2]),Pe&&Pe.visible&&(ze[Ze]=Pe.width/2,Re[Ze]=t(Pe.color),Oe[Ze]=Pe.thickness)}return{capSize:ze,color:Re,lineWidth:Oe}}([A.error_x,A.error_y,A.error_z]);return E.errorColor=ke.color,E.errorLineWidth=ke.lineWidth,E.errorCapSize=ke.capSize,E.delaunayAxis=A.surfaceaxis,E.delaunayColor=t(A.surfacecolor),E}function w(L){if(n.isArrayOrTypedArray(L)){var A=L[0];return n.isArrayOrTypedArray(A)&&(L=A),"rgb("+L.slice(0,3).map(function(I){return Math.round(255*I)})+")"}return null}function k(L){return n.isArrayOrTypedArray(L)?L.length===4&&typeof L[0]=="number"?w(L):L.map(w):null}h.handlePick=function(L){if(L.object&&(L.object===this.linePlot||L.object===this.delaunayMesh||L.object===this.textMarkers||L.object===this.scatterPlot)){var A=L.index=L.data.index;return L.object.highlight&&L.object.highlight(null),this.scatterPlot&&(L.object=this.scatterPlot,this.scatterPlot.highlight(L.data)),L.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[A]||this.textLabels[A]===0)&&(L.textLabel=this.textLabels[A]):L.textLabel=this.textLabels),L.traceCoordinate=[this.data.x[A],this.data.y[A],this.data.z[A]],!0}},h.update=function(L){var A,I,P,S,E=this.scene.glplot.gl,D=m.solid;this.data=L;var R=_(this.scene,L);"mode"in R&&(this.mode=R.mode),"lineDashes"in R&&R.lineDashes in m&&(D=m[R.lineDashes]),this.color=k(R.scatterColor)||k(R.lineColor),this.dataPoints=R.position,A={gl:this.scene.glplot.gl,position:R.position,color:R.lineColor,lineWidth:R.lineWidth||1,dashes:D[0],dashScale:D[1],opacity:L.opacity,connectGaps:L.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(A):(this.linePlot=p(A),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var H=L.opacity;if(L.marker&&L.marker.opacity&&(H*=L.marker.opacity),I={gl:this.scene.glplot.gl,position:R.position,color:R.scatterColor,size:R.scatterSize,glyph:R.scatterMarker,opacity:H,orthographic:!0,lineWidth:R.scatterLineWidth,lineColor:R.scatterLineColor,project:R.project,projectScale:R.projectScale,projectOpacity:R.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(I):(this.scatterPlot=g(I),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),S={gl:this.scene.glplot.gl,position:R.position,glyph:R.text,color:R.textColor,size:R.textSize,angle:R.textAngle,alignment:R.textOffset,font:R.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:L.opacity},this.textLabels=L.hovertext||L.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(S):(this.textMarkers=g(S),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),P={gl:this.scene.glplot.gl,position:R.position,color:R.errorColor,error:R.errorBounds,lineWidth:R.errorLineWidth,capSize:R.errorCapSize,opacity:L.opacity},this.errorBars?R.errorBounds?this.errorBars.update(P):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):R.errorBounds&&(this.errorBars=b(P),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),R.delaunayAxis>=0){var V=function(X,$,G){var W,te=(G+1)%3,N=(G+2)%3,B=[],U=[];for(W=0;W<X.length;++W){var ee=X[W];!isNaN(ee[te])&&isFinite(ee[te])&&!isNaN(ee[N])&&isFinite(ee[N])&&(B.push([ee[te],ee[N]]),U.push(W))}var j=e(B);for(W=0;W<j.length;++W)for(var Q=j[W],K=0;K<Q.length;++K)Q[K]=U[Q[K]];return{positions:X,cells:j,meshColor:$}}(R.position,R.delaunayColor,R.delaunayAxis);V.opacity=L.opacity,this.delaunayMesh?this.delaunayMesh.update(V):(V.gl=E,this.delaunayMesh=y(V),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},h.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},J.exports=function(L,A){var I=new l(L,A.uid);return I.update(A),I}},{"../../../stackgl_modules":1133,"../../components/fx/helpers":403,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../scatter/make_bubble_size_func":953,"./calc_errors":966}],968:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib"),b=v("../scatter/subtypes"),y=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),n=v("../scatter/text_defaults"),t=v("./attributes");J.exports=function(a,r,m,o){function i(x,c){return g.coerce(a,r,t,x,c)}if(function(x,c,T,_){var w=0,k=T("x"),L=T("y"),A=T("z");return p.getComponentMethod("calendars","handleTraceDefaults")(x,c,["x","y","z"],_),k&&L&&A&&(w=Math.min(k.length,L.length,A.length),c._length=c._xlength=c._ylength=c._zlength=w),w}(a,r,i,o)){i("text"),i("hovertext"),i("hovertemplate"),i("xhoverformat"),i("yhoverformat"),i("zhoverformat"),i("mode"),b.hasLines(r)&&(i("connectgaps"),e(a,r,m,o,i)),b.hasMarkers(r)&&y(a,r,m,o,i,{noSelect:!0}),b.hasText(r)&&(i("texttemplate"),n(a,r,o,i,{noSelect:!0}));var u=(r.line||{}).color,f=(r.marker||{}).color;i("surfaceaxis")>=0&&i("surfacecolor",u||f);for(var l=["x","y","z"],h=0;h<3;++h){var d="projection."+l[h];i(d+".show")&&(i(d+".opacity"),i(d+".scale"))}var s=p.getComponentMethod("errorbars","supplyDefaults");s(a,r,u||f||m,{axis:"z"}),s(a,r,u||f||m,{axis:"y",inherit:"z"}),s(a,r,u||f||m,{axis:"x",inherit:"z"})}else r.visible=!1}},{"../../lib":515,"../../registry":647,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":964}],969:[function(v,J,Z){J.exports={plot:v("./convert"),attributes:v("./attributes"),markerSymbols:v("../../constants/gl3d_markers"),supplyDefaults:v("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:v("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":489,"../../plots/gl3d":607,"./attributes":964,"./calc":965,"./convert":967,"./defaults":968}],970:[function(v,J,Z){var p=v("../scatter/attributes"),g=v("../../plots/attributes"),b=v("../../plots/template_attributes").hovertemplateAttrs,y=v("../../plots/template_attributes").texttemplateAttrs,e=v("../../components/colorscale/attributes"),n=v("../../lib/extend").extendFlat,t=p.marker,a=p.line,r=t.line;J.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:n({},p.mode,{dflt:"markers"}),text:n({},p.text,{}),texttemplate:y({editType:"plot"},{keys:["a","b","text"]}),hovertext:n({},p.hovertext,{}),line:{color:a.color,width:a.width,dash:a.dash,shape:n({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:p.connectgaps,fill:n({},p.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:p.fillcolor,marker:n({symbol:t.symbol,opacity:t.opacity,maxdisplayed:t.maxdisplayed,size:t.size,sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,line:n({width:r.width,editType:"calc"},e("marker.line")),gradient:t.gradient,editType:"calc"},e("marker")),textfont:p.textfont,textposition:p.textposition,selected:p.selected,unselected:p.unselected,hoverinfo:n({},g.hoverinfo,{flags:["a","b","text","name"]}),hoveron:p.hoveron,hovertemplate:b()}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],971:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../scatter/colorscale_calc"),b=v("../scatter/arrays_to_calcdata"),y=v("../scatter/calc_selection"),e=v("../scatter/calc").calcMarkerSize,n=v("../carpet/lookup_carpetid");J.exports=function(t,a){var r=a._carpetTrace=n(t,a);if(r&&r.visible&&r.visible!=="legendonly"){var m;a.xaxis=r.xaxis,a.yaxis=r.yaxis;var o,i,u=a._length,f=new Array(u),l=!1;for(m=0;m<u;m++)if(o=a.a[m],i=a.b[m],p(o)&&p(i)){var h=r.ab2xy(+o,+i,!0),d=r.isVisible(+o,+i);d||(l=!0),f[m]={x:h[0],y:h[1],a:o,b:i,vis:d}}else f[m]={x:!1,y:!1};return a._needsCull=l,f[0].carpet=r,f[0].trace=a,e(a,u),g(t,a),b(f,a),y(f,a),f}}},{"../carpet/lookup_carpetid":717,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],972:[function(v,J,Z){var p=v("../../lib"),g=v("../scatter/constants"),b=v("../scatter/subtypes"),y=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),n=v("../scatter/line_shape_defaults"),t=v("../scatter/text_defaults"),a=v("../scatter/fillcolor_defaults"),r=v("./attributes");J.exports=function(m,o,i,u){function f(x,c){return p.coerce(m,o,r,x,c)}f("carpet"),o.xaxis="x",o.yaxis="y";var l=f("a"),h=f("b"),d=Math.min(l.length,h.length);if(d){o._length=d,f("text"),f("texttemplate"),f("hovertext"),f("mode",d<g.PTS_LINESONLY?"lines+markers":"lines"),b.hasLines(o)&&(e(m,o,i,u,f),n(m,o,f),f("connectgaps")),b.hasMarkers(o)&&y(m,o,i,u,f,{gradient:!0}),b.hasText(o)&&t(m,o,u,f);var s=[];(b.hasMarkers(o)||b.hasText(o))&&(f("marker.maxdisplayed"),s.push("points")),f("fill"),o.fill!=="none"&&(a(m,o,i,f),b.hasLines(o)||n(m,o,f)),o.fill!=="tonext"&&o.fill!=="toself"||s.push("fills"),f("hoveron",s.join("+")||"points")!=="fills"&&f("hovertemplate"),p.coerceSelectionMarkerOpacity(o,f)}else o.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":970}],973:[function(v,J,Z){J.exports=function(p,g,b,y,e){var n=y[e];return p.a=n.a,p.b=n.b,p.y=n.y,p}},{}],974:[function(v,J,Z){J.exports=function(p,g){var b={},y=g._carpet,e=y.ab2ij([p.a,p.b]),n=Math.floor(e[0]),t=e[0]-n,a=Math.floor(e[1]),r=e[1]-a,m=y.evalxy([],n,a,t,r);return b.yLabel=m[1].toFixed(3),b}},{}],975:[function(v,J,Z){var p=v("../scatter/hover"),g=v("../../lib").fillText;J.exports=function(b,y,e,n){var t=p(b,y,e,n);if(t&&t[0].index!==!1){var a=t[0];if(a.index===void 0){var r=1-a.y0/b.ya._length,m=b.xa._length,o=m*r/2,i=m-o;return a.x0=Math.max(Math.min(a.x0,i),o),a.x1=Math.max(Math.min(a.x1,i),o),t}var u=a.cd[a.index];a.a=u.a,a.b=u.b,a.xLabelVal=void 0,a.yLabelVal=void 0;var f=a.trace,l=f._carpet,h=f._module.formatLabels(u,f);a.yLabel=h.yLabel,delete a.text;var d=[];if(!f.hovertemplate){var s=(u.hi||f.hoverinfo).split("+");s.indexOf("all")!==-1&&(s=["a","b","text"]),s.indexOf("a")!==-1&&x(l.aaxis,u.a),s.indexOf("b")!==-1&&x(l.baxis,u.b),d.push("y: "+a.yLabel),s.indexOf("text")!==-1&&g(u,f,d),a.extraText=d.join("<br>")}return t}function x(c,T){var _;_=c.labelprefix&&c.labelprefix.length>0?c.labelprefix.replace(/ = $/,""):c._hovertitle,d.push(_+": "+T.toFixed(3)+c.labelsuffix)}}},{"../../lib":515,"../scatter/hover":947}],976:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../scatter/select"),eventData:v("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:v("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":970,"./calc":971,"./defaults":972,"./event_data":973,"./format_labels":974,"./hover":975,"./plot":977}],977:[function(v,J,Z){var p=v("../scatter/plot"),g=v("../../plots/cartesian/axes"),b=v("../../components/drawing");J.exports=function(y,e,n,t){var a,r,m,o=n[0][0].carpet,i={xaxis:g.getFromId(y,o.xaxis||"x"),yaxis:g.getFromId(y,o.yaxis||"y"),plot:e.plot};for(p(y,i,n,t),a=0;a<n.length;a++)r=n[a][0].trace,m=t.selectAll("g.trace"+r.uid+" .js-line"),b.setClipUrl(m,n[a][0].carpet._clipPathId,y)}},{"../../components/drawing":389,"../../plots/cartesian/axes":566,"../scatter/plot":957}],978:[function(v,J,Z){var p=v("../../plots/template_attributes").hovertemplateAttrs,g=v("../../plots/template_attributes").texttemplateAttrs,b=v("../scatter/attributes"),y=v("../../plots/attributes"),e=v("../../components/colorscale/attributes"),n=v("../../components/drawing/attributes").dash,t=v("../../lib/extend").extendFlat,a=v("../../plot_api/edit_types").overrideAll,r=b.marker,m=b.line,o=r.line;J.exports=a({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:t({},b.mode,{dflt:"markers"}),text:t({},b.text,{}),texttemplate:g({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:t({},b.hovertext,{}),textfont:b.textfont,textposition:b.textposition,line:{color:m.color,width:m.width,dash:n},connectgaps:b.connectgaps,marker:t({symbol:r.symbol,opacity:r.opacity,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,colorbar:r.colorbar,line:t({width:o.width},e("marker.line")),gradient:r.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:b.fillcolor,selected:b.selected,unselected:b.unselected,hoverinfo:t({},y.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:p()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],979:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../constants/numerical").BADNUM,b=v("../scatter/colorscale_calc"),y=v("../scatter/arrays_to_calcdata"),e=v("../scatter/calc_selection"),n=v("../../lib")._;function t(a){return a&&typeof a=="string"}J.exports=function(a,r){var m,o=Array.isArray(r.locations),i=o?r.locations.length:r._length,u=new Array(i);m=r.geojson?function(x){return t(x)||p(x)}:t;for(var f=0;f<i;f++){var l=u[f]={};if(o){var h=r.locations[f];l.loc=m(h)?h:null}else{var d=r.lon[f],s=r.lat[f];p(d)&&p(s)?l.lonlat=[+d,+s]:l.lonlat=[g,g]}}return y(u,r),b(a,r),e(u,r),i&&(u[0].t={labels:{lat:n(a,"lat:")+" ",lon:n(a,"lon:")+" "}}),u}},{"../../constants/numerical":491,"../../lib":515,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],980:[function(v,J,Z){var p=v("../../lib"),g=v("../scatter/subtypes"),b=v("../scatter/marker_defaults"),y=v("../scatter/line_defaults"),e=v("../scatter/text_defaults"),n=v("../scatter/fillcolor_defaults"),t=v("./attributes");J.exports=function(a,r,m,o){function i(x,c){return p.coerce(a,r,t,x,c)}var u,f=i("locations");if(f&&f.length){var l,h=i("geojson");(typeof h=="string"&&h!==""||p.isPlainObject(h))&&(l="geojson-id"),i("locationmode",l)==="geojson-id"&&i("featureidkey"),u=f.length}else{var d=i("lon")||[],s=i("lat")||[];u=Math.min(d.length,s.length)}u?(r._length=u,i("text"),i("hovertext"),i("hovertemplate"),i("mode"),g.hasLines(r)&&(y(a,r,m,o,i),i("connectgaps")),g.hasMarkers(r)&&b(a,r,m,o,i,{gradient:!0}),g.hasText(r)&&(i("texttemplate"),e(a,r,o,i)),i("fill"),r.fill!=="none"&&n(a,r,m,i),p.coerceSelectionMarkerOpacity(r,i)):r.visible=!1}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":978}],981:[function(v,J,Z){J.exports=function(p,g,b,y,e){p.lon=g.lon,p.lat=g.lat,p.location=g.loc?g.loc:null;var n=y[e];return n.fIn&&n.fIn.properties&&(p.properties=n.fIn.properties),p}},{}],982:[function(v,J,Z){var p=v("../../plots/cartesian/axes");J.exports=function(g,b,y){var e={},n=y[b.geo]._subplot.mockAxis,t=g.lonlat;return e.lonLabel=p.tickText(n,n.c2l(t[0]),!0).text,e.latLabel=p.tickText(n,n.c2l(t[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],983:[function(v,J,Z){var p=v("../../components/fx"),g=v("../../constants/numerical").BADNUM,b=v("../scatter/get_trace_color"),y=v("../../lib").fillText,e=v("./attributes");J.exports=function(n,t,a){var r=n.cd,m=r[0].trace,o=n.xa,i=n.ya,u=n.subplot,f=u.projection.isLonLatOverEdges,l=u.project;if(p.getClosest(r,function(_){var w=_.lonlat;if(w[0]===g||f(w))return 1/0;var k=l(w),L=l([t,a]),A=Math.abs(k[0]-L[0]),I=Math.abs(k[1]-L[1]),P=Math.max(3,_.mrc||0);return Math.max(Math.sqrt(A*A+I*I)-P,1-3/P)},n),n.index!==!1){var h=r[n.index],d=h.lonlat,s=[o.c2p(d),i.c2p(d)],x=h.mrc||1;n.x0=s[0]-x,n.x1=s[0]+x,n.y0=s[1]-x,n.y1=s[1]+x,n.loc=h.loc,n.lon=d[0],n.lat=d[1];var c={};c[m.geo]={_subplot:u};var T=m._module.formatLabels(h,m,c);return n.lonLabel=T.lonLabel,n.latLabel=T.latLabel,n.color=b(m,h),n.extraText=function(_,w,k,L){if(_.hovertemplate)return;var A=w.hi||_.hoverinfo,I=A==="all"?e.hoverinfo.flags:A.split("+"),P=I.indexOf("location")!==-1&&Array.isArray(_.locations),S=I.indexOf("lon")!==-1,E=I.indexOf("lat")!==-1,D=I.indexOf("text")!==-1,R=[];function H(V){return V+"\xB0"}return P?R.push(w.loc):S&&E?R.push("("+H(k.latLabel)+", "+H(k.lonLabel)+")"):S?R.push(L.lon+H(k.lonLabel)):E&&R.push(L.lat+H(k.latLabel)),D&&y(w,_,R),R.join("<br>")}(m,h,n,r[0].t.labels),n.hovertemplate=m.hovertemplate,[n]}}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946,"./attributes":978}],984:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),calcGeoJSON:v("./plot").calcGeoJSON,plot:v("./plot").plot,style:v("./style"),styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:v("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":598,"../scatter/marker_colorbar":954,"../scatter/style":960,"./attributes":978,"./calc":979,"./defaults":980,"./event_data":981,"./format_labels":982,"./hover":983,"./plot":985,"./select":986,"./style":987}],985:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../lib/topojson_utils").getTopojsonFeatures,y=v("../../lib/geojson_utils"),e=v("../../lib/geo_location_utils"),n=v("../../plots/cartesian/autorange").findExtremes,t=v("../../constants/numerical").BADNUM,a=v("../scatter/calc").calcMarkerSize,r=v("../scatter/subtypes"),m=v("./style");J.exports={calcGeoJSON:function(o,i){var u,f,l=o[0].trace,h=i[l.geo],d=h._subplot,s=l._length;if(Array.isArray(l.locations)){var x=l.locationmode,c=x==="geojson-id"?e.extractTraceFeature(o):b(l,d.topojson);for(u=0;u<s;u++){f=o[u];var T=x==="geojson-id"?f.fOut:e.locationToFeature(x,f.loc,c);f.lonlat=T?T.properties.ct:[t,t]}}var _,w,k={padded:!0};if(h.fitbounds==="geojson"&&l.locationmode==="geojson-id"){var L=e.computeBbox(e.getTraceGeojson(l));_=[L[0],L[2]],w=[L[1],L[3]]}else{for(_=new Array(s),w=new Array(s),u=0;u<s;u++)f=o[u],_[u]=f.lonlat[0],w[u]=f.lonlat[1];k.ppad=a(l,s)}l._extremes.lon=n(h.lonaxis._ax,_,k),l._extremes.lat=n(h.lataxis._ax,w,k)},plot:function(o,i,u){var f=i.layers.frontplot.select(".scatterlayer"),l=g.makeTraceGroups(f,u,"trace scattergeo");function h(d,s){d.lonlat[0]===t&&p.select(s).remove()}l.selectAll("*").remove(),l.each(function(d){var s=p.select(this),x=d[0].trace;if(r.hasLines(x)||x.fill!=="none"){var c=y.calcTraceToLineCoords(d),T=x.fill!=="none"?y.makePolygon(c):y.makeLine(c);s.selectAll("path.js-line").data([{geojson:T,trace:x}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}r.hasMarkers(x)&&s.selectAll("path.point").data(g.identity).enter().append("path").classed("point",!0).each(function(_){h(_,this)}),r.hasText(x)&&s.selectAll("g").data(g.identity).enter().append("g").append("text").each(function(_){h(_,this)}),m(o,d)})}}},{"../../constants/numerical":491,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"../scatter/calc":937,"../scatter/subtypes":961,"./style":987,"@plotly/d3":58}],986:[function(v,J,Z){var p=v("../scatter/subtypes"),g=v("../../constants/numerical").BADNUM;J.exports=function(b,y){var e,n,t,a,r,m=b.cd,o=b.xaxis,i=b.yaxis,u=[],f=m[0].trace;if(!p.hasMarkers(f)&&!p.hasText(f))return[];if(y===!1)for(r=0;r<m.length;r++)m[r].selected=0;else for(r=0;r<m.length;r++)(n=(e=m[r]).lonlat)[0]!==g&&(t=o.c2p(n),a=i.c2p(n),y.contains([t,a],null,r,b)?(u.push({pointNumber:r,lon:n[0],lat:n[1]}),e.selected=1):e.selected=0);return u}},{"../../constants/numerical":491,"../scatter/subtypes":961}],987:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/drawing"),b=v("../../components/color"),y=v("../scatter/style"),e=y.stylePoints,n=y.styleText;J.exports=function(t,a){a&&function(r,m){var o=m[0].trace,i=m[0].node3;i.style("opacity",m[0].trace.opacity),e(i,o,r),n(i,o,r),i.selectAll("path.js-line").style("fill","none").each(function(u){var f=p.select(this),l=u.trace,h=l.line||{};f.call(b.stroke,h.color).call(g.dashLine,h.dash||"",h.width||0),l.fill!=="none"&&f.call(b.fill,l.fillcolor)})}(t,a)}},{"../../components/color":367,"../../components/drawing":389,"../scatter/style":960,"@plotly/d3":58}],988:[function(v,J,Z){var p=v("../../plots/attributes"),g=v("../scatter/attributes"),b=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=v("../../components/colorscale/attributes"),e=v("../../lib/sort_object_keys"),n=v("../../lib/extend").extendFlat,t=v("../../plot_api/edit_types").overrideAll,a=v("./constants").DASHES,r=g.line,m=g.marker,o=m.line,i=J.exports=t({x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:b("x"),yhoverformat:b("y"),text:g.text,hovertext:g.hovertext,textposition:g.textposition,textfont:g.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:r.color,width:r.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(a),dflt:"solid"}},marker:n({},y("marker"),{symbol:m.symbol,size:m.size,sizeref:m.sizeref,sizemin:m.sizemin,sizemode:m.sizemode,opacity:m.opacity,colorbar:m.colorbar,line:n({},y("marker.line"),{width:o.width})}),connectgaps:g.connectgaps,fill:n({},g.fill,{dflt:"none"}),fillcolor:g.fillcolor,selected:{marker:g.selected.marker,textfont:g.selected.textfont},unselected:{marker:g.unselected.marker,textfont:g.unselected.textfont},opacity:p.opacity},"calc","nested");i.x.editType=i.y.editType=i.x0.editType=i.y0.editType="calc+clearAxisTypes",i.hovertemplate=g.hovertemplate,i.texttemplate=g.texttemplate},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936,"./constants":991}],989:[function(v,J,Z){var p=v("./hover");J.exports={moduleType:"trace",name:"scattergl",basePlotModule:v("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../scatter/cross_trace_defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),hoverPoints:p.hoverPoints,selectPoints:v("./select"),meta:{}}},{"../../plots/cartesian":578,"../scatter/cross_trace_defaults":942,"../scatter/marker_colorbar":954,"./attributes":988,"./calc":990,"./defaults":993,"./format_labels":995,"./hover":997,"./select":1001}],990:[function(v,J,Z){var p=v("@plotly/point-cluster"),g=v("../../lib"),b=v("../../plots/cartesian/axis_ids"),y=v("../../plots/cartesian/autorange").findExtremes,e=v("../../plots/cartesian/align_period"),n=v("../scatter/calc"),t=n.calcMarkerSize,a=n.calcAxisExpansion,r=n.setFirstScatter,m=v("../scatter/colorscale_calc"),o=v("./convert"),i=v("./scene_update"),u=v("../../constants/numerical").BADNUM,f=v("./constants").TOO_MANY_POINTS;function l(h,d,s){var x=h._extremes[d._id],c=y(d,s._bnds,{padded:!0});x.min=x.min.concat(c.min),x.max=x.max.concat(c.max)}J.exports=function(h,d){var s,x=h._fullLayout,c=b.getFromId(h,d.xaxis),T=b.getFromId(h,d.yaxis),_=x._plots[d.xaxis+d.yaxis],w=d._length,k=w>=f,L=2*w,A={},I=c.makeCalcdata(d,"x"),P=T.makeCalcdata(d,"y"),S=e(d,c,"x",I),E=e(d,T,"y",P),D=S.vals,R=E.vals;d._x=D,d._y=R,d.xperiodalignment&&(d._origX=I,d._xStarts=S.starts,d._xEnds=S.ends),d.yperiodalignment&&(d._origY=P,d._yStarts=E.starts,d._yEnds=E.ends);var H=new Array(L),V=new Array(w);for(s=0;s<w;s++)H[2*s]=D[s]===u?NaN:D[s],H[2*s+1]=R[s]===u?NaN:R[s],V[s]=s;if(c.type==="log")for(s=0;s<L;s+=2)H[s]=c.c2l(H[s]);if(T.type==="log")for(s=1;s<L;s+=2)H[s]=T.c2l(H[s]);k&&c.type!=="log"&&T.type!=="log"?A.tree=p(H):A.ids=V,m(h,d);var X,$=function(W,te,N,B,U,ee){var j=o.style(W,N);if(j.marker&&(j.marker.positions=B),j.line&&B.length>1&&g.extendFlat(j.line,o.linePositions(W,N,B)),j.errorX||j.errorY){var Q=o.errorBarPositions(W,N,B,U,ee);j.errorX&&g.extendFlat(j.errorX,Q.x),j.errorY&&g.extendFlat(j.errorY,Q.y)}return j.text&&(g.extendFlat(j.text,{positions:B},o.textPosition(W,N,j.text,j.marker)),g.extendFlat(j.textSel,{positions:B},o.textPosition(W,N,j.text,j.markerSel)),g.extendFlat(j.textUnsel,{positions:B},o.textPosition(W,N,j.text,j.markerUnsel))),j}(h,0,d,H,D,R),G=i(h,_);return r(x,d),k?$.marker&&(X=$.marker.sizeAvg||Math.max($.marker.size,3)):X=t(d,w),a(h,d,c,T,D,R,X),$.errorX&&l(d,c,$.errorX),$.errorY&&l(d,T,$.errorY),$.fill&&!G.fill2d&&(G.fill2d=!0),$.marker&&!G.scatter2d&&(G.scatter2d=!0),$.line&&!G.line2d&&(G.line2d=!0),!$.errorX&&!$.errorY||G.error2d||(G.error2d=!0),$.text&&!G.glText&&(G.glText=!0),$.marker&&($.marker.snap=w),G.lineOptions.push($.line),G.errorXOptions.push($.errorX),G.errorYOptions.push($.errorY),G.fillOptions.push($.fill),G.markerOptions.push($.marker),G.markerSelectedOptions.push($.markerSel),G.markerUnselectedOptions.push($.markerUnsel),G.textOptions.push($.text),G.textSelectedOptions.push($.textSel),G.textUnselectedOptions.push($.textUnsel),G.selectBatch.push([]),G.unselectBatch.push([]),A._scene=G,A.index=G.count,A.x=D,A.y=R,A.positions=H,G.count++,[{x:!1,y:!1,t:A,trace:d}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"./constants":991,"./convert":992,"./scene_update":1e3,"@plotly/point-cluster":59}],991:[function(v,J,Z){J.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],992:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("svg-path-sdf"),b=v("color-normalize"),y=v("../../registry"),e=v("../../lib"),n=v("../../components/drawing"),t=v("../../plots/cartesian/axis_ids"),a=v("../../lib/gl_format_color").formatColor,r=v("../scatter/subtypes"),m=v("../scatter/make_bubble_size_func"),o=v("./helpers"),i=v("./constants"),u=v("../../constants/interactions").DESELECTDIM,f={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},l=v("../../components/fx/helpers").appendArrayPointValue;function h(I,P){var S,E=I._fullLayout,D=P._length,R=P.textfont,H=P.textposition,V=Array.isArray(H)?H:[H],X=R.color,$=R.size,G=R.family,W={},te=I._context.plotGlPixelRatio,N=P.texttemplate;if(N){W.text=[];var B=E._d3locale,U=Array.isArray(N),ee=U?Math.min(N.length,D):D,j=U?function(de){return N[de]}:function(){return N};for(S=0;S<ee;S++){var Q={i:S},K=P._module.formatLabels(Q,P,E),re={};l(re,P,S);var ne=P._meta||{};W.text.push(e.texttemplateString(j(S),K,B,re,Q,ne))}}else Array.isArray(P.text)&&P.text.length<D?W.text=P.text.slice():W.text=P.text;if(Array.isArray(W.text))for(S=W.text.length;S<D;S++)W.text[S]="";for(W.opacity=P.opacity,W.font={},W.align=[],W.baseline=[],S=0;S<V.length;S++){var le=V[S].split(/\s+/);switch(le[1]){case"left":W.align.push("right");break;case"right":W.align.push("left");break;default:W.align.push(le[1])}switch(le[0]){case"top":W.baseline.push("bottom");break;case"bottom":W.baseline.push("top");break;default:W.baseline.push(le[0])}}if(Array.isArray(X))for(W.color=new Array(D),S=0;S<D;S++)W.color[S]=X[S];else W.color=X;if(e.isArrayOrTypedArray($)||Array.isArray(G))for(W.font=new Array(D),S=0;S<D;S++){var oe=W.font[S]={};oe.size=(e.isTypedArray($)?$[S]:Array.isArray($)?p($[S])?$[S]:0:$)*te,oe.family=Array.isArray(G)?G[S]:G}else W.font={size:$*te,family:G};return W}function d(I){var P,S,E=I._length,D=I.marker,R={},H=e.isArrayOrTypedArray(D.symbol),V=e.isArrayOrTypedArray(D.color),X=e.isArrayOrTypedArray(D.line.color),$=e.isArrayOrTypedArray(D.opacity),G=e.isArrayOrTypedArray(D.size),W=e.isArrayOrTypedArray(D.line.width);if(H||(S=o.isOpenSymbol(D.symbol)),H||V||X||$){R.colors=new Array(E),R.borderColors=new Array(E);var te=a(D,D.opacity,E),N=a(D.line,D.opacity,E);if(!Array.isArray(N[0])){var B=N;for(N=Array(E),P=0;P<E;P++)N[P]=B}if(!Array.isArray(te[0])){var U=te;for(te=Array(E),P=0;P<E;P++)te[P]=U}for(R.colors=te,R.borderColors=N,P=0;P<E;P++){if(H){var ee=D.symbol[P];S=o.isOpenSymbol(ee)}S&&(N[P]=te[P].slice(),te[P]=te[P].slice(),te[P][3]=0)}R.opacity=I.opacity}else S?(R.color=b(D.color,"uint8"),R.color[3]=0,R.borderColor=b(D.color,"uint8")):(R.color=b(D.color,"uint8"),R.borderColor=b(D.line.color,"uint8")),R.opacity=I.opacity*D.opacity;if(H)for(R.markers=new Array(E),P=0;P<E;P++)R.markers[P]=A(D.symbol[P]);else R.marker=A(D.symbol);var j,Q=m(I,1);if(G||W){var K,re=R.sizes=new Array(E),ne=R.borderSizes=new Array(E),le=0;if(G){for(P=0;P<E;P++)re[P]=Q(D.size[P]),le+=re[P];K=le/E}else for(j=Q(D.size),P=0;P<E;P++)re[P]=j;if(W)for(P=0;P<E;P++)ne[P]=D.line.width[P];else for(j=D.line.width,P=0;P<E;P++)ne[P]=j;R.sizeAvg=K}else R.size=Q(D&&D.size||10),R.borderSizes=Q(D.line.width);return R}function s(I,P){var S=I.marker,E={};return P&&(P.marker&&P.marker.symbol?E=d(e.extendFlat({},S,P.marker)):P.marker&&(P.marker.size&&(E.size=P.marker.size),P.marker.color&&(E.colors=P.marker.color),P.marker.opacity!==void 0&&(E.opacity=P.marker.opacity))),E}function x(I,P,S){var E={};if(!S)return E;if(S.textfont){var D={opacity:1,text:P.text,texttemplate:P.texttemplate,textposition:P.textposition,textfont:e.extendFlat({},P.textfont)};S.textfont&&e.extendFlat(D.textfont,S.textfont),E=h(I,D)}return E}function c(I,P,S){var E={capSize:2*P.width*S,lineWidth:P.thickness*S,color:P.color};return P.copy_ystyle&&(E=I.error_y),E}var T=i.SYMBOL_SDF_SIZE,_=i.SYMBOL_SIZE,w=i.SYMBOL_STROKE,k={},L=n.symbolFuncs[0](.05*_);function A(I){if(I==="circle")return null;var P,S,E=n.symbolNumber(I),D=n.symbolFuncs[E%100],R=!!n.symbolNoDot[E%100],H=!!n.symbolNoFill[E%100],V=o.isDotSymbol(I);return k[I]?k[I]:(P=V&&!R?D(1.1*_)+L:D(_),S=g(P,{w:T,h:T,viewBox:[-_,-_,_,_],stroke:H?w:-w}),k[I]=S,S||null)}J.exports={style:function(I,P){var S,E={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},D=I._context.plotGlPixelRatio;if(P.visible!==!0)return E;if(r.hasText(P)&&(E.text=h(I,P),E.textSel=x(I,P,P.selected),E.textUnsel=x(I,P,P.unselected)),r.hasMarkers(P)&&(E.marker=d(P),E.markerSel=s(P,P.selected),E.markerUnsel=s(P,P.unselected),!P.unselected&&e.isArrayOrTypedArray(P.marker.opacity))){var R=P.marker.opacity;for(E.markerUnsel.opacity=new Array(R.length),S=0;S<R.length;S++)E.markerUnsel.opacity[S]=u*R[S]}if(r.hasLines(P)){E.line={overlay:!0,thickness:P.line.width*D,color:P.line.color,opacity:P.opacity};var H=(i.DASHES[P.line.dash]||[1]).slice();for(S=0;S<H.length;++S)H[S]*=P.line.width*D;E.line.dashes=H}return P.error_x&&P.error_x.visible&&(E.errorX=c(P,P.error_x,D)),P.error_y&&P.error_y.visible&&(E.errorY=c(P,P.error_y,D)),P.fill&&P.fill!=="none"&&(E.fill={closed:!0,fill:P.fillcolor,thickness:0}),E},markerStyle:d,markerSelection:s,linePositions:function(I,P,S){var E,D,R=S.length,H=R/2;if(r.hasLines(P)&&H)if(P.line.shape==="hv"){for(E=[],D=0;D<H-1;D++)isNaN(S[2*D])||isNaN(S[2*D+1])?E.push(NaN,NaN,NaN,NaN):(E.push(S[2*D],S[2*D+1]),isNaN(S[2*D+2])||isNaN(S[2*D+3])?E.push(NaN,NaN):E.push(S[2*D+2],S[2*D+1]));E.push(S[R-2],S[R-1])}else if(P.line.shape==="hvh"){for(E=[],D=0;D<H-1;D++)if(isNaN(S[2*D])||isNaN(S[2*D+1])||isNaN(S[2*D+2])||isNaN(S[2*D+3]))isNaN(S[2*D])||isNaN(S[2*D+1])?E.push(NaN,NaN):E.push(S[2*D],S[2*D+1]),E.push(NaN,NaN);else{var V=(S[2*D]+S[2*D+2])/2;E.push(S[2*D],S[2*D+1],V,S[2*D+1],V,S[2*D+3])}E.push(S[R-2],S[R-1])}else if(P.line.shape==="vhv"){for(E=[],D=0;D<H-1;D++)if(isNaN(S[2*D])||isNaN(S[2*D+1])||isNaN(S[2*D+2])||isNaN(S[2*D+3]))isNaN(S[2*D])||isNaN(S[2*D+1])?E.push(NaN,NaN):E.push(S[2*D],S[2*D+1]),E.push(NaN,NaN);else{var X=(S[2*D+1]+S[2*D+3])/2;E.push(S[2*D],S[2*D+1],S[2*D],X,S[2*D+2],X)}E.push(S[R-2],S[R-1])}else if(P.line.shape==="vh"){for(E=[],D=0;D<H-1;D++)isNaN(S[2*D])||isNaN(S[2*D+1])?E.push(NaN,NaN,NaN,NaN):(E.push(S[2*D],S[2*D+1]),isNaN(S[2*D+2])||isNaN(S[2*D+3])?E.push(NaN,NaN):E.push(S[2*D],S[2*D+3]));E.push(S[R-2],S[R-1])}else E=S;var $=!1;for(D=0;D<E.length;D++)if(isNaN(E[D])){$=!0;break}var G=$||E.length>i.TOO_MANY_POINTS||r.hasMarkers(P)?"rect":"round";if($&&P.connectgaps){var W=E[0],te=E[1];for(D=0;D<E.length;D+=2)isNaN(E[D])||isNaN(E[D+1])?(E[D]=W,E[D+1]=te):(W=E[D],te=E[D+1])}return{join:G,positions:E}},errorBarPositions:function(I,P,S,E,D){var R=y.getComponentMethod("errorbars","makeComputeError"),H=t.getFromId(I,P.xaxis),V=t.getFromId(I,P.yaxis),X=S.length/2,$={};function G(W,te){var N=te._id.charAt(0),B=P["error_"+N];if(B&&B.visible&&(te.type==="linear"||te.type==="log")){for(var U=R(B),ee={x:0,y:1}[N],j={x:[0,1,2,3],y:[2,3,0,1]}[N],Q=new Float64Array(4*X),K=1/0,re=-1/0,ne=0,le=0;ne<X;ne++,le+=4){var oe=W[ne];if(p(oe)){var de=S[2*ne+ee],se=U(oe,ne),me=se[0],Te=se[1];if(p(me)&&p(Te)){var _e=oe-me,be=oe+Te;Q[le+j[0]]=de-te.c2l(_e),Q[le+j[1]]=te.c2l(be)-de,Q[le+j[2]]=0,Q[le+j[3]]=0,K=Math.min(K,oe-me),re=Math.max(re,oe+Te)}}}$[N]={positions:S,errors:Q,_bnds:[K,re]}}}return G(E,H),G(D,V),$},textPosition:function(I,P,S,E){var D,R=P._length,H={};if(r.hasMarkers(P)){var V=S.font,X=S.align,$=S.baseline;for(H.offset=new Array(R),D=0;D<R;D++){var G=E.sizes?E.sizes[D]:E.size,W=Array.isArray(V)?V[D].size:V.size,te=Array.isArray(X)?X.length>1?X[D]:X[0]:X,N=Array.isArray($)?$.length>1?$[D]:$[0]:$,B=f[te],U=f[N],ee=G?G/.8+1:0,j=-U*ee-.5*U;H.offset[D]=[B*ee/W,j/W]}}return H}}},{"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/interactions":490,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"./constants":991,"./helpers":996,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":311}],993:[function(v,J,Z){var p=v("../../lib"),g=v("../../registry"),b=v("./helpers"),y=v("./attributes"),e=v("../scatter/constants"),n=v("../scatter/subtypes"),t=v("../scatter/xy_defaults"),a=v("../scatter/period_defaults"),r=v("../scatter/marker_defaults"),m=v("../scatter/line_defaults"),o=v("../scatter/fillcolor_defaults"),i=v("../scatter/text_defaults");J.exports=function(u,f,l,h){function d(L,A){return p.coerce(u,f,y,L,A)}var s=!!u.marker&&b.isOpenSymbol(u.marker.symbol),x=n.isBubble(u),c=t(u,f,h,d);if(c){a(u,f,h,d),d("xhoverformat"),d("yhoverformat");var T=c<e.PTS_LINESONLY?"lines+markers":"lines";d("text"),d("hovertext"),d("hovertemplate"),d("mode",T),n.hasLines(f)&&(d("connectgaps"),m(u,f,l,h,d),d("line.shape")),n.hasMarkers(f)&&(r(u,f,l,h,d),d("marker.line.width",s||x?1:0)),n.hasText(f)&&(d("texttemplate"),i(u,f,h,d));var _=(f.line||{}).color,w=(f.marker||{}).color;d("fill"),f.fill!=="none"&&o(u,f,l,d);var k=g.getComponentMethod("errorbars","supplyDefaults");k(u,f,_||w||l,{axis:"y"}),k(u,f,_||w||l,{axis:"x",inherit:"y"}),p.coerceSelectionMarkerOpacity(f,d)}else f.visible=!1}},{"../../lib":515,"../../registry":647,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/period_defaults":956,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatter/xy_defaults":963,"./attributes":988,"./helpers":996}],994:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/color"),b=v("../../constants/interactions").DESELECTDIM;J.exports={styleTextSelection:function(y){var e,n,t=y[0],a=t.trace,r=t.t,m=r._scene,o=r.index,i=m.selectBatch[o],u=m.unselectBatch[o],f=m.textOptions[o],l=m.textSelectedOptions[o]||{},h=m.textUnselectedOptions[o]||{},d=p.extendFlat({},f);if(i.length||u.length){var s=l.color,x=h.color,c=f.color,T=Array.isArray(c);for(d.color=new Array(a._length),e=0;e<i.length;e++)n=i[e],d.color[n]=s||(T?c[n]:c);for(e=0;e<u.length;e++){n=u[e];var _=T?c[n]:c;d.color[n]=x||(s?_:g.addOpacity(_,b))}}m.glText[o].update(d)}}},{"../../components/color":367,"../../constants/interactions":490,"../../lib":515}],995:[function(v,J,Z){var p=v("../scatter/format_labels");J.exports=function(g,b,y){var e=g.i;return"x"in g||(g.x=b._x[e]),"y"in g||(g.y=b._y[e]),p(g,b,y)}},{"../scatter/format_labels":945}],996:[function(v,J,Z){var p=v("./constants");Z.isOpenSymbol=function(g){return typeof g=="string"?p.OPEN_RE.test(g):g%200>100},Z.isDotSymbol=function(g){return typeof g=="string"?p.DOT_RE.test(g):g>200}},{"./constants":991}],997:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib"),b=v("../scatter/get_trace_color");function y(e,n,t,a){var r=e.xa,m=e.ya,o=e.distance,i=e.dxy,u=e.index,f={pointNumber:u,x:n[u],y:t[u]};f.tx=Array.isArray(a.text)?a.text[u]:a.text,f.htx=Array.isArray(a.hovertext)?a.hovertext[u]:a.hovertext,f.data=Array.isArray(a.customdata)?a.customdata[u]:a.customdata,f.tp=Array.isArray(a.textposition)?a.textposition[u]:a.textposition;var l=a.textfont;l&&(f.ts=g.isArrayOrTypedArray(l.size)?l.size[u]:l.size,f.tc=Array.isArray(l.color)?l.color[u]:l.color,f.tf=Array.isArray(l.family)?l.family[u]:l.family);var h=a.marker;h&&(f.ms=g.isArrayOrTypedArray(h.size)?h.size[u]:h.size,f.mo=g.isArrayOrTypedArray(h.opacity)?h.opacity[u]:h.opacity,f.mx=g.isArrayOrTypedArray(h.symbol)?h.symbol[u]:h.symbol,f.mc=g.isArrayOrTypedArray(h.color)?h.color[u]:h.color);var d=h&&h.line;d&&(f.mlc=Array.isArray(d.color)?d.color[u]:d.color,f.mlw=g.isArrayOrTypedArray(d.width)?d.width[u]:d.width);var s=h&&h.gradient;s&&s.type!=="none"&&(f.mgt=Array.isArray(s.type)?s.type[u]:s.type,f.mgc=Array.isArray(s.color)?s.color[u]:s.color);var x=r.c2p(f.x,!0),c=m.c2p(f.y,!0),T=f.mrc||1,_=a.hoverlabel;_&&(f.hbg=Array.isArray(_.bgcolor)?_.bgcolor[u]:_.bgcolor,f.hbc=Array.isArray(_.bordercolor)?_.bordercolor[u]:_.bordercolor,f.hts=g.isArrayOrTypedArray(_.font.size)?_.font.size[u]:_.font.size,f.htc=Array.isArray(_.font.color)?_.font.color[u]:_.font.color,f.htf=Array.isArray(_.font.family)?_.font.family[u]:_.font.family,f.hnl=g.isArrayOrTypedArray(_.namelength)?_.namelength[u]:_.namelength);var w=a.hoverinfo;w&&(f.hi=Array.isArray(w)?w[u]:w);var k=a.hovertemplate;k&&(f.ht=Array.isArray(k)?k[u]:k);var L={};L[e.index]=f;var A=a._origX,I=a._origY,P=g.extendFlat({},e,{color:b(a,f),x0:x-T,x1:x+T,xLabelVal:A?A[u]:f.x,y0:c-T,y1:c+T,yLabelVal:I?I[u]:f.y,cd:L,distance:o,spikeDistance:i,hovertemplate:f.ht});return f.htx?P.text=f.htx:f.tx?P.text=f.tx:a.text&&(P.text=a.text),g.fillText(f,a,P),p.getComponentMethod("errorbars","hoverInfo")(f,a,P),P}J.exports={hoverPoints:function(e,n,t,a){var r,m,o,i,u,f,l,h,d,s,x=e.cd,c=x[0].t,T=x[0].trace,_=e.xa,w=e.ya,k=c.x,L=c.y,A=_.c2p(n),I=w.c2p(t),P=e.distance;if(c.tree){var S=_.p2c(A-P),E=_.p2c(A+P),D=w.p2c(I-P),R=w.p2c(I+P);r=a==="x"?c.tree.range(Math.min(S,E),Math.min(w._rl[0],w._rl[1]),Math.max(S,E),Math.max(w._rl[0],w._rl[1])):c.tree.range(Math.min(S,E),Math.min(D,R),Math.max(S,E),Math.max(D,R))}else r=c.ids;var H=P;if(a==="x"){var V=!!T.xperiodalignment,X=!!T.yperiodalignment;for(f=0;f<r.length;f++){if(i=k[m=r[f]],l=Math.abs(_.c2p(i)-A),V){var $=_.c2p(T._xStarts[m]),G=_.c2p(T._xEnds[m]);l=A>=Math.min($,G)&&A<=Math.max($,G)?0:1/0}if(l<H){if(H=l,u=L[m],h=w.c2p(u)-I,X){var W=w.c2p(T._yStarts[m]),te=w.c2p(T._yEnds[m]);h=I>=Math.min(W,te)&&I<=Math.max(W,te)?0:1/0}s=Math.sqrt(l*l+h*h),o=r[f]}}}else for(f=r.length-1;f>-1;f--)i=k[m=r[f]],u=L[m],l=_.c2p(i)-A,h=w.c2p(u)-I,(d=Math.sqrt(l*l+h*h))<H&&(H=s=d,o=m);return e.index=o,e.distance=H,e.dxy=s,o===void 0?[e]:[y(e,k,L,T)]},calcHover:y}},{"../../lib":515,"../../registry":647,"../scatter/get_trace_color":946}],998:[function(v,J,Z){arguments[4][905][0].apply(Z,arguments)},{"./base_index":989,"./plot":999,dup:905}],999:[function(v,J,Z){var p=v("regl-scatter2d"),g=v("regl-line2d"),b=v("regl-error2d"),y=v("gl-text"),e=v("../../lib"),n=v("../../components/dragelement/helpers").selectMode,t=v("../../lib/prepare_regl"),a=v("../scatter/subtypes"),r=v("../scatter/link_traces"),m=v("./edit_style").styleTextSelection,o={};function i(u,f,l,h){var d=u._size,s=u.width*h,x=u.height*h,c=d.l*h,T=d.b*h,_=d.r*h,w=d.t*h,k=d.w*h,L=d.h*h;return[c+f.domain[0]*k,T+l.domain[0]*L,s-_-(1-f.domain[1])*k,x-w-(1-l.domain[1])*L]}(J.exports=function(u,f,l){if(l.length){var h,d,s=u._fullLayout,x=f._scene,c=f.xaxis,T=f.yaxis;if(x)if(t(u,["ANGLE_instanced_arrays","OES_element_index_uint"],o)){var _=x.count,w=s._glcanvas.data()[0].regl;if(r(u,f,l),x.dirty){if(x.error2d===!0&&(x.error2d=b(w)),x.line2d===!0&&(x.line2d=g(w)),x.scatter2d===!0&&(x.scatter2d=p(w)),x.fill2d===!0&&(x.fill2d=g(w)),x.glText===!0)for(x.glText=new Array(_),h=0;h<_;h++)x.glText[h]=new y(w);if(x.glText){if(_>x.glText.length){var k=_-x.glText.length;for(h=0;h<k;h++)x.glText.push(new y(w))}else if(_<x.glText.length){var L=x.glText.length-_;x.glText.splice(_,L).forEach(function(Q){Q.destroy()})}for(h=0;h<_;h++)x.glText[h].update(x.textOptions[h])}if(x.line2d&&(x.line2d.update(x.lineOptions),x.lineOptions=x.lineOptions.map(function(Q){if(Q&&Q.positions){for(var K=Q.positions,re=0;re<K.length&&(isNaN(K[re])||isNaN(K[re+1]));)re+=2;for(var ne=K.length-2;ne>re&&(isNaN(K[ne])||isNaN(K[ne+1]));)ne-=2;Q.positions=K.slice(re,ne+2)}return Q}),x.line2d.update(x.lineOptions)),x.error2d){var A=(x.errorXOptions||[]).concat(x.errorYOptions||[]);x.error2d.update(A)}x.scatter2d&&x.scatter2d.update(x.markerOptions),x.fillOrder=e.repeat(null,_),x.fill2d&&(x.fillOptions=x.fillOptions.map(function(Q,K){var re=l[K];if(Q&&re&&re[0]&&re[0].trace){var ne,le,oe=re[0],de=oe.trace,se=oe.t,me=x.lineOptions[K],Te=[];de._ownfill&&Te.push(K),de._nexttrace&&Te.push(K+1),Te.length&&(x.fillOrder[K]=Te);var _e,be,Ce=[],fe=me&&me.positions||se.positions;if(de.fill==="tozeroy"){for(_e=0;_e<fe.length&&isNaN(fe[_e+1]);)_e+=2;for(be=fe.length-2;be>_e&&isNaN(fe[be+1]);)be-=2;fe[_e+1]!==0&&(Ce=[fe[_e],0]),Ce=Ce.concat(fe.slice(_e,be+2)),fe[be+1]!==0&&(Ce=Ce.concat([fe[be],0]))}else if(de.fill==="tozerox"){for(_e=0;_e<fe.length&&isNaN(fe[_e]);)_e+=2;for(be=fe.length-2;be>_e&&isNaN(fe[be]);)be-=2;fe[_e]!==0&&(Ce=[0,fe[_e+1]]),Ce=Ce.concat(fe.slice(_e,be+2)),fe[be]!==0&&(Ce=Ce.concat([0,fe[be+1]]))}else if(de.fill==="toself"||de.fill==="tonext"){for(Ce=[],ne=0,Q.splitNull=!0,le=0;le<fe.length;le+=2)(isNaN(fe[le])||isNaN(fe[le+1]))&&((Ce=Ce.concat(fe.slice(ne,le))).push(fe[ne],fe[ne+1]),Ce.push(null,null),ne=le+2);Ce=Ce.concat(fe.slice(ne)),ne&&Ce.push(fe[ne],fe[ne+1])}else{var ve=de._nexttrace;if(ve){var Me=x.lineOptions[K+1];if(Me){var ke=Me.positions;if(de.fill==="tonexty"){for(Ce=fe.slice(),K=Math.floor(ke.length/2);K--;){var Le=ke[2*K],ze=ke[2*K+1];isNaN(Le)||isNaN(ze)||Ce.push(Le,ze)}Q.fill=ve.fillcolor}}}}if(de._prevtrace&&de._prevtrace.fill==="tonext"){var Re=x.lineOptions[K-1].positions,Oe=Ce.length/2,Ze=[ne=Oe];for(le=0;le<Re.length;le+=2)(isNaN(Re[le])||isNaN(Re[le+1]))&&(Ze.push(le/2+Oe+1),ne=le+2);Ce=Ce.concat(Re),Q.hole=Ze}return Q.fillmode=de.fill,Q.opacity=de.opacity,Q.positions=Ce,Q}}),x.fill2d.update(x.fillOptions))}var I=s.dragmode,P=n(I),S=s.clickmode.indexOf("select")>-1;for(h=0;h<_;h++){var E=l[h][0],D=E.trace,R=E.t,H=R.index,V=D._length,X=R.x,$=R.y;if(D.selectedpoints||P||S){if(P||(P=!0),D.selectedpoints){var G=x.selectBatch[H]=e.selIndices2selPoints(D),W={};for(d=0;d<G.length;d++)W[G[d]]=1;var te=[];for(d=0;d<V;d++)W[d]||te.push(d);x.unselectBatch[H]=te}var N=R.xpx=new Array(V),B=R.ypx=new Array(V);for(d=0;d<V;d++)N[d]=c.c2p(X[d]),B[d]=T.c2p($[d])}else R.xpx=R.ypx=null}if(P){if(x.select2d||(x.select2d=p(s._glcanvas.data()[1].regl)),x.scatter2d){var U=new Array(_);for(h=0;h<_;h++)U[h]=x.selectBatch[h].length||x.unselectBatch[h].length?x.markerUnselectedOptions[h]:{};x.scatter2d.update(U)}x.select2d&&(x.select2d.update(x.markerOptions),x.select2d.update(x.markerSelectedOptions)),x.glText&&l.forEach(function(Q){var K=((Q||[])[0]||{}).trace||{};a.hasText(K)&&m(Q)})}else x.scatter2d&&x.scatter2d.update(x.markerOptions);var ee={viewport:i(s,c,T,u._context.plotGlPixelRatio),range:[(c._rl||c.range)[0],(T._rl||T.range)[0],(c._rl||c.range)[1],(T._rl||T.range)[1]]},j=e.repeat(ee,x.count);x.fill2d&&x.fill2d.update(j),x.line2d&&x.line2d.update(j),x.error2d&&x.error2d.update(j.concat(j)),x.scatter2d&&x.scatter2d.update(j),x.select2d&&x.select2d.update(j),x.glText&&x.glText.forEach(function(Q){Q.update(ee)})}else x.init()}}).reglPrecompiled=o},{"../../components/dragelement/helpers":385,"../../lib":515,"../../lib/prepare_regl":528,"../scatter/link_traces":952,"../scatter/subtypes":961,"./edit_style":994,"gl-text":225,"regl-error2d":280,"regl-line2d":281,"regl-scatter2d":282}],1e3:[function(v,J,Z){var p=v("../../lib");J.exports=function(g,b){var y=b._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},n={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return b._scene||((y=b._scene={}).init=function(){p.extendFlat(y,n,e)},y.init(),y.update=function(t){var a=p.repeat(t,y.count);if(y.fill2d&&y.fill2d.update(a),y.scatter2d&&y.scatter2d.update(a),y.line2d&&y.line2d.update(a),y.error2d&&y.error2d.update(a.concat(a)),y.select2d&&y.select2d.update(a),y.glText)for(var r=0;r<y.count;r++)y.glText[r].update(t)},y.draw=function(){for(var t=y.count,a=y.fill2d,r=y.error2d,m=y.line2d,o=y.scatter2d,i=y.glText,u=y.select2d,f=y.selectBatch,l=y.unselectBatch,h=0;h<t;h++){if(a&&y.fillOrder[h]&&a.draw(y.fillOrder[h]),m&&y.lineOptions[h]&&m.draw(h),r&&(y.errorXOptions[h]&&r.draw(h),y.errorYOptions[h]&&r.draw(h+t)),o&&y.markerOptions[h])if(l[h].length){var d=p.repeat([],y.count);d[h]=l[h],o.draw(d)}else f[h].length||o.draw(h);i[h]&&y.textOptions[h]&&i[h].render()}u&&u.draw(f),y.dirty=!1},y.destroy=function(){y.fill2d&&y.fill2d.destroy&&y.fill2d.destroy(),y.scatter2d&&y.scatter2d.destroy&&y.scatter2d.destroy(),y.error2d&&y.error2d.destroy&&y.error2d.destroy(),y.line2d&&y.line2d.destroy&&y.line2d.destroy(),y.select2d&&y.select2d.destroy&&y.select2d.destroy(),y.glText&&y.glText.forEach(function(t){t.destroy&&t.destroy()}),y.lineOptions=null,y.fillOptions=null,y.markerOptions=null,y.markerSelectedOptions=null,y.markerUnselectedOptions=null,y.errorXOptions=null,y.errorYOptions=null,y.textOptions=null,y.textSelectedOptions=null,y.textUnselectedOptions=null,y.selectBatch=null,y.unselectBatch=null,b._scene=null}),y.dirty||p.extendFlat(y,e),y}},{"../../lib":515}],1001:[function(v,J,Z){var p=v("../scatter/subtypes"),g=v("./edit_style").styleTextSelection;J.exports=function(b,y){var e=b.cd,n=b.xaxis,t=b.yaxis,a=[],r=e[0].trace,m=e[0].t,o=r._length,i=m.x,u=m.y,f=m._scene,l=m.index;if(!f)return a;var h=p.hasText(r),d=p.hasMarkers(r),s=!d&&!h;if(r.visible!==!0||s)return a;var x=[],c=[];if(y!==!1&&!y.degenerate)for(var T=0;T<o;T++)y.contains([m.xpx[T],m.ypx[T]],!1,T,b)?(x.push(T),a.push({pointNumber:T,x:n.c2d(i[T]),y:t.c2d(u[T])})):c.push(T);if(d){var _=f.scatter2d;if(x.length||c.length){if(!f.selectBatch[l].length&&!f.unselectBatch[l].length){var w=new Array(f.count);w[l]=f.markerUnselectedOptions[l],_.update.apply(_,w)}}else{var k=new Array(f.count);k[l]=f.markerOptions[l],_.update.apply(_,k)}}return f.selectBatch[l]=x,f.unselectBatch[l]=c,h&&g(e),a}},{"../scatter/subtypes":961,"./edit_style":994}],1002:[function(v,J,Z){var p=v("../../plots/template_attributes").hovertemplateAttrs,g=v("../../plots/template_attributes").texttemplateAttrs,b=v("../scattergeo/attributes"),y=v("../scatter/attributes"),e=v("../../plots/mapbox/layout_attributes"),n=v("../../plots/attributes"),t=v("../../components/colorscale/attributes"),a=v("../../lib/extend").extendFlat,r=v("../../plot_api/edit_types").overrideAll,m=b.line,o=b.marker;J.exports=r({lon:b.lon,lat:b.lat,mode:a({},y.mode,{dflt:"markers"}),text:a({},y.text,{}),texttemplate:g({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:a({},y.hovertext,{}),line:{color:m.color,width:m.width},connectgaps:y.connectgaps,marker:a({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:o.opacity,size:o.size,sizeref:o.sizeref,sizemin:o.sizemin,sizemode:o.sizemode},t("marker")),fill:b.fill,fillcolor:y.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:y.selected.marker},unselected:{marker:y.unselected.marker},hoverinfo:a({},n.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:p()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/mapbox/layout_attributes":624,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergeo/attributes":978}],1003:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../lib"),b=v("../../constants/numerical").BADNUM,y=v("../../lib/geojson_utils"),e=v("../../components/colorscale"),n=v("../../components/drawing"),t=v("../scatter/make_bubble_size_func"),a=v("../scatter/subtypes"),r=v("../../plots/mapbox/convert_text_opts"),m=v("../../components/fx/helpers").appendArrayPointValue,o=v("../../lib/svg_text_utils").NEWLINES,i=v("../../lib/svg_text_utils").BR_TAG_ALL;function u(){return{geojson:y.makeBlank(),layout:{visibility:"none"},paint:{}}}function f(d,s){return g.isArrayOrTypedArray(d)?s?function(x){return p(d[x])?+d[x]:0}:function(x){return d[x]}:d?function(){return d}:l}function l(){return""}function h(d){return d[0]===b}J.exports=function(d,s){var x,c=s[0].trace,T=c.visible===!0&&c._length!==0,_=c.fill!=="none",w=a.hasLines(c),k=a.hasMarkers(c),L=a.hasText(c),A=k&&c.marker.symbol==="circle",I=k&&c.marker.symbol!=="circle",P=u(),S=u(),E=u(),D=u(),R={fill:P,line:S,circle:E,symbol:D};if(!T)return R;if((_||w)&&(x=y.calcTraceToLineCoords(s)),_&&(P.geojson=y.makePolygon(x),P.layout.visibility="visible",g.extendFlat(P.paint,{"fill-color":c.fillcolor})),w&&(S.geojson=y.makeLine(x),S.layout.visibility="visible",g.extendFlat(S.paint,{"line-width":c.line.width,"line-color":c.line.color,"line-opacity":c.opacity})),A){var H=function($){var G,W,te,N,B=$[0].trace,U=B.marker,ee=B.selectedpoints,j=g.isArrayOrTypedArray(U.color),Q=g.isArrayOrTypedArray(U.size),K=g.isArrayOrTypedArray(U.opacity);function re(_e){return B.opacity*_e}j&&(W=e.hasColorscale(B,"marker")?e.makeColorScaleFuncFromTrace(U):g.identity),Q&&(te=t(B)),K&&(N=function(_e){return re(p(_e)?+g.constrain(_e,0,1):0)});var ne,le=[];for(G=0;G<$.length;G++){var oe=$[G],de=oe.lonlat;if(!h(de)){var se={};W&&(se.mcc=oe.mcc=W(oe.mc)),te&&(se.mrc=oe.mrc=te(oe.ms)),N&&(se.mo=N(oe.mo)),ee&&(se.selected=oe.selected||0),le.push({type:"Feature",geometry:{type:"Point",coordinates:de},properties:se})}}if(ee)for(ne=n.makeSelectedPointStyleFns(B),G=0;G<le.length;G++){var me=le[G].properties;ne.selectedOpacityFn&&(me.mo=re(ne.selectedOpacityFn(me))),ne.selectedColorFn&&(me.mcc=ne.selectedColorFn(me)),ne.selectedSizeFn&&(me.mrc=ne.selectedSizeFn(me))}return{geojson:{type:"FeatureCollection",features:le},mcc:j||ne&&ne.selectedColorFn?{type:"identity",property:"mcc"}:U.color,mrc:Q||ne&&ne.selectedSizeFn?{type:"identity",property:"mrc"}:(Te=U.size,Te/2),mo:K||ne&&ne.selectedOpacityFn?{type:"identity",property:"mo"}:re(U.opacity)};var Te}(s);E.geojson=H.geojson,E.layout.visibility="visible",g.extendFlat(E.paint,{"circle-color":H.mcc,"circle-radius":H.mrc,"circle-opacity":H.mo})}if((I||L)&&(D.geojson=function($,G){for(var W=G._fullLayout,te=$[0].trace,N=te.marker||{},B=N.symbol,U=N.angle,ee=B!=="circle"?f(B):l,j=U!=="auto"?f(U,!0):l,Q=a.hasText(te)?f(te.text):l,K=[],re=0;re<$.length;re++){var ne=$[re];if(!h(ne.lonlat)){var le,oe=te.texttemplate;if(oe){var de=Array.isArray(oe)?oe[re]||"":oe,se=te._module.formatLabels(ne,te,W),me={};m(me,te,ne.i);var Te=te._meta||{};le=g.texttemplateString(de,se,W._d3locale,me,ne,Te)}else le=Q(re);le&&(le=le.replace(o,"").replace(i,`
`)),K.push({type:"Feature",geometry:{type:"Point",coordinates:ne.lonlat},properties:{symbol:ee(re),angle:j(re),text:le}})}}return{type:"FeatureCollection",features:K}}(s,d),g.extendFlat(D.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),I&&(g.extendFlat(D.layout,{"icon-size":c.marker.size/10}),"angle"in c.marker&&c.marker.angle!=="auto"&&g.extendFlat(D.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),D.layout["icon-allow-overlap"]=c.marker.allowoverlap,g.extendFlat(D.paint,{"icon-opacity":c.opacity*c.marker.opacity,"icon-color":c.marker.color})),L)){var V=(c.marker||{}).size,X=r(c.textposition,V);g.extendFlat(D.layout,{"text-size":c.textfont.size,"text-anchor":X.anchor,"text-offset":X.offset}),g.extendFlat(D.paint,{"text-color":c.textfont.color,"text-opacity":c.opacity})}return R}},{"../../components/colorscale":379,"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"../../lib/svg_text_utils":541,"../../plots/mapbox/convert_text_opts":621,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"fast-isnumeric":190}],1004:[function(v,J,Z){var p=v("../../lib"),g=v("../scatter/subtypes"),b=v("../scatter/marker_defaults"),y=v("../scatter/line_defaults"),e=v("../scatter/text_defaults"),n=v("../scatter/fillcolor_defaults"),t=v("./attributes");J.exports=function(a,r,m,o){function i(f,l){return p.coerce(a,r,t,f,l)}if(function(f,l,h){var d=h("lon")||[],s=h("lat")||[],x=Math.min(d.length,s.length);return l._length=x,x}(0,r,i)){if(i("text"),i("texttemplate"),i("hovertext"),i("hovertemplate"),i("mode"),i("below"),g.hasLines(r)&&(y(a,r,m,o,i,{noDash:!0}),i("connectgaps")),g.hasMarkers(r)){b(a,r,m,o,i,{noLine:!0}),i("marker.allowoverlap"),i("marker.angle");var u=r.marker;u.symbol!=="circle"&&(p.isArrayOrTypedArray(u.size)&&(u.size=u.size[0]),p.isArrayOrTypedArray(u.color)&&(u.color=u.color[0]))}g.hasText(r)&&e(a,r,o,i,{noSelect:!0}),i("fill"),r.fill!=="none"&&n(a,r,m,i),p.coerceSelectionMarkerOpacity(r,i)}else r.visible=!1}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1002}],1005:[function(v,J,Z){J.exports=function(p,g){return p.lon=g.lon,p.lat=g.lat,p}},{}],1006:[function(v,J,Z){var p=v("../../plots/cartesian/axes");J.exports=function(g,b,y){var e={},n=y[b.subplot]._subplot.mockAxis,t=g.lonlat;return e.lonLabel=p.tickText(n,n.c2l(t[0]),!0).text,e.latLabel=p.tickText(n,n.c2l(t[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],1007:[function(v,J,Z){var p=v("../../components/fx"),g=v("../../lib"),b=v("../scatter/get_trace_color"),y=g.fillText,e=v("../../constants/numerical").BADNUM;function n(t,a,r){if(!t.hovertemplate){var m=(a.hi||t.hoverinfo).split("+"),o=m.indexOf("all")!==-1,i=m.indexOf("lon")!==-1,u=m.indexOf("lat")!==-1,f=a.lonlat,l=[];return o||i&&u?l.push("("+h(f[1])+", "+h(f[0])+")"):i?l.push(r.lon+h(f[0])):u&&l.push(r.lat+h(f[1])),(o||m.indexOf("text")!==-1)&&y(a,t,l),l.join("<br>")}function h(d){return d+"\xB0"}}J.exports={hoverPoints:function(t,a,r){var m=t.cd,o=m[0].trace,i=t.xa,u=t.ya,f=t.subplot,l=360*(a>=0?Math.floor((a+180)/360):Math.ceil((a-180)/360)),h=a-l;if(p.getClosest(m,function(L){var A=L.lonlat;if(A[0]===e)return 1/0;var I=g.modHalf(A[0],360),P=A[1],S=f.project([I,P]),E=S.x-i.c2p([h,P]),D=S.y-u.c2p([I,r]),R=Math.max(3,L.mrc||0);return Math.max(Math.sqrt(E*E+D*D)-R,1-3/R)},t),t.index!==!1){var d=m[t.index],s=d.lonlat,x=[g.modHalf(s[0],360)+l,s[1]],c=i.c2p(x),T=u.c2p(x),_=d.mrc||1;t.x0=c-_,t.x1=c+_,t.y0=T-_,t.y1=T+_;var w={};w[o.subplot]={_subplot:f};var k=o._module.formatLabels(d,o,w);return t.lonLabel=k.lonLabel,t.latLabel=k.latLabel,t.color=b(o,d),t.extraText=n(o,d,m[0].t.labels),t.hovertemplate=o.hovertemplate,[t]}},getExtraText:n}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946}],1008:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("../scattergeo/calc"),plot:v("./plot"),hoverPoints:v("./hover").hoverPoints,eventData:v("./event_data"),selectPoints:v("./select"),styleOnSelect:function(p,g){g&&g[0].trace._glTrace.update(g)},moduleType:"trace",name:"scattermapbox",basePlotModule:v("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":622,"../scatter/marker_colorbar":954,"../scattergeo/calc":979,"./attributes":1002,"./defaults":1004,"./event_data":1005,"./format_labels":1006,"./hover":1007,"./plot":1009,"./select":1010}],1009:[function(v,J,Z){var p=v("./convert"),g=v("../../plots/mapbox/constants").traceLayerPrefix,b=["fill","line","circle","symbol"];function y(n,t){this.type="scattermapbox",this.subplot=n,this.uid=t,this.sourceIds={fill:"source-"+t+"-fill",line:"source-"+t+"-line",circle:"source-"+t+"-circle",symbol:"source-"+t+"-symbol"},this.layerIds={fill:g+t+"-fill",line:g+t+"-line",circle:g+t+"-circle",symbol:g+t+"-symbol"},this.below=null}var e=y.prototype;e.addSource=function(n,t){this.subplot.map.addSource(this.sourceIds[n],{type:"geojson",data:t.geojson})},e.setSourceData=function(n,t){this.subplot.map.getSource(this.sourceIds[n]).setData(t.geojson)},e.addLayer=function(n,t,a){this.subplot.addLayer({type:n,id:this.layerIds[n],source:this.sourceIds[n],layout:t.layout,paint:t.paint},a)},e.update=function(n){var t,a,r,m=this.subplot,o=m.map,i=p(m.gd,n),u=m.belowLookup["trace-"+this.uid];if(u!==this.below){for(t=b.length-1;t>=0;t--)a=b[t],o.removeLayer(this.layerIds[a]);for(t=0;t<b.length;t++)r=i[a=b[t]],this.addLayer(a,r,u);this.below=u}for(t=0;t<b.length;t++)r=i[a=b[t]],m.setOptions(this.layerIds[a],"setLayoutProperty",r.layout),r.layout.visibility==="visible"&&(this.setSourceData(a,r),m.setOptions(this.layerIds[a],"setPaintProperty",r.paint));n[0].trace._glTrace=this},e.dispose=function(){for(var n=this.subplot.map,t=b.length-1;t>=0;t--){var a=b[t];n.removeLayer(this.layerIds[a]),n.removeSource(this.sourceIds[a])}},J.exports=function(n,t){for(var a=t[0].trace,r=new y(n,a.uid),m=p(n.gd,t),o=r.below=n.belowLookup["trace-"+a.uid],i=0;i<b.length;i++){var u=b[i],f=m[u];r.addSource(u,f),r.addLayer(u,f,o)}return t[0].trace._glTrace=r,r}},{"../../plots/mapbox/constants":620,"./convert":1003}],1010:[function(v,J,Z){var p=v("../../lib"),g=v("../scatter/subtypes"),b=v("../../constants/numerical").BADNUM;J.exports=function(y,e){var n,t=y.cd,a=y.xaxis,r=y.yaxis,m=[],o=t[0].trace;if(!g.hasMarkers(o))return[];if(e===!1)for(n=0;n<t.length;n++)t[n].selected=0;else for(n=0;n<t.length;n++){var i=t[n],u=i.lonlat;if(u[0]!==b){var f=[p.modHalf(u[0],360),u[1]],l=[a.c2p(f),r.c2p(f)];e.contains(l,null,n,y)?(m.push({pointNumber:n,lon:u[0],lat:u[1]}),i.selected=1):i.selected=0}}return m}},{"../../constants/numerical":491,"../../lib":515,"../scatter/subtypes":961}],1011:[function(v,J,Z){var p=v("../../plots/template_attributes").hovertemplateAttrs,g=v("../../plots/template_attributes").texttemplateAttrs,b=v("../../lib/extend").extendFlat,y=v("../scatter/attributes"),e=v("../../plots/attributes"),n=y.line;J.exports={mode:y.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:y.text,texttemplate:g({editType:"plot"},{keys:["r","theta","text"]}),hovertext:y.hovertext,line:{color:n.color,width:n.width,dash:n.dash,shape:b({},n.shape,{values:["linear","spline"]}),smoothing:n.smoothing,editType:"calc"},connectgaps:y.connectgaps,marker:y.marker,cliponaxis:b({},y.cliponaxis,{dflt:!1}),textposition:y.textposition,textfont:y.textfont,fill:b({},y.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:y.fillcolor,hoverinfo:b({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:y.hoveron,hovertemplate:p(),selected:y.selected,unselected:y.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1012:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../constants/numerical").BADNUM,b=v("../../plots/cartesian/axes"),y=v("../scatter/colorscale_calc"),e=v("../scatter/arrays_to_calcdata"),n=v("../scatter/calc_selection"),t=v("../scatter/calc").calcMarkerSize;J.exports=function(a,r){for(var m=a._fullLayout,o=r.subplot,i=m[o].radialaxis,u=m[o].angularaxis,f=i.makeCalcdata(r,"r"),l=u.makeCalcdata(r,"theta"),h=r._length,d=new Array(h),s=0;s<h;s++){var x=f[s],c=l[s],T=d[s]={};p(x)&&p(c)?(T.r=x,T.theta=c):T.r=g}var _=t(r,h);return r._extremes.x=b.findExtremes(i,f,{ppad:_}),y(a,r),e(d,r),n(d,r),d}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1013:[function(v,J,Z){var p=v("../../lib"),g=v("../scatter/subtypes"),b=v("../scatter/marker_defaults"),y=v("../scatter/line_defaults"),e=v("../scatter/line_shape_defaults"),n=v("../scatter/text_defaults"),t=v("../scatter/fillcolor_defaults"),a=v("../scatter/constants").PTS_LINESONLY,r=v("./attributes");function m(o,i,u,f){var l,h=f("r"),d=f("theta");if(h)d?l=Math.min(h.length,d.length):(l=h.length,f("theta0"),f("dtheta"));else{if(!d)return 0;l=i.theta.length,f("r0"),f("dr")}return i._length=l,l}J.exports={handleRThetaDefaults:m,supplyDefaults:function(o,i,u,f){function l(s,x){return p.coerce(o,i,r,s,x)}var h=m(o,i,f,l);if(h){l("thetaunit"),l("mode",h<a?"lines+markers":"lines"),l("text"),l("hovertext"),i.hoveron!=="fills"&&l("hovertemplate"),g.hasLines(i)&&(y(o,i,u,f,l),e(o,i,l),l("connectgaps")),g.hasMarkers(i)&&b(o,i,u,f,l,{gradient:!0}),g.hasText(i)&&(l("texttemplate"),n(o,i,f,l));var d=[];(g.hasMarkers(i)||g.hasText(i))&&(l("cliponaxis"),l("marker.maxdisplayed"),d.push("points")),l("fill"),i.fill!=="none"&&(t(o,i,u,l),g.hasLines(i)||e(o,i,l)),i.fill!=="tonext"&&i.fill!=="toself"||d.push("fills"),l("hoveron",d.join("+")||"points"),p.coerceSelectionMarkerOpacity(i,l)}else i.visible=!1}}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1011}],1014:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes");J.exports=function(b,y,e){var n,t,a={},r=e[y.subplot]._subplot;r?(n=r.radialAxis,t=r.angularAxis):(n=(r=e[y.subplot]).radialaxis,t=r.angularaxis);var m=n.c2l(b.r);a.rLabel=g.tickText(n,m,!0).text;var o=t.thetaunit==="degrees"?p.rad2deg(b.theta):b.theta;return a.thetaLabel=g.tickText(t,o,!0).text,a}},{"../../lib":515,"../../plots/cartesian/axes":566}],1015:[function(v,J,Z){var p=v("../scatter/hover");function g(b,y,e,n){var t=e.radialAxis,a=e.angularAxis;t._hovertitle="r",a._hovertitle="\u03B8";var r={};r[y.subplot]={_subplot:e};var m=y._module.formatLabels(b,y,r);n.rLabel=m.rLabel,n.thetaLabel=m.thetaLabel;var o=b.hi||y.hoverinfo,i=[];function u(l,h){i.push(l._hovertitle+": "+h)}if(!y.hovertemplate){var f=o.split("+");f.indexOf("all")!==-1&&(f=["r","theta","text"]),f.indexOf("r")!==-1&&u(t,n.rLabel),f.indexOf("theta")!==-1&&u(a,n.thetaLabel),f.indexOf("text")!==-1&&n.text&&(i.push(n.text),delete n.text),n.extraText=i.join("<br>")}}J.exports={hoverPoints:function(b,y,e,n){var t=p(b,y,e,n);if(t&&t[0].index!==!1){var a=t[0];if(a.index===void 0)return t;var r=b.subplot,m=a.cd[a.index],o=a.trace;if(r.isPtInside(m))return a.xLabelVal=void 0,a.yLabelVal=void 0,g(m,o,r,a),a.hovertemplate=o.hovertemplate,t}},makeHoverPointText:g}},{"../scatter/hover":947}],1016:[function(v,J,Z){J.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:v("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,selectPoints:v("../scatter/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1011,"./calc":1012,"./defaults":1013,"./format_labels":1014,"./hover":1015,"./plot":1017}],1017:[function(v,J,Z){var p=v("../scatter/plot"),g=v("../../constants/numerical").BADNUM;J.exports=function(b,y,e){for(var n=y.layers.frontplot.select("g.scatterlayer"),t={xaxis:y.xaxis,yaxis:y.yaxis,plot:y.framework,layerClipId:y._hasClipOnAxisFalse?y.clipIds.forTraces:null},a=y.radialAxis,r=y.angularAxis,m=0;m<e.length;m++)for(var o=e[m],i=0;i<o.length;i++){var u=o[i],f=u.r;if(f===g)u.x=u.y=g;else{var l=a.c2g(f),h=r.c2g(u.theta);u.x=l*Math.cos(h),u.y=l*Math.sin(h)}}p(b,t,e,n)}},{"../../constants/numerical":491,"../scatter/plot":957}],1018:[function(v,J,Z){var p=v("../scatterpolar/attributes"),g=v("../scattergl/attributes"),b=v("../../plots/template_attributes").texttemplateAttrs;J.exports={mode:p.mode,r:p.r,theta:p.theta,r0:p.r0,dr:p.dr,theta0:p.theta0,dtheta:p.dtheta,thetaunit:p.thetaunit,text:p.text,texttemplate:b({editType:"plot"},{keys:["r","theta","text"]}),hovertext:p.hovertext,hovertemplate:p.hovertemplate,line:g.line,connectgaps:g.connectgaps,marker:g.marker,fill:g.fill,fillcolor:g.fillcolor,textposition:g.textposition,textfont:g.textfont,hoverinfo:p.hoverinfo,selected:p.selected,unselected:p.unselected}},{"../../plots/template_attributes":642,"../scattergl/attributes":988,"../scatterpolar/attributes":1011}],1019:[function(v,J,Z){J.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:v("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),hoverPoints:v("./hover").hoverPoints,selectPoints:v("../scattergl/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scattergl/select":1001,"./attributes":1018,"./calc":1020,"./defaults":1021,"./format_labels":1022,"./hover":1023}],1020:[function(v,J,Z){var p=v("../scatter/colorscale_calc"),g=v("../scatter/calc").calcMarkerSize,b=v("../scattergl/convert"),y=v("../../plots/cartesian/axes"),e=v("../scattergl/constants").TOO_MANY_POINTS;J.exports=function(n,t){var a=n._fullLayout,r=t.subplot,m=a[r].radialaxis,o=a[r].angularaxis,i=t._r=m.makeCalcdata(t,"r"),u=t._theta=o.makeCalcdata(t,"theta"),f=t._length,l={};f<i.length&&(i=i.slice(0,f)),f<u.length&&(u=u.slice(0,f)),l.r=i,l.theta=u,p(n,t);var h,d=l.opts=b.style(n,t);return f<e?h=g(t,f):d.marker&&(h=2*(d.marker.sizeAvg||Math.max(d.marker.size,3))),t._extremes.x=y.findExtremes(m,i,{ppad:h}),[{x:!1,y:!1,t:l,trace:t}]}},{"../../plots/cartesian/axes":566,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992}],1021:[function(v,J,Z){var p=v("../../lib"),g=v("../scatter/subtypes"),b=v("../scatterpolar/defaults").handleRThetaDefaults,y=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),n=v("../scatter/text_defaults"),t=v("../scatter/fillcolor_defaults"),a=v("../scatter/constants").PTS_LINESONLY,r=v("./attributes");J.exports=function(m,o,i,u){function f(h,d){return p.coerce(m,o,r,h,d)}var l=b(m,o,u,f);l?(f("thetaunit"),f("mode",l<a?"lines+markers":"lines"),f("text"),f("hovertext"),o.hoveron!=="fills"&&f("hovertemplate"),g.hasLines(o)&&(e(m,o,i,u,f),f("connectgaps")),g.hasMarkers(o)&&y(m,o,i,u,f),g.hasText(o)&&(f("texttemplate"),n(m,o,u,f)),f("fill"),o.fill!=="none"&&t(m,o,i,f),p.coerceSelectionMarkerOpacity(o,f)):o.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatterpolar/defaults":1013,"./attributes":1018}],1022:[function(v,J,Z){var p=v("../scatterpolar/format_labels");J.exports=function(g,b,y){var e=g.i;return"r"in g||(g.r=b._r[e]),"theta"in g||(g.theta=b._theta[e]),p(g,b,y)}},{"../scatterpolar/format_labels":1014}],1023:[function(v,J,Z){var p=v("../scattergl/hover"),g=v("../scatterpolar/hover").makeHoverPointText;J.exports={hoverPoints:function(b,y,e,n){var t=b.cd[0].t,a=t.r,r=t.theta,m=p.hoverPoints(b,y,e,n);if(m&&m[0].index!==!1){var o=m[0];if(o.index===void 0)return m;var i=b.subplot,u=o.cd[o.index],f=o.trace;if(u.r=a[o.index],u.theta=r[o.index],i.isPtInside(u))return o.xLabelVal=void 0,o.yLabelVal=void 0,g(u,f,i,o),m}}}},{"../scattergl/hover":997,"../scatterpolar/hover":1015}],1024:[function(v,J,Z){arguments[4][905][0].apply(Z,arguments)},{"./base_index":1019,"./plot":1025,dup:905}],1025:[function(v,J,Z){var p=v("@plotly/point-cluster"),g=v("fast-isnumeric"),b=v("../scattergl/plot"),y=v("../scattergl/scene_update"),e=v("../scattergl/convert"),n=v("../../lib"),t=v("../scattergl/constants").TOO_MANY_POINTS;J.exports=function(a,r,m){if(m.length){var o=r.radialAxis,i=r.angularAxis,u=y(a,r);return m.forEach(function(f){if(f&&f[0]&&f[0].trace){var l,h=f[0],d=h.trace,s=h.t,x=d._length,c=s.r,T=s.theta,_=s.opts,w=c.slice(),k=T.slice();for(l=0;l<c.length;l++)r.isPtInside({r:c[l],theta:T[l]})||(w[l]=NaN,k[l]=NaN);var L=new Array(2*x),A=Array(x),I=Array(x);for(l=0;l<x;l++){var P,S,E=w[l];if(g(E)){var D=o.c2g(E),R=i.c2g(k[l],d.thetaunit);P=D*Math.cos(R),S=D*Math.sin(R)}else P=S=NaN;A[l]=L[2*l]=P,I[l]=L[2*l+1]=S}s.tree=p(L),_.marker&&x>=t&&(_.marker.cluster=s.tree),_.marker&&(_.markerSel.positions=_.markerUnsel.positions=_.marker.positions=L),_.line&&L.length>1&&n.extendFlat(_.line,e.linePositions(a,d,L)),_.text&&(n.extendFlat(_.text,{positions:L},e.textPosition(a,d,_.text,_.marker)),n.extendFlat(_.textSel,{positions:L},e.textPosition(a,d,_.text,_.markerSel)),n.extendFlat(_.textUnsel,{positions:L},e.textPosition(a,d,_.text,_.markerUnsel))),_.fill&&!u.fill2d&&(u.fill2d=!0),_.marker&&!u.scatter2d&&(u.scatter2d=!0),_.line&&!u.line2d&&(u.line2d=!0),_.text&&!u.glText&&(u.glText=!0),u.lineOptions.push(_.line),u.fillOptions.push(_.fill),u.markerOptions.push(_.marker),u.markerSelectedOptions.push(_.markerSel),u.markerUnselectedOptions.push(_.markerUnsel),u.textOptions.push(_.text),u.textSelectedOptions.push(_.textSel),u.textUnselectedOptions.push(_.textUnsel),u.selectBatch.push([]),u.unselectBatch.push([]),s.x=A,s.y=I,s.rawx=A,s.rawy=I,s.r=c,s.theta=T,s.positions=L,s._scene=u,s.index=u.count,u.count++}}),b(a,r,m)}},J.exports.reglPrecompiled={}},{"../../lib":515,"../scattergl/constants":991,"../scattergl/convert":992,"../scattergl/plot":999,"../scattergl/scene_update":1e3,"@plotly/point-cluster":59,"fast-isnumeric":190}],1026:[function(v,J,Z){var p=v("../../plots/template_attributes").hovertemplateAttrs,g=v("../../plots/template_attributes").texttemplateAttrs,b=v("../../lib/extend").extendFlat,y=v("../scatter/attributes"),e=v("../../plots/attributes"),n=y.line;J.exports={mode:y.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:y.text,texttemplate:g({editType:"plot"},{keys:["real","imag","text"]}),hovertext:y.hovertext,line:{color:n.color,width:n.width,dash:n.dash,shape:b({},n.shape,{values:["linear","spline"]}),smoothing:n.smoothing,editType:"calc"},connectgaps:y.connectgaps,marker:y.marker,cliponaxis:b({},y.cliponaxis,{dflt:!1}),textposition:y.textposition,textfont:y.textfont,fill:b({},y.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:y.fillcolor,hoverinfo:b({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:y.hoveron,hovertemplate:p(),selected:y.selected,unselected:y.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1027:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../../constants/numerical").BADNUM,b=v("../scatter/colorscale_calc"),y=v("../scatter/arrays_to_calcdata"),e=v("../scatter/calc_selection"),n=v("../scatter/calc").calcMarkerSize;J.exports=function(t,a){for(var r=t._fullLayout,m=a.subplot,o=r[m].realaxis,i=r[m].imaginaryaxis,u=o.makeCalcdata(a,"real"),f=i.makeCalcdata(a,"imag"),l=a._length,h=new Array(l),d=0;d<l;d++){var s=u[d],x=f[d],c=h[d]={};p(s)&&p(x)?(c.real=s,c.imag=x):c.real=g}return n(a,l),b(t,a),y(h,a),e(h,a),h}},{"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1028:[function(v,J,Z){var p=v("../../lib"),g=v("../scatter/subtypes"),b=v("../scatter/marker_defaults"),y=v("../scatter/line_defaults"),e=v("../scatter/line_shape_defaults"),n=v("../scatter/text_defaults"),t=v("../scatter/fillcolor_defaults"),a=v("../scatter/constants").PTS_LINESONLY,r=v("./attributes");J.exports=function(m,o,i,u){function f(d,s){return p.coerce(m,o,r,d,s)}var l=function(d,s,x,c){var T,_=c("real"),w=c("imag");return _&&w&&(T=Math.min(_.length,w.length)),s._length=T,T}(0,o,0,f);if(l){f("mode",l<a?"lines+markers":"lines"),f("text"),f("hovertext"),o.hoveron!=="fills"&&f("hovertemplate"),g.hasLines(o)&&(y(m,o,i,u,f),e(m,o,f),f("connectgaps")),g.hasMarkers(o)&&b(m,o,i,u,f,{gradient:!0}),g.hasText(o)&&(f("texttemplate"),n(m,o,u,f));var h=[];(g.hasMarkers(o)||g.hasText(o))&&(f("cliponaxis"),f("marker.maxdisplayed"),h.push("points")),f("fill"),o.fill!=="none"&&(t(m,o,i,f),g.hasLines(o)||e(m,o,f)),o.fill!=="tonext"&&o.fill!=="toself"||h.push("fills"),f("hoveron",h.join("+")||"points"),p.coerceSelectionMarkerOpacity(o,f)}else o.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1026}],1029:[function(v,J,Z){var p=v("../../plots/cartesian/axes");J.exports=function(g,b,y){var e={},n=y[b.subplot]._subplot;return e.realLabel=p.tickText(n.radialAxis,g.real,!0).text,e.imagLabel=p.tickText(n.angularAxis,g.imag,!0).text,e}},{"../../plots/cartesian/axes":566}],1030:[function(v,J,Z){var p=v("../scatter/hover");function g(b,y,e,n){var t=e.radialAxis,a=e.angularAxis;t._hovertitle="real",a._hovertitle="imag";var r={};r[y.subplot]={_subplot:e};var m=y._module.formatLabels(b,y,r);n.realLabel=m.realLabel,n.imagLabel=m.imagLabel;var o=b.hi||y.hoverinfo,i=[];function u(l,h){i.push(l._hovertitle+": "+h)}if(!y.hovertemplate){var f=o.split("+");f.indexOf("all")!==-1&&(f=["real","imag","text"]),f.indexOf("real")!==-1&&u(t,n.realLabel),f.indexOf("imag")!==-1&&u(a,n.imagLabel),f.indexOf("text")!==-1&&n.text&&(i.push(n.text),delete n.text),n.extraText=i.join("<br>")}}J.exports={hoverPoints:function(b,y,e,n){var t=p(b,y,e,n);if(t&&t[0].index!==!1){var a=t[0];if(a.index===void 0)return t;var r=b.subplot,m=a.cd[a.index],o=a.trace;if(r.isPtInside(m))return a.xLabelVal=void 0,a.yLabelVal=void 0,g(m,o,r,a),a.hovertemplate=o.hovertemplate,t}},makeHoverPointText:g}},{"../scatter/hover":947}],1031:[function(v,J,Z){J.exports={moduleType:"trace",name:"scattersmith",basePlotModule:v("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,selectPoints:v("../scatter/select"),meta:{}}},{"../../plots/smith":638,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1026,"./calc":1027,"./defaults":1028,"./format_labels":1029,"./hover":1030,"./plot":1032}],1032:[function(v,J,Z){var p=v("../scatter/plot"),g=v("../../constants/numerical").BADNUM,b=v("../../plots/smith/helpers").smith;J.exports=function(y,e,n){for(var t=e.layers.frontplot.select("g.scatterlayer"),a={xaxis:e.xaxis,yaxis:e.yaxis,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},r=0;r<n.length;r++)for(var m=n[r],o=0;o<m.length;o++){var i=m[o],u=i.real;if(u===g)i.x=i.y=g;else{var f=b([u,i.imag]);i.x=f[0],i.y=f[1]}}p(y,a,n,t)}},{"../../constants/numerical":491,"../../plots/smith/helpers":637,"../scatter/plot":957}],1033:[function(v,J,Z){var p=v("../../plots/template_attributes").hovertemplateAttrs,g=v("../../plots/template_attributes").texttemplateAttrs,b=v("../scatter/attributes"),y=v("../../plots/attributes"),e=v("../../components/colorscale/attributes"),n=v("../../components/drawing/attributes").dash,t=v("../../lib/extend").extendFlat,a=b.marker,r=b.line,m=a.line;J.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:t({},b.mode,{dflt:"markers"}),text:t({},b.text,{}),texttemplate:g({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:t({},b.hovertext,{}),line:{color:r.color,width:r.width,dash:n,shape:t({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:b.connectgaps,cliponaxis:b.cliponaxis,fill:t({},b.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:b.fillcolor,marker:t({symbol:a.symbol,opacity:a.opacity,maxdisplayed:a.maxdisplayed,size:a.size,sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode,line:t({width:m.width,editType:"calc"},e("marker.line")),gradient:a.gradient,editType:"calc"},e("marker")),textfont:b.textfont,textposition:b.textposition,selected:b.selected,unselected:b.unselected,hoverinfo:t({},y.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:b.hoveron,hovertemplate:p()}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1034:[function(v,J,Z){var p=v("fast-isnumeric"),g=v("../scatter/colorscale_calc"),b=v("../scatter/arrays_to_calcdata"),y=v("../scatter/calc_selection"),e=v("../scatter/calc").calcMarkerSize,n=["a","b","c"],t={a:["b","c"],b:["a","c"],c:["a","b"]};J.exports=function(a,r){var m,o,i,u,f,l,h=a._fullLayout[r.subplot].sum,d=r.sum||h,s={a:r.a,b:r.b,c:r.c};for(m=0;m<n.length;m++)if(!s[i=n[m]]){for(f=s[t[i][0]],l=s[t[i][1]],u=new Array(f.length),o=0;o<f.length;o++)u[o]=d-f[o]-l[o];s[i]=u}var x,c,T,_,w,k,L=r._length,A=new Array(L);for(m=0;m<L;m++)x=s.a[m],c=s.b[m],T=s.c[m],p(x)&&p(c)&&p(T)?((_=h/((x=+x)+(c=+c)+(T=+T)))!==1&&(x*=_,c*=_,T*=_),k=x,w=T-c,A[m]={x:w,y:k,a:x,b:c,c:T}):A[m]={x:!1,y:!1};return e(r,L),g(a,r),b(A,r),y(A,r),A}},{"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1035:[function(v,J,Z){var p=v("../../lib"),g=v("../scatter/constants"),b=v("../scatter/subtypes"),y=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),n=v("../scatter/line_shape_defaults"),t=v("../scatter/text_defaults"),a=v("../scatter/fillcolor_defaults"),r=v("./attributes");J.exports=function(m,o,i,u){function f(c,T){return p.coerce(m,o,r,c,T)}var l,h=f("a"),d=f("b"),s=f("c");if(h?(l=h.length,d?(l=Math.min(l,d.length),s&&(l=Math.min(l,s.length))):l=s?Math.min(l,s.length):0):d&&s&&(l=Math.min(d.length,s.length)),l){o._length=l,f("sum"),f("text"),f("hovertext"),o.hoveron!=="fills"&&f("hovertemplate"),f("mode",l<g.PTS_LINESONLY?"lines+markers":"lines"),b.hasLines(o)&&(e(m,o,i,u,f),n(m,o,f),f("connectgaps")),b.hasMarkers(o)&&y(m,o,i,u,f,{gradient:!0}),b.hasText(o)&&(f("texttemplate"),t(m,o,u,f));var x=[];(b.hasMarkers(o)||b.hasText(o))&&(f("cliponaxis"),f("marker.maxdisplayed"),x.push("points")),f("fill"),o.fill!=="none"&&(a(m,o,i,f),b.hasLines(o)||n(m,o,f)),o.fill!=="tonext"&&o.fill!=="toself"||x.push("fills"),f("hoveron",x.join("+")||"points"),p.coerceSelectionMarkerOpacity(o,f)}else o.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1033}],1036:[function(v,J,Z){J.exports=function(p,g,b,y,e){if(g.xa&&(p.xaxis=g.xa),g.ya&&(p.yaxis=g.ya),y[e]){var n=y[e];p.a=n.a,p.b=n.b,p.c=n.c}else p.a=g.a,p.b=g.b,p.c=g.c;return p}},{}],1037:[function(v,J,Z){var p=v("../../plots/cartesian/axes");J.exports=function(g,b,y){var e={},n=y[b.subplot]._subplot;return e.aLabel=p.tickText(n.aaxis,g.a,!0).text,e.bLabel=p.tickText(n.baxis,g.b,!0).text,e.cLabel=p.tickText(n.caxis,g.c,!0).text,e}},{"../../plots/cartesian/axes":566}],1038:[function(v,J,Z){var p=v("../scatter/hover");J.exports=function(g,b,y,e){var n=p(g,b,y,e);if(n&&n[0].index!==!1){var t=n[0];if(t.index===void 0){var a=1-t.y0/g.ya._length,r=g.xa._length,m=r*a/2,o=r-m;return t.x0=Math.max(Math.min(t.x0,o),m),t.x1=Math.max(Math.min(t.x1,o),m),n}var i=t.cd[t.index],u=t.trace,f=t.subplot;t.a=i.a,t.b=i.b,t.c=i.c,t.xLabelVal=void 0,t.yLabelVal=void 0;var l={};l[u.subplot]={_subplot:f};var h=u._module.formatLabels(i,u,l);t.aLabel=h.aLabel,t.bLabel=h.bLabel,t.cLabel=h.cLabel;var d=i.hi||u.hoverinfo,s=[];if(!u.hovertemplate){var x=d.split("+");x.indexOf("all")!==-1&&(x=["a","b","c"]),x.indexOf("a")!==-1&&c(f.aaxis,t.aLabel),x.indexOf("b")!==-1&&c(f.baxis,t.bLabel),x.indexOf("c")!==-1&&c(f.caxis,t.cLabel)}return t.extraText=s.join("<br>"),t.hovertemplate=u.hovertemplate,n}function c(T,_){s.push(T._hovertitle+": "+_)}}},{"../scatter/hover":947}],1039:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../scatter/select"),eventData:v("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:v("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":643,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1033,"./calc":1034,"./defaults":1035,"./event_data":1036,"./format_labels":1037,"./hover":1038,"./plot":1040}],1040:[function(v,J,Z){var p=v("../scatter/plot");J.exports=function(g,b,y){var e=b.plotContainer;e.select(".scatterlayer").selectAll("*").remove();var n={xaxis:b.xaxis,yaxis:b.yaxis,plot:e,layerClipId:b._hasClipOnAxisFalse?b.clipIdRelative:null},t=b.layers.frontplot.select("g.scatterlayer");p(g,n,y,t)}},{"../scatter/plot":957}],1041:[function(v,J,Z){var p=v("../scatter/attributes"),g=v("../../components/colorscale/attributes"),b=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../scattergl/attributes"),n=v("../../plots/cartesian/constants").idRegex,t=v("../../plot_api/plot_template").templatedArray,a=v("../../lib/extend").extendFlat,r=p.marker,m=r.line,o=a(g("marker.line",{editTypeOverride:"calc"}),{width:a({},m.width,{editType:"calc"}),editType:"calc"}),i=a(g("marker"),{symbol:r.symbol,size:a({},r.size,{editType:"markerSize"}),sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,opacity:r.opacity,colorbar:r.colorbar,line:o,editType:"calc"});function u(f){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:n[f],editType:"plot"}}}i.color.editType=i.cmin.editType=i.cmax.editType="style",J.exports={dimensions:t("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:a({},e.text,{}),hovertext:a({},e.hovertext,{}),hovertemplate:y(),xhoverformat:b("x"),yhoverformat:b("y"),marker:i,xaxes:u("x"),yaxes:u("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/constants":573,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergl/attributes":988}],1042:[function(v,J,Z){var p=v("../../registry"),g=v("../../components/grid");J.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),calc:v("./calc"),plot:v("./plot"),hoverPoints:v("./hover").hoverPoints,selectPoints:v("./select"),editStyle:v("./edit_style"),meta:{}},p.register(g)},{"../../components/grid":411,"../../registry":647,"../scatter/marker_colorbar":954,"./attributes":1041,"./calc":1044,"./defaults":1045,"./edit_style":1046,"./hover":1048,"./plot":1050,"./select":1052}],1043:[function(v,J,Z){var p=v("regl-line2d"),g=v("../../registry"),b=v("../../lib/prepare_regl"),y=v("../../plots/get_data").getModuleCalcData,e=v("../../plots/cartesian"),n=v("../../plots/cartesian/axis_ids").getFromId,t=v("../../plots/cartesian/axes").shouldShowZeroLine,a={};function r(o,i,u){for(var f=u.matrixOptions.data.length,l=i._visibleDims,h=u.viewOpts.ranges=new Array(f),d=0;d<l.length;d++){var s=l[d],x=h[d]=new Array(4),c=n(o,i._diag[s][0]);c&&(x[0]=c.r2l(c.range[0]),x[2]=c.r2l(c.range[1]));var T=n(o,i._diag[s][1]);T&&(x[1]=T.r2l(T.range[0]),x[3]=T.r2l(T.range[1]))}u.selectBatch.length||u.unselectBatch.length?u.matrix.update({ranges:h},{ranges:h}):u.matrix.update({ranges:h})}function m(o){var i=o._fullLayout,u=i._glcanvas.data()[0].regl,f=i._splomGrid;f||(f=i._splomGrid=p(u)),f.update(function(l){var h,d=l._context.plotGlPixelRatio,s=l._fullLayout,x=s._size,c=[0,0,s.width*d,s.height*d],T={};function _(G,W,te,N,B,U){te*=d,N*=d,B*=d,U*=d;var ee=W[G+"color"],j=W[G+"width"],Q=String(ee+j);Q in T?T[Q].data.push(NaN,NaN,te,N,B,U):T[Q]={data:[te,N,B,U],join:"rect",thickness:j*d,color:ee,viewport:c,range:c,overlay:!1}}for(h in s._splomSubplots){var w,k,L=s._plots[h],A=L.xaxis,I=L.yaxis,P=A._gridVals,S=I._gridVals,E=A._offset,D=A._length,R=I._length,H=x.b+I.domain[0]*x.h,V=-I._m,X=-V*I.r2l(I.range[0],I.calendar);if(A.showgrid)for(h=0;h<P.length;h++)w=E+A.l2p(P[h].x),_("grid",A,w,H,w,H+R);if(I.showgrid)for(h=0;h<S.length;h++)k=H+X+V*S[h].x,_("grid",I,E,k,E+D,k);t(l,A,I)&&(w=E+A.l2p(0),_("zeroline",A,w,H,w,H+R)),t(l,I,A)&&_("zeroline",I,E,k=H+X+0,E+D,k)}var $=[];for(h in T)$.push(T[h]);return $}(o))}J.exports={name:"splom",attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:function(o){var i=o._fullLayout,u=g.getModule("splom"),f=y(o.calcdata,u)[0];b(o,["ANGLE_instanced_arrays","OES_element_index_uint"],a)&&(i._hasOnlyLargeSploms&&m(o),u.plot(o,{},f))},drag:function(o){var i=o.calcdata,u=o._fullLayout;u._hasOnlyLargeSploms&&m(o);for(var f=0;f<i.length;f++){var l=i[f][0].trace,h=u._splomScenes[l.uid];l.type==="splom"&&h&&h.matrix&&r(o,l,h)}},updateGrid:m,clean:function(o,i,u,f){var l,h={};if(f._splomScenes){for(l=0;l<o.length;l++){var d=o[l];d.type==="splom"&&(h[d.uid]=1)}for(l=0;l<u.length;l++){var s=u[l];if(!h[s.uid]){var x=f._splomScenes[s.uid];x&&x.destroy&&x.destroy(),f._splomScenes[s.uid]=null,delete f._splomScenes[s.uid]}}}Object.keys(f._splomScenes||{}).length===0&&delete f._splomScenes,f._splomGrid&&!i._hasOnlyLargeSploms&&f._hasOnlyLargeSploms&&(f._splomGrid.destroy(),f._splomGrid=null,delete f._splomGrid),e.clean(o,i,u,f)},updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:a}},{"../../lib/prepare_regl":528,"../../plots/cartesian":578,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../../plots/get_data":602,"../../registry":647,"regl-line2d":281}],1044:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axis_ids"),b=v("../scatter/calc").calcMarkerSize,y=v("../scatter/calc").calcAxisExpansion,e=v("../scatter/colorscale_calc"),n=v("../scattergl/convert").markerSelection,t=v("../scattergl/convert").markerStyle,a=v("./scene_update"),r=v("../../constants/numerical").BADNUM,m=v("../scattergl/constants").TOO_MANY_POINTS;J.exports=function(o,i){var u,f,l,h,d,s,x=i.dimensions,c=i._length,T={},_=T.cdata=[],w=T.data=[],k=i._visibleDims=[];function L(I,P){for(var S=I.makeCalcdata({v:P.values,vcalendar:i.calendar},"v"),E=0;E<S.length;E++)S[E]=S[E]===r?NaN:S[E];_.push(S),w.push(I.type==="log"?p.simpleMap(S,I.c2l):S)}for(u=0;u<x.length;u++)if((l=x[u]).visible){if(h=g.getFromId(o,i._diag[u][0]),d=g.getFromId(o,i._diag[u][1]),h&&d&&h.type!==d.type){p.log("Skipping splom dimension "+u+" with conflicting axis types");continue}h?(L(h,l),d&&d.type==="category"&&(d._categories=h._categories.slice())):L(d,l),k.push(u)}for(e(o,i),p.extendFlat(T,t(i)),s=_.length*c>m?T.sizeAvg||Math.max(T.size,3):b(i,c),f=0;f<k.length;f++)l=x[u=k[f]],h=g.getFromId(o,i._diag[u][0])||{},d=g.getFromId(o,i._diag[u][1])||{},y(o,i,h,d,_[f],_[f],s);var A=a(o,i);return A.matrix||(A.matrix=!0),A.matrixOptions=T,A.selectedOptions=n(i,i.selected),A.unselectedOptions=n(i,i.unselected),[{x:!1,y:!1,t:{},trace:i}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992,"./scene_update":1051}],1045:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/array_container_defaults"),b=v("./attributes"),y=v("../scatter/subtypes"),e=v("../scatter/marker_defaults"),n=v("../parcoords/merge_length"),t=v("../scattergl/helpers").isOpenSymbol;function a(r,m){function o(u,f){return p.coerce(r,m,b.dimensions,u,f)}o("label");var i=o("values");i&&i.length?o("visible"):m.visible=!1,o("axis.type"),o("axis.matches")}J.exports=function(r,m,o,i){function u(c,T){return p.coerce(r,m,b,c,T)}var f=g(r,m,{name:"dimensions",handleItemDefaults:a}),l=u("diagonal.visible"),h=u("showupperhalf"),d=u("showlowerhalf");if(n(m,f,"values")&&(l||h||d)){u("text"),u("hovertext"),u("hovertemplate"),u("xhoverformat"),u("yhoverformat"),e(r,m,o,i,u);var s=t(m.marker.symbol),x=y.isBubble(m);u("marker.line.width",s||x?1:0),function(c,T,_,w){var k,L,A=T.dimensions,I=A.length,P=T.showupperhalf,S=T.showlowerhalf,E=T.diagonal.visible,D=new Array(I),R=new Array(I);for(k=0;k<I;k++){var H=k?k+1:"";D[k]="x"+H,R[k]="y"+H}var V=w("xaxes",D),X=w("yaxes",R),$=T._diag=new Array(I);T._xaxes={},T._yaxes={};var G=[],W=[];function te(ne,le,oe,de){if(ne){var se=ne.charAt(0),me=_._splomAxes[se];if(T["_"+se+"axes"][ne]=1,de.push(ne),!(ne in me)){var Te=me[ne]={};oe&&(Te.label=oe.label||"",oe.visible&&oe.axis&&(oe.axis.type&&(Te.type=oe.axis.type),oe.axis.matches&&(Te.matches=le)))}}}var N=!E&&!S,B=!E&&!P;for(T._axesDim={},k=0;k<I;k++){var U=A[k],ee=k===0,j=k===I-1,Q=ee&&N||j&&B?void 0:V[k],K=ee&&B||j&&N?void 0:X[k];te(Q,K,U,G),te(K,Q,U,W),$[k]=[Q,K],T._axesDim[Q]=k,T._axesDim[K]=k}for(k=0;k<G.length;k++)for(L=0;L<W.length;L++){var re=G[k]+W[L];k>L&&P||k<L&&S?_._splomSubplots[re]=1:k!==L||!E&&S&&P||(_._splomSubplots[re]=1)}(!S||!E&&P&&S)&&(_._splomGridDflt.xside="bottom",_._splomGridDflt.yside="left")}(0,m,i,u),p.coerceSelectionMarkerOpacity(m,u)}else m.visible=!1}},{"../../lib":515,"../../plots/array_container_defaults":561,"../parcoords/merge_length":907,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scattergl/helpers":996,"./attributes":1041}],1046:[function(v,J,Z){var p=v("../../lib"),g=v("../scatter/colorscale_calc"),b=v("../scattergl/convert").markerStyle;J.exports=function(y,e){var n=e.trace,t=y._fullLayout._splomScenes[n.uid];if(t){g(y,n),p.extendFlat(t.matrixOptions,b(n));var a=p.extendFlat({},t.matrixOptions,t.viewOpts);t.matrix.update(a,null)}}},{"../../lib":515,"../scatter/colorscale_calc":939,"../scattergl/convert":992}],1047:[function(v,J,Z){Z.getDimIndex=function(p,g){for(var b=g._id,y={x:0,y:1}[b.charAt(0)],e=p._visibleDims,n=0;n<e.length;n++){var t=e[n];if(p._diag[t][y]===b)return n}return!1}},{}],1048:[function(v,J,Z){var p=v("./helpers"),g=v("../scattergl/hover").calcHover;J.exports={hoverPoints:function(b,y,e){var n=b.cd[0].trace,t=b.scene.matrixOptions.cdata,a=b.xa,r=b.ya,m=a.c2p(y),o=r.c2p(e),i=b.distance,u=p.getDimIndex(n,a),f=p.getDimIndex(n,r);if(u===!1||f===!1)return[b];for(var l,h,d=t[u],s=t[f],x=i,c=0;c<d.length;c++){var T=d[c],_=s[c],w=a.c2p(T)-m,k=r.c2p(_)-o,L=Math.sqrt(w*w+k*k);L<x&&(x=h=L,l=c)}return b.index=l,b.distance=x,b.dxy=h,l===void 0?[b]:[g(b,d,s,n)]}}},{"../scattergl/hover":997,"./helpers":1047}],1049:[function(v,J,Z){var p=v("./base_index");p.basePlotModule=v("./base_plot"),J.exports=p},{"./base_index":1042,"./base_plot":1043}],1050:[function(v,J,Z){var p=v("regl-splom"),g=v("../../lib"),b=v("../../plots/cartesian/axis_ids"),y=v("../../components/dragelement/helpers").selectMode;function e(n,t){var a,r,m,o,i,u=n._fullLayout,f=u._size,l=t.trace,h=t.t,d=u._splomScenes[l.uid],s=d.matrixOptions,x=s.cdata,c=u._glcanvas.data()[0].regl,T=u.dragmode;if(x.length!==0){s.lower=l.showupperhalf,s.upper=l.showlowerhalf,s.diagonal=l.diagonal.visible;var _=l._visibleDims,w=x.length,k=d.viewOpts={};for(k.ranges=new Array(w),k.domains=new Array(w),i=0;i<_.length;i++){m=_[i];var L=k.ranges[i]=new Array(4),A=k.domains[i]=new Array(4);(a=b.getFromId(n,l._diag[m][0]))&&(L[0]=a._rl[0],L[2]=a._rl[1],A[0]=a.domain[0],A[2]=a.domain[1]),(r=b.getFromId(n,l._diag[m][1]))&&(L[1]=r._rl[0],L[3]=r._rl[1],A[1]=r.domain[0],A[3]=r.domain[1])}var I=n._context.plotGlPixelRatio,P=f.l*I,S=f.b*I,E=f.w*I,D=f.h*I;k.viewport=[P,S,E+P,D+S],d.matrix===!0&&(d.matrix=p(c));var R=u.clickmode.indexOf("select")>-1,H=!0;if(y(T)||!!l.selectedpoints||R){var V=l._length;if(l.selectedpoints){d.selectBatch=l.selectedpoints;var X=l.selectedpoints,$={};for(m=0;m<X.length;m++)$[X[m]]=!0;var G=[];for(m=0;m<V;m++)$[m]||G.push(m);d.unselectBatch=G}var W=h.xpx=new Array(w),te=h.ypx=new Array(w);for(i=0;i<_.length;i++){if(m=_[i],a=b.getFromId(n,l._diag[m][0]))for(W[i]=new Array(V),o=0;o<V;o++)W[i][o]=a.c2p(x[i][o]);if(r=b.getFromId(n,l._diag[m][1]))for(te[i]=new Array(V),o=0;o<V;o++)te[i][o]=r.c2p(x[i][o])}if(d.selectBatch.length||d.unselectBatch.length){var N=g.extendFlat({},s,d.unselectedOptions,k),B=g.extendFlat({},s,d.selectedOptions,k);d.matrix.update(N,B),H=!1}}else h.xpx=h.ypx=null;if(H){var U=g.extendFlat({},s,k);d.matrix.update(U,null)}}}J.exports=function(n,t,a){if(a.length)for(var r=0;r<a.length;r++)e(n,a[r][0])}},{"../../components/dragelement/helpers":385,"../../lib":515,"../../plots/cartesian/axis_ids":570,"regl-splom":283}],1051:[function(v,J,Z){var p=v("../../lib");J.exports=function(g,b){var y=g._fullLayout,e=b.uid,n=y._splomScenes;n||(n=y._splomScenes={});var t={dirty:!0,selectBatch:[],unselectBatch:[]},a=n[b.uid];return a||((a=n[e]=p.extendFlat({},t,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){a.matrix&&a.matrix.draw&&(a.selectBatch.length||a.unselectBatch.length?a.matrix.draw(a.unselectBatch,a.selectBatch):a.matrix.draw()),a.dirty=!1},a.destroy=function(){a.matrix&&a.matrix.destroy&&a.matrix.destroy(),a.matrixOptions=null,a.selectBatch=null,a.unselectBatch=null,a=null}),a.dirty||p.extendFlat(a,t),a}},{"../../lib":515}],1052:[function(v,J,Z){var p=v("../../lib"),g=p.pushUnique,b=v("../scatter/subtypes"),y=v("./helpers");J.exports=function(e,n){var t=e.cd,a=t[0].trace,r=t[0].t,m=e.scene,o=m.matrixOptions.cdata,i=e.xaxis,u=e.yaxis,f=[];if(!m)return f;var l=!b.hasMarkers(a)&&!b.hasText(a);if(a.visible!==!0||l)return f;var h=y.getDimIndex(a,i),d=y.getDimIndex(a,u);if(h===!1||d===!1)return f;var s=r.xpx[h],x=r.ypx[d],c=o[h],T=o[d],_=(e.scene.selectBatch||[]).slice(),w=[];if(n!==!1&&!n.degenerate)for(var k=0;k<c.length;k++)n.contains([s[k],x[k]],null,k,e)?(f.push({pointNumber:k,x:c[k],y:T[k]}),g(_,k)):_.indexOf(k)!==-1?g(_,k):w.push(k);var L=m.matrixOptions;return _.length||w.length?m.selectBatch.length||m.unselectBatch.length||m.matrix.update(m.unselectedOptions,p.extendFlat({},L,m.selectedOptions,m.viewOpts)):m.matrix.update(L,null),m.selectBatch=_,m.unselectBatch=w,f}},{"../../lib":515,"../scatter/subtypes":961,"./helpers":1047}],1053:[function(v,J,Z){var p=v("../../components/colorscale/attributes"),g=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,b=v("../../plots/template_attributes").hovertemplateAttrs,y=v("../mesh3d/attributes"),e=v("../../plots/attributes"),n=v("../../lib/extend").extendFlat,t={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:b({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:g("u",1),vhoverformat:g("v",1),whoverformat:g("w",1),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),showlegend:n({},e.showlegend,{dflt:!1})};n(t,p("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){t[a]=y[a]}),t.hoverinfo=n({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),t.transforms=void 0,J.exports=t},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],1054:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/colorscale/calc");function b(n){var t,a,r,m,o,i,u,f,l,h,d,s,x=n._x,c=n._y,T=n._z,_=n._len,w=-1/0,k=1/0,L=-1/0,A=1/0,I=-1/0,P=1/0,S="";for(_&&(u=x[0],l=c[0],d=T[0]),_>1&&(f=x[_-1],h=c[_-1],s=T[_-1]),t=0;t<_;t++)w=Math.max(w,x[t]),k=Math.min(k,x[t]),L=Math.max(L,c[t]),A=Math.min(A,c[t]),I=Math.max(I,T[t]),P=Math.min(P,T[t]),m||x[t]===u||(m=!0,S+="x"),o||c[t]===l||(o=!0,S+="y"),i||T[t]===d||(i=!0,S+="z");m||(S+="x"),o||(S+="y"),i||(S+="z");var E=y(n._x),D=y(n._y),R=y(n._z);S=(S=(S=S.replace("x",(u>f?"-":"+")+"x")).replace("y",(l>h?"-":"+")+"y")).replace("z",(d>s?"-":"+")+"z");var H=function(){_=0,E=[],D=[],R=[]};(!_||_<E.length*D.length*R.length)&&H();var V=function(se){return se==="x"?x:se==="y"?c:T},X=function(se){return se==="x"?E:se==="y"?D:R},$=function(se){return se[_-1]<se[0]?-1:1},G=V(S[1]),W=V(S[3]),te=V(S[5]),N=X(S[1]).length,B=X(S[3]).length,U=X(S[5]).length,ee=!1,j=function(se,me,Te){return N*(B*se+me)+Te},Q=$(V(S[1])),K=$(V(S[3])),re=$(V(S[5]));for(t=0;t<U-1;t++){for(a=0;a<B-1;a++){for(r=0;r<N-1;r++){var ne=j(t,a,r),le=j(t,a,r+1),oe=j(t,a+1,r),de=j(t+1,a,r);if(G[ne]*Q<G[le]*Q&&W[ne]*K<W[oe]*K&&te[ne]*re<te[de]*re||(ee=!0),ee)break}if(ee)break}if(ee)break}return ee&&(p.warn("Encountered arbitrary coordinates! Unable to input data grid."),H()),{xMin:k,yMin:A,zMin:P,xMax:w,yMax:L,zMax:I,Xs:E,Ys:D,Zs:R,len:_,fill:S}}function y(n){return p.distinctVals(n).vals}function e(n,t){if(t===void 0&&(t=n.length),p.isTypedArray(n))return n.subarray(0,t);for(var a=[],r=0;r<t;r++)a[r]=+n[r];return a}J.exports={calc:function(n,t){t._len=Math.min(t.u.length,t.v.length,t.w.length,t.x.length,t.y.length,t.z.length),t._u=e(t.u,t._len),t._v=e(t.v,t._len),t._w=e(t.w,t._len),t._x=e(t.x,t._len),t._y=e(t.y,t._len),t._z=e(t.z,t._len);var a=b(t);t._gridFill=a.fill,t._Xs=a.Xs,t._Ys=a.Ys,t._Zs=a.Zs,t._len=a.len;var r,m,o,i=0;t.starts&&(r=e(t.starts.x||[]),m=e(t.starts.y||[]),o=e(t.starts.z||[]),i=Math.min(r.length,m.length,o.length)),t._startsX=r||[],t._startsY=m||[],t._startsZ=o||[];var u,f=0,l=1/0;for(u=0;u<t._len;u++){var h=t._u[u],d=t._v[u],s=t._w[u],x=Math.sqrt(h*h+d*d+s*s);f=Math.max(f,x),l=Math.min(l,x)}for(g(n,t,{vals:[l,f],containerStr:"",cLetter:"c"}),u=0;u<i;u++){var c=r[u];a.xMax=Math.max(a.xMax,c),a.xMin=Math.min(a.xMin,c);var T=m[u];a.yMax=Math.max(a.yMax,T),a.yMin=Math.min(a.yMin,T);var _=o[u];a.zMax=Math.max(a.zMax,_),a.zMin=Math.min(a.zMin,_)}t._slen=i,t._normMax=f,t._xbnds=[a.xMin,a.xMax],t._ybnds=[a.yMin,a.yMax],t._zbnds=[a.zMin,a.zMax]},filter:e,processGrid:b}},{"../../components/colorscale/calc":375,"../../lib":515}],1055:[function(v,J,Z){var p=v("../../../stackgl_modules").gl_streamtube3d,g=p.createTubeMesh,b=v("../../lib"),y=v("../../lib/gl_format_color").parseColorScale,e=v("../../components/colorscale").extractOpts,n=v("../../plots/gl3d/zip3"),t={xaxis:0,yaxis:1,zaxis:2};function a(u,f){this.scene=u,this.uid=f,this.mesh=null,this.data=null}var r=a.prototype;function m(u){var f=u.length;return f>2?u.slice(1,f-1):f===2?[(u[0]+u[1])/2]:u}function o(u){var f=u.length;return f===1?[.5,.5]:[u[1]-u[0],u[f-1]-u[f-2]]}function i(u,f){var l=u.fullSceneLayout,h=u.dataScale,d=f._len,s={};function x(N,B){var U=l[B],ee=h[t[B]];return b.simpleMap(N,function(j){return U.d2l(j)*ee})}if(s.vectors=n(x(f._u,"xaxis"),x(f._v,"yaxis"),x(f._w,"zaxis"),d),!d)return{positions:[],cells:[]};var c=x(f._Xs,"xaxis"),T=x(f._Ys,"yaxis"),_=x(f._Zs,"zaxis");if(s.meshgrid=[c,T,_],s.gridFill=f._gridFill,f._slen)s.startingPositions=n(x(f._startsX,"xaxis"),x(f._startsY,"yaxis"),x(f._startsZ,"zaxis"));else{for(var w=T[0],k=m(c),L=m(_),A=new Array(k.length*L.length),I=0,P=0;P<k.length;P++)for(var S=0;S<L.length;S++)A[I++]=[k[P],w,L[S]];s.startingPositions=A}s.colormap=y(f),s.tubeSize=f.sizeref,s.maxLength=f.maxdisplayed;var E=x(f._xbnds,"xaxis"),D=x(f._ybnds,"yaxis"),R=x(f._zbnds,"zaxis"),H=o(c),V=o(T),X=o(_),$=[[E[0]-H[0],D[0]-V[0],R[0]-X[0]],[E[1]+H[1],D[1]+V[1],R[1]+X[1]]],G=p(s,$),W=e(f);G.vertexIntensityBounds=[W.min/f._normMax,W.max/f._normMax];var te=f.lightposition;return G.lightPosition=[te.x,te.y,te.z],G.ambient=f.lighting.ambient,G.diffuse=f.lighting.diffuse,G.specular=f.lighting.specular,G.roughness=f.lighting.roughness,G.fresnel=f.lighting.fresnel,G.opacity=f.opacity,f._pad=G.tubeScale*f.sizeref*2,G}r.handlePick=function(u){var f=this.scene.fullSceneLayout,l=this.scene.dataScale;function h(x,c){var T=f[c],_=l[t[c]];return T.l2c(x)/_}if(u.object===this.mesh){var d=u.data.position,s=u.data.velocity;return u.traceCoordinate=[h(d[0],"xaxis"),h(d[1],"yaxis"),h(d[2],"zaxis"),h(s[0],"xaxis"),h(s[1],"yaxis"),h(s[2],"zaxis"),u.data.intensity*this.data._normMax,u.data.divergence],u.textLabel=this.data.hovertext||this.data.text,!0}},r.update=function(u){this.data=u;var f=i(this.scene,u);this.mesh.update(f)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},J.exports=function(u,f){var l=u.glplot.gl,h=i(u,f),d=g(l,h),s=new a(u,f.uid);return s.mesh=d,s.data=f,d._trace=s,u.glplot.add(d),s}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],1056:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/colorscale/defaults"),b=v("./attributes");J.exports=function(y,e,n,t){function a(l,h){return p.coerce(y,e,b,l,h)}var r=a("u"),m=a("v"),o=a("w"),i=a("x"),u=a("y"),f=a("z");r&&r.length&&m&&m.length&&o&&o.length&&i&&i.length&&u&&u.length&&f&&f.length?(a("starts.x"),a("starts.y"),a("starts.z"),a("maxdisplayed"),a("sizeref"),a("lighting.ambient"),a("lighting.diffuse"),a("lighting.specular"),a("lighting.roughness"),a("lighting.fresnel"),a("lightposition.x"),a("lightposition.y"),a("lightposition.z"),g(y,e,t,a,{prefix:"",cLetter:"c"}),a("text"),a("hovertext"),a("hovertemplate"),a("uhoverformat"),a("vhoverformat"),a("whoverformat"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":1053}],1057:[function(v,J,Z){J.exports={moduleType:"trace",name:"streamtube",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:v("./calc").calc,plot:v("./convert"),eventData:function(p,g){return p.tubex=p.x,p.tubey=p.y,p.tubez=p.z,p.tubeu=g.traceCoordinate[3],p.tubev=g.traceCoordinate[4],p.tubew=g.traceCoordinate[5],p.norm=g.traceCoordinate[6],p.divergence=g.traceCoordinate[7],delete p.x,delete p.y,delete p.z,p},meta:{}}},{"../../plots/gl3d":607,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(v,J,Z){var p=v("../../plots/attributes"),g=v("../../plots/template_attributes").hovertemplateAttrs,b=v("../../plots/template_attributes").texttemplateAttrs,y=v("../../components/colorscale/attributes"),e=v("../../plots/domain").attributes,n=v("../pie/attributes"),t=v("./constants"),a=v("../../lib/extend").extendFlat;J.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:a({colors:{valType:"data_array",editType:"calc"},line:{color:a({},n.marker.line.color,{dflt:null}),width:a({},n.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},y("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:n.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:b({editType:"plot"},{keys:t.eventDataKeys.concat(["label","value"])}),hovertext:n.hovertext,hoverinfo:a({},p.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:g({},{keys:t.eventDataKeys}),textfont:n.textfont,insidetextorientation:n.insidetextorientation,insidetextfont:n.insidetextfont,outsidetextfont:a({},n.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:n.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"./constants":1061}],1059:[function(v,J,Z){var p=v("../../plots/plots");Z.name="sunburst",Z.plot=function(g,b,y,e){p.plotBasePlot(Z.name,g,b,y,e)},Z.clean=function(g,b,y,e){p.cleanBasePlot(Z.name,g,b,y,e)}},{"../../plots/plots":628}],1060:[function(v,J,Z){var p=v("d3-hierarchy"),g=v("fast-isnumeric"),b=v("../../lib"),y=v("../../components/colorscale").makeColorScaleFuncFromTrace,e=v("../pie/calc").makePullColorFn,n=v("../pie/calc").generateExtendedColors,t=v("../../components/colorscale").calc,a=v("../../constants/numerical").ALMOST_EQUAL,r={},m={},o={};Z.calc=function(i,u){var f,l,h,d,s,x,c=i._fullLayout,T=u.ids,_=b.isArrayOrTypedArray(T),w=u.labels,k=u.parents,L=u.values,A=b.isArrayOrTypedArray(L),I=[],P={},S={},E=function(K){return K||typeof K=="number"},D=function(K){return!A||g(L[K])&&L[K]>=0};_?(f=Math.min(T.length,k.length),l=function(K){return E(T[K])&&D(K)},h=function(K){return String(T[K])}):(f=Math.min(w.length,k.length),l=function(K){return E(w[K])&&D(K)},h=function(K){return String(w[K])}),A&&(f=Math.min(f,L.length));for(var R=0;R<f;R++)if(l(R)){var H=h(R),V=E(k[R])?String(k[R]):"",X={i:R,id:H,pid:V,label:E(w[R])?String(w[R]):""};A&&(X.v=+L[R]),I.push(X),s=H,P[d=V]?P[d].push(s):P[d]=[s],S[s]=1}if(P[""]){if(P[""].length>1){for(var $=b.randstr(),G=0;G<I.length;G++)I[G].pid===""&&(I[G].pid=$);I.unshift({hasMultipleRoots:!0,id:$,pid:"",label:""})}}else{var W,te=[];for(W in P)S[W]||te.push(W);if(te.length!==1)return b.warn(["Multiple implied roots, cannot build",u.type,"hierarchy of",u.name+".","These roots include:",te.join(", ")].join(" "));W=te[0],I.unshift({hasImpliedRoot:!0,id:W,pid:"",label:W})}try{x=p.stratify().id(function(K){return K.id}).parentId(function(K){return K.pid})(I)}catch(K){return b.warn(["Failed to build",u.type,"hierarchy of",u.name+".","Error:",K.message].join(" "))}var N=p.hierarchy(x),B=!1;if(A)switch(u.branchvalues){case"remainder":N.sum(function(K){return K.data.v});break;case"total":N.each(function(K){var re=K.data.data,ne=re.v;if(K.children){var le=K.children.reduce(function(oe,de){return oe+de.data.data.v},0);if((re.hasImpliedRoot||re.hasMultipleRoots)&&(ne=le),ne<le*a)return B=!0,b.warn(["Total value for node",K.data.data.id,"of",u.name,"is smaller than the sum of its children.",`
parent value =`,ne,`
children sum =`,le].join(" "))}K.value=ne})}else(function K(re,ne,le){var oe=0,de=re.children;if(de){for(var se=de.length,me=0;me<se;me++)oe+=K(de[me],ne,le);le.branches&&oe++}else le.leaves&&oe++;return re.value=re.data.data.value=oe,ne._values||(ne._values=[]),ne._values[re.data.data.i]=oe,oe})(N,u,{branches:u.count.indexOf("branches")!==-1,leaves:u.count.indexOf("leaves")!==-1});if(!B){var U,ee;u.sort&&N.sort(function(K,re){return re.value-K.value});var j=u.marker.colors||[],Q=!!j.length;return u._hasColorscale?(Q||(j=A?u.values:u._values),t(i,u,{vals:j,containerStr:"marker",cLetter:"c"}),ee=y(u.marker)):U=e(c["_"+u.type+"colormap"]),N.each(function(K){var re=K.data.data;re.color=u._hasColorscale?ee(j[re.i]):U(j[re.i],re.id)}),I[0].hierarchy=N,I}},Z._runCrossTraceCalc=function(i,u){var f=u._fullLayout,l=u.calcdata,h=f[i+"colorway"],d=f["_"+i+"colormap"];f["extend"+i+"colors"]&&(h=n(h,i==="icicle"?o:i==="treemap"?m:r));var s,x=0;function c(w){var k=w.data.data,L=k.id;k.color===!1&&(d[L]?k.color=d[L]:w.parent?w.parent.parent?k.color=w.parent.data.data.color:(d[L]=k.color=h[x%h.length],x++):k.color=s)}for(var T=0;T<l.length;T++){var _=l[T][0];_.trace.type===i&&_.hierarchy&&(s=_.trace.root.color,_.hierarchy.each(c))}},Z.crossTraceCalc=function(i){return Z._runCrossTraceCalc("sunburst",i)}},{"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../pie/calc":912,"d3-hierarchy":115,"fast-isnumeric":190}],1061:[function(v,J,Z){J.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1062:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes"),b=v("../../plots/domain").defaults,y=v("../bar/defaults").handleText,e=v("../../components/colorscale"),n=e.hasColorscale,t=e.handleDefaults;J.exports=function(a,r,m,o){function i(s,x){return p.coerce(a,r,g,s,x)}var u=i("labels"),f=i("parents");if(u&&u.length&&f&&f.length){var l=i("values");l&&l.length?i("branchvalues"):i("count"),i("level"),i("maxdepth"),i("marker.line.width")&&i("marker.line.color",o.paper_bgcolor),i("marker.colors");var h=r._hasColorscale=n(a,"marker","colors")||(a.marker||{}).coloraxis;h&&t(a,r,o,i,{prefix:"marker.",cLetter:"c"}),i("leaf.opacity",h?1:.7);var d=i("text");i("texttemplate"),r.texttemplate||i("textinfo",Array.isArray(d)?"text+label":"label"),i("hovertext"),i("hovertemplate"),y(a,r,o,i,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),i("insidetextorientation"),i("sort"),i("rotation"),i("root.color"),b(r,o,i),r._length=null}else r.visible=!1}},{"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":1058}],1063:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../registry"),b=v("../../components/fx/helpers").appendArrayPointValue,y=v("../../components/fx"),e=v("../../lib"),n=v("../../lib/events"),t=v("./helpers"),a=v("../pie/helpers").formatPieValue;function r(m,o,i){for(var u=m.data.data,f={curveNumber:o.index,pointNumber:u.i,data:o._input,fullData:o},l=0;l<i.length;l++){var h=i[l];h in m&&(f[h]=m[h])}return"parentString"in m&&!t.isHierarchyRoot(m)&&(f.parent=m.parentString),b(f,o,u.i),f}J.exports=function(m,o,i,u,f){var l=u[0],h=l.trace,d=l.hierarchy,s=h.type==="sunburst",x=h.type==="treemap"||h.type==="icicle";"_hasHoverLabel"in h||(h._hasHoverLabel=!1),"_hasHoverEvent"in h||(h._hasHoverEvent=!1),m.on("mouseover",function(c){var T=i._fullLayout;if(!i._dragging&&T.hovermode!==!1){var _,w=i._fullData[h.index],k=c.data.data,L=k.i,A=t.isHierarchyRoot(c),I=t.getParent(d,c),P=t.getValue(c),S=function(Q){return e.castOption(w,L,Q)},E=S("hovertemplate"),D=y.castHoverinfo(w,T,L),R=T.separators;if(E||D&&D!=="none"&&D!=="skip"){var H,V;s&&(H=l.cx+c.pxmid[0]*(1-c.rInscribed),V=l.cy+c.pxmid[1]*(1-c.rInscribed)),x&&(H=c._hoverX,V=c._hoverY);var X,$={},G=[],W=[],te=function(Q){return G.indexOf(Q)!==-1};D&&(G=D==="all"?w._module.attributes.hoverinfo.flags:D.split("+")),$.label=k.label,te("label")&&$.label&&W.push($.label),k.hasOwnProperty("v")&&($.value=k.v,$.valueLabel=a($.value,R),te("value")&&W.push($.valueLabel)),$.currentPath=c.currentPath=t.getPath(c.data),te("current path")&&!A&&W.push($.currentPath);var N=[],B=function(){N.indexOf(X)===-1&&(W.push(X),N.push(X))};$.percentParent=c.percentParent=P/t.getValue(I),$.parent=c.parentString=t.getPtLabel(I),te("percent parent")&&(X=t.formatPercent($.percentParent,R)+" of "+$.parent,B()),$.percentEntry=c.percentEntry=P/t.getValue(o),$.entry=c.entry=t.getPtLabel(o),!te("percent entry")||A||c.onPathbar||(X=t.formatPercent($.percentEntry,R)+" of "+$.entry,B()),$.percentRoot=c.percentRoot=P/t.getValue(d),$.root=c.root=t.getPtLabel(d),te("percent root")&&!A&&(X=t.formatPercent($.percentRoot,R)+" of "+$.root,B()),$.text=S("hovertext")||S("text"),te("text")&&(X=$.text,e.isValidTextValue(X)&&W.push(X)),_=[r(c,w,f.eventDataKeys)];var U={trace:w,y:V,_x0:c._x0,_x1:c._x1,_y0:c._y0,_y1:c._y1,text:W.join("<br>"),name:E||te("name")?w.name:void 0,color:S("hoverlabel.bgcolor")||k.color,borderColor:S("hoverlabel.bordercolor"),fontFamily:S("hoverlabel.font.family"),fontSize:S("hoverlabel.font.size"),fontColor:S("hoverlabel.font.color"),nameLength:S("hoverlabel.namelength"),textAlign:S("hoverlabel.align"),hovertemplate:E,hovertemplateLabels:$,eventData:_};s&&(U.x0=H-c.rInscribed*c.rpx1,U.x1=H+c.rInscribed*c.rpx1,U.idealAlign=c.pxmid[0]<0?"left":"right"),x&&(U.x=H,U.idealAlign=H<0?"left":"right");var ee=[];y.loneHover(U,{container:T._hoverlayer.node(),outerContainer:T._paper.node(),gd:i,inOut_bbox:ee}),_[0].bbox=ee[0],h._hasHoverLabel=!0}if(x){var j=m.select("path.surface");f.styleOne(j,c,w,{hovered:!0})}h._hasHoverEvent=!0,i.emit("plotly_hover",{points:_||[r(c,w,f.eventDataKeys)],event:p.event})}}),m.on("mouseout",function(c){var T=i._fullLayout,_=i._fullData[h.index],w=p.select(this).datum();if(h._hasHoverEvent&&(c.originalEvent=p.event,i.emit("plotly_unhover",{points:[r(w,_,f.eventDataKeys)],event:p.event}),h._hasHoverEvent=!1),h._hasHoverLabel&&(y.loneUnhover(T._hoverlayer.node()),h._hasHoverLabel=!1),x){var k=m.select("path.surface");f.styleOne(k,w,_,{hovered:!1})}}),m.on("click",function(c){var T=i._fullLayout,_=i._fullData[h.index],w=s&&(t.isHierarchyRoot(c)||t.isLeaf(c)),k=t.getPtId(c),L=t.isEntry(c)?t.findEntryWithChild(d,k):t.findEntryWithLevel(d,k),A=t.getPtId(L),I={points:[r(c,_,f.eventDataKeys)],event:p.event};w||(I.nextLevel=A);var P=n.triggerHandler(i,"plotly_"+h.type+"click",I);if(P!==!1&&T.hovermode&&(i._hoverdata=[r(c,_,f.eventDataKeys)],y.click(i,p.event)),!w&&P!==!1&&!i._dragging&&!i._transitioning){g.call("_storeDirectGUIEdit",_,T._tracePreGUI[_.uid],{level:_.level});var S={data:[{level:A}],traces:[h.index]},E={frame:{redraw:!1,duration:f.transitionTime},transition:{duration:f.transitionTime,easing:f.transitionEasing},mode:"immediate",fromcurrent:!0};y.loneUnhover(T._hoverlayer.node()),g.call("animate",i,S,E)}})}},{"../../components/fx":407,"../../components/fx/helpers":403,"../../lib":515,"../../lib/events":504,"../../registry":647,"../pie/helpers":915,"./helpers":1064,"@plotly/d3":58}],1064:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/color"),b=v("../../lib/setcursor"),y=v("../pie/helpers");function e(n){return n.data.data.pid}Z.findEntryWithLevel=function(n,t){var a;return t&&n.eachAfter(function(r){if(Z.getPtId(r)===t)return a=r.copy()}),a||n},Z.findEntryWithChild=function(n,t){var a;return n.eachAfter(function(r){for(var m=r.children||[],o=0;o<m.length;o++){var i=m[o];if(Z.getPtId(i)===t)return a=r.copy()}}),a||n},Z.isEntry=function(n){return!n.parent},Z.isLeaf=function(n){return!n.children},Z.getPtId=function(n){return n.data.data.id},Z.getPtLabel=function(n){return n.data.data.label},Z.getValue=function(n){return n.value},Z.isHierarchyRoot=function(n){return e(n)===""},Z.setSliceCursor=function(n,t,a){var r=a.isTransitioning;if(!r){var m=n.datum();r=a.hideOnRoot&&Z.isHierarchyRoot(m)||a.hideOnLeaves&&Z.isLeaf(m)}b(n,r?null:"pointer")},Z.getInsideTextFontKey=function(n,t,a,r,m){var o=(m||{}).onPathbar?"pathbar.textfont":"insidetextfont",i=a.data.data.i;return p.castOption(t,i,o+"."+n)||p.castOption(t,i,"textfont."+n)||r.size},Z.getOutsideTextFontKey=function(n,t,a,r){var m=a.data.data.i;return p.castOption(t,m,"outsidetextfont."+n)||p.castOption(t,m,"textfont."+n)||r.size},Z.isOutsideText=function(n,t){return!n._hasColorscale&&Z.isHierarchyRoot(t)},Z.determineTextFont=function(n,t,a,r){return Z.isOutsideText(n,t)?function(m,o,i){return{color:Z.getOutsideTextFontKey("color",m,o,i),family:Z.getOutsideTextFontKey("family",m,o,i),size:Z.getOutsideTextFontKey("size",m,o,i)}}(n,t,a):function(m,o,i,u){var f=(u||{}).onPathbar,l=o.data.data,h=l.i,d=p.castOption(m,h,(f?"pathbar.textfont":"insidetextfont")+".color");return!d&&m._input.textfont&&(d=p.castOption(m._input,h,"textfont.color")),{color:d||g.contrast(l.color),family:Z.getInsideTextFontKey("family",m,o,i,u),size:Z.getInsideTextFontKey("size",m,o,i,u)}}(n,t,a,r)},Z.hasTransition=function(n){return!!(n&&n.duration>0)},Z.getMaxDepth=function(n){return n.maxdepth>=0?n.maxdepth:1/0},Z.isHeader=function(n,t){return!(Z.isLeaf(n)||n.depth===t._maxDepth-1)},Z.getParent=function(n,t){return Z.findEntryWithLevel(n,e(t))},Z.listPath=function(n,t){var a=n.parent;if(!a)return[];var r=t?[a.data[t]]:[a];return Z.listPath(a,t).concat(r)},Z.getPath=function(n){return Z.listPath(n,"label").join("/")+"/"},Z.formatValue=y.formatPieValue,Z.formatPercent=function(n,t){var a=p.formatPercent(n,0);return a==="0%"&&(a=y.formatPiePercent(n,t)),a}},{"../../components/color":367,"../../lib":515,"../../lib/setcursor":536,"../pie/helpers":915}],1065:[function(v,J,Z){J.exports={moduleType:"trace",name:"sunburst",basePlotModule:v("./base_plot"),categories:[],animatable:!0,attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot").plot,style:v("./style").style,colorbar:v("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1058,"./base_plot":1059,"./calc":1060,"./defaults":1062,"./layout_attributes":1066,"./layout_defaults":1067,"./plot":1068,"./style":1069}],1066:[function(v,J,Z){J.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1067:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes");J.exports=function(b,y){function e(n,t){return p.coerce(b,y,g,n,t)}e("sunburstcolorway",y.colorway),e("extendsunburstcolors")}},{"../../lib":515,"./layout_attributes":1066}],1068:[function(v,J,Z){var p=v("@plotly/d3"),g=v("d3-hierarchy"),b=v("d3-interpolate").interpolate,y=v("../../components/drawing"),e=v("../../lib"),n=v("../../lib/svg_text_utils"),t=v("../bar/uniform_text"),a=t.recordMinTextSize,r=t.clearMinTextSize,m=v("../pie/plot"),o=v("../pie/helpers").getRotationAngle,i=m.computeTransform,u=m.transformInsideText,f=v("./style").styleOne,l=v("../bar/style").resizeText,h=v("./fx"),d=v("./constants"),s=v("./helpers");function x(T,_,w,k){var L=T._fullLayout,A=!L.uniformtext.mode&&s.hasTransition(k),I=p.select(w).selectAll("g.slice"),P=_[0],S=P.trace,E=P.hierarchy,D=s.findEntryWithLevel(E,S.level),R=s.getMaxDepth(S),H=L._size,V=S.domain,X=H.w*(V.x[1]-V.x[0]),$=H.h*(V.y[1]-V.y[0]),G=.5*Math.min(X,$),W=P.cx=H.l+H.w*(V.x[1]+V.x[0])/2,te=P.cy=H.t+H.h*(1-V.y[0])-$/2;if(!D)return I.remove();var N=null,B={};A&&I.each(function(Ce){B[s.getPtId(Ce)]={rpx0:Ce.rpx0,rpx1:Ce.rpx1,x0:Ce.x0,x1:Ce.x1,transform:Ce.transform},!N&&s.isEntry(Ce)&&(N=Ce)});var U=function(Ce){return g.partition().size([2*Math.PI,Ce.height+1])(Ce)}(D).descendants(),ee=D.height+1,j=0,Q=R;P.hasMultipleRoots&&s.isHierarchyRoot(D)&&(U=U.slice(1),ee-=1,j=1,Q+=1),U=U.filter(function(Ce){return Ce.y1<=Q});var K=o(S.rotation);K&&U.forEach(function(Ce){Ce.x0+=K,Ce.x1+=K});var re=Math.min(ee,R),ne=function(Ce){return(Ce-j)/re*G},le=function(Ce,fe){return[Ce*Math.cos(fe),-Ce*Math.sin(fe)]},oe=function(Ce){return e.pathAnnulus(Ce.rpx0,Ce.rpx1,Ce.x0,Ce.x1,W,te)},de=function(Ce){return W+c(Ce)[0]*(Ce.transform.rCenter||0)+(Ce.transform.x||0)},se=function(Ce){return te+c(Ce)[1]*(Ce.transform.rCenter||0)+(Ce.transform.y||0)};(I=I.data(U,s.getPtId)).enter().append("g").classed("slice",!0),A?I.exit().transition().each(function(){var Ce=p.select(this);Ce.select("path.surface").transition().attrTween("d",function(fe){var ve=function(Me){var ke,Le=s.getPtId(Me),ze=B[Le],Re=B[s.getPtId(D)];if(Re){var Oe=(Me.x1>Re.x1?2*Math.PI:0)+K;ke=Me.rpx1<Re.rpx1?{x0:Me.x0,x1:Me.x1,rpx0:0,rpx1:0}:{x0:Oe,x1:Oe,rpx0:Me.rpx0,rpx1:Me.rpx1}}else{var Ze,Pe=s.getPtId(Me.parent);I.each(function(ot){if(s.getPtId(ot)===Pe)return Ze=ot});var Ie,Be=Ze.children;Be.forEach(function(ot,pt){if(s.getPtId(ot)===Le)return Ie=pt});var Fe=Be.length,$e=b(Ze.x0,Ze.x1);ke={rpx0:G,rpx1:G,x0:$e(Ie/Fe),x1:$e((Ie+1)/Fe)}}return b(ze,ke)}(fe);return function(Me){return oe(ve(Me))}}),Ce.select("g.slicetext").attr("opacity",0)}).remove():I.exit().remove(),I.order();var me=null;if(A&&N){var Te=s.getPtId(N);I.each(function(Ce){me===null&&s.getPtId(Ce)===Te&&(me=Ce.x1)})}var _e=I;function be(Ce){var fe=Ce.parent,ve=B[s.getPtId(fe)],Me={};if(ve){var ke=fe.children,Le=ke.indexOf(Ce),ze=ke.length,Re=b(ve.x0,ve.x1);Me.x0=Re(Le/ze),Me.x1=Re(Le/ze)}else Me.x0=Me.x1=0;return Me}A&&(_e=_e.transition().each("end",function(){var Ce=p.select(this);s.setSliceCursor(Ce,T,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),_e.each(function(Ce){var fe=p.select(this),ve=e.ensureSingle(fe,"path","surface",function(Oe){Oe.style("pointer-events","all")});Ce.rpx0=ne(Ce.y0),Ce.rpx1=ne(Ce.y1),Ce.xmid=(Ce.x0+Ce.x1)/2,Ce.pxmid=le(Ce.rpx1,Ce.xmid),Ce.midangle=-(Ce.xmid-Math.PI/2),Ce.startangle=-(Ce.x0-Math.PI/2),Ce.stopangle=-(Ce.x1-Math.PI/2),Ce.halfangle=.5*Math.min(e.angleDelta(Ce.x0,Ce.x1)||Math.PI,Math.PI),Ce.ring=1-Ce.rpx0/Ce.rpx1,Ce.rInscribed=function(Oe){return Oe.rpx0===0&&e.isFullCircle([Oe.x0,Oe.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(Oe.halfangle)),Oe.ring/2))}(Ce),A?ve.transition().attrTween("d",function(Oe){var Ze=function(Pe){var Ie,Be=B[s.getPtId(Pe)],Fe={x0:Pe.x0,x1:Pe.x1,rpx0:Pe.rpx0,rpx1:Pe.rpx1};if(Be)Ie=Be;else if(N)if(Pe.parent)if(me){var $e=(Pe.x1>me?2*Math.PI:0)+K;Ie={x0:$e,x1:$e}}else Ie={rpx0:G,rpx1:G},e.extendFlat(Ie,be(Pe));else Ie={rpx0:0,rpx1:0};else Ie={x0:K,x1:K};return b(Ie,Fe)}(Oe);return function(Pe){return oe(Ze(Pe))}}):ve.attr("d",oe),fe.call(h,D,T,_,{eventDataKeys:d.eventDataKeys,transitionTime:d.CLICK_TRANSITION_TIME,transitionEasing:d.CLICK_TRANSITION_EASING}).call(s.setSliceCursor,T,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:T._transitioning}),ve.call(f,Ce,S);var Me=e.ensureSingle(fe,"g","slicetext"),ke=e.ensureSingle(Me,"text","",function(Oe){Oe.attr("data-notex",1)}),Le=e.ensureUniformFontSize(T,s.determineTextFont(S,Ce,L.font));ke.text(Z.formatSliceLabel(Ce,D,S,_,L)).classed("slicetext",!0).attr("text-anchor","middle").call(y.font,Le).call(n.convertToTspans,T);var ze=y.bBox(ke.node());Ce.transform=u(ze,Ce,P),Ce.transform.targetX=de(Ce),Ce.transform.targetY=se(Ce);var Re=function(Oe,Ze){var Pe=Oe.transform;return i(Pe,Ze),Pe.fontSize=Le.size,a(S.type,Pe,L),e.getTextTransform(Pe)};A?ke.transition().attrTween("transform",function(Oe){var Ze=function(Pe){var Ie,Be=B[s.getPtId(Pe)],Fe=Pe.transform;if(Be)Ie=Be;else if(Ie={rpx1:Pe.rpx1,transform:{textPosAngle:Fe.textPosAngle,scale:0,rotate:Fe.rotate,rCenter:Fe.rCenter,x:Fe.x,y:Fe.y}},N)if(Pe.parent)if(me){var $e=Pe.x1>me?2*Math.PI:0;Ie.x0=Ie.x1=$e}else e.extendFlat(Ie,be(Pe));else Ie.x0=Ie.x1=K;else Ie.x0=Ie.x1=K;var ot=b(Ie.transform.textPosAngle,Pe.transform.textPosAngle),pt=b(Ie.rpx1,Pe.rpx1),_t=b(Ie.x0,Pe.x0),yt=b(Ie.x1,Pe.x1),tt=b(Ie.transform.scale,Fe.scale),Ke=b(Ie.transform.rotate,Fe.rotate),vt=Fe.rCenter===0?3:Ie.transform.rCenter===0?1/3:1,Nt=b(Ie.transform.rCenter,Fe.rCenter);return function(qt){var er=pt(qt),Jt=_t(qt),ir=yt(qt),Ht=function(We){return Nt(Math.pow(We,vt))}(qt),Ue={pxmid:le(er,(Jt+ir)/2),rpx1:er,transform:{textPosAngle:ot(qt),rCenter:Ht,x:Fe.x,y:Fe.y}};return a(S.type,Fe,L),{transform:{targetX:de(Ue),targetY:se(Ue),scale:tt(qt),rotate:Ke(qt),rCenter:Ht}}}}(Oe);return function(Pe){return Re(Ze(Pe),ze)}}):ke.attr("transform",Re(Ce,ze))})}function c(T){return _=T.rpx1,w=T.transform.textPosAngle,[_*Math.sin(w),-_*Math.cos(w)];var _,w}Z.plot=function(T,_,w,k){var L,A,I=T._fullLayout,P=I._sunburstlayer,S=!w,E=!I.uniformtext.mode&&s.hasTransition(w);r("sunburst",I),(L=P.selectAll("g.trace.sunburst").data(_,function(D){return D[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),L.order(),E?(k&&(A=k()),p.transition().duration(w.duration).ease(w.easing).each("end",function(){A&&A()}).each("interrupt",function(){A&&A()}).each(function(){P.selectAll("g.trace").each(function(D){x(T,D,this,w)})})):(L.each(function(D){x(T,D,this,w)}),I.uniformtext.mode&&l(T,I._sunburstlayer.selectAll(".trace"),"sunburst")),S&&L.exit().remove()},Z.formatSliceLabel=function(T,_,w,k,L){var A=w.texttemplate,I=w.textinfo;if(!(A||I&&I!=="none"))return"";var P=L.separators,S=k[0],E=T.data.data,D=S.hierarchy,R=s.isHierarchyRoot(T),H=s.getParent(D,T),V=s.getValue(T);if(!A){var X,$=I.split("+"),G=function(K){return $.indexOf(K)!==-1},W=[];if(G("label")&&E.label&&W.push(E.label),E.hasOwnProperty("v")&&G("value")&&W.push(s.formatValue(E.v,P)),!R){G("current path")&&W.push(s.getPath(T.data));var te=0;G("percent parent")&&te++,G("percent entry")&&te++,G("percent root")&&te++;var N=te>1;if(te){var B,U=function(K){X=s.formatPercent(B,P),N&&(X+=" of "+K),W.push(X)};G("percent parent")&&!R&&(B=V/s.getValue(H),U("parent")),G("percent entry")&&(B=V/s.getValue(_),U("entry")),G("percent root")&&(B=V/s.getValue(D),U("root"))}}return G("text")&&(X=e.castOption(w,E.i,"text"),e.isValidTextValue(X)&&W.push(X)),W.join("<br>")}var ee=e.castOption(w,E.i,"texttemplate");if(!ee)return"";var j={};E.label&&(j.label=E.label),E.hasOwnProperty("v")&&(j.value=E.v,j.valueLabel=s.formatValue(E.v,P)),j.currentPath=s.getPath(T.data),R||(j.percentParent=V/s.getValue(H),j.percentParentLabel=s.formatPercent(j.percentParent,P),j.parent=s.getPtLabel(H)),j.percentEntry=V/s.getValue(_),j.percentEntryLabel=s.formatPercent(j.percentEntry,P),j.entry=s.getPtLabel(_),j.percentRoot=V/s.getValue(D),j.percentRootLabel=s.formatPercent(j.percentRoot,P),j.root=s.getPtLabel(D),E.hasOwnProperty("color")&&(j.color=E.color);var Q=e.castOption(w,E.i,"text");return(e.isValidTextValue(Q)||Q==="")&&(j.text=Q),j.customdata=e.castOption(w,E.i,"customdata"),e.texttemplateString(ee,j,L._d3locale,j,w._meta||{})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/style":671,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"./constants":1061,"./fx":1063,"./helpers":1064,"./style":1069,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1069:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/color"),b=v("../../lib"),y=v("../bar/uniform_text").resizeText;function e(n,t,a){var r=t.data.data,m=!t.children,o=r.i,i=b.castOption(a,o,"marker.line.color")||g.defaultLine,u=b.castOption(a,o,"marker.line.width")||0;n.style("stroke-width",u).call(g.fill,r.color).call(g.stroke,i).style("opacity",m?a.leaf.opacity:null)}J.exports={style:function(n){var t=n._fullLayout._sunburstlayer.selectAll(".trace");y(n,t,"sunburst"),t.each(function(a){var r=p.select(this),m=a[0].trace;r.style("opacity",m.opacity),r.selectAll("path.surface").each(function(o){p.select(this).call(e,o,m)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],1070:[function(v,J,Z){var p=v("../../components/color"),g=v("../../components/colorscale/attributes"),b=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../../plots/attributes"),n=v("../../lib/extend").extendFlat,t=v("../../plot_api/edit_types").overrideAll;function a(m){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:p.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:p.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var r=J.exports=t(n({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:y(),xhoverformat:b("x"),yhoverformat:b("y"),zhoverformat:b("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},g("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:a(),y:a(),z:a()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:n({},g.zauto,{}),zmin:n({},g.zmin,{}),zmax:n({},g.zmax,{})},hoverinfo:n({},e.hoverinfo),showlegend:n({},e.showlegend,{dflt:!1})}),"calc","nested");r.x.editType=r.y.editType=r.z.editType="calc+clearAxisTypes",r.transforms=void 0},{"../../components/color":367,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642}],1071:[function(v,J,Z){var p=v("../../components/colorscale/calc");J.exports=function(g,b){b.surfacecolor?p(g,b,{vals:b.surfacecolor,containerStr:"",cLetter:"c"}):p(g,b,{vals:b.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],1072:[function(v,J,Z){var p=v("../../../stackgl_modules").gl_surface3d,g=v("../../../stackgl_modules").ndarray,b=v("../../../stackgl_modules").ndarray_linear_interpolate.d2,y=v("../heatmap/interp2d"),e=v("../heatmap/find_empties"),n=v("../../lib").isArrayOrTypedArray,t=v("../../lib/gl_format_color").parseColorScale,a=v("../../lib/str2rgbarray"),r=v("../../components/colorscale").extractOpts;function m(w,k,L){this.scene=w,this.uid=L,this.surface=k,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var o=m.prototype;o.getXat=function(w,k,L,A){var I=n(this.data.x)?n(this.data.x[0])?this.data.x[k][w]:this.data.x[w]:w;return L===void 0?I:A.d2l(I,0,L)},o.getYat=function(w,k,L,A){var I=n(this.data.y)?n(this.data.y[0])?this.data.y[k][w]:this.data.y[k]:k;return L===void 0?I:A.d2l(I,0,L)},o.getZat=function(w,k,L,A){var I=this.data.z[k][w];return I===null&&this.data.connectgaps&&this.data._interpolatedZ&&(I=this.data._interpolatedZ[k][w]),L===void 0?I:A.d2l(I,0,L)},o.handlePick=function(w){if(w.object===this.surface){var k=(w.data.index[0]-1)/this.dataScaleX-1,L=(w.data.index[1]-1)/this.dataScaleY-1,A=Math.max(Math.min(Math.round(k),this.data.z[0].length-1),0),I=Math.max(Math.min(Math.round(L),this.data._ylength-1),0);w.index=[A,I],w.traceCoordinate=[this.getXat(A,I),this.getYat(A,I),this.getZat(A,I)],w.dataCoordinate=[this.getXat(A,I,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(A,I,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(A,I,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var P=0;P<3;P++){var S=w.dataCoordinate[P];S!=null&&(w.dataCoordinate[P]*=this.scene.dataScale[P])}var E=this.data.hovertext||this.data.text;return Array.isArray(E)&&E[I]&&E[I][A]!==void 0?w.textLabel=E[I][A]:w.textLabel=E||"",w.data.dataCoordinate=w.dataCoordinate.slice(),this.surface.highlight(w.data),this.scene.glplot.spikes.position=w.dataCoordinate,!0}};var i=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function u(w,k){if(w<k)return 0;for(var L=0;Math.floor(w%k)===0;)w/=k,L++;return L}function f(w){for(var k=[],L=0;L<i.length;L++){var A=i[L];k.push(u(w,A))}return k}function l(w){for(var k=f(w),L=w,A=0;A<i.length;A++)if(k[A]>0){L=i[A];break}return L}function h(w,k){if(!(w<1||k<1)){for(var L=f(w),A=f(k),I=1,P=0;P<i.length;P++)I*=Math.pow(i[P],Math.max(L[P],A[P]));return I}}o.calcXnums=function(w){var k,L=[];for(k=1;k<w;k++){var A=this.getXat(k-1,0),I=this.getXat(k,0);L[k-1]=I!==A&&A!=null&&I!=null?Math.abs(I-A):0}var P=0;for(k=1;k<w;k++)P+=L[k-1];for(k=1;k<w;k++)L[k-1]===0?L[k-1]=1:L[k-1]=Math.round(P/L[k-1]);return L},o.calcYnums=function(w){var k,L=[];for(k=1;k<w;k++){var A=this.getYat(0,k-1),I=this.getYat(0,k);L[k-1]=I!==A&&A!=null&&I!=null?Math.abs(I-A):0}var P=0;for(k=1;k<w;k++)P+=L[k-1];for(k=1;k<w;k++)L[k-1]===0?L[k-1]=1:L[k-1]=Math.round(P/L[k-1]);return L};var d=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],s=d[9],x=d[13];function c(w,k,L){var A=L[8]+L[2]*k[0]+L[5]*k[1];return w[0]=(L[6]+L[0]*k[0]+L[3]*k[1])/A,w[1]=(L[7]+L[1]*k[0]+L[4]*k[1])/A,w}function T(w,k,L){return function(A,I,P,S){for(var E=[0,0],D=A.shape[0],R=A.shape[1],H=0;H<D;H++)for(var V=0;V<R;V++)P(E,[H,V],S),A.set(H,V,b(I,E[0],E[1]))}(w,k,c,L),w}function _(w,k){for(var L=!1,A=0;A<w.length;A++)if(k===w[A]){L=!0;break}L===!1&&w.push(k)}o.estimateScale=function(w,k){for(var L=1+function(I){if(I.length!==0){for(var P=1,S=0;S<I.length;S++)P=h(P,I[S]);return P}}(k===0?this.calcXnums(w):this.calcYnums(w));L<s;)L*=2;for(;L>x;)L--,L/=l(L),++L<s&&(L=x);var A=Math.round(L/w);return A>1?A:1},o.refineCoords=function(w){for(var k=this.dataScaleX,L=this.dataScaleY,A=w[0].shape[0],I=w[0].shape[1],P=0|Math.floor(w[0].shape[0]*k+1),S=0|Math.floor(w[0].shape[1]*L+1),E=1+A+1,D=1+I+1,R=g(new Float32Array(E*D),[E,D]),H=[1/k,0,0,0,1/L,0,0,0,1],V=0;V<w.length;++V){this.surface.padField(R,w[V]);var X=g(new Float32Array(P*S),[P,S]);T(X,R,H),w[V]=X}},o.setContourLevels=function(){var w,k,L,A=[[],[],[]],I=[!1,!1,!1],P=!1;for(w=0;w<3;++w)if(this.showContour[w]&&(P=!0,this.contourSize[w]>0&&this.contourStart[w]!==null&&this.contourEnd[w]!==null&&this.contourEnd[w]>this.contourStart[w]))for(I[w]=!0,k=this.contourStart[w];k<this.contourEnd[w];k+=this.contourSize[w])L=k*this.scene.dataScale[w],_(A[w],L);if(P){var S=[[],[],[]];for(w=0;w<3;++w)this.showContour[w]&&(S[w]=I[w]?A[w]:this.scene.contourLevels[w]);this.surface.update({levels:S})}},o.update=function(w){var k,L,A,I,P=this.scene,S=P.fullSceneLayout,E=this.surface,D=t(w),R=P.dataScale,H=w.z[0].length,V=w._ylength,X=P.contourLevels;this.data=w;var $=[];for(k=0;k<3;k++)for($[k]=[],L=0;L<H;L++)$[k][L]=[];for(L=0;L<H;L++)for(A=0;A<V;A++)$[0][L][A]=this.getXat(L,A,w.xcalendar,S.xaxis),$[1][L][A]=this.getYat(L,A,w.ycalendar,S.yaxis),$[2][L][A]=this.getZat(L,A,w.zcalendar,S.zaxis);if(w.connectgaps)for(w._emptypoints=e($[2]),y($[2],w._emptypoints),w._interpolatedZ=[],L=0;L<H;L++)for(w._interpolatedZ[L]=[],A=0;A<V;A++)w._interpolatedZ[L][A]=$[2][L][A];for(k=0;k<3;k++)for(L=0;L<H;L++)for(A=0;A<V;A++)(I=$[k][L][A])==null?$[k][L][A]=NaN:I=$[k][L][A]*=R[k];for(k=0;k<3;k++)for(L=0;L<H;L++)for(A=0;A<V;A++)(I=$[k][L][A])!=null&&(this.minValues[k]>I&&(this.minValues[k]=I),this.maxValues[k]<I&&(this.maxValues[k]=I));for(k=0;k<3;k++)this.objectOffset[k]=.5*(this.minValues[k]+this.maxValues[k]);for(k=0;k<3;k++)for(L=0;L<H;L++)for(A=0;A<V;A++)(I=$[k][L][A])!=null&&($[k][L][A]-=this.objectOffset[k]);var G=[g(new Float32Array(H*V),[H,V]),g(new Float32Array(H*V),[H,V]),g(new Float32Array(H*V),[H,V])];for(k=0;k<3;k++)for(L=0;L<H;L++)for(A=0;A<V;A++)G[k].set(L,A,$[k][L][A]);$=[];var W={colormap:D,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!w.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:w.opacityscale,opacity:w.opacity},te=r(w);if(W.intensityBounds=[te.min,te.max],w.surfacecolor){var N=g(new Float32Array(H*V),[H,V]);for(L=0;L<H;L++)for(A=0;A<V;A++)N.set(L,A,w.surfacecolor[A][L]);G.push(N)}else W.intensityBounds[0]*=R[2],W.intensityBounds[1]*=R[2];(x<G[0].shape[0]||x<G[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(G[0].shape[0],0),this.dataScaleY=this.estimateScale(G[0].shape[1],1),this.dataScaleX===1&&this.dataScaleY===1||this.refineCoords(G)),w.surfacecolor&&(W.intensity=G.pop());var B=[!0,!0,!0],U=["x","y","z"];for(k=0;k<3;++k){var ee=w.contours[U[k]];B[k]=ee.highlight,W.showContour[k]=ee.show||ee.highlight,W.showContour[k]&&(W.contourProject[k]=[ee.project.x,ee.project.y,ee.project.z],ee.show?(this.showContour[k]=!0,W.levels[k]=X[k],E.highlightColor[k]=W.contourColor[k]=a(ee.color),ee.usecolormap?E.highlightTint[k]=W.contourTint[k]=0:E.highlightTint[k]=W.contourTint[k]=1,W.contourWidth[k]=ee.width,this.contourStart[k]=ee.start,this.contourEnd[k]=ee.end,this.contourSize[k]=ee.size):(this.showContour[k]=!1,this.contourStart[k]=null,this.contourEnd[k]=null,this.contourSize[k]=0),ee.highlight&&(W.dynamicColor[k]=a(ee.highlightcolor),W.dynamicWidth[k]=ee.highlightwidth))}(function(j){var Q=j[0].rgb,K=j[j.length-1].rgb;return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]&&Q[3]===K[3]})(D)&&(W.vertexColor=!0),W.objectOffset=this.objectOffset,W.coords=G,E.update(W),E.visible=w.visible,E.enableDynamic=B,E.enableHighlight=B,E.snapToData=!0,"lighting"in w&&(E.ambientLight=w.lighting.ambient,E.diffuseLight=w.lighting.diffuse,E.specularLight=w.lighting.specular,E.roughness=w.lighting.roughness,E.fresnel=w.lighting.fresnel),"lightposition"in w&&(E.lightPosition=[w.lightposition.x,w.lightposition.y,w.lightposition.z])},o.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},J.exports=function(w,k){var L=w.glplot.gl,A=p({gl:L}),I=new m(w,A,k.uid);return A._trace=I,I.update(k),w.glplot.add(A),I}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../heatmap/find_empties":807,"../heatmap/interp2d":810}],1073:[function(v,J,Z){var p=v("../../registry"),g=v("../../lib"),b=v("../../components/colorscale/defaults"),y=v("./attributes");function e(t,a,r,m){var o=m("opacityscale");o==="max"?a.opacityscale=[[0,.1],[1,1]]:o==="min"?a.opacityscale=[[0,1],[1,.1]]:o==="extremes"?a.opacityscale=function(i,u){for(var f=[],l=0;l<32;l++){var h=l/31,d=u+(1-u)*(1-Math.pow(Math.sin(i*h*Math.PI),2));f.push([h,Math.max(0,Math.min(1,d))])}return f}(1,.1):function(i){var u=0;if(!Array.isArray(i)||i.length<2||!i[0]||!i[i.length-1]||+i[0][0]!=0||+i[i.length-1][0]!=1)return!1;for(var f=0;f<i.length;f++){var l=i[f];if(l.length!==2||+l[0]<u)return!1;u=+l[0]}return!0}(o)||(a.opacityscale=void 0)}function n(t,a,r){a in t&&!(r in t)&&(t[r]=t[a])}J.exports={supplyDefaults:function(t,a,r,m){var o,i;function u(_,w){return g.coerce(t,a,y,_,w)}var f=u("x"),l=u("y"),h=u("z");if(!h||!h.length||f&&f.length<1||l&&l.length<1)a.visible=!1;else{a._xlength=Array.isArray(f)&&g.isArrayOrTypedArray(f[0])?h.length:h[0].length,a._ylength=h.length,p.getComponentMethod("calendars","handleTraceDefaults")(t,a,["x","y","z"],m),u("text"),u("hovertext"),u("hovertemplate"),u("xhoverformat"),u("yhoverformat"),u("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(_){u(_)});var d=u("surfacecolor"),s=["x","y","z"];for(o=0;o<3;++o){var x="contours."+s[o],c=u(x+".show"),T=u(x+".highlight");if(c||T)for(i=0;i<3;++i)u(x+".project."+s[i]);c&&(u(x+".color"),u(x+".width"),u(x+".usecolormap")),T&&(u(x+".highlightcolor"),u(x+".highlightwidth")),u(x+".start"),u(x+".end"),u(x+".size")}d||(n(t,"zmin","cmin"),n(t,"zmax","cmax"),n(t,"zauto","cauto")),b(t,a,m,u,{prefix:"",cLetter:"c"}),e(t,a,m,u),a._length=null}},opacityscaleDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":1070}],1074:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:v("./calc"),plot:v("./convert"),moduleType:"trace",name:"surface",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":1070,"./calc":1071,"./convert":1072,"./defaults":1073}],1075:[function(v,J,Z){var p=v("../../components/annotations/attributes"),g=v("../../lib/extend").extendFlat,b=v("../../plot_api/edit_types").overrideAll,y=v("../../plots/font_attributes"),e=v("../../plots/domain").attributes,n=v("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;(J.exports=b({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:n("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:g({},p.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:g({},y({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:n("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:g({},p.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:g({},y({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":350,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594}],1076:[function(v,J,Z){var p=v("../../plots/get_data").getModuleCalcData,g=v("./plot");Z.name="table",Z.plot=function(b){var y=p(b.calcdata,"table")[0];y.length&&g(b,y)},Z.clean=function(b,y,e,n){var t=n._has&&n._has("table"),a=y._has&&y._has("table");t&&!a&&n._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":602,"./plot":1083}],1077:[function(v,J,Z){var p=v("../../lib/gup").wrap;J.exports=function(){return p({})}},{"../../lib/gup":512}],1078:[function(v,J,Z){J.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1079:[function(v,J,Z){var p=v("./constants"),g=v("../../lib/extend").extendFlat,b=v("fast-isnumeric");function y(o){if(Array.isArray(o)){for(var i=0,u=0;u<o.length;u++)i=Math.max(i,y(o[u]));return i}return o}function e(o,i){return o+i}function n(o){var i,u=o.slice(),f=1/0,l=0;for(i=0;i<u.length;i++)Array.isArray(u[i])||(u[i]=[u[i]]),f=Math.min(f,u[i].length),l=Math.max(l,u[i].length);if(f!==l)for(i=0;i<u.length;i++){var h=l-u[i].length;h&&(u[i]=u[i].concat(t(h)))}return u}function t(o){for(var i=new Array(o),u=0;u<o;u++)i[u]="";return i}function a(o){return o.calcdata.columns.reduce(function(i,u){return u.xIndex<o.xIndex?i+u.columnWidth:i},0)}function r(o,i){return Object.keys(o).map(function(u){return g({},o[u],{auxiliaryBlocks:i})})}function m(o,i){for(var u,f={},l=0,h=0,d={firstRowIndex:null,lastRowIndex:null,rows:[]},s=0,x=0,c=0;c<o.length;c++)u=o[c],d.rows.push({rowIndex:c,rowHeight:u}),((h+=u)>=i||c===o.length-1)&&(f[l]=d,d.key=x++,d.firstRowIndex=s,d.lastRowIndex=c,d={firstRowIndex:null,lastRowIndex:null,rows:[]},l+=h,s=c+1,h=0);return f}J.exports=function(o,i){var u=n(i.cells.values),f=function(R){return R.slice(i.header.values.length,R.length)},l=n(i.header.values);l.length&&!l[0].length&&(l[0]=[""],l=n(l));var h=l.concat(f(u).map(function(){return t((l[0]||[""]).length)})),d=i.domain,s=Math.floor(o._fullLayout._size.w*(d.x[1]-d.x[0])),x=Math.floor(o._fullLayout._size.h*(d.y[1]-d.y[0])),c=i.header.values.length?h[0].map(function(){return i.header.height}):[p.emptyHeaderHeight],T=u.length?u[0].map(function(){return i.cells.height}):[],_=c.reduce(e,0),w=m(T,x-_+p.uplift),k=r(m(c,_),[]),L=r(w,k),A={},I=i._fullInput.columnorder.concat(f(u.map(function(R,H){return H}))),P=h.map(function(R,H){var V=Array.isArray(i.columnwidth)?i.columnwidth[Math.min(H,i.columnwidth.length-1)]:i.columnwidth;return b(V)?Number(V):1}),S=P.reduce(e,0);P=P.map(function(R){return R/S*s});var E=Math.max(y(i.header.line.width),y(i.cells.line.width)),D={key:i.uid+o._context.staticPlot,translateX:d.x[0]*o._fullLayout._size.w,translateY:o._fullLayout._size.h*(1-d.y[1]),size:o._fullLayout._size,width:s,maxLineWidth:E,height:x,columnOrder:I,groupHeight:x,rowBlocks:L,headerRowBlocks:k,scrollY:0,cells:g({},i.cells,{values:u}),headerCells:g({},i.header,{values:h}),gdColumns:h.map(function(R){return R[0]}),gdColumnsOriginalOrder:h.map(function(R){return R[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:h.map(function(R,H){var V=A[R];return A[R]=(V||0)+1,{key:R+"__"+A[R],label:R,specIndex:H,xIndex:I[H],xScale:a,x:void 0,calcdata:void 0,columnWidth:P[H]}})};return D.columns.forEach(function(R){R.calcdata=D,R.x=a(R)}),D}},{"../../lib/extend":505,"./constants":1078,"fast-isnumeric":190}],1080:[function(v,J,Z){var p=v("../../lib/extend").extendFlat;Z.splitToPanels=function(g){var b=[0,0],y=p({},g,{key:"header",type:"header",page:0,prevPages:b,currentRepaint:[null,null],dragHandle:!0,values:g.calcdata.headerCells.values[g.specIndex],rowBlocks:g.calcdata.headerRowBlocks,calcdata:p({},g.calcdata,{cells:g.calcdata.headerCells})});return[p({},g,{key:"cells1",type:"cells",page:0,prevPages:b,currentRepaint:[null,null],dragHandle:!1,values:g.calcdata.cells.values[g.specIndex],rowBlocks:g.calcdata.rowBlocks}),p({},g,{key:"cells2",type:"cells",page:1,prevPages:b,currentRepaint:[null,null],dragHandle:!1,values:g.calcdata.cells.values[g.specIndex],rowBlocks:g.calcdata.rowBlocks}),y]},Z.splitToCells=function(g){var b=function(y){var e=y.rowBlocks[y.page],n=e?e.rows[0].rowIndex:0,t=e?n+e.rows.length:0;return[n,t]}(g);return(g.values||[]).slice(b[0],b[1]).map(function(y,e){return{keyWithinBlock:e+(typeof y=="string"&&y.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:b[0]+e,column:g,calcdata:g.calcdata,page:g.page,rowBlocks:g.rowBlocks,value:y}})}},{"../../lib/extend":505}],1081:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes"),b=v("../../plots/domain").defaults;J.exports=function(y,e,n,t){function a(r,m){return p.coerce(y,e,g,r,m)}b(e,t,a),a("columnwidth"),a("header.values"),a("header.format"),a("header.align"),a("header.prefix"),a("header.suffix"),a("header.height"),a("header.line.width"),a("header.line.color"),a("header.fill.color"),p.coerceFont(a,"header.font",p.extendFlat({},t.font)),function(r,m){for(var o=r.columnorder||[],i=r.header.values.length,u=o.slice(0,i),f=u.slice().sort(function(d,s){return d-s}),l=u.map(function(d){return f.indexOf(d)}),h=l.length;h<i;h++)l.push(h);m("columnorder",l)}(e,a),a("cells.values"),a("cells.format"),a("cells.align"),a("cells.prefix"),a("cells.suffix"),a("cells.height"),a("cells.line.width"),a("cells.line.color"),a("cells.fill.color"),p.coerceFont(a,"cells.font",p.extendFlat({},t.font)),e._length=null}},{"../../lib":515,"../../plots/domain":593,"./attributes":1075}],1082:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),moduleType:"trace",name:"table",basePlotModule:v("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1081,"./plot":1083}],1083:[function(v,J,Z){var p=v("./constants"),g=v("@plotly/d3"),b=v("../../lib").numberFormat,y=v("../../lib/gup"),e=v("../../components/drawing"),n=v("../../lib/svg_text_utils"),t=v("../../lib").raiseToTop,a=v("../../lib").strTranslate,r=v("../../lib").cancelTransition,m=v("./data_preparation_helper"),o=v("./data_split_helpers"),i=v("../../components/color");function u(G){return Math.ceil(G.calcdata.maxLineWidth/2)}function f(G,W){return"clip"+G._fullLayout._uid+"_scrollAreaBottomClip_"+W.key}function l(G,W){return"clip"+G._fullLayout._uid+"_columnBoundaryClippath_"+W.calcdata.key+"_"+W.specIndex}function h(G){return[].concat.apply([],G.map(function(W){return W})).map(function(W){return W.__data__})}function d(G,W,te){var N=G.selectAll("."+p.cn.scrollbarKit).data(y.repeat,y.keyFun);N.enter().append("g").classed(p.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),N.each(function(Q){var K=Q.scrollbarState;K.totalHeight=function(re){var ne=re.rowBlocks;return H(ne,ne.length-1)+(ne.length?V(ne[ne.length-1],1/0):1)}(Q),K.scrollableAreaHeight=Q.groupHeight-L(Q),K.currentlyVisibleHeight=Math.min(K.totalHeight,K.scrollableAreaHeight),K.ratio=K.currentlyVisibleHeight/K.totalHeight,K.barLength=Math.max(K.ratio*K.currentlyVisibleHeight,p.goldenRatio*p.scrollbarWidth),K.barWiggleRoom=K.currentlyVisibleHeight-K.barLength,K.wiggleRoom=Math.max(0,K.totalHeight-K.scrollableAreaHeight),K.topY=K.barWiggleRoom===0?0:Q.scrollY/K.wiggleRoom*K.barWiggleRoom,K.bottomY=K.topY+K.barLength,K.dragMultiplier=K.wiggleRoom/K.barWiggleRoom}).attr("transform",function(Q){var K=Q.width+p.scrollbarWidth/2+p.scrollbarOffset;return a(K,L(Q))});var B=N.selectAll("."+p.cn.scrollbar).data(y.repeat,y.keyFun);B.enter().append("g").classed(p.cn.scrollbar,!0);var U=B.selectAll("."+p.cn.scrollbarSlider).data(y.repeat,y.keyFun);U.enter().append("g").classed(p.cn.scrollbarSlider,!0),U.attr("transform",function(Q){return a(0,Q.scrollbarState.topY||0)});var ee=U.selectAll("."+p.cn.scrollbarGlyph).data(y.repeat,y.keyFun);ee.enter().append("line").classed(p.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",p.scrollbarWidth).attr("stroke-linecap","round").attr("y1",p.scrollbarWidth/2),ee.attr("y2",function(Q){return Q.scrollbarState.barLength-p.scrollbarWidth/2}).attr("stroke-opacity",function(Q){return Q.columnDragInProgress||!Q.scrollbarState.barWiggleRoom||te?0:.4}),ee.transition().delay(0).duration(0),ee.transition().delay(p.scrollbarHideDelay).duration(p.scrollbarHideDuration).attr("stroke-opacity",0);var j=B.selectAll("."+p.cn.scrollbarCaptureZone).data(y.repeat,y.keyFun);j.enter().append("line").classed(p.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",p.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(Q){var K=g.event.y,re=this.getBoundingClientRect(),ne=Q.scrollbarState,le=K-re.top,oe=g.scale.linear().domain([0,ne.scrollableAreaHeight]).range([0,ne.totalHeight]).clamp(!0);ne.topY<=le&&le<=ne.bottomY||I(W,G,null,oe(le-ne.barLength/2))(Q)}).call(g.behavior.drag().origin(function(Q){return g.event.stopPropagation(),Q.scrollbarState.scrollbarScrollInProgress=!0,Q}).on("drag",I(W,G)).on("dragend",function(){})),j.attr("y2",function(Q){return Q.scrollbarState.scrollableAreaHeight}),W._context.staticPlot&&(ee.remove(),j.remove())}function s(G,W,te,N){var B=function(ee){var j=ee.selectAll("."+p.cn.columnCell).data(o.splitToCells,function(Q){return Q.keyWithinBlock});return j.enter().append("g").classed(p.cn.columnCell,!0),j.exit().remove(),j}(function(ee){var j=ee.selectAll("."+p.cn.columnCells).data(y.repeat,y.keyFun);return j.enter().append("g").classed(p.cn.columnCells,!0),j.exit().remove(),j}(te));(function(ee){ee.each(function(j,Q){var K=j.calcdata.cells.font,re=j.column.specIndex,ne={size:T(K.size,re,Q),color:T(K.color,re,Q),family:T(K.family,re,Q)};j.rowNumber=j.key,j.align=T(j.calcdata.cells.align,re,Q),j.cellBorderWidth=T(j.calcdata.cells.line.width,re,Q),j.font=ne})})(B),function(ee){ee.attr("width",function(j){return j.column.columnWidth}).attr("stroke-width",function(j){return j.cellBorderWidth}).each(function(j){var Q=g.select(this);i.stroke(Q,T(j.calcdata.cells.line.color,j.column.specIndex,j.rowNumber)),i.fill(Q,T(j.calcdata.cells.fill.color,j.column.specIndex,j.rowNumber))})}(function(ee){var j=ee.selectAll("."+p.cn.cellRect).data(y.repeat,function(Q){return Q.keyWithinBlock});return j.enter().append("rect").classed(p.cn.cellRect,!0),j}(B));var U=function(ee){var j=ee.selectAll("."+p.cn.cellText).data(y.repeat,function(Q){return Q.keyWithinBlock});return j.enter().append("text").classed(p.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){g.event.stopPropagation()}),j}(function(ee){var j=ee.selectAll("."+p.cn.cellTextHolder).data(y.repeat,function(Q){return Q.keyWithinBlock});return j.enter().append("g").classed(p.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),j}(B));(function(ee){ee.each(function(j){e.font(g.select(this),j.font)})})(U),x(U,W,N,G),R(B)}function x(G,W,te,N){G.text(function(B){var U=B.column.specIndex,ee=B.rowNumber,j=B.value,Q=typeof j=="string",K=Q&&j.match(/<br>/i),re=!Q||K;B.mayHaveMarkup=Q&&j.match(/[<&>]/);var ne,le=typeof(ne=j)=="string"&&ne.match(p.latexCheck);B.latex=le;var oe,de,se=le?"":T(B.calcdata.cells.prefix,U,ee)||"",me=le?"":T(B.calcdata.cells.suffix,U,ee)||"",Te=le?null:T(B.calcdata.cells.format,U,ee)||null,_e=se+(Te?b(Te)(B.value):B.value)+me;if(B.wrappingNeeded=!B.wrapped&&!re&&!le&&(oe=c(_e)),B.cellHeightMayIncrease=K||le||B.mayHaveMarkup||(oe===void 0?c(_e):oe),B.needsConvertToTspans=B.mayHaveMarkup||B.wrappingNeeded||B.latex,B.wrappingNeeded){var be=(p.wrapSplitCharacter===" "?_e.replace(/<a href=/gi,"<a_href="):_e).split(p.wrapSplitCharacter),Ce=p.wrapSplitCharacter===" "?be.map(function(fe){return fe.replace(/<a_href=/gi,"<a href=")}):be;B.fragments=Ce.map(function(fe){return{text:fe,width:null}}),B.fragments.push({fragment:p.wrapSpacer,width:null}),de=Ce.join(p.lineBreaker)+p.lineBreaker+p.wrapSpacer}else delete B.fragments,de=_e;return de}).attr("dy",function(B){return B.needsConvertToTspans?0:"0.75em"}).each(function(B){var U=g.select(this),ee=B.wrappingNeeded?S:E;B.needsConvertToTspans?n.convertToTspans(U,N,ee(te,this,W,N,B)):g.select(this.parentNode).attr("transform",function(j){return a(D(j),p.cellPad)}).attr("text-anchor",function(j){return{left:"start",center:"middle",right:"end"}[j.align]})})}function c(G){return G.indexOf(p.wrapSplitCharacter)!==-1}function T(G,W,te){if(Array.isArray(G)){var N=G[Math.min(W,G.length-1)];return Array.isArray(N)?N[Math.min(te,N.length-1)]:N}return G}function _(G,W,te){G.transition().ease(p.releaseTransitionEase).duration(p.releaseTransitionDuration).attr("transform",a(W.x,te))}function w(G){return G.type==="cells"}function k(G){return G.type==="header"}function L(G){return(G.rowBlocks.length?G.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(W,te){return W+V(te,1/0)},0)}function A(G,W,te){var N=h(W)[0];if(N!==void 0){var B=N.rowBlocks,U=N.calcdata,ee=H(B,B.length),j=N.calcdata.groupHeight-L(N),Q=U.scrollY=Math.max(0,Math.min(ee-j,U.scrollY)),K=function(re,ne,le){for(var oe=[],de=0,se=0;se<re.length;se++){for(var me=re[se],Te=me.rows,_e=0,be=0;be<Te.length;be++)_e+=Te[be].rowHeight;me.allRowsHeight=_e,ne<de+_e&&ne+le>de&&oe.push(se),de+=_e}return oe}(B,Q,j);K.length===1&&(K[0]===B.length-1?K.unshift(K[0]-1):K.push(K[0]+1)),K[0]%2&&K.reverse(),W.each(function(re,ne){re.page=K[ne],re.scrollY=Q}),W.attr("transform",function(re){var ne=H(re.rowBlocks,re.page)-re.scrollY;return a(0,ne)}),G&&(P(G,te,W,K,N.prevPages,N,0),P(G,te,W,K,N.prevPages,N,1),d(te,G))}}function I(G,W,te,N){return function(B){var U=B.calcdata?B.calcdata:B,ee=W.filter(function(re){return U.key===re.key}),j=te||U.scrollbarState.dragMultiplier,Q=U.scrollY;U.scrollY=N===void 0?U.scrollY+j*g.event.dy:N;var K=ee.selectAll("."+p.cn.yColumn).selectAll("."+p.cn.columnBlock).filter(w);return A(G,K,ee),U.scrollY===Q}}function P(G,W,te,N,B,U,ee){N[ee]!==B[ee]&&(clearTimeout(U.currentRepaint[ee]),U.currentRepaint[ee]=setTimeout(function(){var j=te.filter(function(Q,K){return K===ee&&N[K]!==B[K]});s(G,W,j,te),B[ee]=N[ee]}))}function S(G,W,te,N){return function(){var B=g.select(W.parentNode);B.each(function(U){var ee=U.fragments;B.selectAll("tspan.line").each(function(de,se){ee[se].width=this.getComputedTextLength()});var j,Q,K=ee[ee.length-1].width,re=ee.slice(0,-1),ne=[],le=0,oe=U.column.columnWidth-2*p.cellPad;for(U.value="";re.length;)le+(Q=(j=re.shift()).width+K)>oe&&(U.value+=ne.join(p.wrapSpacer)+p.lineBreaker,ne=[],le=0),ne.push(j.text),le+=Q;le&&(U.value+=ne.join(p.wrapSpacer)),U.wrapped=!0}),B.selectAll("tspan.line").remove(),x(B.select("."+p.cn.cellText),te,G,N),g.select(W.parentNode.parentNode).call(R)}}function E(G,W,te,N,B){return function(){if(!B.settledY){var U=g.select(W.parentNode),ee=$(B),j=B.key-ee.firstRowIndex,Q=ee.rows[j].rowHeight,K=B.cellHeightMayIncrease?W.parentNode.getBoundingClientRect().height+2*p.cellPad:Q,re=Math.max(K,Q);re-ee.rows[j].rowHeight&&(ee.rows[j].rowHeight=re,G.selectAll("."+p.cn.columnCell).call(R),A(null,G.filter(w),0),d(te,N,!0)),U.attr("transform",function(){var ne=this.parentNode.getBoundingClientRect(),le=g.select(this.parentNode).select("."+p.cn.cellRect).node().getBoundingClientRect(),oe=this.transform.baseVal.consolidate(),de=le.top-ne.top+(oe?oe.matrix.f:p.cellPad);return a(D(B,g.select(this.parentNode).select("."+p.cn.cellTextHolder).node().getBoundingClientRect().width),de)}),B.settledY=!0}}}function D(G,W){switch(G.align){case"left":return p.cellPad;case"right":return G.column.columnWidth-(W||0)-p.cellPad;case"center":return(G.column.columnWidth-(W||0))/2;default:return p.cellPad}}function R(G){G.attr("transform",function(W){var te=W.rowBlocks[0].auxiliaryBlocks.reduce(function(B,U){return B+V(U,1/0)},0),N=V($(W),W.key);return a(0,N+te)}).selectAll("."+p.cn.cellRect).attr("height",function(W){return(te=$(W),N=W.key,te.rows[N-te.firstRowIndex]).rowHeight;var te,N})}function H(G,W){for(var te=0,N=W-1;N>=0;N--)te+=X(G[N]);return te}function V(G,W){for(var te=0,N=0;N<G.rows.length&&G.rows[N].rowIndex<W;N++)te+=G.rows[N].rowHeight;return te}function X(G){var W=G.allRowsHeight;if(W!==void 0)return W;for(var te=0,N=0;N<G.rows.length;N++)te+=G.rows[N].rowHeight;return G.allRowsHeight=te,te}function $(G){return G.rowBlocks[G.page]}J.exports=function(G,W){var te=!G._context.staticPlot,N=G._fullLayout._paper.selectAll("."+p.cn.table).data(W.map(function(me){var Te=y.unwrap(me).trace;return m(G,Te)}),y.keyFun);N.exit().remove(),N.enter().append("g").classed(p.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),N.attr("width",function(me){return me.width+me.size.l+me.size.r}).attr("height",function(me){return me.height+me.size.t+me.size.b}).attr("transform",function(me){return a(me.translateX,me.translateY)});var B=N.selectAll("."+p.cn.tableControlView).data(y.repeat,y.keyFun),U=B.enter().append("g").classed(p.cn.tableControlView,!0).style("box-sizing","content-box");if(te){var ee="onwheel"in document?"wheel":"mousewheel";U.on("mousemove",function(me){B.filter(function(Te){return me===Te}).call(d,G)}).on(ee,function(me){if(!me.scrollbarState.wheeling){me.scrollbarState.wheeling=!0;var Te=me.scrollY+g.event.deltaY;I(G,B,null,Te)(me)||(g.event.stopPropagation(),g.event.preventDefault()),me.scrollbarState.wheeling=!1}}).call(d,G,!0)}B.attr("transform",function(me){return a(me.size.l,me.size.t)});var j=B.selectAll("."+p.cn.scrollBackground).data(y.repeat,y.keyFun);j.enter().append("rect").classed(p.cn.scrollBackground,!0).attr("fill","none"),j.attr("width",function(me){return me.width}).attr("height",function(me){return me.height}),B.each(function(me){e.setClipUrl(g.select(this),f(G,me),G)});var Q=B.selectAll("."+p.cn.yColumn).data(function(me){return me.columns},y.keyFun);Q.enter().append("g").classed(p.cn.yColumn,!0),Q.exit().remove(),Q.attr("transform",function(me){return a(me.x,0)}),te&&Q.call(g.behavior.drag().origin(function(me){return _(g.select(this),me,-p.uplift),t(this),me.calcdata.columnDragInProgress=!0,d(B.filter(function(Te){return me.calcdata.key===Te.key}),G),me}).on("drag",function(me){var Te=g.select(this),_e=function(be){return(me===be?g.event.x:be.x)+be.columnWidth/2};me.x=Math.max(-p.overdrag,Math.min(me.calcdata.width+p.overdrag-me.columnWidth,g.event.x)),h(Q).filter(function(be){return be.calcdata.key===me.calcdata.key}).sort(function(be,Ce){return _e(be)-_e(Ce)}).forEach(function(be,Ce){be.xIndex=Ce,be.x=me===be?be.x:be.xScale(be)}),Q.filter(function(be){return me!==be}).transition().ease(p.transitionEase).duration(p.transitionDuration).attr("transform",function(be){return a(be.x,0)}),Te.call(r).attr("transform",a(me.x,-p.uplift))}).on("dragend",function(me){var Te=g.select(this),_e=me.calcdata;me.x=me.xScale(me),me.calcdata.columnDragInProgress=!1,_(Te,me,0),function(be,Ce,fe){var ve=Ce.gdColumnsOriginalOrder;Ce.gdColumns.sort(function(Me,ke){return fe[ve.indexOf(Me)]-fe[ve.indexOf(ke)]}),Ce.columnorder=fe,be.emit("plotly_restyle")}(G,_e,_e.columns.map(function(be){return be.xIndex}))})),Q.each(function(me){e.setClipUrl(g.select(this),l(G,me),G)});var K=Q.selectAll("."+p.cn.columnBlock).data(o.splitToPanels,y.keyFun);K.enter().append("g").classed(p.cn.columnBlock,!0).attr("id",function(me){return me.key}),K.style("cursor",function(me){return me.dragHandle?"ew-resize":me.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var re=K.filter(k),ne=K.filter(w);te&&ne.call(g.behavior.drag().origin(function(me){return g.event.stopPropagation(),me}).on("drag",I(G,B,-1)).on("dragend",function(){})),s(G,B,re,K),s(G,B,ne,K);var le=B.selectAll("."+p.cn.scrollAreaClip).data(y.repeat,y.keyFun);le.enter().append("clipPath").classed(p.cn.scrollAreaClip,!0).attr("id",function(me){return f(G,me)});var oe=le.selectAll("."+p.cn.scrollAreaClipRect).data(y.repeat,y.keyFun);oe.enter().append("rect").classed(p.cn.scrollAreaClipRect,!0).attr("x",-p.overdrag).attr("y",-p.uplift).attr("fill","none"),oe.attr("width",function(me){return me.width+2*p.overdrag}).attr("height",function(me){return me.height+p.uplift}),Q.selectAll("."+p.cn.columnBoundary).data(y.repeat,y.keyFun).enter().append("g").classed(p.cn.columnBoundary,!0);var de=Q.selectAll("."+p.cn.columnBoundaryClippath).data(y.repeat,y.keyFun);de.enter().append("clipPath").classed(p.cn.columnBoundaryClippath,!0),de.attr("id",function(me){return l(G,me)});var se=de.selectAll("."+p.cn.columnBoundaryRect).data(y.repeat,y.keyFun);se.enter().append("rect").classed(p.cn.columnBoundaryRect,!0).attr("fill","none"),se.attr("width",function(me){return me.columnWidth+2*u(me)}).attr("height",function(me){return me.calcdata.height+2*u(me)+p.uplift}).attr("x",function(me){return-u(me)}).attr("y",function(me){return-u(me)}),A(null,ne,B)}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"./constants":1078,"./data_preparation_helper":1079,"./data_split_helpers":1080,"@plotly/d3":58}],1084:[function(v,J,Z){var p=v("../../plots/template_attributes").hovertemplateAttrs,g=v("../../plots/template_attributes").texttemplateAttrs,b=v("../../components/colorscale/attributes"),y=v("../../plots/domain").attributes,e=v("../pie/attributes"),n=v("../sunburst/attributes"),t=v("./constants"),a=v("../../lib/extend").extendFlat;J.exports={labels:n.labels,parents:n.parents,values:n.values,branchvalues:n.branchvalues,count:n.count,level:n.level,maxdepth:n.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:a({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:n.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:n.marker.line,editType:"calc"},b("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:a({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:n.textinfo,texttemplate:g({editType:"plot"},{keys:t.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:n.hoverinfo,hovertemplate:p({},{keys:t.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:a({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:n.root,domain:y({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"./constants":1087}],1085:[function(v,J,Z){var p=v("../../plots/plots");Z.name="treemap",Z.plot=function(g,b,y,e){p.plotBasePlot(Z.name,g,b,y,e)},Z.clean=function(g,b,y,e){p.cleanBasePlot(Z.name,g,b,y,e)}},{"../../plots/plots":628}],1086:[function(v,J,Z){var p=v("../sunburst/calc");Z.calc=function(g,b){return p.calc(g,b)},Z.crossTraceCalc=function(g){return p._runCrossTraceCalc("treemap",g)}},{"../sunburst/calc":1060}],1087:[function(v,J,Z){J.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1088:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes"),b=v("../../components/color"),y=v("../../plots/domain").defaults,e=v("../bar/defaults").handleText,n=v("../bar/constants").TEXTPAD,t=v("../../components/colorscale"),a=t.hasColorscale,r=t.handleDefaults;J.exports=function(m,o,i,u){function f(w,k){return p.coerce(m,o,g,w,k)}var l=f("labels"),h=f("parents");if(l&&l.length&&h&&h.length){var d=f("values");d&&d.length?f("branchvalues"):f("count"),f("level"),f("maxdepth"),f("tiling.packing")==="squarify"&&f("tiling.squarifyratio"),f("tiling.flip"),f("tiling.pad");var s=f("text");f("texttemplate"),o.texttemplate||f("textinfo",Array.isArray(s)?"text+label":"label"),f("hovertext"),f("hovertemplate");var x=f("pathbar.visible");e(m,o,u,f,"auto",{hasPathbar:x,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),f("textposition");var c=o.textposition.indexOf("bottom")!==-1;f("marker.line.width")&&f("marker.line.color",u.paper_bgcolor);var T=f("marker.colors");(o._hasColorscale=a(m,"marker","colors")||(m.marker||{}).coloraxis)?r(m,o,u,f,{prefix:"marker.",cLetter:"c"}):f("marker.depthfade",!(T||[]).length);var _=2*o.textfont.size;f("marker.pad.t",c?_/4:_),f("marker.pad.l",_/4),f("marker.pad.r",_/4),f("marker.pad.b",c?_:_/4),o._hovered={marker:{line:{width:2,color:b.contrast(u.paper_bgcolor)}}},x&&(f("pathbar.thickness",o.pathbar.textfont.size+2*n),f("pathbar.side"),f("pathbar.edgeshape")),f("sort"),f("root.color"),y(o,u,f),o._length=null}else o.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":1084}],1089:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../sunburst/helpers"),b=v("../bar/uniform_text").clearMinTextSize,y=v("../bar/style").resizeText,e=v("./plot_one");J.exports=function(n,t,a,r,m){var o,i,u=m.type,f=m.drawDescendants,l=n._fullLayout,h=l["_"+u+"layer"],d=!a;b(u,l),(o=h.selectAll("g.trace."+u).data(t,function(s){return s[0].trace.uid})).enter().append("g").classed("trace",!0).classed(u,!0),o.order(),!l.uniformtext.mode&&g.hasTransition(a)?(r&&(i=r()),p.transition().duration(a.duration).ease(a.easing).each("end",function(){i&&i()}).each("interrupt",function(){i&&i()}).each(function(){h.selectAll("g.trace").each(function(s){e(n,s,this,a,f)})})):(o.each(function(s){e(n,s,this,a,f)}),l.uniformtext.mode&&y(n,h.selectAll(".trace"),u)),d&&o.exit().remove()}},{"../bar/style":671,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./plot_one":1098,"@plotly/d3":58}],1090:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../components/drawing"),y=v("../../lib/svg_text_utils"),e=v("./partition"),n=v("./style").styleOne,t=v("./constants"),a=v("../sunburst/helpers"),r=v("../sunburst/fx");J.exports=function(m,o,i,u,f){var l=f.barDifY,h=f.width,d=f.height,s=f.viewX,x=f.viewY,c=f.pathSlice,T=f.toMoveInsideSlice,_=f.strTransform,w=f.hasTransition,k=f.handleSlicesExit,L=f.makeUpdateSliceInterpolator,A=f.makeUpdateTextInterpolator,I={},P=m._fullLayout,S=o[0],E=S.trace,D=S.hierarchy,R=h/E._entryDepth,H=a.listPath(i.data,"id"),V=e(D.copy(),[h,d],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(V=V.filter(function($){var G=H.indexOf($.data.id);return G!==-1&&($.x0=R*G,$.x1=R*(G+1),$.y0=l,$.y1=l+d,$.onPathbar=!0,!0)})).reverse(),(u=u.data(V,a.getPtId)).enter().append("g").classed("pathbar",!0),k(u,!0,I,[h,d],c),u.order();var X=u;w&&(X=X.transition().each("end",function(){var $=p.select(this);a.setSliceCursor($,m,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),X.each(function($){$._x0=s($.x0),$._x1=s($.x1),$._y0=x($.y0),$._y1=x($.y1),$._hoverX=s($.x1-Math.min(h,d)/2),$._hoverY=x($.y1-d/2);var G=p.select(this),W=g.ensureSingle(G,"path","surface",function(U){U.style("pointer-events","all")});w?W.transition().attrTween("d",function(U){var ee=L(U,!0,I,[h,d]);return function(j){return c(ee(j))}}):W.attr("d",c),G.call(r,i,m,o,{styleOne:n,eventDataKeys:t.eventDataKeys,transitionTime:t.CLICK_TRANSITION_TIME,transitionEasing:t.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,m,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:m._transitioning}),W.call(n,$,E,{hovered:!1}),$._text=(a.getPtLabel($)||"").split("<br>").join(" ")||"";var te=g.ensureSingle(G,"g","slicetext"),N=g.ensureSingle(te,"text","",function(U){U.attr("data-notex",1)}),B=g.ensureUniformFontSize(m,a.determineTextFont(E,$,P.font,{onPathbar:!0}));N.text($._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(b.font,B).call(y.convertToTspans,m),$.textBB=b.bBox(N.node()),$.transform=T($,{fontSize:B.size,onPathbar:!0}),$.transform.fontSize=B.size,w?N.transition().attrTween("transform",function(U){var ee=A(U,!0,I,[h,d]);return function(j){return _(ee(j))}}):N.attr("transform",_($))})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1091:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../components/drawing"),y=v("../../lib/svg_text_utils"),e=v("./partition"),n=v("./style").styleOne,t=v("./constants"),a=v("../sunburst/helpers"),r=v("../sunburst/fx"),m=v("../sunburst/plot").formatSliceLabel;J.exports=function(o,i,u,f,l){var h=l.width,d=l.height,s=l.viewX,x=l.viewY,c=l.pathSlice,T=l.toMoveInsideSlice,_=l.strTransform,w=l.hasTransition,k=l.handleSlicesExit,L=l.makeUpdateSliceInterpolator,A=l.makeUpdateTextInterpolator,I=l.prevEntry,P=o._fullLayout,S=i[0].trace,E=S.textposition.indexOf("left")!==-1,D=S.textposition.indexOf("right")!==-1,R=S.textposition.indexOf("bottom")!==-1,H=!R&&!S.marker.pad.t||R&&!S.marker.pad.b,V=e(u,[h,d],{packing:S.tiling.packing,squarifyratio:S.tiling.squarifyratio,flipX:S.tiling.flip.indexOf("x")>-1,flipY:S.tiling.flip.indexOf("y")>-1,pad:{inner:S.tiling.pad,top:S.marker.pad.t,left:S.marker.pad.l,right:S.marker.pad.r,bottom:S.marker.pad.b}}).descendants(),X=1/0,$=-1/0;V.forEach(function(B){var U=B.depth;U>=S._maxDepth?(B.x0=B.x1=(B.x0+B.x1)/2,B.y0=B.y1=(B.y0+B.y1)/2):(X=Math.min(X,U),$=Math.max($,U))}),f=f.data(V,a.getPtId),S._maxVisibleLayers=isFinite($)?$-X+1:0,f.enter().append("g").classed("slice",!0),k(f,!1,{},[h,d],c),f.order();var G=null;if(w&&I){var W=a.getPtId(I);f.each(function(B){G===null&&a.getPtId(B)===W&&(G={x0:B.x0,x1:B.x1,y0:B.y0,y1:B.y1})})}var te=function(){return G||{x0:0,x1:h,y0:0,y1:d}},N=f;return w&&(N=N.transition().each("end",function(){var B=p.select(this);a.setSliceCursor(B,o,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),N.each(function(B){var U=a.isHeader(B,S);B._x0=s(B.x0),B._x1=s(B.x1),B._y0=x(B.y0),B._y1=x(B.y1),B._hoverX=s(B.x1-S.marker.pad.r),B._hoverY=x(R?B.y1-S.marker.pad.b/2:B.y0+S.marker.pad.t/2);var ee=p.select(this),j=g.ensureSingle(ee,"path","surface",function(ne){ne.style("pointer-events","all")});w?j.transition().attrTween("d",function(ne){var le=L(ne,!1,te(),[h,d]);return function(oe){return c(le(oe))}}):j.attr("d",c),ee.call(r,u,o,i,{styleOne:n,eventDataKeys:t.eventDataKeys,transitionTime:t.CLICK_TRANSITION_TIME,transitionEasing:t.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,o,{isTransitioning:o._transitioning}),j.call(n,B,S,{hovered:!1}),B.x0===B.x1||B.y0===B.y1?B._text="":B._text=U?H?"":a.getPtLabel(B)||"":m(B,u,S,i,P)||"";var Q=g.ensureSingle(ee,"g","slicetext"),K=g.ensureSingle(Q,"text","",function(ne){ne.attr("data-notex",1)}),re=g.ensureUniformFontSize(o,a.determineTextFont(S,B,P.font));K.text(B._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":E||U?"start":"middle").call(b.font,re).call(y.convertToTspans,o),B.textBB=b.bBox(K.node()),B.transform=T(B,{fontSize:re.size,isHeader:U}),B.transform.fontSize=re.size,w?K.transition().attrTween("transform",function(ne){var le=A(ne,!1,te(),[h,d]);return function(oe){return _(le(oe))}}):K.attr("transform",_(B))}),G}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1092:[function(v,J,Z){J.exports=function p(g,b,y){var e;y.swapXY&&(e=g.x0,g.x0=g.y0,g.y0=e,e=g.x1,g.x1=g.y1,g.y1=e),y.flipX&&(e=g.x0,g.x0=b[0]-g.x1,g.x1=b[0]-e),y.flipY&&(e=g.y0,g.y0=b[1]-g.y1,g.y1=b[1]-e);var n=g.children;if(n)for(var t=0;t<n.length;t++)p(n[t],b,y)}},{}],1093:[function(v,J,Z){J.exports={moduleType:"trace",name:"treemap",basePlotModule:v("./base_plot"),categories:[],animatable:!0,attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),style:v("./style").style,colorbar:v("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1084,"./base_plot":1085,"./calc":1086,"./defaults":1088,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1097,"./style":1099}],1094:[function(v,J,Z){J.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1095:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes");J.exports=function(b,y){function e(n,t){return p.coerce(b,y,g,n,t)}e("treemapcolorway",y.colorway),e("extendtreemapcolors")}},{"../../lib":515,"./layout_attributes":1094}],1096:[function(v,J,Z){var p=v("d3-hierarchy"),g=v("./flip_tree");J.exports=function(b,y,e){var n,t=e.flipX,a=e.flipY,r=e.packing==="dice-slice",m=e.pad[a?"bottom":"top"],o=e.pad[t?"right":"left"],i=e.pad[t?"left":"right"],u=e.pad[a?"top":"bottom"];r&&(n=o,o=m,m=n,n=i,i=u,u=n);var f=p.treemap().tile(function(l,h){switch(l){case"squarify":return p.treemapSquarify.ratio(h);case"binary":return p.treemapBinary;case"dice":return p.treemapDice;case"slice":return p.treemapSlice;default:return p.treemapSliceDice}}(e.packing,e.squarifyratio)).paddingInner(e.pad.inner).paddingLeft(o).paddingRight(i).paddingTop(m).paddingBottom(u).size(r?[y[1],y[0]]:y)(b);return(r||t||a)&&g(f,y,{swapXY:r,flipX:t,flipY:a}),f}},{"./flip_tree":1092,"d3-hierarchy":115}],1097:[function(v,J,Z){var p=v("./draw"),g=v("./draw_descendants");J.exports=function(b,y,e,n){return p(b,y,e,n,{type:"treemap",drawDescendants:g})}},{"./draw":1089,"./draw_descendants":1091}],1098:[function(v,J,Z){var p=v("@plotly/d3"),g=v("d3-interpolate").interpolate,b=v("../sunburst/helpers"),y=v("../../lib"),e=v("../bar/constants").TEXTPAD,n=v("../bar/plot").toMoveInsideBar,t=v("../bar/uniform_text").recordMinTextSize,a=v("./constants"),r=v("./draw_ancestors");function m(o){return b.isHierarchyRoot(o)?"":b.getPtId(o)}J.exports=function(o,i,u,f,l){var h=o._fullLayout,d=i[0],s=d.trace,x=s.type==="icicle",c=d.hierarchy,T=b.findEntryWithLevel(c,s.level),_=p.select(u),w=_.selectAll("g.pathbar"),k=_.selectAll("g.slice");if(!T)return w.remove(),void k.remove();var L=b.isHierarchyRoot(T),A=!h.uniformtext.mode&&b.hasTransition(f),I=b.getMaxDepth(s),P=h._size,S=s.domain,E=P.w*(S.x[1]-S.x[0]),D=P.h*(S.y[1]-S.y[0]),R=E,H=s.pathbar.thickness,V=s.marker.line.width+a.gapWithPathbar,X=s.pathbar.visible?s.pathbar.side.indexOf("bottom")>-1?D+V:-(H+V):0,$={x0:R,x1:R,y0:X,y1:X+H},G=function(Le,ze,Re){var Oe=s.tiling.pad,Ze=function(Fe){return Fe-Oe<=ze.x0},Pe=function(Fe){return Fe+Oe>=ze.x1},Ie=function(Fe){return Fe-Oe<=ze.y0},Be=function(Fe){return Fe+Oe>=ze.y1};return Le.x0===ze.x0&&Le.x1===ze.x1&&Le.y0===ze.y0&&Le.y1===ze.y1?{x0:Le.x0,x1:Le.x1,y0:Le.y0,y1:Le.y1}:{x0:Ze(Le.x0-Oe)?0:Pe(Le.x0-Oe)?Re[0]:Le.x0,x1:Ze(Le.x1+Oe)?0:Pe(Le.x1+Oe)?Re[0]:Le.x1,y0:Ie(Le.y0-Oe)?0:Be(Le.y0-Oe)?Re[1]:Le.y0,y1:Ie(Le.y1+Oe)?0:Be(Le.y1+Oe)?Re[1]:Le.y1}},W=null,te={},N={},B=null,U=function(Le,ze){return ze?te[m(Le)]:N[m(Le)]},ee=function(Le,ze,Re,Oe){if(ze)return te[m(c)]||$;var Ze=N[s.level]||Re;return function(Pe){return Pe.data.depth-T.data.depth<I}(Le)?G(Le,Ze,Oe):{}};d.hasMultipleRoots&&L&&I++,s._maxDepth=I,s._backgroundColor=h.paper_bgcolor,s._entryDepth=T.data.depth,s._atRootLevel=L;var j=-E/2+P.l+P.w*(S.x[1]+S.x[0])/2,Q=-D/2+P.t+P.h*(1-(S.y[1]+S.y[0])/2),K=function(Le){return j+Le},re=function(Le){return Q+Le},ne=re(0),le=K(0),oe=function(Le){return le+Le},de=function(Le){return ne+Le};function se(Le,ze){return Le+","+ze}var me=oe(0),Te=function(Le){Le.x=Math.max(me,Le.x)},_e=s.pathbar.edgeshape,be=function(Le,ze){var Re=Le.x0,Oe=Le.x1,Ze=Le.y0,Pe=Le.y1,Ie=Le.textBB,Be=function(vt){return s.textposition.indexOf(vt)!==-1},Fe=Be("bottom"),$e=Be("top")||ze.isHeader&&!Fe?"start":Fe?"end":"middle",ot=Be("right"),pt=Be("left")||ze.onPathbar?-1:ot?1:0,_t=s[x?"tiling":"marker"].pad;if(ze.isHeader){if((Re+=(x?_t:_t.l)-e)>=(Oe-=(x?_t:_t.r)-e)){var yt=(Re+Oe)/2;Re=yt,Oe=yt}var tt;Fe?Ze<(tt=Pe-(x?_t:_t.b))&&tt<Pe&&(Ze=tt):Ze<(tt=Ze+(x?_t:_t.t))&&tt<Pe&&(Pe=tt)}var Ke=n(Re,Oe,Ze,Pe,Ie,{isHorizontal:!1,constrained:!0,angle:0,anchor:$e,leftToRight:pt});return Ke.fontSize=ze.fontSize,Ke.targetX=K(Ke.targetX),Ke.targetY=re(Ke.targetY),isNaN(Ke.targetX)||isNaN(Ke.targetY)?{}:(Re!==Oe&&Ze!==Pe&&t(s.type,Ke,h),{scale:Ke.scale,rotate:Ke.rotate,textX:Ke.textX,textY:Ke.textY,anchorX:Ke.anchorX,anchorY:Ke.anchorY,targetX:Ke.targetX,targetY:Ke.targetY})},Ce=function(Le,ze){for(var Re,Oe=0,Ze=Le;!Re&&Oe<I;)Oe++,(Ze=Ze.parent)?Re=U(Ze,ze):Oe=I;return Re||{}},fe=function(Le,ze,Re,Oe,Ze){var Pe,Ie=U(Le,ze);if(Ie)Pe=Ie;else if(ze)Pe=$;else if(W)if(Le.parent){var Be=B||Re;Be&&!ze?Pe=G(Le,Be,Oe):(Pe={},y.extendFlat(Pe,Ce(Le,ze)))}else Pe=y.extendFlat({},Le),x&&(Ze.orientation==="h"?Ze.flipX?Pe.x0=Le.x1:Pe.x1=0:Ze.flipY?Pe.y0=Le.y1:Pe.y1=0);else Pe={};return g(Pe,{x0:Le.x0,x1:Le.x1,y0:Le.y0,y1:Le.y1})},ve=function(Le,ze,Re,Oe){var Ze=U(Le,ze),Pe={},Ie=ee(Le,ze,Re,Oe);y.extendFlat(Pe,{transform:be({x0:Ie.x0,x1:Ie.x1,y0:Ie.y0,y1:Ie.y1,textBB:Le.textBB,_text:Le._text},{isHeader:b.isHeader(Le,s)})}),Ze?Pe=Ze:Le.parent&&y.extendFlat(Pe,Ce(Le,ze));var Be=Le.transform;return Le.x0!==Le.x1&&Le.y0!==Le.y1&&t(s.type,Be,h),g(Pe,{transform:{scale:Be.scale,rotate:Be.rotate,textX:Be.textX,textY:Be.textY,anchorX:Be.anchorX,anchorY:Be.anchorY,targetX:Be.targetX,targetY:Be.targetY}})},Me=function(Le,ze,Re,Oe,Ze){var Pe=Oe[0],Ie=Oe[1];A?Le.exit().transition().each(function(){var Be=p.select(this);Be.select("path.surface").transition().attrTween("d",function(Fe){var $e=function(ot,pt,_t,yt){var tt,Ke=U(ot,pt);if(pt)tt=$;else{var vt=U(T,pt);tt=vt?G(ot,vt,yt):{}}return g(Ke,tt)}(Fe,ze,0,[Pe,Ie]);return function(ot){return Ze($e(ot))}}),Be.select("g.slicetext").attr("opacity",0)}).remove():Le.exit().remove()},ke=function(Le){var ze=Le.transform;return Le.x0!==Le.x1&&Le.y0!==Le.y1&&t(s.type,ze,h),y.getTextTransform({textX:ze.textX,textY:ze.textY,anchorX:ze.anchorX,anchorY:ze.anchorY,targetX:ze.targetX,targetY:ze.targetY,scale:ze.scale,rotate:ze.rotate})};A&&(w.each(function(Le){te[m(Le)]={x0:Le.x0,x1:Le.x1,y0:Le.y0,y1:Le.y1},Le.transform&&(te[m(Le)].transform={textX:Le.transform.textX,textY:Le.transform.textY,anchorX:Le.transform.anchorX,anchorY:Le.transform.anchorY,targetX:Le.transform.targetX,targetY:Le.transform.targetY,scale:Le.transform.scale,rotate:Le.transform.rotate})}),k.each(function(Le){N[m(Le)]={x0:Le.x0,x1:Le.x1,y0:Le.y0,y1:Le.y1},Le.transform&&(N[m(Le)].transform={textX:Le.transform.textX,textY:Le.transform.textY,anchorX:Le.transform.anchorX,anchorY:Le.transform.anchorY,targetX:Le.transform.targetX,targetY:Le.transform.targetY,scale:Le.transform.scale,rotate:Le.transform.rotate}),!W&&b.isEntry(Le)&&(W=Le)})),B=l(o,i,T,k,{width:E,height:D,viewX:K,viewY:re,pathSlice:function(Le){var ze=K(Le.x0),Re=K(Le.x1),Oe=re(Le.y0),Ze=re(Le.y1),Pe=Re-ze,Ie=Ze-Oe;return!Pe||!Ie?"":"M"+se(ze,Oe+0)+"L"+se(Re-0,Oe)+"L"+se(Re,Ze-0)+"L"+se(ze+0,Ze)+"Z"},toMoveInsideSlice:be,prevEntry:W,makeUpdateSliceInterpolator:fe,makeUpdateTextInterpolator:ve,handleSlicesExit:Me,hasTransition:A,strTransform:ke}),s.pathbar.visible?r(o,i,T,w,{barDifY:X,width:R,height:H,viewX:oe,viewY:de,pathSlice:function(Le){var ze=oe(Math.max(Math.min(Le.x0,Le.x0),0)),Re=oe(Math.min(Math.max(Le.x1,Le.x1),R)),Oe=de(Le.y0),Ze=de(Le.y1),Pe=H/2,Ie={},Be={};Ie.x=ze,Be.x=Re,Ie.y=Be.y=(Oe+Ze)/2;var Fe={x:ze,y:Oe},$e={x:Re,y:Oe},ot={x:Re,y:Ze},pt={x:ze,y:Ze};return _e===">"?(Fe.x-=Pe,$e.x-=Pe,ot.x-=Pe,pt.x-=Pe):_e==="/"?(ot.x-=Pe,pt.x-=Pe,Ie.x-=Pe/2,Be.x-=Pe/2):_e==="\\"?(Fe.x-=Pe,$e.x-=Pe,Ie.x-=Pe/2,Be.x-=Pe/2):_e==="<"&&(Ie.x-=Pe,Be.x-=Pe),Te(Fe),Te(pt),Te(Ie),Te($e),Te(ot),Te(Be),"M"+se(Fe.x,Fe.y)+"L"+se($e.x,$e.y)+"L"+se(Be.x,Be.y)+"L"+se(ot.x,ot.y)+"L"+se(pt.x,pt.y)+"L"+se(Ie.x,Ie.y)+"Z"},toMoveInsideSlice:be,makeUpdateSliceInterpolator:fe,makeUpdateTextInterpolator:ve,handleSlicesExit:Me,hasTransition:A,strTransform:ke}):w.remove()}},{"../../lib":515,"../bar/constants":659,"../bar/plot":668,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./constants":1087,"./draw_ancestors":1090,"@plotly/d3":58,"d3-interpolate":116}],1099:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/color"),b=v("../../lib"),y=v("../sunburst/helpers"),e=v("../bar/uniform_text").resizeText;function n(t,a,r,m){var o,i,u=(m||{}).hovered,f=a.data.data,l=f.i,h=f.color,d=y.isHierarchyRoot(a),s=1;if(u)o=r._hovered.marker.line.color,i=r._hovered.marker.line.width;else if(d&&h===r.root.color)s=100,o="rgba(0,0,0,0)",i=0;else if(o=b.castOption(r,l,"marker.line.color")||g.defaultLine,i=b.castOption(r,l,"marker.line.width")||0,!r._hasColorscale&&!a.onPathbar){var x=r.marker.depthfade;if(x){var c,T=g.combine(g.addOpacity(r._backgroundColor,.75),h);if(x===!0){var _=y.getMaxDepth(r);c=isFinite(_)?y.isLeaf(a)?0:r._maxVisibleLayers-(a.data.depth-r._entryDepth):a.data.height+1}else c=a.data.depth-r._entryDepth,r._atRootLevel||c++;if(c>0)for(var w=0;w<c;w++){var k=.5*w/c;h=g.combine(g.addOpacity(T,k),h)}}}t.style("stroke-width",i).call(g.fill,h).call(g.stroke,o).style("opacity",s)}J.exports={style:function(t){var a=t._fullLayout._treemaplayer.selectAll(".trace");e(t,a,"treemap"),a.each(function(r){var m=p.select(this),o=r[0].trace;m.style("opacity",o.opacity),m.selectAll("path.surface").each(function(i){p.select(this).call(n,i,o,{hovered:!1})})})},styleOne:n}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"../sunburst/helpers":1064,"@plotly/d3":58}],1100:[function(v,J,Z){var p=v("../box/attributes"),g=v("../../lib/extend").extendFlat,b=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat;J.exports={y:p.y,x:p.x,x0:p.x0,y0:p.y0,xhoverformat:b("x"),yhoverformat:b("y"),name:g({},p.name,{}),orientation:g({},p.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:p.fillcolor,points:g({},p.boxpoints,{}),jitter:g({},p.jitter,{}),pointpos:g({},p.pointpos,{}),width:g({},p.width,{}),marker:p.marker,text:p.text,hovertext:p.hovertext,hovertemplate:p.hovertemplate,quartilemethod:p.quartilemethod,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:p.offsetgroup,alignmentgroup:p.alignmentgroup,selected:p.selected,unselected:p.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682}],1101:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes"),b=v("../box/calc"),y=v("./helpers"),e=v("../../constants/numerical").BADNUM;function n(a,r,m){var o=r.max-r.min;if(!o)return a.bandwidth?a.bandwidth:0;if(a.bandwidth)return Math.max(a.bandwidth,o/1e4);var i=m.length,u=p.stdev(m,i-1,r.mean);return Math.max(function(f,l,h){return 1.059*Math.min(l,h/1.349)*Math.pow(f,-.2)}(i,u,r.q3-r.q1),o/100)}function t(a,r,m,o){var i,u=a.spanmode,f=a.span||[],l=[r.min,r.max],h=[r.min-2*o,r.max+2*o];function d(x){var c=f[x],T=m.type==="multicategory"?m.r2c(c):m.d2c(c,0,a[r.valLetter+"calendar"]);return T===e?h[x]:T}var s={type:"linear",range:i=u==="soft"?h:u==="hard"?l:[d(0),d(1)]};return g.setConvert(s),s.cleanRange(),i}J.exports=function(a,r){var m=b(a,r);if(m[0].t.empty)return m;for(var o=a._fullLayout,i=g.getFromId(a,r[r.orientation==="h"?"xaxis":"yaxis"]),u=1/0,f=-1/0,l=0,h=0,d=0;d<m.length;d++){var s=m[d],x=s.pts.map(y.extractVal),c=s.bandwidth=n(r,s,x),T=s.span=t(r,s,i,c);if(s.min===s.max&&c===0)T=s.span=[s.min,s.max],s.density=[{v:1,t:T[0]}],s.bandwidth=c,l=Math.max(l,1);else{var _=T[1]-T[0],w=Math.ceil(_/(c/3)),k=_/w;if(!isFinite(k)||!isFinite(w))return p.error("Something went wrong with computing the violin span"),m[0].t.empty=!0,m;var L=y.makeKDE(s,r,x);s.density=new Array(w);for(var A=0,I=T[0];I<T[1]+k/2;A++,I+=k){var P=L(I);s.density[A]={v:P,t:I},l=Math.max(l,P)}}h=Math.max(h,x.length),u=Math.min(u,T[0]),f=Math.max(f,T[1])}var S=g.findExtremes(i,[u,f],{padded:!0});if(r._extremes[i._id]=S,r.width)m[0].t.maxKDE=l;else{var E=o._violinScaleGroupStats,D=r.scalegroup,R=E[D];R?(R.maxKDE=Math.max(R.maxKDE,l),R.maxCount=Math.max(R.maxCount,h)):E[D]={maxKDE:l,maxCount:h}}return m[0].t.labels.kde=p._(a,"kde:"),m}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../box/calc":683,"./helpers":1104}],1102:[function(v,J,Z){var p=v("../box/cross_trace_calc").setPositionOffset,g=["v","h"];J.exports=function(b,y){for(var e=b.calcdata,n=y.xaxis,t=y.yaxis,a=0;a<g.length;a++){for(var r=g[a],m=r==="h"?t:n,o=[],i=0;i<e.length;i++){var u=e[i],f=u[0].t,l=u[0].trace;l.visible!==!0||l.type!=="violin"||f.empty||l.orientation!==r||l.xaxis!==n._id||l.yaxis!==t._id||o.push(i)}p("violin",b,o,m)}}},{"../box/cross_trace_calc":684}],1103:[function(v,J,Z){var p=v("../../lib"),g=v("../../components/color"),b=v("../box/defaults"),y=v("./attributes");J.exports=function(e,n,t,a){function r(_,w){return p.coerce(e,n,y,_,w)}function m(_,w){return p.coerce2(e,n,y,_,w)}if(b.handleSampleDefaults(e,n,r,a),n.visible!==!1){r("bandwidth"),r("side"),r("width")||(r("scalegroup",n.name),r("scalemode"));var o,i=r("span");Array.isArray(i)&&(o="manual"),r("spanmode",o);var u=r("line.color",(e.marker||{}).color||t),f=r("line.width"),l=r("fillcolor",g.addOpacity(n.line.color,.5));b.handlePointsDefaults(e,n,r,{prefix:""});var h=m("box.width"),d=m("box.fillcolor",l),s=m("box.line.color",u),x=m("box.line.width",f);r("box.visible",Boolean(h||d||s||x))||(n.box={visible:!1});var c=m("meanline.color",u),T=m("meanline.width",f);r("meanline.visible",Boolean(c||T))||(n.meanline={visible:!1}),r("quartilemethod")}}},{"../../components/color":367,"../../lib":515,"../box/defaults":685,"./attributes":1100}],1104:[function(v,J,Z){var p=v("../../lib"),g=function(b){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*b*b)};Z.makeKDE=function(b,y,e){var n=e.length,t=g,a=b.bandwidth,r=1/(n*a);return function(m){for(var o=0,i=0;i<n;i++)o+=t((m-e[i])/a);return r*o}},Z.getPositionOnKdePath=function(b,y,e){var n,t;y.orientation==="h"?(n="y",t="x"):(n="x",t="y");var a=p.findPointOnPath(b.path,e,t,{pathLength:b.pathLength}),r=b.posCenterPx,m=a[n];return[m,y.side==="both"?2*r-m:r]},Z.getKdeValue=function(b,y,e){var n=b.pts.map(Z.extractVal);return Z.makeKDE(b,y,n)(e)/b.posDensityScale},Z.extractVal=function(b){return b.v}},{"../../lib":515}],1105:[function(v,J,Z){var p=v("../../lib"),g=v("../../plots/cartesian/axes"),b=v("../box/hover"),y=v("./helpers");J.exports=function(e,n,t,a,r){r||(r={});var m,o,i=r.hoverLayer,u=e.cd,f=u[0].trace,l=f.hoveron,h=l.indexOf("violins")!==-1,d=l.indexOf("kde")!==-1,s=[];if(h||d){var x=b.hoverOnBoxes(e,n,t,a);if(d&&x.length>0){var c,T,_,w,k,L=e.xa,A=e.ya;f.orientation==="h"?(k=n,c="y",_=A,T="x",w=L):(k=t,c="x",_=L,T="y",w=A);var I=u[e.index];if(k>=I.span[0]&&k<=I.span[1]){var P=p.extendFlat({},e),S=w.c2p(k,!0),E=y.getKdeValue(I,f,k),D=y.getPositionOnKdePath(I,f,S),R=_._offset,H=_._length;P[c+"0"]=D[0],P[c+"1"]=D[1],P[T+"0"]=P[T+"1"]=S,P[T+"Label"]=T+": "+g.hoverLabelText(w,k,f[T+"hoverformat"])+", "+u[0].t.labels.kde+" "+E.toFixed(3);for(var V=0,X=0;X<x.length;X++)if(x[X].attr==="med"){V=X;break}P.spikeDistance=x[V].spikeDistance;var $=c+"Spike";P[$]=x[V][$],x[V].spikeDistance=void 0,x[V][$]=void 0,P.hovertemplate=!1,s.push(P),(o={stroke:e.color})[c+"1"]=p.constrain(R+D[0],R,R+H),o[c+"2"]=p.constrain(R+D[1],R,R+H),o[T+"1"]=o[T+"2"]=w._offset+S}}h&&(s=s.concat(x))}l.indexOf("points")!==-1&&(m=b.hoverOnPoints(e,n,t));var G=i.selectAll(".violinline-"+f.uid).data(o?[0]:[]);return G.enter().append("line").classed("violinline-"+f.uid,!0).attr("stroke-width",1.5),G.exit().remove(),G.attr(o),a==="closest"?m?[m]:s:(m&&s.push(m),s)}},{"../../lib":515,"../../plots/cartesian/axes":566,"../box/hover":687,"./helpers":1104}],1106:[function(v,J,Z){J.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc"),plot:v("./plot"),style:v("./style"),styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../box/select"),moduleType:"trace",name:"violin",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../box/defaults":685,"../box/select":692,"../scatter/style":960,"./attributes":1100,"./calc":1101,"./cross_trace_calc":1102,"./defaults":1103,"./hover":1105,"./layout_attributes":1107,"./layout_defaults":1108,"./plot":1109,"./style":1110}],1107:[function(v,J,Z){var p=v("../box/layout_attributes"),g=v("../../lib").extendFlat;J.exports={violinmode:g({},p.boxmode,{}),violingap:g({},p.boxgap,{}),violingroupgap:g({},p.boxgroupgap,{})}},{"../../lib":515,"../box/layout_attributes":689}],1108:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes"),b=v("../box/layout_defaults");J.exports=function(y,e,n){b._supply(y,e,n,function(t,a){return p.coerce(y,e,g,t,a)},"violin")}},{"../../lib":515,"../box/layout_defaults":690,"./layout_attributes":1107}],1109:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../components/drawing"),y=v("../box/plot"),e=v("../scatter/line_points"),n=v("./helpers");J.exports=function(t,a,r,m){var o=t._fullLayout,i=a.xaxis,u=a.yaxis;function f(l){var h=e(l,{xaxis:i,yaxis:u,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return b.smoothopen(h[0],1)}g.makeTraceGroups(m,r,"trace violins").each(function(l){var h=p.select(this),d=l[0],s=d.t,x=d.trace;if(x.visible!==!0||s.empty)h.remove();else{var c=s.bPos,T=s.bdPos,_=a[s.valLetter+"axis"],w=a[s.posLetter+"axis"],k=x.side==="both",L=k||x.side==="positive",A=k||x.side==="negative",I=h.selectAll("path.violin").data(g.identity);I.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),I.exit().remove(),I.each(function(X){var $,G,W,te,N,B,U,ee,j=p.select(this),Q=X.density,K=Q.length,re=w.c2l(X.pos+c,!0),ne=w.l2p(re);if(x.width)$=s.maxKDE/T;else{var le=o._violinScaleGroupStats[x.scalegroup];$=x.scalemode==="count"?le.maxKDE/T*(le.maxCount/X.pts.length):le.maxKDE/T}if(L){for(U=new Array(K),N=0;N<K;N++)(ee=U[N]={})[s.posLetter]=re+Q[N].v/$,ee[s.valLetter]=_.c2l(Q[N].t,!0);G=f(U)}if(A){for(U=new Array(K),B=0,N=K-1;B<K;B++,N--)(ee=U[B]={})[s.posLetter]=re-Q[N].v/$,ee[s.valLetter]=_.c2l(Q[N].t,!0);W=f(U)}if(k)te=G+"L"+W.substr(1)+"Z";else{var oe=[ne,_.c2p(Q[0].t)],de=[ne,_.c2p(Q[K-1].t)];x.orientation==="h"&&(oe.reverse(),de.reverse()),te=L?"M"+oe+"L"+G.substr(1)+"L"+de:"M"+de+"L"+W.substr(1)+"L"+oe}j.attr("d",te),X.posCenterPx=ne,X.posDensityScale=$*T,X.path=j.node(),X.pathLength=X.path.getTotalLength()/(k?2:1)});var P,S,E,D=x.box,R=D.width,H=(D.line||{}).width;k?(P=T*R,S=0):L?(P=[0,T*R/2],S=H*{x:1,y:-1}[s.posLetter]):(P=[T*R/2,0],S=H*{x:-1,y:1}[s.posLetter]),y.plotBoxAndWhiskers(h,{pos:w,val:_},x,{bPos:c,bdPos:P,bPosPxOffset:S}),y.plotBoxMean(h,{pos:w,val:_},x,{bPos:c,bdPos:P,bPosPxOffset:S}),!x.box.visible&&x.meanline.visible&&(E=g.identity);var V=h.selectAll("path.meanline").data(E||[]);V.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),V.exit().remove(),V.each(function(X){var $=_.c2p(X.mean,!0),G=n.getPositionOnKdePath(X,x,$);p.select(this).attr("d",x.orientation==="h"?"M"+$+","+G[0]+"V"+G[1]:"M"+G[0]+","+$+"H"+G[1])}),y.plotPoints(h,{x:i,y:u},x,s)}})}},{"../../components/drawing":389,"../../lib":515,"../box/plot":691,"../scatter/line_points":950,"./helpers":1104,"@plotly/d3":58}],1110:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/color"),b=v("../scatter/style").stylePoints;J.exports=function(y){var e=p.select(y).selectAll("g.trace.violins");e.style("opacity",function(n){return n[0].trace.opacity}),e.each(function(n){var t=n[0].trace,a=p.select(this),r=t.box||{},m=r.line||{},o=t.meanline||{},i=o.width;a.selectAll("path.violin").style("stroke-width",t.line.width+"px").call(g.stroke,t.line.color).call(g.fill,t.fillcolor),a.selectAll("path.box").style("stroke-width",m.width+"px").call(g.stroke,m.color).call(g.fill,r.fillcolor);var u={"stroke-width":i+"px","stroke-dasharray":2*i+"px,"+i+"px"};a.selectAll("path.mean").style(u).call(g.stroke,o.color),a.selectAll("path.meanline").style(u).call(g.stroke,o.color),b(a,t,y)})}},{"../../components/color":367,"../scatter/style":960,"@plotly/d3":58}],1111:[function(v,J,Z){var p=v("../../components/colorscale/attributes"),g=v("../isosurface/attributes"),b=v("../surface/attributes"),y=v("../../plots/attributes"),e=v("../../lib/extend").extendFlat,n=v("../../plot_api/edit_types").overrideAll,t=J.exports=n(e({x:g.x,y:g.y,z:g.z,value:g.value,isomin:g.isomin,isomax:g.isomax,surface:g.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:g.slices,caps:g.caps,text:g.text,hovertext:g.hovertext,xhoverformat:g.xhoverformat,yhoverformat:g.yhoverformat,zhoverformat:g.zhoverformat,valuehoverformat:g.valuehoverformat,hovertemplate:g.hovertemplate},p("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:g.colorbar,opacity:g.opacity,opacityscale:b.opacityscale,lightposition:g.lightposition,lighting:g.lighting,flatshading:g.flatshading,contour:g.contour,hoverinfo:e({},y.hoverinfo),showlegend:e({},y.showlegend,{dflt:!1})}),"calc","nested");t.x.editType=t.y.editType=t.z.editType=t.value.editType="calc+clearAxisTypes",t.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../isosurface/attributes":871,"../surface/attributes":1070}],1112:[function(v,J,Z){var p=v("../../../stackgl_modules").gl_mesh3d,g=v("../../lib/gl_format_color").parseColorScale,b=v("../../lib/str2rgbarray"),y=v("../../components/colorscale").extractOpts,e=v("../../plots/gl3d/zip3"),n=v("../isosurface/convert").findNearestOnAxis,t=v("../isosurface/convert").generateIsoMeshes;function a(m,o,i){this.scene=m,this.uid=i,this.mesh=o,this.name="",this.data=null,this.showContour=!1}var r=a.prototype;r.handlePick=function(m){if(m.object===this.mesh){var o=m.data.index,i=this.data._meshX[o],u=this.data._meshY[o],f=this.data._meshZ[o],l=this.data._Ys.length,h=this.data._Zs.length,d=n(i,this.data._Xs).id,s=n(u,this.data._Ys).id,x=n(f,this.data._Zs).id,c=m.index=x+h*s+h*l*d;m.traceCoordinate=[this.data._meshX[c],this.data._meshY[c],this.data._meshZ[c],this.data._value[c]];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&T[c]!==void 0?m.textLabel=T[c]:T&&(m.textLabel=T),!0}},r.update=function(m){var o=this.scene,i=o.fullSceneLayout;function u(h,d,s,x){return d.map(function(c){return h.d2l(c,0,x)*s})}this.data=t(m);var f={positions:e(u(i.xaxis,m._meshX,o.dataScale[0],m.xcalendar),u(i.yaxis,m._meshY,o.dataScale[1],m.ycalendar),u(i.zaxis,m._meshZ,o.dataScale[2],m.zcalendar)),cells:e(m._meshI,m._meshJ,m._meshK),lightPosition:[m.lightposition.x,m.lightposition.y,m.lightposition.z],ambient:m.lighting.ambient,diffuse:m.lighting.diffuse,specular:m.lighting.specular,roughness:m.lighting.roughness,fresnel:m.lighting.fresnel,vertexNormalsEpsilon:m.lighting.vertexnormalsepsilon,faceNormalsEpsilon:m.lighting.facenormalsepsilon,opacity:m.opacity,opacityscale:m.opacityscale,contourEnable:m.contour.show,contourColor:b(m.contour.color).slice(0,3),contourWidth:m.contour.width,useFacetNormals:m.flatshading},l=y(m);f.vertexIntensity=m._meshIntensity,f.vertexIntensityBounds=[l.min,l.max],f.colormap=g(m),this.mesh.update(f)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},J.exports=function(m,o){var i=m.glplot.gl,u=p({gl:i}),f=new a(m,u,o.uid);return u._trace=f,f.update(o),m.glplot.add(u),f}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618,"../isosurface/convert":873}],1113:[function(v,J,Z){var p=v("../../lib"),g=v("./attributes"),b=v("../isosurface/defaults").supplyIsoDefaults,y=v("../surface/defaults").opacityscaleDefaults;J.exports=function(e,n,t,a){function r(m,o){return p.coerce(e,n,g,m,o)}b(e,n,t,a,r),y(e,n,a,r)}},{"../../lib":515,"../isosurface/defaults":874,"../surface/defaults":1073,"./attributes":1111}],1114:[function(v,J,Z){J.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:v("./convert"),moduleType:"trace",name:"volume",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"../isosurface/calc":872,"./attributes":1111,"./convert":1112,"./defaults":1113}],1115:[function(v,J,Z){var p=v("../bar/attributes"),g=v("../scatter/attributes").line,b=v("../../plots/attributes"),y=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../plots/template_attributes").hovertemplateAttrs,n=v("../../plots/template_attributes").texttemplateAttrs,t=v("./constants"),a=v("../../lib/extend").extendFlat,r=v("../../components/color");function m(o){return{marker:{color:a({},p.marker.color,{arrayOk:!1,editType:"style"}),line:{color:a({},p.marker.line.color,{arrayOk:!1,editType:"style"}),width:a({},p.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}J.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:p.x,x0:p.x0,dx:p.dx,y:p.y,y0:p.y0,dy:p.dy,xperiod:p.xperiod,yperiod:p.yperiod,xperiod0:p.xperiod0,yperiod0:p.yperiod0,xperiodalignment:p.xperiodalignment,yperiodalignment:p.yperiodalignment,xhoverformat:y("x"),yhoverformat:y("y"),hovertext:p.hovertext,hovertemplate:e({},{keys:t.eventDataKeys}),hoverinfo:a({},b.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:n({editType:"plot"},{keys:t.eventDataKeys.concat(["label"])}),text:p.text,textposition:p.textposition,insidetextanchor:p.insidetextanchor,textangle:p.textangle,textfont:p.textfont,insidetextfont:p.insidetextfont,outsidetextfont:p.outsidetextfont,constraintext:p.constraintext,cliponaxis:p.cliponaxis,orientation:p.orientation,offset:p.offset,width:p.width,increasing:m(),decreasing:m(),totals:m(),connector:{line:{color:a({},g.color,{dflt:r.defaultLine}),width:a({},g.width,{editType:"plot"}),dash:g.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:p.offsetgroup,alignmentgroup:p.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":1117}],1116:[function(v,J,Z){var p=v("../../plots/cartesian/axes"),g=v("../../plots/cartesian/align_period"),b=v("../../lib").mergeArray,y=v("../scatter/calc_selection"),e=v("../../constants/numerical").BADNUM;function n(a){return a==="a"||a==="absolute"}function t(a){return a==="t"||a==="total"}J.exports=function(a,r){var m,o,i,u,f,l,h=p.getFromId(a,r.xaxis||"x"),d=p.getFromId(a,r.yaxis||"y");r.orientation==="h"?(m=h.makeCalcdata(r,"x"),i=d.makeCalcdata(r,"y"),u=g(r,d,"y",i),f=!!r.yperiodalignment,l="y"):(m=d.makeCalcdata(r,"y"),i=h.makeCalcdata(r,"x"),u=g(r,h,"x",i),f=!!r.xperiodalignment,l="x"),o=u.vals;for(var s,x=Math.min(o.length,m.length),c=new Array(x),T=0,_=!1,w=0;w<x;w++){var k=m[w]||0,L=!1;(m[w]!==e||t(r.measure[w])||n(r.measure[w]))&&w+1<x&&(m[w+1]!==e||t(r.measure[w+1])||n(r.measure[w+1]))&&(L=!0);var A=c[w]={i:w,p:o[w],s:k,rawS:k,cNext:L};n(r.measure[w])?(T=A.s,A.isSum=!0,A.dir="totals",A.s=T):t(r.measure[w])?(A.isSum=!0,A.dir="totals",A.s=T):(A.isSum=!1,A.dir=A.rawS<0?"decreasing":"increasing",s=A.s,A.s=T+s,T+=s),A.dir==="totals"&&(_=!0),f&&(c[w].orig_p=i[w],c[w][l+"End"]=u.ends[w],c[w][l+"Start"]=u.starts[w]),r.ids&&(A.id=String(r.ids[w])),A.v=(r.base||0)+T}return c.length&&(c[0].hasTotals=_),b(r.text,c,"tx"),b(r.hovertext,c,"htx"),y(c,r),c}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938}],1117:[function(v,J,Z){J.exports={eventDataKeys:["initial","delta","final"]}},{}],1118:[function(v,J,Z){var p=v("../bar/cross_trace_calc").setGroupPositions;J.exports=function(g,b){var y,e,n=g._fullLayout,t=g._fullData,a=g.calcdata,r=b.xaxis,m=b.yaxis,o=[],i=[],u=[];for(e=0;e<t.length;e++){var f=t[e];f.visible===!0&&f.xaxis===r._id&&f.yaxis===m._id&&f.type==="waterfall"&&(y=a[e],f.orientation==="h"?u.push(y):i.push(y),o.push(y))}var l={mode:n.waterfallmode,norm:n.waterfallnorm,gap:n.waterfallgap,groupgap:n.waterfallgroupgap};for(p(g,r,m,i,l),p(g,m,r,u,l),e=0;e<o.length;e++){y=o[e];for(var h=0;h<y.length;h++){var d=y[h];d.isSum===!1&&(d.s0+=h===0?0:y[h-1].s),h+1<y.length&&(y[h].nextP0=y[h+1].p0,y[h].nextS0=y[h+1].s0)}}}},{"../bar/cross_trace_calc":660}],1119:[function(v,J,Z){var p=v("../../lib"),g=v("../bar/defaults").handleGroupingDefaults,b=v("../bar/defaults").handleText,y=v("../scatter/xy_defaults"),e=v("../scatter/period_defaults"),n=v("./attributes"),t=v("../../components/color"),a=v("../../constants/delta.js"),r=a.INCREASING.COLOR,m=a.DECREASING.COLOR;function o(i,u,f){i(u+".marker.color",f),i(u+".marker.line.color",t.defaultLine),i(u+".marker.line.width")}J.exports={supplyDefaults:function(i,u,f,l){function h(s,x){return p.coerce(i,u,n,s,x)}if(y(i,u,l,h)){e(i,u,l,h),h("xhoverformat"),h("yhoverformat"),h("measure"),h("orientation",u.x&&!u.y?"h":"v"),h("base"),h("offset"),h("width"),h("text"),h("hovertext"),h("hovertemplate");var d=h("textposition");b(i,u,l,h,d,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),u.textposition!=="none"&&(h("texttemplate"),u.texttemplate||h("textinfo")),o(h,"increasing",r),o(h,"decreasing",m),o(h,"totals","#4499FF"),h("connector.visible")&&(h("connector.mode"),h("connector.line.width")&&(h("connector.line.color"),h("connector.line.dash")))}else u.visible=!1},crossTraceDefaults:function(i,u){var f,l;function h(s){return p.coerce(l._input,l,n,s)}if(u.waterfallmode==="group")for(var d=0;d<i.length;d++)f=(l=i[d])._input,g(f,l,u,h)}}},{"../../components/color":367,"../../constants/delta.js":485,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":1115}],1120:[function(v,J,Z){J.exports=function(p,g){return p.x="xVal"in g?g.xVal:g.x,p.y="yVal"in g?g.yVal:g.y,"initial"in g&&(p.initial=g.initial),"delta"in g&&(p.delta=g.delta),"final"in g&&(p.final=g.final),g.xa&&(p.xaxis=g.xa),g.ya&&(p.yaxis=g.ya),p}},{}],1121:[function(v,J,Z){var p=v("../../plots/cartesian/axes").hoverLabelText,g=v("../../components/color").opacity,b=v("../bar/hover").hoverOnBars,y=v("../../constants/delta.js"),e=y.INCREASING.SYMBOL,n=y.DECREASING.SYMBOL;J.exports=function(t,a,r,m,o){var i=b(t,a,r,m,o);if(i){var u=i.cd,f=u[0].trace,l=f.orientation==="h",h=l?"x":"y",d=l?t.xa:t.ya,s=u[i.index],x=s.isSum?s.b+s.s:s.rawS;if(!s.isSum){i.initial=s.b+s.s-x,i.delta=x,i.final=i.initial+i.delta;var c=A(Math.abs(i.delta));i.deltaLabel=x<0?"("+c+")":c,i.finalLabel=A(i.final),i.initialLabel=A(i.initial)}var T=s.hi||f.hoverinfo,_=[];if(T&&T!=="none"&&T!=="skip"){var w=T==="all",k=T.split("+"),L=function(I){return w||k.indexOf(I)!==-1};s.isSum||(!L("final")||L(l?"x":"y")||_.push(i.finalLabel),L("delta")&&(x<0?_.push(i.deltaLabel+" "+n):_.push(i.deltaLabel+" "+e)),L("initial")&&_.push("Initial: "+i.initialLabel))}return _.length&&(i.extraText=_.join("<br>")),i.color=function(I,P){var S=I[P.dir].marker,E=S.color,D=S.line.color,R=S.line.width;if(g(E))return E;if(g(D)&&R)return D}(f,s),[i]}function A(I){return p(d,I,f[h+"hoverformat"])}}},{"../../components/color":367,"../../constants/delta.js":485,"../../plots/cartesian/axes":566,"../bar/hover":664}],1122:[function(v,J,Z){J.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc"),plot:v("./plot"),style:v("./style").style,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":1115,"./calc":1116,"./cross_trace_calc":1118,"./defaults":1119,"./event_data":1120,"./hover":1121,"./layout_attributes":1123,"./layout_defaults":1124,"./plot":1125,"./style":1126}],1123:[function(v,J,Z){J.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1124:[function(v,J,Z){var p=v("../../lib"),g=v("./layout_attributes");J.exports=function(b,y,e){var n=!1;function t(m,o){return p.coerce(b,y,g,m,o)}for(var a=0;a<e.length;a++){var r=e[a];if(r.visible&&r.type==="waterfall"){n=!0;break}}n&&(t("waterfallmode"),t("waterfallgap",.2),t("waterfallgroupgap"))}},{"../../lib":515,"./layout_attributes":1123}],1125:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../lib"),b=v("../../components/drawing"),y=v("../../constants/numerical").BADNUM,e=v("../bar/plot"),n=v("../bar/uniform_text").clearMinTextSize;J.exports=function(t,a,r,m){var o=t._fullLayout;n("waterfall",o),e.plot(t,a,r,m,{mode:o.waterfallmode,norm:o.waterfallmode,gap:o.waterfallgap,groupgap:o.waterfallgroupgap}),function(i,u,f,l){var h=u.xaxis,d=u.yaxis;g.makeTraceGroups(l,f,"trace bars").each(function(s){var x=p.select(this),c=s[0].trace,T=g.ensureSingle(x,"g","lines");if(c.connector&&c.connector.visible){var _=c.orientation==="h",w=c.connector.mode,k=T.selectAll("g.line").data(g.identity);k.enter().append("g").classed("line",!0),k.exit().remove();var L=k.size();k.each(function(A,I){if(I===L-1||A.cNext){var P=function(R,H,V,X){var $=[],G=[],W=X?H:V,te=X?V:H;return $[0]=W.c2p(R.s0,!0),G[0]=te.c2p(R.p0,!0),$[1]=W.c2p(R.s1,!0),G[1]=te.c2p(R.p1,!0),$[2]=W.c2p(R.nextS0,!0),G[2]=te.c2p(R.nextP0,!0),X?[$,G]:[G,$]}(A,h,d,_),S=P[0],E=P[1],D="";S[0]!==y&&E[0]!==y&&S[1]!==y&&E[1]!==y&&(w==="spanning"&&!A.isSum&&I>0&&(D+=_?"M"+S[0]+","+E[1]+"V"+E[0]:"M"+S[1]+","+E[0]+"H"+S[0]),w!=="between"&&(A.isSum||I<L-1)&&(D+=_?"M"+S[1]+","+E[0]+"V"+E[1]:"M"+S[0]+","+E[1]+"H"+S[1]),S[2]!==y&&E[2]!==y&&(D+=_?"M"+S[1]+","+E[1]+"V"+E[2]:"M"+S[1]+","+E[1]+"H"+S[2])),D===""&&(D="M0,0Z"),g.ensureSingle(p.select(this),"path").attr("d",D).call(b.setClipUrl,u.layerClipId,i)}})}else T.remove()})}(t,a,r,m)}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],1126:[function(v,J,Z){var p=v("@plotly/d3"),g=v("../../components/drawing"),b=v("../../components/color"),y=v("../../constants/interactions").DESELECTDIM,e=v("../bar/style"),n=v("../bar/uniform_text").resizeText,t=e.styleTextPoints;J.exports={style:function(a,r,m){var o=m||p.select(a).selectAll("g.waterfalllayer").selectAll("g.trace");n(a,o,"waterfall"),o.style("opacity",function(i){return i[0].trace.opacity}),o.each(function(i){var u=p.select(this),f=i[0].trace;u.selectAll(".point > path").each(function(l){if(!l.isBlank){var h=f[l.dir].marker;p.select(this).call(b.fill,h.color).call(b.stroke,h.line.color).call(g.dashLine,h.line.dash,h.line.width).style("opacity",f.selectedpoints&&!l.selected?y:1)}}),t(u,f,a),u.selectAll(".lines").each(function(){var l=f.connector.line;g.lineGroupStyle(p.select(this).selectAll("path"),l.width,l.color,l.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],1127:[function(v,J,Z){var p=v("../plots/cartesian/axes"),g=v("../lib"),b=v("../plot_api/plot_schema"),y=v("./helpers").pointsAccessorFunction,e=v("../constants/numerical").BADNUM;Z.moduleType="transform",Z.name="aggregate";var n=Z.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},t=n.aggregations;function a(i,u,f,l){if(l.enabled){for(var h=l.target,d=g.nestedProperty(u,h),s=d.get(),x=function(_,w){var k=_.func,L=w.d2c,A=w.c2d;switch(k){case"count":return r;case"first":return m;case"last":return o;case"sum":return function(I,P){for(var S=0,E=0;E<P.length;E++){var D=L(I[P[E]]);D!==e&&(S+=D)}return A(S)};case"avg":return function(I,P){for(var S=0,E=0,D=0;D<P.length;D++){var R=L(I[P[D]]);R!==e&&(S+=R,E++)}return E?A(S/E):e};case"min":return function(I,P){for(var S=1/0,E=0;E<P.length;E++){var D=L(I[P[E]]);D!==e&&(S=Math.min(S,D))}return S===1/0?e:A(S)};case"max":return function(I,P){for(var S=-1/0,E=0;E<P.length;E++){var D=L(I[P[E]]);D!==e&&(S=Math.max(S,D))}return S===-1/0?e:A(S)};case"range":return function(I,P){for(var S=1/0,E=-1/0,D=0;D<P.length;D++){var R=L(I[P[D]]);R!==e&&(S=Math.min(S,R),E=Math.max(E,R))}return E===-1/0||S===1/0?e:A(E-S)};case"change":return function(I,P){var S=L(I[P[0]]),E=L(I[P[P.length-1]]);return S===e||E===e?e:A(E-S)};case"median":return function(I,P){for(var S=[],E=0;E<P.length;E++){var D=L(I[P[E]]);D!==e&&S.push(D)}if(!S.length)return e;S.sort(g.sorterAsc);var R=(S.length-1)/2;return A((S[Math.floor(R)]+S[Math.ceil(R)])/2)};case"mode":return function(I,P){for(var S={},E=0,D=e,R=0;R<P.length;R++){var H=L(I[P[R]]);if(H!==e){var V=S[H]=(S[H]||0)+1;V>E&&(E=V,D=H)}}return E?A(D):e};case"rms":return function(I,P){for(var S=0,E=0,D=0;D<P.length;D++){var R=L(I[P[D]]);R!==e&&(S+=R*R,E++)}return E?A(Math.sqrt(S/E)):e};case"stddev":return function(I,P){var S,E=0,D=0,R=1,H=e;for(S=0;S<P.length&&H===e;S++)H=L(I[P[S]]);if(H===e)return e;for(;S<P.length;S++){var V=L(I[P[S]]);if(V!==e){var X=V-H;E+=X,D+=X*X,R++}}var $=_.funcmode==="sample"?R-1:R;return $?Math.sqrt((D-E*E/R)/$):0}}}(l,p.getDataConversions(i,u,h,s)),c=new Array(f.length),T=0;T<f.length;T++)c[T]=x(s,f[T]);d.set(c),l.func==="count"&&g.pushUnique(u._arrayAttrs,h)}}function r(i,u){return u.length}function m(i,u){return i[u[0]]}function o(i,u){return i[u[u.length-1]]}Z.supplyDefaults=function(i,u){var f,l={};function h(A,I){return g.coerce(i,l,n,A,I)}if(!h("enabled"))return l;var d=b.findArrayAttributes(u),s={};for(f=0;f<d.length;f++)s[d[f]]=1;var x=h("groups");if(!Array.isArray(x)){if(!s[x])return l.enabled=!1,l;s[x]=0}var c,T=i.aggregations||[],_=l.aggregations=new Array(T.length);function w(A,I){return g.coerce(T[f],c,t,A,I)}for(f=0;f<T.length;f++){c={_index:f};var k=w("target"),L=w("func");w("enabled")&&k&&(s[k]||L==="count"&&s[k]===void 0)?(L==="stddev"&&w("funcmode"),s[k]=0,_[f]=c):_[f]={enabled:!1,_index:f}}for(f=0;f<d.length;f++)s[d[f]]&&_.push({target:d[f],func:t.func.dflt,enabled:!0,_index:-1});return l},Z.calcTransform=function(i,u,f){if(f.enabled){var l=f.groups,h=g.getTargetArray(u,{target:l});if(h){var d,s,x,c,T={},_={},w=[],k=y(u.transforms,f),L=h.length;for(u._length&&(L=Math.min(L,u._length)),d=0;d<L;d++)(x=T[s=h[d]])===void 0?(T[s]=w.length,c=[d],w.push(c),_[T[s]]=k(d)):(w[x].push(d),_[T[s]]=(_[T[s]]||[]).concat(k(d)));f._indexToPoints=_;var A=f.aggregations;for(d=0;d<A.length;d++)a(i,u,w,A[d]);typeof l=="string"&&a(i,u,w,{target:l,func:"first",enabled:!0}),u._length=w.length}}}},{"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plots/cartesian/axes":566,"./helpers":1130}],1128:[function(v,J,Z){var p=v("../lib"),g=v("../registry"),b=v("../plots/cartesian/axes"),y=v("./helpers").pointsAccessorFunction,e=v("../constants/filter_ops"),n=e.COMPARISON_OPS,t=e.INTERVAL_OPS,a=e.SET_OPS;Z.moduleType="transform",Z.name="filter",Z.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(n).concat(t).concat(a),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},Z.supplyDefaults=function(r){var m={};function o(f,l){return p.coerce(r,m,Z.attributes,f,l)}if(o("enabled")){var i=o("target");if(p.isArrayOrTypedArray(i)&&i.length===0)return m.enabled=!1,m;o("preservegaps"),o("operation"),o("value");var u=g.getComponentMethod("calendars","handleDefaults");u(r,m,"valuecalendar",null),u(r,m,"targetcalendar",null)}return m},Z.calcTransform=function(r,m,o){if(o.enabled){var i=p.getTargetArray(m,o);if(i){var u=o.target,f=i.length;m._length&&(f=Math.min(f,m._length));var l=o.targetcalendar,h=m._arrayAttrs,d=o.preservegaps;if(typeof u=="string"){var s=p.nestedProperty(m,u+"calendar").get();s&&(l=s)}var x,c,T=function(P,S,E){var D=P.operation,R=P.value,H=Array.isArray(R);function V(W){return W.indexOf(D)!==-1}var X,$=function(W){return S(W,0,P.valuecalendar)},G=function(W){return S(W,0,E)};switch(V(n)?X=$(H?R[0]:R):V(t)?X=H?[$(R[0]),$(R[1])]:[$(R),$(R)]:V(a)&&(X=H?R.map($):[$(R)]),D){case"=":return function(W){return G(W)===X};case"!=":return function(W){return G(W)!==X};case"<":return function(W){return G(W)<X};case"<=":return function(W){return G(W)<=X};case">":return function(W){return G(W)>X};case">=":return function(W){return G(W)>=X};case"[]":return function(W){var te=G(W);return te>=X[0]&&te<=X[1]};case"()":return function(W){var te=G(W);return te>X[0]&&te<X[1]};case"[)":return function(W){var te=G(W);return te>=X[0]&&te<X[1]};case"(]":return function(W){var te=G(W);return te>X[0]&&te<=X[1]};case"][":return function(W){var te=G(W);return te<=X[0]||te>=X[1]};case")(":return function(W){var te=G(W);return te<X[0]||te>X[1]};case"](":return function(W){var te=G(W);return te<=X[0]||te>X[1]};case")[":return function(W){var te=G(W);return te<X[0]||te>=X[1]};case"{}":return function(W){return X.indexOf(G(W))!==-1};case"}{":return function(W){return X.indexOf(G(W))===-1}}}(o,b.getDataToCoordFunc(r,m,u,i),l),_={},w={},k=0;d?(x=function(P){_[P.astr]=p.extendDeep([],P.get()),P.set(new Array(f))},c=function(P,S){var E=_[P.astr][S];P.get()[S]=E}):(x=function(P){_[P.astr]=p.extendDeep([],P.get()),P.set([])},c=function(P,S){var E=_[P.astr][S];P.get().push(E)}),I(x);for(var L=y(m.transforms,o),A=0;A<f;A++)T(i[A])?(I(c,A),w[k++]=L(A)):d&&k++;o._indexToPoints=w,m._length=k}}function I(P,S){for(var E=0;E<h.length;E++)P(p.nestedProperty(m,h[E]),S)}}},{"../constants/filter_ops":487,"../lib":515,"../plots/cartesian/axes":566,"../registry":647,"./helpers":1130}],1129:[function(v,J,Z){var p=v("../lib"),g=v("../plot_api/plot_schema"),b=v("../plots/plots"),y=v("./helpers").pointsAccessorFunction;function e(n,t){var a,r,m,o,i,u,f,l,h,d,s=t.transform,x=t.transformIndex,c=n.transforms[x].groups,T=y(n.transforms,s);if(!p.isArrayOrTypedArray(c)||c.length===0)return[n];var _=p.filterUnique(c),w=new Array(_.length),k=c.length,L=g.findArrayAttributes(n),A=s.styles||[],I={};for(a=0;a<A.length;a++)I[A[a].target]=A[a].value;s.styles&&(d=p.keyedContainer(s,"styles","target","value.name"));var P={},S={};for(a=0;a<_.length;a++){P[u=_[a]]=a,S[u]=0,(f=w[a]=p.extendDeepNoArrays({},n))._group=u,f.transforms[x]._indexToPoints={};var E=null;for(d&&(E=d.get(u)),f.name=E||E===""?E:p.templateString(s.nameformat,{trace:n.name,group:u}),l=f.transforms,f.transforms=[],r=0;r<l.length;r++)f.transforms[r]=p.extendDeepNoArrays({},l[r]);for(r=0;r<L.length;r++)p.nestedProperty(f,L[r]).set([])}for(m=0;m<L.length;m++){for(o=L[m],r=0,h=[];r<_.length;r++)h[r]=p.nestedProperty(w[r],o).get();for(i=p.nestedProperty(n,o).get(),r=0;r<k;r++)h[P[c[r]]].push(i[r])}for(r=0;r<k;r++)(f=w[P[c[r]]]).transforms[x]._indexToPoints[S[c[r]]]=T(r),S[c[r]]++;for(a=0;a<_.length;a++)u=_[a],f=w[a],b.clearExpandedTraceDefaultColors(f),f=p.extendDeepNoArrays(f,I[u]||{});return w}Z.moduleType="transform",Z.name="groupby",Z.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},Z.supplyDefaults=function(n,t,a){var r,m={};function o(h,d){return p.coerce(n,m,Z.attributes,h,d)}if(!o("enabled"))return m;o("groups"),o("nameformat",a._dataLength>1?"%{group} (%{trace})":"%{group}");var i=n.styles,u=m.styles=[];if(i)for(r=0;r<i.length;r++){var f=u[r]={};p.coerce(i[r],u[r],Z.attributes.styles,"target");var l=p.coerce(i[r],u[r],Z.attributes.styles,"value");p.isPlainObject(l)?f.value=p.extendDeep({},l):l&&delete f.value}return m},Z.transform=function(n,t){var a,r,m,o=[];for(r=0;r<n.length;r++)for(a=e(n[r],t),m=0;m<a.length;m++)o.push(a[m]);return o}},{"../lib":515,"../plot_api/plot_schema":554,"../plots/plots":628,"./helpers":1130}],1130:[function(v,J,Z){Z.pointsAccessorFunction=function(p,g){for(var b,y,e=0;e<p.length&&(b=p[e])!==g;e++)b._indexToPoints&&b.enabled!==!1&&(y=b._indexToPoints);return y?function(n){return y[n]}:function(n){return[n]}}},{}],1131:[function(v,J,Z){var p=v("../lib"),g=v("../plots/cartesian/axes"),b=v("./helpers").pointsAccessorFunction,y=v("../constants/numerical").BADNUM;Z.moduleType="transform",Z.name="sort",Z.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},Z.supplyDefaults=function(e){var n={};function t(a,r){return p.coerce(e,n,Z.attributes,a,r)}return t("enabled")&&(t("target"),t("order")),n},Z.calcTransform=function(e,n,t){if(t.enabled){var a=p.getTargetArray(n,t);if(a){var r=t.target,m=a.length;n._length&&(m=Math.min(m,n._length));var o,i,u=n._arrayAttrs,f=function(c,T,_,w){var k,L=new Array(w),A=new Array(w);for(k=0;k<w;k++)L[k]={v:T[k],i:k};for(L.sort(function(I,P){switch(I.order){case"ascending":return function(S,E){var D=P(S.v),R=P(E.v);return D===y?1:R===y?-1:D-R};case"descending":return function(S,E){var D=P(S.v),R=P(E.v);return D===y?1:R===y?-1:R-D}}}(c,_)),k=0;k<w;k++)A[k]=L[k].i;return A}(t,a,g.getDataToCoordFunc(e,n,r,a),m),l=b(n.transforms,t),h={};for(o=0;o<u.length;o++){var d=p.nestedProperty(n,u[o]),s=d.get(),x=new Array(m);for(i=0;i<m;i++)x[i]=s[f[i]];d.set(x)}for(i=0;i<m;i++)h[i]=l(f[i]);t._indexToPoints=h,n._length=m}}}},{"../constants/numerical":491,"../lib":515,"../plots/cartesian/axes":566,"./helpers":1130}],1132:[function(v,J,Z){Z.version="2.14.0"},{}],1133:[function(v,J,Z){(function(p){(function(){(function(g){typeof Z=="object"&&J!==void 0?J.exports=g():(typeof window<"u"?window:p!==void 0?p:typeof self<"u"?self:this).stackgl=g()})(function(){return function g(b,y,e){function n(r,m){if(!y[r]){if(!b[r]){var o=typeof v=="function"&&v;if(!m&&o)return o(r,!0);if(t)return t(r,!0);var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}var u=y[r]={exports:{}};b[r][0].call(u.exports,function(f){return n(b[r][1][f]||f)},u,u.exports,g,b,y,e)}return y[r].exports}for(var t=typeof v=="function"&&v,a=0;a<e.length;a++)n(e[a]);return n}({1:[function(g,b,y){y.byteLength=function(u){var f=o(u),l=f[0],h=f[1];return 3*(l+h)/4-h},y.toByteArray=function(u){var f,l,h=o(u),d=h[0],s=h[1],x=new t(function(_,w,k){return 3*(w+k)/4-k}(0,d,s)),c=0,T=s>0?d-4:d;for(l=0;l<T;l+=4)f=n[u.charCodeAt(l)]<<18|n[u.charCodeAt(l+1)]<<12|n[u.charCodeAt(l+2)]<<6|n[u.charCodeAt(l+3)],x[c++]=f>>16&255,x[c++]=f>>8&255,x[c++]=255&f;return s===2&&(f=n[u.charCodeAt(l)]<<2|n[u.charCodeAt(l+1)]>>4,x[c++]=255&f),s===1&&(f=n[u.charCodeAt(l)]<<10|n[u.charCodeAt(l+1)]<<4|n[u.charCodeAt(l+2)]>>2,x[c++]=f>>8&255,x[c++]=255&f),x},y.fromByteArray=function(u){for(var f,l=u.length,h=l%3,d=[],s=0,x=l-h;s<x;s+=16383)d.push(i(u,s,s+16383>x?x:s+16383));return h===1?(f=u[l-1],d.push(e[f>>2]+e[f<<4&63]+"==")):h===2&&(f=(u[l-2]<<8)+u[l-1],d.push(e[f>>10]+e[f>>4&63]+e[f<<2&63]+"=")),d.join("")};for(var e=[],n=[],t=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,m=a.length;r<m;++r)e[r]=a[r],n[a.charCodeAt(r)]=r;function o(u){var f=u.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=u.indexOf("=");return l===-1&&(l=f),[l,l===f?0:4-l%4]}function i(u,f,l){for(var h,d,s=[],x=f;x<l;x+=3)h=(u[x]<<16&16711680)+(u[x+1]<<8&65280)+(255&u[x+2]),s.push(e[(d=h)>>18&63]+e[d>>12&63]+e[d>>6&63]+e[63&d]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},{}],2:[function(g,b,y){},{}],3:[function(g,b,y){(function(e){(function(){var n=g("base64-js"),t=g("ieee754");y.Buffer=r,y.SlowBuffer=function(j){return+j!=j&&(j=0),r.alloc(+j)},y.INSPECT_MAX_BYTES=50;function a(j){if(j>2147483647)throw new RangeError('The value "'+j+'" is invalid for option "size"');var Q=new Uint8Array(j);return Q.__proto__=r.prototype,Q}function r(j,Q,K){if(typeof j=="number"){if(typeof Q=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return i(j)}return m(j,Q,K)}function m(j,Q,K){if(typeof j=="string")return function(le,oe){if(typeof oe=="string"&&oe!==""||(oe="utf8"),!r.isEncoding(oe))throw new TypeError("Unknown encoding: "+oe);var de=0|l(le,oe),se=a(de),me=se.write(le,oe);return me!==de&&(se=se.slice(0,me)),se}(j,Q);if(ArrayBuffer.isView(j))return u(j);if(j==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j);if(U(j,ArrayBuffer)||j&&U(j.buffer,ArrayBuffer))return function(le,oe,de){if(oe<0||le.byteLength<oe)throw new RangeError('"offset" is outside of buffer bounds');if(le.byteLength<oe+(de||0))throw new RangeError('"length" is outside of buffer bounds');var se;return se=oe===void 0&&de===void 0?new Uint8Array(le):de===void 0?new Uint8Array(le,oe):new Uint8Array(le,oe,de),se.__proto__=r.prototype,se}(j,Q,K);if(typeof j=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var re=j.valueOf&&j.valueOf();if(re!=null&&re!==j)return r.from(re,Q,K);var ne=function(le){if(r.isBuffer(le)){var oe=0|f(le.length),de=a(oe);return de.length===0||le.copy(de,0,0,oe),de}if(le.length!==void 0)return typeof le.length!="number"||ee(le.length)?a(0):u(le);if(le.type==="Buffer"&&Array.isArray(le.data))return u(le.data)}(j);if(ne)return ne;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof j[Symbol.toPrimitive]=="function")return r.from(j[Symbol.toPrimitive]("string"),Q,K);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j)}function o(j){if(typeof j!="number")throw new TypeError('"size" argument must be of type number');if(j<0)throw new RangeError('The value "'+j+'" is invalid for option "size"')}function i(j){return o(j),a(j<0?0:0|f(j))}function u(j){for(var Q=j.length<0?0:0|f(j.length),K=a(Q),re=0;re<Q;re+=1)K[re]=255&j[re];return K}function f(j){if(j>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|j}function l(j,Q){if(r.isBuffer(j))return j.length;if(ArrayBuffer.isView(j)||U(j,ArrayBuffer))return j.byteLength;if(typeof j!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof j);var K=j.length,re=arguments.length>2&&arguments[2]===!0;if(!re&&K===0)return 0;for(var ne=!1;;)switch(Q){case"ascii":case"latin1":case"binary":return K;case"utf8":case"utf-8":return te(j).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*K;case"hex":return K>>>1;case"base64":return N(j).length;default:if(ne)return re?-1:te(j).length;Q=(""+Q).toLowerCase(),ne=!0}}function h(j,Q,K){var re=!1;if((Q===void 0||Q<0)&&(Q=0),Q>this.length||((K===void 0||K>this.length)&&(K=this.length),K<=0)||(K>>>=0)<=(Q>>>=0))return"";for(j||(j="utf8");;)switch(j){case"hex":return E(this,Q,K);case"utf8":case"utf-8":return I(this,Q,K);case"ascii":return P(this,Q,K);case"latin1":case"binary":return S(this,Q,K);case"base64":return A(this,Q,K);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,Q,K);default:if(re)throw new TypeError("Unknown encoding: "+j);j=(j+"").toLowerCase(),re=!0}}function d(j,Q,K){var re=j[Q];j[Q]=j[K],j[K]=re}function s(j,Q,K,re,ne){if(j.length===0)return-1;if(typeof K=="string"?(re=K,K=0):K>2147483647?K=2147483647:K<-2147483648&&(K=-2147483648),ee(K=+K)&&(K=ne?0:j.length-1),K<0&&(K=j.length+K),K>=j.length){if(ne)return-1;K=j.length-1}else if(K<0){if(!ne)return-1;K=0}if(typeof Q=="string"&&(Q=r.from(Q,re)),r.isBuffer(Q))return Q.length===0?-1:x(j,Q,K,re,ne);if(typeof Q=="number")return Q&=255,typeof Uint8Array.prototype.indexOf=="function"?ne?Uint8Array.prototype.indexOf.call(j,Q,K):Uint8Array.prototype.lastIndexOf.call(j,Q,K):x(j,[Q],K,re,ne);throw new TypeError("val must be string, number or Buffer")}function x(j,Q,K,re,ne){var le,oe=1,de=j.length,se=Q.length;if(re!==void 0&&((re=String(re).toLowerCase())==="ucs2"||re==="ucs-2"||re==="utf16le"||re==="utf-16le")){if(j.length<2||Q.length<2)return-1;oe=2,de/=2,se/=2,K/=2}function me(Ce,fe){return oe===1?Ce[fe]:Ce.readUInt16BE(fe*oe)}if(ne){var Te=-1;for(le=K;le<de;le++)if(me(j,le)===me(Q,Te===-1?0:le-Te)){if(Te===-1&&(Te=le),le-Te+1===se)return Te*oe}else Te!==-1&&(le-=le-Te),Te=-1}else for(K+se>de&&(K=de-se),le=K;le>=0;le--){for(var _e=!0,be=0;be<se;be++)if(me(j,le+be)!==me(Q,be)){_e=!1;break}if(_e)return le}return-1}function c(j,Q,K,re){K=Number(K)||0;var ne=j.length-K;re?(re=Number(re))>ne&&(re=ne):re=ne;var le=Q.length;re>le/2&&(re=le/2);for(var oe=0;oe<re;++oe){var de=parseInt(Q.substr(2*oe,2),16);if(ee(de))return oe;j[K+oe]=de}return oe}function T(j,Q,K,re){return B(te(Q,j.length-K),j,K,re)}function _(j,Q,K,re){return B(function(ne){for(var le=[],oe=0;oe<ne.length;++oe)le.push(255&ne.charCodeAt(oe));return le}(Q),j,K,re)}function w(j,Q,K,re){return _(j,Q,K,re)}function k(j,Q,K,re){return B(N(Q),j,K,re)}function L(j,Q,K,re){return B(function(ne,le){for(var oe,de,se,me=[],Te=0;Te<ne.length&&!((le-=2)<0);++Te)oe=ne.charCodeAt(Te),de=oe>>8,se=oe%256,me.push(se),me.push(de);return me}(Q,j.length-K),j,K,re)}function A(j,Q,K){return Q===0&&K===j.length?n.fromByteArray(j):n.fromByteArray(j.slice(Q,K))}function I(j,Q,K){K=Math.min(j.length,K);for(var re=[],ne=Q;ne<K;){var le,oe,de,se,me=j[ne],Te=null,_e=me>239?4:me>223?3:me>191?2:1;if(ne+_e<=K)switch(_e){case 1:me<128&&(Te=me);break;case 2:(192&(le=j[ne+1]))==128&&(se=(31&me)<<6|63&le)>127&&(Te=se);break;case 3:le=j[ne+1],oe=j[ne+2],(192&le)==128&&(192&oe)==128&&(se=(15&me)<<12|(63&le)<<6|63&oe)>2047&&(se<55296||se>57343)&&(Te=se);break;case 4:le=j[ne+1],oe=j[ne+2],de=j[ne+3],(192&le)==128&&(192&oe)==128&&(192&de)==128&&(se=(15&me)<<18|(63&le)<<12|(63&oe)<<6|63&de)>65535&&se<1114112&&(Te=se)}Te===null?(Te=65533,_e=1):Te>65535&&(Te-=65536,re.push(Te>>>10&1023|55296),Te=56320|1023&Te),re.push(Te),ne+=_e}return function(be){var Ce=be.length;if(Ce<=4096)return String.fromCharCode.apply(String,be);for(var fe="",ve=0;ve<Ce;)fe+=String.fromCharCode.apply(String,be.slice(ve,ve+=4096));return fe}(re)}y.kMaxLength=2147483647,r.TYPED_ARRAY_SUPPORT=function(){try{var j=new Uint8Array(1);return j.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},j.foo()===42}catch{return!1}}(),r.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.buffer}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192,r.from=function(j,Q,K){return m(j,Q,K)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,r.alloc=function(j,Q,K){return function(re,ne,le){return o(re),re<=0?a(re):ne!==void 0?typeof le=="string"?a(re).fill(ne,le):a(re).fill(ne):a(re)}(j,Q,K)},r.allocUnsafe=function(j){return i(j)},r.allocUnsafeSlow=function(j){return i(j)},r.isBuffer=function(j){return j!=null&&j._isBuffer===!0&&j!==r.prototype},r.compare=function(j,Q){if(U(j,Uint8Array)&&(j=r.from(j,j.offset,j.byteLength)),U(Q,Uint8Array)&&(Q=r.from(Q,Q.offset,Q.byteLength)),!r.isBuffer(j)||!r.isBuffer(Q))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(j===Q)return 0;for(var K=j.length,re=Q.length,ne=0,le=Math.min(K,re);ne<le;++ne)if(j[ne]!==Q[ne]){K=j[ne],re=Q[ne];break}return K<re?-1:re<K?1:0},r.isEncoding=function(j){switch(String(j).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(j,Q){if(!Array.isArray(j))throw new TypeError('"list" argument must be an Array of Buffers');if(j.length===0)return r.alloc(0);var K;if(Q===void 0)for(Q=0,K=0;K<j.length;++K)Q+=j[K].length;var re=r.allocUnsafe(Q),ne=0;for(K=0;K<j.length;++K){var le=j[K];if(U(le,Uint8Array)&&(le=r.from(le)),!r.isBuffer(le))throw new TypeError('"list" argument must be an Array of Buffers');le.copy(re,ne),ne+=le.length}return re},r.byteLength=l,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var j=this.length;if(j%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var Q=0;Q<j;Q+=2)d(this,Q,Q+1);return this},r.prototype.swap32=function(){var j=this.length;if(j%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var Q=0;Q<j;Q+=4)d(this,Q,Q+3),d(this,Q+1,Q+2);return this},r.prototype.swap64=function(){var j=this.length;if(j%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var Q=0;Q<j;Q+=8)d(this,Q,Q+7),d(this,Q+1,Q+6),d(this,Q+2,Q+5),d(this,Q+3,Q+4);return this},r.prototype.toString=function(){var j=this.length;return j===0?"":arguments.length===0?I(this,0,j):h.apply(this,arguments)},r.prototype.toLocaleString=r.prototype.toString,r.prototype.equals=function(j){if(!r.isBuffer(j))throw new TypeError("Argument must be a Buffer");return this===j||r.compare(this,j)===0},r.prototype.inspect=function(){var j="",Q=y.INSPECT_MAX_BYTES;return j=this.toString("hex",0,Q).replace(/(.{2})/g,"$1 ").trim(),this.length>Q&&(j+=" ... "),"<Buffer "+j+">"},r.prototype.compare=function(j,Q,K,re,ne){if(U(j,Uint8Array)&&(j=r.from(j,j.offset,j.byteLength)),!r.isBuffer(j))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof j);if(Q===void 0&&(Q=0),K===void 0&&(K=j?j.length:0),re===void 0&&(re=0),ne===void 0&&(ne=this.length),Q<0||K>j.length||re<0||ne>this.length)throw new RangeError("out of range index");if(re>=ne&&Q>=K)return 0;if(re>=ne)return-1;if(Q>=K)return 1;if(this===j)return 0;for(var le=(ne>>>=0)-(re>>>=0),oe=(K>>>=0)-(Q>>>=0),de=Math.min(le,oe),se=this.slice(re,ne),me=j.slice(Q,K),Te=0;Te<de;++Te)if(se[Te]!==me[Te]){le=se[Te],oe=me[Te];break}return le<oe?-1:oe<le?1:0},r.prototype.includes=function(j,Q,K){return this.indexOf(j,Q,K)!==-1},r.prototype.indexOf=function(j,Q,K){return s(this,j,Q,K,!0)},r.prototype.lastIndexOf=function(j,Q,K){return s(this,j,Q,K,!1)},r.prototype.write=function(j,Q,K,re){if(Q===void 0)re="utf8",K=this.length,Q=0;else if(K===void 0&&typeof Q=="string")re=Q,K=this.length,Q=0;else{if(!isFinite(Q))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");Q>>>=0,isFinite(K)?(K>>>=0,re===void 0&&(re="utf8")):(re=K,K=void 0)}var ne=this.length-Q;if((K===void 0||K>ne)&&(K=ne),j.length>0&&(K<0||Q<0)||Q>this.length)throw new RangeError("Attempt to write outside buffer bounds");re||(re="utf8");for(var le=!1;;)switch(re){case"hex":return c(this,j,Q,K);case"utf8":case"utf-8":return T(this,j,Q,K);case"ascii":return _(this,j,Q,K);case"latin1":case"binary":return w(this,j,Q,K);case"base64":return k(this,j,Q,K);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,j,Q,K);default:if(le)throw new TypeError("Unknown encoding: "+re);re=(""+re).toLowerCase(),le=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(j,Q,K){var re="";K=Math.min(j.length,K);for(var ne=Q;ne<K;++ne)re+=String.fromCharCode(127&j[ne]);return re}function S(j,Q,K){var re="";K=Math.min(j.length,K);for(var ne=Q;ne<K;++ne)re+=String.fromCharCode(j[ne]);return re}function E(j,Q,K){var re=j.length;(!Q||Q<0)&&(Q=0),(!K||K<0||K>re)&&(K=re);for(var ne="",le=Q;le<K;++le)ne+=W(j[le]);return ne}function D(j,Q,K){for(var re=j.slice(Q,K),ne="",le=0;le<re.length;le+=2)ne+=String.fromCharCode(re[le]+256*re[le+1]);return ne}function R(j,Q,K){if(j%1!=0||j<0)throw new RangeError("offset is not uint");if(j+Q>K)throw new RangeError("Trying to access beyond buffer length")}function H(j,Q,K,re,ne,le){if(!r.isBuffer(j))throw new TypeError('"buffer" argument must be a Buffer instance');if(Q>ne||Q<le)throw new RangeError('"value" argument is out of bounds');if(K+re>j.length)throw new RangeError("Index out of range")}function V(j,Q,K,re,ne,le){if(K+re>j.length)throw new RangeError("Index out of range");if(K<0)throw new RangeError("Index out of range")}function X(j,Q,K,re,ne){return Q=+Q,K>>>=0,ne||V(j,0,K,4),t.write(j,Q,K,re,23,4),K+4}function $(j,Q,K,re,ne){return Q=+Q,K>>>=0,ne||V(j,0,K,8),t.write(j,Q,K,re,52,8),K+8}r.prototype.slice=function(j,Q){var K=this.length;(j=~~j)<0?(j+=K)<0&&(j=0):j>K&&(j=K),(Q=Q===void 0?K:~~Q)<0?(Q+=K)<0&&(Q=0):Q>K&&(Q=K),Q<j&&(Q=j);var re=this.subarray(j,Q);return re.__proto__=r.prototype,re},r.prototype.readUIntLE=function(j,Q,K){j>>>=0,Q>>>=0,K||R(j,Q,this.length);for(var re=this[j],ne=1,le=0;++le<Q&&(ne*=256);)re+=this[j+le]*ne;return re},r.prototype.readUIntBE=function(j,Q,K){j>>>=0,Q>>>=0,K||R(j,Q,this.length);for(var re=this[j+--Q],ne=1;Q>0&&(ne*=256);)re+=this[j+--Q]*ne;return re},r.prototype.readUInt8=function(j,Q){return j>>>=0,Q||R(j,1,this.length),this[j]},r.prototype.readUInt16LE=function(j,Q){return j>>>=0,Q||R(j,2,this.length),this[j]|this[j+1]<<8},r.prototype.readUInt16BE=function(j,Q){return j>>>=0,Q||R(j,2,this.length),this[j]<<8|this[j+1]},r.prototype.readUInt32LE=function(j,Q){return j>>>=0,Q||R(j,4,this.length),(this[j]|this[j+1]<<8|this[j+2]<<16)+16777216*this[j+3]},r.prototype.readUInt32BE=function(j,Q){return j>>>=0,Q||R(j,4,this.length),16777216*this[j]+(this[j+1]<<16|this[j+2]<<8|this[j+3])},r.prototype.readIntLE=function(j,Q,K){j>>>=0,Q>>>=0,K||R(j,Q,this.length);for(var re=this[j],ne=1,le=0;++le<Q&&(ne*=256);)re+=this[j+le]*ne;return re>=(ne*=128)&&(re-=Math.pow(2,8*Q)),re},r.prototype.readIntBE=function(j,Q,K){j>>>=0,Q>>>=0,K||R(j,Q,this.length);for(var re=Q,ne=1,le=this[j+--re];re>0&&(ne*=256);)le+=this[j+--re]*ne;return le>=(ne*=128)&&(le-=Math.pow(2,8*Q)),le},r.prototype.readInt8=function(j,Q){return j>>>=0,Q||R(j,1,this.length),128&this[j]?-1*(255-this[j]+1):this[j]},r.prototype.readInt16LE=function(j,Q){j>>>=0,Q||R(j,2,this.length);var K=this[j]|this[j+1]<<8;return 32768&K?4294901760|K:K},r.prototype.readInt16BE=function(j,Q){j>>>=0,Q||R(j,2,this.length);var K=this[j+1]|this[j]<<8;return 32768&K?4294901760|K:K},r.prototype.readInt32LE=function(j,Q){return j>>>=0,Q||R(j,4,this.length),this[j]|this[j+1]<<8|this[j+2]<<16|this[j+3]<<24},r.prototype.readInt32BE=function(j,Q){return j>>>=0,Q||R(j,4,this.length),this[j]<<24|this[j+1]<<16|this[j+2]<<8|this[j+3]},r.prototype.readFloatLE=function(j,Q){return j>>>=0,Q||R(j,4,this.length),t.read(this,j,!0,23,4)},r.prototype.readFloatBE=function(j,Q){return j>>>=0,Q||R(j,4,this.length),t.read(this,j,!1,23,4)},r.prototype.readDoubleLE=function(j,Q){return j>>>=0,Q||R(j,8,this.length),t.read(this,j,!0,52,8)},r.prototype.readDoubleBE=function(j,Q){return j>>>=0,Q||R(j,8,this.length),t.read(this,j,!1,52,8)},r.prototype.writeUIntLE=function(j,Q,K,re){j=+j,Q>>>=0,K>>>=0,re||H(this,j,Q,K,Math.pow(2,8*K)-1,0);var ne=1,le=0;for(this[Q]=255&j;++le<K&&(ne*=256);)this[Q+le]=j/ne&255;return Q+K},r.prototype.writeUIntBE=function(j,Q,K,re){j=+j,Q>>>=0,K>>>=0,re||H(this,j,Q,K,Math.pow(2,8*K)-1,0);var ne=K-1,le=1;for(this[Q+ne]=255&j;--ne>=0&&(le*=256);)this[Q+ne]=j/le&255;return Q+K},r.prototype.writeUInt8=function(j,Q,K){return j=+j,Q>>>=0,K||H(this,j,Q,1,255,0),this[Q]=255&j,Q+1},r.prototype.writeUInt16LE=function(j,Q,K){return j=+j,Q>>>=0,K||H(this,j,Q,2,65535,0),this[Q]=255&j,this[Q+1]=j>>>8,Q+2},r.prototype.writeUInt16BE=function(j,Q,K){return j=+j,Q>>>=0,K||H(this,j,Q,2,65535,0),this[Q]=j>>>8,this[Q+1]=255&j,Q+2},r.prototype.writeUInt32LE=function(j,Q,K){return j=+j,Q>>>=0,K||H(this,j,Q,4,4294967295,0),this[Q+3]=j>>>24,this[Q+2]=j>>>16,this[Q+1]=j>>>8,this[Q]=255&j,Q+4},r.prototype.writeUInt32BE=function(j,Q,K){return j=+j,Q>>>=0,K||H(this,j,Q,4,4294967295,0),this[Q]=j>>>24,this[Q+1]=j>>>16,this[Q+2]=j>>>8,this[Q+3]=255&j,Q+4},r.prototype.writeIntLE=function(j,Q,K,re){if(j=+j,Q>>>=0,!re){var ne=Math.pow(2,8*K-1);H(this,j,Q,K,ne-1,-ne)}var le=0,oe=1,de=0;for(this[Q]=255&j;++le<K&&(oe*=256);)j<0&&de===0&&this[Q+le-1]!==0&&(de=1),this[Q+le]=(j/oe>>0)-de&255;return Q+K},r.prototype.writeIntBE=function(j,Q,K,re){if(j=+j,Q>>>=0,!re){var ne=Math.pow(2,8*K-1);H(this,j,Q,K,ne-1,-ne)}var le=K-1,oe=1,de=0;for(this[Q+le]=255&j;--le>=0&&(oe*=256);)j<0&&de===0&&this[Q+le+1]!==0&&(de=1),this[Q+le]=(j/oe>>0)-de&255;return Q+K},r.prototype.writeInt8=function(j,Q,K){return j=+j,Q>>>=0,K||H(this,j,Q,1,127,-128),j<0&&(j=255+j+1),this[Q]=255&j,Q+1},r.prototype.writeInt16LE=function(j,Q,K){return j=+j,Q>>>=0,K||H(this,j,Q,2,32767,-32768),this[Q]=255&j,this[Q+1]=j>>>8,Q+2},r.prototype.writeInt16BE=function(j,Q,K){return j=+j,Q>>>=0,K||H(this,j,Q,2,32767,-32768),this[Q]=j>>>8,this[Q+1]=255&j,Q+2},r.prototype.writeInt32LE=function(j,Q,K){return j=+j,Q>>>=0,K||H(this,j,Q,4,2147483647,-2147483648),this[Q]=255&j,this[Q+1]=j>>>8,this[Q+2]=j>>>16,this[Q+3]=j>>>24,Q+4},r.prototype.writeInt32BE=function(j,Q,K){return j=+j,Q>>>=0,K||H(this,j,Q,4,2147483647,-2147483648),j<0&&(j=4294967295+j+1),this[Q]=j>>>24,this[Q+1]=j>>>16,this[Q+2]=j>>>8,this[Q+3]=255&j,Q+4},r.prototype.writeFloatLE=function(j,Q,K){return X(this,j,Q,!0,K)},r.prototype.writeFloatBE=function(j,Q,K){return X(this,j,Q,!1,K)},r.prototype.writeDoubleLE=function(j,Q,K){return $(this,j,Q,!0,K)},r.prototype.writeDoubleBE=function(j,Q,K){return $(this,j,Q,!1,K)},r.prototype.copy=function(j,Q,K,re){if(!r.isBuffer(j))throw new TypeError("argument should be a Buffer");if(K||(K=0),re||re===0||(re=this.length),Q>=j.length&&(Q=j.length),Q||(Q=0),re>0&&re<K&&(re=K),re===K||j.length===0||this.length===0)return 0;if(Q<0)throw new RangeError("targetStart out of bounds");if(K<0||K>=this.length)throw new RangeError("Index out of range");if(re<0)throw new RangeError("sourceEnd out of bounds");re>this.length&&(re=this.length),j.length-Q<re-K&&(re=j.length-Q+K);var ne=re-K;if(this===j&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(Q,K,re);else if(this===j&&K<Q&&Q<re)for(var le=ne-1;le>=0;--le)j[le+Q]=this[le+K];else Uint8Array.prototype.set.call(j,this.subarray(K,re),Q);return ne},r.prototype.fill=function(j,Q,K,re){if(typeof j=="string"){if(typeof Q=="string"?(re=Q,Q=0,K=this.length):typeof K=="string"&&(re=K,K=this.length),re!==void 0&&typeof re!="string")throw new TypeError("encoding must be a string");if(typeof re=="string"&&!r.isEncoding(re))throw new TypeError("Unknown encoding: "+re);if(j.length===1){var ne=j.charCodeAt(0);(re==="utf8"&&ne<128||re==="latin1")&&(j=ne)}}else typeof j=="number"&&(j&=255);if(Q<0||this.length<Q||this.length<K)throw new RangeError("Out of range index");if(K<=Q)return this;var le;if(Q>>>=0,K=K===void 0?this.length:K>>>0,j||(j=0),typeof j=="number")for(le=Q;le<K;++le)this[le]=j;else{var oe=r.isBuffer(j)?j:r.from(j,re),de=oe.length;if(de===0)throw new TypeError('The value "'+j+'" is invalid for argument "value"');for(le=0;le<K-Q;++le)this[le+Q]=oe[le%de]}return this};var G=/[^+/0-9A-Za-z-_]/g;function W(j){return j<16?"0"+j.toString(16):j.toString(16)}function te(j,Q){var K;Q=Q||1/0;for(var re=j.length,ne=null,le=[],oe=0;oe<re;++oe){if((K=j.charCodeAt(oe))>55295&&K<57344){if(!ne){if(K>56319){(Q-=3)>-1&&le.push(239,191,189);continue}if(oe+1===re){(Q-=3)>-1&&le.push(239,191,189);continue}ne=K;continue}if(K<56320){(Q-=3)>-1&&le.push(239,191,189),ne=K;continue}K=65536+(ne-55296<<10|K-56320)}else ne&&(Q-=3)>-1&&le.push(239,191,189);if(ne=null,K<128){if((Q-=1)<0)break;le.push(K)}else if(K<2048){if((Q-=2)<0)break;le.push(K>>6|192,63&K|128)}else if(K<65536){if((Q-=3)<0)break;le.push(K>>12|224,K>>6&63|128,63&K|128)}else{if(!(K<1114112))throw new Error("Invalid code point");if((Q-=4)<0)break;le.push(K>>18|240,K>>12&63|128,K>>6&63|128,63&K|128)}}return le}function N(j){return n.toByteArray(function(Q){if((Q=(Q=Q.split("=")[0]).trim().replace(G,"")).length<2)return"";for(;Q.length%4!=0;)Q+="=";return Q}(j))}function B(j,Q,K,re){for(var ne=0;ne<re&&!(ne+K>=Q.length||ne>=j.length);++ne)Q[ne+K]=j[ne];return ne}function U(j,Q){return j instanceof Q||j!=null&&j.constructor!=null&&j.constructor.name!=null&&j.constructor.name===Q.name}function ee(j){return j!=j}}).call(this)}).call(this,g("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(g,b,y){y.read=function(e,n,t,a,r){var m,o,i=8*r-a-1,u=(1<<i)-1,f=u>>1,l=-7,h=t?r-1:0,d=t?-1:1,s=e[n+h];for(h+=d,m=s&(1<<-l)-1,s>>=-l,l+=i;l>0;m=256*m+e[n+h],h+=d,l-=8);for(o=m&(1<<-l)-1,m>>=-l,l+=a;l>0;o=256*o+e[n+h],h+=d,l-=8);if(m===0)m=1-f;else{if(m===u)return o?NaN:1/0*(s?-1:1);o+=Math.pow(2,a),m-=f}return(s?-1:1)*o*Math.pow(2,m-a)},y.write=function(e,n,t,a,r,m){var o,i,u,f=8*m-r-1,l=(1<<f)-1,h=l>>1,d=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,s=a?0:m-1,x=a?1:-1,c=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(i=isNaN(n)?1:0,o=l):(o=Math.floor(Math.log(n)/Math.LN2),n*(u=Math.pow(2,-o))<1&&(o--,u*=2),(n+=o+h>=1?d/u:d*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=l?(i=0,o=l):o+h>=1?(i=(n*u-1)*Math.pow(2,r),o+=h):(i=n*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;e[t+s]=255&i,s+=x,i/=256,r-=8);for(o=o<<r|i,f+=r;f>0;e[t+s]=255&o,s+=x,o/=256,f-=8);e[t+s-x]|=128*c}},{}],5:[function(g,b,y){var e,n,t=b.exports={};function a(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function m(x){if(e===setTimeout)return setTimeout(x,0);if((e===a||!e)&&setTimeout)return e=setTimeout,setTimeout(x,0);try{return e(x,0)}catch{try{return e.call(null,x,0)}catch{return e.call(this,x,0)}}}(function(){try{e=typeof setTimeout=="function"?setTimeout:a}catch{e=a}try{n=typeof clearTimeout=="function"?clearTimeout:r}catch{n=r}})();var o,i=[],u=!1,f=-1;function l(){u&&o&&(u=!1,o.length?i=o.concat(i):f=-1,i.length&&h())}function h(){if(!u){var x=m(l);u=!0;for(var c=i.length;c;){for(o=i,i=[];++f<c;)o&&o[f].run();f=-1,c=i.length}o=null,u=!1,function(T){if(n===clearTimeout)return clearTimeout(T);if((n===r||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(T);try{n(T)}catch{try{return n.call(null,T)}catch{return n.call(this,T)}}}(x)}}function d(x,c){this.fun=x,this.array=c}function s(){}t.nextTick=function(x){var c=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)c[T-1]=arguments[T];i.push(new d(x,c)),i.length!==1||u||m(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=s,t.addListener=s,t.once=s,t.off=s,t.removeListener=s,t.removeAllListeners=s,t.emit=s,t.prependListener=s,t.prependOnceListener=s,t.listeners=function(x){return[]},t.binding=function(x){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(x){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],6:[function(g,b,y){b.exports={alpha_shape:g("alpha-shape"),convex_hull:g("convex-hull"),delaunay_triangulate:g("delaunay-triangulate"),gl_cone3d:g("gl-cone3d"),gl_error3d:g("gl-error3d"),gl_heatmap2d:g("gl-heatmap2d"),gl_line3d:g("gl-line3d"),gl_mesh3d:g("gl-mesh3d"),gl_plot2d:g("gl-plot2d"),gl_plot3d:g("gl-plot3d"),gl_pointcloud2d:g("gl-pointcloud2d"),gl_scatter3d:g("gl-scatter3d"),gl_select_box:g("gl-select-box"),gl_spikes2d:g("gl-spikes2d"),gl_streamtube3d:g("gl-streamtube3d"),gl_surface3d:g("gl-surface3d"),ndarray:g("ndarray"),ndarray_linear_interpolate:g("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(g,b,y){b.exports=function(m){var o=(m=m||{}).eye||[0,0,1],i=m.center||[0,0,0],u=m.up||[0,1,0],f=m.distanceLimits||[0,1/0],l=m.mode||"turntable",h=e(),d=n(),s=t();return h.setDistanceLimits(f[0],f[1]),h.lookAt(0,o,i,u),d.setDistanceLimits(f[0],f[1]),d.lookAt(0,o,i,u),s.setDistanceLimits(f[0],f[1]),s.lookAt(0,o,i,u),new a({turntable:h,orbit:d,matrix:s},l)};var e=g("turntable-camera-controller"),n=g("orbit-camera-controller"),t=g("matrix-camera-controller");function a(m,o){this._controllerNames=Object.keys(m),this._controllerList=this._controllerNames.map(function(i){return m[i]}),this._mode=o,this._active=m[o],this._active||(this._mode="turntable",this._active=m.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var r=a.prototype;r.flush=function(m){for(var o=this._controllerList,i=0;i<o.length;++i)o[i].flush(m)},r.idle=function(m){for(var o=this._controllerList,i=0;i<o.length;++i)o[i].idle(m)},r.lookAt=function(m,o,i,u){for(var f=this._controllerList,l=0;l<f.length;++l)f[l].lookAt(m,o,i,u)},r.rotate=function(m,o,i,u){for(var f=this._controllerList,l=0;l<f.length;++l)f[l].rotate(m,o,i,u)},r.pan=function(m,o,i,u){for(var f=this._controllerList,l=0;l<f.length;++l)f[l].pan(m,o,i,u)},r.translate=function(m,o,i,u){for(var f=this._controllerList,l=0;l<f.length;++l)f[l].translate(m,o,i,u)},r.setMatrix=function(m,o){for(var i=this._controllerList,u=0;u<i.length;++u)i[u].setMatrix(m,o)},r.setDistanceLimits=function(m,o){for(var i=this._controllerList,u=0;u<i.length;++u)i[u].setDistanceLimits(m,o)},r.setDistance=function(m,o){for(var i=this._controllerList,u=0;u<i.length;++u)i[u].setDistance(m,o)},r.recalcMatrix=function(m){this._active.recalcMatrix(m)},r.getDistance=function(m){return this._active.getDistance(m)},r.getDistanceLimits=function(m){return this._active.getDistanceLimits(m)},r.lastT=function(){return this._active.lastT()},r.setMode=function(m){if(m!==this._mode){var o=this._controllerNames.indexOf(m);if(!(o<0)){var i=this._active,u=this._controllerList[o],f=Math.max(i.lastT(),u.lastT());i.recalcMatrix(f),u.setMatrix(f,i.computedMatrix),this._active=u,this._mode=m,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},r.getMode=function(){return this._mode}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(g,b,y){var e=typeof WeakMap>"u"?g("weak-map"):WeakMap,n=g("gl-buffer"),t=g("gl-vao"),a=new e;b.exports=function(r){var m=a.get(r),o=m&&(m._triangleBuffer.handle||m._triangleBuffer.buffer);if(!o||!r.isBuffer(o)){var i=n(r,new Float32Array([-1,-1,-1,4,4,-1]));(m=t(r,[{buffer:i,type:r.FLOAT,size:2}]))._triangleBuffer=i,a.set(r,m)}m.bind(),r.drawArrays(r.TRIANGLES,0,3),m.unbind()}},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(g,b,y){var e=g("pad-left");b.exports=function(n,t,a){t=typeof t=="number"?t:1,a=a||": ";var r=n.split(/\r?\n/),m=String(r.length+t-1).length;return r.map(function(o,i){var u=i+t,f=String(u).length;return e(u,m-f)+a+o}).join(`
`)}},{"pad-left":264}],10:[function(g,b,y){b.exports=function(t){var a=t.length;if(a===0)return[];if(a===1)return[0];for(var r=t[0].length,m=[t[0]],o=[0],i=1;i<a;++i)if(m.push(t[i]),n(m,r)){if(o.push(i),o.length===r+1)return o}else m.pop();return o};var e=g("robust-orientation");function n(t,a){for(var r=new Array(a+1),m=0;m<t.length;++m)r[m]=t[m];for(m=0;m<=t.length;++m){for(var o=t.length;o<=a;++o){for(var i=new Array(a),u=0;u<a;++u)i[u]=Math.pow(o+1-m,u);r[o]=i}if(e.apply(void 0,r))return!0}return!1}},{"robust-orientation":284}],11:[function(g,b,y){b.exports=function(t,a){return e(a).filter(function(r){for(var m=new Array(r.length),o=0;o<r.length;++o)m[o]=a[r[o]];return n(m)*t<1})};var e=g("delaunay-triangulate"),n=g("circumradius")},{circumradius:49,"delaunay-triangulate":63}],12:[function(g,b,y){b.exports=function(t,a){return n(e(t,a))};var e=g("alpha-complex"),n=g("simplicial-complex-boundary")},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(g,b,y){b.exports=function(e){return atob(e)}},{}],14:[function(g,b,y){b.exports=function(t,a){for(var r=a.length,m=new Array(r+1),o=0;o<r;++o){for(var i=new Array(r+1),u=0;u<=r;++u)i[u]=t[u][o];m[o]=i}for(m[r]=new Array(r+1),o=0;o<=r;++o)m[r][o]=1;var f=new Array(r+1);for(o=0;o<r;++o)f[o]=a[o];f[r]=1;var l=e(m,f),h=n(l[r+1]);h===0&&(h=1);var d=new Array(r+1);for(o=0;o<=r;++o)d[o]=n(l[o])/h;return d};var e=g("robust-linear-solve");function n(t){for(var a=0,r=0;r<t.length;++r)a+=t[r];return a}},{"robust-linear-solve":283}],15:[function(g,b,y){var e=g("./lib/rationalize");b.exports=function(n,t){return e(n[0].mul(t[1]).add(t[0].mul(n[1])),n[1].mul(t[1]))}},{"./lib/rationalize":25}],16:[function(g,b,y){b.exports=function(e,n){return e[0].mul(n[1]).cmp(n[0].mul(e[1]))}},{}],17:[function(g,b,y){var e=g("./lib/rationalize");b.exports=function(n,t){return e(n[0].mul(t[1]),n[1].mul(t[0]))}},{"./lib/rationalize":25}],18:[function(g,b,y){var e=g("./is-rat"),n=g("./lib/is-bn"),t=g("./lib/num-to-bn"),a=g("./lib/str-to-bn"),r=g("./lib/rationalize"),m=g("./div");b.exports=function o(i,u){if(e(i))return u?m(i,o(u)):[i[0].clone(),i[1].clone()];var f,l,h=0;if(n(i))f=i.clone();else if(typeof i=="string")f=a(i);else{if(i===0)return[t(0),t(1)];if(i===Math.floor(i))f=t(i);else{for(;i!==Math.floor(i);)i*=Math.pow(2,256),h-=256;f=t(i)}}if(e(u))f.mul(u[1]),l=u[0].clone();else if(n(u))l=u.clone();else if(typeof u=="string")l=a(u);else if(u)if(u===Math.floor(u))l=t(u);else{for(;u!==Math.floor(u);)u*=Math.pow(2,256),h+=256;l=t(u)}else l=t(1);return h>0?f=f.ushln(h):h<0&&(l=l.ushln(-h)),r(f,l)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(g,b,y){var e=g("./lib/is-bn");b.exports=function(n){return Array.isArray(n)&&n.length===2&&e(n[0])&&e(n[1])}},{"./lib/is-bn":23}],20:[function(g,b,y){var e=g("bn.js");b.exports=function(n){return n.cmp(new e(0))}},{"bn.js":33}],21:[function(g,b,y){var e=g("./bn-sign");b.exports=function(n){var t=n.length,a=n.words,r=0;if(t===1)r=a[0];else if(t===2)r=a[0]+67108864*a[1];else for(var m=0;m<t;m++){var o=a[m];r+=o*Math.pow(67108864,m)}return e(n)*r}},{"./bn-sign":20}],22:[function(g,b,y){var e=g("double-bits"),n=g("bit-twiddle").countTrailingZeros;b.exports=function(t){var a=n(e.lo(t));if(a<32)return a;var r=n(e.hi(t));return r>20?52:r+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(g,b,y){g("bn.js"),b.exports=function(e){return e&&typeof e=="object"&&Boolean(e.words)}},{"bn.js":33}],24:[function(g,b,y){var e=g("bn.js"),n=g("double-bits");b.exports=function(t){var a=n.exponent(t);return a<52?new e(t):new e(t*Math.pow(2,52-a)).ushln(a-52)}},{"bn.js":33,"double-bits":64}],25:[function(g,b,y){var e=g("./num-to-bn"),n=g("./bn-sign");b.exports=function(t,a){var r=n(t),m=n(a);if(r===0)return[e(0),e(1)];if(m===0)return[e(0),e(0)];m<0&&(t=t.neg(),a=a.neg());var o=t.gcd(a);return o.cmpn(1)?[t.div(o),a.div(o)]:[t,a]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(g,b,y){var e=g("bn.js");b.exports=function(n){return new e(n)}},{"bn.js":33}],27:[function(g,b,y){var e=g("./lib/rationalize");b.exports=function(n,t){return e(n[0].mul(t[0]),n[1].mul(t[1]))}},{"./lib/rationalize":25}],28:[function(g,b,y){var e=g("./lib/bn-sign");b.exports=function(n){return e(n[0])*e(n[1])}},{"./lib/bn-sign":20}],29:[function(g,b,y){var e=g("./lib/rationalize");b.exports=function(n,t){return e(n[0].mul(t[1]).sub(n[1].mul(t[0])),n[1].mul(t[1]))}},{"./lib/rationalize":25}],30:[function(g,b,y){var e=g("./lib/bn-to-num"),n=g("./lib/ctz");b.exports=function(t){var a=t[0],r=t[1];if(a.cmpn(0)===0)return 0;var m=a.abs().divmod(r.abs()),o=m.div,i=e(o),u=m.mod,f=a.negative!==r.negative?-1:1;if(u.cmpn(0)===0)return f*i;if(i){var l=n(i)+4,h=e(u.ushln(l).divRound(r));return f*(i+h*Math.pow(2,-l))}var d=r.bitLength()-u.bitLength()+53;return h=e(u.ushln(d).divRound(r)),d<1023?f*h*Math.pow(2,-d):(h*=Math.pow(2,-1023),f*h*Math.pow(2,1023-d))}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(g,b,y){function e(o,i,u,f,l){for(var h=l+1;f<=l;){var d=f+l>>>1,s=o[d];(u!==void 0?u(s,i):s-i)>=0?(h=d,l=d-1):f=d+1}return h}function n(o,i,u,f,l){for(var h=l+1;f<=l;){var d=f+l>>>1,s=o[d];(u!==void 0?u(s,i):s-i)>0?(h=d,l=d-1):f=d+1}return h}function t(o,i,u,f,l){for(var h=f-1;f<=l;){var d=f+l>>>1,s=o[d];(u!==void 0?u(s,i):s-i)<0?(h=d,f=d+1):l=d-1}return h}function a(o,i,u,f,l){for(var h=f-1;f<=l;){var d=f+l>>>1,s=o[d];(u!==void 0?u(s,i):s-i)<=0?(h=d,f=d+1):l=d-1}return h}function r(o,i,u,f,l){for(;f<=l;){var h=f+l>>>1,d=o[h],s=u!==void 0?u(d,i):d-i;if(s===0)return h;s<=0?f=h+1:l=h-1}return-1}function m(o,i,u,f,l,h){return typeof u=="function"?h(o,i,u,f===void 0?0:0|f,l===void 0?o.length-1:0|l):h(o,i,void 0,u===void 0?0:0|u,f===void 0?o.length-1:0|f)}b.exports={ge:function(o,i,u,f,l){return m(o,i,u,f,l,e)},gt:function(o,i,u,f,l){return m(o,i,u,f,l,n)},lt:function(o,i,u,f,l){return m(o,i,u,f,l,t)},le:function(o,i,u,f,l){return m(o,i,u,f,l,a)},eq:function(o,i,u,f,l){return m(o,i,u,f,l,r)}}},{}],32:[function(g,b,y){function e(t){var a=32;return(t&=-t)&&a--,65535&t&&(a-=16),16711935&t&&(a-=8),252645135&t&&(a-=4),858993459&t&&(a-=2),1431655765&t&&(a-=1),a}y.INT_BITS=32,y.INT_MAX=2147483647,y.INT_MIN=-1<<31,y.sign=function(t){return(t>0)-(t<0)},y.abs=function(t){var a=t>>31;return(t^a)-a},y.min=function(t,a){return a^(t^a)&-(t<a)},y.max=function(t,a){return t^(t^a)&-(t<a)},y.isPow2=function(t){return!(t&t-1||!t)},y.log2=function(t){var a,r;return a=(t>65535)<<4,a|=r=((t>>>=a)>255)<<3,a|=r=((t>>>=r)>15)<<2,(a|=r=((t>>>=r)>3)<<1)|(t>>>=r)>>1},y.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},y.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},y.countTrailingZeros=e,y.nextPow2=function(t){return t+=t===0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1},y.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},y.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var n=new Array(256);(function(t){for(var a=0;a<256;++a){var r=a,m=a,o=7;for(r>>>=1;r;r>>>=1)m<<=1,m|=1&r,--o;t[a]=m<<o&255}})(n),y.reverse=function(t){return n[255&t]<<24|n[t>>>8&255]<<16|n[t>>>16&255]<<8|n[t>>>24&255]},y.interleave2=function(t,a){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a&=65535)|a<<8))|a<<4))|a<<2))|a<<1))<<1},y.deinterleave2=function(t,a){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>a&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},y.interleave3=function(t,a,r){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(a=1227133513&((a=3272356035&((a=251719695&((a=4278190335&((a&=1023)|a<<16))|a<<8))|a<<4))|a<<2))<<1)|(r=1227133513&((r=3272356035&((r=251719695&((r=4278190335&((r&=1023)|r<<16))|r<<8))|r<<4))|r<<2))<<2},y.deinterleave3=function(t,a){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>a&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},y.nextCombination=function(t){var a=t|t-1;return a+1|(~a&-~a)-1>>>e(t)+1}},{}],33:[function(g,b,y){(function(e,n){function t(S,E){if(!S)throw new Error(E||"Assertion failed")}function a(S,E){S.super_=E;var D=function(){};D.prototype=E.prototype,S.prototype=new D,S.prototype.constructor=S}function r(S,E,D){if(r.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,S!==null&&(E!=="le"&&E!=="be"||(D=E,E=10),this._init(S||0,E||10,D||"be"))}var m;typeof e=="object"?e.exports=r:n.BN=r,r.BN=r,r.wordSize=26;try{m=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:g("buffer").Buffer}catch{}function o(S,E){var D=S.charCodeAt(E);return D>=65&&D<=70?D-55:D>=97&&D<=102?D-87:D-48&15}function i(S,E,D){var R=o(S,D);return D-1>=E&&(R|=o(S,D-1)<<4),R}function u(S,E,D,R){for(var H=0,V=Math.min(S.length,D),X=E;X<V;X++){var $=S.charCodeAt(X)-48;H*=R,H+=$>=49?$-49+10:$>=17?$-17+10:$}return H}r.isBN=function(S){return S instanceof r||S!==null&&typeof S=="object"&&S.constructor.wordSize===r.wordSize&&Array.isArray(S.words)},r.max=function(S,E){return S.cmp(E)>0?S:E},r.min=function(S,E){return S.cmp(E)<0?S:E},r.prototype._init=function(S,E,D){if(typeof S=="number")return this._initNumber(S,E,D);if(typeof S=="object")return this._initArray(S,E,D);E==="hex"&&(E=16),t(E===(0|E)&&E>=2&&E<=36);var R=0;(S=S.toString().replace(/\s+/g,""))[0]==="-"&&(R++,this.negative=1),R<S.length&&(E===16?this._parseHex(S,R,D):(this._parseBase(S,E,R),D==="le"&&this._initArray(this.toArray(),E,D)))},r.prototype._initNumber=function(S,E,D){S<0&&(this.negative=1,S=-S),S<67108864?(this.words=[67108863&S],this.length=1):S<4503599627370496?(this.words=[67108863&S,S/67108864&67108863],this.length=2):(t(S<9007199254740992),this.words=[67108863&S,S/67108864&67108863,1],this.length=3),D==="le"&&this._initArray(this.toArray(),E,D)},r.prototype._initArray=function(S,E,D){if(t(typeof S.length=="number"),S.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(S.length/3),this.words=new Array(this.length);for(var R=0;R<this.length;R++)this.words[R]=0;var H,V,X=0;if(D==="be")for(R=S.length-1,H=0;R>=0;R-=3)V=S[R]|S[R-1]<<8|S[R-2]<<16,this.words[H]|=V<<X&67108863,this.words[H+1]=V>>>26-X&67108863,(X+=24)>=26&&(X-=26,H++);else if(D==="le")for(R=0,H=0;R<S.length;R+=3)V=S[R]|S[R+1]<<8|S[R+2]<<16,this.words[H]|=V<<X&67108863,this.words[H+1]=V>>>26-X&67108863,(X+=24)>=26&&(X-=26,H++);return this.strip()},r.prototype._parseHex=function(S,E,D){this.length=Math.ceil((S.length-E)/6),this.words=new Array(this.length);for(var R=0;R<this.length;R++)this.words[R]=0;var H,V=0,X=0;if(D==="be")for(R=S.length-1;R>=E;R-=2)H=i(S,E,R)<<V,this.words[X]|=67108863&H,V>=18?(V-=18,X+=1,this.words[X]|=H>>>26):V+=8;else for(R=(S.length-E)%2==0?E+1:E;R<S.length;R+=2)H=i(S,E,R)<<V,this.words[X]|=67108863&H,V>=18?(V-=18,X+=1,this.words[X]|=H>>>26):V+=8;this.strip()},r.prototype._parseBase=function(S,E,D){this.words=[0],this.length=1;for(var R=0,H=1;H<=67108863;H*=E)R++;R--,H=H/E|0;for(var V=S.length-D,X=V%R,$=Math.min(V,V-X)+D,G=0,W=D;W<$;W+=R)G=u(S,W,W+R,E),this.imuln(H),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G);if(X!==0){var te=1;for(G=u(S,W,S.length,E),W=0;W<X;W++)te*=E;this.imuln(te),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G)}this.strip()},r.prototype.copy=function(S){S.words=new Array(this.length);for(var E=0;E<this.length;E++)S.words[E]=this.words[E];S.length=this.length,S.negative=this.negative,S.red=this.red},r.prototype.clone=function(){var S=new r(null);return this.copy(S),S},r.prototype._expand=function(S){for(;this.length<S;)this.words[this.length++]=0;return this},r.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},r.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},r.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function d(S,E,D){D.negative=E.negative^S.negative;var R=S.length+E.length|0;D.length=R,R=R-1|0;var H=0|S.words[0],V=0|E.words[0],X=H*V,$=67108863&X,G=X/67108864|0;D.words[0]=$;for(var W=1;W<R;W++){for(var te=G>>>26,N=67108863&G,B=Math.min(W,E.length-1),U=Math.max(0,W-S.length+1);U<=B;U++){var ee=W-U|0;te+=(X=(H=0|S.words[ee])*(V=0|E.words[U])+N)/67108864|0,N=67108863&X}D.words[W]=0|N,G=0|te}return G!==0?D.words[W]=0|G:D.length--,D.strip()}r.prototype.toString=function(S,E){var D;if(E=0|E||1,(S=S||10)===16||S==="hex"){D="";for(var R=0,H=0,V=0;V<this.length;V++){var X=this.words[V],$=(16777215&(X<<R|H)).toString(16);D=(H=X>>>24-R&16777215)!==0||V!==this.length-1?f[6-$.length]+$+D:$+D,(R+=2)>=26&&(R-=26,V--)}for(H!==0&&(D=H.toString(16)+D);D.length%E!=0;)D="0"+D;return this.negative!==0&&(D="-"+D),D}if(S===(0|S)&&S>=2&&S<=36){var G=l[S],W=h[S];D="";var te=this.clone();for(te.negative=0;!te.isZero();){var N=te.modn(W).toString(S);D=(te=te.idivn(W)).isZero()?N+D:f[G-N.length]+N+D}for(this.isZero()&&(D="0"+D);D.length%E!=0;)D="0"+D;return this.negative!==0&&(D="-"+D),D}t(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var S=this.words[0];return this.length===2?S+=67108864*this.words[1]:this.length===3&&this.words[2]===1?S+=4503599627370496+67108864*this.words[1]:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-S:S},r.prototype.toJSON=function(){return this.toString(16)},r.prototype.toBuffer=function(S,E){return t(m!==void 0),this.toArrayLike(m,S,E)},r.prototype.toArray=function(S,E){return this.toArrayLike(Array,S,E)},r.prototype.toArrayLike=function(S,E,D){var R=this.byteLength(),H=D||Math.max(1,R);t(R<=H,"byte array longer than desired length"),t(H>0,"Requested array length <= 0"),this.strip();var V,X,$=E==="le",G=new S(H),W=this.clone();if($){for(X=0;!W.isZero();X++)V=W.andln(255),W.iushrn(8),G[X]=V;for(;X<H;X++)G[X]=0}else{for(X=0;X<H-R;X++)G[X]=0;for(X=0;!W.isZero();X++)V=W.andln(255),W.iushrn(8),G[H-X-1]=V}return G},Math.clz32?r.prototype._countBits=function(S){return 32-Math.clz32(S)}:r.prototype._countBits=function(S){var E=S,D=0;return E>=4096&&(D+=13,E>>>=13),E>=64&&(D+=7,E>>>=7),E>=8&&(D+=4,E>>>=4),E>=2&&(D+=2,E>>>=2),D+E},r.prototype._zeroBits=function(S){if(S===0)return 26;var E=S,D=0;return(8191&E)==0&&(D+=13,E>>>=13),(127&E)==0&&(D+=7,E>>>=7),(15&E)==0&&(D+=4,E>>>=4),(3&E)==0&&(D+=2,E>>>=2),(1&E)==0&&D++,D},r.prototype.bitLength=function(){var S=this.words[this.length-1],E=this._countBits(S);return 26*(this.length-1)+E},r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var S=0,E=0;E<this.length;E++){var D=this._zeroBits(this.words[E]);if(S+=D,D!==26)break}return S},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(S){return this.negative!==0?this.abs().inotn(S).iaddn(1):this.clone()},r.prototype.fromTwos=function(S){return this.testn(S-1)?this.notn(S).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return this.negative!==0},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(S){for(;this.length<S.length;)this.words[this.length++]=0;for(var E=0;E<S.length;E++)this.words[E]=this.words[E]|S.words[E];return this.strip()},r.prototype.ior=function(S){return t((this.negative|S.negative)==0),this.iuor(S)},r.prototype.or=function(S){return this.length>S.length?this.clone().ior(S):S.clone().ior(this)},r.prototype.uor=function(S){return this.length>S.length?this.clone().iuor(S):S.clone().iuor(this)},r.prototype.iuand=function(S){var E;E=this.length>S.length?S:this;for(var D=0;D<E.length;D++)this.words[D]=this.words[D]&S.words[D];return this.length=E.length,this.strip()},r.prototype.iand=function(S){return t((this.negative|S.negative)==0),this.iuand(S)},r.prototype.and=function(S){return this.length>S.length?this.clone().iand(S):S.clone().iand(this)},r.prototype.uand=function(S){return this.length>S.length?this.clone().iuand(S):S.clone().iuand(this)},r.prototype.iuxor=function(S){var E,D;this.length>S.length?(E=this,D=S):(E=S,D=this);for(var R=0;R<D.length;R++)this.words[R]=E.words[R]^D.words[R];if(this!==E)for(;R<E.length;R++)this.words[R]=E.words[R];return this.length=E.length,this.strip()},r.prototype.ixor=function(S){return t((this.negative|S.negative)==0),this.iuxor(S)},r.prototype.xor=function(S){return this.length>S.length?this.clone().ixor(S):S.clone().ixor(this)},r.prototype.uxor=function(S){return this.length>S.length?this.clone().iuxor(S):S.clone().iuxor(this)},r.prototype.inotn=function(S){t(typeof S=="number"&&S>=0);var E=0|Math.ceil(S/26),D=S%26;this._expand(E),D>0&&E--;for(var R=0;R<E;R++)this.words[R]=67108863&~this.words[R];return D>0&&(this.words[R]=~this.words[R]&67108863>>26-D),this.strip()},r.prototype.notn=function(S){return this.clone().inotn(S)},r.prototype.setn=function(S,E){t(typeof S=="number"&&S>=0);var D=S/26|0,R=S%26;return this._expand(D+1),this.words[D]=E?this.words[D]|1<<R:this.words[D]&~(1<<R),this.strip()},r.prototype.iadd=function(S){var E,D,R;if(this.negative!==0&&S.negative===0)return this.negative=0,E=this.isub(S),this.negative^=1,this._normSign();if(this.negative===0&&S.negative!==0)return S.negative=0,E=this.isub(S),S.negative=1,E._normSign();this.length>S.length?(D=this,R=S):(D=S,R=this);for(var H=0,V=0;V<R.length;V++)E=(0|D.words[V])+(0|R.words[V])+H,this.words[V]=67108863&E,H=E>>>26;for(;H!==0&&V<D.length;V++)E=(0|D.words[V])+H,this.words[V]=67108863&E,H=E>>>26;if(this.length=D.length,H!==0)this.words[this.length]=H,this.length++;else if(D!==this)for(;V<D.length;V++)this.words[V]=D.words[V];return this},r.prototype.add=function(S){var E;return S.negative!==0&&this.negative===0?(S.negative=0,E=this.sub(S),S.negative^=1,E):S.negative===0&&this.negative!==0?(this.negative=0,E=S.sub(this),this.negative=1,E):this.length>S.length?this.clone().iadd(S):S.clone().iadd(this)},r.prototype.isub=function(S){if(S.negative!==0){S.negative=0;var E=this.iadd(S);return S.negative=1,E._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(S),this.negative=1,this._normSign();var D,R,H=this.cmp(S);if(H===0)return this.negative=0,this.length=1,this.words[0]=0,this;H>0?(D=this,R=S):(D=S,R=this);for(var V=0,X=0;X<R.length;X++)V=(E=(0|D.words[X])-(0|R.words[X])+V)>>26,this.words[X]=67108863&E;for(;V!==0&&X<D.length;X++)V=(E=(0|D.words[X])+V)>>26,this.words[X]=67108863&E;if(V===0&&X<D.length&&D!==this)for(;X<D.length;X++)this.words[X]=D.words[X];return this.length=Math.max(this.length,X),D!==this&&(this.negative=1),this.strip()},r.prototype.sub=function(S){return this.clone().isub(S)};var s=function(S,E,D){var R,H,V,X=S.words,$=E.words,G=D.words,W=0,te=0|X[0],N=8191&te,B=te>>>13,U=0|X[1],ee=8191&U,j=U>>>13,Q=0|X[2],K=8191&Q,re=Q>>>13,ne=0|X[3],le=8191&ne,oe=ne>>>13,de=0|X[4],se=8191&de,me=de>>>13,Te=0|X[5],_e=8191&Te,be=Te>>>13,Ce=0|X[6],fe=8191&Ce,ve=Ce>>>13,Me=0|X[7],ke=8191&Me,Le=Me>>>13,ze=0|X[8],Re=8191&ze,Oe=ze>>>13,Ze=0|X[9],Pe=8191&Ze,Ie=Ze>>>13,Be=0|$[0],Fe=8191&Be,$e=Be>>>13,ot=0|$[1],pt=8191&ot,_t=ot>>>13,yt=0|$[2],tt=8191&yt,Ke=yt>>>13,vt=0|$[3],Nt=8191&vt,qt=vt>>>13,er=0|$[4],Jt=8191&er,ir=er>>>13,Ht=0|$[5],Ue=8191&Ht,We=Ht>>>13,he=0|$[6],xe=8191&he,De=he>>>13,qe=0|$[7],Xe=8191&qe,He=qe>>>13,st=0|$[8],it=8191&st,Tt=st>>>13,Pt=0|$[9],rt=8191&Pt,ut=Pt>>>13;D.negative=S.negative^E.negative,D.length=19;var Ft=(W+(R=Math.imul(N,Fe))|0)+((8191&(H=(H=Math.imul(N,$e))+Math.imul(B,Fe)|0))<<13)|0;W=((V=Math.imul(B,$e))+(H>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,R=Math.imul(ee,Fe),H=(H=Math.imul(ee,$e))+Math.imul(j,Fe)|0,V=Math.imul(j,$e);var wt=(W+(R=R+Math.imul(N,pt)|0)|0)+((8191&(H=(H=H+Math.imul(N,_t)|0)+Math.imul(B,pt)|0))<<13)|0;W=((V=V+Math.imul(B,_t)|0)+(H>>>13)|0)+(wt>>>26)|0,wt&=67108863,R=Math.imul(K,Fe),H=(H=Math.imul(K,$e))+Math.imul(re,Fe)|0,V=Math.imul(re,$e),R=R+Math.imul(ee,pt)|0,H=(H=H+Math.imul(ee,_t)|0)+Math.imul(j,pt)|0,V=V+Math.imul(j,_t)|0;var Lt=(W+(R=R+Math.imul(N,tt)|0)|0)+((8191&(H=(H=H+Math.imul(N,Ke)|0)+Math.imul(B,tt)|0))<<13)|0;W=((V=V+Math.imul(B,Ke)|0)+(H>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,R=Math.imul(le,Fe),H=(H=Math.imul(le,$e))+Math.imul(oe,Fe)|0,V=Math.imul(oe,$e),R=R+Math.imul(K,pt)|0,H=(H=H+Math.imul(K,_t)|0)+Math.imul(re,pt)|0,V=V+Math.imul(re,_t)|0,R=R+Math.imul(ee,tt)|0,H=(H=H+Math.imul(ee,Ke)|0)+Math.imul(j,tt)|0,V=V+Math.imul(j,Ke)|0;var Ae=(W+(R=R+Math.imul(N,Nt)|0)|0)+((8191&(H=(H=H+Math.imul(N,qt)|0)+Math.imul(B,Nt)|0))<<13)|0;W=((V=V+Math.imul(B,qt)|0)+(H>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,R=Math.imul(se,Fe),H=(H=Math.imul(se,$e))+Math.imul(me,Fe)|0,V=Math.imul(me,$e),R=R+Math.imul(le,pt)|0,H=(H=H+Math.imul(le,_t)|0)+Math.imul(oe,pt)|0,V=V+Math.imul(oe,_t)|0,R=R+Math.imul(K,tt)|0,H=(H=H+Math.imul(K,Ke)|0)+Math.imul(re,tt)|0,V=V+Math.imul(re,Ke)|0,R=R+Math.imul(ee,Nt)|0,H=(H=H+Math.imul(ee,qt)|0)+Math.imul(j,Nt)|0,V=V+Math.imul(j,qt)|0;var Ye=(W+(R=R+Math.imul(N,Jt)|0)|0)+((8191&(H=(H=H+Math.imul(N,ir)|0)+Math.imul(B,Jt)|0))<<13)|0;W=((V=V+Math.imul(B,ir)|0)+(H>>>13)|0)+(Ye>>>26)|0,Ye&=67108863,R=Math.imul(_e,Fe),H=(H=Math.imul(_e,$e))+Math.imul(be,Fe)|0,V=Math.imul(be,$e),R=R+Math.imul(se,pt)|0,H=(H=H+Math.imul(se,_t)|0)+Math.imul(me,pt)|0,V=V+Math.imul(me,_t)|0,R=R+Math.imul(le,tt)|0,H=(H=H+Math.imul(le,Ke)|0)+Math.imul(oe,tt)|0,V=V+Math.imul(oe,Ke)|0,R=R+Math.imul(K,Nt)|0,H=(H=H+Math.imul(K,qt)|0)+Math.imul(re,Nt)|0,V=V+Math.imul(re,qt)|0,R=R+Math.imul(ee,Jt)|0,H=(H=H+Math.imul(ee,ir)|0)+Math.imul(j,Jt)|0,V=V+Math.imul(j,ir)|0;var nt=(W+(R=R+Math.imul(N,Ue)|0)|0)+((8191&(H=(H=H+Math.imul(N,We)|0)+Math.imul(B,Ue)|0))<<13)|0;W=((V=V+Math.imul(B,We)|0)+(H>>>13)|0)+(nt>>>26)|0,nt&=67108863,R=Math.imul(fe,Fe),H=(H=Math.imul(fe,$e))+Math.imul(ve,Fe)|0,V=Math.imul(ve,$e),R=R+Math.imul(_e,pt)|0,H=(H=H+Math.imul(_e,_t)|0)+Math.imul(be,pt)|0,V=V+Math.imul(be,_t)|0,R=R+Math.imul(se,tt)|0,H=(H=H+Math.imul(se,Ke)|0)+Math.imul(me,tt)|0,V=V+Math.imul(me,Ke)|0,R=R+Math.imul(le,Nt)|0,H=(H=H+Math.imul(le,qt)|0)+Math.imul(oe,Nt)|0,V=V+Math.imul(oe,qt)|0,R=R+Math.imul(K,Jt)|0,H=(H=H+Math.imul(K,ir)|0)+Math.imul(re,Jt)|0,V=V+Math.imul(re,ir)|0,R=R+Math.imul(ee,Ue)|0,H=(H=H+Math.imul(ee,We)|0)+Math.imul(j,Ue)|0,V=V+Math.imul(j,We)|0;var ft=(W+(R=R+Math.imul(N,xe)|0)|0)+((8191&(H=(H=H+Math.imul(N,De)|0)+Math.imul(B,xe)|0))<<13)|0;W=((V=V+Math.imul(B,De)|0)+(H>>>13)|0)+(ft>>>26)|0,ft&=67108863,R=Math.imul(ke,Fe),H=(H=Math.imul(ke,$e))+Math.imul(Le,Fe)|0,V=Math.imul(Le,$e),R=R+Math.imul(fe,pt)|0,H=(H=H+Math.imul(fe,_t)|0)+Math.imul(ve,pt)|0,V=V+Math.imul(ve,_t)|0,R=R+Math.imul(_e,tt)|0,H=(H=H+Math.imul(_e,Ke)|0)+Math.imul(be,tt)|0,V=V+Math.imul(be,Ke)|0,R=R+Math.imul(se,Nt)|0,H=(H=H+Math.imul(se,qt)|0)+Math.imul(me,Nt)|0,V=V+Math.imul(me,qt)|0,R=R+Math.imul(le,Jt)|0,H=(H=H+Math.imul(le,ir)|0)+Math.imul(oe,Jt)|0,V=V+Math.imul(oe,ir)|0,R=R+Math.imul(K,Ue)|0,H=(H=H+Math.imul(K,We)|0)+Math.imul(re,Ue)|0,V=V+Math.imul(re,We)|0,R=R+Math.imul(ee,xe)|0,H=(H=H+Math.imul(ee,De)|0)+Math.imul(j,xe)|0,V=V+Math.imul(j,De)|0;var Mt=(W+(R=R+Math.imul(N,Xe)|0)|0)+((8191&(H=(H=H+Math.imul(N,He)|0)+Math.imul(B,Xe)|0))<<13)|0;W=((V=V+Math.imul(B,He)|0)+(H>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,R=Math.imul(Re,Fe),H=(H=Math.imul(Re,$e))+Math.imul(Oe,Fe)|0,V=Math.imul(Oe,$e),R=R+Math.imul(ke,pt)|0,H=(H=H+Math.imul(ke,_t)|0)+Math.imul(Le,pt)|0,V=V+Math.imul(Le,_t)|0,R=R+Math.imul(fe,tt)|0,H=(H=H+Math.imul(fe,Ke)|0)+Math.imul(ve,tt)|0,V=V+Math.imul(ve,Ke)|0,R=R+Math.imul(_e,Nt)|0,H=(H=H+Math.imul(_e,qt)|0)+Math.imul(be,Nt)|0,V=V+Math.imul(be,qt)|0,R=R+Math.imul(se,Jt)|0,H=(H=H+Math.imul(se,ir)|0)+Math.imul(me,Jt)|0,V=V+Math.imul(me,ir)|0,R=R+Math.imul(le,Ue)|0,H=(H=H+Math.imul(le,We)|0)+Math.imul(oe,Ue)|0,V=V+Math.imul(oe,We)|0,R=R+Math.imul(K,xe)|0,H=(H=H+Math.imul(K,De)|0)+Math.imul(re,xe)|0,V=V+Math.imul(re,De)|0,R=R+Math.imul(ee,Xe)|0,H=(H=H+Math.imul(ee,He)|0)+Math.imul(j,Xe)|0,V=V+Math.imul(j,He)|0;var Rt=(W+(R=R+Math.imul(N,it)|0)|0)+((8191&(H=(H=H+Math.imul(N,Tt)|0)+Math.imul(B,it)|0))<<13)|0;W=((V=V+Math.imul(B,Tt)|0)+(H>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,R=Math.imul(Pe,Fe),H=(H=Math.imul(Pe,$e))+Math.imul(Ie,Fe)|0,V=Math.imul(Ie,$e),R=R+Math.imul(Re,pt)|0,H=(H=H+Math.imul(Re,_t)|0)+Math.imul(Oe,pt)|0,V=V+Math.imul(Oe,_t)|0,R=R+Math.imul(ke,tt)|0,H=(H=H+Math.imul(ke,Ke)|0)+Math.imul(Le,tt)|0,V=V+Math.imul(Le,Ke)|0,R=R+Math.imul(fe,Nt)|0,H=(H=H+Math.imul(fe,qt)|0)+Math.imul(ve,Nt)|0,V=V+Math.imul(ve,qt)|0,R=R+Math.imul(_e,Jt)|0,H=(H=H+Math.imul(_e,ir)|0)+Math.imul(be,Jt)|0,V=V+Math.imul(be,ir)|0,R=R+Math.imul(se,Ue)|0,H=(H=H+Math.imul(se,We)|0)+Math.imul(me,Ue)|0,V=V+Math.imul(me,We)|0,R=R+Math.imul(le,xe)|0,H=(H=H+Math.imul(le,De)|0)+Math.imul(oe,xe)|0,V=V+Math.imul(oe,De)|0,R=R+Math.imul(K,Xe)|0,H=(H=H+Math.imul(K,He)|0)+Math.imul(re,Xe)|0,V=V+Math.imul(re,He)|0,R=R+Math.imul(ee,it)|0,H=(H=H+Math.imul(ee,Tt)|0)+Math.imul(j,it)|0,V=V+Math.imul(j,Tt)|0;var Gt=(W+(R=R+Math.imul(N,rt)|0)|0)+((8191&(H=(H=H+Math.imul(N,ut)|0)+Math.imul(B,rt)|0))<<13)|0;W=((V=V+Math.imul(B,ut)|0)+(H>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,R=Math.imul(Pe,pt),H=(H=Math.imul(Pe,_t))+Math.imul(Ie,pt)|0,V=Math.imul(Ie,_t),R=R+Math.imul(Re,tt)|0,H=(H=H+Math.imul(Re,Ke)|0)+Math.imul(Oe,tt)|0,V=V+Math.imul(Oe,Ke)|0,R=R+Math.imul(ke,Nt)|0,H=(H=H+Math.imul(ke,qt)|0)+Math.imul(Le,Nt)|0,V=V+Math.imul(Le,qt)|0,R=R+Math.imul(fe,Jt)|0,H=(H=H+Math.imul(fe,ir)|0)+Math.imul(ve,Jt)|0,V=V+Math.imul(ve,ir)|0,R=R+Math.imul(_e,Ue)|0,H=(H=H+Math.imul(_e,We)|0)+Math.imul(be,Ue)|0,V=V+Math.imul(be,We)|0,R=R+Math.imul(se,xe)|0,H=(H=H+Math.imul(se,De)|0)+Math.imul(me,xe)|0,V=V+Math.imul(me,De)|0,R=R+Math.imul(le,Xe)|0,H=(H=H+Math.imul(le,He)|0)+Math.imul(oe,Xe)|0,V=V+Math.imul(oe,He)|0,R=R+Math.imul(K,it)|0,H=(H=H+Math.imul(K,Tt)|0)+Math.imul(re,it)|0,V=V+Math.imul(re,Tt)|0;var jt=(W+(R=R+Math.imul(ee,rt)|0)|0)+((8191&(H=(H=H+Math.imul(ee,ut)|0)+Math.imul(j,rt)|0))<<13)|0;W=((V=V+Math.imul(j,ut)|0)+(H>>>13)|0)+(jt>>>26)|0,jt&=67108863,R=Math.imul(Pe,tt),H=(H=Math.imul(Pe,Ke))+Math.imul(Ie,tt)|0,V=Math.imul(Ie,Ke),R=R+Math.imul(Re,Nt)|0,H=(H=H+Math.imul(Re,qt)|0)+Math.imul(Oe,Nt)|0,V=V+Math.imul(Oe,qt)|0,R=R+Math.imul(ke,Jt)|0,H=(H=H+Math.imul(ke,ir)|0)+Math.imul(Le,Jt)|0,V=V+Math.imul(Le,ir)|0,R=R+Math.imul(fe,Ue)|0,H=(H=H+Math.imul(fe,We)|0)+Math.imul(ve,Ue)|0,V=V+Math.imul(ve,We)|0,R=R+Math.imul(_e,xe)|0,H=(H=H+Math.imul(_e,De)|0)+Math.imul(be,xe)|0,V=V+Math.imul(be,De)|0,R=R+Math.imul(se,Xe)|0,H=(H=H+Math.imul(se,He)|0)+Math.imul(me,Xe)|0,V=V+Math.imul(me,He)|0,R=R+Math.imul(le,it)|0,H=(H=H+Math.imul(le,Tt)|0)+Math.imul(oe,it)|0,V=V+Math.imul(oe,Tt)|0;var pr=(W+(R=R+Math.imul(K,rt)|0)|0)+((8191&(H=(H=H+Math.imul(K,ut)|0)+Math.imul(re,rt)|0))<<13)|0;W=((V=V+Math.imul(re,ut)|0)+(H>>>13)|0)+(pr>>>26)|0,pr&=67108863,R=Math.imul(Pe,Nt),H=(H=Math.imul(Pe,qt))+Math.imul(Ie,Nt)|0,V=Math.imul(Ie,qt),R=R+Math.imul(Re,Jt)|0,H=(H=H+Math.imul(Re,ir)|0)+Math.imul(Oe,Jt)|0,V=V+Math.imul(Oe,ir)|0,R=R+Math.imul(ke,Ue)|0,H=(H=H+Math.imul(ke,We)|0)+Math.imul(Le,Ue)|0,V=V+Math.imul(Le,We)|0,R=R+Math.imul(fe,xe)|0,H=(H=H+Math.imul(fe,De)|0)+Math.imul(ve,xe)|0,V=V+Math.imul(ve,De)|0,R=R+Math.imul(_e,Xe)|0,H=(H=H+Math.imul(_e,He)|0)+Math.imul(be,Xe)|0,V=V+Math.imul(be,He)|0,R=R+Math.imul(se,it)|0,H=(H=H+Math.imul(se,Tt)|0)+Math.imul(me,it)|0,V=V+Math.imul(me,Tt)|0;var Ar=(W+(R=R+Math.imul(le,rt)|0)|0)+((8191&(H=(H=H+Math.imul(le,ut)|0)+Math.imul(oe,rt)|0))<<13)|0;W=((V=V+Math.imul(oe,ut)|0)+(H>>>13)|0)+(Ar>>>26)|0,Ar&=67108863,R=Math.imul(Pe,Jt),H=(H=Math.imul(Pe,ir))+Math.imul(Ie,Jt)|0,V=Math.imul(Ie,ir),R=R+Math.imul(Re,Ue)|0,H=(H=H+Math.imul(Re,We)|0)+Math.imul(Oe,Ue)|0,V=V+Math.imul(Oe,We)|0,R=R+Math.imul(ke,xe)|0,H=(H=H+Math.imul(ke,De)|0)+Math.imul(Le,xe)|0,V=V+Math.imul(Le,De)|0,R=R+Math.imul(fe,Xe)|0,H=(H=H+Math.imul(fe,He)|0)+Math.imul(ve,Xe)|0,V=V+Math.imul(ve,He)|0,R=R+Math.imul(_e,it)|0,H=(H=H+Math.imul(_e,Tt)|0)+Math.imul(be,it)|0,V=V+Math.imul(be,Tt)|0;var fr=(W+(R=R+Math.imul(se,rt)|0)|0)+((8191&(H=(H=H+Math.imul(se,ut)|0)+Math.imul(me,rt)|0))<<13)|0;W=((V=V+Math.imul(me,ut)|0)+(H>>>13)|0)+(fr>>>26)|0,fr&=67108863,R=Math.imul(Pe,Ue),H=(H=Math.imul(Pe,We))+Math.imul(Ie,Ue)|0,V=Math.imul(Ie,We),R=R+Math.imul(Re,xe)|0,H=(H=H+Math.imul(Re,De)|0)+Math.imul(Oe,xe)|0,V=V+Math.imul(Oe,De)|0,R=R+Math.imul(ke,Xe)|0,H=(H=H+Math.imul(ke,He)|0)+Math.imul(Le,Xe)|0,V=V+Math.imul(Le,He)|0,R=R+Math.imul(fe,it)|0,H=(H=H+Math.imul(fe,Tt)|0)+Math.imul(ve,it)|0,V=V+Math.imul(ve,Tt)|0;var Zt=(W+(R=R+Math.imul(_e,rt)|0)|0)+((8191&(H=(H=H+Math.imul(_e,ut)|0)+Math.imul(be,rt)|0))<<13)|0;W=((V=V+Math.imul(be,ut)|0)+(H>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,R=Math.imul(Pe,xe),H=(H=Math.imul(Pe,De))+Math.imul(Ie,xe)|0,V=Math.imul(Ie,De),R=R+Math.imul(Re,Xe)|0,H=(H=H+Math.imul(Re,He)|0)+Math.imul(Oe,Xe)|0,V=V+Math.imul(Oe,He)|0,R=R+Math.imul(ke,it)|0,H=(H=H+Math.imul(ke,Tt)|0)+Math.imul(Le,it)|0,V=V+Math.imul(Le,Tt)|0;var Qt=(W+(R=R+Math.imul(fe,rt)|0)|0)+((8191&(H=(H=H+Math.imul(fe,ut)|0)+Math.imul(ve,rt)|0))<<13)|0;W=((V=V+Math.imul(ve,ut)|0)+(H>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,R=Math.imul(Pe,Xe),H=(H=Math.imul(Pe,He))+Math.imul(Ie,Xe)|0,V=Math.imul(Ie,He),R=R+Math.imul(Re,it)|0,H=(H=H+Math.imul(Re,Tt)|0)+Math.imul(Oe,it)|0,V=V+Math.imul(Oe,Tt)|0;var $t=(W+(R=R+Math.imul(ke,rt)|0)|0)+((8191&(H=(H=H+Math.imul(ke,ut)|0)+Math.imul(Le,rt)|0))<<13)|0;W=((V=V+Math.imul(Le,ut)|0)+(H>>>13)|0)+($t>>>26)|0,$t&=67108863,R=Math.imul(Pe,it),H=(H=Math.imul(Pe,Tt))+Math.imul(Ie,it)|0,V=Math.imul(Ie,Tt);var hr=(W+(R=R+Math.imul(Re,rt)|0)|0)+((8191&(H=(H=H+Math.imul(Re,ut)|0)+Math.imul(Oe,rt)|0))<<13)|0;W=((V=V+Math.imul(Oe,ut)|0)+(H>>>13)|0)+(hr>>>26)|0,hr&=67108863;var vr=(W+(R=Math.imul(Pe,rt))|0)+((8191&(H=(H=Math.imul(Pe,ut))+Math.imul(Ie,rt)|0))<<13)|0;return W=((V=Math.imul(Ie,ut))+(H>>>13)|0)+(vr>>>26)|0,vr&=67108863,G[0]=Ft,G[1]=wt,G[2]=Lt,G[3]=Ae,G[4]=Ye,G[5]=nt,G[6]=ft,G[7]=Mt,G[8]=Rt,G[9]=Gt,G[10]=jt,G[11]=pr,G[12]=Ar,G[13]=fr,G[14]=Zt,G[15]=Qt,G[16]=$t,G[17]=hr,G[18]=vr,W!==0&&(G[19]=W,D.length++),D};function x(S,E,D){return new c().mulp(S,E,D)}function c(S,E){this.x=S,this.y=E}Math.imul||(s=d),r.prototype.mulTo=function(S,E){var D=this.length+S.length;return this.length===10&&S.length===10?s(this,S,E):D<63?d(this,S,E):D<1024?function(R,H,V){V.negative=H.negative^R.negative,V.length=R.length+H.length;for(var X=0,$=0,G=0;G<V.length-1;G++){var W=$;$=0;for(var te=67108863&X,N=Math.min(G,H.length-1),B=Math.max(0,G-R.length+1);B<=N;B++){var U=G-B,ee=(0|R.words[U])*(0|H.words[B]),j=67108863&ee;te=67108863&(j=j+te|0),$+=(W=(W=W+(ee/67108864|0)|0)+(j>>>26)|0)>>>26,W&=67108863}V.words[G]=te,X=W,W=$}return X!==0?V.words[G]=X:V.length--,V.strip()}(this,S,E):x(this,S,E)},c.prototype.makeRBT=function(S){for(var E=new Array(S),D=r.prototype._countBits(S)-1,R=0;R<S;R++)E[R]=this.revBin(R,D,S);return E},c.prototype.revBin=function(S,E,D){if(S===0||S===D-1)return S;for(var R=0,H=0;H<E;H++)R|=(1&S)<<E-H-1,S>>=1;return R},c.prototype.permute=function(S,E,D,R,H,V){for(var X=0;X<V;X++)R[X]=E[S[X]],H[X]=D[S[X]]},c.prototype.transform=function(S,E,D,R,H,V){this.permute(V,S,E,D,R,H);for(var X=1;X<H;X<<=1)for(var $=X<<1,G=Math.cos(2*Math.PI/$),W=Math.sin(2*Math.PI/$),te=0;te<H;te+=$)for(var N=G,B=W,U=0;U<X;U++){var ee=D[te+U],j=R[te+U],Q=D[te+U+X],K=R[te+U+X],re=N*Q-B*K;K=N*K+B*Q,Q=re,D[te+U]=ee+Q,R[te+U]=j+K,D[te+U+X]=ee-Q,R[te+U+X]=j-K,U!==$&&(re=G*N-W*B,B=G*B+W*N,N=re)}},c.prototype.guessLen13b=function(S,E){var D=1|Math.max(E,S),R=1&D,H=0;for(D=D/2|0;D;D>>>=1)H++;return 1<<H+1+R},c.prototype.conjugate=function(S,E,D){if(!(D<=1))for(var R=0;R<D/2;R++){var H=S[R];S[R]=S[D-R-1],S[D-R-1]=H,H=E[R],E[R]=-E[D-R-1],E[D-R-1]=-H}},c.prototype.normalize13b=function(S,E){for(var D=0,R=0;R<E/2;R++){var H=8192*Math.round(S[2*R+1]/E)+Math.round(S[2*R]/E)+D;S[R]=67108863&H,D=H<67108864?0:H/67108864|0}return S},c.prototype.convert13b=function(S,E,D,R){for(var H=0,V=0;V<E;V++)H+=0|S[V],D[2*V]=8191&H,H>>>=13,D[2*V+1]=8191&H,H>>>=13;for(V=2*E;V<R;++V)D[V]=0;t(H===0),t((-8192&H)==0)},c.prototype.stub=function(S){for(var E=new Array(S),D=0;D<S;D++)E[D]=0;return E},c.prototype.mulp=function(S,E,D){var R=2*this.guessLen13b(S.length,E.length),H=this.makeRBT(R),V=this.stub(R),X=new Array(R),$=new Array(R),G=new Array(R),W=new Array(R),te=new Array(R),N=new Array(R),B=D.words;B.length=R,this.convert13b(S.words,S.length,X,R),this.convert13b(E.words,E.length,W,R),this.transform(X,V,$,G,R,H),this.transform(W,V,te,N,R,H);for(var U=0;U<R;U++){var ee=$[U]*te[U]-G[U]*N[U];G[U]=$[U]*N[U]+G[U]*te[U],$[U]=ee}return this.conjugate($,G,R),this.transform($,G,B,V,R,H),this.conjugate(B,V,R),this.normalize13b(B,R),D.negative=S.negative^E.negative,D.length=S.length+E.length,D.strip()},r.prototype.mul=function(S){var E=new r(null);return E.words=new Array(this.length+S.length),this.mulTo(S,E)},r.prototype.mulf=function(S){var E=new r(null);return E.words=new Array(this.length+S.length),x(this,S,E)},r.prototype.imul=function(S){return this.clone().mulTo(S,this)},r.prototype.imuln=function(S){t(typeof S=="number"),t(S<67108864);for(var E=0,D=0;D<this.length;D++){var R=(0|this.words[D])*S,H=(67108863&R)+(67108863&E);E>>=26,E+=R/67108864|0,E+=H>>>26,this.words[D]=67108863&H}return E!==0&&(this.words[D]=E,this.length++),this},r.prototype.muln=function(S){return this.clone().imuln(S)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(S){var E=function(V){for(var X=new Array(V.bitLength()),$=0;$<X.length;$++){var G=$/26|0,W=$%26;X[$]=(V.words[G]&1<<W)>>>W}return X}(S);if(E.length===0)return new r(1);for(var D=this,R=0;R<E.length&&E[R]===0;R++,D=D.sqr());if(++R<E.length)for(var H=D.sqr();R<E.length;R++,H=H.sqr())E[R]!==0&&(D=D.mul(H));return D},r.prototype.iushln=function(S){t(typeof S=="number"&&S>=0);var E,D=S%26,R=(S-D)/26,H=67108863>>>26-D<<26-D;if(D!==0){var V=0;for(E=0;E<this.length;E++){var X=this.words[E]&H,$=(0|this.words[E])-X<<D;this.words[E]=$|V,V=X>>>26-D}V&&(this.words[E]=V,this.length++)}if(R!==0){for(E=this.length-1;E>=0;E--)this.words[E+R]=this.words[E];for(E=0;E<R;E++)this.words[E]=0;this.length+=R}return this.strip()},r.prototype.ishln=function(S){return t(this.negative===0),this.iushln(S)},r.prototype.iushrn=function(S,E,D){var R;t(typeof S=="number"&&S>=0),R=E?(E-E%26)/26:0;var H=S%26,V=Math.min((S-H)/26,this.length),X=67108863^67108863>>>H<<H,$=D;if(R-=V,R=Math.max(0,R),$){for(var G=0;G<V;G++)$.words[G]=this.words[G];$.length=V}if(V!==0)if(this.length>V)for(this.length-=V,G=0;G<this.length;G++)this.words[G]=this.words[G+V];else this.words[0]=0,this.length=1;var W=0;for(G=this.length-1;G>=0&&(W!==0||G>=R);G--){var te=0|this.words[G];this.words[G]=W<<26-H|te>>>H,W=te&X}return $&&W!==0&&($.words[$.length++]=W),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},r.prototype.ishrn=function(S,E,D){return t(this.negative===0),this.iushrn(S,E,D)},r.prototype.shln=function(S){return this.clone().ishln(S)},r.prototype.ushln=function(S){return this.clone().iushln(S)},r.prototype.shrn=function(S){return this.clone().ishrn(S)},r.prototype.ushrn=function(S){return this.clone().iushrn(S)},r.prototype.testn=function(S){t(typeof S=="number"&&S>=0);var E=S%26,D=(S-E)/26,R=1<<E;return!(this.length<=D)&&!!(this.words[D]&R)},r.prototype.imaskn=function(S){t(typeof S=="number"&&S>=0);var E=S%26,D=(S-E)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=D)return this;if(E!==0&&D++,this.length=Math.min(D,this.length),E!==0){var R=67108863^67108863>>>E<<E;this.words[this.length-1]&=R}return this.strip()},r.prototype.maskn=function(S){return this.clone().imaskn(S)},r.prototype.iaddn=function(S){return t(typeof S=="number"),t(S<67108864),S<0?this.isubn(-S):this.negative!==0?this.length===1&&(0|this.words[0])<S?(this.words[0]=S-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(S),this.negative=1,this):this._iaddn(S)},r.prototype._iaddn=function(S){this.words[0]+=S;for(var E=0;E<this.length&&this.words[E]>=67108864;E++)this.words[E]-=67108864,E===this.length-1?this.words[E+1]=1:this.words[E+1]++;return this.length=Math.max(this.length,E+1),this},r.prototype.isubn=function(S){if(t(typeof S=="number"),t(S<67108864),S<0)return this.iaddn(-S);if(this.negative!==0)return this.negative=0,this.iaddn(S),this.negative=1,this;if(this.words[0]-=S,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var E=0;E<this.length&&this.words[E]<0;E++)this.words[E]+=67108864,this.words[E+1]-=1;return this.strip()},r.prototype.addn=function(S){return this.clone().iaddn(S)},r.prototype.subn=function(S){return this.clone().isubn(S)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._ishlnsubmul=function(S,E,D){var R,H,V=S.length+D;this._expand(V);var X=0;for(R=0;R<S.length;R++){H=(0|this.words[R+D])+X;var $=(0|S.words[R])*E;X=((H-=67108863&$)>>26)-($/67108864|0),this.words[R+D]=67108863&H}for(;R<this.length-D;R++)X=(H=(0|this.words[R+D])+X)>>26,this.words[R+D]=67108863&H;if(X===0)return this.strip();for(t(X===-1),X=0,R=0;R<this.length;R++)X=(H=-(0|this.words[R])+X)>>26,this.words[R]=67108863&H;return this.negative=1,this.strip()},r.prototype._wordDiv=function(S,E){var D=(this.length,S.length),R=this.clone(),H=S,V=0|H.words[H.length-1];(D=26-this._countBits(V))!==0&&(H=H.ushln(D),R.iushln(D),V=0|H.words[H.length-1]);var X,$=R.length-H.length;if(E!=="mod"){(X=new r(null)).length=$+1,X.words=new Array(X.length);for(var G=0;G<X.length;G++)X.words[G]=0}var W=R.clone()._ishlnsubmul(H,1,$);W.negative===0&&(R=W,X&&(X.words[$]=1));for(var te=$-1;te>=0;te--){var N=67108864*(0|R.words[H.length+te])+(0|R.words[H.length+te-1]);for(N=Math.min(N/V|0,67108863),R._ishlnsubmul(H,N,te);R.negative!==0;)N--,R.negative=0,R._ishlnsubmul(H,1,te),R.isZero()||(R.negative^=1);X&&(X.words[te]=N)}return X&&X.strip(),R.strip(),E!=="div"&&D!==0&&R.iushrn(D),{div:X||null,mod:R}},r.prototype.divmod=function(S,E,D){return t(!S.isZero()),this.isZero()?{div:new r(0),mod:new r(0)}:this.negative!==0&&S.negative===0?(V=this.neg().divmod(S,E),E!=="mod"&&(R=V.div.neg()),E!=="div"&&(H=V.mod.neg(),D&&H.negative!==0&&H.iadd(S)),{div:R,mod:H}):this.negative===0&&S.negative!==0?(V=this.divmod(S.neg(),E),E!=="mod"&&(R=V.div.neg()),{div:R,mod:V.mod}):(this.negative&S.negative)!=0?(V=this.neg().divmod(S.neg(),E),E!=="div"&&(H=V.mod.neg(),D&&H.negative!==0&&H.isub(S)),{div:V.div,mod:H}):S.length>this.length||this.cmp(S)<0?{div:new r(0),mod:this}:S.length===1?E==="div"?{div:this.divn(S.words[0]),mod:null}:E==="mod"?{div:null,mod:new r(this.modn(S.words[0]))}:{div:this.divn(S.words[0]),mod:new r(this.modn(S.words[0]))}:this._wordDiv(S,E);var R,H,V},r.prototype.div=function(S){return this.divmod(S,"div",!1).div},r.prototype.mod=function(S){return this.divmod(S,"mod",!1).mod},r.prototype.umod=function(S){return this.divmod(S,"mod",!0).mod},r.prototype.divRound=function(S){var E=this.divmod(S);if(E.mod.isZero())return E.div;var D=E.div.negative!==0?E.mod.isub(S):E.mod,R=S.ushrn(1),H=S.andln(1),V=D.cmp(R);return V<0||H===1&&V===0?E.div:E.div.negative!==0?E.div.isubn(1):E.div.iaddn(1)},r.prototype.modn=function(S){t(S<=67108863);for(var E=(1<<26)%S,D=0,R=this.length-1;R>=0;R--)D=(E*D+(0|this.words[R]))%S;return D},r.prototype.idivn=function(S){t(S<=67108863);for(var E=0,D=this.length-1;D>=0;D--){var R=(0|this.words[D])+67108864*E;this.words[D]=R/S|0,E=R%S}return this.strip()},r.prototype.divn=function(S){return this.clone().idivn(S)},r.prototype.egcd=function(S){t(S.negative===0),t(!S.isZero());var E=this,D=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var R=new r(1),H=new r(0),V=new r(0),X=new r(1),$=0;E.isEven()&&D.isEven();)E.iushrn(1),D.iushrn(1),++$;for(var G=D.clone(),W=E.clone();!E.isZero();){for(var te=0,N=1;(E.words[0]&N)==0&&te<26;++te,N<<=1);if(te>0)for(E.iushrn(te);te-- >0;)(R.isOdd()||H.isOdd())&&(R.iadd(G),H.isub(W)),R.iushrn(1),H.iushrn(1);for(var B=0,U=1;(D.words[0]&U)==0&&B<26;++B,U<<=1);if(B>0)for(D.iushrn(B);B-- >0;)(V.isOdd()||X.isOdd())&&(V.iadd(G),X.isub(W)),V.iushrn(1),X.iushrn(1);E.cmp(D)>=0?(E.isub(D),R.isub(V),H.isub(X)):(D.isub(E),V.isub(R),X.isub(H))}return{a:V,b:X,gcd:D.iushln($)}},r.prototype._invmp=function(S){t(S.negative===0),t(!S.isZero());var E=this,D=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var R,H=new r(1),V=new r(0),X=D.clone();E.cmpn(1)>0&&D.cmpn(1)>0;){for(var $=0,G=1;(E.words[0]&G)==0&&$<26;++$,G<<=1);if($>0)for(E.iushrn($);$-- >0;)H.isOdd()&&H.iadd(X),H.iushrn(1);for(var W=0,te=1;(D.words[0]&te)==0&&W<26;++W,te<<=1);if(W>0)for(D.iushrn(W);W-- >0;)V.isOdd()&&V.iadd(X),V.iushrn(1);E.cmp(D)>=0?(E.isub(D),H.isub(V)):(D.isub(E),V.isub(H))}return(R=E.cmpn(1)===0?H:V).cmpn(0)<0&&R.iadd(S),R},r.prototype.gcd=function(S){if(this.isZero())return S.abs();if(S.isZero())return this.abs();var E=this.clone(),D=S.clone();E.negative=0,D.negative=0;for(var R=0;E.isEven()&&D.isEven();R++)E.iushrn(1),D.iushrn(1);for(;;){for(;E.isEven();)E.iushrn(1);for(;D.isEven();)D.iushrn(1);var H=E.cmp(D);if(H<0){var V=E;E=D,D=V}else if(H===0||D.cmpn(1)===0)break;E.isub(D)}return D.iushln(R)},r.prototype.invm=function(S){return this.egcd(S).a.umod(S)},r.prototype.isEven=function(){return(1&this.words[0])==0},r.prototype.isOdd=function(){return(1&this.words[0])==1},r.prototype.andln=function(S){return this.words[0]&S},r.prototype.bincn=function(S){t(typeof S=="number");var E=S%26,D=(S-E)/26,R=1<<E;if(this.length<=D)return this._expand(D+1),this.words[D]|=R,this;for(var H=R,V=D;H!==0&&V<this.length;V++){var X=0|this.words[V];H=(X+=H)>>>26,X&=67108863,this.words[V]=X}return H!==0&&(this.words[V]=H,this.length++),this},r.prototype.isZero=function(){return this.length===1&&this.words[0]===0},r.prototype.cmpn=function(S){var E,D=S<0;if(this.negative!==0&&!D)return-1;if(this.negative===0&&D)return 1;if(this.strip(),this.length>1)E=1;else{D&&(S=-S),t(S<=67108863,"Number is too big");var R=0|this.words[0];E=R===S?0:R<S?-1:1}return this.negative!==0?0|-E:E},r.prototype.cmp=function(S){if(this.negative!==0&&S.negative===0)return-1;if(this.negative===0&&S.negative!==0)return 1;var E=this.ucmp(S);return this.negative!==0?0|-E:E},r.prototype.ucmp=function(S){if(this.length>S.length)return 1;if(this.length<S.length)return-1;for(var E=0,D=this.length-1;D>=0;D--){var R=0|this.words[D],H=0|S.words[D];if(R!==H){R<H?E=-1:R>H&&(E=1);break}}return E},r.prototype.gtn=function(S){return this.cmpn(S)===1},r.prototype.gt=function(S){return this.cmp(S)===1},r.prototype.gten=function(S){return this.cmpn(S)>=0},r.prototype.gte=function(S){return this.cmp(S)>=0},r.prototype.ltn=function(S){return this.cmpn(S)===-1},r.prototype.lt=function(S){return this.cmp(S)===-1},r.prototype.lten=function(S){return this.cmpn(S)<=0},r.prototype.lte=function(S){return this.cmp(S)<=0},r.prototype.eqn=function(S){return this.cmpn(S)===0},r.prototype.eq=function(S){return this.cmp(S)===0},r.red=function(S){return new I(S)},r.prototype.toRed=function(S){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),S.convertTo(this)._forceRed(S)},r.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype._forceRed=function(S){return this.red=S,this},r.prototype.forceRed=function(S){return t(!this.red,"Already a number in reduction context"),this._forceRed(S)},r.prototype.redAdd=function(S){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,S)},r.prototype.redIAdd=function(S){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,S)},r.prototype.redSub=function(S){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,S)},r.prototype.redISub=function(S){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,S)},r.prototype.redShl=function(S){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,S)},r.prototype.redMul=function(S){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.mul(this,S)},r.prototype.redIMul=function(S){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.imul(this,S)},r.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},r.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},r.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},r.prototype.redPow=function(S){return t(this.red&&!S.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,S)};var T={k256:null,p224:null,p192:null,p25519:null};function _(S,E){this.name=S,this.p=new r(E,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function k(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function L(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function A(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function I(S){if(typeof S=="string"){var E=r._prime(S);this.m=E.p,this.prime=E}else t(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}function P(S){I.call(this,S),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var S=new r(null);return S.words=new Array(Math.ceil(this.n/13)),S},_.prototype.ireduce=function(S){var E,D=S;do this.split(D,this.tmp),E=(D=(D=this.imulK(D)).iadd(this.tmp)).bitLength();while(E>this.n);var R=E<this.n?-1:D.ucmp(this.p);return R===0?(D.words[0]=0,D.length=1):R>0?D.isub(this.p):D.strip!==void 0?D.strip():D._strip(),D},_.prototype.split=function(S,E){S.iushrn(this.n,0,E)},_.prototype.imulK=function(S){return S.imul(this.k)},a(w,_),w.prototype.split=function(S,E){for(var D=Math.min(S.length,9),R=0;R<D;R++)E.words[R]=S.words[R];if(E.length=D,S.length<=9)return S.words[0]=0,void(S.length=1);var H=S.words[9];for(E.words[E.length++]=4194303&H,R=10;R<S.length;R++){var V=0|S.words[R];S.words[R-10]=(4194303&V)<<4|H>>>22,H=V}H>>>=22,S.words[R-10]=H,H===0&&S.length>10?S.length-=10:S.length-=9},w.prototype.imulK=function(S){S.words[S.length]=0,S.words[S.length+1]=0,S.length+=2;for(var E=0,D=0;D<S.length;D++){var R=0|S.words[D];E+=977*R,S.words[D]=67108863&E,E=64*R+(E/67108864|0)}return S.words[S.length-1]===0&&(S.length--,S.words[S.length-1]===0&&S.length--),S},a(k,_),a(L,_),a(A,_),A.prototype.imulK=function(S){for(var E=0,D=0;D<S.length;D++){var R=19*(0|S.words[D])+E,H=67108863&R;R>>>=26,S.words[D]=H,E=R}return E!==0&&(S.words[S.length++]=E),S},r._prime=function(S){if(T[S])return T[S];var E;if(S==="k256")E=new w;else if(S==="p224")E=new k;else if(S==="p192")E=new L;else{if(S!=="p25519")throw new Error("Unknown prime "+S);E=new A}return T[S]=E,E},I.prototype._verify1=function(S){t(S.negative===0,"red works only with positives"),t(S.red,"red works only with red numbers")},I.prototype._verify2=function(S,E){t((S.negative|E.negative)==0,"red works only with positives"),t(S.red&&S.red===E.red,"red works only with red numbers")},I.prototype.imod=function(S){return this.prime?this.prime.ireduce(S)._forceRed(this):S.umod(this.m)._forceRed(this)},I.prototype.neg=function(S){return S.isZero()?S.clone():this.m.sub(S)._forceRed(this)},I.prototype.add=function(S,E){this._verify2(S,E);var D=S.add(E);return D.cmp(this.m)>=0&&D.isub(this.m),D._forceRed(this)},I.prototype.iadd=function(S,E){this._verify2(S,E);var D=S.iadd(E);return D.cmp(this.m)>=0&&D.isub(this.m),D},I.prototype.sub=function(S,E){this._verify2(S,E);var D=S.sub(E);return D.cmpn(0)<0&&D.iadd(this.m),D._forceRed(this)},I.prototype.isub=function(S,E){this._verify2(S,E);var D=S.isub(E);return D.cmpn(0)<0&&D.iadd(this.m),D},I.prototype.shl=function(S,E){return this._verify1(S),this.imod(S.ushln(E))},I.prototype.imul=function(S,E){return this._verify2(S,E),this.imod(S.imul(E))},I.prototype.mul=function(S,E){return this._verify2(S,E),this.imod(S.mul(E))},I.prototype.isqr=function(S){return this.imul(S,S.clone())},I.prototype.sqr=function(S){return this.mul(S,S)},I.prototype.sqrt=function(S){if(S.isZero())return S.clone();var E=this.m.andln(3);if(t(E%2==1),E===3){var D=this.m.add(new r(1)).iushrn(2);return this.pow(S,D)}for(var R=this.m.subn(1),H=0;!R.isZero()&&R.andln(1)===0;)H++,R.iushrn(1);t(!R.isZero());var V=new r(1).toRed(this),X=V.redNeg(),$=this.m.subn(1).iushrn(1),G=this.m.bitLength();for(G=new r(2*G*G).toRed(this);this.pow(G,$).cmp(X)!==0;)G.redIAdd(X);for(var W=this.pow(G,R),te=this.pow(S,R.addn(1).iushrn(1)),N=this.pow(S,R),B=H;N.cmp(V)!==0;){for(var U=N,ee=0;U.cmp(V)!==0;ee++)U=U.redSqr();t(ee<B);var j=this.pow(W,new r(1).iushln(B-ee-1));te=te.redMul(j),W=j.redSqr(),N=N.redMul(W),B=ee}return te},I.prototype.invm=function(S){var E=S._invmp(this.m);return E.negative!==0?(E.negative=0,this.imod(E).redNeg()):this.imod(E)},I.prototype.pow=function(S,E){if(E.isZero())return new r(1).toRed(this);if(E.cmpn(1)===0)return S.clone();var D=new Array(16);D[0]=new r(1).toRed(this),D[1]=S;for(var R=2;R<D.length;R++)D[R]=this.mul(D[R-1],S);var H=D[0],V=0,X=0,$=E.bitLength()%26;for($===0&&($=26),R=E.length-1;R>=0;R--){for(var G=E.words[R],W=$-1;W>=0;W--){var te=G>>W&1;H!==D[0]&&(H=this.sqr(H)),te!==0||V!==0?(V<<=1,V|=te,(++X===4||R===0&&W===0)&&(H=this.mul(H,D[V]),X=0,V=0)):X=0}$=26}return H},I.prototype.convertTo=function(S){var E=S.umod(this.m);return E===S?E.clone():E},I.prototype.convertFrom=function(S){var E=S.clone();return E.red=null,E},r.mont=function(S){return new P(S)},a(P,I),P.prototype.convertTo=function(S){return this.imod(S.ushln(this.shift))},P.prototype.convertFrom=function(S){var E=this.imod(S.mul(this.rinv));return E.red=null,E},P.prototype.imul=function(S,E){if(S.isZero()||E.isZero())return S.words[0]=0,S.length=1,S;var D=S.imul(E),R=D.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),H=D.isub(R).iushrn(this.shift),V=H;return H.cmp(this.m)>=0?V=H.isub(this.m):H.cmpn(0)<0&&(V=H.iadd(this.m)),V._forceRed(this)},P.prototype.mul=function(S,E){if(S.isZero()||E.isZero())return new r(0)._forceRed(this);var D=S.mul(E),R=D.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),H=D.isub(R).iushrn(this.shift),V=H;return H.cmp(this.m)>=0?V=H.isub(this.m):H.cmpn(0)<0&&(V=H.iadd(this.m)),V._forceRed(this)},P.prototype.invm=function(S){return this.imod(S._invmp(this.m).mul(this.r2))._forceRed(this)}})(b===void 0||b,this)},{buffer:2}],34:[function(g,b,y){b.exports=function(e){var n,t,a,r=e.length,m=0;for(n=0;n<r;++n)m+=e[n].length;var o=new Array(m),i=0;for(n=0;n<r;++n){var u=e[n],f=u.length;for(t=0;t<f;++t){var l=o[i++]=new Array(f-1),h=0;for(a=0;a<f;++a)a!==t&&(l[h++]=u[a]);if(1&t){var d=l[1];l[1]=l[0],l[0]=d}}}return o}},{}],35:[function(g,b,y){b.exports=function(l,h,d){switch(arguments.length){case 1:return u(l);case 2:return typeof h=="function"?o(l,l,h,!0):f(l,h);case 3:return o(l,h,d,!1);default:throw new Error("box-intersect: Invalid arguments")}};var e,n=g("typedarray-pool"),t=g("./lib/sweep"),a=g("./lib/intersect");function r(l,h){for(var d=0;d<l;++d)if(!(h[d]<=h[d+l]))return!0;return!1}function m(l,h,d,s){for(var x=0,c=0,T=0,_=l.length;T<_;++T){var w=l[T];if(!r(h,w)){for(var k=0;k<2*h;++k)d[x++]=w[k];s[c++]=T}}return c}function o(l,h,d,s){var x=l.length,c=h.length;if(!(x<=0||c<=0)){var T=l[0].length>>>1;if(!(T<=0)){var _,w=n.mallocDouble(2*T*x),k=n.mallocInt32(x);if((x=m(l,T,w,k))>0){if(T===1&&s)t.init(x),_=t.sweepComplete(T,d,0,x,w,k,0,x,w,k);else{var L=n.mallocDouble(2*T*c),A=n.mallocInt32(c);(c=m(h,T,L,A))>0&&(t.init(x+c),_=T===1?t.sweepBipartite(T,d,0,x,w,k,0,c,L,A):a(T,d,s,x,w,k,c,L,A),n.free(L),n.free(A))}n.free(w),n.free(k)}return _}}}function i(l,h){e.push([l,h])}function u(l){return e=[],o(l,l,i,!0),e}function f(l,h){return e=[],o(l,h,i,!1),e}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(g,b,y){function e(n){return n?function(t,a,r,m,o,i,u,f,l,h,d){return o-m>l-f?function(s,x,c,T,_,w,k,L,A,I,P){for(var S=2*s,E=T,D=S*T;E<_;++E,D+=S){var R=w[x+D],H=w[x+D+s],V=k[E];e:for(var X=L,$=S*L;X<A;++X,$+=S){var G=I[x+$],W=I[x+$+s],te=P[X];if(!(W<R||H<G)){for(var N=x+1;N<s;++N){var B=w[N+D],U=w[N+s+D],ee=I[N+$],j=I[N+s+$];if(U<ee||j<B)continue e}var Q=c(V,te);if(Q!==void 0)return Q}}}}(t,a,r,m,o,i,u,f,l,h,d):function(s,x,c,T,_,w,k,L,A,I,P){for(var S=2*s,E=L,D=S*L;E<A;++E,D+=S){var R=I[x+D],H=I[x+D+s],V=P[E];e:for(var X=T,$=S*T;X<_;++X,$+=S){var G=w[x+$],W=w[x+$+s],te=k[X];if(!(H<G||W<R)){for(var N=x+1;N<s;++N){var B=w[N+$],U=w[N+s+$],ee=I[N+D],j=I[N+s+D];if(U<ee||j<B)continue e}var Q=c(te,V);if(Q!==void 0)return Q}}}}(t,a,r,m,o,i,u,f,l,h,d)}:function(t,a,r,m,o,i,u,f,l,h,d,s){return i-o>h-l?m?function(x,c,T,_,w,k,L,A,I,P,S){for(var E=2*x,D=_,R=E*_;D<w;++D,R+=E){var H=k[c+R],V=k[c+R+x],X=L[D];e:for(var $=A,G=E*A;$<I;++$,G+=E){var W=P[c+G],te=S[$];if(!(W<=H||V<W)){for(var N=c+1;N<x;++N){var B=k[N+R],U=k[N+x+R],ee=P[N+G],j=P[N+x+G];if(U<ee||j<B)continue e}var Q=T(te,X);if(Q!==void 0)return Q}}}}(t,a,r,o,i,u,f,l,h,d,s):function(x,c,T,_,w,k,L,A,I,P,S){for(var E=2*x,D=_,R=E*_;D<w;++D,R+=E){var H=k[c+R],V=k[c+R+x],X=L[D];e:for(var $=A,G=E*A;$<I;++$,G+=E){var W=P[c+G],te=S[$];if(!(W<H||V<W)){for(var N=c+1;N<x;++N){var B=k[N+R],U=k[N+x+R],ee=P[N+G],j=P[N+x+G];if(U<ee||j<B)continue e}var Q=T(X,te);if(Q!==void 0)return Q}}}}(t,a,r,o,i,u,f,l,h,d,s):m?function(x,c,T,_,w,k,L,A,I,P,S){for(var E=2*x,D=A,R=E*A;D<I;++D,R+=E){var H=P[c+R],V=S[D];e:for(var X=_,$=E*_;X<w;++X,$+=E){var G=k[c+$],W=k[c+$+x],te=L[X];if(!(H<=G||W<H)){for(var N=c+1;N<x;++N){var B=k[N+$],U=k[N+x+$],ee=P[N+R],j=P[N+x+R];if(U<ee||j<B)continue e}var Q=T(V,te);if(Q!==void 0)return Q}}}}(t,a,r,o,i,u,f,l,h,d,s):function(x,c,T,_,w,k,L,A,I,P,S){for(var E=2*x,D=A,R=E*A;D<I;++D,R+=E){var H=P[c+R],V=S[D];e:for(var X=_,$=E*_;X<w;++X,$+=E){var G=k[c+$],W=k[c+$+x],te=L[X];if(!(H<G||W<H)){for(var N=c+1;N<x;++N){var B=k[N+$],U=k[N+x+$],ee=P[N+R],j=P[N+x+R];if(U<ee||j<B)continue e}var Q=T(te,V);if(Q!==void 0)return Q}}}}(t,a,r,o,i,u,f,l,h,d,s)}}y.partial=e(!1),y.full=e(!0)},{}],37:[function(g,b,y){b.exports=function(k,L,A,I,P,S,E,D,R){(function(Me,ke){var Le=8*n.log2(ke+1)*(Me+1)|0,ze=n.nextPow2(6*Le);x.length<ze&&(e.free(x),x=e.mallocInt32(ze));var Re=n.nextPow2(2*Le);c.length<Re&&(e.free(c),c=e.mallocDouble(Re))})(k,I+E);var H,V=0,X=2*k;for(T(V++,0,0,I,0,E,A?16:0,-1/0,1/0),A||T(V++,0,0,E,0,I,1,-1/0,1/0);V>0;){var $=6*(V-=1),G=x[$],W=x[$+1],te=x[$+2],N=x[$+3],B=x[$+4],U=x[$+5],ee=2*V,j=c[ee],Q=c[ee+1],K=1&U,re=!!(16&U),ne=P,le=S,oe=D,de=R;if(K&&(ne=D,le=R,oe=P,de=S),!(2&U&&(te=l(k,G,W,te,ne,le,Q),W>=te)||4&U&&(W=h(k,G,W,te,ne,le,j))>=te)){var se=te-W,me=B-N;if(re){if(k*se*(se+me)<1<<22){if((H=m.scanComplete(k,G,L,W,te,ne,le,N,B,oe,de))!==void 0)return H;continue}}else{if(k*Math.min(se,me)<128){if((H=a(k,G,L,K,W,te,ne,le,N,B,oe,de))!==void 0)return H;continue}if(k*se*me<1<<22){if((H=m.scanBipartite(k,G,L,K,W,te,ne,le,N,B,oe,de))!==void 0)return H;continue}}var Te=u(k,G,W,te,ne,le,j,Q);if(W<Te)if(k*(Te-W)<128){if((H=r(k,G+1,L,W,Te,ne,le,N,B,oe,de))!==void 0)return H}else if(G===k-2){if((H=K?m.sweepBipartite(k,L,N,B,oe,de,W,Te,ne,le):m.sweepBipartite(k,L,W,Te,ne,le,N,B,oe,de))!==void 0)return H}else T(V++,G+1,W,Te,N,B,K,-1/0,1/0),T(V++,G+1,N,B,W,Te,1^K,-1/0,1/0);if(Te<te){var _e=o(k,G,N,B,oe,de),be=oe[X*_e+G],Ce=f(k,G,_e,B,oe,de,be);if(Ce<B&&T(V++,G,Te,te,Ce,B,(4|K)+(re?16:0),be,Q),N<_e&&T(V++,G,Te,te,N,_e,(2|K)+(re?16:0),j,be),_e+1===Ce){if((H=re?w(k,G,L,Te,te,ne,le,_e,oe,de[_e]):_(k,G,L,K,Te,te,ne,le,_e,oe,de[_e]))!==void 0)return H}else if(_e<Ce){var fe;if(re){if(fe=d(k,G,Te,te,ne,le,be),Te<fe){var ve=f(k,G,Te,fe,ne,le,be);if(G===k-2){if(Te<ve&&(H=m.sweepComplete(k,L,Te,ve,ne,le,_e,Ce,oe,de))!==void 0||ve<fe&&(H=m.sweepBipartite(k,L,ve,fe,ne,le,_e,Ce,oe,de))!==void 0)return H}else Te<ve&&T(V++,G+1,Te,ve,_e,Ce,16,-1/0,1/0),ve<fe&&(T(V++,G+1,ve,fe,_e,Ce,0,-1/0,1/0),T(V++,G+1,_e,Ce,ve,fe,1,-1/0,1/0))}}else fe=K?s(k,G,Te,te,ne,le,be):d(k,G,Te,te,ne,le,be),Te<fe&&(G===k-2?H=K?m.sweepBipartite(k,L,_e,Ce,oe,de,Te,fe,ne,le):m.sweepBipartite(k,L,Te,fe,ne,le,_e,Ce,oe,de):(T(V++,G+1,Te,fe,_e,Ce,K,-1/0,1/0),T(V++,G+1,_e,Ce,Te,fe,1^K,-1/0,1/0)))}}}}};var e=g("typedarray-pool"),n=g("bit-twiddle"),t=g("./brute"),a=t.partial,r=t.full,m=g("./sweep"),o=g("./median"),i=g("./partition"),u=i("!(lo>=p0)&&!(p1>=hi)"),f=i("lo===p0"),l=i("lo<p0"),h=i("hi<=p0"),d=i("lo<=p0&&p0<=hi"),s=i("lo<p0&&p0<=hi"),x=e.mallocInt32(1024),c=e.mallocDouble(1024);function T(k,L,A,I,P,S,E,D,R){var H=6*k;x[H]=L,x[H+1]=A,x[H+2]=I,x[H+3]=P,x[H+4]=S,x[H+5]=E;var V=2*k;c[V]=D,c[V+1]=R}function _(k,L,A,I,P,S,E,D,R,H,V){var X=2*k,$=R*X,G=H[$+L];e:for(var W=P,te=P*X;W<S;++W,te+=X){var N=E[te+L],B=E[te+L+k];if(!(G<N||B<G)&&(!I||G!==N)){for(var U,ee=D[W],j=L+1;j<k;++j){N=E[te+j],B=E[te+j+k];var Q=H[$+j],K=H[$+j+k];if(B<Q||K<N)continue e}if((U=I?A(V,ee):A(ee,V))!==void 0)return U}}}function w(k,L,A,I,P,S,E,D,R,H){var V=2*k,X=D*V,$=R[X+L];e:for(var G=I,W=I*V;G<P;++G,W+=V){var te=E[G];if(te!==H){var N=S[W+L],B=S[W+L+k];if(!($<N||B<$)){for(var U=L+1;U<k;++U){N=S[W+U],B=S[W+U+k];var ee=R[X+U],j=R[X+U+k];if(B<ee||j<N)continue e}var Q=A(te,H);if(Q!==void 0)return Q}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(g,b,y){b.exports=function(t,a,r,m,o,i){if(m<=r+1)return r;for(var u=r,f=m,l=m+r>>>1,h=2*t,d=l,s=o[h*l+a];u<f;){if(f-u<8){n(t,a,u,f,o,i),s=o[h*l+a];break}var x=f-u,c=Math.random()*x+u|0,T=o[h*c+a],_=Math.random()*x+u|0,w=o[h*_+a],k=Math.random()*x+u|0,L=o[h*k+a];T<=w?L>=w?(d=_,s=w):T>=L?(d=c,s=T):(d=k,s=L):w>=L?(d=_,s=w):L>=T?(d=c,s=T):(d=k,s=L);for(var A=h*(f-1),I=h*d,P=0;P<h;++P,++A,++I){var S=o[A];o[A]=o[I],o[I]=S}var E=i[f-1];for(i[f-1]=i[d],i[d]=E,d=e(t,a,u,f-1,o,i,s),A=h*(f-1),I=h*d,P=0;P<h;++P,++A,++I)S=o[A],o[A]=o[I],o[I]=S;if(E=i[f-1],i[f-1]=i[d],i[d]=E,l<d){for(f=d-1;u<f&&o[h*(f-1)+a]===s;)f-=1;f+=1}else{if(!(d<l))break;for(u=d+1;u<f&&o[h*u+a]===s;)u+=1}}return e(t,a,r,l,o,i,o[h*l+a])};var e=g("./partition")("lo<p0");function n(t,a,r,m,o,i){for(var u=2*t,f=u*(r+1)+a,l=r+1;l<m;++l,f+=u)for(var h=o[f],d=l,s=u*(l-1);d>r&&o[s+a]>h;--d,s-=u){for(var x=s,c=s+u,T=0;T<u;++T,++x,++c){var _=o[x];o[x]=o[c],o[c]=_}var w=i[d];i[d]=i[d-1],i[d-1]=w}}},{"./partition":39}],39:[function(g,b,y){b.exports=function(n){return e[n]};var e={"lo===p0":function(n,t,a,r,m,o,i){for(var u=2*n,f=u*a,l=f,h=a,d=t,s=a;r>s;++s,f+=u)if(m[f+d]===i)if(h===s)h+=1,l+=u;else{for(var x=0;u>x;++x){var c=m[f+x];m[f+x]=m[l],m[l++]=c}var T=o[s];o[s]=o[h],o[h++]=T}return h},"lo<p0":function(n,t,a,r,m,o,i){for(var u=2*n,f=u*a,l=f,h=a,d=t,s=a;r>s;++s,f+=u)if(m[f+d]<i)if(h===s)h+=1,l+=u;else{for(var x=0;u>x;++x){var c=m[f+x];m[f+x]=m[l],m[l++]=c}var T=o[s];o[s]=o[h],o[h++]=T}return h},"lo<=p0":function(n,t,a,r,m,o,i){for(var u=2*n,f=u*a,l=f,h=a,d=n+t,s=a;r>s;++s,f+=u)if(m[f+d]<=i)if(h===s)h+=1,l+=u;else{for(var x=0;u>x;++x){var c=m[f+x];m[f+x]=m[l],m[l++]=c}var T=o[s];o[s]=o[h],o[h++]=T}return h},"hi<=p0":function(n,t,a,r,m,o,i){for(var u=2*n,f=u*a,l=f,h=a,d=n+t,s=a;r>s;++s,f+=u)if(m[f+d]<=i)if(h===s)h+=1,l+=u;else{for(var x=0;u>x;++x){var c=m[f+x];m[f+x]=m[l],m[l++]=c}var T=o[s];o[s]=o[h],o[h++]=T}return h},"lo<p0&&p0<=hi":function(n,t,a,r,m,o,i){for(var u=2*n,f=u*a,l=f,h=a,d=t,s=n+t,x=a;r>x;++x,f+=u){var c=m[f+d],T=m[f+s];if(c<i&&i<=T)if(h===x)h+=1,l+=u;else{for(var _=0;u>_;++_){var w=m[f+_];m[f+_]=m[l],m[l++]=w}var k=o[x];o[x]=o[h],o[h++]=k}}return h},"lo<=p0&&p0<=hi":function(n,t,a,r,m,o,i){for(var u=2*n,f=u*a,l=f,h=a,d=t,s=n+t,x=a;r>x;++x,f+=u){var c=m[f+d],T=m[f+s];if(c<=i&&i<=T)if(h===x)h+=1,l+=u;else{for(var _=0;u>_;++_){var w=m[f+_];m[f+_]=m[l],m[l++]=w}var k=o[x];o[x]=o[h],o[h++]=k}}return h},"!(lo>=p0)&&!(p1>=hi)":function(n,t,a,r,m,o,i,u){for(var f=2*n,l=f*a,h=l,d=a,s=t,x=n+t,c=a;r>c;++c,l+=f){var T=m[l+s],_=m[l+x];if(!(T>=i||u>=_))if(d===c)d+=1,h+=f;else{for(var w=0;f>w;++w){var k=m[l+w];m[l+w]=m[h],m[h++]=k}var L=o[c];o[c]=o[d],o[d++]=L}}return d}}},{}],40:[function(g,b,y){b.exports=function(i,u){u<=128?e(0,u-1,i):function f(l,h,d){var s=(h-l+1)/6|0,x=l+s,c=h-s,T=l+h>>1,_=T-s,w=T+s,k=x,L=_,A=T,I=w,P=c,S=l+1,E=h-1,D=0;m(k,L,d)&&(D=k,k=L,L=D),m(I,P,d)&&(D=I,I=P,P=D),m(k,A,d)&&(D=k,k=A,A=D),m(L,A,d)&&(D=L,L=A,A=D),m(k,I,d)&&(D=k,k=I,I=D),m(A,I,d)&&(D=A,A=I,I=D),m(L,P,d)&&(D=L,L=P,P=D),m(L,A,d)&&(D=L,L=A,A=D),m(I,P,d)&&(D=I,I=P,P=D);for(var R=d[2*L],H=d[2*L+1],V=d[2*I],X=d[2*I+1],$=2*k,G=2*A,W=2*P,te=2*x,N=2*T,B=2*c,U=0;U<2;++U){var ee=d[$+U],j=d[G+U],Q=d[W+U];d[te+U]=ee,d[N+U]=j,d[B+U]=Q}t(_,l,d),t(w,h,d);for(var K=S;K<=E;++K)if(o(K,R,H,d))K!==S&&n(K,S,d),++S;else if(!o(K,V,X,d))for(;;){if(o(E,V,X,d)){o(E,R,H,d)?(a(K,S,E,d),++S,--E):(n(K,E,d),--E);break}if(--E<K)break}r(l,S-1,R,H,d),r(h,E+1,V,X,d),S-2-l<=32?e(l,S-2,d):f(l,S-2,d),h-(E+2)<=32?e(E+2,h,d):f(E+2,h,d),E-S<=32?e(S,E,d):f(S,E,d)}(0,u-1,i)};function e(i,u,f){for(var l=2*(i+1),h=i+1;h<=u;++h){for(var d=f[l++],s=f[l++],x=h,c=l-2;x-- >i;){var T=f[c-2],_=f[c-1];if(T<d||T===d&&_<s)break;f[c]=T,f[c+1]=_,c-=2}f[c]=d,f[c+1]=s}}function n(i,u,f){u*=2;var l=f[i*=2],h=f[i+1];f[i]=f[u],f[i+1]=f[u+1],f[u]=l,f[u+1]=h}function t(i,u,f){u*=2,f[i*=2]=f[u],f[i+1]=f[u+1]}function a(i,u,f,l){u*=2,f*=2;var h=l[i*=2],d=l[i+1];l[i]=l[u],l[i+1]=l[u+1],l[u]=l[f],l[u+1]=l[f+1],l[f]=h,l[f+1]=d}function r(i,u,f,l,h){u*=2,h[i*=2]=h[u],h[u]=f,h[i+1]=h[u+1],h[u+1]=l}function m(i,u,f){u*=2;var l=f[i*=2],h=f[u];return!(l<h)&&(l!==h||f[i+1]>f[u+1])}function o(i,u,f,l){var h=l[i*=2];return h<u||h===u&&l[i+1]<f}},{}],41:[function(g,b,y){b.exports={init:function(d){var s=n.nextPow2(d);a.length<s&&(e.free(a),a=e.mallocInt32(s)),r.length<s&&(e.free(r),r=e.mallocInt32(s)),m.length<s&&(e.free(m),m=e.mallocInt32(s)),o.length<s&&(e.free(o),o=e.mallocInt32(s)),i.length<s&&(e.free(i),i=e.mallocInt32(s)),u.length<s&&(e.free(u),u=e.mallocInt32(s));var x=8*s;f.length<x&&(e.free(f),f=e.mallocDouble(x))},sweepBipartite:function(d,s,x,c,T,_,w,k,L,A){for(var I=0,P=2*d,S=d-1,E=P-1,D=x;D<c;++D){var R=_[D],H=P*D;f[I++]=T[H+S],f[I++]=-(R+1),f[I++]=T[H+E],f[I++]=R}for(D=w;D<k;++D){R=A[D]+(1<<28);var V=P*D;f[I++]=L[V+S],f[I++]=-R,f[I++]=L[V+E],f[I++]=R}var X=I>>>1;t(f,X);var $=0,G=0;for(D=0;D<X;++D){var W=0|f[2*D+1];if(W>=1<<28)l(m,o,G--,W=W-(1<<28)|0);else if(W>=0)l(a,r,$--,W);else if(W<=-(1<<28)){W=-W-(1<<28)|0;for(var te=0;te<$;++te)if((N=s(a[te],W))!==void 0)return N;h(m,o,G++,W)}else{for(W=-W-1|0,te=0;te<G;++te){var N;if((N=s(W,m[te]))!==void 0)return N}h(a,r,$++,W)}}},sweepComplete:function(d,s,x,c,T,_,w,k,L,A){for(var I=0,P=2*d,S=d-1,E=P-1,D=x;D<c;++D){var R=_[D]+1<<1,H=P*D;f[I++]=T[H+S],f[I++]=-R,f[I++]=T[H+E],f[I++]=R}for(D=w;D<k;++D){R=A[D]+1<<1;var V=P*D;f[I++]=L[V+S],f[I++]=1|-R,f[I++]=L[V+E],f[I++]=1|R}var X=I>>>1;t(f,X);var $=0,G=0,W=0;for(D=0;D<X;++D){var te=0|f[2*D+1],N=1&te;if(D<X-1&&te>>1==f[2*D+3]>>1&&(N=2,D+=1),te<0){for(var B=-(te>>1)-1,U=0;U<W;++U)if((ee=s(i[U],B))!==void 0)return ee;if(N!==0){for(U=0;U<$;++U)if((ee=s(a[U],B))!==void 0)return ee}if(N!==1)for(U=0;U<G;++U){var ee;if((ee=s(m[U],B))!==void 0)return ee}N===0?h(a,r,$++,B):N===1?h(m,o,G++,B):N===2&&h(i,u,W++,B)}else B=(te>>1)-1,N===0?l(a,r,$--,B):N===1?l(m,o,G--,B):N===2&&l(i,u,W--,B)}},scanBipartite:function(d,s,x,c,T,_,w,k,L,A,I,P){var S=0,E=2*d,D=s,R=s+d,H=1,V=1;c?V=1<<28:H=1<<28;for(var X=T;X<_;++X){var $=X+H,G=E*X;f[S++]=w[G+D],f[S++]=-$,f[S++]=w[G+R],f[S++]=$}for(X=L;X<A;++X){$=X+V;var W=E*X;f[S++]=I[W+D],f[S++]=-$}var te=S>>>1;t(f,te);var N=0;for(X=0;X<te;++X){var B=0|f[2*X+1];if(B<0){var U=!1;if(($=-B)>=1<<28?(U=!c,$-=1<<28):(U=!!c,$-=1),U)h(a,r,N++,$);else{var ee=P[$],j=E*$,Q=I[j+s+1],K=I[j+s+1+d];e:for(var re=0;re<N;++re){var ne=a[re],le=E*ne;if(!(K<w[le+s+1]||w[le+s+1+d]<Q)){for(var oe=s+2;oe<d;++oe)if(I[j+oe+d]<w[le+oe]||w[le+oe+d]<I[j+oe])continue e;var de,se=k[ne];if((de=c?x(ee,se):x(se,ee))!==void 0)return de}}}}else l(a,r,N--,B-H)}},scanComplete:function(d,s,x,c,T,_,w,k,L,A,I){for(var P=0,S=2*d,E=s,D=s+d,R=c;R<T;++R){var H=R+268435456,V=S*R;f[P++]=_[V+E],f[P++]=-H,f[P++]=_[V+D],f[P++]=H}for(R=k;R<L;++R){H=R+1;var X=S*R;f[P++]=A[X+E],f[P++]=-H}var $=P>>>1;t(f,$);var G=0;for(R=0;R<$;++R){var W=0|f[2*R+1];if(W<0)if((H=-W)>=1<<28)a[G++]=H-(1<<28);else{var te=I[H-=1],N=S*H,B=A[N+s+1],U=A[N+s+1+d];e:for(var ee=0;ee<G;++ee){var j=a[ee],Q=w[j];if(Q===te)break;var K=S*j;if(!(U<_[K+s+1]||_[K+s+1+d]<B)){for(var re=s+2;re<d;++re)if(A[N+re+d]<_[K+re]||_[K+re+d]<A[N+re])continue e;var ne=x(Q,te);if(ne!==void 0)return ne}}}else{for(H=W-(1<<28),ee=G-1;ee>=0;--ee)if(a[ee]===H){for(re=ee+1;re<G;++re)a[re-1]=a[re];break}--G}}}};var e=g("typedarray-pool"),n=g("bit-twiddle"),t=g("./sort"),a=e.mallocInt32(1024),r=e.mallocInt32(1024),m=e.mallocInt32(1024),o=e.mallocInt32(1024),i=e.mallocInt32(1024),u=e.mallocInt32(1024),f=e.mallocDouble(8192);function l(d,s,x,c){var T=s[c],_=d[x-1];d[T]=_,s[_]=T}function h(d,s,x,c){d[x]=c,s[c]=x}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(g,b,y){var e=g("./lib/monotone"),n=g("./lib/triangulation"),t=g("./lib/delaunay"),a=g("./lib/filter");function r(i){return[Math.min(i[0],i[1]),Math.max(i[0],i[1])]}function m(i,u){return i[0]-u[0]||i[1]-u[1]}function o(i,u,f){return u in i?i[u]:f}b.exports=function(i,u,f){Array.isArray(u)?(f=f||{},u=u||[]):(f=u||{},u=[]);var l=!!o(f,"delaunay",!0),h=!!o(f,"interior",!0),d=!!o(f,"exterior",!0),s=!!o(f,"infinity",!1);if(!h&&!d||i.length===0)return[];var x=e(i,u);if(l||h!==d||s){for(var c=n(i.length,function(w){return w.map(r).sort(m)}(u)),T=0;T<x.length;++T){var _=x[T];c.addTriangle(_[0],_[1],_[2])}return l&&t(i,c),d?h?s?a(c,0,s):c.cells():a(c,1,s):a(c,-1)}return x}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(g,b,y){var e=g("robust-in-sphere")[4];g("binary-search-bounds");function n(t,a,r,m,o,i){var u=a.opposite(m,o);if(!(u<0)){if(o<m){var f=m;m=o,o=f,f=i,i=u,u=f}a.isConstraint(m,o)||e(t[m],t[o],t[i],t[u])<0&&r.push(m,o)}}b.exports=function(t,a){for(var r=[],m=t.length,o=a.stars,i=0;i<m;++i)for(var u=o[i],f=1;f<u.length;f+=2)if(!((s=u[f])<i)&&!a.isConstraint(i,s)){for(var l=u[f-1],h=-1,d=1;d<u.length;d+=2)if(u[d-1]===s){h=u[d];break}h<0||e(t[i],t[s],t[l],t[h])<0&&r.push(i,s)}for(;r.length>0;){for(var s=r.pop(),x=(i=r.pop(),l=-1,h=-1,u=o[i],1);x<u.length;x+=2){var c=u[x-1],T=u[x];c===s?h=T:T===s&&(l=c)}l<0||h<0||e(t[i],t[s],t[l],t[h])>=0||(a.flip(i,s),n(t,a,r,l,i,h),n(t,a,r,i,h,l),n(t,a,r,h,s,l),n(t,a,r,s,l,h))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(g,b,y){var e,n=g("binary-search-bounds");function t(r,m,o,i,u,f,l){this.cells=r,this.neighbor=m,this.flags=i,this.constraint=o,this.active=u,this.next=f,this.boundary=l}function a(r,m){return r[0]-m[0]||r[1]-m[1]||r[2]-m[2]}b.exports=function(r,m,o){var i=function(L,A){for(var I=L.cells(),P=I.length,S=0;S<P;++S){var E=(N=I[S])[0],D=N[1],R=N[2];D<R?D<E&&(N[0]=D,N[1]=R,N[2]=E):R<E&&(N[0]=R,N[1]=E,N[2]=D)}I.sort(a);var H=new Array(P);for(S=0;S<H.length;++S)H[S]=0;var V=[],X=[],$=new Array(3*P),G=new Array(3*P),W=null;A&&(W=[]);var te=new t(I,$,G,H,V,X,W);for(S=0;S<P;++S)for(var N=I[S],B=0;B<3;++B){E=N[B],D=N[(B+1)%3];var U=$[3*S+B]=te.locate(D,E,L.opposite(D,E)),ee=G[3*S+B]=L.isConstraint(E,D);U<0&&(ee?X.push(S):(V.push(S),H[S]=1),A&&W.push([D,E,-1]))}return te}(r,o);if(m===0)return o?i.cells.concat(i.boundary):i.cells;for(var u=1,f=i.active,l=i.next,h=i.flags,d=i.cells,s=i.constraint,x=i.neighbor;f.length>0||l.length>0;){for(;f.length>0;){var c=f.pop();if(h[c]!==-u){h[c]=u,d[c];for(var T=0;T<3;++T){var _=x[3*c+T];_>=0&&h[_]===0&&(s[3*c+T]?l.push(_):(f.push(_),h[_]=u))}}}var w=l;l=f,f=w,l.length=0,u=-u}var k=function(L,A,I){for(var P=0,S=0;S<L.length;++S)A[S]===I&&(L[P++]=L[S]);return L.length=P,L}(d,h,m);return o?k.concat(i.boundary):k},t.prototype.locate=(e=[0,0,0],function(r,m,o){var i=r,u=m,f=o;return m<o?m<r&&(i=m,u=o,f=r):o<r&&(i=o,u=r,f=m),i<0?-1:(e[0]=i,e[1]=u,e[2]=f,n.eq(this.cells,e,a))})},{"binary-search-bounds":31}],45:[function(g,b,y){var e=g("binary-search-bounds"),n=g("robust-orientation")[3];function t(l,h,d,s,x){this.a=l,this.b=h,this.idx=d,this.lowerIds=s,this.upperIds=x}function a(l,h,d,s){this.a=l,this.b=h,this.type=d,this.idx=s}function r(l,h){var d=l.a[0]-h.a[0]||l.a[1]-h.a[1]||l.type-h.type;return d||(l.type!==0&&(d=n(l.a,l.b,h.b))?d:l.idx-h.idx)}function m(l,h){return n(l.a,l.b,h)}function o(l,h,d,s,x){for(var c=e.lt(h,s,m),T=e.gt(h,s,m),_=c;_<T;++_){for(var w=h[_],k=w.lowerIds,L=k.length;L>1&&n(d[k[L-2]],d[k[L-1]],s)>0;)l.push([k[L-1],k[L-2],x]),L-=1;k.length=L,k.push(x);var A=w.upperIds;for(L=A.length;L>1&&n(d[A[L-2]],d[A[L-1]],s)<0;)l.push([A[L-2],A[L-1],x]),L-=1;A.length=L,A.push(x)}}function i(l,h){var d;return(d=l.a[0]<h.a[0]?n(l.a,l.b,h.a):n(h.b,h.a,l.a))?d:(d=h.b[0]<l.b[0]?n(l.a,l.b,h.b):n(h.b,h.a,l.b))||l.idx-h.idx}function u(l,h,d){var s=e.le(l,d,i),x=l[s],c=x.upperIds,T=c[c.length-1];x.upperIds=[T],l.splice(s+1,0,new t(d.a,d.b,d.idx,[T],c))}function f(l,h,d){var s=d.a;d.a=d.b,d.b=s;var x=e.eq(l,d,i),c=l[x];l[x-1].upperIds=c.upperIds,l.splice(x,1)}b.exports=function(l,h){for(var d=l.length,s=h.length,x=[],c=0;c<d;++c)x.push(new a(l[c],null,0,c));for(c=0;c<s;++c){var T=h[c],_=l[T[0]],w=l[T[1]];_[0]<w[0]?x.push(new a(_,w,2,c),new a(w,_,1,c)):_[0]>w[0]&&x.push(new a(w,_,2,c),new a(_,w,1,c))}x.sort(r);for(var k=x[0].a[0]-(1+Math.abs(x[0].a[0]))*Math.pow(2,-52),L=[new t([k,1],[k,0],-1,[],[])],A=[],I=(c=0,x.length);c<I;++c){var P=x[c],S=P.type;S===0?o(A,L,l,P.a,P.idx):S===2?u(L,l,P):f(L,l,P)}return A}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(g,b,y){var e=g("binary-search-bounds");function n(r,m){this.stars=r,this.edges=m}b.exports=function(r,m){for(var o=new Array(r),i=0;i<r;++i)o[i]=[];return new n(o,m)};var t=n.prototype;function a(r,m,o){for(var i=1,u=r.length;i<u;i+=2)if(r[i-1]===m&&r[i]===o)return r[i-1]=r[u-2],r[i]=r[u-1],void(r.length=u-2)}t.isConstraint=function(){var r=[0,0];function m(o,i){return o[0]-i[0]||o[1]-i[1]}return function(o,i){return r[0]=Math.min(o,i),r[1]=Math.max(o,i),e.eq(this.edges,r,m)>=0}}(),t.removeTriangle=function(r,m,o){var i=this.stars;a(i[r],m,o),a(i[m],o,r),a(i[o],r,m)},t.addTriangle=function(r,m,o){var i=this.stars;i[r].push(m,o),i[m].push(o,r),i[o].push(r,m)},t.opposite=function(r,m){for(var o=this.stars[m],i=1,u=o.length;i<u;i+=2)if(o[i]===r)return o[i-1];return-1},t.flip=function(r,m){var o=this.opposite(r,m),i=this.opposite(m,r);this.removeTriangle(r,m,o),this.removeTriangle(m,r,i),this.addTriangle(r,i,o),this.addTriangle(m,o,i)},t.edges=function(){for(var r=this.stars,m=[],o=0,i=r.length;o<i;++o)for(var u=r[o],f=0,l=u.length;f<l;f+=2)m.push([u[f],u[f+1]]);return m},t.cells=function(){for(var r=this.stars,m=[],o=0,i=r.length;o<i;++o)for(var u=r[o],f=0,l=u.length;f<l;f+=2){var h=u[f],d=u[f+1];o<Math.min(h,d)&&m.push([o,h,d])}return m}},{"binary-search-bounds":31}],47:[function(g,b,y){b.exports=function(e){for(var n=1,t=1;t<e.length;++t)for(var a=0;a<t;++a)if(e[t]<e[a])n=-n;else if(e[a]===e[t])return 0;return n}},{}],48:[function(g,b,y){var e=g("dup"),n=g("robust-linear-solve");function t(m,o){for(var i=0,u=m.length,f=0;f<u;++f)i+=m[f]*o[f];return i}function a(m){var o=m.length;if(o===0)return[];m[0].length;var i=e([m.length+1,m.length+1],1),u=e([m.length+1],1);i[o][o]=0;for(var f=0;f<o;++f){for(var l=0;l<=f;++l)i[l][f]=i[f][l]=2*t(m[f],m[l]);u[f]=t(m[f],m[f])}var h=n(i,u),d=0,s=h[o+1];for(f=0;f<s.length;++f)d+=s[f];var x=new Array(o);for(f=0;f<o;++f){s=h[f];var c=0;for(l=0;l<s.length;++l)c+=s[l];x[f]=c/d}return x}function r(m){if(m.length===0)return[];for(var o=m[0].length,i=e([o]),u=a(m),f=0;f<m.length;++f)for(var l=0;l<o;++l)i[l]+=m[f][l]*u[f];return i}r.barycenetric=a,b.exports=r},{dup:65,"robust-linear-solve":283}],49:[function(g,b,y){b.exports=function(n){for(var t=e(n),a=0,r=0;r<n.length;++r)for(var m=n[r],o=0;o<t.length;++o)a+=Math.pow(m[o]-t[o],2);return Math.sqrt(a/n.length)};var e=g("circumcenter")},{circumcenter:48}],50:[function(g,b,y){b.exports=function(T,_,w){var k;if(w){k=_;for(var L=new Array(_.length),A=0;A<_.length;++A){var I=_[A];L[A]=[I[0],I[1],w[A]]}_=L}for(var P=function(S,E,D){var R=h(S,[],l(S));return x(E,R,D),!!R}(T,_,!!w);c(T,_,!!w);)P=!0;if(w&&P)for(k.length=0,w.length=0,A=0;A<_.length;++A)I=_[A],k.push([I[0],I[1]]),w.push(I[2]);return P};var e=g("union-find"),n=g("box-intersect"),t=g("robust-segment-intersect"),a=g("big-rat"),r=g("big-rat/cmp"),m=g("big-rat/to-float"),o=g("rat-vec"),i=g("nextafter"),u=g("./lib/rat-seg-intersect");function f(T){var _=m(T);return[i(_,-1/0),i(_,1/0)]}function l(T){for(var _=new Array(T.length),w=0;w<T.length;++w){var k=T[w];_[w]=[i(k[0],-1/0),i(k[1],-1/0),i(k[0],1/0),i(k[1],1/0)]}return _}function h(T,_,w){for(var k=_.length,L=new e(k),A=[],I=0;I<_.length;++I){var P=_[I],S=f(P[0]),E=f(P[1]);A.push([i(S[0],-1/0),i(E[0],-1/0),i(S[1],1/0),i(E[1],1/0)])}n(A,function(X,$){L.link(X,$)});var D=!0,R=new Array(k);for(I=0;I<k;++I)(V=L.find(I))!==I&&(D=!1,T[V]=[Math.min(T[I][0],T[V][0]),Math.min(T[I][1],T[V][1])]);if(D)return null;var H=0;for(I=0;I<k;++I){var V;(V=L.find(I))===I?(R[I]=H,T[H++]=T[I]):R[I]=-1}for(T.length=H,I=0;I<k;++I)R[I]<0&&(R[I]=R[L.find(I)]);return R}function d(T,_){return T[0]-_[0]||T[1]-_[1]}function s(T,_){var w=T[0]-_[0]||T[1]-_[1];return w||(T[2]<_[2]?-1:T[2]>_[2]?1:0)}function x(T,_,w){if(T.length!==0){if(_)for(var k=0;k<T.length;++k){var L=_[(I=T[k])[0]],A=_[I[1]];I[0]=Math.min(L,A),I[1]=Math.max(L,A)}else for(k=0;k<T.length;++k){var I;L=(I=T[k])[0],A=I[1],I[0]=Math.min(L,A),I[1]=Math.max(L,A)}w?T.sort(s):T.sort(d);var P=1;for(k=1;k<T.length;++k){var S=T[k-1],E=T[k];(E[0]!==S[0]||E[1]!==S[1]||w&&E[2]!==S[2])&&(T[P++]=E)}T.length=P}}function c(T,_,w){var k=function(S,E){for(var D=new Array(E.length),R=0;R<E.length;++R){var H=E[R],V=S[H[0]],X=S[H[1]];D[R]=[i(Math.min(V[0],X[0]),-1/0),i(Math.min(V[1],X[1]),-1/0),i(Math.max(V[0],X[0]),1/0),i(Math.max(V[1],X[1]),1/0)]}return D}(T,_),L=function(S,E,D){var R=[];return n(D,function(H,V){var X=E[H],$=E[V];if(X[0]!==$[0]&&X[0]!==$[1]&&X[1]!==$[0]&&X[1]!==$[1]){var G=S[X[0]],W=S[X[1]],te=S[$[0]],N=S[$[1]];t(G,W,te,N)&&R.push([H,V])}}),R}(T,_,k),A=l(T),I=function(S,E,D,R){var H=[];return n(D,R,function(V,X){var $=E[V];if($[0]!==X&&$[1]!==X){var G=S[X],W=S[$[0]],te=S[$[1]];t(W,te,G,G)&&H.push([V,X])}}),H}(T,_,k,A),P=h(T,function(S,E,D,R,H){var V,X,$=S.map(function(me){return[a(me[0]),a(me[1])]});for(V=0;V<D.length;++V){var G=D[V];X=G[0];var W=G[1],te=E[X],N=E[W],B=u(o(S[te[0]]),o(S[te[1]]),o(S[N[0]]),o(S[N[1]]));if(B){var U=S.length;S.push([m(B[0]),m(B[1])]),$.push(B),R.push([X,U],[W,U])}}for(R.sort(function(me,Te){if(me[0]!==Te[0])return me[0]-Te[0];var _e=$[me[1]],be=$[Te[1]];return r(_e[0],be[0])||r(_e[1],be[1])}),V=R.length-1;V>=0;--V){var ee=E[X=(de=R[V])[0]],j=ee[0],Q=ee[1],K=S[j],re=S[Q];if((K[0]-re[0]||K[1]-re[1])<0){var ne=j;j=Q,Q=ne}ee[0]=j;var le,oe=ee[1]=de[1];for(H&&(le=ee[2]);V>0&&R[V-1][0]===X;){var de,se=(de=R[--V])[1];H?E.push([oe,se,le]):E.push([oe,se]),oe=se}H?E.push([oe,Q,le]):E.push([oe,Q])}return $}(T,_,L,I,w));return x(_,P,w),!!P||L.length>0||I.length>0}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(g,b,y){b.exports=function(u,f,l,h){var d=r(f,u),s=r(h,l),x=i(d,s);if(a(x)===0)return null;var c=r(u,l),T=i(s,c),_=n(T,x),w=o(d,_);return m(u,w)};var e=g("big-rat/mul"),n=g("big-rat/div"),t=g("big-rat/sub"),a=g("big-rat/sign"),r=g("rat-vec/sub"),m=g("rat-vec/add"),o=g("rat-vec/muls");function i(u,f){return t(e(u[0],f[1]),e(u[1],f[0]))}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(g,b,y){b.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(g,b,y){var e=g("./colorScale"),n=g("lerp");function t(m){return[m[0]/255,m[1]/255,m[2]/255,m[3]]}function a(m){for(var o,i="#",u=0;u<3;++u)i+=("00"+(o=(o=m[u]).toString(16))).substr(o.length);return i}function r(m){return"rgba("+m.join(",")+")"}b.exports=function(m){var o,i,u,f,l,h,d,s,x,c;if(m||(m={}),s=(m.nshades||72)-1,d=m.format||"hex",(h=m.colormap)||(h="jet"),typeof h=="string"){if(h=h.toLowerCase(),!e[h])throw Error(h+" not a supported colorscale");l=e[h]}else{if(!Array.isArray(h))throw Error("unsupported colormap option",h);l=h.slice()}if(l.length>s+1)throw new Error(h+" map requires nshades to be at least size "+l.length);x=Array.isArray(m.alpha)?m.alpha.length!==2?[1,1]:m.alpha.slice():typeof m.alpha=="number"?[m.alpha,m.alpha]:[1,1],o=l.map(function(L){return Math.round(L.index*s)}),x[0]=Math.min(Math.max(x[0],0),1),x[1]=Math.min(Math.max(x[1],0),1);var T=l.map(function(L,A){var I=l[A].index,P=l[A].rgb.slice();return P.length===4&&P[3]>=0&&P[3]<=1||(P[3]=x[0]+(x[1]-x[0])*I),P}),_=[];for(c=0;c<o.length-1;++c){f=o[c+1]-o[c],i=T[c],u=T[c+1];for(var w=0;w<f;w++){var k=w/f;_.push([Math.round(n(i[0],u[0],k)),Math.round(n(i[1],u[1],k)),Math.round(n(i[2],u[2],k)),n(i[3],u[3],k)])}}return _.push(l[l.length-1].rgb.concat(x[1])),d==="hex"?_=_.map(a):d==="rgbaString"?_=_.map(r):d==="float"&&(_=_.map(t)),_}},{"./colorScale":52,lerp:240}],54:[function(g,b,y){b.exports=function(o,i,u,f){var l=e(i,u,f);if(l===0){var h=n(e(o,i,u)),d=n(e(o,i,f));if(h===d){if(h===0){var s=m(o,i,u),x=m(o,i,f);return s===x?0:s?1:-1}return 0}return d===0?h>0||m(o,i,f)?-1:1:h===0?d>0||m(o,i,u)?1:-1:n(d-h)}var c=e(o,i,u);return c>0?l>0&&e(o,i,f)>0?1:-1:c<0?l>0||e(o,i,f)>0?1:-1:e(o,i,f)>0||m(o,i,u)?1:-1};var e=g("robust-orientation"),n=g("signum"),t=g("two-sum"),a=g("robust-product"),r=g("robust-sum");function m(o,i,u){var f=t(o[0],-i[0]),l=t(o[1],-i[1]),h=t(u[0],-i[0]),d=t(u[1],-i[1]),s=r(a(f,h),a(l,d));return s[s.length-1]>=0}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(g,b,y){b.exports=function(e){return e<0?-1:e>0?1:0}},{}],56:[function(g,b,y){b.exports=function(t,a){var r=t.length,m=t.length-a.length;if(m)return m;switch(r){case 0:return 0;case 1:return t[0]-a[0];case 2:return t[0]+t[1]-a[0]-a[1]||e(t[0],t[1])-e(a[0],a[1]);case 3:var o=t[0]+t[1],i=a[0]+a[1];if(m=o+t[2]-(i+a[2]))return m;var u=e(t[0],t[1]),f=e(a[0],a[1]);return e(u,t[2])-e(f,a[2])||e(u+t[2],o)-e(f+a[2],i);case 4:var l=t[0],h=t[1],d=t[2],s=t[3],x=a[0],c=a[1],T=a[2],_=a[3];return l+h+d+s-(x+c+T+_)||e(l,h,d,s)-e(x,c,T,_,x)||e(l+h,l+d,l+s,h+d,h+s,d+s)-e(x+c,x+T,x+_,c+T,c+_,T+_)||e(l+h+d,l+h+s,l+d+s,h+d+s)-e(x+c+T,x+c+_,x+T+_,c+T+_);default:for(var w=t.slice().sort(n),k=a.slice().sort(n),L=0;L<r;++L)if(m=w[L]-k[L])return m;return 0}};var e=Math.min;function n(t,a){return t-a}},{}],57:[function(g,b,y){var e=g("compare-cell"),n=g("cell-orientation");b.exports=function(t,a){return e(t,a)||n(t)-n(a)}},{"cell-orientation":47,"compare-cell":56}],58:[function(g,b,y){var e=g("./lib/ch1d"),n=g("./lib/ch2d"),t=g("./lib/chnd");b.exports=function(a){var r=a.length;if(r===0)return[];if(r===1)return[[0]];var m=a[0].length;return m===0?[]:m===1?e(a):m===2?n(a):t(a,m)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(g,b,y){b.exports=function(e){for(var n=0,t=0,a=1;a<e.length;++a)e[a][0]<e[n][0]&&(n=a),e[a][0]>e[t][0]&&(t=a);return n<t?[[n],[t]]:n>t?[[t],[n]]:[[n]]}},{}],60:[function(g,b,y){b.exports=function(n){var t=e(n),a=t.length;if(a<=2)return[];for(var r=new Array(a),m=t[a-1],o=0;o<a;++o){var i=t[o];r[o]=[m,i],m=i}return r};var e=g("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":246}],61:[function(g,b,y){b.exports=function(t,a){try{return e(t,!0)}catch{var r=n(t);if(r.length<=a)return[];var m=function(i,u){for(var f=i.length,l=new Array(f),h=0;h<u.length;++h)l[h]=i[u[h]];var d=u.length;for(h=0;h<f;++h)u.indexOf(h)<0&&(l[d++]=i[h]);return l}(t,r);return function(i,u){for(var f=i.length,l=u.length,h=0;h<f;++h)for(var d=i[h],s=0;s<d.length;++s){var x=d[s];if(x<l)d[s]=u[x];else{x-=l;for(var c=0;c<l;++c)x>=u[c]&&(x+=1);d[s]=x}}return i}(e(m,!0),r)}};var e=g("incremental-convex-hull"),n=g("affine-hull")},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(g,b,y){b.exports=function(e,n,t,a,r,m){var o=r-1,i=r*r,u=o*o,f=(1+2*r)*u,l=r*u,h=i*(3-2*r),d=i*o;if(e.length){m||(m=new Array(e.length));for(var s=e.length-1;s>=0;--s)m[s]=f*e[s]+l*n[s]+h*t[s]+d*a[s];return m}return f*e+l*n+h*t+d*a},b.exports.derivative=function(e,n,t,a,r,m){var o=6*r*r-6*r,i=3*r*r-4*r+1,u=-6*r*r+6*r,f=3*r*r-2*r;if(e.length){m||(m=new Array(e.length));for(var l=e.length-1;l>=0;--l)m[l]=o*e[l]+i*n[l]+u*t[l]+f*a[l];return m}return o*e+i*n+u*t[l]+f*a}},{}],63:[function(g,b,y){var e=g("incremental-convex-hull"),n=g("uniq");function t(r,m){this.point=r,this.index=m}function a(r,m){for(var o=r.point,i=m.point,u=o.length,f=0;f<u;++f){var l=i[f]-o[f];if(l)return l}return 0}b.exports=function(r,m){var o=r.length;if(o===0)return[];var i=r[0].length;if(i<1)return[];if(i===1)return function(I,P,S){if(I===1)return S?[[-1,0]]:[];var E=P.map(function(X,$){return[X[0],$]});E.sort(function(X,$){return X[0]-$[0]});for(var D=new Array(I-1),R=1;R<I;++R){var H=E[R-1],V=E[R];D[R-1]=[H[1],V[1]]}return S&&D.push([-1,D[0][1]],[D[I-1][1],-1]),D}(o,r,m);for(var u=new Array(o),f=1,l=0;l<o;++l){for(var h=r[l],d=new Array(i+1),s=0,x=0;x<i;++x){var c=h[x];d[x]=c,s+=c*c}d[i]=s,u[l]=new t(d,l),f=Math.max(s,f)}n(u,a),o=u.length;var T=new Array(o+i+1),_=new Array(o+i+1),w=(i+1)*(i+1)*f,k=new Array(i+1);for(l=0;l<=i;++l)k[l]=0;for(k[i]=w,T[0]=k.slice(),_[0]=-1,l=0;l<=i;++l)(d=k.slice())[l]=1,T[l+1]=d,_[l+1]=-1;for(l=0;l<o;++l){var L=u[l];T[l+i+1]=L.point,_[l+i+1]=L.index}var A=e(T,!1);if(A=m?A.filter(function(I){for(var P=0,S=0;S<=i;++S){var E=_[I[S]];if(E<0&&++P>=2)return!1;I[S]=E}return!0}):A.filter(function(I){for(var P=0;P<=i;++P){var S=_[I[P]];if(S<0)return!1;I[P]=S}return!0}),1&i)for(l=0;l<A.length;++l)d=(L=A[l])[0],L[0]=L[1],L[1]=d;return A}},{"incremental-convex-hull":233,uniq:310}],64:[function(g,b,y){(function(e){(function(){var n=!1;if(typeof Float64Array<"u"){var t=new Float64Array(1),a=new Uint32Array(t.buffer);t[0]=1,n=!0,a[1]===1072693248?(b.exports=function(m){return t[0]=m,[a[0],a[1]]},b.exports.pack=function(m,o){return a[0]=m,a[1]=o,t[0]},b.exports.lo=function(m){return t[0]=m,a[0]},b.exports.hi=function(m){return t[0]=m,a[1]}):a[0]===1072693248?(b.exports=function(m){return t[0]=m,[a[1],a[0]]},b.exports.pack=function(m,o){return a[1]=m,a[0]=o,t[0]},b.exports.lo=function(m){return t[0]=m,a[1]},b.exports.hi=function(m){return t[0]=m,a[0]}):n=!1}if(!n){var r=new e(8);b.exports=function(m){return r.writeDoubleLE(m,0,!0),[r.readUInt32LE(0,!0),r.readUInt32LE(4,!0)]},b.exports.pack=function(m,o){return r.writeUInt32LE(m,0,!0),r.writeUInt32LE(o,4,!0),r.readDoubleLE(0,!0)},b.exports.lo=function(m){return r.writeDoubleLE(m,0,!0),r.readUInt32LE(0,!0)},b.exports.hi=function(m){return r.writeDoubleLE(m,0,!0),r.readUInt32LE(4,!0)}}b.exports.sign=function(m){return b.exports.hi(m)>>>31},b.exports.exponent=function(m){return(b.exports.hi(m)<<1>>>21)-1023},b.exports.fraction=function(m){var o=b.exports.lo(m),i=b.exports.hi(m),u=1048575&i;return 2146435072&i&&(u+=1<<20),[o,u]},b.exports.denormalized=function(m){return!(2146435072&b.exports.hi(m))}}).call(this)}).call(this,g("buffer").Buffer)},{buffer:3}],65:[function(g,b,y){b.exports=function(e,n){switch(n===void 0&&(n=0),typeof e){case"number":if(e>0)return function(t,a){var r,m;for(r=new Array(t),m=0;m<t;++m)r[m]=a;return r}(0|e,n);break;case"object":if(typeof e.length=="number")return function t(a,r,m){var o=0|a[m];if(o<=0)return[];var i,u=new Array(o);if(m===a.length-1)for(i=0;i<o;++i)u[i]=r;else for(i=0;i<o;++i)u[i]=t(a,r,m+1);return u}(e,n,0)}return[]}},{}],66:[function(g,b,y){b.exports=function(n,t){var a=n.length;if(typeof t!="number"){t=0;for(var r=0;r<a;++r){var m=n[r];t=Math.max(t,m[0],m[1])}t=1+(0|t)}t|=0;var o=new Array(t);for(r=0;r<t;++r)o[r]=[];for(r=0;r<a;++r)m=n[r],o[m[0]].push(m[1]),o[m[1]].push(m[0]);for(var i=0;i<t;++i)e(o[i],function(u,f){return u-f});return o};var e=g("uniq")},{uniq:310}],67:[function(g,b,y){b.exports=function(e,n,t){var a=n||0,r=t||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[a*e[12]+e[8],a*e[13]+e[9],a*e[14]+e[10],a*e[15]+e[11]],[r*e[12]-e[8],r*e[13]-e[9],r*e[14]-e[10],r*e[15]-e[11]]]}},{}],68:[function(g,b,y){b.exports=function(o,i,u){switch(arguments.length){case 0:return new a([0],[0],0);case 1:return typeof o=="number"?new a(f=m(o),f,0):new a(o,m(o.length),0);case 2:if(typeof i=="number"){var f=m(o.length);return new a(o,f,+i)}u=0;case 3:if(o.length!==i.length)throw new Error("state and velocity lengths must match");return new a(o,i,u)}};var e=g("cubic-hermite"),n=g("binary-search-bounds");function t(o,i,u){return Math.min(i,Math.max(o,u))}function a(o,i,u){this.dimension=o.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var f=0;f<this.dimension;++f)this.bounds[0][f]=-1/0,this.bounds[1][f]=1/0;this._state=o.slice().reverse(),this._velocity=i.slice().reverse(),this._time=[u],this._scratch=[o.slice(),o.slice(),o.slice(),o.slice(),o.slice()]}var r=a.prototype;function m(o){for(var i=new Array(o),u=0;u<o;++u)i[u]=0;return i}r.flush=function(o){var i=n.gt(this._time,o)-1;i<=0||(this._time.splice(0,i),this._state.splice(0,i*this.dimension),this._velocity.splice(0,i*this.dimension))},r.curve=function(o){var i=this._time,u=i.length,f=n.le(i,o),l=this._scratch[0],h=this._state,d=this._velocity,s=this.dimension,x=this.bounds;if(f<0)for(var c=s-1,T=0;T<s;++T,--c)l[T]=h[c];else if(f>=u-1){c=h.length-1;var _=o-i[u-1];for(T=0;T<s;++T,--c)l[T]=h[c]+_*d[c]}else{c=s*(f+1)-1;var w=i[f],k=i[f+1]-w||1,L=this._scratch[1],A=this._scratch[2],I=this._scratch[3],P=this._scratch[4],S=!0;for(T=0;T<s;++T,--c)L[T]=h[c],I[T]=d[c]*k,A[T]=h[c+s],P[T]=d[c+s]*k,S=S&&L[T]===A[T]&&I[T]===P[T]&&I[T]===0;if(S)for(T=0;T<s;++T)l[T]=L[T];else e(L,I,A,P,(o-w)/k,l)}var E=x[0],D=x[1];for(T=0;T<s;++T)l[T]=t(E[T],D[T],l[T]);return l},r.dcurve=function(o){var i=this._time,u=i.length,f=n.le(i,o),l=this._scratch[0],h=this._state,d=this._velocity,s=this.dimension;if(f>=u-1)for(var x=h.length-1,c=(i[u-1],0);c<s;++c,--x)l[c]=d[x];else{x=s*(f+1)-1;var T=i[f],_=i[f+1]-T||1,w=this._scratch[1],k=this._scratch[2],L=this._scratch[3],A=this._scratch[4],I=!0;for(c=0;c<s;++c,--x)w[c]=h[x],L[c]=d[x]*_,k[c]=h[x+s],A[c]=d[x+s]*_,I=I&&w[c]===k[c]&&L[c]===A[c]&&L[c]===0;if(I)for(c=0;c<s;++c)l[c]=0;else for(e.derivative(w,L,k,A,(o-T)/_,l),c=0;c<s;++c)l[c]/=_}return l},r.lastT=function(){var o=this._time;return o[o.length-1]},r.stable=function(){for(var o=this._velocity,i=o.length,u=this.dimension-1;u>=0;--u)if(o[--i])return!1;return!0},r.jump=function(o){var i=this.lastT(),u=this.dimension;if(!(o<i||arguments.length!==u+1)){var f=this._state,l=this._velocity,h=f.length-this.dimension,d=this.bounds,s=d[0],x=d[1];this._time.push(i,o);for(var c=0;c<2;++c)for(var T=0;T<u;++T)f.push(f[h++]),l.push(0);for(this._time.push(o),T=u;T>0;--T)f.push(t(s[T-1],x[T-1],arguments[T])),l.push(0)}},r.push=function(o){var i=this.lastT(),u=this.dimension;if(!(o<i||arguments.length!==u+1)){var f=this._state,l=this._velocity,h=f.length-this.dimension,d=o-i,s=this.bounds,x=s[0],c=s[1],T=d>1e-6?1/d:0;this._time.push(o);for(var _=u;_>0;--_){var w=t(x[_-1],c[_-1],arguments[_]);f.push(w),l.push((w-f[h++])*T)}}},r.set=function(o){var i=this.dimension;if(!(o<this.lastT()||arguments.length!==i+1)){var u=this._state,f=this._velocity,l=this.bounds,h=l[0],d=l[1];this._time.push(o);for(var s=i;s>0;--s)u.push(t(h[s-1],d[s-1],arguments[s])),f.push(0)}},r.move=function(o){var i=this.lastT(),u=this.dimension;if(!(o<=i||arguments.length!==u+1)){var f=this._state,l=this._velocity,h=f.length-this.dimension,d=this.bounds,s=d[0],x=d[1],c=o-i,T=c>1e-6?1/c:0;this._time.push(o);for(var _=u;_>0;--_){var w=arguments[_];f.push(t(s[_-1],x[_-1],f[h++]+w)),l.push(w*T)}}},r.idle=function(o){var i=this.lastT();if(!(o<i)){var u=this.dimension,f=this._state,l=this._velocity,h=f.length-u,d=this.bounds,s=d[0],x=d[1],c=o-i;this._time.push(o);for(var T=u-1;T>=0;--T)f.push(t(s[T],x[T],f[h]+c*l[h])),l.push(0),h+=1}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(g,b,y){b.exports=function(s){return new r(s||d,null)};function e(s,x,c,T,_,w){this._color=s,this.key=x,this.value=c,this.left=T,this.right=_,this._count=w}function n(s){return new e(s._color,s.key,s.value,s.left,s.right,s._count)}function t(s,x){return new e(s,x.key,x.value,x.left,x.right,x._count)}function a(s){s._count=1+(s.left?s.left._count:0)+(s.right?s.right._count:0)}function r(s,x){this._compare=s,this.root=x}var m=r.prototype;function o(s,x){var c;return x.left&&(c=o(s,x.left))?c:(c=s(x.key,x.value))||(x.right?o(s,x.right):void 0)}function i(s,x,c,T){if(x(s,T.key)<=0){var _;if(T.left&&(_=i(s,x,c,T.left))||(_=c(T.key,T.value)))return _}if(T.right)return i(s,x,c,T.right)}function u(s,x,c,T,_){var w,k=c(s,_.key),L=c(x,_.key);if(k<=0&&(_.left&&(w=u(s,x,c,T,_.left))||L>0&&(w=T(_.key,_.value))))return w;if(L>0&&_.right)return u(s,x,c,T,_.right)}function f(s,x){this.tree=s,this._stack=x}Object.defineProperty(m,"keys",{get:function(){var s=[];return this.forEach(function(x,c){s.push(x)}),s}}),Object.defineProperty(m,"values",{get:function(){var s=[];return this.forEach(function(x,c){s.push(c)}),s}}),Object.defineProperty(m,"length",{get:function(){return this.root?this.root._count:0}}),m.insert=function(s,x){for(var c=this._compare,T=this.root,_=[],w=[];T;){var k=c(s,T.key);_.push(T),w.push(k),T=k<=0?T.left:T.right}_.push(new e(0,s,x,null,null,1));for(var L=_.length-2;L>=0;--L)T=_[L],w[L]<=0?_[L]=new e(T._color,T.key,T.value,_[L+1],T.right,T._count+1):_[L]=new e(T._color,T.key,T.value,T.left,_[L+1],T._count+1);for(L=_.length-1;L>1;--L){var A=_[L-1];if(T=_[L],A._color===1||T._color===1)break;var I=_[L-2];if(I.left===A)if(A.left===T){if(!(P=I.right)||P._color!==0){I._color=0,I.left=A.right,A._color=1,A.right=I,_[L-2]=A,_[L-1]=T,a(I),a(A),L>=3&&((S=_[L-3]).left===I?S.left=A:S.right=A);break}A._color=1,I.right=t(1,P),I._color=0,L-=1}else{if(!(P=I.right)||P._color!==0){A.right=T.left,I._color=0,I.left=T.right,T._color=1,T.left=A,T.right=I,_[L-2]=T,_[L-1]=A,a(I),a(A),a(T),L>=3&&((S=_[L-3]).left===I?S.left=T:S.right=T);break}A._color=1,I.right=t(1,P),I._color=0,L-=1}else if(A.right===T){if(!(P=I.left)||P._color!==0){I._color=0,I.right=A.left,A._color=1,A.left=I,_[L-2]=A,_[L-1]=T,a(I),a(A),L>=3&&((S=_[L-3]).right===I?S.right=A:S.left=A);break}A._color=1,I.left=t(1,P),I._color=0,L-=1}else{var P;if(!(P=I.left)||P._color!==0){var S;A.left=T.right,I._color=0,I.right=T.left,T._color=1,T.right=A,T.left=I,_[L-2]=T,_[L-1]=A,a(I),a(A),a(T),L>=3&&((S=_[L-3]).right===I?S.right=T:S.left=T);break}A._color=1,I.left=t(1,P),I._color=0,L-=1}}return _[0]._color=1,new r(c,_[0])},m.forEach=function(s,x,c){if(this.root)switch(arguments.length){case 1:return o(s,this.root);case 2:return i(x,this._compare,s,this.root);case 3:return this._compare(x,c)>=0?void 0:u(x,c,this._compare,s,this.root)}},Object.defineProperty(m,"begin",{get:function(){for(var s=[],x=this.root;x;)s.push(x),x=x.left;return new f(this,s)}}),Object.defineProperty(m,"end",{get:function(){for(var s=[],x=this.root;x;)s.push(x),x=x.right;return new f(this,s)}}),m.at=function(s){if(s<0)return new f(this,[]);for(var x=this.root,c=[];;){if(c.push(x),x.left){if(s<x.left._count){x=x.left;continue}s-=x.left._count}if(!s)return new f(this,c);if(s-=1,!x.right||s>=x.right._count)break;x=x.right}return new f(this,[])},m.ge=function(s){for(var x=this._compare,c=this.root,T=[],_=0;c;){var w=x(s,c.key);T.push(c),w<=0&&(_=T.length),c=w<=0?c.left:c.right}return T.length=_,new f(this,T)},m.gt=function(s){for(var x=this._compare,c=this.root,T=[],_=0;c;){var w=x(s,c.key);T.push(c),w<0&&(_=T.length),c=w<0?c.left:c.right}return T.length=_,new f(this,T)},m.lt=function(s){for(var x=this._compare,c=this.root,T=[],_=0;c;){var w=x(s,c.key);T.push(c),w>0&&(_=T.length),c=w<=0?c.left:c.right}return T.length=_,new f(this,T)},m.le=function(s){for(var x=this._compare,c=this.root,T=[],_=0;c;){var w=x(s,c.key);T.push(c),w>=0&&(_=T.length),c=w<0?c.left:c.right}return T.length=_,new f(this,T)},m.find=function(s){for(var x=this._compare,c=this.root,T=[];c;){var _=x(s,c.key);if(T.push(c),_===0)return new f(this,T);c=_<=0?c.left:c.right}return new f(this,[])},m.remove=function(s){var x=this.find(s);return x?x.remove():this},m.get=function(s){for(var x=this._compare,c=this.root;c;){var T=x(s,c.key);if(T===0)return c.value;c=T<=0?c.left:c.right}};var l=f.prototype;function h(s,x){s.key=x.key,s.value=x.value,s.left=x.left,s.right=x.right,s._color=x._color,s._count=x._count}function d(s,x){return s<x?-1:s>x?1:0}Object.defineProperty(l,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(l,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),l.clone=function(){return new f(this.tree,this._stack.slice())},l.remove=function(){var s=this._stack;if(s.length===0)return this.tree;var x=new Array(s.length),c=s[s.length-1];x[x.length-1]=new e(c._color,c.key,c.value,c.left,c.right,c._count);for(var T=s.length-2;T>=0;--T)(c=s[T]).left===s[T+1]?x[T]=new e(c._color,c.key,c.value,x[T+1],c.right,c._count):x[T]=new e(c._color,c.key,c.value,c.left,x[T+1],c._count);if((c=x[x.length-1]).left&&c.right){var _=x.length;for(c=c.left;c.right;)x.push(c),c=c.right;var w=x[_-1];for(x.push(new e(c._color,w.key,w.value,c.left,c.right,c._count)),x[_-1].key=c.key,x[_-1].value=c.value,T=x.length-2;T>=_;--T)c=x[T],x[T]=new e(c._color,c.key,c.value,c.left,x[T+1],c._count);x[_-1].left=x[_]}if((c=x[x.length-1])._color===0){var k=x[x.length-2];for(k.left===c?k.left=null:k.right===c&&(k.right=null),x.pop(),T=0;T<x.length;++T)x[T]._count--;return new r(this.tree._compare,x[0])}if(c.left||c.right){for(c.left?h(c,c.left):c.right&&h(c,c.right),c._color=1,T=0;T<x.length-1;++T)x[T]._count--;return new r(this.tree._compare,x[0])}if(x.length===1)return new r(this.tree._compare,null);for(T=0;T<x.length;++T)x[T]._count--;var L=x[x.length-2];return function(A){for(var I,P,S,E,D=A.length-1;D>=0;--D){if(I=A[D],D===0)return void(I._color=1);if((P=A[D-1]).left===I){if((S=P.right).right&&S.right._color===0)return E=(S=P.right=n(S)).right=n(S.right),P.right=S.left,S.left=P,S.right=E,S._color=P._color,I._color=1,P._color=1,E._color=1,a(P),a(S),D>1&&((R=A[D-2]).left===P?R.left=S:R.right=S),void(A[D-1]=S);if(S.left&&S.left._color===0)return E=(S=P.right=n(S)).left=n(S.left),P.right=E.left,S.left=E.right,E.left=P,E.right=S,E._color=P._color,P._color=1,S._color=1,I._color=1,a(P),a(S),a(E),D>1&&((R=A[D-2]).left===P?R.left=E:R.right=E),void(A[D-1]=E);if(S._color===1){if(P._color===0)return P._color=1,void(P.right=t(0,S));P.right=t(0,S);continue}S=n(S),P.right=S.left,S.left=P,S._color=P._color,P._color=0,a(P),a(S),D>1&&((R=A[D-2]).left===P?R.left=S:R.right=S),A[D-1]=S,A[D]=P,D+1<A.length?A[D+1]=I:A.push(I),D+=2}else{if((S=P.left).left&&S.left._color===0)return E=(S=P.left=n(S)).left=n(S.left),P.left=S.right,S.right=P,S.left=E,S._color=P._color,I._color=1,P._color=1,E._color=1,a(P),a(S),D>1&&((R=A[D-2]).right===P?R.right=S:R.left=S),void(A[D-1]=S);if(S.right&&S.right._color===0)return E=(S=P.left=n(S)).right=n(S.right),P.left=E.right,S.right=E.left,E.right=P,E.left=S,E._color=P._color,P._color=1,S._color=1,I._color=1,a(P),a(S),a(E),D>1&&((R=A[D-2]).right===P?R.right=E:R.left=E),void(A[D-1]=E);if(S._color===1){if(P._color===0)return P._color=1,void(P.left=t(0,S));P.left=t(0,S);continue}var R;S=n(S),P.left=S.right,S.right=P,S._color=P._color,P._color=0,a(P),a(S),D>1&&((R=A[D-2]).right===P?R.right=S:R.left=S),A[D-1]=S,A[D]=P,D+1<A.length?A[D+1]=I:A.push(I),D+=2}}}(x),L.left===c?L.left=null:L.right=null,new r(this.tree._compare,x[0])},Object.defineProperty(l,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(l,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(l,"index",{get:function(){var s=0,x=this._stack;if(x.length===0){var c=this.tree.root;return c?c._count:0}x[x.length-1].left&&(s=x[x.length-1].left._count);for(var T=x.length-2;T>=0;--T)x[T+1]===x[T].right&&(++s,x[T].left&&(s+=x[T].left._count));return s},enumerable:!0}),l.next=function(){var s=this._stack;if(s.length!==0){var x=s[s.length-1];if(x.right)for(x=x.right;x;)s.push(x),x=x.left;else for(s.pop();s.length>0&&s[s.length-1].right===x;)x=s[s.length-1],s.pop()}},Object.defineProperty(l,"hasNext",{get:function(){var s=this._stack;if(s.length===0)return!1;if(s[s.length-1].right)return!0;for(var x=s.length-1;x>0;--x)if(s[x-1].left===s[x])return!0;return!1}}),l.update=function(s){var x=this._stack;if(x.length===0)throw new Error("Can't update empty node!");var c=new Array(x.length),T=x[x.length-1];c[c.length-1]=new e(T._color,T.key,s,T.left,T.right,T._count);for(var _=x.length-2;_>=0;--_)(T=x[_]).left===x[_+1]?c[_]=new e(T._color,T.key,T.value,c[_+1],T.right,T._count):c[_]=new e(T._color,T.key,T.value,T.left,c[_+1],T._count);return new r(this.tree._compare,c[0])},l.prev=function(){var s=this._stack;if(s.length!==0){var x=s[s.length-1];if(x.left)for(x=x.left;x;)s.push(x),x=x.right;else for(s.pop();s.length>0&&s[s.length-1].left===x;)x=s[s.length-1],s.pop()}},Object.defineProperty(l,"hasPrev",{get:function(){var s=this._stack;if(s.length===0)return!1;if(s[s.length-1].left)return!0;for(var x=s.length-1;x>0;--x)if(s[x-1].right===s[x])return!0;return!1}})},{}],70:[function(g,b,y){b.exports=function(_,w){var k=new i(_);return k.update(w),k};var e=g("./lib/text.js"),n=g("./lib/lines.js"),t=g("./lib/background.js"),a=g("./lib/cube.js"),r=g("./lib/ticks.js"),m=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function o(_,w){return _[0]=w[0],_[1]=w[1],_[2]=w[2],_}function i(_){this.gl=_,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=t(_)}var u=i.prototype;function f(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}u.update=function(_){function w(X,$,G){if(G in _){var W,te=_[G],N=this[G];(X?Array.isArray(te)&&Array.isArray(te[0]):Array.isArray(te))?this[G]=W=[$(te[0]),$(te[1]),$(te[2])]:this[G]=W=[$(te),$(te),$(te)];for(var B=0;B<3;++B)if(W[B]!==N[B])return!0}return!1}_=_||{};var k,L=w.bind(this,!1,Number),A=w.bind(this,!1,Boolean),I=w.bind(this,!1,String),P=w.bind(this,!0,function(X){if(Array.isArray(X)){if(X.length===3)return[+X[0],+X[1],+X[2],1];if(X.length===4)return[+X[0],+X[1],+X[2],+X[3]]}return[0,0,0,1]}),S=!1,E=!1;if("bounds"in _)for(var D=_.bounds,R=0;R<2;++R)for(var H=0;H<3;++H)D[R][H]!==this.bounds[R][H]&&(E=!0),this.bounds[R][H]=D[R][H];if("ticks"in _)for(k=_.ticks,S=!0,this.autoTicks=!1,R=0;R<3;++R)this.tickSpacing[R]=0;else L("tickSpacing")&&(this.autoTicks=!0,E=!0);if(this._firstInit&&("ticks"in _||"tickSpacing"in _||(this.autoTicks=!0),E=!0,S=!0,this._firstInit=!1),E&&this.autoTicks&&(k=r.create(this.bounds,this.tickSpacing),S=!0),S){for(R=0;R<3;++R)k[R].sort(function(X,$){return X.x-$.x});r.equal(k,this.ticks)?S=!1:this.ticks=k}A("tickEnable"),I("tickFont")&&(S=!0),L("tickSize"),L("tickAngle"),L("tickPad"),P("tickColor");var V=I("labels");I("labelFont")&&(V=!0),A("labelEnable"),L("labelSize"),L("labelPad"),P("labelColor"),A("lineEnable"),A("lineMirror"),L("lineWidth"),P("lineColor"),A("lineTickEnable"),A("lineTickMirror"),L("lineTickLength"),L("lineTickWidth"),P("lineTickColor"),A("gridEnable"),L("gridWidth"),P("gridColor"),A("zeroEnable"),P("zeroLineColor"),L("zeroLineWidth"),A("backgroundEnable"),P("backgroundColor"),this._text?this._text&&(V||S)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=e(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&S&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=n(this.gl,this.bounds,this.ticks))};var l=[new f,new f,new f];function h(_,w,k,L,A){for(var I=_.primalOffset,P=_.primalMinor,S=_.mirrorOffset,E=_.mirrorMinor,D=L[w],R=0;R<3;++R)if(w!==R){var H=I,V=S,X=P,$=E;D&1<<R&&(H=S,V=I,X=E,$=P),H[R]=k[0][R],V[R]=k[1][R],A[R]>0?(X[R]=-1,$[R]=0):(X[R]=0,$[R]=1)}}var d=[0,0,0],s={model:m,view:m,projection:m,_ortho:!1};u.isOpaque=function(){return!0},u.isTransparent=function(){return!1},u.drawTransparent=function(_){};var x=[0,0,0],c=[0,0,0],T=[0,0,0];u.draw=function(_){_=_||s;for(var w=this.gl,k=_.model||m,L=_.view||m,A=_.projection||m,I=this.bounds,P=_._ortho||!1,S=a(k,L,A,I,P),E=S.cubeEdges,D=S.axis,R=L[12],H=L[13],V=L[14],X=L[15],$=(P?2:1)*this.pixelRatio*(A[3]*R+A[7]*H+A[11]*V+A[15]*X)/w.drawingBufferHeight,G=0;G<3;++G)this.lastCubeProps.cubeEdges[G]=E[G],this.lastCubeProps.axis[G]=D[G];var W=l;for(G=0;G<3;++G)h(l[G],G,this.bounds,E,D);w=this.gl;var te,N=d;for(G=0;G<3;++G)this.backgroundEnable[G]?N[G]=D[G]:N[G]=0;for(this._background.draw(k,L,A,I,N,this.backgroundColor),this._lines.bind(k,L,A,this),G=0;G<3;++G){var B=[0,0,0];D[G]>0?B[G]=I[1][G]:B[G]=I[0][G];for(var U=0;U<2;++U){var ee=(G+1+U)%3,j=(G+1+(1^U))%3;this.gridEnable[ee]&&this._lines.drawGrid(ee,j,this.bounds,B,this.gridColor[ee],this.gridWidth[ee]*this.pixelRatio)}for(U=0;U<2;++U)ee=(G+1+U)%3,j=(G+1+(1^U))%3,this.zeroEnable[j]&&Math.min(I[0][j],I[1][j])<=0&&Math.max(I[0][j],I[1][j])>=0&&this._lines.drawZero(ee,j,this.bounds,B,this.zeroLineColor[j],this.zeroLineWidth[j]*this.pixelRatio)}for(G=0;G<3;++G){this.lineEnable[G]&&this._lines.drawAxisLine(G,this.bounds,W[G].primalOffset,this.lineColor[G],this.lineWidth[G]*this.pixelRatio),this.lineMirror[G]&&this._lines.drawAxisLine(G,this.bounds,W[G].mirrorOffset,this.lineColor[G],this.lineWidth[G]*this.pixelRatio);var Q=o(x,W[G].primalMinor),K=o(c,W[G].mirrorMinor),re=this.lineTickLength;for(U=0;U<3;++U){var ne=$/k[5*U];Q[U]*=re[U]*ne,K[U]*=re[U]*ne}this.lineTickEnable[G]&&this._lines.drawAxisTicks(G,W[G].primalOffset,Q,this.lineTickColor[G],this.lineTickWidth[G]*this.pixelRatio),this.lineTickMirror[G]&&this._lines.drawAxisTicks(G,W[G].mirrorOffset,K,this.lineTickColor[G],this.lineTickWidth[G]*this.pixelRatio)}this._lines.unbind(),this._text.bind(k,L,A,this.pixelRatio);var le,oe;function de(Ce){(oe=[0,0,0])[Ce]=1}function se(Ce,fe,ve){var Me=(Ce+1)%3,ke=(Ce+2)%3,Le=fe[Me],ze=fe[ke],Re=ve[Me],Oe=ve[ke];Le>0&&Oe>0||Le>0&&Oe<0||Le<0&&Oe>0||Le<0&&Oe<0?de(Me):(ze>0&&Re>0||ze>0&&Re<0||ze<0&&Re>0||ze<0&&Re<0)&&de(ke)}for(G=0;G<3;++G){var me=W[G].primalMinor,Te=W[G].mirrorMinor,_e=o(T,W[G].primalOffset);for(U=0;U<3;++U)this.lineTickEnable[G]&&(_e[U]+=$*me[U]*Math.max(this.lineTickLength[U],0)/k[5*U]);var be=[0,0,0];if(be[G]=1,this.tickEnable[G]){for(this.tickAngle[G]===-3600?(this.tickAngle[G]=0,this.tickAlign[G]="auto"):this.tickAlign[G]=-1,le=1,(te=[this.tickAlign[G],.5,le])[0]==="auto"?te[0]=0:te[0]=parseInt(""+te[0]),oe=[0,0,0],se(G,me,Te),U=0;U<3;++U)_e[U]+=$*me[U]*this.tickPad[U]/k[5*U];this._text.drawTicks(G,this.tickSize[G],this.tickAngle[G],_e,this.tickColor[G],be,oe,te)}if(this.labelEnable[G]){for(le=0,oe=[0,0,0],this.labels[G].length>4&&(de(G),le=1),(te=[this.labelAlign[G],.5,le])[0]==="auto"?te[0]=0:te[0]=parseInt(""+te[0]),U=0;U<3;++U)_e[U]+=$*me[U]*this.labelPad[U]/k[5*U];_e[G]+=.5*(I[0][G]+I[1][G]),this._text.drawLabel(G,this.labelSize[G],this.labelAngle[G],_e,this.labelColor[G],[0,0,0],oe,te)}}this._text.unbind()},u.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(g,b,y){b.exports=function(m){for(var o=[],i=[],u=0,f=0;f<3;++f)for(var l=(f+1)%3,h=(f+2)%3,d=[0,0,0],s=[0,0,0],x=-1;x<=1;x+=2){i.push(u,u+2,u+1,u+1,u+2,u+3),d[f]=x,s[f]=x;for(var c=-1;c<=1;c+=2){d[l]=c;for(var T=-1;T<=1;T+=2)d[h]=T,o.push(d[0],d[1],d[2],s[0],s[1],s[2]),u+=1}var _=l;l=h,h=_}var w=e(m,new Float32Array(o)),k=e(m,new Uint16Array(i),m.ELEMENT_ARRAY_BUFFER),L=n(m,[{buffer:w,type:m.FLOAT,size:3,offset:0,stride:24},{buffer:w,type:m.FLOAT,size:3,offset:12,stride:24}],k),A=t(m);return A.attributes.position.location=0,A.attributes.normal.location=1,new a(m,w,L,A)};var e=g("gl-buffer"),n=g("gl-vao"),t=g("./shaders").bg;function a(m,o,i,u){this.gl=m,this.buffer=o,this.vao=i,this.shader=u}var r=a.prototype;r.draw=function(m,o,i,u,f,l){for(var h=!1,d=0;d<3;++d)h=h||f[d];if(h){var s=this.gl;s.enable(s.POLYGON_OFFSET_FILL),s.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:m,view:o,projection:i,bounds:u,enable:f,colors:l},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),s.disable(s.POLYGON_OFFSET_FILL)}},r.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(g,b,y){b.exports=function(c,T,_,w,k){n(r,T,c),n(r,_,r);for(var L=0,A=0;A<2;++A){i[2]=w[A][2];for(var I=0;I<2;++I){i[1]=w[I][1];for(var P=0;P<2;++P)i[0]=w[P][0],f(m[L],i,r),L+=1}}var S=-1;for(A=0;A<8;++A){for(var E=m[A][3],D=0;D<3;++D)o[A][D]=m[A][D]/E;k&&(o[A][2]*=-1),E<0&&(S<0||o[A][2]<o[S][2])&&(S=A)}if(S<0){S=0;for(var R=0;R<3;++R){for(var H=(R+2)%3,V=(R+1)%3,X=-1,$=-1,G=0;G<2;++G){var W=(N=G<<R)+(G<<H)+(1-G<<V),te=N+(1-G<<H)+(G<<V);a(o[N],o[W],o[te],u)<0||(G?X=1:$=1)}if(X<0||$<0)$>X&&(S|=1<<R);else{for(G=0;G<2;++G){W=(N=G<<R)+(G<<H)+(1-G<<V),te=N+(1-G<<H)+(G<<V);var N,B=h([m[N],m[W],m[te],m[N+(1<<H)+(1<<V)]]);G?X=B:$=B}$>X&&(S|=1<<R)}}}var U=7^S,ee=-1;for(A=0;A<8;++A)A!==S&&A!==U&&(ee<0||o[ee][1]>o[A][1])&&(ee=A);var j=-1;for(A=0;A<3;++A)(K=ee^1<<A)!==S&&K!==U&&(j<0&&(j=K),(V=o[K])[0]<o[j][0]&&(j=K));var Q=-1;for(A=0;A<3;++A){var K;(K=ee^1<<A)!==S&&K!==U&&K!==j&&(Q<0&&(Q=K),(V=o[K])[0]>o[Q][0]&&(Q=K))}var re=d;re[0]=re[1]=re[2]=0,re[e.log2(j^ee)]=ee&j,re[e.log2(ee^Q)]=ee&Q;var ne=7^Q;ne===S||ne===U?(ne=7^j,re[e.log2(Q^ne)]=ne&Q):re[e.log2(j^ne)]=ne&j;var le=s,oe=S;for(R=0;R<3;++R)le[R]=oe&1<<R?-1:1;return x};var e=g("bit-twiddle"),n=g("gl-mat4/multiply"),t=g("split-polygon"),a=g("robust-orientation"),r=new Array(16),m=new Array(8),o=new Array(8),i=new Array(3),u=[0,0,0];function f(c,T,_){for(var w=0;w<4;++w){c[w]=_[12+w];for(var k=0;k<3;++k)c[w]+=T[k]*_[4*k+w]}}(function(){for(var c=0;c<8;++c)m[c]=[1,1,1,1],o[c]=[1,1,1]})();var l=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function h(c){for(var T=0;T<l.length;++T)if((c=t.positive(c,l[T])).length<3)return 0;var _=c[0],w=_[0]/_[3],k=_[1]/_[3],L=0;for(T=1;T+1<c.length;++T){var A=c[T],I=c[T+1],P=A[0]/A[3]-w,S=A[1]/A[3]-k,E=I[0]/I[3]-w,D=I[1]/I[3]-k;L+=Math.abs(P*D-S*E)}return L}var d=[1,1,1],s=[0,0,0],x={cubeEdges:d,axis:s}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(g,b,y){b.exports=function(d,s,x){var c=[],T=[0,0,0],_=[0,0,0],w=[0,0,0],k=[0,0,0];c.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var L=0;L<3;++L){for(var A=c.length/3|0,I=0;I<x[L].length;++I){var P=+x[L][I].x;c.push(P,0,1,P,1,1,P,0,-1,P,0,-1,P,1,1,P,1,-1)}var S=c.length/3|0;T[L]=A,_[L]=S-A,A=c.length/3|0;for(var E=0;E<x[L].length;++E)P=+x[L][E].x,c.push(P,0,1,P,1,1,P,0,-1,P,0,-1,P,1,1,P,1,-1);S=c.length/3|0,w[L]=A,k[L]=S-A}var D=e(d,new Float32Array(c)),R=n(d,[{buffer:D,type:d.FLOAT,size:3,stride:0,offset:0}]),H=t(d);return H.attributes.position.location=0,new l(d,D,R,H,_,T,k,w)};var e=g("gl-buffer"),n=g("gl-vao"),t=g("./shaders").line,a=[0,0,0],r=[0,0,0],m=[0,0,0],o=[0,0,0],i=[1,1];function u(d){return d[0]=d[1]=d[2]=0,d}function f(d,s){return d[0]=s[0],d[1]=s[1],d[2]=s[2],d}function l(d,s,x,c,T,_,w,k){this.gl=d,this.vertBuffer=s,this.vao=x,this.shader=c,this.tickCount=T,this.tickOffset=_,this.gridCount=w,this.gridOffset=k}var h=l.prototype;h.bind=function(d,s,x){this.shader.bind(),this.shader.uniforms.model=d,this.shader.uniforms.view=s,this.shader.uniforms.projection=x,i[0]=this.gl.drawingBufferWidth,i[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=i,this.vao.bind()},h.unbind=function(){this.vao.unbind()},h.drawAxisLine=function(d,s,x,c,T){var _=u(r);this.shader.uniforms.majorAxis=r,_[d]=s[1][d]-s[0][d],this.shader.uniforms.minorAxis=_;var w,k=f(o,x);k[d]+=s[0][d],this.shader.uniforms.offset=k,this.shader.uniforms.lineWidth=T,this.shader.uniforms.color=c,(w=u(m))[(d+2)%3]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,6),(w=u(m))[(d+1)%3]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,6)},h.drawAxisTicks=function(d,s,x,c,T){if(this.tickCount[d]){var _=u(a);_[d]=1,this.shader.uniforms.majorAxis=_,this.shader.uniforms.offset=s,this.shader.uniforms.minorAxis=x,this.shader.uniforms.color=c,this.shader.uniforms.lineWidth=T;var w=u(m);w[d]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,this.tickCount[d],this.tickOffset[d])}},h.drawGrid=function(d,s,x,c,T,_){if(this.gridCount[d]){var w=u(r);w[s]=x[1][s]-x[0][s],this.shader.uniforms.minorAxis=w;var k=f(o,c);k[s]+=x[0][s],this.shader.uniforms.offset=k;var L=u(a);L[d]=1,this.shader.uniforms.majorAxis=L;var A=u(m);A[d]=1,this.shader.uniforms.screenAxis=A,this.shader.uniforms.lineWidth=_,this.shader.uniforms.color=T,this.vao.draw(this.gl.TRIANGLES,this.gridCount[d],this.gridOffset[d])}},h.drawZero=function(d,s,x,c,T,_){var w=u(r);this.shader.uniforms.majorAxis=w,w[d]=x[1][d]-x[0][d],this.shader.uniforms.minorAxis=w;var k=f(o,c);k[d]+=x[0][d],this.shader.uniforms.offset=k;var L=u(m);L[s]=1,this.shader.uniforms.screenAxis=L,this.shader.uniforms.lineWidth=_,this.shader.uniforms.color=T,this.vao.draw(this.gl.TRIANGLES,6)},h.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(g,b,y){var e=g("glslify"),n=g("gl-shader"),t=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),a=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);y.line=function(u){return n(u,t,a,null,[{name:"position",type:"vec3"}])};var r=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),m=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);y.text=function(u){return n(u,r,m,null,[{name:"position",type:"vec3"}])};var o=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),i=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);y.bg=function(u){return n(u,o,i,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(g,b,y){(function(e){(function(){b.exports=function(l,h,d,s,x,c){var T=n(l),_=t(l,[{buffer:T,size:3}]),w=r(l);w.attributes.position.location=0;var k=new i(l,w,T,_);return k.update(h,d,s,x,c),k};var n=g("gl-buffer"),t=g("gl-vao"),a=g("vectorize-text"),r=g("./shaders").text,m=window||e.global||{},o=m.__TEXT_CACHE||{};m.__TEXT_CACHE={};function i(l,h,d,s){this.gl=l,this.shader=h,this.buffer=d,this.vao=s,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var u=i.prototype,f=[0,0];u.bind=function(l,h,d,s){this.vao.bind(),this.shader.bind();var x=this.shader.uniforms;x.model=l,x.view=h,x.projection=d,x.pixelScale=s,f[0]=this.gl.drawingBufferWidth,f[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=f},u.unbind=function(){this.vao.unbind()},u.update=function(l,h,d,s,x){var c=[];function T(S,E,D,R,H,V){var X=o[D];X||(X=o[D]={});var $=X[E];$||($=X[E]=function(Q,K){try{return a(Q,K)}catch(re){return console.warn('error vectorizing text:"'+Q+'" error:',re),{cells:[],positions:[]}}}(E,{triangles:!0,font:D,textAlign:"center",textBaseline:"middle",lineSpacing:H,styletags:V}));for(var G=(R||12)/12,W=$.positions,te=$.cells,N=0,B=te.length;N<B;++N)for(var U=te[N],ee=2;ee>=0;--ee){var j=W[U[ee]];c.push(G*j[0],-G*j[1],S)}}for(var _=[0,0,0],w=[0,0,0],k=[0,0,0],L=[0,0,0],A={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},I=0;I<3;++I){k[I]=c.length/3|0,T(.5*(l[0][I]+l[1][I]),h[I],d[I],12,1.25,A),L[I]=(c.length/3|0)-k[I],_[I]=c.length/3|0;for(var P=0;P<s[I].length;++P)s[I][P].text&&T(s[I][P].x,s[I][P].text,s[I][P].font||x,s[I][P].fontSize||12,1.25,A);w[I]=(c.length/3|0)-_[I]}this.buffer.update(c),this.tickOffset=_,this.tickCount=w,this.labelOffset=k,this.labelCount=L},u.drawTicks=function(l,h,d,s,x,c,T,_){this.tickCount[l]&&(this.shader.uniforms.axis=c,this.shader.uniforms.color=x,this.shader.uniforms.angle=d,this.shader.uniforms.scale=h,this.shader.uniforms.offset=s,this.shader.uniforms.alignDir=T,this.shader.uniforms.alignOpt=_,this.vao.draw(this.gl.TRIANGLES,this.tickCount[l],this.tickOffset[l]))},u.drawLabel=function(l,h,d,s,x,c,T,_){this.labelCount[l]&&(this.shader.uniforms.axis=c,this.shader.uniforms.color=x,this.shader.uniforms.angle=d,this.shader.uniforms.scale=h,this.shader.uniforms.offset=s,this.shader.uniforms.alignDir=T,this.shader.uniforms.alignOpt=_,this.vao.draw(this.gl.TRIANGLES,this.labelCount[l],this.labelOffset[l]))},u.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,g("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(g,b,y){function e(n,t){var a=n+"",r=a.indexOf("."),m=0;r>=0&&(m=a.length-r-1);var o=Math.pow(10,m),i=Math.round(n*t*o),u=i+"";if(u.indexOf("e")>=0)return u;var f=i/o,l=i%o;i<0?(f=0|-Math.ceil(f),l=0|-l):(f=0|Math.floor(f),l|=0);var h=""+f;if(i<0&&(h="-"+h),m){for(var d=""+l;d.length<m;)d="0"+d;return h+"."+d}return h}y.create=function(n,t){for(var a=[],r=0;r<3;++r){for(var m=[],o=(n[0][r],n[1][r],0);o*t[r]<=n[1][r];++o)m.push({x:o*t[r],text:e(t[r],o)});for(o=-1;o*t[r]>=n[0][r];--o)m.push({x:o*t[r],text:e(t[r],o)});a.push(m)}return a},y.equal=function(n,t){for(var a=0;a<3;++a){if(n[a].length!==t[a].length)return!1;for(var r=0;r<n[a].length;++r){var m=n[a][r],o=t[a][r];if(m.x!==o.x||m.text!==o.text||m.font!==o.font||m.fontColor!==o.fontColor||m.fontSize!==o.fontSize||m.dx!==o.dx||m.dy!==o.dy)return!1}}return!0}},{}],77:[function(g,b,y){b.exports=function(x,c,T,_,w){var k=c.model||o,L=c.view||o,A=c.projection||o,I=c._ortho||!1,P=x.bounds,S=(w=w||t(k,L,A,P,I)).axis;a(i,L,k),a(i,A,i);for(var E=d,D=0;D<3;++D)E[D].lo=1/0,E[D].hi=-1/0,E[D].pixelsPerDataUnit=1/0;var R=e(r(i,i));r(i,i);for(var H=0;H<3;++H){var V=(H+1)%3,X=(H+2)%3,$=s;e:for(D=0;D<2;++D){var G=[];if(S[H]<0!=!!D){$[H]=P[D][H];for(var W=0;W<2;++W){$[V]=P[W^D][V];for(var te=0;te<2;++te)$[X]=P[te^W^D][X],G.push($.slice())}var N=I?5:4;for(W=N;W===N;++W){if(G.length===0)continue e;G=n.positive(G,R[W])}for(W=0;W<G.length;++W){X=G[W];var B=h(s,i,X,T,_);for(te=0;te<3;++te)E[te].lo=Math.min(E[te].lo,X[te]),E[te].hi=Math.max(E[te].hi,X[te]),te!==H&&(E[te].pixelsPerDataUnit=Math.min(E[te].pixelsPerDataUnit,Math.abs(B[te])))}}}}return E};var e=g("extract-frustum-planes"),n=g("split-polygon"),t=g("./lib/cube.js"),a=g("gl-mat4/multiply"),r=g("gl-mat4/transpose"),m=g("gl-vec4/transformMat4"),o=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),i=new Float32Array(16);function u(x,c,T){this.lo=x,this.hi=c,this.pixelsPerDataUnit=T}var f=[0,0,0,1],l=[0,0,0,1];function h(x,c,T,_,w){for(var k=0;k<3;++k){for(var L=f,A=l,I=0;I<3;++I)A[I]=L[I]=T[I];A[3]=L[3]=1,A[k]+=1,m(A,A,c),A[3]<0&&(x[k]=1/0),L[k]-=1,m(L,L,c),L[3]<0&&(x[k]=1/0);var P=(L[0]/L[3]-A[0]/A[3])*_,S=(L[1]/L[3]-A[1]/A[3])*w;x[k]=.25*Math.sqrt(P*P+S*S)}return x}var d=[new u(1/0,-1/0,1/0),new u(1/0,-1/0,1/0),new u(1/0,-1/0,1/0)],s=[0,0,0]},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(g,b,y){var e=g("typedarray-pool"),n=g("ndarray-ops"),t=g("ndarray"),a=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function r(u,f,l,h,d){this.gl=u,this.type=f,this.handle=l,this.length=h,this.usage=d}var m=r.prototype;function o(u,f,l,h,d,s){var x=d.length*d.BYTES_PER_ELEMENT;if(s<0)return u.bufferData(f,d,h),x;if(x+s>l)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return u.bufferSubData(f,s,d),l}function i(u,f){for(var l=e.malloc(u.length,f),h=u.length,d=0;d<h;++d)l[d]=u[d];return l}m.bind=function(){this.gl.bindBuffer(this.type,this.handle)},m.unbind=function(){this.gl.bindBuffer(this.type,null)},m.dispose=function(){this.gl.deleteBuffer(this.handle)},m.update=function(u,f){if(typeof f!="number"&&(f=-1),this.bind(),typeof u=="object"&&u.shape!==void 0){var l=u.dtype;if(a.indexOf(l)<0&&(l="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(l=gl.getExtension("OES_element_index_uint")&&l!=="uint16"?"uint32":"uint16"),l===u.dtype&&function(x,c){for(var T=1,_=c.length-1;_>=0;--_){if(c[_]!==T)return!1;T*=x[_]}return!0}(u.shape,u.stride))u.offset===0&&u.data.length===u.shape[0]?this.length=o(this.gl,this.type,this.length,this.usage,u.data,f):this.length=o(this.gl,this.type,this.length,this.usage,u.data.subarray(u.offset,u.shape[0]),f);else{var h=e.malloc(u.size,l),d=t(h,u.shape);n.assign(d,u),this.length=o(this.gl,this.type,this.length,this.usage,f<0?h:h.subarray(0,u.size),f),e.free(h)}}else if(Array.isArray(u)){var s;s=this.type===this.gl.ELEMENT_ARRAY_BUFFER?i(u,"uint16"):i(u,"float32"),this.length=o(this.gl,this.type,this.length,this.usage,f<0?s:s.subarray(0,u.length),f),e.free(s)}else if(typeof u=="object"&&typeof u.length=="number")this.length=o(this.gl,this.type,this.length,this.usage,u,f);else{if(typeof u!="number"&&u!==void 0)throw new Error("gl-buffer: Invalid data type");if(f>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(u|=0)<=0&&(u=1),this.gl.bufferData(this.type,0|u,this.usage),this.length=u}},b.exports=function(u,f,l,h){if(l=l||u.ARRAY_BUFFER,h=h||u.DYNAMIC_DRAW,l!==u.ARRAY_BUFFER&&l!==u.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(h!==u.DYNAMIC_DRAW&&h!==u.STATIC_DRAW&&h!==u.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var d=u.createBuffer(),s=new r(u,l,d,0,h);return s.update(f),s}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(g,b,y){var e=g("gl-vec3");b.exports=function(t,a){var r=t.positions,m=t.vectors,o={positions:[],vertexIntensity:[],vertexIntensityBounds:t.vertexIntensityBounds,vectors:[],cells:[],coneOffset:t.coneOffset,colormap:t.colormap};if(t.positions.length===0)return a&&(a[0]=[0,0,0],a[1]=[0,0,0]),o;for(var i=0,u=1/0,f=-1/0,l=1/0,h=-1/0,d=1/0,s=-1/0,x=null,c=null,T=[],_=1/0,w=!1,k=0;k<r.length;k++){var L=r[k];u=Math.min(L[0],u),f=Math.max(L[0],f),l=Math.min(L[1],l),h=Math.max(L[1],h),d=Math.min(L[2],d),s=Math.max(L[2],s);var A=m[k];if(e.length(A)>i&&(i=e.length(A)),k){var I=2*e.distance(x,L)/(e.length(c)+e.length(A));I?(_=Math.min(_,I),w=!1):w=!0}w||(x=L,c=A),T.push(A)}var P=[u,l,d],S=[f,h,s];a&&(a[0]=P,a[1]=S),i===0&&(i=1);var E=1/i;isFinite(_)||(_=1),o.vectorScale=_;var D=t.coneSize||.5;t.absoluteConeSize&&(D=t.absoluteConeSize*E),o.coneScale=D,k=0;for(var R=0;k<r.length;k++)for(var H=(L=r[k])[0],V=L[1],X=L[2],$=T[k],G=e.length($)*E,W=0;W<8;W++){o.positions.push([H,V,X,R++]),o.positions.push([H,V,X,R++]),o.positions.push([H,V,X,R++]),o.positions.push([H,V,X,R++]),o.positions.push([H,V,X,R++]),o.positions.push([H,V,X,R++]),o.vectors.push($),o.vectors.push($),o.vectors.push($),o.vectors.push($),o.vectors.push($),o.vectors.push($),o.vertexIntensity.push(G,G,G),o.vertexIntensity.push(G,G,G);var te=o.positions.length;o.cells.push([te-6,te-5,te-4],[te-3,te-2,te-1])}return o};var n=g("./lib/shaders");b.exports.createMesh=g("./create_mesh"),b.exports.createConeMesh=function(t,a){return b.exports.createMesh(t,a,{shaders:n,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(g,b,y){var e=g("gl-shader"),n=g("gl-buffer"),t=g("gl-vao"),a=g("gl-texture2d"),r=g("gl-mat4/multiply"),m=g("gl-mat4/invert"),o=g("ndarray"),i=g("colormap"),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function f(s,x,c,T,_,w,k,L,A,I,P){this.gl=s,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=x,this.dirty=!0,this.triShader=c,this.pickShader=T,this.trianglePositions=_,this.triangleVectors=w,this.triangleColors=L,this.triangleUVs=A,this.triangleIds=k,this.triangleVAO=I,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=P,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=u,this._view=u,this._projection=u,this._resolution=[1,1]}var l=f.prototype;function h(s,x){var c=e(s,x.meshShader.vertex,x.meshShader.fragment,null,x.meshShader.attributes);return c.attributes.position.location=0,c.attributes.color.location=2,c.attributes.uv.location=3,c.attributes.vector.location=4,c}function d(s,x){var c=e(s,x.pickShader.vertex,x.pickShader.fragment,null,x.pickShader.attributes);return c.attributes.position.location=0,c.attributes.id.location=1,c.attributes.vector.location=4,c}l.isOpaque=function(){return this.opacity>=1},l.isTransparent=function(){return this.opacity<1},l.pickSlots=1,l.setPickBase=function(s){this.pickId=s},l.update=function(s){s=s||{};var x=this.gl;this.dirty=!0,"lightPosition"in s&&(this.lightPosition=s.lightPosition),"opacity"in s&&(this.opacity=s.opacity),"ambient"in s&&(this.ambientLight=s.ambient),"diffuse"in s&&(this.diffuseLight=s.diffuse),"specular"in s&&(this.specularLight=s.specular),"roughness"in s&&(this.roughness=s.roughness),"fresnel"in s&&(this.fresnel=s.fresnel),s.tubeScale!==void 0&&(this.tubeScale=s.tubeScale),s.vectorScale!==void 0&&(this.vectorScale=s.vectorScale),s.coneScale!==void 0&&(this.coneScale=s.coneScale),s.coneOffset!==void 0&&(this.coneOffset=s.coneOffset),s.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=x.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=x.LINEAR,this.texture.setPixels(function(ee){for(var j=i({colormap:ee,nshades:256,format:"rgba"}),Q=new Uint8Array(1024),K=0;K<256;++K){for(var re=j[K],ne=0;ne<3;++ne)Q[4*K+ne]=re[ne];Q[4*K+3]=255*re[3]}return o(Q,[256,256,4],[4,0,1])}(s.colormap)),this.texture.generateMipmap());var c=s.cells,T=s.positions,_=s.vectors;if(T&&c&&_){var w=[],k=[],L=[],A=[],I=[];this.cells=c,this.positions=T,this.vectors=_;var P=s.meshColor||[1,1,1,1],S=s.vertexIntensity,E=1/0,D=-1/0;if(S)if(s.vertexIntensityBounds)E=+s.vertexIntensityBounds[0],D=+s.vertexIntensityBounds[1];else for(var R=0;R<S.length;++R){var H=S[R];E=Math.min(E,H),D=Math.max(D,H)}else for(R=0;R<T.length;++R)H=T[R][2],E=Math.min(E,H),D=Math.max(D,H);for(this.intensity=S||function(ee){for(var j=ee.length,Q=new Array(j),K=0;K<j;++K)Q[K]=ee[K][2];return Q}(T),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],R=0;R<T.length;++R)for(var V=T[R],X=0;X<3;++X)!isNaN(V[X])&&isFinite(V[X])&&(this.bounds[0][X]=Math.min(this.bounds[0][X],V[X]),this.bounds[1][X]=Math.max(this.bounds[1][X],V[X]));var $=0;e:for(R=0;R<c.length;++R){var G=c[R];switch(G.length){case 3:for(X=0;X<3;++X){V=T[te=G[X]];for(var W=0;W<3;++W)if(isNaN(V[W])||!isFinite(V[W]))continue e}for(X=0;X<3;++X){var te;V=T[te=G[2-X]],w.push(V[0],V[1],V[2],V[3]);var N=_[te];k.push(N[0],N[1],N[2],N[3]||0);var B,U=P;U.length===3?L.push(U[0],U[1],U[2],1):L.push(U[0],U[1],U[2],U[3]),B=S?[(S[te]-E)/(D-E),0]:[(V[2]-E)/(D-E),0],A.push(B[0],B[1]),I.push(R)}$+=1}}this.triangleCount=$,this.trianglePositions.update(w),this.triangleVectors.update(k),this.triangleColors.update(L),this.triangleUVs.update(A),this.triangleIds.update(new Uint32Array(I))}},l.drawTransparent=l.draw=function(s){s=s||{};for(var x=this.gl,c=s.model||u,T=s.view||u,_=s.projection||u,w=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],k=0;k<3;++k)w[0][k]=Math.max(w[0][k],this.clipBounds[0][k]),w[1][k]=Math.min(w[1][k],this.clipBounds[1][k]);var L={model:c,view:T,projection:_,inverseModel:u.slice(),clipBounds:w,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};L.inverseModel=m(L.inverseModel,L.model),x.disable(x.CULL_FACE),this.texture.bind(0);var A=new Array(16);for(r(A,L.view,L.model),r(A,L.projection,A),m(A,A),k=0;k<3;++k)L.eyePosition[k]=A[12+k]/A[15];var I=A[15];for(k=0;k<3;++k)I+=this.lightPosition[k]*A[4*k+3];for(k=0;k<3;++k){for(var P=A[12+k],S=0;S<3;++S)P+=A[4*S+k]*this.lightPosition[S];L.lightPosition[k]=P/I}if(this.triangleCount>0){var E=this.triShader;E.bind(),E.uniforms=L,this.triangleVAO.bind(),x.drawArrays(x.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},l.drawPick=function(s){s=s||{};for(var x=this.gl,c=s.model||u,T=s.view||u,_=s.projection||u,w=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],k=0;k<3;++k)w[0][k]=Math.max(w[0][k],this.clipBounds[0][k]),w[1][k]=Math.min(w[1][k],this.clipBounds[1][k]);this._model=[].slice.call(c),this._view=[].slice.call(T),this._projection=[].slice.call(_),this._resolution=[x.drawingBufferWidth,x.drawingBufferHeight];var L={model:c,view:T,projection:_,clipBounds:w,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},A=this.pickShader;A.bind(),A.uniforms=L,this.triangleCount>0&&(this.triangleVAO.bind(),x.drawArrays(x.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},l.pick=function(s){if(!s||s.id!==this.pickId)return null;var x=s.value[0]+256*s.value[1]+65536*s.value[2],c=this.cells[x],T=this.positions[c[1]].slice(0,3),_={position:T,dataCoordinate:T,index:Math.floor(c[1]/48)};return this.traceType==="cone"?_.index=Math.floor(c[1]/48):this.traceType==="streamtube"&&(_.intensity=this.intensity[c[1]],_.velocity=this.vectors[c[1]].slice(0,3),_.divergence=this.vectors[c[1]][3],_.index=x),_},l.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},b.exports=function(s,x,c){var T=c.shaders;arguments.length===1&&(s=(x=s).gl);var _=h(s,T),w=d(s,T),k=a(s,o(new Uint8Array([255,255,255,255]),[1,1,4]));k.generateMipmap(),k.minFilter=s.LINEAR_MIPMAP_LINEAR,k.magFilter=s.LINEAR;var L=n(s),A=n(s),I=n(s),P=n(s),S=n(s),E=t(s,[{buffer:L,type:s.FLOAT,size:4},{buffer:S,type:s.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:I,type:s.FLOAT,size:4},{buffer:P,type:s.FLOAT,size:2},{buffer:A,type:s.FLOAT,size:4}]),D=new f(s,k,_,w,L,A,S,I,P,E,c.traceType||"cone");return D.update(x),D}},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(g,b,y){var e=g("glslify"),n=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),t=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);y.meshShader={vertex:n,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},y.pickShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(g,b,y){b.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(g,b,y){var e=g("./1.0/numbers");b.exports=function(n){return e[n]}},{"./1.0/numbers":82}],84:[function(g,b,y){b.exports=function(f){var l=f.gl,h=e(l),d=n(l,[{buffer:h,type:l.FLOAT,size:3,offset:0,stride:40},{buffer:h,type:l.FLOAT,size:4,offset:12,stride:40},{buffer:h,type:l.FLOAT,size:3,offset:28,stride:40}]),s=t(l);s.attributes.position.location=0,s.attributes.color.location=1,s.attributes.offset.location=2;var x=new r(l,h,d,s);return x.update(f),x};var e=g("gl-buffer"),n=g("gl-vao"),t=g("./shaders/index"),a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(f,l,h,d){this.gl=f,this.shader=d,this.buffer=l,this.vao=h,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var m=r.prototype;function o(f,l){for(var h=0;h<3;++h)f[0][h]=Math.min(f[0][h],l[h]),f[1][h]=Math.max(f[1][h],l[h])}m.isOpaque=function(){return!this.hasAlpha},m.isTransparent=function(){return this.hasAlpha},m.drawTransparent=m.draw=function(f){var l=this.gl,h=this.shader.uniforms;this.shader.bind();var d=h.view=f.view||a,s=h.projection=f.projection||a;h.model=f.model||a,h.clipBounds=this.clipBounds,h.opacity=this.opacity;var x=d[12],c=d[13],T=d[14],_=d[15],w=(f._ortho?2:1)*this.pixelRatio*(s[3]*x+s[7]*c+s[11]*T+s[15]*_)/l.drawingBufferHeight;this.vao.bind();for(var k=0;k<3;++k)l.lineWidth(this.lineWidth[k]*this.pixelRatio),h.capSize=this.capSize[k]*w,this.lineCount[k]&&l.drawArrays(l.LINES,this.lineOffset[k],this.lineCount[k]);this.vao.unbind()};var i=function(){for(var f=new Array(3),l=0;l<3;++l){for(var h=[],d=1;d<=2;++d)for(var s=-1;s<=1;s+=2){var x=[0,0,0];x[(d+l)%3]=s,h.push(x)}f[l]=h}return f}();function u(f,l,h,d){for(var s=i[d],x=0;x<s.length;++x){var c=s[x];f.push(l[0],l[1],l[2],h[0],h[1],h[2],h[3],c[0],c[1],c[2])}return s.length}m.update=function(f){"lineWidth"in(f=f||{})&&(this.lineWidth=f.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in f&&(this.capSize=f.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in f&&(this.opacity=+f.opacity,this.opacity<1&&(this.hasAlpha=!0));var l=f.color||[[0,0,0],[0,0,0],[0,0,0]],h=f.position,d=f.error;if(Array.isArray(l[0])||(l=[l,l,l]),h&&d){var s=[],x=h.length,c=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var T=0;T<3;++T){this.lineOffset[T]=c;e:for(var _=0;_<x;++_){for(var w=h[_],k=0;k<3;++k)if(isNaN(w[k])||!isFinite(w[k]))continue e;var L=d[_],A=l[T];if(Array.isArray(A[0])&&(A=l[_]),A.length===3?A=[A[0],A[1],A[2],1]:A.length===4&&(A=[A[0],A[1],A[2],A[3]],!this.hasAlpha&&A[3]<1&&(this.hasAlpha=!0)),!isNaN(L[0][T])&&!isNaN(L[1][T])){var I;L[0][T]<0&&((I=w.slice())[T]+=L[0][T],s.push(w[0],w[1],w[2],A[0],A[1],A[2],A[3],0,0,0,I[0],I[1],I[2],A[0],A[1],A[2],A[3],0,0,0),o(this.bounds,I),c+=2+u(s,I,A,T)),L[1][T]>0&&((I=w.slice())[T]+=L[1][T],s.push(w[0],w[1],w[2],A[0],A[1],A[2],A[3],0,0,0,I[0],I[1],I[2],A[0],A[1],A[2],A[3],0,0,0),o(this.bounds,I),c+=2+u(s,I,A,T))}}this.lineCount[T]=c-this.lineOffset[T]}this.buffer.update(s)}},m.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(g,b,y){var e=g("glslify"),n=g("gl-shader"),t=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),a=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);b.exports=function(r){return n(r,t,a,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(g,b,y){var e=g("gl-texture2d");b.exports=function(x,c,T,_){n||(n=x.FRAMEBUFFER_UNSUPPORTED,t=x.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,a=x.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,r=x.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var w=x.getExtension("WEBGL_draw_buffers");if(!m&&w&&function(E,D){var R=E.getParameter(D.MAX_COLOR_ATTACHMENTS_WEBGL);m=new Array(R+1);for(var H=0;H<=R;++H){for(var V=new Array(R),X=0;X<H;++X)V[X]=E.COLOR_ATTACHMENT0+X;for(X=H;X<R;++X)V[X]=E.NONE;m[H]=V}}(x,w),Array.isArray(c)&&(_=T,T=0|c[1],c=0|c[0]),typeof c!="number")throw new Error("gl-fbo: Missing shape parameter");var k=x.getParameter(x.MAX_RENDERBUFFER_SIZE);if(c<0||c>k||T<0||T>k)throw new Error("gl-fbo: Parameters are too large for FBO");var L=1;if("color"in(_=_||{})){if((L=Math.max(0|_.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(L>1){if(!w)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(L>x.getParameter(w.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+L+" draw buffers")}}var A=x.UNSIGNED_BYTE,I=x.getExtension("OES_texture_float");if(_.float&&L>0){if(!I)throw new Error("gl-fbo: Context does not support floating point textures");A=x.FLOAT}else _.preferFloat&&L>0&&I&&(A=x.FLOAT);var P=!0;"depth"in _&&(P=!!_.depth);var S=!1;return"stencil"in _&&(S=!!_.stencil),new h(x,c,T,A,L,P,S,w)};var n,t,a,r,m=null;function o(x){return[x.getParameter(x.FRAMEBUFFER_BINDING),x.getParameter(x.RENDERBUFFER_BINDING),x.getParameter(x.TEXTURE_BINDING_2D)]}function i(x,c){x.bindFramebuffer(x.FRAMEBUFFER,c[0]),x.bindRenderbuffer(x.RENDERBUFFER,c[1]),x.bindTexture(x.TEXTURE_2D,c[2])}function u(x){switch(x){case n:throw new Error("gl-fbo: Framebuffer unsupported");case t:throw new Error("gl-fbo: Framebuffer incomplete attachment");case a:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case r:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function f(x,c,T,_,w,k){if(!_)return null;var L=e(x,c,T,w,_);return L.magFilter=x.NEAREST,L.minFilter=x.NEAREST,L.mipSamples=1,L.bind(),x.framebufferTexture2D(x.FRAMEBUFFER,k,x.TEXTURE_2D,L.handle,0),L}function l(x,c,T,_,w){var k=x.createRenderbuffer();return x.bindRenderbuffer(x.RENDERBUFFER,k),x.renderbufferStorage(x.RENDERBUFFER,_,c,T),x.framebufferRenderbuffer(x.FRAMEBUFFER,w,x.RENDERBUFFER,k),k}function h(x,c,T,_,w,k,L,A){this.gl=x,this._shape=[0|c,0|T],this._destroyed=!1,this._ext=A,this.color=new Array(w);for(var I=0;I<w;++I)this.color[I]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=_,this._useDepth=k,this._useStencil=L;var P=this,S=[0|c,0|T];Object.defineProperties(S,{0:{get:function(){return P._shape[0]},set:function(E){return P.width=E}},1:{get:function(){return P._shape[1]},set:function(E){return P.height=E}}}),this._shapeVector=S,function(E){var D=o(E.gl),R=E.gl,H=E.handle=R.createFramebuffer(),V=E._shape[0],X=E._shape[1],$=E.color.length,G=E._ext,W=E._useStencil,te=E._useDepth,N=E._colorType;R.bindFramebuffer(R.FRAMEBUFFER,H);for(var B=0;B<$;++B)E.color[B]=f(R,V,X,N,R.RGBA,R.COLOR_ATTACHMENT0+B);$===0?(E._color_rb=l(R,V,X,R.RGBA4,R.COLOR_ATTACHMENT0),G&&G.drawBuffersWEBGL(m[0])):$>1&&G.drawBuffersWEBGL(m[$]);var U=R.getExtension("WEBGL_depth_texture");U?W?E.depth=f(R,V,X,U.UNSIGNED_INT_24_8_WEBGL,R.DEPTH_STENCIL,R.DEPTH_STENCIL_ATTACHMENT):te&&(E.depth=f(R,V,X,R.UNSIGNED_SHORT,R.DEPTH_COMPONENT,R.DEPTH_ATTACHMENT)):te&&W?E._depth_rb=l(R,V,X,R.DEPTH_STENCIL,R.DEPTH_STENCIL_ATTACHMENT):te?E._depth_rb=l(R,V,X,R.DEPTH_COMPONENT16,R.DEPTH_ATTACHMENT):W&&(E._depth_rb=l(R,V,X,R.STENCIL_INDEX,R.STENCIL_ATTACHMENT));var ee=R.checkFramebufferStatus(R.FRAMEBUFFER);if(ee!==R.FRAMEBUFFER_COMPLETE){for(E._destroyed=!0,R.bindFramebuffer(R.FRAMEBUFFER,null),R.deleteFramebuffer(E.handle),E.handle=null,E.depth&&(E.depth.dispose(),E.depth=null),E._depth_rb&&(R.deleteRenderbuffer(E._depth_rb),E._depth_rb=null),B=0;B<E.color.length;++B)E.color[B].dispose(),E.color[B]=null;E._color_rb&&(R.deleteRenderbuffer(E._color_rb),E._color_rb=null),i(R,D),u(ee)}i(R,D)}(this)}var d=h.prototype;function s(x,c,T){if(x._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(x._shape[0]!==c||x._shape[1]!==T){var _=x.gl,w=_.getParameter(_.MAX_RENDERBUFFER_SIZE);if(c<0||c>w||T<0||T>w)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");x._shape[0]=c,x._shape[1]=T;for(var k=o(_),L=0;L<x.color.length;++L)x.color[L].shape=x._shape;x._color_rb&&(_.bindRenderbuffer(_.RENDERBUFFER,x._color_rb),_.renderbufferStorage(_.RENDERBUFFER,_.RGBA4,x._shape[0],x._shape[1])),x.depth&&(x.depth.shape=x._shape),x._depth_rb&&(_.bindRenderbuffer(_.RENDERBUFFER,x._depth_rb),x._useDepth&&x._useStencil?_.renderbufferStorage(_.RENDERBUFFER,_.DEPTH_STENCIL,x._shape[0],x._shape[1]):x._useDepth?_.renderbufferStorage(_.RENDERBUFFER,_.DEPTH_COMPONENT16,x._shape[0],x._shape[1]):x._useStencil&&_.renderbufferStorage(_.RENDERBUFFER,_.STENCIL_INDEX,x._shape[0],x._shape[1])),_.bindFramebuffer(_.FRAMEBUFFER,x.handle);var A=_.checkFramebufferStatus(_.FRAMEBUFFER);A!==_.FRAMEBUFFER_COMPLETE&&(x.dispose(),i(_,k),u(A)),i(_,k)}}Object.defineProperties(d,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(x){if(Array.isArray(x)||(x=[0|x,0|x]),x.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var c=0|x[0],T=0|x[1];return s(this,c,T),[c,T]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(x){return s(this,x|=0,this._shape[1]),x},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(x){return x|=0,s(this,this._shape[0],x),x},enumerable:!1}}),d.bind=function(){if(!this._destroyed){var x=this.gl;x.bindFramebuffer(x.FRAMEBUFFER,this.handle),x.viewport(0,0,this._shape[0],this._shape[1])}},d.dispose=function(){if(!this._destroyed){this._destroyed=!0;var x=this.gl;x.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(x.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var c=0;c<this.color.length;++c)this.color[c].dispose(),this.color[c]=null;this._color_rb&&(x.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":146}],87:[function(g,b,y){var e=g("sprintf-js").sprintf,n=g("gl-constants/lookup"),t=g("glsl-shader-name"),a=g("add-line-numbers");b.exports=function(r,m,o){var i=t(m)||"of unknown name (see npm glsl-shader-name)",u="unknown type";o!==void 0&&(u=o===n.FRAGMENT_SHADER?"fragment":"vertex");for(var f=e(`Error compiling %s shader %s:
`,u,i),l=e("%s%s",f,r),h=r.split(`
`),d={},s=0;s<h.length;s++){var x=h[s];if(x!==""&&x!=="\0"){var c=parseInt(x.split(":")[2]);if(isNaN(c))throw new Error(e("Could not parse error: %s",x));d[c]=x}}var T=a(m).split(`
`);for(s=0;s<T.length;s++)if(d[s+3]||d[s+2]||d[s+1]){var _=T[s];if(f+=_+`
`,d[s+1]){var w=d[s+1];w=w.substr(w.split(":",3).join(":").length+1).trim(),f+=e(`^^^ %s

`,w)}}return{long:f.trim(),short:l.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(g,b,y){b.exports=function(l,h){var d=l.gl,s=a(d,m.vertex,m.fragment),x=a(d,m.pickVertex,m.pickFragment),c=r(d),T=r(d),_=r(d),w=r(d),k=new o(l,s,x,c,T,_,w);return k.update(h),l.addObject(k),k};var e=g("binary-search-bounds"),n=g("iota-array"),t=g("typedarray-pool"),a=g("gl-shader"),r=g("gl-buffer"),m=g("./lib/shaders");function o(l,h,d,s,x,c,T){this.plot=l,this.shader=h,this.pickShader=d,this.positionBuffer=s,this.weightBuffer=x,this.colorBuffer=c,this.idBuffer=T,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var i,u=o.prototype,f=[0,0,1,0,0,1,1,0,1,1,0,1];u.draw=(i=[1,0,0,0,1,0,0,0,1],function(){var l=this.plot,h=this.shader,d=this.bounds,s=this.numVertices;if(!(s<=0)){var x=l.gl,c=l.dataBox,T=d[2]-d[0],_=d[3]-d[1],w=c[2]-c[0],k=c[3]-c[1];i[0]=2*T/w,i[4]=2*_/k,i[6]=2*(d[0]-c[0])/w-1,i[7]=2*(d[1]-c[1])/k-1,h.bind();var L=h.uniforms;L.viewTransform=i,L.shape=this.shape;var A=h.attributes;this.positionBuffer.bind(),A.position.pointer(),this.weightBuffer.bind(),A.weight.pointer(x.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),A.color.pointer(x.UNSIGNED_BYTE,!0),x.drawArrays(x.TRIANGLES,0,s)}}),u.drawPick=function(){var l=[1,0,0,0,1,0,0,0,1],h=[0,0,0,0];return function(d){var s=this.plot,x=this.pickShader,c=this.bounds,T=this.numVertices;if(!(T<=0)){var _=s.gl,w=s.dataBox,k=c[2]-c[0],L=c[3]-c[1],A=w[2]-w[0],I=w[3]-w[1];l[0]=2*k/A,l[4]=2*L/I,l[6]=2*(c[0]-w[0])/A-1,l[7]=2*(c[1]-w[1])/I-1;for(var P=0;P<4;++P)h[P]=d>>8*P&255;this.pickOffset=d,x.bind();var S=x.uniforms;S.viewTransform=l,S.pickOffset=h,S.shape=this.shape;var E=x.attributes;return this.positionBuffer.bind(),E.position.pointer(),this.weightBuffer.bind(),E.weight.pointer(_.UNSIGNED_BYTE,!1),this.idBuffer.bind(),E.pickId.pointer(_.UNSIGNED_BYTE,!1),_.drawArrays(_.TRIANGLES,0,T),d+this.shape[0]*this.shape[1]}}}(),u.pick=function(l,h,d){var s=this.pickOffset,x=this.shape[0]*this.shape[1];if(d<s||d>=s+x)return null;var c=d-s,T=this.xData,_=this.yData;return{object:this,pointId:c,dataCoord:[T[c%this.shape[0]],_[c/this.shape[0]|0]]}},u.update=function(l){var h=(l=l||{}).shape||[0,0],d=l.x||n(h[0]),s=l.y||n(h[1]),x=l.z||new Float32Array(h[0]*h[1]),c=l.zsmooth!==!1;this.xData=d,this.yData=s;var T,_,w,k,L=l.colorLevels||[0],A=l.colorValues||[0,0,0,1],I=L.length,P=this.bounds;c?(T=P[0]=d[0],_=P[1]=s[0],w=P[2]=d[d.length-1],k=P[3]=s[s.length-1]):(T=P[0]=d[0]+(d[1]-d[0])/2,_=P[1]=s[0]+(s[1]-s[0])/2,w=P[2]=d[d.length-1]+(d[d.length-1]-d[d.length-2])/2,k=P[3]=s[s.length-1]+(s[s.length-1]-s[s.length-2])/2);var S=1/(w-T),E=1/(k-_),D=h[0],R=h[1];this.shape=[D,R];var H=(c?(D-1)*(R-1):D*R)*(f.length>>>1);this.numVertices=H;for(var V=t.mallocUint8(4*H),X=t.mallocFloat32(2*H),$=t.mallocUint8(2*H),G=t.mallocUint32(H),W=0,te=c?D-1:D,N=c?R-1:R,B=0;B<N;++B){var U,ee;c?(U=E*(s[B]-_),ee=E*(s[B+1]-_)):(U=B<R-1?E*(s[B]-(s[B+1]-s[B])/2-_):E*(s[B]-(s[B]-s[B-1])/2-_),ee=B<R-1?E*(s[B]+(s[B+1]-s[B])/2-_):E*(s[B]+(s[B]-s[B-1])/2-_));for(var j=0;j<te;++j){var Q,K;c?(Q=S*(d[j]-T),K=S*(d[j+1]-T)):(Q=j<D-1?S*(d[j]-(d[j+1]-d[j])/2-T):S*(d[j]-(d[j]-d[j-1])/2-T),K=j<D-1?S*(d[j]+(d[j+1]-d[j])/2-T):S*(d[j]+(d[j]-d[j-1])/2-T));for(var re=0;re<f.length;re+=2){var ne,le,oe,de,se=f[re],me=f[re+1],Te=x[c?(B+me)*D+(j+se):B*D+j],_e=e.le(L,Te);if(_e<0)ne=A[0],le=A[1],oe=A[2],de=A[3];else if(_e===I-1)ne=A[4*I-4],le=A[4*I-3],oe=A[4*I-2],de=A[4*I-1];else{var be=(Te-L[_e])/(L[_e+1]-L[_e]),Ce=1-be,fe=4*_e,ve=4*(_e+1);ne=Ce*A[fe]+be*A[ve],le=Ce*A[fe+1]+be*A[ve+1],oe=Ce*A[fe+2]+be*A[ve+2],de=Ce*A[fe+3]+be*A[ve+3]}V[4*W]=255*ne,V[4*W+1]=255*le,V[4*W+2]=255*oe,V[4*W+3]=255*de,X[2*W]=.5*Q+.5*K,X[2*W+1]=.5*U+.5*ee,$[2*W]=se,$[2*W+1]=me,G[W]=B*D+j,W+=1}}}this.positionBuffer.update(X),this.weightBuffer.update($),this.colorBuffer.update(V),this.idBuffer.update(G),t.free(X),t.free(V),t.free($),t.free(G)},u.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(g,b,y){var e=g("glslify");b.exports={fragment:e([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:231}],90:[function(g,b,y){var e=g("glslify"),n=g("gl-shader"),t=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),a=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),m=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];y.createShader=function(o){return n(o,t,a,null,m)},y.createPickShader=function(o){return n(o,t,r,null,m)}},{"gl-shader":132,glslify:231}],91:[function(g,b,y){b.exports=function(T){var _=T.gl||T.scene&&T.scene.gl,w=u(_);w.attributes.position.location=0,w.attributes.nextPosition.location=1,w.attributes.arcLength.location=2,w.attributes.lineWidth.location=3,w.attributes.color.location=4;var k=f(_);k.attributes.position.location=0,k.attributes.nextPosition.location=1,k.attributes.arcLength.location=2,k.attributes.lineWidth.location=3,k.attributes.color.location=4;for(var L=e(_),A=n(_,[{buffer:L,size:3,offset:0,stride:48},{buffer:L,size:3,offset:12,stride:48},{buffer:L,size:1,offset:24,stride:48},{buffer:L,size:1,offset:28,stride:48},{buffer:L,size:4,offset:32,stride:48}]),I=o(new Array(1024),[256,1,4]),P=0;P<1024;++P)I.data[P]=255;var S=t(_,I);S.wrap=_.REPEAT;var E=new x(_,w,k,L,A,S);return E.update(T),E};var e=g("gl-buffer"),n=g("gl-vao"),t=g("gl-texture2d"),a=new Uint8Array(4),r=new Float32Array(a.buffer),m=g("binary-search-bounds"),o=g("ndarray"),i=g("./lib/shaders"),u=i.createShader,f=i.createPickShader,l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function h(T,_){for(var w=0,k=0;k<3;++k){var L=T[k]-_[k];w+=L*L}return Math.sqrt(w)}function d(T){for(var _=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],w=0;w<3;++w)_[0][w]=Math.max(T[0][w],_[0][w]),_[1][w]=Math.min(T[1][w],_[1][w]);return _}function s(T,_,w,k){this.arcLength=T,this.position=_,this.index=w,this.dataCoordinate=k}function x(T,_,w,k,L,A){this.gl=T,this.shader=_,this.pickShader=w,this.buffer=k,this.vao=L,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=A,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var c=x.prototype;c.isTransparent=function(){return this.hasAlpha},c.isOpaque=function(){return!this.hasAlpha},c.pickSlots=1,c.setPickBase=function(T){this.pickId=T},c.drawTransparent=c.draw=function(T){if(this.vertexCount){var _=this.gl,w=this.shader,k=this.vao;w.bind(),w.uniforms={model:T.model||l,view:T.view||l,projection:T.projection||l,clipBounds:d(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[_.drawingBufferWidth,_.drawingBufferHeight],pixelRatio:this.pixelRatio},k.bind(),k.draw(_.TRIANGLE_STRIP,this.vertexCount),k.unbind()}},c.drawPick=function(T){if(this.vertexCount){var _=this.gl,w=this.pickShader,k=this.vao;w.bind(),w.uniforms={model:T.model||l,view:T.view||l,projection:T.projection||l,pickId:this.pickId,clipBounds:d(this.clipBounds),screenShape:[_.drawingBufferWidth,_.drawingBufferHeight],pixelRatio:this.pixelRatio},k.bind(),k.draw(_.TRIANGLE_STRIP,this.vertexCount),k.unbind()}},c.update=function(T){var _,w;this.dirty=!0;var k=!!T.connectGaps;"dashScale"in T&&(this.dashScale=T.dashScale),this.hasAlpha=!1,"opacity"in T&&(this.opacity=+T.opacity,this.opacity<1&&(this.hasAlpha=!0));var L=[],A=[],I=[],P=0,S=0,E=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],D=T.position||T.positions;if(D){var R=T.color||T.colors||[0,0,0,1],H=T.lineWidth||1,V=!1;e:for(_=1;_<D.length;++_){var X,$,G,W=D[_-1],te=D[_];for(A.push(P),I.push(W.slice()),w=0;w<3;++w){if(isNaN(W[w])||isNaN(te[w])||!isFinite(W[w])||!isFinite(te[w])){if(!k&&L.length>0){for(var N=0;N<24;++N)L.push(L[L.length-12]);S+=2,V=!0}continue e}E[0][w]=Math.min(E[0][w],W[w],te[w]),E[1][w]=Math.max(E[1][w],W[w],te[w])}Array.isArray(R[0])?(X=R.length>_-1?R[_-1]:R.length>0?R[R.length-1]:[0,0,0,1],$=R.length>_?R[_]:R.length>0?R[R.length-1]:[0,0,0,1]):X=$=R,X.length===3&&(X=[X[0],X[1],X[2],1]),$.length===3&&($=[$[0],$[1],$[2],1]),!this.hasAlpha&&X[3]<1&&(this.hasAlpha=!0),G=Array.isArray(H)?H.length>_-1?H[_-1]:H.length>0?H[H.length-1]:[0,0,0,1]:H;var B=P;if(P+=h(W,te),V){for(w=0;w<2;++w)L.push(W[0],W[1],W[2],te[0],te[1],te[2],B,G,X[0],X[1],X[2],X[3]);S+=2,V=!1}L.push(W[0],W[1],W[2],te[0],te[1],te[2],B,G,X[0],X[1],X[2],X[3],W[0],W[1],W[2],te[0],te[1],te[2],B,-G,X[0],X[1],X[2],X[3],te[0],te[1],te[2],W[0],W[1],W[2],P,-G,$[0],$[1],$[2],$[3],te[0],te[1],te[2],W[0],W[1],W[2],P,G,$[0],$[1],$[2],$[3]),S+=4}}if(this.buffer.update(L),A.push(P),I.push(D[D.length-1].slice()),this.bounds=E,this.vertexCount=S,this.points=I,this.arcLength=A,"dashes"in T){var U=T.dashes.slice();for(U.unshift(0),_=1;_<U.length;++_)U[_]=U[_-1]+U[_];var ee=o(new Array(1024),[256,1,4]);for(_=0;_<256;++_){for(w=0;w<4;++w)ee.set(_,0,w,0);1&m.le(U,U[U.length-1]*_/255)?ee.set(_,0,0,0):ee.set(_,0,0,255)}this.texture.setPixels(ee)}},c.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},c.pick=function(T){if(!T||T.id!==this.pickId)return null;var _=function(D,R,H,V){return a[0]=V,a[1]=H,a[2]=R,a[3]=D,r[0]}(T.value[0],T.value[1],T.value[2],0),w=m.le(this.arcLength,_);if(w<0)return null;if(w===this.arcLength.length-1)return new s(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),w);for(var k=this.points[w],L=this.points[Math.min(w+1,this.points.length-1)],A=(_-this.arcLength[w])/(this.arcLength[w+1]-this.arcLength[w]),I=1-A,P=[0,0,0],S=0;S<3;++S)P[S]=I*k[S]+A*L[S];var E=Math.min(A<.5?w:w+1,this.points.length-1);return new s(_,P,E,this.points[E])}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(g,b,y){b.exports=function(e){var n=new Float32Array(16);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}},{}],93:[function(g,b,y){b.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],94:[function(g,b,y){b.exports=function(e){var n=e[0],t=e[1],a=e[2],r=e[3],m=e[4],o=e[5],i=e[6],u=e[7],f=e[8],l=e[9],h=e[10],d=e[11],s=e[12],x=e[13],c=e[14],T=e[15];return(n*o-t*m)*(h*T-d*c)-(n*i-a*m)*(l*T-d*x)+(n*u-r*m)*(l*c-h*x)+(t*i-a*o)*(f*T-d*s)-(t*u-r*o)*(f*c-h*s)+(a*u-r*i)*(f*x-l*s)}},{}],95:[function(g,b,y){b.exports=function(e,n){var t=n[0],a=n[1],r=n[2],m=n[3],o=t+t,i=a+a,u=r+r,f=t*o,l=a*o,h=a*i,d=r*o,s=r*i,x=r*u,c=m*o,T=m*i,_=m*u;return e[0]=1-h-x,e[1]=l+_,e[2]=d-T,e[3]=0,e[4]=l-_,e[5]=1-f-x,e[6]=s+c,e[7]=0,e[8]=d+T,e[9]=s-c,e[10]=1-f-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],96:[function(g,b,y){b.exports=function(e,n,t){var a=n[0],r=n[1],m=n[2],o=n[3],i=a+a,u=r+r,f=m+m,l=a*i,h=a*u,d=a*f,s=r*u,x=r*f,c=m*f,T=o*i,_=o*u,w=o*f;return e[0]=1-(s+c),e[1]=h+w,e[2]=d-_,e[3]=0,e[4]=h-w,e[5]=1-(l+c),e[6]=x+T,e[7]=0,e[8]=d+_,e[9]=x-T,e[10]=1-(l+s),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}},{}],97:[function(g,b,y){b.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],98:[function(g,b,y){b.exports=function(e,n){var t=n[0],a=n[1],r=n[2],m=n[3],o=n[4],i=n[5],u=n[6],f=n[7],l=n[8],h=n[9],d=n[10],s=n[11],x=n[12],c=n[13],T=n[14],_=n[15],w=t*i-a*o,k=t*u-r*o,L=t*f-m*o,A=a*u-r*i,I=a*f-m*i,P=r*f-m*u,S=l*c-h*x,E=l*T-d*x,D=l*_-s*x,R=h*T-d*c,H=h*_-s*c,V=d*_-s*T,X=w*V-k*H+L*R+A*D-I*E+P*S;return X?(X=1/X,e[0]=(i*V-u*H+f*R)*X,e[1]=(r*H-a*V-m*R)*X,e[2]=(c*P-T*I+_*A)*X,e[3]=(d*I-h*P-s*A)*X,e[4]=(u*D-o*V-f*E)*X,e[5]=(t*V-r*D+m*E)*X,e[6]=(T*L-x*P-_*k)*X,e[7]=(l*P-d*L+s*k)*X,e[8]=(o*H-i*D+f*S)*X,e[9]=(a*D-t*H-m*S)*X,e[10]=(x*I-c*L+_*w)*X,e[11]=(h*L-l*I-s*w)*X,e[12]=(i*E-o*R-u*S)*X,e[13]=(t*R-a*E+r*S)*X,e[14]=(c*k-x*A-T*w)*X,e[15]=(l*A-h*k+d*w)*X,e):null}},{}],99:[function(g,b,y){var e=g("./identity");b.exports=function(n,t,a,r){var m,o,i,u,f,l,h,d,s,x,c=t[0],T=t[1],_=t[2],w=r[0],k=r[1],L=r[2],A=a[0],I=a[1],P=a[2];return Math.abs(c-A)<1e-6&&Math.abs(T-I)<1e-6&&Math.abs(_-P)<1e-6?e(n):(h=c-A,d=T-I,s=_-P,x=1/Math.sqrt(h*h+d*d+s*s),m=k*(s*=x)-L*(d*=x),o=L*(h*=x)-w*s,i=w*d-k*h,(x=Math.sqrt(m*m+o*o+i*i))?(m*=x=1/x,o*=x,i*=x):(m=0,o=0,i=0),u=d*i-s*o,f=s*m-h*i,l=h*o-d*m,(x=Math.sqrt(u*u+f*f+l*l))?(u*=x=1/x,f*=x,l*=x):(u=0,f=0,l=0),n[0]=m,n[1]=u,n[2]=h,n[3]=0,n[4]=o,n[5]=f,n[6]=d,n[7]=0,n[8]=i,n[9]=l,n[10]=s,n[11]=0,n[12]=-(m*c+o*T+i*_),n[13]=-(u*c+f*T+l*_),n[14]=-(h*c+d*T+s*_),n[15]=1,n)}},{"./identity":97}],100:[function(g,b,y){b.exports=function(e,n,t){var a=n[0],r=n[1],m=n[2],o=n[3],i=n[4],u=n[5],f=n[6],l=n[7],h=n[8],d=n[9],s=n[10],x=n[11],c=n[12],T=n[13],_=n[14],w=n[15],k=t[0],L=t[1],A=t[2],I=t[3];return e[0]=k*a+L*i+A*h+I*c,e[1]=k*r+L*u+A*d+I*T,e[2]=k*m+L*f+A*s+I*_,e[3]=k*o+L*l+A*x+I*w,k=t[4],L=t[5],A=t[6],I=t[7],e[4]=k*a+L*i+A*h+I*c,e[5]=k*r+L*u+A*d+I*T,e[6]=k*m+L*f+A*s+I*_,e[7]=k*o+L*l+A*x+I*w,k=t[8],L=t[9],A=t[10],I=t[11],e[8]=k*a+L*i+A*h+I*c,e[9]=k*r+L*u+A*d+I*T,e[10]=k*m+L*f+A*s+I*_,e[11]=k*o+L*l+A*x+I*w,k=t[12],L=t[13],A=t[14],I=t[15],e[12]=k*a+L*i+A*h+I*c,e[13]=k*r+L*u+A*d+I*T,e[14]=k*m+L*f+A*s+I*_,e[15]=k*o+L*l+A*x+I*w,e}},{}],101:[function(g,b,y){b.exports=function(e,n,t,a,r,m,o){var i=1/(n-t),u=1/(a-r),f=1/(m-o);return e[0]=-2*i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(n+t)*i,e[13]=(r+a)*u,e[14]=(o+m)*f,e[15]=1,e}},{}],102:[function(g,b,y){b.exports=function(e,n,t,a,r){var m=1/Math.tan(n/2),o=1/(a-r);return e[0]=m/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=m,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+a)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*a*o,e[15]=0,e}},{}],103:[function(g,b,y){b.exports=function(e,n,t,a){var r,m,o,i,u,f,l,h,d,s,x,c,T,_,w,k,L,A,I,P,S,E,D,R,H=a[0],V=a[1],X=a[2],$=Math.sqrt(H*H+V*V+X*X);return Math.abs($)<1e-6?null:(H*=$=1/$,V*=$,X*=$,r=Math.sin(t),m=Math.cos(t),o=1-m,i=n[0],u=n[1],f=n[2],l=n[3],h=n[4],d=n[5],s=n[6],x=n[7],c=n[8],T=n[9],_=n[10],w=n[11],k=H*H*o+m,L=V*H*o+X*r,A=X*H*o-V*r,I=H*V*o-X*r,P=V*V*o+m,S=X*V*o+H*r,E=H*X*o+V*r,D=V*X*o-H*r,R=X*X*o+m,e[0]=i*k+h*L+c*A,e[1]=u*k+d*L+T*A,e[2]=f*k+s*L+_*A,e[3]=l*k+x*L+w*A,e[4]=i*I+h*P+c*S,e[5]=u*I+d*P+T*S,e[6]=f*I+s*P+_*S,e[7]=l*I+x*P+w*S,e[8]=i*E+h*D+c*R,e[9]=u*E+d*D+T*R,e[10]=f*E+s*D+_*R,e[11]=l*E+x*D+w*R,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)}},{}],104:[function(g,b,y){b.exports=function(e,n,t){var a=Math.sin(t),r=Math.cos(t),m=n[4],o=n[5],i=n[6],u=n[7],f=n[8],l=n[9],h=n[10],d=n[11];return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=m*r+f*a,e[5]=o*r+l*a,e[6]=i*r+h*a,e[7]=u*r+d*a,e[8]=f*r-m*a,e[9]=l*r-o*a,e[10]=h*r-i*a,e[11]=d*r-u*a,e}},{}],105:[function(g,b,y){b.exports=function(e,n,t){var a=Math.sin(t),r=Math.cos(t),m=n[0],o=n[1],i=n[2],u=n[3],f=n[8],l=n[9],h=n[10],d=n[11];return n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=m*r-f*a,e[1]=o*r-l*a,e[2]=i*r-h*a,e[3]=u*r-d*a,e[8]=m*a+f*r,e[9]=o*a+l*r,e[10]=i*a+h*r,e[11]=u*a+d*r,e}},{}],106:[function(g,b,y){b.exports=function(e,n,t){var a=Math.sin(t),r=Math.cos(t),m=n[0],o=n[1],i=n[2],u=n[3],f=n[4],l=n[5],h=n[6],d=n[7];return n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=m*r+f*a,e[1]=o*r+l*a,e[2]=i*r+h*a,e[3]=u*r+d*a,e[4]=f*r-m*a,e[5]=l*r-o*a,e[6]=h*r-i*a,e[7]=d*r-u*a,e}},{}],107:[function(g,b,y){b.exports=function(e,n,t){var a=t[0],r=t[1],m=t[2];return e[0]=n[0]*a,e[1]=n[1]*a,e[2]=n[2]*a,e[3]=n[3]*a,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=n[7]*r,e[8]=n[8]*m,e[9]=n[9]*m,e[10]=n[10]*m,e[11]=n[11]*m,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}},{}],108:[function(g,b,y){b.exports=function(e,n,t){var a,r,m,o,i,u,f,l,h,d,s,x,c=t[0],T=t[1],_=t[2];return n===e?(e[12]=n[0]*c+n[4]*T+n[8]*_+n[12],e[13]=n[1]*c+n[5]*T+n[9]*_+n[13],e[14]=n[2]*c+n[6]*T+n[10]*_+n[14],e[15]=n[3]*c+n[7]*T+n[11]*_+n[15]):(a=n[0],r=n[1],m=n[2],o=n[3],i=n[4],u=n[5],f=n[6],l=n[7],h=n[8],d=n[9],s=n[10],x=n[11],e[0]=a,e[1]=r,e[2]=m,e[3]=o,e[4]=i,e[5]=u,e[6]=f,e[7]=l,e[8]=h,e[9]=d,e[10]=s,e[11]=x,e[12]=a*c+i*T+h*_+n[12],e[13]=r*c+u*T+d*_+n[13],e[14]=m*c+f*T+s*_+n[14],e[15]=o*c+l*T+x*_+n[15]),e}},{}],109:[function(g,b,y){b.exports=function(e,n){if(e===n){var t=n[1],a=n[2],r=n[3],m=n[6],o=n[7],i=n[11];e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=t,e[6]=n[9],e[7]=n[13],e[8]=a,e[9]=m,e[11]=n[14],e[12]=r,e[13]=o,e[14]=i}else e[0]=n[0],e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=n[1],e[5]=n[5],e[6]=n[9],e[7]=n[13],e[8]=n[2],e[9]=n[6],e[10]=n[10],e[11]=n[14],e[12]=n[3],e[13]=n[7],e[14]=n[11],e[15]=n[15];return e}},{}],110:[function(g,b,y){var e=g("barycentric"),n=g("polytope-closest-point/lib/closest_point_2d.js");function t(m,o){for(var i=[0,0,0,0],u=0;u<4;++u)for(var f=0;f<4;++f)i[f]+=m[4*u+f]*o[u];return i}function a(m,o,i,u,f){for(var l=t(u,t(i,t(o,[m[0],m[1],m[2],1]))),h=0;h<3;++h)l[h]/=l[3];return[.5*f[0]*(1+l[0]),.5*f[1]*(1-l[1])]}function r(m,o){for(var i=[0,0,0],u=0;u<m.length;++u)for(var f=m[u],l=o[u],h=0;h<3;++h)i[h]+=l*f[h];return i}b.exports=function(m,o,i,u,f,l){if(m.length===1)return[0,m[0].slice()];for(var h=new Array(m.length),d=0;d<m.length;++d)h[d]=a(m[d],i,u,f,l);var s=0,x=1/0;for(d=0;d<h.length;++d){for(var c=0,T=0;T<2;++T)c+=Math.pow(h[d][T]-o[T],2);c<x&&(x=c,s=d)}var _=function(k,L){if(k.length===2){for(var A=0,I=0,P=0;P<2;++P)A+=Math.pow(L[P]-k[0][P],2),I+=Math.pow(L[P]-k[1][P],2);return A=Math.sqrt(A),I=Math.sqrt(I),A+I<1e-6?[1,0]:[I/(A+I),A/(I+A)]}if(k.length===3){var S=[0,0];return n(k[0],k[1],k[2],L,S),e(k,S)}return[]}(h,o),w=0;for(d=0;d<3;++d){if(_[d]<-.001||_[d]>1.0001)return null;w+=_[d]}return Math.abs(w-1)>.001?null:[s,r(m,_),_]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(g,b,y){var e=g("glslify"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),t=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),a=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),m=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),o=e([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),i=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),u=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),f=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),l=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),h=e([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);y.meshShader={vertex:n,fragment:t,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},y.wireShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},y.pointShader={vertex:m,fragment:o,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},y.pickShader={vertex:i,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},y.pointPickShader={vertex:f,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},y.contourShader={vertex:l,fragment:h,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(g,b,y){var e=g("gl-shader"),n=g("gl-buffer"),t=g("gl-vao"),a=g("gl-texture2d"),r=g("normals"),m=g("gl-mat4/multiply"),o=g("gl-mat4/invert"),i=g("ndarray"),u=g("colormap"),f=g("simplicial-complex-contour"),l=g("typedarray-pool"),h=g("./lib/shaders"),d=g("./lib/closest-point"),s=h.meshShader,x=h.wireShader,c=h.pointShader,T=h.pickShader,_=h.pointPickShader,w=h.contourShader,k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function L(V,X,$,G,W,te,N,B,U,ee,j,Q,K,re,ne,le,oe,de,se,me,Te,_e,be,Ce,fe,ve,Me){this.gl=V,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=X,this.dirty=!0,this.triShader=$,this.lineShader=G,this.pointShader=W,this.pickShader=te,this.pointPickShader=N,this.contourShader=B,this.trianglePositions=U,this.triangleColors=j,this.triangleNormals=K,this.triangleUVs=Q,this.triangleIds=ee,this.triangleVAO=re,this.triangleCount=0,this.lineWidth=1,this.edgePositions=ne,this.edgeColors=oe,this.edgeUVs=de,this.edgeIds=le,this.edgeVAO=se,this.edgeCount=0,this.pointPositions=me,this.pointColors=_e,this.pointUVs=be,this.pointSizes=Ce,this.pointIds=Te,this.pointVAO=fe,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=ve,this.contourVAO=Me,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=k,this._view=k,this._projection=k,this._resolution=[1,1]}var A=L.prototype;function I(V,X){if(!X||!X.length)return 1;for(var $=0;$<X.length;++$){if(X.length<2)return 1;if(X[$][0]===V)return X[$][1];if(X[$][0]>V&&$>0){var G=(X[$][0]-V)/(X[$][0]-X[$-1][0]);return X[$][1]*(1-G)+G*X[$-1][1]}}return 1}function P(V){var X=e(V,s.vertex,s.fragment);return X.attributes.position.location=0,X.attributes.color.location=2,X.attributes.uv.location=3,X.attributes.normal.location=4,X}function S(V){var X=e(V,x.vertex,x.fragment);return X.attributes.position.location=0,X.attributes.color.location=2,X.attributes.uv.location=3,X}function E(V){var X=e(V,c.vertex,c.fragment);return X.attributes.position.location=0,X.attributes.color.location=2,X.attributes.uv.location=3,X.attributes.pointSize.location=4,X}function D(V){var X=e(V,T.vertex,T.fragment);return X.attributes.position.location=0,X.attributes.id.location=1,X}function R(V){var X=e(V,_.vertex,_.fragment);return X.attributes.position.location=0,X.attributes.id.location=1,X.attributes.pointSize.location=4,X}function H(V){var X=e(V,w.vertex,w.fragment);return X.attributes.position.location=0,X}A.isOpaque=function(){return!this.hasAlpha},A.isTransparent=function(){return this.hasAlpha},A.pickSlots=1,A.setPickBase=function(V){this.pickId=V},A.highlight=function(V){if(V&&this.contourEnable){for(var X=f(this.cells,this.intensity,V.intensity),$=X.cells,G=X.vertexIds,W=X.vertexWeights,te=$.length,N=l.mallocFloat32(6*te),B=0,U=0;U<te;++U)for(var ee=$[U],j=0;j<2;++j){var Q=ee[0];ee.length===2&&(Q=ee[j]);for(var K=G[Q][0],re=G[Q][1],ne=W[Q],le=1-ne,oe=this.positions[K],de=this.positions[re],se=0;se<3;++se)N[B++]=ne*oe[se]+le*de[se]}this.contourCount=B/3|0,this.contourPositions.update(N.subarray(0,B)),l.free(N)}else this.contourCount=0},A.update=function(V){V=V||{};var X=this.gl;this.dirty=!0,"contourEnable"in V&&(this.contourEnable=V.contourEnable),"contourColor"in V&&(this.contourColor=V.contourColor),"lineWidth"in V&&(this.lineWidth=V.lineWidth),"lightPosition"in V&&(this.lightPosition=V.lightPosition),this.hasAlpha=!1,"opacity"in V&&(this.opacity=V.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in V&&(this.opacityscale=V.opacityscale,this.hasAlpha=!0),"ambient"in V&&(this.ambientLight=V.ambient),"diffuse"in V&&(this.diffuseLight=V.diffuse),"specular"in V&&(this.specularLight=V.specular),"roughness"in V&&(this.roughness=V.roughness),"fresnel"in V&&(this.fresnel=V.fresnel),V.texture?(this.texture.dispose(),this.texture=a(X,V.texture)):V.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=X.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=X.LINEAR,this.texture.setPixels(function(qt,er){for(var Jt=u({colormap:qt,nshades:256,format:"rgba"}),ir=new Uint8Array(1024),Ht=0;Ht<256;++Ht){for(var Ue=Jt[Ht],We=0;We<3;++We)ir[4*Ht+We]=Ue[We];ir[4*Ht+3]=er?255*I(Ht/255,er):255*Ue[3]}return i(ir,[256,256,4],[4,0,1])}(V.colormap,this.opacityscale)),this.texture.generateMipmap());var $=V.cells,G=V.positions;if(G&&$){var W=[],te=[],N=[],B=[],U=[],ee=[],j=[],Q=[],K=[],re=[],ne=[],le=[],oe=[],de=[];this.cells=$,this.positions=G;var se=V.vertexNormals,me=V.cellNormals,Te=V.vertexNormalsEpsilon===void 0?1e-6:V.vertexNormalsEpsilon,_e=V.faceNormalsEpsilon===void 0?1e-6:V.faceNormalsEpsilon;V.useFacetNormals&&!me&&(me=r.faceNormals($,G,_e)),me||se||(se=r.vertexNormals($,G,Te));var be=V.vertexColors,Ce=V.cellColors,fe=V.meshColor||[1,1,1,1],ve=V.vertexUVs,Me=V.vertexIntensity,ke=V.cellUVs,Le=V.cellIntensity,ze=1/0,Re=-1/0;if(!ve&&!ke)if(Me)if(V.vertexIntensityBounds)ze=+V.vertexIntensityBounds[0],Re=+V.vertexIntensityBounds[1];else for(var Oe=0;Oe<Me.length;++Oe){var Ze=Me[Oe];ze=Math.min(ze,Ze),Re=Math.max(Re,Ze)}else if(Le)if(V.cellIntensityBounds)ze=+V.cellIntensityBounds[0],Re=+V.cellIntensityBounds[1];else for(Oe=0;Oe<Le.length;++Oe)Ze=Le[Oe],ze=Math.min(ze,Ze),Re=Math.max(Re,Ze);else for(Oe=0;Oe<G.length;++Oe)Ze=G[Oe][2],ze=Math.min(ze,Ze),Re=Math.max(Re,Ze);this.intensity=Me||Le||function(qt){for(var er=qt.length,Jt=new Array(er),ir=0;ir<er;++ir)Jt[ir]=qt[ir][2];return Jt}(G),this.pickVertex=!(Le||Ce);var Pe=V.pointSizes,Ie=V.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Oe=0;Oe<G.length;++Oe)for(var Be=G[Oe],Fe=0;Fe<3;++Fe)!isNaN(Be[Fe])&&isFinite(Be[Fe])&&(this.bounds[0][Fe]=Math.min(this.bounds[0][Fe],Be[Fe]),this.bounds[1][Fe]=Math.max(this.bounds[1][Fe],Be[Fe]));var $e=0,ot=0,pt=0;e:for(Oe=0;Oe<$.length;++Oe){var _t=$[Oe];switch(_t.length){case 1:for(Be=G[tt=_t[0]],Fe=0;Fe<3;++Fe)if(isNaN(Be[Fe])||!isFinite(Be[Fe]))continue e;re.push(Be[0],Be[1],Be[2]),Ke=be?be[tt]:Ce?Ce[Oe]:fe,this.opacityscale&&Me?te.push(Ke[0],Ke[1],Ke[2],this.opacity*I((Me[tt]-ze)/(Re-ze),this.opacityscale)):Ke.length===3?ne.push(Ke[0],Ke[1],Ke[2],this.opacity):(ne.push(Ke[0],Ke[1],Ke[2],Ke[3]*this.opacity),Ke[3]<1&&(this.hasAlpha=!0)),vt=ve?ve[tt]:Me?[(Me[tt]-ze)/(Re-ze),0]:ke?ke[Oe]:Le?[(Le[Oe]-ze)/(Re-ze),0]:[(Be[2]-ze)/(Re-ze),0],le.push(vt[0],vt[1]),Pe?oe.push(Pe[tt]):oe.push(Ie),de.push(Oe),pt+=1;break;case 2:for(Fe=0;Fe<2;++Fe){Be=G[tt=_t[Fe]];for(var yt=0;yt<3;++yt)if(isNaN(Be[yt])||!isFinite(Be[yt]))continue e}for(Fe=0;Fe<2;++Fe)Be=G[tt=_t[Fe]],ee.push(Be[0],Be[1],Be[2]),Ke=be?be[tt]:Ce?Ce[Oe]:fe,this.opacityscale&&Me?te.push(Ke[0],Ke[1],Ke[2],this.opacity*I((Me[tt]-ze)/(Re-ze),this.opacityscale)):Ke.length===3?j.push(Ke[0],Ke[1],Ke[2],this.opacity):(j.push(Ke[0],Ke[1],Ke[2],Ke[3]*this.opacity),Ke[3]<1&&(this.hasAlpha=!0)),vt=ve?ve[tt]:Me?[(Me[tt]-ze)/(Re-ze),0]:ke?ke[Oe]:Le?[(Le[Oe]-ze)/(Re-ze),0]:[(Be[2]-ze)/(Re-ze),0],Q.push(vt[0],vt[1]),K.push(Oe);ot+=1;break;case 3:for(Fe=0;Fe<3;++Fe)for(Be=G[tt=_t[Fe]],yt=0;yt<3;++yt)if(isNaN(Be[yt])||!isFinite(Be[yt]))continue e;for(Fe=0;Fe<3;++Fe){var tt,Ke,vt,Nt;Be=G[tt=_t[2-Fe]],W.push(Be[0],Be[1],Be[2]),(Ke=be?be[tt]:Ce?Ce[Oe]:fe)?this.opacityscale&&Me?te.push(Ke[0],Ke[1],Ke[2],this.opacity*I((Me[tt]-ze)/(Re-ze),this.opacityscale)):Ke.length===3?te.push(Ke[0],Ke[1],Ke[2],this.opacity):(te.push(Ke[0],Ke[1],Ke[2],Ke[3]*this.opacity),Ke[3]<1&&(this.hasAlpha=!0)):te.push(.5,.5,.5,1),vt=ve?ve[tt]:Me?[(Me[tt]-ze)/(Re-ze),0]:ke?ke[Oe]:Le?[(Le[Oe]-ze)/(Re-ze),0]:[(Be[2]-ze)/(Re-ze),0],B.push(vt[0],vt[1]),Nt=se?se[tt]:me[Oe],N.push(Nt[0],Nt[1],Nt[2]),U.push(Oe)}$e+=1}}this.pointCount=pt,this.edgeCount=ot,this.triangleCount=$e,this.pointPositions.update(re),this.pointColors.update(ne),this.pointUVs.update(le),this.pointSizes.update(oe),this.pointIds.update(new Uint32Array(de)),this.edgePositions.update(ee),this.edgeColors.update(j),this.edgeUVs.update(Q),this.edgeIds.update(new Uint32Array(K)),this.trianglePositions.update(W),this.triangleColors.update(te),this.triangleUVs.update(B),this.triangleNormals.update(N),this.triangleIds.update(new Uint32Array(U))}},A.drawTransparent=A.draw=function(V){V=V||{};for(var X=this.gl,$=V.model||k,G=V.view||k,W=V.projection||k,te=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],N=0;N<3;++N)te[0][N]=Math.max(te[0][N],this.clipBounds[0][N]),te[1][N]=Math.min(te[1][N],this.clipBounds[1][N]);var B={model:$,view:G,projection:W,inverseModel:k.slice(),clipBounds:te,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};B.inverseModel=o(B.inverseModel,B.model),X.disable(X.CULL_FACE),this.texture.bind(0);var U=new Array(16);for(m(U,B.view,B.model),m(U,B.projection,U),o(U,U),N=0;N<3;++N)B.eyePosition[N]=U[12+N]/U[15];var ee,j=U[15];for(N=0;N<3;++N)j+=this.lightPosition[N]*U[4*N+3];for(N=0;N<3;++N){for(var Q=U[12+N],K=0;K<3;++K)Q+=U[4*K+N]*this.lightPosition[K];B.lightPosition[N]=Q/j}this.triangleCount>0&&((ee=this.triShader).bind(),ee.uniforms=B,this.triangleVAO.bind(),X.drawArrays(X.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((ee=this.lineShader).bind(),ee.uniforms=B,this.edgeVAO.bind(),X.lineWidth(this.lineWidth*this.pixelRatio),X.drawArrays(X.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((ee=this.pointShader).bind(),ee.uniforms=B,this.pointVAO.bind(),X.drawArrays(X.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((ee=this.contourShader).bind(),ee.uniforms=B,this.contourVAO.bind(),X.drawArrays(X.LINES,0,this.contourCount),this.contourVAO.unbind())},A.drawPick=function(V){V=V||{};for(var X=this.gl,$=V.model||k,G=V.view||k,W=V.projection||k,te=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],N=0;N<3;++N)te[0][N]=Math.max(te[0][N],this.clipBounds[0][N]),te[1][N]=Math.min(te[1][N],this.clipBounds[1][N]);this._model=[].slice.call($),this._view=[].slice.call(G),this._projection=[].slice.call(W),this._resolution=[X.drawingBufferWidth,X.drawingBufferHeight];var B,U={model:$,view:G,projection:W,clipBounds:te,pickId:this.pickId/255};(B=this.pickShader).bind(),B.uniforms=U,this.triangleCount>0&&(this.triangleVAO.bind(),X.drawArrays(X.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),X.lineWidth(this.lineWidth*this.pixelRatio),X.drawArrays(X.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((B=this.pointPickShader).bind(),B.uniforms=U,this.pointVAO.bind(),X.drawArrays(X.POINTS,0,this.pointCount),this.pointVAO.unbind())},A.pick=function(V){if(!V||V.id!==this.pickId)return null;for(var X=V.value[0]+256*V.value[1]+65536*V.value[2],$=this.cells[X],G=this.positions,W=new Array($.length),te=0;te<$.length;++te)W[te]=G[$[te]];var N=V.coord[0],B=V.coord[1];if(!this.pickVertex){var U=this.positions[$[0]],ee=this.positions[$[1]],j=this.positions[$[2]],Q=[(U[0]+ee[0]+j[0])/3,(U[1]+ee[1]+j[1])/3,(U[2]+ee[2]+j[2])/3];return{_cellCenter:!0,position:[N,B],index:X,cell:$,cellId:X,intensity:this.intensity[X],dataCoordinate:Q}}var K=d(W,[N*this.pixelRatio,this._resolution[1]-B*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!K)return null;var re=K[2],ne=0;for(te=0;te<$.length;++te)ne+=re[te]*this.intensity[$[te]];return{position:K[1],index:$[K[0]],cell:$,cellId:X,intensity:ne,dataCoordinate:this.positions[$[K[0]]]}},A.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},b.exports=function(V,X){arguments.length===1&&(V=(X=V).gl);var $=V.getExtension("OES_standard_derivatives")||V.getExtension("MOZ_OES_standard_derivatives")||V.getExtension("WEBKIT_OES_standard_derivatives");if(!$)throw new Error("derivatives not supported");var G=P(V),W=S(V),te=E(V),N=D(V),B=R(V),U=H(V),ee=a(V,i(new Uint8Array([255,255,255,255]),[1,1,4]));ee.generateMipmap(),ee.minFilter=V.LINEAR_MIPMAP_LINEAR,ee.magFilter=V.LINEAR;var j=n(V),Q=n(V),K=n(V),re=n(V),ne=n(V),le=t(V,[{buffer:j,type:V.FLOAT,size:3},{buffer:ne,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Q,type:V.FLOAT,size:4},{buffer:K,type:V.FLOAT,size:2},{buffer:re,type:V.FLOAT,size:3}]),oe=n(V),de=n(V),se=n(V),me=n(V),Te=t(V,[{buffer:oe,type:V.FLOAT,size:3},{buffer:me,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:de,type:V.FLOAT,size:4},{buffer:se,type:V.FLOAT,size:2}]),_e=n(V),be=n(V),Ce=n(V),fe=n(V),ve=n(V),Me=t(V,[{buffer:_e,type:V.FLOAT,size:3},{buffer:ve,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:be,type:V.FLOAT,size:4},{buffer:Ce,type:V.FLOAT,size:2},{buffer:fe,type:V.FLOAT,size:1}]),ke=n(V),Le=t(V,[{buffer:ke,type:V.FLOAT,size:3}]),ze=new L(V,ee,G,W,te,N,B,U,j,ne,Q,K,re,le,oe,me,de,se,Te,_e,ve,be,Ce,fe,Me,ke,Le);return ze.update(X),ze}},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(g,b,y){b.exports=function(i){var u=i.gl,f=e(u,[0,0,0,1,1,0,1,1]),l=n(u,t.boxVert,t.lineFrag);return new a(i,f,l)};var e=g("gl-buffer"),n=g("gl-shader"),t=g("./shaders");function a(i,u,f){this.plot=i,this.vbo=u,this.shader=f}var r,m,o=a.prototype;o.bind=function(){var i=this.shader;this.vbo.bind(),this.shader.bind(),i.attributes.coord.pointer(),i.uniforms.screenBox=this.plot.screenBox},o.drawBox=(r=[0,0],m=[0,0],function(i,u,f,l,h){var d=this.plot,s=this.shader,x=d.gl;r[0]=i,r[1]=u,m[0]=f,m[1]=l,s.uniforms.lo=r,s.uniforms.hi=m,s.uniforms.color=h,x.drawArrays(x.TRIANGLE_STRIP,0,4)}),o.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(g,b,y){b.exports=function(d){var s=d.gl,x=e(s),c=n(s,a.gridVert,a.gridFrag),T=n(s,a.tickVert,a.gridFrag);return new r(d,x,c,T)};var e=g("gl-buffer"),n=g("gl-shader"),t=g("binary-search-bounds"),a=g("./shaders");function r(d,s,x,c){this.plot=d,this.vbo=s,this.shader=x,this.tickShader=c,this.ticks=[[],[]]}function m(d,s){return d-s}var o,i,u,f,l,h=r.prototype;h.draw=(o=[0,0],i=[0,0],u=[0,0],function(){for(var d=this.plot,s=this.vbo,x=this.shader,c=this.ticks,T=d.gl,_=d._tickBounds,w=d.dataBox,k=d.viewBox,L=d.gridLineWidth,A=d.gridLineColor,I=d.gridLineEnable,P=d.pixelRatio,S=0;S<2;++S){var E=_[S],D=_[S+2]-E,R=.5*(w[S+2]+w[S]),H=w[S+2]-w[S];i[S]=2*D/H,o[S]=2*(E-R)/H}x.bind(),s.bind(),x.attributes.dataCoord.pointer(),x.uniforms.dataShift=o,x.uniforms.dataScale=i;var V=0;for(S=0;S<2;++S){u[0]=u[1]=0,u[S]=1,x.uniforms.dataAxis=u,x.uniforms.lineWidth=L[S]/(k[S+2]-k[S])*P,x.uniforms.color=A[S];var X=6*c[S].length;I[S]&&X&&T.drawArrays(T.TRIANGLES,V,X),V+=X}}),h.drawTickMarks=function(){var d=[0,0],s=[0,0],x=[1,0],c=[0,1],T=[0,0],_=[0,0];return function(){for(var w=this.plot,k=this.vbo,L=this.tickShader,A=this.ticks,I=w.gl,P=w._tickBounds,S=w.dataBox,E=w.viewBox,D=w.pixelRatio,R=w.screenBox,H=R[2]-R[0],V=R[3]-R[1],X=E[2]-E[0],$=E[3]-E[1],G=0;G<2;++G){var W=P[G],te=P[G+2]-W,N=.5*(S[G+2]+S[G]),B=S[G+2]-S[G];s[G]=2*te/B,d[G]=2*(W-N)/B}s[0]*=X/H,d[0]*=X/H,s[1]*=$/V,d[1]*=$/V,L.bind(),k.bind(),L.attributes.dataCoord.pointer();var U=L.uniforms;U.dataShift=d,U.dataScale=s;var ee=w.tickMarkLength,j=w.tickMarkWidth,Q=w.tickMarkColor,K=6*A[0].length,re=Math.min(t.ge(A[0],(S[0]-P[0])/(P[2]-P[0]),m),A[0].length),ne=Math.min(t.gt(A[0],(S[2]-P[0])/(P[2]-P[0]),m),A[0].length),le=0+6*re,oe=6*Math.max(0,ne-re),de=Math.min(t.ge(A[1],(S[1]-P[1])/(P[3]-P[1]),m),A[1].length),se=Math.min(t.gt(A[1],(S[3]-P[1])/(P[3]-P[1]),m),A[1].length),me=K+6*de,Te=6*Math.max(0,se-de);T[0]=2*(E[0]-ee[1])/H-1,T[1]=(E[3]+E[1])/V-1,_[0]=ee[1]*D/H,_[1]=j[1]*D/V,Te&&(U.color=Q[1],U.tickScale=_,U.dataAxis=c,U.screenOffset=T,I.drawArrays(I.TRIANGLES,me,Te)),T[0]=(E[2]+E[0])/H-1,T[1]=2*(E[1]-ee[0])/V-1,_[0]=j[0]*D/H,_[1]=ee[0]*D/V,oe&&(U.color=Q[0],U.tickScale=_,U.dataAxis=x,U.screenOffset=T,I.drawArrays(I.TRIANGLES,le,oe)),T[0]=2*(E[2]+ee[3])/H-1,T[1]=(E[3]+E[1])/V-1,_[0]=ee[3]*D/H,_[1]=j[3]*D/V,Te&&(U.color=Q[3],U.tickScale=_,U.dataAxis=c,U.screenOffset=T,I.drawArrays(I.TRIANGLES,me,Te)),T[0]=(E[2]+E[0])/H-1,T[1]=2*(E[3]+ee[2])/V-1,_[0]=j[2]*D/H,_[1]=ee[2]*D/V,oe&&(U.color=Q[2],U.tickScale=_,U.dataAxis=x,U.screenOffset=T,I.drawArrays(I.TRIANGLES,le,oe))}}(),h.update=(f=[1,1,-1,-1,1,-1],l=[1,-1,1,1,-1,-1],function(d){for(var s=d.ticks,x=d.bounds,c=new Float32Array(18*(s[0].length+s[1].length)),T=(this.plot.zeroLineEnable,0),_=[[],[]],w=0;w<2;++w)for(var k=_[w],L=s[w],A=x[w],I=x[w+2],P=0;P<L.length;++P){var S=(L[P].x-A)/(I-A);k.push(S);for(var E=0;E<6;++E)c[T++]=S,c[T++]=f[E],c[T++]=l[E]}this.ticks=_,this.vbo.update(c)}),h.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(g,b,y){b.exports=function(i){var u=i.gl,f=e(u,[-1,-1,-1,1,1,-1,1,1]),l=n(u,t.lineVert,t.lineFrag);return new a(i,f,l)};var e=g("gl-buffer"),n=g("gl-shader"),t=g("./shaders");function a(i,u,f){this.plot=i,this.vbo=u,this.shader=f}var r,m,o=a.prototype;o.bind=function(){var i=this.shader;this.vbo.bind(),this.shader.bind(),i.attributes.coord.pointer(),i.uniforms.screenBox=this.plot.screenBox},o.drawLine=(r=[0,0],m=[0,0],function(i,u,f,l,h,d){var s=this.plot,x=this.shader,c=s.gl;r[0]=i,r[1]=u,m[0]=f,m[1]=l,x.uniforms.start=r,x.uniforms.end=m,x.uniforms.width=h*s.pixelRatio,x.uniforms.color=d,c.drawArrays(c.TRIANGLE_STRIP,0,4)}),o.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(g,b,y){var e=g("glslify"),n=e([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);b.exports={lineVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:n,textVert:e([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:n,gridVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:n,boxVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:231}],117:[function(g,b,y){b.exports=function(s){var x=s.gl,c=e(x),T=n(x,r.textVert,r.textFrag);return new m(s,c,T)};var e=g("gl-buffer"),n=g("gl-shader"),t=g("text-cache"),a=g("binary-search-bounds"),r=g("./shaders");function m(s,x,c){this.plot=s,this.vbo=x,this.shader=c,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var o,i,u,f,l,h,d=m.prototype;d.drawTicks=(o=[0,0],i=[0,0],u=[0,0],function(s){var x=this.plot,c=this.shader,T=this.tickX[s],_=this.tickOffset[s],w=x.gl,k=x.viewBox,L=x.dataBox,A=x.screenBox,I=x.pixelRatio,P=x.tickEnable,S=x.tickPad,E=x.tickColor,D=x.tickAngle,R=x.labelEnable,H=x.labelPad,V=x.labelColor,X=x.labelAngle,$=this.labelOffset[s],G=this.labelCount[s],W=a.lt(T,L[s]),te=a.le(T,L[s+2]);o[0]=o[1]=0,o[s]=1,i[s]=(k[2+s]+k[s])/(A[2+s]-A[s])-1;var N=2/A[2+(1^s)]-A[1^s];i[1^s]=N*k[1^s]-1,P[s]&&(i[1^s]-=N*I*S[s],W<te&&_[te]>_[W]&&(c.uniforms.dataAxis=o,c.uniforms.screenOffset=i,c.uniforms.color=E[s],c.uniforms.angle=D[s],w.drawArrays(w.TRIANGLES,_[W],_[te]-_[W]))),R[s]&&G&&(i[1^s]-=N*I*H[s],c.uniforms.dataAxis=u,c.uniforms.screenOffset=i,c.uniforms.color=V[s],c.uniforms.angle=X[s],w.drawArrays(w.TRIANGLES,$,G)),i[1^s]=N*k[2+(1^s)]-1,P[s+2]&&(i[1^s]+=N*I*S[s+2],W<te&&_[te]>_[W]&&(c.uniforms.dataAxis=o,c.uniforms.screenOffset=i,c.uniforms.color=E[s+2],c.uniforms.angle=D[s+2],w.drawArrays(w.TRIANGLES,_[W],_[te]-_[W]))),R[s+2]&&G&&(i[1^s]+=N*I*H[s+2],c.uniforms.dataAxis=u,c.uniforms.screenOffset=i,c.uniforms.color=V[s+2],c.uniforms.angle=X[s+2],w.drawArrays(w.TRIANGLES,$,G))}),d.drawTitle=function(){var s=[0,0],x=[0,0];return function(){var c=this.plot,T=this.shader,_=c.gl,w=c.screenBox,k=c.titleCenter,L=c.titleAngle,A=c.titleColor,I=c.pixelRatio;if(this.titleCount){for(var P=0;P<2;++P)x[P]=2*(k[P]*I-w[P])/(w[2+P]-w[P])-1;T.bind(),T.uniforms.dataAxis=s,T.uniforms.screenOffset=x,T.uniforms.angle=L,T.uniforms.color=A,_.drawArrays(_.TRIANGLES,this.titleOffset,this.titleCount)}}}(),d.bind=(f=[0,0],l=[0,0],h=[0,0],function(){var s=this.plot,x=this.shader,c=s._tickBounds,T=s.dataBox,_=s.screenBox,w=s.viewBox;x.bind();for(var k=0;k<2;++k){var L=c[k],A=c[k+2]-L,I=.5*(T[k+2]+T[k]),P=T[k+2]-T[k],S=w[k],E=w[k+2]-S,D=_[k],R=_[k+2]-D;l[k]=2*A/P*E/R,f[k]=2*(L-I)/P*E/R}h[1]=2*s.pixelRatio/(_[3]-_[1]),h[0]=h[1]*(_[3]-_[1])/(_[2]-_[0]),x.uniforms.dataScale=l,x.uniforms.dataShift=f,x.uniforms.textScale=h,this.vbo.bind(),x.attributes.textCoordinate.pointer()}),d.update=function(s){var x,c,T,_,w,k=[],L=s.ticks,A=s.bounds;for(w=0;w<2;++w){var I=[Math.floor(k.length/3)],P=[-1/0],S=L[w];for(x=0;x<S.length;++x){var E=S[x],D=E.x,R=E.text,H=E.font||"sans-serif";_=E.fontSize||12;for(var V=1/(A[w+2]-A[w]),X=A[w],$=R.split(`
`),G=0;G<$.length;G++)for(T=t(H,$[G]).data,c=0;c<T.length;c+=2)k.push(T[c]*_,-T[c+1]*_-G*_*1.2,(D-X)*V);I.push(Math.floor(k.length/3)),P.push(D)}this.tickOffset[w]=I,this.tickX[w]=P}for(w=0;w<2;++w){for(this.labelOffset[w]=Math.floor(k.length/3),T=t(s.labelFont[w],s.labels[w],{textAlign:"center"}).data,_=s.labelSize[w],x=0;x<T.length;x+=2)k.push(T[x]*_,-T[x+1]*_,0);this.labelCount[w]=Math.floor(k.length/3)-this.labelOffset[w]}for(this.titleOffset=Math.floor(k.length/3),T=t(s.titleFont,s.title).data,_=s.titleSize,x=0;x<T.length;x+=2)k.push(T[x]*_,-T[x+1]*_,0);this.titleCount=Math.floor(k.length/3)-this.titleOffset,this.vbo.update(k)},d.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(g,b,y){b.exports=function(f){var l=f.gl,h=e(l,[l.drawingBufferWidth,l.drawingBufferHeight]),d=new m(l,h);return d.grid=n(d),d.text=t(d),d.line=a(d),d.box=r(d),d.update(f),d};var e=g("gl-select-static"),n=g("./lib/grid"),t=g("./lib/text"),a=g("./lib/line"),r=g("./lib/box");function m(f,l){this.gl=f,this.pickBuffer=l,this.screenBox=[0,0,f.drawingBufferWidth,f.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var o=m.prototype;function i(f){for(var l=f.slice(),h=0;h<l.length;++h)l[h]=l[h].slice();return l}function u(f,l){return f.x-l.x}o.setDirty=function(){this.dirty=this.pickDirty=!0},o.setOverlayDirty=function(){this.dirty=!0},o.nextDepthValue=function(){return this._depthCounter++/65536},o.draw=function(){var f=this.gl,l=this.screenBox,h=this.viewBox,d=this.dataBox,s=this.pixelRatio,x=this.grid,c=this.line,T=this.text,_=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,f.bindFramebuffer(f.FRAMEBUFFER,null),f.enable(f.SCISSOR_TEST),f.disable(f.DEPTH_TEST),f.depthFunc(f.LESS),f.depthMask(!1),f.enable(f.BLEND),f.blendEquation(f.FUNC_ADD,f.FUNC_ADD),f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA),this.borderColor){f.scissor(l[0],l[1],l[2]-l[0],l[3]-l[1]);var w=this.borderColor;f.clearColor(w[0]*w[3],w[1]*w[3],w[2]*w[3],w[3]),f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT)}f.scissor(h[0],h[1],h[2]-h[0],h[3]-h[1]),f.viewport(h[0],h[1],h[2]-h[0],h[3]-h[1]);var k=this.backgroundColor;f.clearColor(k[0]*k[3],k[1]*k[3],k[2]*k[3],k[3]),f.clear(f.COLOR_BUFFER_BIT),x.draw();var L=this.zeroLineEnable,A=this.zeroLineColor,I=this.zeroLineWidth;if(L[0]||L[1]){c.bind();for(var P=0;P<2;++P)if(L[P]&&d[P]<=0&&d[P+2]>=0){var S=l[P]-d[P]*(l[P+2]-l[P])/(d[P+2]-d[P]);P===0?c.drawLine(S,l[1],S,l[3],I[P],A[P]):c.drawLine(l[0],S,l[2],S,I[P],A[P])}}for(P=0;P<_.length;++P)_[P].draw();f.viewport(l[0],l[1],l[2]-l[0],l[3]-l[1]),f.scissor(l[0],l[1],l[2]-l[0],l[3]-l[1]),this.grid.drawTickMarks(),c.bind();var E=this.borderLineEnable,D=this.borderLineWidth,R=this.borderLineColor;for(E[1]&&c.drawLine(h[0],h[1]-.5*D[1]*s,h[0],h[3]+.5*D[3]*s,D[1],R[1]),E[0]&&c.drawLine(h[0]-.5*D[0]*s,h[1],h[2]+.5*D[2]*s,h[1],D[0],R[0]),E[3]&&c.drawLine(h[2],h[1]-.5*D[1]*s,h[2],h[3]+.5*D[3]*s,D[3],R[3]),E[2]&&c.drawLine(h[0]-.5*D[0]*s,h[3],h[2]+.5*D[2]*s,h[3],D[2],R[2]),T.bind(),P=0;P<2;++P)T.drawTicks(P);this.titleEnable&&T.drawTitle();var H=this.overlays;for(P=0;P<H.length;++P)H[P].draw();f.disable(f.SCISSOR_TEST),f.disable(f.BLEND),f.depthMask(!0)}},o.drawPick=function(){if(!this.static){var f=this.pickBuffer;this.gl,this._pickTimeout=null,f.begin();for(var l=1,h=this.objects,d=0;d<h.length;++d)l=h[d].drawPick(l);f.end()}},o.pick=function(f,l){if(!this.static){var h=this.pixelRatio,d=this.pickPixelRatio,s=this.viewBox,x=0|Math.round((f-s[0]/h)*d),c=0|Math.round((l-s[1]/h)*d),T=this.pickBuffer.query(x,c,this.pickRadius);if(!T)return null;for(var _=T.id+(T.value[0]<<8)+(T.value[1]<<16)+(T.value[2]<<24),w=this.objects,k=0;k<w.length;++k){var L=w[k].pick(x,c,_);if(L)return L}return null}},o.setScreenBox=function(f){var l=this.screenBox,h=this.pixelRatio;l[0]=0|Math.round(f[0]*h),l[1]=0|Math.round(f[1]*h),l[2]=0|Math.round(f[2]*h),l[3]=0|Math.round(f[3]*h),this.setDirty()},o.setDataBox=function(f){var l=this.dataBox;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3])&&(l[0]=f[0],l[1]=f[1],l[2]=f[2],l[3]=f[3],this.setDirty())},o.setViewBox=function(f){var l=this.pixelRatio,h=this.viewBox;h[0]=0|Math.round(f[0]*l),h[1]=0|Math.round(f[1]*l),h[2]=0|Math.round(f[2]*l),h[3]=0|Math.round(f[3]*l);var d=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((f[2]-f[0])*d),0|Math.round((f[3]-f[1])*d)],this.setDirty()},o.update=function(f){f=f||{};var l=this.gl;this.pixelRatio=f.pixelRatio||1;var h=this.pixelRatio;this.pickPixelRatio=Math.max(h,1),this.setScreenBox(f.screenBox||[0,0,l.drawingBufferWidth/h,l.drawingBufferHeight/h]),this.screenBox,this.setViewBox(f.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/h,.125*(this.screenBox[3]-this.screenBox[1])/h,.875*(this.screenBox[2]-this.screenBox[0])/h,.875*(this.screenBox[3]-this.screenBox[1])/h]);var d=this.viewBox,s=(d[2]-d[0])/(d[3]-d[1]);this.setDataBox(f.dataBox||[-10,-10/s,10,10/s]),this.borderColor=f.borderColor!==!1&&(f.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(f.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(f.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(f.gridLineWidth||[1,1]).slice(),this.gridLineColor=i(f.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(f.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(f.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=i(f.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(f.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(f.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=i(f.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(f.titleCenter||[.5*(d[0]+d[2])/h,(d[3]+120)/h]).slice(),this.titleEnable=!("titleEnable"in f)||!!f.titleEnable,this.titleAngle=f.titleAngle||0,this.titleColor=(f.titleColor||[0,0,0,1]).slice(),this.labelPad=(f.labelPad||[15,15,15,15]).slice(),this.labelAngle=(f.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(f.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=i(f.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(f.tickPad||[15,15,15,15]).slice(),this.tickAngle=(f.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(f.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=i(f.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(f.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(f.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=i(f.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var x=f.ticks||[[],[]],c=this._tickBounds;c[0]=c[1]=1/0,c[2]=c[3]=-1/0;for(var T=0;T<2;++T){var _=x[T].slice(0);_.length!==0&&(_.sort(u),c[T]=Math.min(c[T],_[0].x),c[T+2]=Math.max(c[T+2],_[_.length-1].x))}this.grid.update({bounds:c,ticks:x}),this.text.update({bounds:c,ticks:x,labels:f.labels||["x","y"],labelSize:f.labelSize||[12,12],labelFont:f.labelFont||["sans-serif","sans-serif"],title:f.title||"",titleSize:f.titleSize||18,titleFont:f.titleFont||"sans-serif"}),this.static=!!f.static,this.setDirty()},o.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var f=this.objects.length-1;f>=0;--f)this.objects[f].dispose();for(this.objects.length=0,f=this.overlays.length-1;f>=0;--f)this.overlays[f].dispose();this.overlays.length=0,this.gl=null},o.addObject=function(f){this.objects.indexOf(f)<0&&(this.objects.push(f),this.setDirty())},o.removeObject=function(f){for(var l=this.objects,h=0;h<l.length;++h)if(l[h]===f){l.splice(h,1),this.setDirty();break}},o.addOverlay=function(f){this.overlays.indexOf(f)<0&&(this.overlays.push(f),this.setOverlayDirty())},o.removeOverlay=function(f){for(var l=this.overlays,h=0;h<l.length;++h)if(l[h]===f){l.splice(h,1),this.setOverlayDirty();break}}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(g,b,y){b.exports=function(o,i){o=o||document.body,i=i||{};var u=[.01,1/0];"distanceLimits"in i&&(u[0]=i.distanceLimits[0],u[1]=i.distanceLimits[1]),"zoomMin"in i&&(u[0]=i.zoomMin),"zoomMax"in i&&(u[1]=i.zoomMax);var f=n({center:i.center||[0,0,0],up:i.up||[0,1,0],eye:i.eye||[0,0,10],mode:i.mode||"orbit",distanceLimits:u}),l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h=0,d=o.clientWidth,s=o.clientHeight,x={keyBindingMode:"rotate",enableWheel:!0,view:f,element:o,delay:i.delay||16,rotateSpeed:i.rotateSpeed||1,zoomSpeed:i.zoomSpeed||1,translateSpeed:i.translateSpeed||1,flipX:!!i.flipX,flipY:!!i.flipY,modes:f.modes,_ortho:i._ortho||i.projection&&i.projection.type==="orthographic"||!1,tick:function(){var c=e(),T=this.delay,_=c-2*T;f.idle(c-T),f.recalcMatrix(_),f.flush(c-(100+2*T));for(var w=!0,k=f.computedMatrix,L=0;L<16;++L)w=w&&l[L]===k[L],l[L]=k[L];var A=o.clientWidth===d&&o.clientHeight===s;return d=o.clientWidth,s=o.clientHeight,w?!A:(h=Math.exp(f.computedRadius[0]),!0)},lookAt:function(c,T,_){f.lookAt(f.lastT(),c,T,_)},rotate:function(c,T,_){f.rotate(f.lastT(),c,T,_)},pan:function(c,T,_){f.pan(f.lastT(),c,T,_)},translate:function(c,T,_){f.translate(f.lastT(),c,T,_)}};return Object.defineProperties(x,{matrix:{get:function(){return f.computedMatrix},set:function(c){return f.setMatrix(f.lastT(),c),f.computedMatrix},enumerable:!0},mode:{get:function(){return f.getMode()},set:function(c){var T=f.computedUp.slice(),_=f.computedEye.slice(),w=f.computedCenter.slice();if(f.setMode(c),c==="turntable"){var k=e();f._active.lookAt(k,_,w,T),f._active.lookAt(k+500,_,w,[0,0,1]),f._active.flush(k)}return f.getMode()},enumerable:!0},center:{get:function(){return f.computedCenter},set:function(c){return f.lookAt(f.lastT(),null,c),f.computedCenter},enumerable:!0},eye:{get:function(){return f.computedEye},set:function(c){return f.lookAt(f.lastT(),c),f.computedEye},enumerable:!0},up:{get:function(){return f.computedUp},set:function(c){return f.lookAt(f.lastT(),null,null,c),f.computedUp},enumerable:!0},distance:{get:function(){return h},set:function(c){return f.setDistance(f.lastT(),c),c},enumerable:!0},distanceLimits:{get:function(){return f.getDistanceLimits(u)},set:function(c){return f.setDistanceLimits(c),c},enumerable:!0}}),o.addEventListener("contextmenu",function(c){return c.preventDefault(),!1}),x._lastX=-1,x._lastY=-1,x._lastMods={shift:!1,control:!1,alt:!1,meta:!1},x.enableMouseListeners=function(){function c(T,_,w,k){var L=x.keyBindingMode;if(L!==!1){var A=L==="rotate",I=L==="pan",P=L==="zoom",S=!!k.control,E=!!k.alt,D=!!k.shift,R=!!(1&T),H=!!(2&T),V=!!(4&T),X=1/o.clientHeight,$=X*(_-x._lastX),G=X*(w-x._lastY),W=x.flipX?1:-1,te=x.flipY?1:-1,N=Math.PI*x.rotateSpeed,B=e();if(x._lastX!==-1&&x._lastY!==-1&&((A&&R&&!S&&!E&&!D||R&&!S&&!E&&D)&&f.rotate(B,W*N*$,-te*N*G,0),(I&&R&&!S&&!E&&!D||H||R&&S&&!E&&!D)&&f.pan(B,-x.translateSpeed*$*h,x.translateSpeed*G*h,0),P&&R&&!S&&!E&&!D||V||R&&!S&&E&&!D)){var U=-x.zoomSpeed*G/window.innerHeight*(B-f.lastT())*100;f.pan(B,0,0,h*(Math.exp(U)-1))}return x._lastX=_,x._lastY=w,x._lastMods=k,!0}}x.mouseListener=t(o,c),o.addEventListener("touchstart",function(T){var _=r(T.changedTouches[0],o);c(0,_[0],_[1],x._lastMods),c(1,_[0],_[1],x._lastMods)},!!m&&{passive:!0}),o.addEventListener("touchmove",function(T){var _=r(T.changedTouches[0],o);c(1,_[0],_[1],x._lastMods),T.preventDefault()},!!m&&{passive:!1}),o.addEventListener("touchend",function(T){c(0,x._lastX,x._lastY,x._lastMods)},!!m&&{passive:!0}),x.wheelListener=a(o,function(T,_){if(x.keyBindingMode!==!1&&x.enableWheel){var w=x.flipX?1:-1,k=x.flipY?1:-1,L=e();if(Math.abs(T)>Math.abs(_))f.rotate(L,0,0,-T*w*Math.PI*x.rotateSpeed/window.innerWidth);else if(!x._ortho){var A=-x.zoomSpeed*k*_/window.innerHeight*(L-f.lastT())/20;f.pan(L,0,0,h*(Math.exp(A)-1))}}},!0)},x.enableMouseListeners(),x};var e=g("right-now"),n=g("3d-view"),t=g("mouse-change"),a=g("mouse-wheel"),r=g("mouse-event-offset"),m=g("has-passive-events")},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(g,b,y){var e=g("glslify"),n=g("gl-shader"),t=e([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),a=e([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);b.exports=function(r){return n(r,t,a,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(g,b,y){var e=g("./camera.js"),n=g("gl-axes3d"),t=g("gl-axes3d/properties"),a=g("gl-spikes3d"),r=g("gl-select-static"),m=g("gl-fbo"),o=g("a-big-triangle"),i=g("mouse-change"),u=g("gl-mat4/perspective"),f=g("gl-mat4/ortho"),l=g("./lib/shader"),h=g("is-mobile")({tablet:!0,featureDetect:!0});function d(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function s(c){var T=Math.round(Math.log(Math.abs(c))/Math.log(10));if(T<0){var _=Math.round(Math.pow(10,-T));return Math.ceil(c*_)/_}return T>0?(_=Math.round(Math.pow(10,T)),Math.ceil(c/_)*_):Math.ceil(c)}function x(c){return typeof c!="boolean"||c}b.exports={createScene:function(c){(c=c||{}).camera=c.camera||{};var T=c.canvas;T||(T=document.createElement("canvas"),c.container?c.container.appendChild(T):document.body.appendChild(T));var _=c.gl;if(_||(c.glOptions&&(h=!!c.glOptions.preserveDrawingBuffer),_=function(se,me){var Te=null;try{(Te=se.getContext("webgl",me))||(Te=se.getContext("experimental-webgl",me))}catch{return null}return Te}(T,c.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:h})),!_)throw new Error("webgl not supported");var w=c.bounds||[[-10,-10,-10],[10,10,10]],k=new d,L=m(_,_.drawingBufferWidth,_.drawingBufferHeight,{preferFloat:!h}),A=l(_),I=c.cameraObject&&c.cameraObject._ortho===!0||c.camera.projection&&c.camera.projection.type==="orthographic"||!1,P={eye:c.camera.eye||[2,0,0],center:c.camera.center||[0,0,0],up:c.camera.up||[0,1,0],zoomMin:c.camera.zoomMax||.1,zoomMax:c.camera.zoomMin||100,mode:c.camera.mode||"turntable",_ortho:I},S=c.axes||{},E=n(_,S);E.enable=!S.disable;var D=c.spikes||{},R=a(_,D),H=[],V=[],X=[],$=[],G=!0,W=!0,te=new Array(16),N=new Array(16),B={view:null,projection:te,model:N,_ortho:!1},U=(W=!0,[_.drawingBufferWidth,_.drawingBufferHeight]),ee=c.cameraObject||e(T,P),j={gl:_,contextLost:!1,pixelRatio:c.pixelRatio||1,canvas:T,selection:k,camera:ee,axes:E,axesPixels:null,spikes:R,bounds:w,objects:H,shape:U,aspect:c.aspectRatio||[1,1,1],pickRadius:c.pickRadius||10,zNear:c.zNear||.01,zFar:c.zFar||1e3,fovy:c.fovy||Math.PI/4,clearColor:c.clearColor||[0,0,0,0],autoResize:x(c.autoResize),autoBounds:x(c.autoBounds),autoScale:!!c.autoScale,autoCenter:x(c.autoCenter),clipToBounds:x(c.clipToBounds),snapToData:!!c.snapToData,onselect:c.onselect||null,onrender:c.onrender||null,onclick:c.onclick||null,cameraParams:B,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(se){this.aspect[0]=se.x,this.aspect[1]=se.y,this.aspect[2]=se.z,W=!0},setBounds:function(se,me){this.bounds[0][se]=me.min,this.bounds[1][se]=me.max},setClearColor:function(se){this.clearColor=se},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},Q=[_.drawingBufferWidth/j.pixelRatio|0,_.drawingBufferHeight/j.pixelRatio|0];function K(){if(!j._stopped&&j.autoResize){var se=T.parentNode,me=1,Te=1;se&&se!==document.body?(me=se.clientWidth,Te=se.clientHeight):(me=window.innerWidth,Te=window.innerHeight);var _e=0|Math.ceil(me*j.pixelRatio),be=0|Math.ceil(Te*j.pixelRatio);if(_e!==T.width||be!==T.height){T.width=_e,T.height=be;var Ce=T.style;Ce.position=Ce.position||"absolute",Ce.left="0px",Ce.top="0px",Ce.width=me+"px",Ce.height=Te+"px",G=!0}}}j.autoResize&&K();function re(){for(var se=H.length,me=$.length,Te=0;Te<me;++Te)X[Te]=0;e:for(Te=0;Te<se;++Te){var _e=H[Te],be=_e.pickSlots;if(be){for(var Ce=0;Ce<me;++Ce)if(X[Ce]+be<255){V[Te]=Ce,_e.setPickBase(X[Ce]+1),X[Ce]+=be;continue e}var fe=r(_,U);V[Te]=me,$.push(fe),X.push(be),_e.setPickBase(1),me+=1}else V[Te]=-1}for(;me>0&&X[me-1]===0;)X.pop(),$.pop().dispose()}function ne(){if(j.contextLost)return!0;_.isContextLost()&&(j.contextLost=!0,j.mouseListener.enabled=!1,j.selection.object=null,j.oncontextloss&&j.oncontextloss())}window.addEventListener("resize",K),j.update=function(se){j._stopped||(G=!0,W=!0)},j.add=function(se){j._stopped||(se.axes=E,H.push(se),V.push(-1),G=!0,W=!0,re())},j.remove=function(se){if(!j._stopped){var me=H.indexOf(se);me<0||(H.splice(me,1),V.pop(),G=!0,W=!0,re())}},j.dispose=function(){if(!j._stopped&&(j._stopped=!0,window.removeEventListener("resize",K),T.removeEventListener("webglcontextlost",ne),j.mouseListener.enabled=!1,!j.contextLost)){E.dispose(),R.dispose();for(var se=0;se<H.length;++se)H[se].dispose();for(L.dispose(),se=0;se<$.length;++se)$[se].dispose();A.dispose(),_=null,E=null,R=null,H=[]}},j._mouseRotating=!1,j._prevButtons=0,j.enableMouseListeners=function(){j.mouseListener=i(T,function(se,me,Te){if(!j._stopped){var _e=$.length,be=H.length,Ce=k.object;k.distance=1/0,k.mouse[0]=me,k.mouse[1]=Te,k.object=null,k.screen=null,k.dataCoordinate=k.dataPosition=null;var fe=!1;if(se&&j._prevButtons)j._mouseRotating=!0;else{j._mouseRotating&&(W=!0),j._mouseRotating=!1;for(var ve=0;ve<_e;++ve){var Me=$[ve].query(me,Q[1]-Te-1,j.pickRadius);if(Me){if(Me.distance>k.distance)continue;for(var ke=0;ke<be;++ke){var Le=H[ke];if(V[ke]===ve){var ze=Le.pick(Me);ze&&(k.buttons=se,k.screen=Me.coord,k.distance=Me.distance,k.object=Le,k.index=ze.distance,k.dataPosition=ze.position,k.dataCoordinate=ze.dataCoordinate,k.data=ze,fe=!0)}}}}}Ce&&Ce!==k.object&&(Ce.highlight&&Ce.highlight(null),G=!0),k.object&&(k.object.highlight&&k.object.highlight(k.data),G=!0),(fe=fe||k.object!==Ce)&&j.onselect&&j.onselect(k),1&se&&!(1&j._prevButtons)&&j.onclick&&j.onclick(k),j._prevButtons=se}})},T.addEventListener("webglcontextlost",ne);var le=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],oe=[le[0].slice(),le[1].slice()];function de(){if(!ne()){K();var se=j.camera.tick();B.view=j.camera.matrix,G=G||se,W=W||se,E.pixelRatio=j.pixelRatio,R.pixelRatio=j.pixelRatio;var me=H.length,Te=le[0],_e=le[1];Te[0]=Te[1]=Te[2]=1/0,_e[0]=_e[1]=_e[2]=-1/0;for(var be=0;be<me;++be){(Ie=H[be]).pixelRatio=j.pixelRatio,Ie.axes=j.axes,G=G||!!Ie.dirty,W=W||!!Ie.dirty;var Ce=Ie.bounds;if(Ce)for(var fe=Ce[0],ve=Ce[1],Me=0;Me<3;++Me)Te[Me]=Math.min(Te[Me],fe[Me]),_e[Me]=Math.max(_e[Me],ve[Me])}var ke=j.bounds;if(j.autoBounds)for(Me=0;Me<3;++Me){if(_e[Me]<Te[Me])Te[Me]=-1,_e[Me]=1;else{Te[Me]===_e[Me]&&(Te[Me]-=1,_e[Me]+=1);var Le=.05*(_e[Me]-Te[Me]);Te[Me]=Te[Me]-Le,_e[Me]=_e[Me]+Le}ke[0][Me]=Te[Me],ke[1][Me]=_e[Me]}var ze=!1;for(Me=0;Me<3;++Me)ze=ze||oe[0][Me]!==ke[0][Me]||oe[1][Me]!==ke[1][Me],oe[0][Me]=ke[0][Me],oe[1][Me]=ke[1][Me];if(W=W||ze,G=G||ze){if(ze){var Re=[0,0,0];for(be=0;be<3;++be)Re[be]=s((ke[1][be]-ke[0][be])/10);E.autoTicks?E.update({bounds:ke,tickSpacing:Re}):E.update({bounds:ke})}var Oe=_.drawingBufferWidth,Ze=_.drawingBufferHeight;for(U[0]=Oe,U[1]=Ze,Q[0]=0|Math.max(Oe/j.pixelRatio,1),Q[1]=0|Math.max(Ze/j.pixelRatio,1),function(Be,Fe){var $e=Be.bounds,ot=Be.cameraParams,pt=ot.projection,_t=ot.model,yt=Be.gl.drawingBufferWidth,tt=Be.gl.drawingBufferHeight,Ke=Be.zNear,vt=Be.zFar,Nt=Be.fovy,qt=yt/tt;Fe?(f(pt,-qt,qt,-1,1,Ke,vt),ot._ortho=!0):(u(pt,Nt,qt,Ke,vt),ot._ortho=!1);for(var er=0;er<16;++er)_t[er]=0;_t[15]=1;var Jt=0;for(er=0;er<3;++er)Jt=Math.max(Jt,$e[1][er]-$e[0][er]);for(er=0;er<3;++er)Be.autoScale?_t[5*er]=Be.aspect[er]/($e[1][er]-$e[0][er]):_t[5*er]=1/Jt,Be.autoCenter&&(_t[12+er]=.5*-_t[5*er]*($e[0][er]+$e[1][er]))}(j,I),be=0;be<me;++be)(Ie=H[be]).axesBounds=ke,j.clipToBounds&&(Ie.clipBounds=ke);k.object&&(j.snapToData?R.position=k.dataCoordinate:R.position=k.dataPosition,R.bounds=ke),W&&(W=!1,function(){if(!ne()){_.colorMask(!0,!0,!0,!0),_.depthMask(!0),_.disable(_.BLEND),_.enable(_.DEPTH_TEST),_.depthFunc(_.LEQUAL);for(var Be=H.length,Fe=$.length,$e=0;$e<Fe;++$e){var ot=$[$e];ot.shape=Q,ot.begin();for(var pt=0;pt<Be;++pt)if(V[pt]===$e){var _t=H[pt];_t.drawPick&&(_t.pixelRatio=1,_t.drawPick(B))}ot.end()}}}()),j.axesPixels=t(j.axes,B,Oe,Ze),j.onrender&&j.onrender(),_.bindFramebuffer(_.FRAMEBUFFER,null),_.viewport(0,0,Oe,Ze),j.clearRGBA(),_.depthMask(!0),_.colorMask(!0,!0,!0,!0),_.enable(_.DEPTH_TEST),_.depthFunc(_.LEQUAL),_.disable(_.BLEND),_.disable(_.CULL_FACE);var Pe=!1;for(E.enable&&(Pe=Pe||E.isTransparent(),E.draw(B)),R.axes=E,k.object&&R.draw(B),_.disable(_.CULL_FACE),be=0;be<me;++be)(Ie=H[be]).axes=E,Ie.pixelRatio=j.pixelRatio,Ie.isOpaque&&Ie.isOpaque()&&Ie.draw(B),Ie.isTransparent&&Ie.isTransparent()&&(Pe=!0);if(Pe){for(L.shape=U,L.bind(),_.clear(_.DEPTH_BUFFER_BIT),_.colorMask(!1,!1,!1,!1),_.depthMask(!0),_.depthFunc(_.LESS),E.enable&&E.isTransparent()&&E.drawTransparent(B),be=0;be<me;++be)(Ie=H[be]).isOpaque&&Ie.isOpaque()&&Ie.draw(B);for(_.enable(_.BLEND),_.blendEquation(_.FUNC_ADD),_.blendFunc(_.ONE,_.ONE_MINUS_SRC_ALPHA),_.colorMask(!0,!0,!0,!0),_.depthMask(!1),_.clearColor(0,0,0,0),_.clear(_.COLOR_BUFFER_BIT),E.isTransparent()&&E.drawTransparent(B),be=0;be<me;++be){var Ie;(Ie=H[be]).isTransparent&&Ie.isTransparent()&&Ie.drawTransparent(B)}_.bindFramebuffer(_.FRAMEBUFFER,null),_.blendFunc(_.ONE,_.ONE_MINUS_SRC_ALPHA),_.disable(_.DEPTH_TEST),A.bind(),L.color[0].bind(0),A.uniforms.accumBuffer=0,o(_),_.disable(_.BLEND)}for(G=!1,be=0;be<me;++be)H[be].dirty=!1}}}return j.enableMouseListeners(),function se(){j._stopped||j.contextLost||(de(),requestAnimationFrame(se))}(),j.redraw=function(){j._stopped||(G=!0,de())},j},createCamera:e}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(g,b,y){var e=g("glslify");y.pointVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),y.pointFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),y.pickVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),y.pickFragment=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:231}],123:[function(g,b,y){var e=g("gl-shader"),n=g("gl-buffer"),t=g("typedarray-pool"),a=g("./lib/shader");function r(u,f,l,h,d){this.plot=u,this.offsetBuffer=f,this.pickBuffer=l,this.shader=h,this.pickShader=d,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}b.exports=function(u,f){var l=u.gl,h=n(l),d=n(l),s=e(l,a.pointVertex,a.pointFragment),x=e(l,a.pickVertex,a.pickFragment),c=new r(u,h,d,s,x);return c.update(f),u.addObject(c),c};var m,o,i=r.prototype;i.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},i.update=function(u){var f;function l(_,w){return _ in u?u[_]:w}u=u||{},this.sizeMin=l("sizeMin",.5),this.sizeMax=l("sizeMax",20),this.color=l("color",[1,0,0,1]).slice(),this.areaRatio=l("areaRatio",1),this.borderColor=l("borderColor",[0,0,0,1]).slice(),this.blend=l("blend",!1);var h=u.positions.length>>>1,d=u.positions instanceof Float32Array,s=u.idToIndex instanceof Int32Array&&u.idToIndex.length>=h,x=u.positions,c=d?x:t.mallocFloat32(x.length),T=s?u.idToIndex:t.mallocInt32(h);if(d||c.set(x),!s)for(c.set(x),f=0;f<h;f++)T[f]=f;this.points=x,this.offsetBuffer.update(c),this.pickBuffer.update(T),d||t.free(c),s||t.free(T),this.pointCount=h,this.pickOffset=0},i.unifiedDraw=(m=[1,0,0,0,1,0,0,0,1],o=[0,0,0,0],function(u){var f=u!==void 0,l=f?this.pickShader:this.shader,h=this.plot.gl,d=this.plot.dataBox;if(this.pointCount===0)return u;var s=d[2]-d[0],x=d[3]-d[1],c=function(k,L){var A,I=0,P=k.length>>>1;for(A=0;A<P;A++){var S=k[2*A],E=k[2*A+1];S>=L[0]&&S<=L[2]&&E>=L[1]&&E<=L[3]&&I++}return I}(this.points,d),T=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(c,.33333)));m[0]=2/s,m[4]=2/x,m[6]=-2*d[0]/s-1,m[7]=-2*d[1]/x-1,this.offsetBuffer.bind(),l.bind(),l.attributes.position.pointer(),l.uniforms.matrix=m,l.uniforms.color=this.color,l.uniforms.borderColor=this.borderColor,l.uniforms.pointCloud=T<5,l.uniforms.pointSize=T,l.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),f&&(o[0]=255&u,o[1]=u>>8&255,o[2]=u>>16&255,o[3]=u>>24&255,this.pickBuffer.bind(),l.attributes.pickId.pointer(h.UNSIGNED_BYTE),l.uniforms.pickOffset=o,this.pickOffset=u);var _=h.getParameter(h.BLEND),w=h.getParameter(h.DITHER);return _&&!this.blend&&h.disable(h.BLEND),w&&h.disable(h.DITHER),h.drawArrays(h.POINTS,0,this.pointCount),_&&!this.blend&&h.enable(h.BLEND),w&&h.enable(h.DITHER),u+this.pointCount}),i.draw=i.unifiedDraw,i.drawPick=i.unifiedDraw,i.pick=function(u,f,l){var h=this.pickOffset,d=this.pointCount;if(l<h||l>=h+d)return null;var s=l-h,x=this.points;return{object:this,pointId:s,dataCoord:[x[2*s],x[2*s+1]]}}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(g,b,y){b.exports=function(e,n,t,a){var r,m,o,i,u,f=n[0],l=n[1],h=n[2],d=n[3],s=t[0],x=t[1],c=t[2],T=t[3];return(m=f*s+l*x+h*c+d*T)<0&&(m=-m,s=-s,x=-x,c=-c,T=-T),1-m>1e-6?(r=Math.acos(m),o=Math.sin(r),i=Math.sin((1-a)*r)/o,u=Math.sin(a*r)/o):(i=1-a,u=a),e[0]=i*f+u*s,e[1]=i*l+u*x,e[2]=i*h+u*c,e[3]=i*d+u*T,e}},{}],125:[function(g,b,y){b.exports=function(e){return e||e===0?e.toString():""}},{}],126:[function(g,b,y){var e=g("vectorize-text");b.exports=function(t,a,r){var m=n[a];if(m||(m=n[a]={}),t in m)return m[t];var o={textAlign:"center",textBaseline:"middle",lineHeight:1,font:a,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},i=e(t,o);o.triangles=!1;var u,f,l=e(t,o);if(r&&r!==1){for(u=0;u<i.positions.length;++u)for(f=0;f<i.positions[u].length;++f)i.positions[u][f]/=r;for(u=0;u<l.positions.length;++u)for(f=0;f<l.positions[u].length;++f)l.positions[u][f]/=r}var h=[[1/0,1/0],[-1/0,-1/0]],d=l.positions.length;for(u=0;u<d;++u){var s=l.positions[u];for(f=0;f<2;++f)h[0][f]=Math.min(h[0][f],s[f]),h[1][f]=Math.max(h[1][f],s[f])}return m[t]=[i,l,h]};var n={}},{"vectorize-text":311}],127:[function(g,b,y){var e=g("gl-shader"),n=g("glslify"),t=n([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),a=n([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),r=n([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),m=n([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),o=n([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),i=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],u={vertex:t,fragment:m,attributes:i},f={vertex:a,fragment:m,attributes:i},l={vertex:r,fragment:m,attributes:i},h={vertex:t,fragment:o,attributes:i},d={vertex:a,fragment:o,attributes:i},s={vertex:r,fragment:o,attributes:i};function x(c,T){var _=e(c,T),w=_.attributes;return w.position.location=0,w.color.location=1,w.glyph.location=2,w.id.location=3,_}y.createPerspective=function(c){return x(c,u)},y.createOrtho=function(c){return x(c,f)},y.createProject=function(c){return x(c,l)},y.createPickPerspective=function(c){return x(c,h)},y.createPickOrtho=function(c){return x(c,d)},y.createPickProject=function(c){return x(c,s)}},{"gl-shader":132,glslify:231}],128:[function(g,b,y){var e=g("is-string-blank"),n=g("gl-buffer"),t=g("gl-vao"),a=g("typedarray-pool"),r=g("gl-mat4/multiply"),m=g("./lib/shaders"),o=g("./lib/glyphs"),i=g("./lib/get-simple-string"),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function f(X,$){var G=X[0],W=X[1],te=X[2],N=X[3];return X[0]=$[0]*G+$[4]*W+$[8]*te+$[12]*N,X[1]=$[1]*G+$[5]*W+$[9]*te+$[13]*N,X[2]=$[2]*G+$[6]*W+$[10]*te+$[14]*N,X[3]=$[3]*G+$[7]*W+$[11]*te+$[15]*N,X}function l(X,$,G,W){return f(W,W),f(W,W),f(W,W)}function h(X,$){this.index=X,this.dataCoordinate=this.position=$}function d(X){return X===!0||X>1?1:X}function s(X,$,G,W,te,N,B,U,ee,j,Q,K){this.gl=X,this.pixelRatio=1,this.shader=$,this.orthoShader=G,this.projectShader=W,this.pointBuffer=te,this.colorBuffer=N,this.glyphBuffer=B,this.idBuffer=U,this.vao=ee,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=j,this.pickOrthoShader=Q,this.pickProjectShader=K,this.points=[],this._selectResult=new h(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}b.exports=function(X){var $=X.gl,G=m.createPerspective($),W=m.createOrtho($),te=m.createProject($),N=m.createPickPerspective($),B=m.createPickOrtho($),U=m.createPickProject($),ee=n($),j=n($),Q=n($),K=n($),re=t($,[{buffer:ee,size:3,type:$.FLOAT},{buffer:j,size:4,type:$.FLOAT},{buffer:Q,size:2,type:$.FLOAT},{buffer:K,size:4,type:$.UNSIGNED_BYTE,normalized:!0}]),ne=new s($,G,W,te,ee,j,Q,K,re,N,B,U);return ne.update(X),ne};var x=s.prototype;x.pickSlots=1,x.setPickBase=function(X){this.pickId=X},x.isTransparent=function(){if(this.hasAlpha)return!0;for(var X=0;X<3;++X)if(this.axesProject[X]&&this.projectHasAlpha)return!0;return!1},x.isOpaque=function(){if(!this.hasAlpha)return!0;for(var X=0;X<3;++X)if(this.axesProject[X]&&!this.projectHasAlpha)return!0;return!1};var c=[0,0],T=[0,0,0],_=[0,0,0],w=[0,0,0,1],k=[0,0,0,1],L=u.slice(),A=[0,0,0],I=[[0,0,0],[0,0,0]];function P(X){return X[0]=X[1]=X[2]=0,X}function S(X,$){return X[0]=$[0],X[1]=$[1],X[2]=$[2],X[3]=1,X}function E(X,$,G,W){return X[0]=$[0],X[1]=$[1],X[2]=$[2],X[G]=W,X}function D(X,$,G,W){var te,N=$.axesProject,B=$.gl,U=X.uniforms,ee=G.model||u,j=G.view||u,Q=G.projection||u,K=$.axesBounds,re=function(ke){for(var Le=I,ze=0;ze<2;++ze)for(var Re=0;Re<3;++Re)Le[ze][Re]=Math.max(Math.min(ke[ze][Re],1e8),-1e8);return Le}($.clipBounds);te=$.axes&&$.axes.lastCubeProps?$.axes.lastCubeProps.axis:[1,1,1],c[0]=2/B.drawingBufferWidth,c[1]=2/B.drawingBufferHeight,X.bind(),U.view=j,U.projection=Q,U.screenSize=c,U.highlightId=$.highlightId,U.highlightScale=$.highlightScale,U.clipBounds=re,U.pickGroup=$.pickId/255,U.pixelRatio=W;for(var ne=0;ne<3;++ne)if(N[ne]){U.scale=$.projectScale[ne],U.opacity=$.projectOpacity[ne];for(var le=L,oe=0;oe<16;++oe)le[oe]=0;for(oe=0;oe<4;++oe)le[5*oe]=1;le[5*ne]=0,te[ne]<0?le[12+ne]=K[0][ne]:le[12+ne]=K[1][ne],r(le,ee,le),U.model=le;var de=(ne+1)%3,se=(ne+2)%3,me=P(T),Te=P(_);me[de]=1,Te[se]=1;var _e=l(0,0,0,S(w,me)),be=l(0,0,0,S(k,Te));if(Math.abs(_e[1])>Math.abs(be[1])){var Ce=_e;_e=be,be=Ce,Ce=me,me=Te,Te=Ce;var fe=de;de=se,se=fe}_e[0]<0&&(me[de]=-1),be[1]>0&&(Te[se]=-1);var ve=0,Me=0;for(oe=0;oe<4;++oe)ve+=Math.pow(ee[4*de+oe],2),Me+=Math.pow(ee[4*se+oe],2);me[de]/=Math.sqrt(ve),Te[se]/=Math.sqrt(Me),U.axes[0]=me,U.axes[1]=Te,U.fragClipBounds[0]=E(A,re[0],ne,-1e8),U.fragClipBounds[1]=E(A,re[1],ne,1e8),$.vao.bind(),$.vao.draw(B.TRIANGLES,$.vertexCount),$.lineWidth>0&&(B.lineWidth($.lineWidth*W),$.vao.draw(B.LINES,$.lineVertexCount,$.vertexCount)),$.vao.unbind()}}var R=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function H(X,$,G,W,te,N,B){var U=G.gl;if((N===G.projectHasAlpha||B)&&D($,G,W,te),N===G.hasAlpha||B){X.bind();var ee=X.uniforms;ee.model=W.model||u,ee.view=W.view||u,ee.projection=W.projection||u,c[0]=2/U.drawingBufferWidth,c[1]=2/U.drawingBufferHeight,ee.screenSize=c,ee.highlightId=G.highlightId,ee.highlightScale=G.highlightScale,ee.fragClipBounds=R,ee.clipBounds=G.axes.bounds,ee.opacity=G.opacity,ee.pickGroup=G.pickId/255,ee.pixelRatio=te,G.vao.bind(),G.vao.draw(U.TRIANGLES,G.vertexCount),G.lineWidth>0&&(U.lineWidth(G.lineWidth*te),G.vao.draw(U.LINES,G.lineVertexCount,G.vertexCount)),G.vao.unbind()}}function V(X,$,G,W){var te;te=Array.isArray(X)?$<X.length?X[$]:void 0:X,te=i(te);var N=!0;e(te)&&(te="\u25BC",N=!1);var B=o(te,G,W);return{mesh:B[0],lines:B[1],bounds:B[2],visible:N}}x.draw=function(X){H(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,X,this.pixelRatio,!1,!1)},x.drawTransparent=function(X){H(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,X,this.pixelRatio,!0,!1)},x.drawPick=function(X){H(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,X,1,!0,!0)},x.pick=function(X){if(!X||X.id!==this.pickId)return null;var $=X.value[2]+(X.value[1]<<8)+(X.value[0]<<16);if($>=this.pointCount||$<0)return null;var G=this.points[$],W=this._selectResult;W.index=$;for(var te=0;te<3;++te)W.position[te]=W.dataCoordinate[te]=G[te];return W},x.highlight=function(X){if(X){var $=X.index,G=255&$,W=$>>8&255,te=$>>16&255;this.highlightId=[G/255,W/255,te/255,0]}else this.highlightId=[1,1,1,1]},x.update=function(X){if("perspective"in(X=X||{})&&(this.useOrtho=!X.perspective),"orthographic"in X&&(this.useOrtho=!!X.orthographic),"lineWidth"in X&&(this.lineWidth=X.lineWidth),"project"in X)if(Array.isArray(X.project))this.axesProject=X.project;else{var $=!!X.project;this.axesProject=[$,$,$]}if("projectScale"in X)if(Array.isArray(X.projectScale))this.projectScale=X.projectScale.slice();else{var G=+X.projectScale;this.projectScale=[G,G,G]}if(this.projectHasAlpha=!1,"projectOpacity"in X){Array.isArray(X.projectOpacity)?this.projectOpacity=X.projectOpacity.slice():(G=+X.projectOpacity,this.projectOpacity=[G,G,G]);for(var W=0;W<3;++W)this.projectOpacity[W]=d(this.projectOpacity[W]),this.projectOpacity[W]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in X&&(this.opacity=d(X.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var te,N,B=X.position,U=X.font||"normal",ee=X.alignment||[0,0];if(ee.length===2)te=ee[0],N=ee[1];else for(te=[],N=[],W=0;W<ee.length;++W)te[W]=ee[W][0],N[W]=ee[W][1];var j=[1/0,1/0,1/0],Q=[-1/0,-1/0,-1/0],K=X.glyph,re=X.color,ne=X.size,le=X.angle,oe=X.lineColor,de=-1,se=0,me=0,Te=0;if(B.length){Te=B.length;e:for(W=0;W<Te;++W){for(var _e=B[W],be=0;be<3;++be)if(isNaN(_e[be])||!isFinite(_e[be]))continue e;var Ce=($e=V(K,W,U,this.pixelRatio)).mesh,fe=$e.lines,ve=$e.bounds;se+=3*Ce.cells.length,me+=2*fe.edges.length}}var Me=se+me,ke=a.mallocFloat(3*Me),Le=a.mallocFloat(4*Me),ze=a.mallocFloat(2*Me),Re=a.mallocUint32(Me);if(Me>0){var Oe=0,Ze=se,Pe=[0,0,0,1],Ie=[0,0,0,1],Be=Array.isArray(re)&&Array.isArray(re[0]),Fe=Array.isArray(oe)&&Array.isArray(oe[0]);e:for(W=0;W<Te;++W){for(de+=1,_e=B[W],be=0;be<3;++be){if(isNaN(_e[be])||!isFinite(_e[be]))continue e;Q[be]=Math.max(Q[be],_e[be]),j[be]=Math.min(j[be],_e[be])}Ce=($e=V(K,W,U,this.pixelRatio)).mesh,fe=$e.lines,ve=$e.bounds;var $e,ot=$e.visible;if(ot)if(Array.isArray(re)){if((pt=Be?W<re.length?re[W]:[0,0,0,0]:re).length===3){for(be=0;be<3;++be)Pe[be]=pt[be];Pe[3]=1}else if(pt.length===4){for(be=0;be<4;++be)Pe[be]=pt[be];!this.hasAlpha&&pt[3]<1&&(this.hasAlpha=!0)}}else Pe[0]=Pe[1]=Pe[2]=0,Pe[3]=1;else Pe=[1,1,1,0];if(ot)if(Array.isArray(oe)){var pt;if((pt=Fe?W<oe.length?oe[W]:[0,0,0,0]:oe).length===3){for(be=0;be<3;++be)Ie[be]=pt[be];Ie[be]=1}else if(pt.length===4){for(be=0;be<4;++be)Ie[be]=pt[be];!this.hasAlpha&&pt[3]<1&&(this.hasAlpha=!0)}}else Ie[0]=Ie[1]=Ie[2]=0,Ie[3]=1;else Ie=[1,1,1,0];var _t=.5;ot?Array.isArray(ne)?_t=W<ne.length?+ne[W]:12:ne?_t=+ne:this.useOrtho&&(_t=12):_t=0;var yt=0;Array.isArray(le)?yt=W<le.length?+le[W]:0:le&&(yt=+le);var tt=Math.cos(yt),Ke=Math.sin(yt);for(_e=B[W],be=0;be<3;++be)Q[be]=Math.max(Q[be],_e[be]),j[be]=Math.min(j[be],_e[be]);var vt=te,Nt=N;vt=0,Array.isArray(te)?vt=W<te.length?te[W]:0:te&&(vt=te),Nt=0,Array.isArray(N)?Nt=W<N.length?N[W]:0:N&&(Nt=N);var qt=[vt*=vt>0?1-ve[0][0]:vt<0?1+ve[1][0]:1,Nt*=Nt>0?1-ve[0][1]:Nt<0?1+ve[1][1]:1],er=Ce.cells||[],Jt=Ce.positions||[];for(be=0;be<er.length;++be)for(var ir=er[be],Ht=0;Ht<3;++Ht){for(var Ue=0;Ue<3;++Ue)ke[3*Oe+Ue]=_e[Ue];for(Ue=0;Ue<4;++Ue)Le[4*Oe+Ue]=Pe[Ue];Re[Oe]=de;var We=Jt[ir[Ht]];ze[2*Oe]=_t*(tt*We[0]-Ke*We[1]+qt[0]),ze[2*Oe+1]=_t*(Ke*We[0]+tt*We[1]+qt[1]),Oe+=1}for(er=fe.edges,Jt=fe.positions,be=0;be<er.length;++be)for(ir=er[be],Ht=0;Ht<2;++Ht){for(Ue=0;Ue<3;++Ue)ke[3*Ze+Ue]=_e[Ue];for(Ue=0;Ue<4;++Ue)Le[4*Ze+Ue]=Ie[Ue];Re[Ze]=de,We=Jt[ir[Ht]],ze[2*Ze]=_t*(tt*We[0]-Ke*We[1]+qt[0]),ze[2*Ze+1]=_t*(Ke*We[0]+tt*We[1]+qt[1]),Ze+=1}}}this.bounds=[j,Q],this.points=B,this.pointCount=B.length,this.vertexCount=se,this.lineVertexCount=me,this.pointBuffer.update(ke),this.colorBuffer.update(Le),this.glyphBuffer.update(ze),this.idBuffer.update(Re),a.free(ke),a.free(Le),a.free(ze),a.free(Re)},x.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(g,b,y){var e=g("glslify");y.boxVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),y.boxFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:231}],130:[function(g,b,y){var e=g("gl-shader"),n=g("gl-buffer"),t=g("./lib/shaders");function a(m,o,i){this.plot=m,this.boxBuffer=o,this.boxShader=i,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}b.exports=function(m,o){var i=m.gl,u=n(i,[0,0,0,1,1,0,1,1]),f=e(i,t.boxVertex,t.boxFragment),l=new a(m,u,f);return l.update(o),m.addOverlay(l),l};var r=a.prototype;r.draw=function(){if(this.enabled){var m=this.plot,o=this.selectBox,i=this.borderWidth,u=(this.innerFill,this.innerColor),f=(this.outerFill,this.outerColor),l=this.borderColor,h=m.box,d=m.screenBox,s=m.dataBox,x=m.viewBox,c=m.pixelRatio,T=(o[0]-s[0])*(x[2]-x[0])/(s[2]-s[0])+x[0],_=(o[1]-s[1])*(x[3]-x[1])/(s[3]-s[1])+x[1],w=(o[2]-s[0])*(x[2]-x[0])/(s[2]-s[0])+x[0],k=(o[3]-s[1])*(x[3]-x[1])/(s[3]-s[1])+x[1];if(T=Math.max(T,x[0]),_=Math.max(_,x[1]),w=Math.min(w,x[2]),k=Math.min(k,x[3]),!(w<T||k<_)){h.bind();var L=d[2]-d[0],A=d[3]-d[1];if(this.outerFill&&(h.drawBox(0,0,L,_,f),h.drawBox(0,_,T,k,f),h.drawBox(0,k,L,A,f),h.drawBox(w,_,L,k,f)),this.innerFill&&h.drawBox(T,_,w,k,u),i>0){var I=i*c;h.drawBox(T-I,_-I,w+I,_+I,l),h.drawBox(T-I,k-I,w+I,k+I,l),h.drawBox(T-I,_-I,T+I,k+I,l),h.drawBox(w-I,_-I,w+I,k+I,l)}}}},r.update=function(m){m=m||{},this.innerFill=!!m.innerFill,this.outerFill=!!m.outerFill,this.innerColor=(m.innerColor||[0,0,0,.5]).slice(),this.outerColor=(m.outerColor||[0,0,0,.5]).slice(),this.borderColor=(m.borderColor||[0,0,0,1]).slice(),this.borderWidth=m.borderWidth||0,this.selectBox=(m.selectBox||this.selectBox).slice()},r.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(g,b,y){b.exports=function(i,u){var f=u[0],l=u[1],h=e(i,f,l,{}),d=n.mallocUint8(f*l*4);return new m(i,h,d)};var e=g("gl-fbo"),n=g("typedarray-pool"),t=g("ndarray"),a=g("bit-twiddle").nextPow2;function r(i,u,f,l,h){this.coord=[i,u],this.id=f,this.value=l,this.distance=h}function m(i,u,f){this.gl=i,this.fbo=u,this.buffer=f,this._readTimeout=null;var l=this;this._readCallback=function(){l.gl&&(u.bind(),i.readPixels(0,0,u.shape[0],u.shape[1],i.RGBA,i.UNSIGNED_BYTE,l.buffer),l._readTimeout=null)}}var o=m.prototype;Object.defineProperty(o,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(i){if(this.gl){this.fbo.shape=i;var u=this.fbo.shape[0],f=this.fbo.shape[1];if(f*u*4>this.buffer.length){n.free(this.buffer);for(var l=this.buffer=n.mallocUint8(a(f*u*4)),h=0;h<f*u*4;++h)l[h]=255}return i}}}),o.begin=function(){var i=this.gl;this.shape,i&&(this.fbo.bind(),i.clearColor(1,1,1,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT))},o.end=function(){var i=this.gl;i&&(i.bindFramebuffer(i.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},o.query=function(i,u,f){if(!this.gl)return null;var l=this.fbo.shape.slice();i|=0,u|=0,typeof f!="number"&&(f=1);var h=0|Math.min(Math.max(i-f,0),l[0]),d=0|Math.min(Math.max(i+f,0),l[0]),s=0|Math.min(Math.max(u-f,0),l[1]),x=0|Math.min(Math.max(u+f,0),l[1]);if(d<=h||x<=s)return null;var c=[d-h,x-s],T=t(this.buffer,[c[0],c[1],4],[4,4*l[0],1],4*(h+l[0]*s)),_=function(L,A,I){for(var P=1e8,S=-1,E=-1,D=L.shape[0],R=L.shape[1],H=0;H<D;H++)for(var V=0;V<R;V++){var X=L.get(H,V,0),$=L.get(H,V,1),G=L.get(H,V,2),W=L.get(H,V,3);if(X<255||$<255||G<255||W<255){var te=A-H,N=I-V,B=te*te+N*N;B<P&&(P=B,S=H,E=V)}}return[S,E,P]}(T.hi(c[0],c[1],1),f,f),w=_[0],k=_[1];return w<0||Math.pow(this.radius,2)<_[2]?null:new r(w+h|0,k+s|0,T.get(w,k,0),[T.get(w,k,1),T.get(w,k,2),T.get(w,k,3)],Math.sqrt(_[2]))},o.dispose=function(){this.gl&&(this.fbo.dispose(),n.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(g,b,y){var e=g("./lib/create-uniforms"),n=g("./lib/create-attributes"),t=g("./lib/reflect"),a=g("./lib/shader-cache"),r=g("./lib/runtime-reflect"),m=g("./lib/GLError");function o(f){this.gl=f,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var i=o.prototype;function u(f,l){return f.name<l.name?-1:1}i.bind=function(){var f;this.program||this._relink();var l=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),h=this.gl.lastAttribCount;if(l>h)for(f=h;f<l;f++)this.gl.enableVertexAttribArray(f);else if(h>l)for(f=l;f<h;f++)this.gl.disableVertexAttribArray(f);this.gl.lastAttribCount=l,this.gl.useProgram(this.program)},i.dispose=function(){for(var f=this.gl.lastAttribCount,l=0;l<f;l++)this.gl.disableVertexAttribArray(l);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},i.update=function(f,l,h,d){if(!l||arguments.length===1){var s=f;f=s.vertex,l=s.fragment,h=s.uniforms,d=s.attributes}var x=this,c=x.gl,T=x._vref;x._vref=a.shader(c,c.VERTEX_SHADER,f),T&&T.dispose(),x.vertShader=x._vref.shader;var _=this._fref;if(x._fref=a.shader(c,c.FRAGMENT_SHADER,l),_&&_.dispose(),x.fragShader=x._fref.shader,!h||!d){var w=c.createProgram();if(c.attachShader(w,x.fragShader),c.attachShader(w,x.vertShader),c.linkProgram(w),!c.getProgramParameter(w,c.LINK_STATUS)){var k=c.getProgramInfoLog(w);throw new m(k,"Error linking program:"+k)}h=h||r.uniforms(c,w),d=d||r.attributes(c,w),c.deleteProgram(w)}(d=d.slice()).sort(u);var L,A=[],I=[],P=[];for(L=0;L<d.length;++L){var S=d[L];if(S.type.indexOf("mat")>=0){for(var E=0|S.type.charAt(S.type.length-1),D=new Array(E),R=0;R<E;++R)D[R]=P.length,I.push(S.name+"["+R+"]"),typeof S.location=="number"?P.push(S.location+R):Array.isArray(S.location)&&S.location.length===E&&typeof S.location[R]=="number"?P.push(0|S.location[R]):P.push(-1);A.push({name:S.name,type:S.type,locations:D})}else A.push({name:S.name,type:S.type,locations:[P.length]}),I.push(S.name),typeof S.location=="number"?P.push(0|S.location):P.push(-1)}var H=0;for(L=0;L<P.length;++L)if(P[L]<0){for(;P.indexOf(H)>=0;)H+=1;P[L]=H}var V=new Array(h.length);function X(){x.program=a.program(c,x._vref,x._fref,I,P);for(var $=0;$<h.length;++$)V[$]=c.getUniformLocation(x.program,h[$].name)}X(),x._relink=X,x.types={uniforms:t(h),attributes:t(d)},x.attributes=n(c,x,A,P),Object.defineProperty(x,"uniforms",e(c,x,h,V))},b.exports=function(f,l,h,d,s){var x=new o(f);return x.update(l,h,d,s),x}},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(g,b,y){function e(n,t,a){this.shortMessage=t||"",this.longMessage=a||"",this.rawError=n||"",this.message="gl-shader: "+(t||n||"")+(a?`
`+a:""),this.stack=new Error().stack}e.prototype=new Error,e.prototype.name="GLError",e.prototype.constructor=e,b.exports=e},{}],134:[function(g,b,y){b.exports=function(o,i,u,f){for(var l={},h=0,d=u.length;h<d;++h){var s=u[h],x=s.name,c=s.type,T=s.locations;switch(c){case"bool":case"int":case"float":r(o,i,T[0],f,1,l,x);break;default:if(c.indexOf("vec")>=0){if((_=c.charCodeAt(c.length-1)-48)<2||_>4)throw new e("","Invalid data type for attribute "+x+": "+c);r(o,i,T[0],f,_,l,x)}else{if(!(c.indexOf("mat")>=0))throw new e("","Unknown data type for attribute "+x+": "+c);var _;if((_=c.charCodeAt(c.length-1)-48)<2||_>4)throw new e("","Invalid data type for attribute "+x+": "+c);m(o,i,T,f,_,l,x)}}}return l};var e=g("./GLError");function n(o,i,u,f,l,h){this._gl=o,this._wrapper=i,this._index=u,this._locations=f,this._dimension=l,this._constFunc=h}var t=n.prototype;t.pointer=function(o,i,u,f){var l=this._gl,h=this._locations[this._index];l.vertexAttribPointer(h,this._dimension,o||l.FLOAT,!!i,u||0,f||0),l.enableVertexAttribArray(h)},t.set=function(o,i,u,f){return this._constFunc(this._locations[this._index],o,i,u,f)},Object.defineProperty(t,"location",{get:function(){return this._locations[this._index]},set:function(o){return o!==this._locations[this._index]&&(this._locations[this._index]=0|o,this._wrapper.program=null),0|o}});var a=[function(o,i,u){return u.length===void 0?o.vertexAttrib1f(i,u):o.vertexAttrib1fv(i,u)},function(o,i,u,f){return u.length===void 0?o.vertexAttrib2f(i,u,f):o.vertexAttrib2fv(i,u)},function(o,i,u,f,l){return u.length===void 0?o.vertexAttrib3f(i,u,f,l):o.vertexAttrib3fv(i,u)},function(o,i,u,f,l,h){return u.length===void 0?o.vertexAttrib4f(i,u,f,l,h):o.vertexAttrib4fv(i,u)}];function r(o,i,u,f,l,h,d){var s=a[l],x=new n(o,i,u,f,l,s);Object.defineProperty(h,d,{set:function(c){return o.disableVertexAttribArray(f[u]),s(o,f[u],c),c},get:function(){return x},enumerable:!0})}function m(o,i,u,f,l,h,d){for(var s=new Array(l),x=new Array(l),c=0;c<l;++c)r(o,i,u[c],f,l,s,c),x[c]=s[c];Object.defineProperty(s,"location",{set:function(w){if(Array.isArray(w))for(var k=0;k<l;++k)x[k].location=w[k];else for(k=0;k<l;++k)x[k].location=w+k;return w},get:function(){for(var w=new Array(l),k=0;k<l;++k)w[k]=f[u[k]];return w},enumerable:!0}),s.pointer=function(w,k,L,A){w=w||o.FLOAT,k=!!k,L=L||l*l,A=A||0;for(var I=0;I<l;++I){var P=f[u[I]];o.vertexAttribPointer(P,l,w,k,L,A+I*l),o.enableVertexAttribArray(P)}};var T=new Array(l),_=o["vertexAttrib"+l+"fv"];Object.defineProperty(h,d,{set:function(w){for(var k=0;k<l;++k){var L=f[u[k]];if(o.disableVertexAttribArray(L),Array.isArray(w[0]))_.call(o,L,w[k]);else{for(var A=0;A<l;++A)T[A]=w[l*k+A];_.call(o,L,T)}}return w},get:function(){return s},enumerable:!0})}},{"./GLError":133}],135:[function(g,b,y){var e=g("./reflect"),n=g("./GLError");function t(r){return function(){return r}}function a(r,m){for(var o=new Array(r),i=0;i<r;++i)o[i]=m;return o}b.exports=function(r,m,o,i){function u(d){return function(s){for(var x=function R(H,V){if(typeof V!="object")return[[H,V]];var X=[];for(var $ in V){var G=V[$],W=H;parseInt($)+""===$?W+="["+$+"]":W+="."+$,typeof G=="object"?X.push.apply(X,R(W,G)):X.push([W,G])}return X}("",d),c=0;c<x.length;++c){var T=x[c],_=T[0],w=T[1];if(i[w]){var k=s;if(typeof _=="string"&&(_.indexOf(".")===0||_.indexOf("[")===0)){var L=_;if(_.indexOf(".")===0&&(L=_.slice(1)),L.indexOf("]")===L.length-1){var A=L.indexOf("["),I=L.slice(0,A),P=L.slice(A+1,L.length-1);k=I?s[I][P]:s[P]}else k=s[L]}var S,E=o[w].type;switch(E){case"bool":case"int":case"sampler2D":case"samplerCube":r.uniform1i(i[w],k);break;case"float":r.uniform1f(i[w],k);break;default:var D=E.indexOf("vec");if(!(0<=D&&D<=1&&E.length===4+D)){if(E.indexOf("mat")===0&&E.length===4){if((S=E.charCodeAt(E.length-1)-48)<2||S>4)throw new n("","Invalid uniform dimension type for matrix "+name+": "+E);r["uniformMatrix"+S+"fv"](i[w],!1,k);break}throw new n("","Unknown uniform data type for "+name+": "+E)}if((S=E.charCodeAt(E.length-1)-48)<2||S>4)throw new n("","Invalid data type");switch(E.charAt(0)){case"b":case"i":r["uniform"+S+"iv"](i[w],k);break;case"v":r["uniform"+S+"fv"](i[w],k);break;default:throw new n("","Unrecognized data type for vector "+name+": "+E)}}}}}}function f(d,s,x){if(typeof x=="object"){var c=l(x);Object.defineProperty(d,s,{get:t(c),set:u(x),enumerable:!0,configurable:!1})}else i[x]?Object.defineProperty(d,s,{get:(T=x,function(_,w,k){return _.getUniform(w.program,k[T])}),set:u(x),enumerable:!0,configurable:!1}):d[s]=function(_){switch(_){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var w=_.indexOf("vec");if(0<=w&&w<=1&&_.length===4+w){if((k=_.charCodeAt(_.length-1)-48)<2||k>4)throw new n("","Invalid data type");return _.charAt(0)==="b"?a(k,!1):a(k,0)}if(_.indexOf("mat")===0&&_.length===4){var k;if((k=_.charCodeAt(_.length-1)-48)<2||k>4)throw new n("","Invalid uniform dimension type for matrix "+name+": "+_);return a(k*k,0)}throw new n("","Unknown uniform data type for "+name+": "+_)}}(o[x].type);var T}function l(d){var s;if(Array.isArray(d)){s=new Array(d.length);for(var x=0;x<d.length;++x)f(s,x,d[x])}else for(var c in s={},d)f(s,c,d[c]);return s}var h=e(o,!0);return{get:t(l(h)),set:u(h),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(g,b,y){b.exports=function(e,n){for(var t={},a=0;a<e.length;++a)for(var r=e[a].name.split("."),m=t,o=0;o<r.length;++o){var i=r[o].split("[");if(i.length>1){i[0]in m||(m[i[0]]=[]),m=m[i[0]];for(var u=1;u<i.length;++u){var f=parseInt(i[u]);u<i.length-1||o<r.length-1?(f in m||(u<i.length-1?m[f]=[]:m[f]={}),m=m[f]):m[f]=n?a:e[a].type}}else o<r.length-1?(i[0]in m||(m[i[0]]={}),m=m[i[0]]):m[i[0]]=n?a:e[a].type}return t}},{}],137:[function(g,b,y){y.uniforms=function(a,r){for(var m=a.getProgramParameter(r,a.ACTIVE_UNIFORMS),o=[],i=0;i<m;++i){var u=a.getActiveUniform(r,i);if(u){var f=t(a,u.type);if(u.size>1)for(var l=0;l<u.size;++l)o.push({name:u.name.replace("[0]","["+l+"]"),type:f});else o.push({name:u.name,type:f})}}return o},y.attributes=function(a,r){for(var m=a.getProgramParameter(r,a.ACTIVE_ATTRIBUTES),o=[],i=0;i<m;++i){var u=a.getActiveAttrib(r,i);u&&o.push({name:u.name,type:t(a,u.type)})}return o};var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},n=null;function t(a,r){if(!n){var m=Object.keys(e);n={};for(var o=0;o<m.length;++o){var i=m[o];n[a[i]]=e[i]}}return n[r]}},{}],138:[function(g,b,y){y.shader=function(u,f,l){return i(u).getShaderReference(f,l)},y.program=function(u,f,l,h,d){return i(u).getProgram(f,l,h,d)};var e=g("./GLError"),n=g("gl-format-compiler-error"),t=new(typeof WeakMap>"u"?g("weakmap-shim"):WeakMap),a=0;function r(u,f,l,h,d,s,x){this.id=u,this.src=f,this.type=l,this.shader=h,this.count=s,this.programs=[],this.cache=x}function m(u){this.gl=u,this.shaders=[{},{}],this.programs={}}r.prototype.dispose=function(){if(--this.count==0){for(var u=this.cache,f=u.gl,l=this.programs,h=0,d=l.length;h<d;++h){var s=u.programs[l[h]];s&&(delete u.programs[h],f.deleteProgram(s))}f.deleteShader(this.shader),delete u.shaders[this.type===f.FRAGMENT_SHADER|0][this.src]}};var o=m.prototype;function i(u){var f=t.get(u);return f||(f=new m(u),t.set(u,f)),f}o.getShaderReference=function(u,f){var l=this.gl,h=this.shaders[u===l.FRAGMENT_SHADER|0],d=h[f];if(d&&l.isShader(d.shader))d.count+=1;else{var s=function(x,c,T){var _=x.createShader(c);if(x.shaderSource(_,T),x.compileShader(_),!x.getShaderParameter(_,x.COMPILE_STATUS)){var w=x.getShaderInfoLog(_);try{var k=n(w,T,c)}catch(L){throw console.warn("Failed to format compiler error: "+L),new e(w,`Error compiling shader:
`+w)}throw new e(w,k.short,k.long)}return _}(l,u,f);d=h[f]=new r(a++,f,u,s,[],1,this)}return d},o.getProgram=function(u,f,l,h){var d=[u.id,f.id,l.join(":"),h.join(":")].join("@"),s=this.programs[d];return s&&this.gl.isProgram(s)||(this.programs[d]=s=function(x,c,T,_,w){var k=x.createProgram();x.attachShader(k,c),x.attachShader(k,T);for(var L=0;L<_.length;++L)x.bindAttribLocation(k,w[L],_[L]);if(x.linkProgram(k),!x.getProgramParameter(k,x.LINK_STATUS)){var A=x.getProgramInfoLog(k);throw new e(A,"Error linking program: "+A)}return k}(this.gl,u.shader,f.shader,l,h),u.programs.push(d),f.programs.push(d)),s}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(g,b,y){function e(t){this.plot=t,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}b.exports=function(t,a){var r=new e(t);return r.update(a),t.addOverlay(r),r};var n=e.prototype;n.update=function(t){t=t||{},this.enable=(t.enable||[!0,!0,!1,!1]).slice(),this.width=(t.width||[1,1,1,1]).slice(),this.color=(t.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(a){return a.slice()}),this.center=(t.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},n.draw=function(){var t=this.enable,a=this.width,r=this.color,m=this.center,o=this.plot,i=o.line,u=o.dataBox,f=o.viewBox;if(i.bind(),u[0]<=m[0]&&m[0]<=u[2]&&u[1]<=m[1]&&m[1]<=u[3]){var l=f[0]+(m[0]-u[0])/(u[2]-u[0])*(f[2]-f[0]),h=f[1]+(m[1]-u[1])/(u[3]-u[1])*(f[3]-f[1]);t[0]&&i.drawLine(l,h,f[0],h,a[0],r[0]),t[1]&&i.drawLine(l,h,l,f[1],a[1],r[1]),t[2]&&i.drawLine(l,h,f[2],h,a[2],r[2]),t[3]&&i.drawLine(l,h,l,f[3],a[3],r[3])}},n.dispose=function(){this.plot.removeOverlay(this)}},{}],140:[function(g,b,y){var e=g("glslify"),n=g("gl-shader"),t=e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),a=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);b.exports=function(r){return n(r,t,a,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(g,b,y){var e=g("gl-buffer"),n=g("gl-vao"),t=g("./shaders/index");b.exports=function(f,l){var h=[];function d(_,w,k,L,A,I){var P=[_,w,k,0,0,0,1];P[L+3]=1,P[L]=A,h.push.apply(h,P),P[6]=-1,h.push.apply(h,P),P[L]=I,h.push.apply(h,P),h.push.apply(h,P),P[6]=1,h.push.apply(h,P),P[L]=A,h.push.apply(h,P)}d(0,0,0,0,0,1),d(0,0,0,1,0,1),d(0,0,0,2,0,1),d(1,0,0,1,-1,1),d(1,0,0,2,-1,1),d(0,1,0,0,-1,1),d(0,1,0,2,-1,1),d(0,0,1,0,-1,1),d(0,0,1,1,-1,1);var s=e(f,h),x=n(f,[{type:f.FLOAT,buffer:s,size:3,offset:0,stride:28},{type:f.FLOAT,buffer:s,size:3,offset:12,stride:28},{type:f.FLOAT,buffer:s,size:1,offset:24,stride:28}]),c=t(f);c.attributes.position.location=0,c.attributes.color.location=1,c.attributes.weight.location=2;var T=new r(f,s,x,c);return T.update(l),T};var a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(f,l,h,d){this.gl=f,this.buffer=l,this.vao=h,this.shader=d,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var m=r.prototype,o=[0,0,0],i=[0,0,0],u=[0,0];m.isTransparent=function(){return!1},m.drawTransparent=function(f){},m.draw=function(f){var l=this.gl,h=this.vao,d=this.shader;h.bind(),d.bind();var s,x=f.model||a,c=f.view||a,T=f.projection||a;this.axes&&(s=this.axes.lastCubeProps.axis);for(var _=o,w=i,k=0;k<3;++k)s&&s[k]<0?(_[k]=this.bounds[0][k],w[k]=this.bounds[1][k]):(_[k]=this.bounds[1][k],w[k]=this.bounds[0][k]);for(u[0]=l.drawingBufferWidth,u[1]=l.drawingBufferHeight,d.uniforms.model=x,d.uniforms.view=c,d.uniforms.projection=T,d.uniforms.coordinates=[this.position,_,w],d.uniforms.colors=this.colors,d.uniforms.screenShape=u,k=0;k<3;++k)d.uniforms.lineWidth=this.lineWidth[k]*this.pixelRatio,this.enabled[k]&&(h.draw(l.TRIANGLES,6,6*k),this.drawSides[k]&&h.draw(l.TRIANGLES,12,18+12*k));h.unbind()},m.update=function(f){f&&("bounds"in f&&(this.bounds=f.bounds),"position"in f&&(this.position=f.position),"lineWidth"in f&&(this.lineWidth=f.lineWidth),"colors"in f&&(this.colors=f.colors),"enabled"in f&&(this.enabled=f.enabled),"drawSides"in f&&(this.drawSides=f.drawSides))},m.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(g,b,y){var e=g("glslify"),n=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),t=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);y.meshShader={vertex:n,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},y.pickShader={vertex:a,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(g,b,y){var e=g("gl-vec3"),n=g("gl-vec4"),t=["xyz","xzy","yxz","yzx","zxy","zyx"],a=function(f,l,h,d){for(var s=0,x=0;x<f.length;x++)for(var c=f[x].velocities,T=0;T<c.length;T++)s=Math.max(s,e.length(c[T]));var _=f.map(function(R){return function(H,V,X,$){for(var G=H.points,W=H.velocities,te=H.divergences,N=[],B=[],U=[],ee=[],j=[],Q=[],K=0,re=0,ne=n.create(),le=n.create(),oe=0;oe<G.length;oe++){var de=G[oe],se=W[oe],me=te[oe];V===0&&(me=.05*X),re=e.length(se)/$,ne=n.create(),e.copy(ne,se),ne[3]=me;for(var Te=0;Te<8;Te++)j[Te]=[de[0],de[1],de[2],Te];if(ee.length>0)for(Te=0;Te<8;Te++){var _e=(Te+1)%8;N.push(ee[Te],j[Te],j[_e],j[_e],ee[_e],ee[Te]),U.push(le,ne,ne,ne,le,le),Q.push(K,re,re,re,K,K);var be=N.length;B.push([be-6,be-5,be-4],[be-3,be-2,be-1])}var Ce=ee;ee=j,j=Ce;var fe=le;le=ne,ne=fe;var ve=K;K=re,re=ve}return{positions:N,cells:B,vectors:U,vertexIntensity:Q}}(R,h,d,s)}),w=[],k=[],L=[],A=[];for(x=0;x<_.length;x++){var I=_[x],P=w.length;for(w=w.concat(I.positions),L=L.concat(I.vectors),A=A.concat(I.vertexIntensity),T=0;T<I.cells.length;T++){var S=I.cells[T],E=[];k.push(E);for(var D=0;D<S.length;D++)E.push(S[D]+P)}}return{positions:w,cells:k,vectors:L,vertexIntensity:A,colormap:l}},r=function(f,l){var h,d=f.length;for(h=0;h<d;h++){var s=f[h];if(s===l)return h;if(s>l)return h-1}return h},m=function(f,l,h){return f<l?l:f>h?h:f},o=function(f){var l=1/0;f.sort(function(x,c){return x-c});for(var h=f.length,d=1;d<h;d++){var s=Math.abs(f[d]-f[d-1]);s<l&&(l=s)}return l};b.exports=function(f,l){var h=f.startingPositions,d=f.maxLength||1e3,s=f.tubeSize||1,x=f.absoluteTubeSize,c=f.gridFill||"+x+y+z",T={};c.indexOf("-x")!==-1&&(T.reversedX=!0),c.indexOf("-y")!==-1&&(T.reversedY=!0),c.indexOf("-z")!==-1&&(T.reversedZ=!0),T.filled=t.indexOf(c.replace(/-/g,"").replace(/\+/g,""));var _=f.getVelocity||function(oe){return function(de,se,me){var Te=se.vectors,_e=se.meshgrid,be=de[0],Ce=de[1],fe=de[2],ve=_e[0].length,Me=_e[1].length,ke=_e[2].length,Le=r(_e[0],be),ze=r(_e[1],Ce),Re=r(_e[2],fe),Oe=Le+1,Ze=ze+1,Pe=Re+1;if(Le=m(Le,0,ve-1),Oe=m(Oe,0,ve-1),ze=m(ze,0,Me-1),Ze=m(Ze,0,Me-1),Re=m(Re,0,ke-1),Pe=m(Pe,0,ke-1),Le<0||ze<0||Re<0||Oe>ve-1||Ze>Me-1||Pe>ke-1)return e.create();var Ie,Be,Fe,$e,ot,pt,_t=_e[0][Le],yt=_e[0][Oe],tt=_e[1][ze],Ke=_e[1][Ze],vt=_e[2][Re],Nt=(be-_t)/(yt-_t),qt=(Ce-tt)/(Ke-tt),er=(fe-vt)/(_e[2][Pe]-vt);switch(isFinite(Nt)||(Nt=.5),isFinite(qt)||(qt=.5),isFinite(er)||(er=.5),me.reversedX&&(Le=ve-1-Le,Oe=ve-1-Oe),me.reversedY&&(ze=Me-1-ze,Ze=Me-1-Ze),me.reversedZ&&(Re=ke-1-Re,Pe=ke-1-Pe),me.filled){case 5:ot=Re,pt=Pe,Fe=ze*ke,$e=Ze*ke,Ie=Le*ke*Me,Be=Oe*ke*Me;break;case 4:ot=Re,pt=Pe,Ie=Le*ke,Be=Oe*ke,Fe=ze*ke*ve,$e=Ze*ke*ve;break;case 3:Fe=ze,$e=Ze,ot=Re*Me,pt=Pe*Me,Ie=Le*Me*ke,Be=Oe*Me*ke;break;case 2:Fe=ze,$e=Ze,Ie=Le*Me,Be=Oe*Me,ot=Re*Me*ve,pt=Pe*Me*ve;break;case 1:Ie=Le,Be=Oe,ot=Re*ve,pt=Pe*ve,Fe=ze*ve*ke,$e=Ze*ve*ke;break;default:Ie=Le,Be=Oe,Fe=ze*ve,$e=Ze*ve,ot=Re*ve*Me,pt=Pe*ve*Me}var Jt=Te[Ie+Fe+ot],ir=Te[Ie+Fe+pt],Ht=Te[Ie+$e+ot],Ue=Te[Ie+$e+pt],We=Te[Be+Fe+ot],he=Te[Be+Fe+pt],xe=Te[Be+$e+ot],De=Te[Be+$e+pt],qe=e.create(),Xe=e.create(),He=e.create(),st=e.create();e.lerp(qe,Jt,We,Nt),e.lerp(Xe,ir,he,Nt),e.lerp(He,Ht,xe,Nt),e.lerp(st,Ue,De,Nt);var it=e.create(),Tt=e.create();e.lerp(it,qe,He,qt),e.lerp(Tt,Xe,st,qt);var Pt=e.create();return e.lerp(Pt,it,Tt,er),Pt}(oe,f,T)},w=f.getDivergence||function(oe,de){var se=e.create(),me=1e-4;e.add(se,oe,[me,0,0]);var Te=_(se);e.subtract(Te,Te,de),e.scale(Te,Te,1/me),e.add(se,oe,[0,me,0]);var _e=_(se);e.subtract(_e,_e,de),e.scale(_e,_e,1/me),e.add(se,oe,[0,0,me]);var be=_(se);return e.subtract(be,be,de),e.scale(be,be,1/me),e.add(se,Te,_e),e.add(se,se,be),se},k=[],L=l[0][0],A=l[0][1],I=l[0][2],P=l[1][0],S=l[1][1],E=l[1][2],D=function(oe){var de=oe[0],se=oe[1],me=oe[2];return!(de<L||de>P||se<A||se>S||me<I||me>E)},R=10*e.distance(l[0],l[1])/d,H=R*R,V=1,X=0,$=h.length;$>1&&(V=function(oe){for(var de=[],se=[],me=[],Te={},_e={},be={},Ce=oe.length,fe=0;fe<Ce;fe++){var ve=oe[fe],Me=ve[0],ke=ve[1],Le=ve[2];Te[Me]||(de.push(Me),Te[Me]=!0),_e[ke]||(se.push(ke),_e[ke]=!0),be[Le]||(me.push(Le),be[Le]=!0)}var ze=o(de),Re=o(se),Oe=o(me),Ze=Math.min(ze,Re,Oe);return isFinite(Ze)?Ze:1}(h));for(var G=0;G<$;G++){var W=e.create();e.copy(W,h[G]);var te=[W],N=[],B=_(W),U=W;N.push(B);var ee=[],j=w(W,B),Q=e.length(j);isFinite(Q)&&Q>X&&(X=Q),ee.push(Q),k.push({points:te,velocities:N,divergences:ee});for(var K=0;K<100*d&&te.length<d&&D(W);){K++;var re=e.clone(B),ne=e.squaredLength(re);if(ne===0)break;ne>H&&e.scale(re,re,R/Math.sqrt(ne)),e.add(re,re,W),B=_(re),e.squaredDistance(U,re)-H>-1e-4*H&&(te.push(re),U=re,N.push(B),j=w(re,B),Q=e.length(j),isFinite(Q)&&Q>X&&(X=Q),ee.push(Q)),W=re}}var le=a(k,f.colormap,X,V);return x?le.tubeScale=x:(X===0&&(X=1),le.tubeScale=.5*s*V/X),le};var i=g("./lib/shaders"),u=g("gl-cone3d").createMesh;b.exports.createTubeMesh=function(f,l){return u(f,l,{shaders:i,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(g,b,y){var e=g("gl-shader"),n=g("glslify"),t=n([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),a=n([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),r=n([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),m=n([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);y.createShader=function(o){var i=e(o,t,a,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},y.createPickShader=function(o){var i=e(o,t,m,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},y.createContourShader=function(o){var i=e(o,r,a,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i},y.createPickContourShader=function(o){var i=e(o,r,m,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i}},{"gl-shader":132,glslify:231}],145:[function(g,b,y){b.exports=function(B){var U=B.gl,ee=c(U),j=_(U),Q=T(U),K=w(U),re=n(U),ne=t(U,[{buffer:re,size:4,stride:40,offset:0},{buffer:re,size:3,stride:40,offset:16},{buffer:re,size:3,stride:40,offset:28}]),le=n(U),oe=t(U,[{buffer:le,size:4,stride:20,offset:0},{buffer:le,size:1,stride:20,offset:16}]),de=n(U),se=t(U,[{buffer:de,size:2,type:U.FLOAT}]),me=a(U,1,256,U.RGBA,U.UNSIGNED_BYTE);me.minFilter=U.LINEAR,me.magFilter=U.LINEAR;var Te=new P(U,[0,0],[[0,0,0],[0,0,0]],ee,j,re,ne,me,Q,K,le,oe,de,se,[0,0,0]),_e={levels:[[],[],[]]};for(var be in B)_e[be]=B[be];return _e.colormap=_e.colormap||"jet",Te.update(_e),Te};var e=g("bit-twiddle"),n=g("gl-buffer"),t=g("gl-vao"),a=g("gl-texture2d"),r=g("typedarray-pool"),m=g("colormap"),o=g("ndarray-ops"),i=g("ndarray-pack"),u=g("ndarray"),f=g("surface-nets"),l=g("gl-mat4/multiply"),h=g("gl-mat4/invert"),d=g("binary-search-bounds"),s=g("ndarray-gradient"),x=g("./lib/shaders"),c=x.createShader,T=x.createContourShader,_=x.createPickShader,w=x.createPickContourShader,k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],L=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],A=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function I(B,U,ee,j,Q){this.position=B,this.index=U,this.uv=ee,this.level=j,this.dataCoordinate=Q}(function(){for(var B=0;B<3;++B){var U=A[B],ee=(B+2)%3;U[(B+1)%3+0]=1,U[ee+3]=1,U[B+6]=1}})();function P(B,U,ee,j,Q,K,re,ne,le,oe,de,se,me,Te,_e){this.gl=B,this.shape=U,this.bounds=ee,this.objectOffset=_e,this.intensityBounds=[],this._shader=j,this._pickShader=Q,this._coordinateBuffer=K,this._vao=re,this._colorMap=ne,this._contourShader=le,this._contourPickShader=oe,this._contourBuffer=de,this._contourVAO=se,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new I([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=me,this._dynamicVAO=Te,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[u(r.mallocFloat(1024),[0,0]),u(r.mallocFloat(1024),[0,0]),u(r.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var S=P.prototype;S.genColormap=function(B,U){var ee=!1,j=i([m({colormap:B,nshades:256,format:"rgba"}).map(function(Q,K){var re=U?function(ne,le){if(!le||!le.length)return 1;for(var oe=0;oe<le.length;++oe){if(le.length<2)return 1;if(le[oe][0]===ne)return le[oe][1];if(le[oe][0]>ne&&oe>0){var de=(le[oe][0]-ne)/(le[oe][0]-le[oe-1][0]);return le[oe][1]*(1-de)+de*le[oe-1][1]}}return 1}(K/255,U):Q[3];return re<1&&(ee=!0),[Q[0],Q[1],Q[2],255*re]})]);return o.divseq(j,255),this.hasAlphaScale=ee,j},S.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},S.isOpaque=function(){return!this.isTransparent()},S.pickSlots=1,S.setPickBase=function(B){this.pickId=B};var E=[0,0,0],D={showSurface:!1,showContour:!1,projections:[k.slice(),k.slice(),k.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function R(B,U){var ee,j,Q,K=U.axes&&U.axes.lastCubeProps.axis||E,re=U.showSurface,ne=U.showContour;for(ee=0;ee<3;++ee)for(re=re||U.surfaceProject[ee],j=0;j<3;++j)ne=ne||U.contourProject[ee][j];for(ee=0;ee<3;++ee){var le=D.projections[ee];for(j=0;j<16;++j)le[j]=0;for(j=0;j<4;++j)le[5*j]=1;le[5*ee]=0,le[12+ee]=U.axesBounds[+(K[ee]>0)][ee],l(le,B.model,le);var oe=D.clipBounds[ee];for(Q=0;Q<2;++Q)for(j=0;j<3;++j)oe[Q][j]=B.clipBounds[Q][j];oe[0][ee]=-1e8,oe[1][ee]=1e8}return D.showSurface=re,D.showContour=ne,D}var H={model:k,view:k,projection:k,inverseModel:k.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},V=k.slice(),X=[1,0,0,0,1,0,0,0,1];function $(B,U){B=B||{};var ee=this.gl;ee.disable(ee.CULL_FACE),this._colorMap.bind(0);var j=H;j.model=B.model||k,j.view=B.view||k,j.projection=B.projection||k,j.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],j.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],j.objectOffset=this.objectOffset,j.contourColor=this.contourColor[0],j.inverseModel=h(j.inverseModel,j.model);for(var Q=0;Q<2;++Q)for(var K=j.clipBounds[Q],re=0;re<3;++re)K[re]=Math.min(Math.max(this.clipBounds[Q][re],-1e8),1e8);j.kambient=this.ambientLight,j.kdiffuse=this.diffuseLight,j.kspecular=this.specularLight,j.roughness=this.roughness,j.fresnel=this.fresnel,j.opacity=this.opacity,j.height=0,j.permutation=X,j.vertexColor=this.vertexColor;var ne=V;for(l(ne,j.view,j.model),l(ne,j.projection,ne),h(ne,ne),Q=0;Q<3;++Q)j.eyePosition[Q]=ne[12+Q]/ne[15];var le=ne[15];for(Q=0;Q<3;++Q)le+=this.lightPosition[Q]*ne[4*Q+3];for(Q=0;Q<3;++Q){var oe=ne[12+Q];for(re=0;re<3;++re)oe+=ne[4*re+Q]*this.lightPosition[re];j.lightPosition[Q]=oe/le}var de=R(j,this);if(de.showSurface){for(this._shader.bind(),this._shader.uniforms=j,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(ee.TRIANGLES,this._vertexCount),Q=0;Q<3;++Q)this.surfaceProject[Q]&&this.vertexCount&&(this._shader.uniforms.model=de.projections[Q],this._shader.uniforms.clipBounds=de.clipBounds[Q],this._vao.draw(ee.TRIANGLES,this._vertexCount));this._vao.unbind()}if(de.showContour){var se=this._contourShader;j.kambient=1,j.kdiffuse=0,j.kspecular=0,j.opacity=1,se.bind(),se.uniforms=j;var me=this._contourVAO;for(me.bind(),Q=0;Q<3;++Q)for(se.uniforms.permutation=A[Q],ee.lineWidth(this.contourWidth[Q]*this.pixelRatio),re=0;re<this.contourLevels[Q].length;++re)re===this.highlightLevel[Q]?(se.uniforms.contourColor=this.highlightColor[Q],se.uniforms.contourTint=this.highlightTint[Q]):re!==0&&re-1!==this.highlightLevel[Q]||(se.uniforms.contourColor=this.contourColor[Q],se.uniforms.contourTint=this.contourTint[Q]),this._contourCounts[Q][re]&&(se.uniforms.height=this.contourLevels[Q][re],me.draw(ee.LINES,this._contourCounts[Q][re],this._contourOffsets[Q][re]));for(Q=0;Q<3;++Q)for(se.uniforms.model=de.projections[Q],se.uniforms.clipBounds=de.clipBounds[Q],re=0;re<3;++re)if(this.contourProject[Q][re]){se.uniforms.permutation=A[re],ee.lineWidth(this.contourWidth[re]*this.pixelRatio);for(var Te=0;Te<this.contourLevels[re].length;++Te)Te===this.highlightLevel[re]?(se.uniforms.contourColor=this.highlightColor[re],se.uniforms.contourTint=this.highlightTint[re]):Te!==0&&Te-1!==this.highlightLevel[re]||(se.uniforms.contourColor=this.contourColor[re],se.uniforms.contourTint=this.contourTint[re]),this._contourCounts[re][Te]&&(se.uniforms.height=this.contourLevels[re][Te],me.draw(ee.LINES,this._contourCounts[re][Te],this._contourOffsets[re][Te]))}for(me.unbind(),(me=this._dynamicVAO).bind(),Q=0;Q<3;++Q)if(this._dynamicCounts[Q]!==0)for(se.uniforms.model=j.model,se.uniforms.clipBounds=j.clipBounds,se.uniforms.permutation=A[Q],ee.lineWidth(this.dynamicWidth[Q]*this.pixelRatio),se.uniforms.contourColor=this.dynamicColor[Q],se.uniforms.contourTint=this.dynamicTint[Q],se.uniforms.height=this.dynamicLevel[Q],me.draw(ee.LINES,this._dynamicCounts[Q],this._dynamicOffsets[Q]),re=0;re<3;++re)this.contourProject[re][Q]&&(se.uniforms.model=de.projections[re],se.uniforms.clipBounds=de.clipBounds[re],me.draw(ee.LINES,this._dynamicCounts[Q],this._dynamicOffsets[Q]));me.unbind()}}S.draw=function(B){return $.call(this,B,!1)},S.drawTransparent=function(B){return $.call(this,B,!0)};var G={model:k,view:k,projection:k,inverseModel:k,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function W(B,U){return Array.isArray(B)?[U(B[0]),U(B[1]),U(B[2])]:[U(B),U(B),U(B)]}function te(B){return Array.isArray(B)?B.length===3?[B[0],B[1],B[2],1]:[B[0],B[1],B[2],B[3]]:[0,0,0,1]}function N(B){if(Array.isArray(B)){if(Array.isArray(B))return[te(B[0]),te(B[1]),te(B[2])];var U=te(B);return[U.slice(),U.slice(),U.slice()]}}S.drawPick=function(B){B=B||{};var U=this.gl;U.disable(U.CULL_FACE);var ee=G;ee.model=B.model||k,ee.view=B.view||k,ee.projection=B.projection||k,ee.shape=this._field[2].shape,ee.pickId=this.pickId/255,ee.lowerBound=this.bounds[0],ee.upperBound=this.bounds[1],ee.objectOffset=this.objectOffset,ee.permutation=X;for(var j=0;j<2;++j)for(var Q=ee.clipBounds[j],K=0;K<3;++K)Q[K]=Math.min(Math.max(this.clipBounds[j][K],-1e8),1e8);var re=R(ee,this);if(re.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=ee,this._vao.bind(),this._vao.draw(U.TRIANGLES,this._vertexCount),j=0;j<3;++j)this.surfaceProject[j]&&(this._pickShader.uniforms.model=re.projections[j],this._pickShader.uniforms.clipBounds=re.clipBounds[j],this._vao.draw(U.TRIANGLES,this._vertexCount));this._vao.unbind()}if(re.showContour){var ne=this._contourPickShader;ne.bind(),ne.uniforms=ee;var le=this._contourVAO;for(le.bind(),K=0;K<3;++K)for(U.lineWidth(this.contourWidth[K]*this.pixelRatio),ne.uniforms.permutation=A[K],j=0;j<this.contourLevels[K].length;++j)this._contourCounts[K][j]&&(ne.uniforms.height=this.contourLevels[K][j],le.draw(U.LINES,this._contourCounts[K][j],this._contourOffsets[K][j]));for(j=0;j<3;++j)for(ne.uniforms.model=re.projections[j],ne.uniforms.clipBounds=re.clipBounds[j],K=0;K<3;++K)if(this.contourProject[j][K]){ne.uniforms.permutation=A[K],U.lineWidth(this.contourWidth[K]*this.pixelRatio);for(var oe=0;oe<this.contourLevels[K].length;++oe)this._contourCounts[K][oe]&&(ne.uniforms.height=this.contourLevels[K][oe],le.draw(U.LINES,this._contourCounts[K][oe],this._contourOffsets[K][oe]))}le.unbind()}},S.pick=function(B){if(!B||B.id!==this.pickId)return null;var U=this._field[2].shape,ee=this._pickResult,j=U[0]*(B.value[0]+(B.value[2]>>4)/16)/255,Q=Math.floor(j),K=j-Q,re=U[1]*(B.value[1]+(15&B.value[2])/16)/255,ne=Math.floor(re),le=re-ne;Q+=1,ne+=1;var oe=ee.position;oe[0]=oe[1]=oe[2]=0;for(var de=0;de<2;++de)for(var se=de?K:1-K,me=0;me<2;++me)for(var Te=Q+de,_e=ne+me,be=se*(me?le:1-le),Ce=0;Ce<3;++Ce)oe[Ce]+=this._field[Ce].get(Te,_e)*be;for(var fe=this._pickResult.level,ve=0;ve<3;++ve)if(fe[ve]=d.le(this.contourLevels[ve],oe[ve]),fe[ve]<0)this.contourLevels[ve].length>0&&(fe[ve]=0);else if(fe[ve]<this.contourLevels[ve].length-1){var Me=this.contourLevels[ve][fe[ve]],ke=this.contourLevels[ve][fe[ve]+1];Math.abs(Me-oe[ve])>Math.abs(ke-oe[ve])&&(fe[ve]+=1)}for(ee.index[0]=K<.5?Q:Q+1,ee.index[1]=le<.5?ne:ne+1,ee.uv[0]=j/U[0],ee.uv[1]=re/U[1],Ce=0;Ce<3;++Ce)ee.dataCoordinate[Ce]=this._field[Ce].get(ee.index[0],ee.index[1]);return ee},S.padField=function(B,U){var ee=U.shape.slice(),j=B.shape.slice();o.assign(B.lo(1,1).hi(ee[0],ee[1]),U),o.assign(B.lo(1).hi(ee[0],1),U.hi(ee[0],1)),o.assign(B.lo(1,j[1]-1).hi(ee[0],1),U.lo(0,ee[1]-1).hi(ee[0],1)),o.assign(B.lo(0,1).hi(1,ee[1]),U.hi(1)),o.assign(B.lo(j[0]-1,1).hi(1,ee[1]),U.lo(ee[0]-1)),B.set(0,0,U.get(0,0)),B.set(0,j[1]-1,U.get(0,ee[1]-1)),B.set(j[0]-1,0,U.get(ee[0]-1,0)),B.set(j[0]-1,j[1]-1,U.get(ee[0]-1,ee[1]-1))},S.update=function(B){B=B||{},this.objectOffset=B.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in B&&(this.contourWidth=W(B.contourWidth,Number)),"showContour"in B&&(this.showContour=W(B.showContour,Boolean)),"showSurface"in B&&(this.showSurface=!!B.showSurface),"contourTint"in B&&(this.contourTint=W(B.contourTint,Boolean)),"contourColor"in B&&(this.contourColor=N(B.contourColor)),"contourProject"in B&&(this.contourProject=W(B.contourProject,function(Gt){return W(Gt,Boolean)})),"surfaceProject"in B&&(this.surfaceProject=B.surfaceProject),"dynamicColor"in B&&(this.dynamicColor=N(B.dynamicColor)),"dynamicTint"in B&&(this.dynamicTint=W(B.dynamicTint,Number)),"dynamicWidth"in B&&(this.dynamicWidth=W(B.dynamicWidth,Number)),"opacity"in B&&(this.opacity=B.opacity),"opacityscale"in B&&(this.opacityscale=B.opacityscale),"colorBounds"in B&&(this.colorBounds=B.colorBounds),"vertexColor"in B&&(this.vertexColor=B.vertexColor?1:0),"colormap"in B&&this._colorMap.setPixels(this.genColormap(B.colormap,this.opacityscale));var U=B.field||B.coords&&B.coords[2]||null,ee=!1;if(U||(U=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in B||"coords"in B){var j=(U.shape[0]+2)*(U.shape[1]+2);j>this._field[2].data.length&&(r.freeFloat(this._field[2].data),this._field[2].data=r.mallocFloat(e.nextPow2(j))),this._field[2]=u(this._field[2].data,[U.shape[0]+2,U.shape[1]+2]),this.padField(this._field[2],U),this.shape=U.shape.slice();for(var Q=this.shape,K=0;K<2;++K)this._field[2].size>this._field[K].data.length&&(r.freeFloat(this._field[K].data),this._field[K].data=r.mallocFloat(this._field[2].size)),this._field[K]=u(this._field[K].data,[Q[0]+2,Q[1]+2]);if(B.coords){var re=B.coords;if(!Array.isArray(re)||re.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(K=0;K<2;++K){var ne=re[K];for(me=0;me<2;++me)if(ne.shape[me]!==Q[me])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[K],ne)}}else if(B.ticks){var le=B.ticks;if(!Array.isArray(le)||le.length!==2)throw new Error("gl-surface: invalid ticks");for(K=0;K<2;++K){var oe=le[K];if((Array.isArray(oe)||oe.length)&&(oe=u(oe)),oe.shape[0]!==Q[K])throw new Error("gl-surface: invalid tick length");var de=u(oe.data,Q);de.stride[K]=oe.stride[0],de.stride[1^K]=0,this.padField(this._field[K],de)}}else{for(K=0;K<2;++K){var se=[0,0];se[K]=1,this._field[K]=u(this._field[K].data,[Q[0]+2,Q[1]+2],se,0)}this._field[0].set(0,0,0);for(var me=0;me<Q[0];++me)this._field[0].set(me+1,0,me);for(this._field[0].set(Q[0]+1,0,Q[0]-1),this._field[1].set(0,0,0),me=0;me<Q[1];++me)this._field[1].set(0,me+1,me);this._field[1].set(0,Q[1]+1,Q[1]-1)}var Te=this._field,_e=u(r.mallocFloat(3*Te[2].size*2),[3,Q[0]+2,Q[1]+2,2]);for(K=0;K<3;++K)s(_e.pick(K),Te[K],"mirror");var be=u(r.mallocFloat(3*Te[2].size),[Q[0]+2,Q[1]+2,3]);for(K=0;K<Q[0]+2;++K)for(me=0;me<Q[1]+2;++me){var Ce=_e.get(0,K,me,0),fe=_e.get(0,K,me,1),ve=_e.get(1,K,me,0),Me=_e.get(1,K,me,1),ke=_e.get(2,K,me,0),Le=_e.get(2,K,me,1),ze=ve*Le-Me*ke,Re=ke*fe-Le*Ce,Oe=Ce*Me-fe*ve,Ze=Math.sqrt(ze*ze+Re*Re+Oe*Oe);Ze<1e-8?(Ze=Math.max(Math.abs(ze),Math.abs(Re),Math.abs(Oe)))<1e-8?(Oe=1,Re=ze=0,Ze=1):Ze=1/Ze:Ze=1/Math.sqrt(Ze),be.set(K,me,0,ze*Ze),be.set(K,me,1,Re*Ze),be.set(K,me,2,Oe*Ze)}r.free(_e.data);var Pe=[1/0,1/0,1/0],Ie=[-1/0,-1/0,-1/0],Be=1/0,Fe=-1/0,$e=(Q[0]-1)*(Q[1]-1)*6,ot=r.mallocFloat(e.nextPow2(10*$e)),pt=0,_t=0;for(K=0;K<Q[0]-1;++K)e:for(me=0;me<Q[1]-1;++me){for(var yt=0;yt<2;++yt)for(var tt=0;tt<2;++tt)for(var Ke=0;Ke<3;++Ke){var vt=this._field[Ke].get(1+K+yt,1+me+tt);if(isNaN(vt)||!isFinite(vt))continue e}for(Ke=0;Ke<6;++Ke){var Nt=K+L[Ke][0],qt=me+L[Ke][1],er=this._field[0].get(Nt+1,qt+1),Jt=this._field[1].get(Nt+1,qt+1);vt=this._field[2].get(Nt+1,qt+1),ze=be.get(Nt+1,qt+1,0),Re=be.get(Nt+1,qt+1,1),Oe=be.get(Nt+1,qt+1,2),B.intensity&&(ir=B.intensity.get(Nt,qt));var ir=B.intensity?B.intensity.get(Nt,qt):vt+this.objectOffset[2];ot[pt++]=Nt,ot[pt++]=qt,ot[pt++]=er,ot[pt++]=Jt,ot[pt++]=vt,ot[pt++]=0,ot[pt++]=ir,ot[pt++]=ze,ot[pt++]=Re,ot[pt++]=Oe,Pe[0]=Math.min(Pe[0],er+this.objectOffset[0]),Pe[1]=Math.min(Pe[1],Jt+this.objectOffset[1]),Pe[2]=Math.min(Pe[2],vt+this.objectOffset[2]),Be=Math.min(Be,ir),Ie[0]=Math.max(Ie[0],er+this.objectOffset[0]),Ie[1]=Math.max(Ie[1],Jt+this.objectOffset[1]),Ie[2]=Math.max(Ie[2],vt+this.objectOffset[2]),Fe=Math.max(Fe,ir),_t+=1}}for(B.intensityBounds&&(Be=+B.intensityBounds[0],Fe=+B.intensityBounds[1]),K=6;K<pt;K+=10)ot[K]=(ot[K]-Be)/(Fe-Be);this._vertexCount=_t,this._coordinateBuffer.update(ot.subarray(0,pt)),r.freeFloat(ot),r.free(be.data),this.bounds=[Pe,Ie],this.intensity=B.intensity||this._field[2],this.intensityBounds[0]===Be&&this.intensityBounds[1]===Fe||(ee=!0),this.intensityBounds=[Be,Fe]}if("levels"in B){var Ht=B.levels;for(Ht=Array.isArray(Ht[0])?Ht.slice():[[],[],Ht],K=0;K<3;++K)Ht[K]=Ht[K].slice(),Ht[K].sort(function(Gt,jt){return Gt-jt});for(K=0;K<3;++K)for(me=0;me<Ht[K].length;++me)Ht[K][me]-=this.objectOffset[K];e:for(K=0;K<3;++K){if(Ht[K].length!==this.contourLevels[K].length){ee=!0;break}for(me=0;me<Ht[K].length;++me)if(Ht[K][me]!==this.contourLevels[K][me]){ee=!0;break e}}this.contourLevels=Ht}if(ee){Te=this._field,Q=this.shape;for(var Ue=[],We=0;We<3;++We){var he=this.contourLevels[We],xe=[],De=[],qe=[0,0,0];for(K=0;K<he.length;++K){var Xe=f(this._field[We],he[K]);xe.push(Ue.length/5|0),_t=0;e:for(me=0;me<Xe.cells.length;++me){var He=Xe.cells[me];for(Ke=0;Ke<2;++Ke){var st=Xe.positions[He[Ke]],it=st[0],Tt=0|Math.floor(it),Pt=it-Tt,rt=st[1],ut=0|Math.floor(rt),Ft=rt-ut,wt=!1;t:for(var Lt=0;Lt<3;++Lt){qe[Lt]=0;var Ae=(We+Lt+1)%3;for(yt=0;yt<2;++yt){var Ye=yt?Pt:1-Pt;for(Nt=0|Math.min(Math.max(Tt+yt,0),Q[0]),tt=0;tt<2;++tt){var nt=tt?Ft:1-Ft;if(qt=0|Math.min(Math.max(ut+tt,0),Q[1]),vt=Lt<2?this._field[Ae].get(Nt,qt):(this.intensity.get(Nt,qt)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(vt)||isNaN(vt)){wt=!0;break t}var ft=Ye*nt;qe[Lt]+=ft*vt}}}if(wt){if(Ke>0){for(var Mt=0;Mt<5;++Mt)Ue.pop();_t-=1}continue e}Ue.push(qe[0],qe[1],st[0],st[1],qe[2]),_t+=1}}De.push(_t)}this._contourOffsets[We]=xe,this._contourCounts[We]=De}var Rt=r.mallocFloat(Ue.length);for(K=0;K<Ue.length;++K)Rt[K]=Ue[K];this._contourBuffer.update(Rt),r.freeFloat(Rt)}},S.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var B=0;B<3;++B)r.freeFloat(this._field[B].data)},S.highlight=function(B){var U,ee;if(!B)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(U=0;U<3;++U)this.enableHighlight[U]?this.highlightLevel[U]=B.level[U]:this.highlightLevel[U]=-1;for(ee=this.snapToData?B.dataCoordinate:B.position,U=0;U<3;++U)ee[U]-=this.objectOffset[U];if(this.enableDynamic[0]&&ee[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&ee[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&ee[2]!==this.dynamicLevel[2]){for(var j=0,Q=this.shape,K=r.mallocFloat(12*Q[0]*Q[1]),re=0;re<3;++re)if(this.enableDynamic[re]){this.dynamicLevel[re]=ee[re];var ne=(re+1)%3,le=(re+2)%3,oe=this._field[re],de=this._field[ne],se=this._field[le],me=f(oe,ee[re]),Te=me.cells,_e=me.positions;for(this._dynamicOffsets[re]=j,U=0;U<Te.length;++U)for(var be=Te[U],Ce=0;Ce<2;++Ce){var fe=_e[be[Ce]],ve=+fe[0],Me=0|ve,ke=0|Math.min(Me+1,Q[0]),Le=ve-Me,ze=1-Le,Re=+fe[1],Oe=0|Re,Ze=0|Math.min(Oe+1,Q[1]),Pe=Re-Oe,Ie=1-Pe,Be=ze*Ie,Fe=ze*Pe,$e=Le*Ie,ot=Le*Pe,pt=Be*de.get(Me,Oe)+Fe*de.get(Me,Ze)+$e*de.get(ke,Oe)+ot*de.get(ke,Ze),_t=Be*se.get(Me,Oe)+Fe*se.get(Me,Ze)+$e*se.get(ke,Oe)+ot*se.get(ke,Ze);if(isNaN(pt)||isNaN(_t)){Ce&&(j-=1);break}K[2*j+0]=pt,K[2*j+1]=_t,j+=1}this._dynamicCounts[re]=j-this._dynamicOffsets[re]}else this.dynamicLevel[re]=NaN,this._dynamicCounts[re]=0;this._dynamicBuffer.update(K.subarray(0,2*j)),r.freeFloat(K)}}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(g,b,y){var e=g("ndarray"),n=g("ndarray-ops"),t=g("typedarray-pool");b.exports=function(_){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(a||o(_),typeof arguments[1]=="number")return x(_,arguments[1],arguments[2],arguments[3]||_.RGBA,arguments[4]||_.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return x(_,0|arguments[1][0],0|arguments[1][1],arguments[2]||_.RGBA,arguments[3]||_.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var w=arguments[1],k=i(w)?w:w.raw;if(k)return c(_,k,0|w.width,0|w.height,arguments[2]||_.RGBA,arguments[3]||_.UNSIGNED_BYTE);if(w.shape&&w.data&&w.stride)return T(_,w)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var a=null,r=null,m=null;function o(_){a=[_.LINEAR,_.NEAREST_MIPMAP_LINEAR,_.LINEAR_MIPMAP_NEAREST,_.LINEAR_MIPMAP_NEAREST],r=[_.NEAREST,_.LINEAR,_.NEAREST_MIPMAP_NEAREST,_.NEAREST_MIPMAP_LINEAR,_.LINEAR_MIPMAP_NEAREST,_.LINEAR_MIPMAP_LINEAR],m=[_.REPEAT,_.CLAMP_TO_EDGE,_.MIRRORED_REPEAT]}function i(_){return typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&_ instanceof HTMLVideoElement||typeof ImageData<"u"&&_ instanceof ImageData}var u=function(_,w){n.muls(_,w,255)};function f(_,w,k){var L=_.gl,A=L.getParameter(L.MAX_TEXTURE_SIZE);if(w<0||w>A||k<0||k>A)throw new Error("gl-texture2d: Invalid texture size");return _._shape=[w,k],_.bind(),L.texImage2D(L.TEXTURE_2D,0,_.format,w,k,0,_.format,_.type,null),_._mipLevels=[0],_}function l(_,w,k,L,A,I){this.gl=_,this.handle=w,this.format=A,this.type=I,this._shape=[k,L],this._mipLevels=[0],this._magFilter=_.NEAREST,this._minFilter=_.NEAREST,this._wrapS=_.CLAMP_TO_EDGE,this._wrapT=_.CLAMP_TO_EDGE,this._anisoSamples=1;var P=this,S=[this._wrapS,this._wrapT];Object.defineProperties(S,[{get:function(){return P._wrapS},set:function(D){return P.wrapS=D}},{get:function(){return P._wrapT},set:function(D){return P.wrapT=D}}]),this._wrapVector=S;var E=[this._shape[0],this._shape[1]];Object.defineProperties(E,[{get:function(){return P._shape[0]},set:function(D){return P.width=D}},{get:function(){return P._shape[1]},set:function(D){return P.height=D}}]),this._shapeVector=E}var h=l.prototype;function d(_,w){return _.length===3?w[2]===1&&w[1]===_[0]*_[2]&&w[0]===_[2]:w[0]===1&&w[1]===_[0]}function s(_){var w=_.createTexture();return _.bindTexture(_.TEXTURE_2D,w),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),w}function x(_,w,k,L,A){var I=_.getParameter(_.MAX_TEXTURE_SIZE);if(w<0||w>I||k<0||k>I)throw new Error("gl-texture2d: Invalid texture shape");if(A===_.FLOAT&&!_.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var P=s(_);return _.texImage2D(_.TEXTURE_2D,0,L,w,k,0,L,A,null),new l(_,P,w,k,L,A)}function c(_,w,k,L,A,I){var P=s(_);return _.texImage2D(_.TEXTURE_2D,0,A,A,I,w),new l(_,P,k,L,A,I)}function T(_,w){var k=w.dtype,L=w.shape.slice(),A=_.getParameter(_.MAX_TEXTURE_SIZE);if(L[0]<0||L[0]>A||L[1]<0||L[1]>A)throw new Error("gl-texture2d: Invalid texture size");var I=d(L,w.stride.slice()),P=0;k==="float32"?P=_.FLOAT:k==="float64"?(P=_.FLOAT,I=!1,k="float32"):k==="uint8"?P=_.UNSIGNED_BYTE:(P=_.UNSIGNED_BYTE,I=!1,k="uint8");var S,E,D=0;if(L.length===2)D=_.LUMINANCE,L=[L[0],L[1],1],w=e(w.data,L,[w.stride[0],w.stride[1],1],w.offset);else{if(L.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(L[2]===1)D=_.ALPHA;else if(L[2]===2)D=_.LUMINANCE_ALPHA;else if(L[2]===3)D=_.RGB;else{if(L[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");D=_.RGBA}}P!==_.FLOAT||_.getExtension("OES_texture_float")||(P=_.UNSIGNED_BYTE,I=!1);var R=w.size;if(I)S=w.offset===0&&w.data.length===R?w.data:w.data.subarray(w.offset,w.offset+R);else{var H=[L[2],L[2]*L[0],1];E=t.malloc(R,k);var V=e(E,L,H,0);k!=="float32"&&k!=="float64"||P!==_.UNSIGNED_BYTE?n.assign(V,w):u(V,w),S=E.subarray(0,R)}var X=s(_);return _.texImage2D(_.TEXTURE_2D,0,D,L[0],L[1],0,D,P,S),I||t.free(E),new l(_,X,L[0],L[1],D,P)}Object.defineProperties(h,{minFilter:{get:function(){return this._minFilter},set:function(_){this.bind();var w=this.gl;if(this.type===w.FLOAT&&a.indexOf(_)>=0&&(w.getExtension("OES_texture_float_linear")||(_=w.NEAREST)),r.indexOf(_)<0)throw new Error("gl-texture2d: Unknown filter mode "+_);return w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,_),this._minFilter=_}},magFilter:{get:function(){return this._magFilter},set:function(_){this.bind();var w=this.gl;if(this.type===w.FLOAT&&a.indexOf(_)>=0&&(w.getExtension("OES_texture_float_linear")||(_=w.NEAREST)),r.indexOf(_)<0)throw new Error("gl-texture2d: Unknown filter mode "+_);return w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,_),this._magFilter=_}},mipSamples:{get:function(){return this._anisoSamples},set:function(_){var w=this._anisoSamples;if(this._anisoSamples=0|Math.max(_,1),w!==this._anisoSamples){var k=this.gl.getExtension("EXT_texture_filter_anisotropic");k&&this.gl.texParameterf(this.gl.TEXTURE_2D,k.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(_){if(this.bind(),m.indexOf(_)<0)throw new Error("gl-texture2d: Unknown wrap mode "+_);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,_),this._wrapS=_}},wrapT:{get:function(){return this._wrapT},set:function(_){if(this.bind(),m.indexOf(_)<0)throw new Error("gl-texture2d: Unknown wrap mode "+_);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,_),this._wrapT=_}},wrap:{get:function(){return this._wrapVector},set:function(_){if(Array.isArray(_)||(_=[_,_]),_.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var w=0;w<2;++w)if(m.indexOf(_[w])<0)throw new Error("gl-texture2d: Unknown wrap mode "+_);this._wrapS=_[0],this._wrapT=_[1];var k=this.gl;return this.bind(),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,this._wrapS),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,this._wrapT),_}},shape:{get:function(){return this._shapeVector},set:function(_){if(Array.isArray(_)){if(_.length!==2)throw new Error("gl-texture2d: Invalid texture shape")}else _=[0|_,0|_];return f(this,0|_[0],0|_[1]),[0|_[0],0|_[1]]}},width:{get:function(){return this._shape[0]},set:function(_){return f(this,_|=0,this._shape[1]),_}},height:{get:function(){return this._shape[1]},set:function(_){return _|=0,f(this,this._shape[0],_),_}}}),h.bind=function(_){var w=this.gl;return _!==void 0&&w.activeTexture(w.TEXTURE0+(0|_)),w.bindTexture(w.TEXTURE_2D,this.handle),_!==void 0?0|_:w.getParameter(w.ACTIVE_TEXTURE)-w.TEXTURE0},h.dispose=function(){this.gl.deleteTexture(this.handle)},h.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var _=Math.min(this._shape[0],this._shape[1]),w=0;_>0;++w,_>>>=1)this._mipLevels.indexOf(w)<0&&this._mipLevels.push(w)},h.setPixels=function(_,w,k,L){var A=this.gl;this.bind(),Array.isArray(w)?(L=k,k=0|w[1],w=0|w[0]):(w=w||0,k=k||0),L=L||0;var I=i(_)?_:_.raw;if(I)this._mipLevels.indexOf(L)<0?(A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,this.type,I),this._mipLevels.push(L)):A.texSubImage2D(A.TEXTURE_2D,L,w,k,this.format,this.type,I);else{if(!(_.shape&&_.stride&&_.data))throw new Error("gl-texture2d: Unsupported data type");if(_.shape.length<2||w+_.shape[1]>this._shape[1]>>>L||k+_.shape[0]>this._shape[0]>>>L||w<0||k<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");(function(P,S,E,D,R,H,V,X){var $=X.dtype,G=X.shape.slice();if(G.length<2||G.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var W=0,te=0,N=d(G,X.stride.slice());if($==="float32"?W=P.FLOAT:$==="float64"?(W=P.FLOAT,N=!1,$="float32"):$==="uint8"?W=P.UNSIGNED_BYTE:(W=P.UNSIGNED_BYTE,N=!1,$="uint8"),G.length===2)te=P.LUMINANCE,G=[G[0],G[1],1],X=e(X.data,G,[X.stride[0],X.stride[1],1],X.offset);else{if(G.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(G[2]===1)te=P.ALPHA;else if(G[2]===2)te=P.LUMINANCE_ALPHA;else if(G[2]===3)te=P.RGB;else{if(G[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");te=P.RGBA}G[2]}if(te!==P.LUMINANCE&&te!==P.ALPHA||R!==P.LUMINANCE&&R!==P.ALPHA||(te=R),te!==R)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var B=X.size,U=V.indexOf(D)<0;if(U&&V.push(D),W===H&&N)X.offset===0&&X.data.length===B?U?P.texImage2D(P.TEXTURE_2D,D,R,G[0],G[1],0,R,H,X.data):P.texSubImage2D(P.TEXTURE_2D,D,S,E,G[0],G[1],R,H,X.data):U?P.texImage2D(P.TEXTURE_2D,D,R,G[0],G[1],0,R,H,X.data.subarray(X.offset,X.offset+B)):P.texSubImage2D(P.TEXTURE_2D,D,S,E,G[0],G[1],R,H,X.data.subarray(X.offset,X.offset+B));else{var ee;ee=H===P.FLOAT?t.mallocFloat32(B):t.mallocUint8(B);var j=e(ee,G,[G[2],G[2]*G[0],1]);W===P.FLOAT&&H===P.UNSIGNED_BYTE?u(j,X):n.assign(j,X),U?P.texImage2D(P.TEXTURE_2D,D,R,G[0],G[1],0,R,H,ee.subarray(0,B)):P.texSubImage2D(P.TEXTURE_2D,D,S,E,G[0],G[1],R,H,ee.subarray(0,B)),H===P.FLOAT?t.freeFloat32(ee):t.freeUint8(ee)}})(A,w,k,L,this.format,this.type,this._mipLevels,_)}}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(g,b,y){b.exports=function(e,n,t){n?n.bind():e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);var a=0|e.getParameter(e.MAX_VERTEX_ATTRIBS);if(t){if(t.length>a)throw new Error("gl-vao: Too many vertex attributes");for(var r=0;r<t.length;++r){var m=t[r];if(m.buffer){var o=m.buffer,i=m.size||4,u=m.type||e.FLOAT,f=!!m.normalized,l=m.stride||0,h=m.offset||0;o.bind(),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,i,u,f,l,h)}else{if(typeof m=="number")e.vertexAttrib1f(r,m);else if(m.length===1)e.vertexAttrib1f(r,m[0]);else if(m.length===2)e.vertexAttrib2f(r,m[0],m[1]);else if(m.length===3)e.vertexAttrib3f(r,m[0],m[1],m[2]);else{if(m.length!==4)throw new Error("gl-vao: Invalid vertex attribute");e.vertexAttrib4f(r,m[0],m[1],m[2],m[3])}e.disableVertexAttribArray(r)}}for(;r<a;++r)e.disableVertexAttribArray(r)}else for(e.bindBuffer(e.ARRAY_BUFFER,null),r=0;r<a;++r)e.disableVertexAttribArray(r)}},{}],148:[function(g,b,y){var e=g("./do-bind.js");function n(t){this.gl=t,this._elements=null,this._attributes=null,this._elementsType=t.UNSIGNED_SHORT}n.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},n.prototype.update=function(t,a,r){this._elements=a,this._attributes=t,this._elementsType=r||this.gl.UNSIGNED_SHORT},n.prototype.dispose=function(){},n.prototype.unbind=function(){},n.prototype.draw=function(t,a,r){r=r||0;var m=this.gl;this._elements?m.drawElements(t,a,this._elementsType,r):m.drawArrays(t,r,a)},b.exports=function(t){return new n(t)}},{"./do-bind.js":147}],149:[function(g,b,y){var e=g("./do-bind.js");function n(a,r,m,o,i,u){this.location=a,this.dimension=r,this.a=m,this.b=o,this.c=i,this.d=u}function t(a,r,m){this.gl=a,this._ext=r,this.handle=m,this._attribs=[],this._useElements=!1,this._elementsType=a.UNSIGNED_SHORT}n.prototype.bind=function(a){switch(this.dimension){case 1:a.vertexAttrib1f(this.location,this.a);break;case 2:a.vertexAttrib2f(this.location,this.a,this.b);break;case 3:a.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:a.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},t.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var a=0;a<this._attribs.length;++a)this._attribs[a].bind(this.gl)},t.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},t.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},t.prototype.update=function(a,r,m){if(this.bind(),e(this.gl,r,a),this.unbind(),this._attribs.length=0,a)for(var o=0;o<a.length;++o){var i=a[o];typeof i=="number"?this._attribs.push(new n(o,1,i)):Array.isArray(i)&&this._attribs.push(new n(o,i.length,i[0],i[1],i[2],i[3]))}this._useElements=!!r,this._elementsType=m||this.gl.UNSIGNED_SHORT},t.prototype.draw=function(a,r,m){m=m||0;var o=this.gl;this._useElements?o.drawElements(a,r,this._elementsType,m):o.drawArrays(a,m,r)},b.exports=function(a,r){return new t(a,r,r.createVertexArrayOES())}},{"./do-bind.js":147}],150:[function(g,b,y){var e=g("./lib/vao-native.js"),n=g("./lib/vao-emulated.js");function t(a){this.bindVertexArrayOES=a.bindVertexArray.bind(a),this.createVertexArrayOES=a.createVertexArray.bind(a),this.deleteVertexArrayOES=a.deleteVertexArray.bind(a)}b.exports=function(a,r,m,o){var i,u=a.createVertexArray?new t(a):a.getExtension("OES_vertex_array_object");return(i=u?e(a,u):n(a)).update(r,m,o),i}},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(g,b,y){b.exports=function(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e}},{}],152:[function(g,b,y){b.exports=function(a,r){var m=e(a[0],a[1],a[2]),o=e(r[0],r[1],r[2]);n(m,m),n(o,o);var i=t(m,o);return i>1?0:Math.acos(i)};var e=g("./fromValues"),n=g("./normalize"),t=g("./dot")},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(g,b,y){b.exports=function(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e[2]=Math.ceil(n[2]),e}},{}],154:[function(g,b,y){b.exports=function(e){var n=new Float32Array(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}},{}],155:[function(g,b,y){b.exports=function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}},{}],156:[function(g,b,y){b.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],157:[function(g,b,y){b.exports=function(e,n,t){var a=n[0],r=n[1],m=n[2],o=t[0],i=t[1],u=t[2];return e[0]=r*u-m*i,e[1]=m*o-a*u,e[2]=a*i-r*o,e}},{}],158:[function(g,b,y){b.exports=g("./distance")},{"./distance":159}],159:[function(g,b,y){b.exports=function(e,n){var t=n[0]-e[0],a=n[1]-e[1],r=n[2]-e[2];return Math.sqrt(t*t+a*a+r*r)}},{}],160:[function(g,b,y){b.exports=g("./divide")},{"./divide":161}],161:[function(g,b,y){b.exports=function(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e}},{}],162:[function(g,b,y){b.exports=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}},{}],163:[function(g,b,y){b.exports=1e-6},{}],164:[function(g,b,y){b.exports=function(n,t){var a=n[0],r=n[1],m=n[2],o=t[0],i=t[1],u=t[2];return Math.abs(a-o)<=e*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(r-i)<=e*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(m-u)<=e*Math.max(1,Math.abs(m),Math.abs(u))};var e=g("./epsilon")},{"./epsilon":163}],165:[function(g,b,y){b.exports=function(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}},{}],166:[function(g,b,y){b.exports=function(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e[2]=Math.floor(n[2]),e}},{}],167:[function(g,b,y){b.exports=function(n,t,a,r,m,o){var i,u;for(t||(t=3),a||(a=0),u=r?Math.min(r*t+a,n.length):n.length,i=a;i<u;i+=t)e[0]=n[i],e[1]=n[i+1],e[2]=n[i+2],m(e,e,o),n[i]=e[0],n[i+1]=e[1],n[i+2]=e[2];return n};var e=g("./create")()},{"./create":156}],168:[function(g,b,y){b.exports=function(e,n,t){var a=new Float32Array(3);return a[0]=e,a[1]=n,a[2]=t,a}},{}],169:[function(g,b,y){b.exports={EPSILON:g("./epsilon"),create:g("./create"),clone:g("./clone"),angle:g("./angle"),fromValues:g("./fromValues"),copy:g("./copy"),set:g("./set"),equals:g("./equals"),exactEquals:g("./exactEquals"),add:g("./add"),subtract:g("./subtract"),sub:g("./sub"),multiply:g("./multiply"),mul:g("./mul"),divide:g("./divide"),div:g("./div"),min:g("./min"),max:g("./max"),floor:g("./floor"),ceil:g("./ceil"),round:g("./round"),scale:g("./scale"),scaleAndAdd:g("./scaleAndAdd"),distance:g("./distance"),dist:g("./dist"),squaredDistance:g("./squaredDistance"),sqrDist:g("./sqrDist"),length:g("./length"),len:g("./len"),squaredLength:g("./squaredLength"),sqrLen:g("./sqrLen"),negate:g("./negate"),inverse:g("./inverse"),normalize:g("./normalize"),dot:g("./dot"),cross:g("./cross"),lerp:g("./lerp"),random:g("./random"),transformMat4:g("./transformMat4"),transformMat3:g("./transformMat3"),transformQuat:g("./transformQuat"),rotateX:g("./rotateX"),rotateY:g("./rotateY"),rotateZ:g("./rotateZ"),forEach:g("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(g,b,y){b.exports=function(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e}},{}],171:[function(g,b,y){b.exports=g("./length")},{"./length":172}],172:[function(g,b,y){b.exports=function(e){var n=e[0],t=e[1],a=e[2];return Math.sqrt(n*n+t*t+a*a)}},{}],173:[function(g,b,y){b.exports=function(e,n,t,a){var r=n[0],m=n[1],o=n[2];return e[0]=r+a*(t[0]-r),e[1]=m+a*(t[1]-m),e[2]=o+a*(t[2]-o),e}},{}],174:[function(g,b,y){b.exports=function(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e[2]=Math.max(n[2],t[2]),e}},{}],175:[function(g,b,y){b.exports=function(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e[2]=Math.min(n[2],t[2]),e}},{}],176:[function(g,b,y){b.exports=g("./multiply")},{"./multiply":177}],177:[function(g,b,y){b.exports=function(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e}},{}],178:[function(g,b,y){b.exports=function(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e}},{}],179:[function(g,b,y){b.exports=function(e,n){var t=n[0],a=n[1],r=n[2],m=t*t+a*a+r*r;return m>0&&(m=1/Math.sqrt(m),e[0]=n[0]*m,e[1]=n[1]*m,e[2]=n[2]*m),e}},{}],180:[function(g,b,y){b.exports=function(e,n){n=n||1;var t=2*Math.random()*Math.PI,a=2*Math.random()-1,r=Math.sqrt(1-a*a)*n;return e[0]=Math.cos(t)*r,e[1]=Math.sin(t)*r,e[2]=a*n,e}},{}],181:[function(g,b,y){b.exports=function(e,n,t,a){var r=t[1],m=t[2],o=n[1]-r,i=n[2]-m,u=Math.sin(a),f=Math.cos(a);return e[0]=n[0],e[1]=r+o*f-i*u,e[2]=m+o*u+i*f,e}},{}],182:[function(g,b,y){b.exports=function(e,n,t,a){var r=t[0],m=t[2],o=n[0]-r,i=n[2]-m,u=Math.sin(a),f=Math.cos(a);return e[0]=r+i*u+o*f,e[1]=n[1],e[2]=m+i*f-o*u,e}},{}],183:[function(g,b,y){b.exports=function(e,n,t,a){var r=t[0],m=t[1],o=n[0]-r,i=n[1]-m,u=Math.sin(a),f=Math.cos(a);return e[0]=r+o*f-i*u,e[1]=m+o*u+i*f,e[2]=n[2],e}},{}],184:[function(g,b,y){b.exports=function(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e[2]=Math.round(n[2]),e}},{}],185:[function(g,b,y){b.exports=function(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e}},{}],186:[function(g,b,y){b.exports=function(e,n,t,a){return e[0]=n[0]+t[0]*a,e[1]=n[1]+t[1]*a,e[2]=n[2]+t[2]*a,e}},{}],187:[function(g,b,y){b.exports=function(e,n,t,a){return e[0]=n,e[1]=t,e[2]=a,e}},{}],188:[function(g,b,y){b.exports=g("./squaredDistance")},{"./squaredDistance":190}],189:[function(g,b,y){b.exports=g("./squaredLength")},{"./squaredLength":191}],190:[function(g,b,y){b.exports=function(e,n){var t=n[0]-e[0],a=n[1]-e[1],r=n[2]-e[2];return t*t+a*a+r*r}},{}],191:[function(g,b,y){b.exports=function(e){var n=e[0],t=e[1],a=e[2];return n*n+t*t+a*a}},{}],192:[function(g,b,y){b.exports=g("./subtract")},{"./subtract":193}],193:[function(g,b,y){b.exports=function(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e}},{}],194:[function(g,b,y){b.exports=function(e,n,t){var a=n[0],r=n[1],m=n[2];return e[0]=a*t[0]+r*t[3]+m*t[6],e[1]=a*t[1]+r*t[4]+m*t[7],e[2]=a*t[2]+r*t[5]+m*t[8],e}},{}],195:[function(g,b,y){b.exports=function(e,n,t){var a=n[0],r=n[1],m=n[2],o=t[3]*a+t[7]*r+t[11]*m+t[15];return o=o||1,e[0]=(t[0]*a+t[4]*r+t[8]*m+t[12])/o,e[1]=(t[1]*a+t[5]*r+t[9]*m+t[13])/o,e[2]=(t[2]*a+t[6]*r+t[10]*m+t[14])/o,e}},{}],196:[function(g,b,y){b.exports=function(e,n,t){var a=n[0],r=n[1],m=n[2],o=t[0],i=t[1],u=t[2],f=t[3],l=f*a+i*m-u*r,h=f*r+u*a-o*m,d=f*m+o*r-i*a,s=-o*a-i*r-u*m;return e[0]=l*f+s*-o+h*-u-d*-i,e[1]=h*f+s*-i+d*-o-l*-u,e[2]=d*f+s*-u+l*-i-h*-o,e}},{}],197:[function(g,b,y){b.exports=function(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e}},{}],198:[function(g,b,y){b.exports=function(e){var n=new Float32Array(4);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}},{}],199:[function(g,b,y){b.exports=function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}},{}],200:[function(g,b,y){b.exports=function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}},{}],201:[function(g,b,y){b.exports=function(e,n){var t=n[0]-e[0],a=n[1]-e[1],r=n[2]-e[2],m=n[3]-e[3];return Math.sqrt(t*t+a*a+r*r+m*m)}},{}],202:[function(g,b,y){b.exports=function(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e[3]=n[3]/t[3],e}},{}],203:[function(g,b,y){b.exports=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3]}},{}],204:[function(g,b,y){b.exports=function(e,n,t,a){var r=new Float32Array(4);return r[0]=e,r[1]=n,r[2]=t,r[3]=a,r}},{}],205:[function(g,b,y){b.exports={create:g("./create"),clone:g("./clone"),fromValues:g("./fromValues"),copy:g("./copy"),set:g("./set"),add:g("./add"),subtract:g("./subtract"),multiply:g("./multiply"),divide:g("./divide"),min:g("./min"),max:g("./max"),scale:g("./scale"),scaleAndAdd:g("./scaleAndAdd"),distance:g("./distance"),squaredDistance:g("./squaredDistance"),length:g("./length"),squaredLength:g("./squaredLength"),negate:g("./negate"),inverse:g("./inverse"),normalize:g("./normalize"),dot:g("./dot"),lerp:g("./lerp"),random:g("./random"),transformMat4:g("./transformMat4"),transformQuat:g("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(g,b,y){b.exports=function(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e[3]=1/n[3],e}},{}],207:[function(g,b,y){b.exports=function(e){var n=e[0],t=e[1],a=e[2],r=e[3];return Math.sqrt(n*n+t*t+a*a+r*r)}},{}],208:[function(g,b,y){b.exports=function(e,n,t,a){var r=n[0],m=n[1],o=n[2],i=n[3];return e[0]=r+a*(t[0]-r),e[1]=m+a*(t[1]-m),e[2]=o+a*(t[2]-o),e[3]=i+a*(t[3]-i),e}},{}],209:[function(g,b,y){b.exports=function(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e[2]=Math.max(n[2],t[2]),e[3]=Math.max(n[3],t[3]),e}},{}],210:[function(g,b,y){b.exports=function(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e[2]=Math.min(n[2],t[2]),e[3]=Math.min(n[3],t[3]),e}},{}],211:[function(g,b,y){b.exports=function(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e[3]=n[3]*t[3],e}},{}],212:[function(g,b,y){b.exports=function(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e[3]=-n[3],e}},{}],213:[function(g,b,y){b.exports=function(e,n){var t=n[0],a=n[1],r=n[2],m=n[3],o=t*t+a*a+r*r+m*m;return o>0&&(o=1/Math.sqrt(o),e[0]=t*o,e[1]=a*o,e[2]=r*o,e[3]=m*o),e}},{}],214:[function(g,b,y){var e=g("./normalize"),n=g("./scale");b.exports=function(t,a){return a=a||1,t[0]=Math.random(),t[1]=Math.random(),t[2]=Math.random(),t[3]=Math.random(),e(t,t),n(t,t,a),t}},{"./normalize":213,"./scale":215}],215:[function(g,b,y){b.exports=function(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e}},{}],216:[function(g,b,y){b.exports=function(e,n,t,a){return e[0]=n[0]+t[0]*a,e[1]=n[1]+t[1]*a,e[2]=n[2]+t[2]*a,e[3]=n[3]+t[3]*a,e}},{}],217:[function(g,b,y){b.exports=function(e,n,t,a,r){return e[0]=n,e[1]=t,e[2]=a,e[3]=r,e}},{}],218:[function(g,b,y){b.exports=function(e,n){var t=n[0]-e[0],a=n[1]-e[1],r=n[2]-e[2],m=n[3]-e[3];return t*t+a*a+r*r+m*m}},{}],219:[function(g,b,y){b.exports=function(e){var n=e[0],t=e[1],a=e[2],r=e[3];return n*n+t*t+a*a+r*r}},{}],220:[function(g,b,y){b.exports=function(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e[3]=n[3]-t[3],e}},{}],221:[function(g,b,y){b.exports=function(e,n,t){var a=n[0],r=n[1],m=n[2],o=n[3];return e[0]=t[0]*a+t[4]*r+t[8]*m+t[12]*o,e[1]=t[1]*a+t[5]*r+t[9]*m+t[13]*o,e[2]=t[2]*a+t[6]*r+t[10]*m+t[14]*o,e[3]=t[3]*a+t[7]*r+t[11]*m+t[15]*o,e}},{}],222:[function(g,b,y){b.exports=function(e,n,t){var a=n[0],r=n[1],m=n[2],o=t[0],i=t[1],u=t[2],f=t[3],l=f*a+i*m-u*r,h=f*r+u*a-o*m,d=f*m+o*r-i*a,s=-o*a-i*r-u*m;return e[0]=l*f+s*-o+h*-u-d*-i,e[1]=h*f+s*-i+d*-o-l*-u,e[2]=d*f+s*-u+l*-i-h*-o,e[3]=n[3],e}},{}],223:[function(g,b,y){var e=g("glsl-tokenizer"),n=g("atob-lite");b.exports=function(t){for(var a=Array.isArray(t)?t:e(t),r=0;r<a.length;r++){var m=a[r];if(m.type==="preprocessor"){var o=m.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(o&&o[2]){var i=o[1],u=o[2];return(i?n(u):u).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(g,b,y){b.exports=function(o){var i,u,f,l=0,h=0,d=999,s=[],x=[],c=1,T=0,_=0,w=!1,k=!1,L="",A=t,I=e;(o=o||{}).version==="300 es"&&(A=r,I=a);var P={},S={};for(l=0;l<A.length;l++)P[A[l]]=!0;for(l=0;l<I.length;l++)S[I[l]]=!0;return function(B){return x=[],B!==null?function(U){l=0,U.toString&&(U=U.toString());var ee;for(L+=U.replace(/\r\n/g,`
`),f=L.length;i=L[l],l<f;){switch(ee=l,d){case 0:l=V();break;case 1:case 2:l=H();break;case 3:l=X();break;case 4:l=W();break;case 11:l=G();break;case 5:l=te();break;case 9999:l=N();break;case 9:l=R();break;case 999:l=D()}if(ee!==l)switch(L[ee]){case`
`:T=0,++c;break;default:++T}}return h+=l,L=L.slice(l),x}(B):function(U){return s.length&&E(s.join("")),d=10,E("(eof)"),x}()};function E(B){B.length&&x.push({type:m[d],data:B,position:_,line:c,column:T})}function D(){return s=s.length?[]:s,u==="/"&&i==="*"?(_=h+l-1,d=0,u=i,l+1):u==="/"&&i==="/"?(_=h+l-1,d=1,u=i,l+1):i==="#"?(d=2,_=h+l,l):/\s/.test(i)?(d=9,_=h+l,l):(w=/\d/.test(i),k=/[^\w_]/.test(i),_=h+l,d=w?4:k?3:9999,l)}function R(){return/[^\s]/g.test(i)?(E(s.join("")),d=999,l):(s.push(i),u=i,l+1)}function H(){return i!=="\r"&&i!==`
`||u==="\\"?(s.push(i),u=i,l+1):(E(s.join("")),d=999,l)}function V(){return i==="/"&&u==="*"?(s.push(i),E(s.join("")),d=999,l+1):(s.push(i),u=i,l+1)}function X(){if(u==="."&&/\d/.test(i))return d=5,l;if(u==="/"&&i==="*")return d=0,l;if(u==="/"&&i==="/")return d=1,l;if(i==="."&&s.length){for(;$(s););return d=5,l}if(i===";"||i===")"||i==="("){if(s.length)for(;$(s););return E(i),d=999,l+1}var B=s.length===2&&i!=="=";if(/[\w_\d\s]/.test(i)||B){for(;$(s););return d=999,l}return s.push(i),u=i,l+1}function $(B){for(var U,ee,j=0;;){if(U=n.indexOf(B.slice(0,B.length+j).join("")),ee=n[U],U===-1){if(j--+B.length>0)continue;ee=B.slice(0,1).join("")}return E(ee),_+=ee.length,(s=s.slice(ee.length)).length}}function G(){return/[^a-fA-F0-9]/.test(i)?(E(s.join("")),d=999,l):(s.push(i),u=i,l+1)}function W(){return i==="."||/[eE]/.test(i)?(s.push(i),d=5,u=i,l+1):i==="x"&&s.length===1&&s[0]==="0"?(d=11,s.push(i),u=i,l+1):/[^\d]/.test(i)?(E(s.join("")),d=999,l):(s.push(i),u=i,l+1)}function te(){return i==="f"&&(s.push(i),u=i,l+=1),/[eE]/.test(i)?(s.push(i),u=i,l+1):(i!=="-"&&i!=="+"||!/[eE]/.test(u))&&/[^\d]/.test(i)?(E(s.join("")),d=999,l):(s.push(i),u=i,l+1)}function N(){if(/[^\d\w_]/.test(i)){var B=s.join("");return d=S[B]?8:P[B]?7:6,E(s.join("")),d=999,l}return s.push(i),u=i,l+1}};var e=g("./lib/literals"),n=g("./lib/operators"),t=g("./lib/builtins"),a=g("./lib/literals-300es"),r=g("./lib/builtins-300es"),m=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(g,b,y){var e=g("./builtins");e=e.slice().filter(function(n){return!/^(gl\_|texture)/.test(n)}),b.exports=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(g,b,y){b.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(g,b,y){var e=g("./literals");b.exports=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(g,b,y){b.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(g,b,y){b.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(g,b,y){var e=g("./index");b.exports=function(n,t){var a=e(t),r=[];return r=(r=r.concat(a(n))).concat(a(null))}},{"./index":224}],231:[function(g,b,y){b.exports=function(e){typeof e=="string"&&(e=[e]);for(var n=[].slice.call(arguments,1),t=[],a=0;a<e.length-1;a++)t.push(e[a],n[a]||"");return t.push(e[a]),t.join("")}},{}],232:[function(g,b,y){var e=g("is-browser");b.exports=e&&function(){var n=!1;try{var t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{n=!1}return n}()},{"is-browser":236}],233:[function(g,b,y){b.exports=function(u,f){var l=u.length;if(l===0)throw new Error("Must have at least d+1 points");var h=u[0].length;if(l<=h)throw new Error("Must input at least d+1 points");var d=u.slice(0,h+1),s=e.apply(void 0,d);if(s===0)throw new Error("Input not in general position");for(var x=new Array(h+1),c=0;c<=h;++c)x[c]=c;s<0&&(x[0]=1,x[1]=0);var T=new t(x,new Array(h+1),!1),_=T.adjacent,w=new Array(h+2);for(c=0;c<=h;++c){for(var k=x.slice(),L=0;L<=h;++L)L===c&&(k[L]=-1);var A=k[0];k[0]=k[1],k[1]=A;var I=new t(k,new Array(h+1),!0);_[c]=I,w[c]=I}for(w[h+1]=T,c=0;c<=h;++c){k=_[c].vertices;var P=_[c].adjacent;for(L=0;L<=h;++L){var S=k[L];if(S<0)P[L]=T;else for(var E=0;E<=h;++E)_[E].vertices.indexOf(S)<0&&(P[L]=_[E])}}var D=new o(h,d,w),R=!!f;for(c=h+1;c<l;++c)D.insert(u[c],R);return D.boundary()};var e=g("robust-orientation"),n=g("simplicial-complex").compareCells;function t(u,f,l){this.vertices=u,this.adjacent=f,this.boundary=l,this.lastVisited=-1}function a(u,f,l){this.vertices=u,this.cell=f,this.index=l}function r(u,f){return n(u.vertices,f.vertices)}t.prototype.flip=function(){var u=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=u;var f=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=f};var m=[];function o(u,f,l){this.dimension=u,this.vertices=f,this.simplices=l,this.interior=l.filter(function(x){return!x.boundary}),this.tuple=new Array(u+1);for(var h=0;h<=u;++h)this.tuple[h]=this.vertices[h];var d,s=m[u];s||(s=m[u]=((d=e[u+1])||(d=e),function(x){return function(){var c=this.tuple;return x.apply(this,c)}}(d))),this.orient=s}var i=o.prototype;i.handleBoundaryDegeneracy=function(u,f){var l=this.dimension,h=this.vertices.length-1,d=this.tuple,s=this.vertices,x=[u];for(u.lastVisited=-h;x.length>0;)for(var c=(u=x.pop()).adjacent,T=0;T<=l;++T){var _=c[T];if(_.boundary&&!(_.lastVisited<=-h)){for(var w=_.vertices,k=0;k<=l;++k){var L=w[k];d[k]=L<0?f:s[L]}var A=this.orient();if(A>0)return _;_.lastVisited=-h,A===0&&x.push(_)}}return null},i.walk=function(u,f){var l=this.vertices.length-1,h=this.dimension,d=this.vertices,s=this.tuple,x=f?this.interior.length*Math.random()|0:this.interior.length-1,c=this.interior[x];e:for(;!c.boundary;){for(var T=c.vertices,_=c.adjacent,w=0;w<=h;++w)s[w]=d[T[w]];for(c.lastVisited=l,w=0;w<=h;++w){var k=_[w];if(!(k.lastVisited>=l)){var L=s[w];s[w]=u;var A=this.orient();if(s[w]=L,A<0){c=k;continue e}k.boundary?k.lastVisited=-l:k.lastVisited=l}}return}return c},i.addPeaks=function(u,f){var l=this.vertices.length-1,h=this.dimension,d=this.vertices,s=this.tuple,x=this.interior,c=this.simplices,T=[f];f.lastVisited=l,f.vertices[f.vertices.indexOf(-1)]=l,f.boundary=!1,x.push(f);for(var _=[];T.length>0;){var w=(f=T.pop()).vertices,k=f.adjacent,L=w.indexOf(l);if(!(L<0)){for(var A=0;A<=h;++A)if(A!==L){var I=k[A];if(I.boundary&&!(I.lastVisited>=l)){var P=I.vertices;if(I.lastVisited!==-l){for(var S=0,E=0;E<=h;++E)P[E]<0?(S=E,s[E]=u):s[E]=d[P[E]];if(this.orient()>0){P[S]=l,I.boundary=!1,x.push(I),T.push(I),I.lastVisited=l;continue}I.lastVisited=-l}var D=I.adjacent,R=w.slice(),H=k.slice(),V=new t(R,H,!0);c.push(V);var X=D.indexOf(f);if(!(X<0))for(D[X]=V,H[L]=I,R[A]=-1,H[A]=f,k[A]=V,V.flip(),E=0;E<=h;++E){var $=R[E];if(!($<0||$===l)){for(var G=new Array(h-1),W=0,te=0;te<=h;++te){var N=R[te];N<0||te===E||(G[W++]=N)}_.push(new a(G,V,E))}}}}}}for(_.sort(r),A=0;A+1<_.length;A+=2){var B=_[A],U=_[A+1],ee=B.index,j=U.index;ee<0||j<0||(B.cell.adjacent[B.index]=U.cell,U.cell.adjacent[U.index]=B.cell)}},i.insert=function(u,f){var l=this.vertices;l.push(u);var h=this.walk(u,f);if(h){for(var d=this.dimension,s=this.tuple,x=0;x<=d;++x){var c=h.vertices[x];s[x]=c<0?u:l[c]}var T=this.orient(s);T<0||(T!==0||(h=this.handleBoundaryDegeneracy(h,u)))&&this.addPeaks(u,h)}},i.boundary=function(){for(var u=this.dimension,f=[],l=this.simplices,h=l.length,d=0;d<h;++d){var s=l[d];if(s.boundary){for(var x=new Array(u),c=s.vertices,T=0,_=0,w=0;w<=u;++w)c[w]>=0?x[T++]=c[w]:_=1&w;if(_===(1&u)){var k=x[0];x[0]=x[1],x[1]=k}f.push(x)}}return f}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(g,b,y){var e=g("binary-search-bounds");function n(T,_,w,k,L){this.mid=T,this.left=_,this.right=w,this.leftPoints=k,this.rightPoints=L,this.count=(_?_.count:0)+(w?w.count:0)+k.length}b.exports=function(T){return!T||T.length===0?new x(null):new x(s(T))};var t=n.prototype;function a(T,_){T.mid=_.mid,T.left=_.left,T.right=_.right,T.leftPoints=_.leftPoints,T.rightPoints=_.rightPoints,T.count=_.count}function r(T,_){var w=s(_);T.mid=w.mid,T.left=w.left,T.right=w.right,T.leftPoints=w.leftPoints,T.rightPoints=w.rightPoints,T.count=w.count}function m(T,_){var w=T.intervals([]);w.push(_),r(T,w)}function o(T,_){var w=T.intervals([]),k=w.indexOf(_);return k<0?0:(w.splice(k,1),r(T,w),1)}function i(T,_,w){for(var k=0;k<T.length&&T[k][0]<=_;++k){var L=w(T[k]);if(L)return L}}function u(T,_,w){for(var k=T.length-1;k>=0&&T[k][1]>=_;--k){var L=w(T[k]);if(L)return L}}function f(T,_){for(var w=0;w<T.length;++w){var k=_(T[w]);if(k)return k}}function l(T,_){return T-_}function h(T,_){var w=T[0]-_[0];return w||T[1]-_[1]}function d(T,_){var w=T[1]-_[1];return w||T[0]-_[0]}function s(T){if(T.length===0)return null;for(var _=[],w=0;w<T.length;++w)_.push(T[w][0],T[w][1]);_.sort(l);var k=_[_.length>>1],L=[],A=[],I=[];for(w=0;w<T.length;++w){var P=T[w];P[1]<k?L.push(P):k<P[0]?A.push(P):I.push(P)}var S=I,E=I.slice();return S.sort(h),E.sort(d),new n(k,s(L),s(A),S,E)}function x(T){this.root=T}t.intervals=function(T){return T.push.apply(T,this.leftPoints),this.left&&this.left.intervals(T),this.right&&this.right.intervals(T),T},t.insert=function(T){var _=this.count-this.leftPoints.length;if(this.count+=1,T[1]<this.mid)this.left?4*(this.left.count+1)>3*(_+1)?m(this,T):this.left.insert(T):this.left=s([T]);else if(T[0]>this.mid)this.right?4*(this.right.count+1)>3*(_+1)?m(this,T):this.right.insert(T):this.right=s([T]);else{var w=e.ge(this.leftPoints,T,h),k=e.ge(this.rightPoints,T,d);this.leftPoints.splice(w,0,T),this.rightPoints.splice(k,0,T)}},t.remove=function(T){var _=this.count-this.leftPoints;if(T[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(_-1)?o(this,T):(A=this.left.remove(T))===2?(this.left=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(T[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(_-1)?o(this,T):(A=this.right.remove(T))===2?(this.right=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(this.count===1)return this.leftPoints[0]===T?2:0;if(this.leftPoints.length===1&&this.leftPoints[0]===T){if(this.left&&this.right){for(var w=this,k=this.left;k.right;)w=k,k=k.right;if(w===this)k.right=this.right;else{var L=this.left,A=this.right;w.count-=k.count,w.right=k.left,k.left=L,k.right=A}a(this,k),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?a(this,this.left):a(this,this.right);return 1}for(L=e.ge(this.leftPoints,T,h);L<this.leftPoints.length&&this.leftPoints[L][0]===T[0];++L)if(this.leftPoints[L]===T){for(this.count-=1,this.leftPoints.splice(L,1),A=e.ge(this.rightPoints,T,d);A<this.rightPoints.length&&this.rightPoints[A][1]===T[1];++A)if(this.rightPoints[A]===T)return this.rightPoints.splice(A,1),1}return 0},t.queryPoint=function(T,_){if(T<this.mid)return this.left&&(w=this.left.queryPoint(T,_))?w:i(this.leftPoints,T,_);if(T>this.mid){var w;return this.right&&(w=this.right.queryPoint(T,_))?w:u(this.rightPoints,T,_)}return f(this.leftPoints,_)},t.queryInterval=function(T,_,w){var k;return T<this.mid&&this.left&&(k=this.left.queryInterval(T,_,w))||_>this.mid&&this.right&&(k=this.right.queryInterval(T,_,w))?k:_<this.mid?i(this.leftPoints,_,w):T>this.mid?u(this.rightPoints,T,w):f(this.leftPoints,w)};var c=x.prototype;c.insert=function(T){this.root?this.root.insert(T):this.root=new n(T[0],null,null,[T],[T])},c.remove=function(T){if(this.root){var _=this.root.remove(T);return _===2&&(this.root=null),_!==0}return!1},c.queryPoint=function(T,_){if(this.root)return this.root.queryPoint(T,_)},c.queryInterval=function(T,_,w){if(T<=_&&this.root)return this.root.queryInterval(T,_,w)},Object.defineProperty(c,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(c,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":31}],235:[function(g,b,y){b.exports=function(e){for(var n=new Array(e),t=0;t<e;++t)n[t]=t;return n}},{}],236:[function(g,b,y){b.exports=!0},{}],237:[function(g,b,y){function e(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */b.exports=function(n){return n!=null&&(e(n)||function(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&e(t.slice(0,0))}(n)||!!n._isBuffer)}},{}],238:[function(g,b,y){b.exports=t,b.exports.isMobile=t,b.exports.default=t;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,n=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function t(a){a||(a={});var r=a.ua;if(r||typeof navigator>"u"||(r=navigator.userAgent),r&&r.headers&&typeof r.headers["user-agent"]=="string"&&(r=r.headers["user-agent"]),typeof r!="string")return!1;var m=a.tablet?n.test(r):e.test(r);return!m&&a.tablet&&a.featureDetect&&navigator&&navigator.maxTouchPoints>1&&r.indexOf("Macintosh")!==-1&&r.indexOf("Safari")!==-1&&(m=!0),m}},{}],239:[function(g,b,y){b.exports=function(e){for(var n,t=e.length,a=0;a<t;a++)if(((n=e.charCodeAt(a))<9||n>13)&&n!==32&&n!==133&&n!==160&&n!==5760&&n!==6158&&(n<8192||n>8205)&&n!==8232&&n!==8233&&n!==8239&&n!==8287&&n!==8288&&n!==12288&&n!==65279)return!1;return!0}},{}],240:[function(g,b,y){b.exports=function(e,n,t){return e*(1-t)+n*t}},{}],241:[function(g,b,y){var e=g("./normalize"),n=g("gl-mat4/create"),t=g("gl-mat4/clone"),a=g("gl-mat4/determinant"),r=g("gl-mat4/invert"),m=g("gl-mat4/transpose"),o={length:g("gl-vec3/length"),normalize:g("gl-vec3/normalize"),dot:g("gl-vec3/dot"),cross:g("gl-vec3/cross")},i=n(),u=n(),f=[0,0,0,0],l=[[0,0,0],[0,0,0],[0,0,0]],h=[0,0,0];function d(s,x,c,T,_){s[0]=x[0]*T+c[0]*_,s[1]=x[1]*T+c[1]*_,s[2]=x[2]*T+c[2]*_}b.exports=function(s,x,c,T,_,w){if(x||(x=[0,0,0]),c||(c=[0,0,0]),T||(T=[0,0,0]),_||(_=[0,0,0,1]),w||(w=[0,0,0,1]),!e(i,s)||(t(u,i),u[3]=0,u[7]=0,u[11]=0,u[15]=1,Math.abs(a(u)<1e-8)))return!1;var k,L,A,I,P,S,E,D=i[3],R=i[7],H=i[11],V=i[12],X=i[13],$=i[14],G=i[15];if(D!==0||R!==0||H!==0){if(f[0]=D,f[1]=R,f[2]=H,f[3]=G,!r(u,u))return!1;m(u,u),k=_,A=u,I=(L=f)[0],P=L[1],S=L[2],E=L[3],k[0]=A[0]*I+A[4]*P+A[8]*S+A[12]*E,k[1]=A[1]*I+A[5]*P+A[9]*S+A[13]*E,k[2]=A[2]*I+A[6]*P+A[10]*S+A[14]*E,k[3]=A[3]*I+A[7]*P+A[11]*S+A[15]*E}else _[0]=_[1]=_[2]=0,_[3]=1;if(x[0]=V,x[1]=X,x[2]=$,function(te,N){te[0][0]=N[0],te[0][1]=N[1],te[0][2]=N[2],te[1][0]=N[4],te[1][1]=N[5],te[1][2]=N[6],te[2][0]=N[8],te[2][1]=N[9],te[2][2]=N[10]}(l,i),c[0]=o.length(l[0]),o.normalize(l[0],l[0]),T[0]=o.dot(l[0],l[1]),d(l[1],l[1],l[0],1,-T[0]),c[1]=o.length(l[1]),o.normalize(l[1],l[1]),T[0]/=c[1],T[1]=o.dot(l[0],l[2]),d(l[2],l[2],l[0],1,-T[1]),T[2]=o.dot(l[1],l[2]),d(l[2],l[2],l[1],1,-T[2]),c[2]=o.length(l[2]),o.normalize(l[2],l[2]),T[1]/=c[2],T[2]/=c[2],o.cross(h,l[1],l[2]),o.dot(l[0],h)<0)for(var W=0;W<3;W++)c[W]*=-1,l[W][0]*=-1,l[W][1]*=-1,l[W][2]*=-1;return w[0]=.5*Math.sqrt(Math.max(1+l[0][0]-l[1][1]-l[2][2],0)),w[1]=.5*Math.sqrt(Math.max(1-l[0][0]+l[1][1]-l[2][2],0)),w[2]=.5*Math.sqrt(Math.max(1-l[0][0]-l[1][1]+l[2][2],0)),w[3]=.5*Math.sqrt(Math.max(1+l[0][0]+l[1][1]+l[2][2],0)),l[2][1]>l[1][2]&&(w[0]=-w[0]),l[0][2]>l[2][0]&&(w[1]=-w[1]),l[1][0]>l[0][1]&&(w[2]=-w[2]),!0}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(g,b,y){b.exports=function(e,n){var t=n[15];if(t===0)return!1;for(var a=1/t,r=0;r<16;r++)e[r]=n[r]*a;return!0}},{}],243:[function(g,b,y){var e=g("gl-vec3/lerp"),n=g("mat4-recompose"),t=g("mat4-decompose"),a=g("gl-mat4/determinant"),r=g("quat-slerp"),m=u(),o=u(),i=u();function u(){return{translate:f(),scale:f(1),skew:f(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function f(l){return[l||0,l||0,l||0]}b.exports=function(l,h,d,s){if(a(h)===0||a(d)===0)return!1;var x=t(h,m.translate,m.scale,m.skew,m.perspective,m.quaternion),c=t(d,o.translate,o.scale,o.skew,o.perspective,o.quaternion);return!(!x||!c)&&(e(i.translate,m.translate,o.translate,s),e(i.skew,m.skew,o.skew,s),e(i.scale,m.scale,o.scale,s),e(i.perspective,m.perspective,o.perspective,s),r(i.quaternion,m.quaternion,o.quaternion,s),n(l,i.translate,i.scale,i.skew,i.perspective,i.quaternion),!0)}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(g,b,y){var e={identity:g("gl-mat4/identity"),translate:g("gl-mat4/translate"),multiply:g("gl-mat4/multiply"),create:g("gl-mat4/create"),scale:g("gl-mat4/scale"),fromRotationTranslation:g("gl-mat4/fromRotationTranslation")},n=(e.create(),e.create());b.exports=function(t,a,r,m,o,i){return e.identity(t),e.fromRotationTranslation(t,i,a),t[3]=o[0],t[7]=o[1],t[11]=o[2],t[15]=o[3],e.identity(n),m[2]!==0&&(n[9]=m[2],e.multiply(t,t,n)),m[1]!==0&&(n[9]=0,n[8]=m[1],e.multiply(t,t,n)),m[0]!==0&&(n[8]=0,n[4]=m[0],e.multiply(t,t,n)),e.scale(t,t,r),t}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(g,b,y){var e=g("binary-search-bounds"),n=g("mat4-interpolate"),t=g("gl-mat4/invert"),a=g("gl-mat4/rotateX"),r=g("gl-mat4/rotateY"),m=g("gl-mat4/rotateZ"),o=g("gl-mat4/lookAt"),i=g("gl-mat4/translate"),u=(g("gl-mat4/scale"),g("gl-vec3/normalize")),f=[0,0,0];function l(s){this._components=s.slice(),this._time=[0],this.prevMatrix=s.slice(),this.nextMatrix=s.slice(),this.computedMatrix=s.slice(),this.computedInverse=s.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}b.exports=function(s){return new l((s=s||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var h=l.prototype;h.recalcMatrix=function(s){var x=this._time,c=e.le(x,s),T=this.computedMatrix;if(!(c<0)){var _=this._components;if(c===x.length-1)for(var w=16*c,k=0;k<16;++k)T[k]=_[w++];else{var L=x[c+1]-x[c],A=(w=16*c,this.prevMatrix),I=!0;for(k=0;k<16;++k)A[k]=_[w++];var P=this.nextMatrix;for(k=0;k<16;++k)P[k]=_[w++],I=I&&A[k]===P[k];if(L<1e-6||I)for(k=0;k<16;++k)T[k]=A[k];else n(T,A,P,(s-x[c])/L)}var S=this.computedUp;S[0]=T[1],S[1]=T[5],S[2]=T[9],u(S,S);var E=this.computedInverse;t(E,T);var D=this.computedEye,R=E[15];D[0]=E[12]/R,D[1]=E[13]/R,D[2]=E[14]/R;var H=this.computedCenter,V=Math.exp(this.computedRadius[0]);for(k=0;k<3;++k)H[k]=D[k]-T[2+4*k]*V}},h.idle=function(s){if(!(s<this.lastT())){for(var x=this._components,c=x.length-16,T=0;T<16;++T)x.push(x[c++]);this._time.push(s)}},h.flush=function(s){var x=e.gt(this._time,s)-2;x<0||(this._time.splice(0,x),this._components.splice(0,16*x))},h.lastT=function(){return this._time[this._time.length-1]},h.lookAt=function(s,x,c,T){this.recalcMatrix(s),x=x||this.computedEye,c=c||f,T=T||this.computedUp,this.setMatrix(s,o(this.computedMatrix,x,c,T));for(var _=0,w=0;w<3;++w)_+=Math.pow(c[w]-x[w],2);_=Math.log(Math.sqrt(_)),this.computedRadius[0]=_},h.rotate=function(s,x,c,T){this.recalcMatrix(s);var _=this.computedInverse;x&&r(_,_,x),c&&a(_,_,c),T&&m(_,_,T),this.setMatrix(s,t(this.computedMatrix,_))};var d=[0,0,0];h.pan=function(s,x,c,T){d[0]=-(x||0),d[1]=-(c||0),d[2]=-(T||0),this.recalcMatrix(s);var _=this.computedInverse;i(_,_,d),this.setMatrix(s,t(_,_))},h.translate=function(s,x,c,T){d[0]=x||0,d[1]=c||0,d[2]=T||0,this.recalcMatrix(s);var _=this.computedMatrix;i(_,_,d),this.setMatrix(s,_)},h.setMatrix=function(s,x){if(!(s<this.lastT())){this._time.push(s);for(var c=0;c<16;++c)this._components.push(x[c])}},h.setDistance=function(s,x){this.computedRadius[0]=x},h.setDistanceLimits=function(s,x){var c=this._limits;c[0]=s,c[1]=x},h.getDistanceLimits=function(s){var x=this._limits;return s?(s[0]=x[0],s[1]=x[1],s):x}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(g,b,y){b.exports=function(n){var t=n.length;if(t<3){for(var a=new Array(t),r=0;r<t;++r)a[r]=r;return t===2&&n[0][0]===n[1][0]&&n[0][1]===n[1][1]?[0]:a}var m=new Array(t);for(r=0;r<t;++r)m[r]=r;m.sort(function(x,c){var T=n[x][0]-n[c][0];return T||n[x][1]-n[c][1]});var o=[m[0],m[1]],i=[m[0],m[1]];for(r=2;r<t;++r){for(var u=m[r],f=n[u],l=o.length;l>1&&e(n[o[l-2]],n[o[l-1]],f)<=0;)l-=1,o.pop();for(o.push(u),l=i.length;l>1&&e(n[i[l-2]],n[i[l-1]],f)>=0;)l-=1,i.pop();i.push(u)}a=new Array(i.length+o.length-2);for(var h=0,d=(r=0,o.length);r<d;++r)a[h++]=o[r];for(var s=i.length-2;s>0;--s)a[h++]=i[s];return a};var e=g("robust-orientation")[3]},{"robust-orientation":284}],247:[function(g,b,y){b.exports=function(n,t){t||(t=n,n=window);var a=0,r=0,m=0,o={shift:!1,alt:!1,control:!1,meta:!1},i=!1;function u(w){var k=!1;return"altKey"in w&&(k=k||w.altKey!==o.alt,o.alt=!!w.altKey),"shiftKey"in w&&(k=k||w.shiftKey!==o.shift,o.shift=!!w.shiftKey),"ctrlKey"in w&&(k=k||w.ctrlKey!==o.control,o.control=!!w.ctrlKey),"metaKey"in w&&(k=k||w.metaKey!==o.meta,o.meta=!!w.metaKey),k}function f(w,k){var L=e.x(k),A=e.y(k);"buttons"in k&&(w=0|k.buttons),(w!==a||L!==r||A!==m||u(k))&&(a=0|w,r=L||0,m=A||0,t&&t(a,r,m,o))}function l(w){f(0,w)}function h(){(a||r||m||o.shift||o.alt||o.meta||o.control)&&(r=m=0,a=0,o.shift=o.alt=o.control=o.meta=!1,t&&t(0,0,0,o))}function d(w){u(w)&&t&&t(a,r,m,o)}function s(w){e.buttons(w)===0?f(0,w):f(a,w)}function x(w){f(a|e.buttons(w),w)}function c(w){f(a&~e.buttons(w),w)}function T(){i||(i=!0,n.addEventListener("mousemove",s),n.addEventListener("mousedown",x),n.addEventListener("mouseup",c),n.addEventListener("mouseleave",l),n.addEventListener("mouseenter",l),n.addEventListener("mouseout",l),n.addEventListener("mouseover",l),n.addEventListener("blur",h),n.addEventListener("keyup",d),n.addEventListener("keydown",d),n.addEventListener("keypress",d),n!==window&&(window.addEventListener("blur",h),window.addEventListener("keyup",d),window.addEventListener("keydown",d),window.addEventListener("keypress",d)))}T();var _={element:n};return Object.defineProperties(_,{enabled:{get:function(){return i},set:function(w){w?T():function(){!i||(i=!1,n.removeEventListener("mousemove",s),n.removeEventListener("mousedown",x),n.removeEventListener("mouseup",c),n.removeEventListener("mouseleave",l),n.removeEventListener("mouseenter",l),n.removeEventListener("mouseout",l),n.removeEventListener("mouseover",l),n.removeEventListener("blur",h),n.removeEventListener("keyup",d),n.removeEventListener("keydown",d),n.removeEventListener("keypress",d),n!==window&&(window.removeEventListener("blur",h),window.removeEventListener("keyup",d),window.removeEventListener("keydown",d),window.removeEventListener("keypress",d)))}()},enumerable:!0},buttons:{get:function(){return a},enumerable:!0},x:{get:function(){return r},enumerable:!0},y:{get:function(){return m},enumerable:!0},mods:{get:function(){return o},enumerable:!0}}),_};var e=g("mouse-event")},{"mouse-event":249}],248:[function(g,b,y){var e={left:0,top:0};b.exports=function(n,t,a){t=t||n.currentTarget||n.srcElement,Array.isArray(a)||(a=[0,0]);var r=n.clientX||0,m=n.clientY||0,o=(i=t,i===window||i===document||i===document.body?e:i.getBoundingClientRect()),i;return a[0]=r-o.left,a[1]=m-o.top,a}},{}],249:[function(g,b,y){function e(n){return n.target||n.srcElement||window}y.buttons=function(n){if(typeof n=="object"){if("buttons"in n)return n.buttons;if("which"in n){if((t=n.which)===2)return 4;if(t===3)return 2;if(t>0)return 1<<t-1}else if("button"in n){var t;if((t=n.button)===1)return 4;if(t===2)return 2;if(t>=0)return 1<<t}}return 0},y.element=e,y.x=function(n){if(typeof n=="object"){if("offsetX"in n)return n.offsetX;var t=e(n).getBoundingClientRect();return n.clientX-t.left}return 0},y.y=function(n){if(typeof n=="object"){if("offsetY"in n)return n.offsetY;var t=e(n).getBoundingClientRect();return n.clientY-t.top}return 0}},{}],250:[function(g,b,y){var e=g("to-px");b.exports=function(n,t,a){typeof n=="function"&&(a=!!t,t=n,n=window);var r=e("ex",n),m=function(o){a&&o.preventDefault();var i=o.deltaX||0,u=o.deltaY||0,f=o.deltaZ||0,l=1;switch(o.deltaMode){case 1:l=r;break;case 2:l=window.innerHeight}if(u*=l,f*=l,(i*=l)||u||f)return t(i,u,f,o)};return n.addEventListener("wheel",m),m}},{"to-px":304}],251:[function(g,b,y){var e=g("typedarray-pool");b.exports=function(t){function a(l){throw new Error("ndarray-extract-contour: "+l)}typeof t!="object"&&a("Must specify arguments");var r=t.order;Array.isArray(r)||a("Must specify order");var m=t.arrayArguments||1;m<1&&a("Must have at least one array argument");var o=t.scalarArguments||0;o<0&&a("Scalar arg count must be > 0"),typeof t.vertex!="function"&&a("Must specify vertex creation function"),typeof t.cell!="function"&&a("Must specify cell creation function"),typeof t.phase!="function"&&a("Must specify phase function");for(var i=t.getters||[],u=new Array(m),f=0;f<m;++f)i.indexOf(f)>=0?u[f]=!0:u[f]=!1;return function(l,h,d,s,x,c){var T=[c,x].join(",");return(0,n[T])(l,h,d,e.mallocUint32,e.freeUint32)}(t.vertex,t.cell,t.phase,0,r,u)};var n={"false,0,1":function(t,a,r,m,o){return function(i,u,f,l){var h,d=0|i.shape[0],s=0|i.shape[1],x=i.data,c=0|i.offset,T=0|i.stride[0],_=0|i.stride[1],w=c,k=0|-T,L=0,A=0|-_,I=0,P=-T-_|0,S=0,E=0|T,D=_-T*d|0,R=0,H=0,V=0,X=2*d|0,$=m(X),G=m(X),W=0,te=0,N=-1,B=-1,U=0,ee=0|-d,j=0|d,Q=0,K=-d-1|0,re=d-1|0,ne=0,le=0,oe=0;for(R=0;R<d;++R)$[W++]=r(x[w],u,f,l),w+=E;if(w+=D,s>0){if(H=1,$[W++]=r(x[w],u,f,l),w+=E,d>0)for(R=1,h=x[w],te=$[W]=r(h,u,f,l),U=$[W+N],Q=$[W+ee],ne=$[W+K],te===U&&te===Q&&te===ne||(L=x[w+k],I=x[w+A],S=x[w+P],t(R,H,h,L,I,S,te,U,Q,ne,u,f,l),le=G[W]=V++),W+=1,w+=E,R=2;R<d;++R)h=x[w],te=$[W]=r(h,u,f,l),U=$[W+N],Q=$[W+ee],ne=$[W+K],te===U&&te===Q&&te===ne||(L=x[w+k],I=x[w+A],S=x[w+P],t(R,H,h,L,I,S,te,U,Q,ne,u,f,l),le=G[W]=V++,ne!==U&&a(G[W+N],le,S,L,ne,U,u,f,l)),W+=1,w+=E;for(w+=D,W=0,oe=N,N=B,B=oe,oe=ee,ee=j,j=oe,oe=K,K=re,re=oe,H=2;H<s;++H){if($[W++]=r(x[w],u,f,l),w+=E,d>0)for(R=1,h=x[w],te=$[W]=r(h,u,f,l),U=$[W+N],Q=$[W+ee],ne=$[W+K],te===U&&te===Q&&te===ne||(L=x[w+k],I=x[w+A],S=x[w+P],t(R,H,h,L,I,S,te,U,Q,ne,u,f,l),le=G[W]=V++,ne!==Q&&a(G[W+ee],le,I,S,Q,ne,u,f,l)),W+=1,w+=E,R=2;R<d;++R)h=x[w],te=$[W]=r(h,u,f,l),U=$[W+N],Q=$[W+ee],ne=$[W+K],te===U&&te===Q&&te===ne||(L=x[w+k],I=x[w+A],S=x[w+P],t(R,H,h,L,I,S,te,U,Q,ne,u,f,l),le=G[W]=V++,ne!==Q&&a(G[W+ee],le,I,S,Q,ne,u,f,l),ne!==U&&a(G[W+N],le,S,L,ne,U,u,f,l)),W+=1,w+=E;1&H&&(W=0),oe=N,N=B,B=oe,oe=ee,ee=j,j=oe,oe=K,K=re,re=oe,w+=D}}o(G),o($)}},"false,1,0":function(t,a,r,m,o){return function(i,u,f,l){var h,d=0|i.shape[0],s=0|i.shape[1],x=i.data,c=0|i.offset,T=0|i.stride[0],_=0|i.stride[1],w=c,k=0|-T,L=0,A=0|-_,I=0,P=-T-_|0,S=0,E=0|_,D=T-_*s|0,R=0,H=0,V=0,X=2*s|0,$=m(X),G=m(X),W=0,te=0,N=-1,B=-1,U=0,ee=0|-s,j=0|s,Q=0,K=-s-1|0,re=s-1|0,ne=0,le=0,oe=0;for(H=0;H<s;++H)$[W++]=r(x[w],u,f,l),w+=E;if(w+=D,d>0){if(R=1,$[W++]=r(x[w],u,f,l),w+=E,s>0)for(H=1,h=x[w],te=$[W]=r(h,u,f,l),Q=$[W+ee],U=$[W+N],ne=$[W+K],te===Q&&te===U&&te===ne||(L=x[w+k],I=x[w+A],S=x[w+P],t(R,H,h,L,I,S,te,Q,U,ne,u,f,l),le=G[W]=V++),W+=1,w+=E,H=2;H<s;++H)h=x[w],te=$[W]=r(h,u,f,l),Q=$[W+ee],U=$[W+N],ne=$[W+K],te===Q&&te===U&&te===ne||(L=x[w+k],I=x[w+A],S=x[w+P],t(R,H,h,L,I,S,te,Q,U,ne,u,f,l),le=G[W]=V++,ne!==U&&a(G[W+N],le,I,S,U,ne,u,f,l)),W+=1,w+=E;for(w+=D,W=0,oe=ee,ee=j,j=oe,oe=N,N=B,B=oe,oe=K,K=re,re=oe,R=2;R<d;++R){if($[W++]=r(x[w],u,f,l),w+=E,s>0)for(H=1,h=x[w],te=$[W]=r(h,u,f,l),Q=$[W+ee],U=$[W+N],ne=$[W+K],te===Q&&te===U&&te===ne||(L=x[w+k],I=x[w+A],S=x[w+P],t(R,H,h,L,I,S,te,Q,U,ne,u,f,l),le=G[W]=V++,ne!==Q&&a(G[W+ee],le,S,L,ne,Q,u,f,l)),W+=1,w+=E,H=2;H<s;++H)h=x[w],te=$[W]=r(h,u,f,l),Q=$[W+ee],U=$[W+N],ne=$[W+K],te===Q&&te===U&&te===ne||(L=x[w+k],I=x[w+A],S=x[w+P],t(R,H,h,L,I,S,te,Q,U,ne,u,f,l),le=G[W]=V++,ne!==U&&a(G[W+N],le,I,S,U,ne,u,f,l),ne!==Q&&a(G[W+ee],le,S,L,ne,Q,u,f,l)),W+=1,w+=E;1&R&&(W=0),oe=ee,ee=j,j=oe,oe=N,N=B,B=oe,oe=K,K=re,re=oe,w+=D}}o(G),o($)}}}},{"typedarray-pool":308}],252:[function(g,b,y){var e=g("dup"),n={zero:function(d,s,x,c){var T=d[0];c|=0;var _=0,w=x[0];for(_=0;_<T;++_)s[c]=0,c+=w},fdTemplate1:function(d,s,x,c,T,_,w){var k=d[0],L=x[0],A=-1*L,I=L;c|=0,w|=0;var P=0,S=L,E=_[0];for(P=0;P<k;++P)T[w]=.5*(s[c+A]-s[c+I]),c+=S,w+=E},fdTemplate2:function(d,s,x,c,T,_,w,k,L,A){var I=d[0],P=d[1],S=x[0],E=x[1],D=_[0],R=_[1],H=L[0],V=L[1],X=-1*S,$=S,G=-1*E,W=E;c|=0,w|=0,A|=0;var te=0,N=0,B=E,U=S-P*E,ee=R,j=D-P*R,Q=V,K=H-P*V;for(N=0;N<I;++N){for(te=0;te<P;++te)T[w]=.5*(s[c+X]-s[c+$]),k[A]=.5*(s[c+G]-s[c+W]),c+=B,w+=ee,A+=Q;c+=U,w+=j,A+=K}}},t={cdiff:function(d){var s={};return function(x,c,T){var _=x.dtype,w=x.order,k=c.dtype,L=c.order,A=T.dtype,I=T.order,P=[_,w.join(),k,L.join(),A,I.join()].join(),S=s[P];return S||(s[P]=S=d([_,w,k,L,A,I])),S(x.shape.slice(0),x.data,x.stride,0|x.offset,c.data,c.stride,0|c.offset,T.data,T.stride,0|T.offset)}},zero:function(d){var s={};return function(x){var c=x.dtype,T=x.order,_=[c,T.join()].join(),w=s[_];return w||(s[_]=w=d([c,T])),w(x.shape.slice(0),x.data,x.stride,0|x.offset)}},fdTemplate1:function(d){var s={};return function(x,c){var T=x.dtype,_=x.order,w=c.dtype,k=c.order,L=[T,_.join(),w,k.join()].join(),A=s[L];return A||(s[L]=A=d([T,_,w,k])),A(x.shape.slice(0),x.data,x.stride,0|x.offset,c.data,c.stride,0|c.offset)}},fdTemplate2:function(d){var s={};return function(x,c,T){var _=x.dtype,w=x.order,k=c.dtype,L=c.order,A=T.dtype,I=T.order,P=[_,w.join(),k,L.join(),A,I.join()].join(),S=s[P];return S||(s[P]=S=d([_,w,k,L,A,I])),S(x.shape.slice(0),x.data,x.stride,0|x.offset,c.data,c.stride,0|c.offset,T.data,T.stride,0|T.offset)}}};function a(d){return(0,t[d.funcName])(r.bind(void 0,d))}function r(d){return n[d.funcName]}function m(d){return a({funcName:d.funcName})}var o={},i={},u=m({funcName:"cdiff"}),f=m({funcName:"zero"});function l(d){return d in o?o[d]:o[d]=m({funcName:"fdTemplate"+d})}function h(d,s,x,c){return function(T,_){var w=_.shape.slice();return w[0]>2&&w[1]>2&&c(_.pick(-1,-1).lo(1,1).hi(w[0]-2,w[1]-2),T.pick(-1,-1,0).lo(1,1).hi(w[0]-2,w[1]-2),T.pick(-1,-1,1).lo(1,1).hi(w[0]-2,w[1]-2)),w[1]>2&&(x(_.pick(0,-1).lo(1).hi(w[1]-2),T.pick(0,-1,1).lo(1).hi(w[1]-2)),s(T.pick(0,-1,0).lo(1).hi(w[1]-2))),w[1]>2&&(x(_.pick(w[0]-1,-1).lo(1).hi(w[1]-2),T.pick(w[0]-1,-1,1).lo(1).hi(w[1]-2)),s(T.pick(w[0]-1,-1,0).lo(1).hi(w[1]-2))),w[0]>2&&(x(_.pick(-1,0).lo(1).hi(w[0]-2),T.pick(-1,0,0).lo(1).hi(w[0]-2)),s(T.pick(-1,0,1).lo(1).hi(w[0]-2))),w[0]>2&&(x(_.pick(-1,w[1]-1).lo(1).hi(w[0]-2),T.pick(-1,w[1]-1,0).lo(1).hi(w[0]-2)),s(T.pick(-1,w[1]-1,1).lo(1).hi(w[0]-2))),T.set(0,0,0,0),T.set(0,0,1,0),T.set(w[0]-1,0,0,0),T.set(w[0]-1,0,1,0),T.set(0,w[1]-1,0,0),T.set(0,w[1]-1,1,0),T.set(w[0]-1,w[1]-1,0,0),T.set(w[0]-1,w[1]-1,1,0),T}}b.exports=function(d,s,x){return Array.isArray(x)||(x=e(s.dimension,typeof x=="string"?x:"clamp")),s.size===0?d:s.dimension===0?(d.set(0),d):function(c){var T=c.join();if(L=i[T])return L;for(var _=c.length,w=[u,f],k=1;k<=_;++k)w.push(l(k));var L=h.apply(void 0,w);return i[T]=L,L}(x)(d,s)}},{dup:65}],253:[function(g,b,y){function e(r,m){var o=Math.floor(m),i=m-o,u=0<=o&&o<r.shape[0],f=0<=o+1&&o+1<r.shape[0];return(1-i)*(u?+r.get(o):0)+i*(f?+r.get(o+1):0)}function n(r,m,o){var i=Math.floor(m),u=m-i,f=0<=i&&i<r.shape[0],l=0<=i+1&&i+1<r.shape[0],h=Math.floor(o),d=o-h,s=0<=h&&h<r.shape[1],x=0<=h+1&&h+1<r.shape[1],c=f&&s?r.get(i,h):0,T=f&&x?r.get(i,h+1):0;return(1-d)*((1-u)*c+u*(l&&s?r.get(i+1,h):0))+d*((1-u)*T+u*(l&&x?r.get(i+1,h+1):0))}function t(r,m,o,i){var u=Math.floor(m),f=m-u,l=0<=u&&u<r.shape[0],h=0<=u+1&&u+1<r.shape[0],d=Math.floor(o),s=o-d,x=0<=d&&d<r.shape[1],c=0<=d+1&&d+1<r.shape[1],T=Math.floor(i),_=i-T,w=0<=T&&T<r.shape[2],k=0<=T+1&&T+1<r.shape[2],L=l&&x&&w?r.get(u,d,T):0,A=l&&c&&w?r.get(u,d+1,T):0,I=h&&x&&w?r.get(u+1,d,T):0,P=h&&c&&w?r.get(u+1,d+1,T):0,S=l&&x&&k?r.get(u,d,T+1):0,E=l&&c&&k?r.get(u,d+1,T+1):0;return(1-_)*((1-s)*((1-f)*L+f*I)+s*((1-f)*A+f*P))+_*((1-s)*((1-f)*S+f*(h&&x&&k?r.get(u+1,d,T+1):0))+s*((1-f)*E+f*(h&&c&&k?r.get(u+1,d+1,T+1):0)))}function a(r){var m,o,i=0|r.shape.length,u=new Array(i),f=new Array(i),l=new Array(i),h=new Array(i);for(m=0;m<i;++m)o=+arguments[m+1],u[m]=Math.floor(o),f[m]=o-u[m],l[m]=0<=u[m]&&u[m]<r.shape[m],h[m]=0<=u[m]+1&&u[m]+1<r.shape[m];var d,s,x,c=0;e:for(m=0;m<1<<i;++m){for(s=1,x=r.offset,d=0;d<i;++d)if(m&1<<d){if(!h[d])continue e;s*=f[d],x+=r.stride[d]*(u[d]+1)}else{if(!l[d])continue e;s*=1-f[d],x+=r.stride[d]*u[d]}c+=s*r.data[x]}return c}b.exports=function(r,m,o,i){switch(r.shape.length){case 0:return 0;case 1:return e(r,m);case 2:return n(r,m,o);case 3:return t(r,m,o,i);default:return a.apply(void 0,arguments)}},b.exports.d1=e,b.exports.d2=n,b.exports.d3=t},{}],254:[function(g,b,y){var e={"float64,2,1,0":function(){return function(m,o,i,u,f){var l=m[0],h=m[1],d=m[2],s=i[0],x=i[1],c=i[2];u|=0;var T=0,_=0,w=0,k=c,L=x-d*c,A=s-h*x;for(w=0;w<l;++w){for(_=0;_<h;++_){for(T=0;T<d;++T)o[u]/=f,u+=k;u+=L}u+=A}}},"uint8,2,0,1,float64,2,1,0":function(){return function(m,o,i,u,f,l,h,d){for(var s=m[0],x=m[1],c=m[2],T=i[0],_=i[1],w=i[2],k=l[0],L=l[1],A=l[2],I=u|=0,P=h|=0,S=0|m[0];S>0;){S<64?(s=S,S=0):(s=64,S-=64);for(var E=0|m[1];E>0;){E<64?(x=E,E=0):(x=64,E-=64),u=I+S*T+E*_,h=P+S*k+E*L;var D=0,R=0,H=0,V=w,X=T-c*w,$=_-s*T,G=A,W=k-c*A,te=L-s*k;for(H=0;H<x;++H){for(R=0;R<s;++R){for(D=0;D<c;++D)o[u]=f[h]*d,u+=V,h+=G;u+=X,h+=W}u+=$,h+=te}}}}},"float32,1,0,float32,1,0":function(){return function(m,o,i,u,f,l,h){var d=m[0],s=m[1],x=i[0],c=i[1],T=l[0],_=l[1];u|=0,h|=0;var w=0,k=0,L=c,A=x-s*c,I=_,P=T-s*_;for(k=0;k<d;++k){for(w=0;w<s;++w)o[u]=f[h],u+=L,h+=I;u+=A,h+=P}}},"float32,1,0,float32,0,1":function(){return function(m,o,i,u,f,l,h){for(var d=m[0],s=m[1],x=i[0],c=i[1],T=l[0],_=l[1],w=u|=0,k=h|=0,L=0|m[1];L>0;){L<64?(s=L,L=0):(s=64,L-=64);for(var A=0|m[0];A>0;){A<64?(d=A,A=0):(d=64,A-=64),u=w+L*c+A*x,h=k+L*_+A*T;var I=0,P=0,S=c,E=x-s*c,D=_,R=T-s*_;for(P=0;P<d;++P){for(I=0;I<s;++I)o[u]=f[h],u+=S,h+=D;u+=E,h+=R}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(m,o,i,u,f,l,h){for(var d=m[0],s=m[1],x=m[2],c=i[0],T=i[1],_=i[2],w=l[0],k=l[1],L=l[2],A=u|=0,I=h|=0,P=0|m[2];P>0;){P<64?(x=P,P=0):(x=64,P-=64);for(var S=0|m[0];S>0;){S<64?(d=S,S=0):(d=64,S-=64);for(var E=0|m[1];E>0;){E<64?(s=E,E=0):(s=64,E-=64),u=A+P*_+S*c+E*T,h=I+P*L+S*w+E*k;var D=0,R=0,H=0,V=_,X=c-x*_,$=T-d*c,G=L,W=w-x*L,te=k-d*w;for(H=0;H<s;++H){for(R=0;R<d;++R){for(D=0;D<x;++D)o[u]=f[h],u+=V,h+=G;u+=X,h+=W}u+=$,h+=te}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(m,o,i,u,f,l,h){var d=m[0],s=m[1],x=m[2],c=i[0],T=i[1],_=i[2],w=l[0],k=l[1],L=l[2];u|=0,h|=0;var A=0,I=0,P=0,S=_,E=c-x*_,D=T-d*c,R=L,H=w-x*L,V=k-d*w;for(P=0;P<s;++P){for(I=0;I<d;++I){for(A=0;A<x;++A)o[u]=f[h],u+=S,h+=R;u+=E,h+=H}u+=D,h+=V}}}},n=function(m,o){var i=o.join(",");return(0,e[i])()},t={mul:function(m){var o={};return function(i,u,f){var l=i.dtype,h=i.order,d=u.dtype,s=u.order,x=f.dtype,c=f.order,T=[l,h.join(),d,s.join(),x,c.join()].join(),_=o[T];return _||(o[T]=_=m([l,h,d,s,x,c])),_(i.shape.slice(0),i.data,i.stride,0|i.offset,u.data,u.stride,0|u.offset,f.data,f.stride,0|f.offset)}},muls:function(m){var o={};return function(i,u,f){var l=i.dtype,h=i.order,d=u.dtype,s=u.order,x=[l,h.join(),d,s.join()].join(),c=o[x];return c||(o[x]=c=m([l,h,d,s])),c(i.shape.slice(0),i.data,i.stride,0|i.offset,u.data,u.stride,0|u.offset,f)}},mulseq:function(m){var o={};return function(i,u){var f=i.dtype,l=i.order,h=[f,l.join()].join(),d=o[h];return d||(o[h]=d=m([f,l])),d(i.shape.slice(0),i.data,i.stride,0|i.offset,u)}},div:function(m){var o={};return function(i,u,f){var l=i.dtype,h=i.order,d=u.dtype,s=u.order,x=f.dtype,c=f.order,T=[l,h.join(),d,s.join(),x,c.join()].join(),_=o[T];return _||(o[T]=_=m([l,h,d,s,x,c])),_(i.shape.slice(0),i.data,i.stride,0|i.offset,u.data,u.stride,0|u.offset,f.data,f.stride,0|f.offset)}},divs:function(m){var o={};return function(i,u,f){var l=i.dtype,h=i.order,d=u.dtype,s=u.order,x=[l,h.join(),d,s.join()].join(),c=o[x];return c||(o[x]=c=m([l,h,d,s])),c(i.shape.slice(0),i.data,i.stride,0|i.offset,u.data,u.stride,0|u.offset,f)}},divseq:function(m){var o={};return function(i,u){var f=i.dtype,l=i.order,h=[f,l.join()].join(),d=o[h];return d||(o[h]=d=m([f,l])),d(i.shape.slice(0),i.data,i.stride,0|i.offset,u)}},assign:function(m){var o={};return function(i,u){var f=i.dtype,l=i.order,h=u.dtype,d=u.order,s=[f,l.join(),h,d.join()].join(),x=o[s];return x||(o[s]=x=m([f,l,h,d])),x(i.shape.slice(0),i.data,i.stride,0|i.offset,u.data,u.stride,0|u.offset)}}};function a(m){return o={funcName:m.funcName},(0,t[o.funcName])(n.bind(void 0,o));var o}var r={mul:"*",div:"/"};(function(){for(var m in r)y[m]=a({funcName:m}),y[m+"s"]=a({funcName:m+"s"}),y[m+"seq"]=a({funcName:m+"seq"})})(),y.assign=a({funcName:"assign"})},{}],255:[function(g,b,y){var e=g("ndarray"),n=g("./doConvert.js");b.exports=function(t,a){for(var r=[],m=t,o=1;Array.isArray(m);)r.push(m.length),o*=m.length,m=m[0];return r.length===0?e():(a||(a=e(new Float64Array(o),r)),n(a,t),a)}},{"./doConvert.js":256,ndarray:259}],256:[function(g,b,y){var e,n=function(){return function(t,a,r,m,o){var i=t[0],u=t[1],f=t[2],l=r[0],h=r[1],d=r[2],s=[0,0,0];m|=0;var x=0,c=0,T=0,_=d,w=h-f*d,k=l-u*h;for(T=0;T<i;++T){for(c=0;c<u;++c){for(x=0;x<f;++x){var L,A=o;for(L=0;L<s.length-1;++L)A=A[s[L]];a[m]=A[s[s.length-1]],m+=_,++s[2]}m+=w,s[2]-=f,++s[1]}m+=k,s[1]-=u,++s[0]}}};b.exports=(e={funcName:"convert"},function(t){var a={};return function(r,m){var o=r.dtype,i=r.order,u=[o,i.join()].join(),f=a[u];return f||(a[u]=f=t([o,i])),f(r.shape.slice(0),r.data,r.stride,0|r.offset,m)}}(n.bind(void 0,e)))},{}],257:[function(g,b,y){var e=g("typedarray-pool");function n(m){switch(m){case"uint32":return[e.mallocUint32,e.freeUint32];default:return null}}var t={"uint32,1,0":function(m,o){return function(i,u,f,l,h,d,s,x,c,T,_){var w,k,L,A,I,P,S,E,D=i*h+l,R=m(x);for(w=i+1;w<=u;++w){for(k=w,L=D+=h,I=0,P=D,A=0;A<x;++A)R[I++]=f[P],P+=c;e:for(;k-- >i;){I=0,P=L-h;t:for(A=0;A<x;++A){if((S=f[P])<(E=R[I]))break e;if(S>E)break t;P+=T,I+=_}for(I=L,P=L-h,A=0;A<x;++A)f[I]=f[P],I+=c,P+=c;L-=h}for(I=L,P=0,A=0;A<x;++A)f[I]=R[P++],I+=c}o(R)}}},a={"uint32,1,0":function(m,o,i){return function u(f,l,h,d,s,x,c,T,_,w,k){var L,A,I,P,S,E,D,R,H,V,X,$,G,W,te,N,B,U,ee,j,Q,K,re,ne,le,oe=(l-f+1)/6|0,de=f+oe,se=l-oe,me=f+l>>1,Te=me-oe,_e=me+oe,be=de,Ce=Te,fe=me,ve=_e,Me=se,ke=f+1,Le=l-1,ze=!0,Re=0,Oe=0,Ze=0,Pe=T,Ie=o(Pe),Be=o(Pe);X=s*be,$=s*Ce,le=d;e:for(V=0;V<T;++V){if(R=$+le,(Ze=h[D=X+le]-h[R])>0){A=be,be=Ce,Ce=A;break e}if(Ze<0)break e;le+=w}X=s*ve,$=s*Me,le=d;e:for(V=0;V<T;++V){if(R=$+le,(Ze=h[D=X+le]-h[R])>0){A=ve,ve=Me,Me=A;break e}if(Ze<0)break e;le+=w}X=s*be,$=s*fe,le=d;e:for(V=0;V<T;++V){if(R=$+le,(Ze=h[D=X+le]-h[R])>0){A=be,be=fe,fe=A;break e}if(Ze<0)break e;le+=w}X=s*Ce,$=s*fe,le=d;e:for(V=0;V<T;++V){if(R=$+le,(Ze=h[D=X+le]-h[R])>0){A=Ce,Ce=fe,fe=A;break e}if(Ze<0)break e;le+=w}X=s*be,$=s*ve,le=d;e:for(V=0;V<T;++V){if(R=$+le,(Ze=h[D=X+le]-h[R])>0){A=be,be=ve,ve=A;break e}if(Ze<0)break e;le+=w}X=s*fe,$=s*ve,le=d;e:for(V=0;V<T;++V){if(R=$+le,(Ze=h[D=X+le]-h[R])>0){A=fe,fe=ve,ve=A;break e}if(Ze<0)break e;le+=w}X=s*Ce,$=s*Me,le=d;e:for(V=0;V<T;++V){if(R=$+le,(Ze=h[D=X+le]-h[R])>0){A=Ce,Ce=Me,Me=A;break e}if(Ze<0)break e;le+=w}X=s*Ce,$=s*fe,le=d;e:for(V=0;V<T;++V){if(R=$+le,(Ze=h[D=X+le]-h[R])>0){A=Ce,Ce=fe,fe=A;break e}if(Ze<0)break e;le+=w}X=s*ve,$=s*Me,le=d;e:for(V=0;V<T;++V){if(R=$+le,(Ze=h[D=X+le]-h[R])>0){A=ve,ve=Me,Me=A;break e}if(Ze<0)break e;le+=w}for(X=s*be,$=s*Ce,G=s*fe,W=s*ve,te=s*Me,N=s*de,B=s*me,U=s*se,ne=0,le=d,V=0;V<T;++V)D=X+le,R=$+le,H=G+le,ee=W+le,j=te+le,Q=N+le,K=B+le,re=U+le,Ie[ne]=h[R],Be[ne]=h[ee],ze=ze&&Ie[ne]===Be[ne],I=h[D],P=h[H],S=h[j],h[Q]=I,h[K]=P,h[re]=S,++ne,le+=_;for(X=s*Te,$=s*f,le=d,V=0;V<T;++V)R=$+le,h[D=X+le]=h[R],le+=_;for(X=s*_e,$=s*l,le=d,V=0;V<T;++V)R=$+le,h[D=X+le]=h[R],le+=_;if(ze)for(E=ke;E<=Le;++E){for(D=d+E*s,ne=0,V=0;V<T&&(Ze=h[D]-Ie[ne])===0;++V)ne+=k,D+=w;if(Ze!==0)if(Ze<0){if(E!==ke)for(X=s*E,$=s*ke,le=d,V=0;V<T;++V)R=$+le,L=h[D=X+le],h[D]=h[R],h[R]=L,le+=_;++ke}else for(;;){for(D=d+Le*s,ne=0,V=0;V<T&&(Ze=h[D]-Ie[ne])===0;++V)ne+=k,D+=w;if(!(Ze>0)){if(Ze<0){for(X=s*E,$=s*ke,G=s*Le,le=d,V=0;V<T;++V)R=$+le,H=G+le,L=h[D=X+le],h[D]=h[R],h[R]=h[H],h[H]=L,le+=_;++ke,--Le;break}for(X=s*E,$=s*Le,le=d,V=0;V<T;++V)R=$+le,L=h[D=X+le],h[D]=h[R],h[R]=L,le+=_;--Le;break}Le--}}else for(E=ke;E<=Le;++E){for(D=d+E*s,ne=0,V=0;V<T&&(Re=h[D]-Ie[ne])===0;++V)ne+=k,D+=w;if(Re<0){if(E!==ke)for(X=s*E,$=s*ke,le=d,V=0;V<T;++V)R=$+le,L=h[D=X+le],h[D]=h[R],h[R]=L,le+=_;++ke}else{for(D=d+E*s,ne=0,V=0;V<T&&(Oe=h[D]-Be[ne])===0;++V)ne+=k,D+=w;if(Oe>0)for(;;){for(D=d+Le*s,ne=0,V=0;V<T&&(Ze=h[D]-Be[ne])===0;++V)ne+=k,D+=w;if(!(Ze>0)){for(D=d+Le*s,ne=0,V=0;V<T&&(Ze=h[D]-Ie[ne])===0;++V)ne+=k,D+=w;if(Ze<0){for(X=s*E,$=s*ke,G=s*Le,le=d,V=0;V<T;++V)R=$+le,H=G+le,L=h[D=X+le],h[D]=h[R],h[R]=h[H],h[H]=L,le+=_;++ke,--Le}else{for(X=s*E,$=s*Le,le=d,V=0;V<T;++V)R=$+le,L=h[D=X+le],h[D]=h[R],h[R]=L,le+=_;--Le}break}if(--Le<E)break}}}for(X=s*f,$=s*(ke-1),ne=0,le=d,V=0;V<T;++V)R=$+le,h[D=X+le]=h[R],h[R]=Ie[ne],++ne,le+=_;for(X=s*l,$=s*(Le+1),ne=0,le=d,V=0;V<T;++V)R=$+le,h[D=X+le]=h[R],h[R]=Be[ne],++ne,le+=_;if(ke-2-f<=32?m(f,ke-2,h,d,s,x,c,T,_,w,k):u(f,ke-2,h,d,s,x,c,T,_,w,k),l-(Le+2)<=32?m(Le+2,l,h,d,s,x,c,T,_,w,k):u(Le+2,l,h,d,s,x,c,T,_,w,k),ze)return i(Ie),void i(Be);if(ke<de&&Le>se){e:for(;;){for(D=d+ke*s,ne=0,le=d,V=0;V<T;++V){if(h[D]!==Ie[ne])break e;++ne,D+=_}++ke}e:for(;;){for(D=d+Le*s,ne=0,le=d,V=0;V<T;++V){if(h[D]!==Be[ne])break e;++ne,D+=_}--Le}for(E=ke;E<=Le;++E){for(D=d+E*s,ne=0,V=0;V<T&&(Re=h[D]-Ie[ne])===0;++V)ne+=k,D+=w;if(Re===0){if(E!==ke)for(X=s*E,$=s*ke,le=d,V=0;V<T;++V)R=$+le,L=h[D=X+le],h[D]=h[R],h[R]=L,le+=_;++ke}else{for(D=d+E*s,ne=0,V=0;V<T&&(Oe=h[D]-Be[ne])===0;++V)ne+=k,D+=w;if(Oe===0)for(;;){for(D=d+Le*s,ne=0,V=0;V<T&&(Ze=h[D]-Be[ne])===0;++V)ne+=k,D+=w;if(Ze!==0){for(D=d+Le*s,ne=0,V=0;V<T&&(Ze=h[D]-Ie[ne])===0;++V)ne+=k,D+=w;if(Ze<0){for(X=s*E,$=s*ke,G=s*Le,le=d,V=0;V<T;++V)R=$+le,H=G+le,L=h[D=X+le],h[D]=h[R],h[R]=h[H],h[H]=L,le+=_;++ke,--Le}else{for(X=s*E,$=s*Le,le=d,V=0;V<T;++V)R=$+le,L=h[D=X+le],h[D]=h[R],h[R]=L,le+=_;--Le}break}if(--Le<E)break}}}}i(Ie),i(Be),Le-ke<=32?m(ke,Le,h,d,s,x,c,T,_,w,k):u(ke,Le,h,d,s,x,c,T,_,w,k)}}},r={"uint32,1,0":function(m,o){return function(i){var u=i.data,f=0|i.offset,l=i.shape,h=i.stride,d=0|h[0],s=0|l[0],x=0|h[1],c=0|l[1],T=x,_=x;s<=32?m(0,s-1,u,f,d,x,s,c,T,_,1):o(0,s-1,u,f,d,x,s,c,T,_,1)}}};b.exports=function(m,o){var i=[o,m].join(","),u=r[i],f=function(h,d){var s=n(d),x=[d,h].join(","),c=t[x];return s?c(s[0],s[1]):c()}(m,o),l=function(h,d,s){var x=n(d),c=[d,h].join(","),T=a[c];return h.length>1&&x?T(s,x[0],x[1]):T(s)}(m,o,f);return u(f,l)}},{"typedarray-pool":308}],258:[function(g,b,y){var e=g("./lib/compile_sort.js"),n={};b.exports=function(t){var a=t.order,r=t.dtype,m=[a,r].join(":"),o=n[m];return o||(n[m]=o=e(a,r)),o(t),t}},{"./lib/compile_sort.js":257}],259:[function(g,b,y){var e=g("is-buffer"),n=typeof Float64Array<"u";function t(i,u){return i[0]-u[0]}function a(){var i,u=this.stride,f=new Array(u.length);for(i=0;i<f.length;++i)f[i]=[Math.abs(u[i]),i];f.sort(t);var l=new Array(f.length);for(i=0;i<l.length;++i)l[i]=f[i][1];return l}var r={T:function(i){function u(l){this.data=l}var f=u.prototype;return f.dtype=i,f.index=function(){return-1},f.size=0,f.dimension=-1,f.shape=f.stride=f.order=[],f.lo=f.hi=f.transpose=f.step=function(){return new u(this.data)},f.get=f.set=function(){},f.pick=function(){return null},function(l){return new u(l)}},0:function(i,u){function f(h,d){this.data=h,this.offset=d}var l=f.prototype;return l.dtype=i,l.index=function(){return this.offset},l.dimension=0,l.size=1,l.shape=l.stride=l.order=[],l.lo=l.hi=l.transpose=l.step=function(){return new f(this.data,this.offset)},l.pick=function(){return u(this.data)},l.valueOf=l.get=function(){return i==="generic"?this.data.get(this.offset):this.data[this.offset]},l.set=function(h){return i==="generic"?this.data.set(this.offset,h):this.data[this.offset]=h},function(h,d,s,x){return new f(h,x)}},1:function(i,u,f){function l(d,s,x,c){this.data=d,this.shape=[s],this.stride=[x],this.offset=0|c}var h=l.prototype;return h.dtype=i,h.dimension=1,Object.defineProperty(h,"size",{get:function(){return this.shape[0]}}),h.order=[0],h.set=function(d,s){return i==="generic"?this.data.set(this.offset+this.stride[0]*d,s):this.data[this.offset+this.stride[0]*d]=s},h.get=function(d){return i==="generic"?this.data.get(this.offset+this.stride[0]*d):this.data[this.offset+this.stride[0]*d]},h.index=function(d){return this.offset+this.stride[0]*d},h.hi=function(d){return new l(this.data,typeof d!="number"||d<0?this.shape[0]:0|d,this.stride[0],this.offset)},h.lo=function(d){var s=this.offset,x=0,c=this.shape[0],T=this.stride[0];return typeof d=="number"&&d>=0&&(s+=T*(x=0|d),c-=x),new l(this.data,c,T,s)},h.step=function(d){var s=this.shape[0],x=this.stride[0],c=this.offset,T=0,_=Math.ceil;return typeof d=="number"&&((T=0|d)<0?(c+=x*(s-1),s=_(-s/T)):s=_(s/T),x*=T),new l(this.data,s,x,c)},h.transpose=function(d){d=d===void 0?0:0|d;var s=this.shape,x=this.stride;return new l(this.data,s[d],x[d],this.offset)},h.pick=function(d){var s=[],x=[],c=this.offset;return typeof d=="number"&&d>=0?c=c+this.stride[0]*d|0:(s.push(this.shape[0]),x.push(this.stride[0])),(0,u[s.length+1])(this.data,s,x,c)},function(d,s,x,c){return new l(d,s[0],x[0],c)}},2:function(i,u,f){function l(d,s,x,c,T,_){this.data=d,this.shape=[s,x],this.stride=[c,T],this.offset=0|_}var h=l.prototype;return h.dtype=i,h.dimension=2,Object.defineProperty(h,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(h,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),h.set=function(d,s,x){return i==="generic"?this.data.set(this.offset+this.stride[0]*d+this.stride[1]*s,x):this.data[this.offset+this.stride[0]*d+this.stride[1]*s]=x},h.get=function(d,s){return i==="generic"?this.data.get(this.offset+this.stride[0]*d+this.stride[1]*s):this.data[this.offset+this.stride[0]*d+this.stride[1]*s]},h.index=function(d,s){return this.offset+this.stride[0]*d+this.stride[1]*s},h.hi=function(d,s){return new l(this.data,typeof d!="number"||d<0?this.shape[0]:0|d,typeof s!="number"||s<0?this.shape[1]:0|s,this.stride[0],this.stride[1],this.offset)},h.lo=function(d,s){var x=this.offset,c=0,T=this.shape[0],_=this.shape[1],w=this.stride[0],k=this.stride[1];return typeof d=="number"&&d>=0&&(x+=w*(c=0|d),T-=c),typeof s=="number"&&s>=0&&(x+=k*(c=0|s),_-=c),new l(this.data,T,_,w,k,x)},h.step=function(d,s){var x=this.shape[0],c=this.shape[1],T=this.stride[0],_=this.stride[1],w=this.offset,k=0,L=Math.ceil;return typeof d=="number"&&((k=0|d)<0?(w+=T*(x-1),x=L(-x/k)):x=L(x/k),T*=k),typeof s=="number"&&((k=0|s)<0?(w+=_*(c-1),c=L(-c/k)):c=L(c/k),_*=k),new l(this.data,x,c,T,_,w)},h.transpose=function(d,s){d=d===void 0?0:0|d,s=s===void 0?1:0|s;var x=this.shape,c=this.stride;return new l(this.data,x[d],x[s],c[d],c[s],this.offset)},h.pick=function(d,s){var x=[],c=[],T=this.offset;return typeof d=="number"&&d>=0?T=T+this.stride[0]*d|0:(x.push(this.shape[0]),c.push(this.stride[0])),typeof s=="number"&&s>=0?T=T+this.stride[1]*s|0:(x.push(this.shape[1]),c.push(this.stride[1])),(0,u[x.length+1])(this.data,x,c,T)},function(d,s,x,c){return new l(d,s[0],s[1],x[0],x[1],c)}},3:function(i,u,f){function l(d,s,x,c,T,_,w,k){this.data=d,this.shape=[s,x,c],this.stride=[T,_,w],this.offset=0|k}var h=l.prototype;return h.dtype=i,h.dimension=3,Object.defineProperty(h,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(h,"order",{get:function(){var d=Math.abs(this.stride[0]),s=Math.abs(this.stride[1]),x=Math.abs(this.stride[2]);return d>s?s>x?[2,1,0]:d>x?[1,2,0]:[1,0,2]:d>x?[2,0,1]:x>s?[0,1,2]:[0,2,1]}}),h.set=function(d,s,x,c){return i==="generic"?this.data.set(this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x,c):this.data[this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x]=c},h.get=function(d,s,x){return i==="generic"?this.data.get(this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x):this.data[this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x]},h.index=function(d,s,x){return this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x},h.hi=function(d,s,x){return new l(this.data,typeof d!="number"||d<0?this.shape[0]:0|d,typeof s!="number"||s<0?this.shape[1]:0|s,typeof x!="number"||x<0?this.shape[2]:0|x,this.stride[0],this.stride[1],this.stride[2],this.offset)},h.lo=function(d,s,x){var c=this.offset,T=0,_=this.shape[0],w=this.shape[1],k=this.shape[2],L=this.stride[0],A=this.stride[1],I=this.stride[2];return typeof d=="number"&&d>=0&&(c+=L*(T=0|d),_-=T),typeof s=="number"&&s>=0&&(c+=A*(T=0|s),w-=T),typeof x=="number"&&x>=0&&(c+=I*(T=0|x),k-=T),new l(this.data,_,w,k,L,A,I,c)},h.step=function(d,s,x){var c=this.shape[0],T=this.shape[1],_=this.shape[2],w=this.stride[0],k=this.stride[1],L=this.stride[2],A=this.offset,I=0,P=Math.ceil;return typeof d=="number"&&((I=0|d)<0?(A+=w*(c-1),c=P(-c/I)):c=P(c/I),w*=I),typeof s=="number"&&((I=0|s)<0?(A+=k*(T-1),T=P(-T/I)):T=P(T/I),k*=I),typeof x=="number"&&((I=0|x)<0?(A+=L*(_-1),_=P(-_/I)):_=P(_/I),L*=I),new l(this.data,c,T,_,w,k,L,A)},h.transpose=function(d,s,x){d=d===void 0?0:0|d,s=s===void 0?1:0|s,x=x===void 0?2:0|x;var c=this.shape,T=this.stride;return new l(this.data,c[d],c[s],c[x],T[d],T[s],T[x],this.offset)},h.pick=function(d,s,x){var c=[],T=[],_=this.offset;return typeof d=="number"&&d>=0?_=_+this.stride[0]*d|0:(c.push(this.shape[0]),T.push(this.stride[0])),typeof s=="number"&&s>=0?_=_+this.stride[1]*s|0:(c.push(this.shape[1]),T.push(this.stride[1])),typeof x=="number"&&x>=0?_=_+this.stride[2]*x|0:(c.push(this.shape[2]),T.push(this.stride[2])),(0,u[c.length+1])(this.data,c,T,_)},function(d,s,x,c){return new l(d,s[0],s[1],s[2],x[0],x[1],x[2],c)}},4:function(i,u,f){function l(d,s,x,c,T,_,w,k,L,A){this.data=d,this.shape=[s,x,c,T],this.stride=[_,w,k,L],this.offset=0|A}var h=l.prototype;return h.dtype=i,h.dimension=4,Object.defineProperty(h,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(h,"order",{get:f}),h.set=function(d,s,x,c,T){return i==="generic"?this.data.set(this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x+this.stride[3]*c,T):this.data[this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x+this.stride[3]*c]=T},h.get=function(d,s,x,c){return i==="generic"?this.data.get(this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x+this.stride[3]*c):this.data[this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x+this.stride[3]*c]},h.index=function(d,s,x,c){return this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x+this.stride[3]*c},h.hi=function(d,s,x,c){return new l(this.data,typeof d!="number"||d<0?this.shape[0]:0|d,typeof s!="number"||s<0?this.shape[1]:0|s,typeof x!="number"||x<0?this.shape[2]:0|x,typeof c!="number"||c<0?this.shape[3]:0|c,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},h.lo=function(d,s,x,c){var T=this.offset,_=0,w=this.shape[0],k=this.shape[1],L=this.shape[2],A=this.shape[3],I=this.stride[0],P=this.stride[1],S=this.stride[2],E=this.stride[3];return typeof d=="number"&&d>=0&&(T+=I*(_=0|d),w-=_),typeof s=="number"&&s>=0&&(T+=P*(_=0|s),k-=_),typeof x=="number"&&x>=0&&(T+=S*(_=0|x),L-=_),typeof c=="number"&&c>=0&&(T+=E*(_=0|c),A-=_),new l(this.data,w,k,L,A,I,P,S,E,T)},h.step=function(d,s,x,c){var T=this.shape[0],_=this.shape[1],w=this.shape[2],k=this.shape[3],L=this.stride[0],A=this.stride[1],I=this.stride[2],P=this.stride[3],S=this.offset,E=0,D=Math.ceil;return typeof d=="number"&&((E=0|d)<0?(S+=L*(T-1),T=D(-T/E)):T=D(T/E),L*=E),typeof s=="number"&&((E=0|s)<0?(S+=A*(_-1),_=D(-_/E)):_=D(_/E),A*=E),typeof x=="number"&&((E=0|x)<0?(S+=I*(w-1),w=D(-w/E)):w=D(w/E),I*=E),typeof c=="number"&&((E=0|c)<0?(S+=P*(k-1),k=D(-k/E)):k=D(k/E),P*=E),new l(this.data,T,_,w,k,L,A,I,P,S)},h.transpose=function(d,s,x,c){d=d===void 0?0:0|d,s=s===void 0?1:0|s,x=x===void 0?2:0|x,c=c===void 0?3:0|c;var T=this.shape,_=this.stride;return new l(this.data,T[d],T[s],T[x],T[c],_[d],_[s],_[x],_[c],this.offset)},h.pick=function(d,s,x,c){var T=[],_=[],w=this.offset;return typeof d=="number"&&d>=0?w=w+this.stride[0]*d|0:(T.push(this.shape[0]),_.push(this.stride[0])),typeof s=="number"&&s>=0?w=w+this.stride[1]*s|0:(T.push(this.shape[1]),_.push(this.stride[1])),typeof x=="number"&&x>=0?w=w+this.stride[2]*x|0:(T.push(this.shape[2]),_.push(this.stride[2])),typeof c=="number"&&c>=0?w=w+this.stride[3]*c|0:(T.push(this.shape[3]),_.push(this.stride[3])),(0,u[T.length+1])(this.data,T,_,w)},function(d,s,x,c){return new l(d,s[0],s[1],s[2],s[3],x[0],x[1],x[2],x[3],c)}},5:function(i,u,f){function l(d,s,x,c,T,_,w,k,L,A,I,P){this.data=d,this.shape=[s,x,c,T,_],this.stride=[w,k,L,A,I],this.offset=0|P}var h=l.prototype;return h.dtype=i,h.dimension=5,Object.defineProperty(h,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(h,"order",{get:f}),h.set=function(d,s,x,c,T,_){return i==="generic"?this.data.set(this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x+this.stride[3]*c+this.stride[4]*T,_):this.data[this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x+this.stride[3]*c+this.stride[4]*T]=_},h.get=function(d,s,x,c,T){return i==="generic"?this.data.get(this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x+this.stride[3]*c+this.stride[4]*T):this.data[this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x+this.stride[3]*c+this.stride[4]*T]},h.index=function(d,s,x,c,T){return this.offset+this.stride[0]*d+this.stride[1]*s+this.stride[2]*x+this.stride[3]*c+this.stride[4]*T},h.hi=function(d,s,x,c,T){return new l(this.data,typeof d!="number"||d<0?this.shape[0]:0|d,typeof s!="number"||s<0?this.shape[1]:0|s,typeof x!="number"||x<0?this.shape[2]:0|x,typeof c!="number"||c<0?this.shape[3]:0|c,typeof T!="number"||T<0?this.shape[4]:0|T,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},h.lo=function(d,s,x,c,T){var _=this.offset,w=0,k=this.shape[0],L=this.shape[1],A=this.shape[2],I=this.shape[3],P=this.shape[4],S=this.stride[0],E=this.stride[1],D=this.stride[2],R=this.stride[3],H=this.stride[4];return typeof d=="number"&&d>=0&&(_+=S*(w=0|d),k-=w),typeof s=="number"&&s>=0&&(_+=E*(w=0|s),L-=w),typeof x=="number"&&x>=0&&(_+=D*(w=0|x),A-=w),typeof c=="number"&&c>=0&&(_+=R*(w=0|c),I-=w),typeof T=="number"&&T>=0&&(_+=H*(w=0|T),P-=w),new l(this.data,k,L,A,I,P,S,E,D,R,H,_)},h.step=function(d,s,x,c,T){var _=this.shape[0],w=this.shape[1],k=this.shape[2],L=this.shape[3],A=this.shape[4],I=this.stride[0],P=this.stride[1],S=this.stride[2],E=this.stride[3],D=this.stride[4],R=this.offset,H=0,V=Math.ceil;return typeof d=="number"&&((H=0|d)<0?(R+=I*(_-1),_=V(-_/H)):_=V(_/H),I*=H),typeof s=="number"&&((H=0|s)<0?(R+=P*(w-1),w=V(-w/H)):w=V(w/H),P*=H),typeof x=="number"&&((H=0|x)<0?(R+=S*(k-1),k=V(-k/H)):k=V(k/H),S*=H),typeof c=="number"&&((H=0|c)<0?(R+=E*(L-1),L=V(-L/H)):L=V(L/H),E*=H),typeof T=="number"&&((H=0|T)<0?(R+=D*(A-1),A=V(-A/H)):A=V(A/H),D*=H),new l(this.data,_,w,k,L,A,I,P,S,E,D,R)},h.transpose=function(d,s,x,c,T){d=d===void 0?0:0|d,s=s===void 0?1:0|s,x=x===void 0?2:0|x,c=c===void 0?3:0|c,T=T===void 0?4:0|T;var _=this.shape,w=this.stride;return new l(this.data,_[d],_[s],_[x],_[c],_[T],w[d],w[s],w[x],w[c],w[T],this.offset)},h.pick=function(d,s,x,c,T){var _=[],w=[],k=this.offset;return typeof d=="number"&&d>=0?k=k+this.stride[0]*d|0:(_.push(this.shape[0]),w.push(this.stride[0])),typeof s=="number"&&s>=0?k=k+this.stride[1]*s|0:(_.push(this.shape[1]),w.push(this.stride[1])),typeof x=="number"&&x>=0?k=k+this.stride[2]*x|0:(_.push(this.shape[2]),w.push(this.stride[2])),typeof c=="number"&&c>=0?k=k+this.stride[3]*c|0:(_.push(this.shape[3]),w.push(this.stride[3])),typeof T=="number"&&T>=0?k=k+this.stride[4]*T|0:(_.push(this.shape[4]),w.push(this.stride[4])),(0,u[_.length+1])(this.data,_,w,k)},function(d,s,x,c){return new l(d,s[0],s[1],s[2],s[3],s[4],x[0],x[1],x[2],x[3],x[4],c)}}};function m(i,u){var f=u===-1?"T":String(u),l=r[f];return u===-1?l(i):u===0?l(i,o[i][0]):l(i,o[i],a)}var o={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};b.exports=function(i,u,f,l){if(i===void 0)return(0,o.array[0])([]);typeof i=="number"&&(i=[i]),u===void 0&&(u=[i.length]);var h=u.length;if(f===void 0){f=new Array(h);for(var d=h-1,s=1;d>=0;--d)f[d]=s,s*=u[d]}if(l===void 0)for(l=0,d=0;d<h;++d)f[d]<0&&(l-=(u[d]-1)*f[d]);for(var x=function(T){if(e(T))return"buffer";if(n)switch(Object.prototype.toString.call(T)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(T)?"array":"generic"}(i),c=o[x];c.length<=h+1;)c.push(m(x,c.length-1));return(0,c[h+1])(i,u,f,l)}},{"is-buffer":237}],260:[function(g,b,y){var e=g("double-bits"),n=Math.pow(2,-1074);b.exports=function(t,a){if(isNaN(t)||isNaN(a))return NaN;if(t===a)return t;if(t===0)return a<0?-n:n;var r=e.hi(t),m=e.lo(t);return a>t==t>0?m===-1>>>0?(r+=1,m=0):m+=1:m===0?(m=-1>>>0,r-=1):m-=1,e.pack(m,r)}},{"double-bits":64}],261:[function(g,b,y){y.vertexNormals=function(e,n,t){for(var a=n.length,r=new Array(a),m=t===void 0?1e-6:t,o=0;o<a;++o)r[o]=[0,0,0];for(o=0;o<e.length;++o)for(var i=e[o],u=0,f=i[i.length-1],l=i[0],h=0;h<i.length;++h){u=f,f=l,l=i[(h+1)%i.length];for(var d=n[u],s=n[f],x=n[l],c=new Array(3),T=0,_=new Array(3),w=0,k=0;k<3;++k)c[k]=d[k]-s[k],T+=c[k]*c[k],_[k]=x[k]-s[k],w+=_[k]*_[k];if(T*w>m){var L=r[f],A=1/Math.sqrt(T*w);for(k=0;k<3;++k){var I=(k+1)%3,P=(k+2)%3;L[k]+=A*(_[I]*c[P]-_[P]*c[I])}}}for(o=0;o<a;++o){L=r[o];var S=0;for(k=0;k<3;++k)S+=L[k]*L[k];if(S>m)for(A=1/Math.sqrt(S),k=0;k<3;++k)L[k]*=A;else for(k=0;k<3;++k)L[k]=0}return r},y.faceNormals=function(e,n,t){for(var a=e.length,r=new Array(a),m=t===void 0?1e-6:t,o=0;o<a;++o){for(var i=e[o],u=new Array(3),f=0;f<3;++f)u[f]=n[i[f]];var l=new Array(3),h=new Array(3);for(f=0;f<3;++f)l[f]=u[1][f]-u[0][f],h[f]=u[2][f]-u[0][f];var d=new Array(3),s=0;for(f=0;f<3;++f){var x=(f+1)%3,c=(f+2)%3;d[f]=l[x]*h[c]-l[c]*h[x],s+=d[f]*d[f]}for(s=s>m?1/Math.sqrt(s):0,f=0;f<3;++f)d[f]*=s;r[o]=d}return r}},{}],262:[function(g,b,y){b.exports=function(e,n,t,a,r,m,o,i,u,f){var l=n+m+f;if(h>0){var h=Math.sqrt(l+1);e[0]=.5*(o-u)/h,e[1]=.5*(i-a)/h,e[2]=.5*(t-m)/h,e[3]=.5*h}else{var d=Math.max(n,m,f);h=Math.sqrt(2*d-l+1),n>=d?(e[0]=.5*h,e[1]=.5*(r+t)/h,e[2]=.5*(i+a)/h,e[3]=.5*(o-u)/h):m>=d?(e[0]=.5*(t+r)/h,e[1]=.5*h,e[2]=.5*(u+o)/h,e[3]=.5*(i-a)/h):(e[0]=.5*(a+i)/h,e[1]=.5*(o+u)/h,e[2]=.5*h,e[3]=.5*(t-r)/h)}return e}},{}],263:[function(g,b,y){b.exports=function(l){var h=(l=l||{}).center||[0,0,0],d=l.rotation||[0,0,0,1],s=l.radius||1;h=[].slice.call(h,0,3),i(d=[].slice.call(d,0,4),d);var x=new u(d,h,Math.log(s));return x.setDistanceLimits(l.zoomMin,l.zoomMax),("eye"in l||"up"in l)&&x.lookAt(0,l.eye,l.center,l.up),x};var e=g("filtered-vector"),n=g("gl-mat4/lookAt"),t=g("gl-mat4/fromQuat"),a=g("gl-mat4/invert"),r=g("./lib/quatFromFrame");function m(l,h,d){return Math.sqrt(Math.pow(l,2)+Math.pow(h,2)+Math.pow(d,2))}function o(l,h,d,s){return Math.sqrt(Math.pow(l,2)+Math.pow(h,2)+Math.pow(d,2)+Math.pow(s,2))}function i(l,h){var d=h[0],s=h[1],x=h[2],c=h[3],T=o(d,s,x,c);T>1e-6?(l[0]=d/T,l[1]=s/T,l[2]=x/T,l[3]=c/T):(l[0]=l[1]=l[2]=0,l[3]=1)}function u(l,h,d){this.radius=e([d]),this.center=e(h),this.rotation=e(l),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var f=u.prototype;f.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},f.recalcMatrix=function(l){this.radius.curve(l),this.center.curve(l),this.rotation.curve(l);var h=this.computedRotation;i(h,h);var d=this.computedMatrix;t(d,h);var s=this.computedCenter,x=this.computedEye,c=this.computedUp,T=Math.exp(this.computedRadius[0]);x[0]=s[0]+T*d[2],x[1]=s[1]+T*d[6],x[2]=s[2]+T*d[10],c[0]=d[1],c[1]=d[5],c[2]=d[9];for(var _=0;_<3;++_){for(var w=0,k=0;k<3;++k)w+=d[_+4*k]*x[k];d[12+_]=-w}},f.getMatrix=function(l,h){this.recalcMatrix(l);var d=this.computedMatrix;if(h){for(var s=0;s<16;++s)h[s]=d[s];return h}return d},f.idle=function(l){this.center.idle(l),this.radius.idle(l),this.rotation.idle(l)},f.flush=function(l){this.center.flush(l),this.radius.flush(l),this.rotation.flush(l)},f.pan=function(l,h,d,s){h=h||0,d=d||0,s=s||0,this.recalcMatrix(l);var x=this.computedMatrix,c=x[1],T=x[5],_=x[9],w=m(c,T,_);c/=w,T/=w,_/=w;var k=x[0],L=x[4],A=x[8],I=k*c+L*T+A*_,P=m(k-=c*I,L-=T*I,A-=_*I);k/=P,L/=P,A/=P,x[2],x[6],x[10];var S=k*h+c*d,E=L*h+T*d,D=A*h+_*d;this.center.move(l,S,E,D);var R=Math.exp(this.computedRadius[0]);R=Math.max(1e-4,R+s),this.radius.set(l,Math.log(R))},f.rotate=function(l,h,d,s){this.recalcMatrix(l),h=h||0,d=d||0;var x=this.computedMatrix,c=x[0],T=x[4],_=x[8],w=x[1],k=x[5],L=x[9],A=x[2],I=x[6],P=x[10],S=h*c+d*w,E=h*T+d*k,D=h*_+d*L,R=-(I*D-P*E),H=-(P*S-A*D),V=-(A*E-I*S),X=Math.sqrt(Math.max(0,1-Math.pow(R,2)-Math.pow(H,2)-Math.pow(V,2))),$=o(R,H,V,X);$>1e-6?(R/=$,H/=$,V/=$,X/=$):(R=H=V=0,X=1);var G=this.computedRotation,W=G[0],te=G[1],N=G[2],B=G[3],U=W*X+B*R+te*V-N*H,ee=te*X+B*H+N*R-W*V,j=N*X+B*V+W*H-te*R,Q=B*X-W*R-te*H-N*V;if(s){R=A,H=I,V=P;var K=Math.sin(s)/m(R,H,V);R*=K,H*=K,V*=K,Q=Q*(X=Math.cos(h))-(U=U*X+Q*R+ee*V-j*H)*R-(ee=ee*X+Q*H+j*R-U*V)*H-(j=j*X+Q*V+U*H-ee*R)*V}var re=o(U,ee,j,Q);re>1e-6?(U/=re,ee/=re,j/=re,Q/=re):(U=ee=j=0,Q=1),this.rotation.set(l,U,ee,j,Q)},f.lookAt=function(l,h,d,s){this.recalcMatrix(l),d=d||this.computedCenter,h=h||this.computedEye,s=s||this.computedUp;var x=this.computedMatrix;n(x,h,d,s);var c=this.computedRotation;r(c,x[0],x[1],x[2],x[4],x[5],x[6],x[8],x[9],x[10]),i(c,c),this.rotation.set(l,c[0],c[1],c[2],c[3]);for(var T=0,_=0;_<3;++_)T+=Math.pow(d[_]-h[_],2);this.radius.set(l,.5*Math.log(Math.max(T,1e-6))),this.center.set(l,d[0],d[1],d[2])},f.translate=function(l,h,d,s){this.center.move(l,h||0,d||0,s||0)},f.setMatrix=function(l,h){var d=this.computedRotation;r(d,h[0],h[1],h[2],h[4],h[5],h[6],h[8],h[9],h[10]),i(d,d),this.rotation.set(l,d[0],d[1],d[2],d[3]);var s=this.computedMatrix;a(s,h);var x=s[15];if(Math.abs(x)>1e-6){var c=s[12]/x,T=s[13]/x,_=s[14]/x;this.recalcMatrix(l);var w=Math.exp(this.computedRadius[0]);this.center.set(l,c-s[2]*w,T-s[6]*w,_-s[10]*w),this.radius.idle(l)}else this.center.idle(l),this.radius.idle(l)},f.setDistance=function(l,h){h>0&&this.radius.set(l,Math.log(h))},f.setDistanceLimits=function(l,h){l=l>0?Math.log(l):-1/0,h=h>0?Math.log(h):1/0,h=Math.max(h,l),this.radius.bounds[0][0]=l,this.radius.bounds[1][0]=h},f.getDistanceLimits=function(l){var h=this.radius.bounds;return l?(l[0]=Math.exp(h[0][0]),l[1]=Math.exp(h[1][0]),l):[Math.exp(h[0][0]),Math.exp(h[1][0])]},f.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},f.fromJSON=function(l){var h=this.lastT(),d=l.center;d&&this.center.set(h,d[0],d[1],d[2]);var s=l.rotation;s&&this.rotation.set(h,s[0],s[1],s[2],s[3]);var x=l.distance;x&&x>0&&this.radius.set(h,Math.log(x)),this.setDistanceLimits(l.zoomMin,l.zoomMax)}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(g,b,y){var e=g("repeat-string");b.exports=function(n,t,a){return e(a=a!==void 0?a+"":" ",t)+n}},{"repeat-string":277}],265:[function(g,b,y){b.exports=function(e,n){n||(n=[0,""]),e=String(e);var t=parseFloat(e,10);return n[0]=t,n[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",n}},{}],266:[function(g,b,y){b.exports=function(n,t){for(var a=0|t.length,r=n.length,m=[new Array(a),new Array(a)],o=0;o<a;++o)m[0][o]=[],m[1][o]=[];for(o=0;o<r;++o){var i=n[o];m[0][i[0]].push(i),m[1][i[1]].push(i)}var u=[];for(o=0;o<a;++o)m[0][o].length+m[1][o].length===0&&u.push([o]);function f(T,_){var w=m[_][T[_]];w.splice(w.indexOf(T),1)}function l(T,_,w){for(var k,L,A,I=0;I<2;++I)if(m[I][_].length>0){k=m[I][_][0],A=I;break}L=k[1^A];for(var P=0;P<2;++P)for(var S=m[P][_],E=0;E<S.length;++E){var D=S[E],R=D[1^P];e(t[T],t[_],t[L],t[R])>0&&(k=D,L=R,A=P)}return w||k&&f(k,A),L}function h(T,_){var w=m[_][T][0],k=[T];f(w,_);for(var L=w[1^_];;){for(;L!==T;)k.push(L),L=l(k[k.length-2],L,!1);if(m[0][T].length+m[1][T].length===0)break;var A=k[k.length-1],I=T,P=k[1],S=l(A,I,!0);if(e(t[A],t[I],t[P],t[S])<0)break;k.push(T),L=l(A,I)}return k}function d(T,_){return _[1]===_[_.length-1]}for(o=0;o<a;++o)for(var s=0;s<2;++s){for(var x=[];m[s][o].length>0;){m[0][o].length;var c=h(o,s);d(0,c)?x.push.apply(x,c):(x.length>0&&u.push(x),x=c)}x.length>0&&u.push(x)}return u};var e=g("compare-angle")},{"compare-angle":54}],267:[function(g,b,y){b.exports=function(n,t){for(var a=e(n,t.length),r=new Array(t.length),m=new Array(t.length),o=[],i=0;i<t.length;++i){var u=a[i].length;m[i]=u,r[i]=!0,u<=1&&o.push(i)}for(;o.length>0;){var f=o.pop();r[f]=!1;var l=a[f];for(i=0;i<l.length;++i){var h=l[i];--m[h]==0&&o.push(h)}}var d=new Array(t.length),s=[];for(i=0;i<t.length;++i)r[i]?(f=s.length,d[i]=f,s.push(t[i])):d[i]=-1;var x=[];for(i=0;i<n.length;++i){var c=n[i];r[c[0]]&&r[c[1]]&&x.push([d[c[0]],d[c[1]]])}return[x,s]};var e=g("edges-to-adjacency-list")},{"edges-to-adjacency-list":66}],268:[function(g,b,y){b.exports=function(u,f){var l=o(u,f);u=l[0];for(var h=(f=l[1]).length,d=(u.length,e(u,f.length)),s=0;s<h;++s)if(d[s].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var x=n(u,f),c=(x=x.filter(function(oe){for(var de=oe.length,se=[0],me=0;me<de;++me){var Te=f[oe[me]],_e=f[oe[(me+1)%de]],be=a(-Te[0],Te[1]),Ce=a(-Te[0],_e[1]),fe=a(_e[0],Te[1]),ve=a(_e[0],_e[1]);se=r(se,r(r(be,Ce),r(fe,ve)))}return se[se.length-1]>0})).length,T=new Array(c),_=new Array(c);for(s=0;s<c;++s){T[s]=s;var w=new Array(c),k=x[s].map(function(oe){return f[oe]}),L=t([k]),A=0;e:for(var I=0;I<c;++I)if(w[I]=0,s!==I){for(var P=(ne=x[I]).length,S=0;S<P;++S){var E=L(f[ne[S]]);if(E!==0){E<0&&(w[I]=1,A+=1);continue e}}w[I]=1,A+=1}_[s]=[A,s,w]}for(_.sort(function(oe,de){return de[0]-oe[0]}),s=0;s<c;++s){var D=(w=_[s])[1],R=w[2];for(I=0;I<c;++I)R[I]&&(T[I]=D)}var H=function(oe){for(var de=new Array(oe),se=0;se<oe;++se)de[se]=[];return de}(c);for(s=0;s<c;++s)H[s].push(T[s]),H[T[s]].push(s);var V={},X=i(h,!1);for(s=0;s<c;++s)for(P=(ne=x[s]).length,I=0;I<P;++I){var $=ne[I],G=ne[(I+1)%P],W=Math.min($,G)+":"+Math.max($,G);if(W in V){var te=V[W];H[te].push(s),H[s].push(te),X[$]=X[G]=!0}else V[W]=s}function N(oe){for(var de=oe.length,se=0;se<de;++se)if(!X[oe[se]])return!1;return!0}var B=[],U=i(c,-1);for(s=0;s<c;++s)T[s]!==s||N(x[s])?U[s]=-1:(B.push(s),U[s]=0);for(l=[];B.length>0;){var ee=B.pop(),j=H[ee];m(j,function(oe,de){return oe-de});var Q,K=j.length,re=U[ee];if(re===0){var ne=x[ee];Q=[ne]}for(s=0;s<K;++s){var le=j[s];U[le]>=0||(U[le]=1^re,B.push(le),re===0&&(N(ne=x[le])||(ne.reverse(),Q.push(ne))))}re===0&&l.push(Q)}return l};var e=g("edges-to-adjacency-list"),n=g("planar-dual"),t=g("point-in-big-polygon"),a=g("two-product"),r=g("robust-sum"),m=g("uniq"),o=g("./lib/trim-leaves");function i(u,f){for(var l=new Array(u),h=0;h<u;++h)l[h]=f;return l}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(g,b,y){b.exports=function(i){for(var u=i.length,f=[],l=[],h=0;h<u;++h)for(var d=i[h],s=d.length,x=s-1,c=0;c<s;x=c++){var T=d[x],_=d[c];T[0]===_[0]?l.push([T,_]):f.push([T,_])}if(f.length===0)return l.length===0?o:(w=m(l),function(A){return w(A[0],A[1])?0:1});var w,k=n(f),L=function(A,I){return function(P){var S=a.le(I,P[0]);if(S<0)return 1;var E=A[S];if(!E){if(!(S>0&&I[S]===P[0]))return 1;E=A[S-1]}for(var D=1;E;){var R=E.key,H=e(P,R[0],R[1]);if(R[0][0]<R[1][0])if(H<0)E=E.left;else{if(!(H>0))return 0;D=-1,E=E.right}else if(H>0)E=E.left;else{if(!(H<0))return 0;D=1,E=E.right}}return D}}(k.slabs,k.coordinates);return l.length===0?L:function(A,I){return function(P){return A(P[0],P[1])?0:I(P)}}(m(l),L)};var e=g("robust-orientation")[3],n=g("slab-decomposition"),t=g("interval-tree-1d"),a=g("binary-search-bounds");function r(){return!0}function m(i){for(var u={},f=0;f<i.length;++f){var l=i[f],h=l[0][0],d=l[0][1],s=l[1][1],x=[Math.min(d,s),Math.max(d,s)];h in u?u[h].push(x):u[h]=[x]}var c={},T=Object.keys(u);for(f=0;f<T.length;++f){var _=u[T[f]];c[T[f]]=t(_)}return function(w){return function(k,L){var A=w[k];return!!A&&!!A.queryPoint(L,r)}}(c)}function o(i){return 1}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(g,b,y){var e=new Float64Array(4),n=new Float64Array(4),t=new Float64Array(4);b.exports=function(a,r,m,o,i){e.length<o.length&&(e=new Float64Array(o.length),n=new Float64Array(o.length),t=new Float64Array(o.length));for(var u=0;u<o.length;++u)e[u]=a[u]-o[u],n[u]=r[u]-a[u],t[u]=m[u]-a[u];var f=0,l=0,h=0,d=0,s=0,x=0;for(u=0;u<o.length;++u){var c=n[u],T=t[u],_=e[u];f+=c*c,l+=c*T,h+=T*T,d+=_*c,s+=_*T,x+=_*_}var w,k,L,A,I,P=Math.abs(f*h-l*l),S=l*s-h*d,E=l*d-f*s;if(S+E<=P)if(S<0)E<0&&d<0?(E=0,-d>=f?(S=1,w=f+2*d+x):w=d*(S=-d/f)+x):(S=0,s>=0?(E=0,w=x):-s>=h?(E=1,w=h+2*s+x):w=s*(E=-s/h)+x);else if(E<0)E=0,d>=0?(S=0,w=x):-d>=f?(S=1,w=f+2*d+x):w=d*(S=-d/f)+x;else{var D=1/P;w=(S*=D)*(f*S+l*(E*=D)+2*d)+E*(l*S+h*E+2*s)+x}else S<0?(L=h+s)>(k=l+d)?(A=L-k)>=(I=f-2*l+h)?(S=1,E=0,w=f+2*d+x):w=(S=A/I)*(f*S+l*(E=1-S)+2*d)+E*(l*S+h*E+2*s)+x:(S=0,L<=0?(E=1,w=h+2*s+x):s>=0?(E=0,w=x):w=s*(E=-s/h)+x):E<0?(L=f+d)>(k=l+s)?(A=L-k)>=(I=f-2*l+h)?(E=1,S=0,w=h+2*s+x):w=(S=1-(E=A/I))*(f*S+l*E+2*d)+E*(l*S+h*E+2*s)+x:(E=0,L<=0?(S=1,w=f+2*d+x):d>=0?(S=0,w=x):w=d*(S=-d/f)+x):(A=h+s-l-d)<=0?(S=0,E=1,w=h+2*s+x):A>=(I=f-2*l+h)?(S=1,E=0,w=f+2*d+x):w=(S=A/I)*(f*S+l*(E=1-S)+2*d)+E*(l*S+h*E+2*s)+x;var R=1-S-E;for(u=0;u<o.length;++u)i[u]=R*a[u]+S*r[u]+E*m[u];return w<0?0:w}},{}],271:[function(g,b,y){b.exports=g("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(g,b,y){var e=g("big-rat/add");b.exports=function(n,t){for(var a=n.length,r=new Array(a),m=0;m<a;++m)r[m]=e(n[m],t[m]);return r}},{"big-rat/add":15}],273:[function(g,b,y){b.exports=function(n){for(var t=new Array(n.length),a=0;a<n.length;++a)t[a]=e(n[a]);return t};var e=g("big-rat")},{"big-rat":18}],274:[function(g,b,y){var e=g("big-rat"),n=g("big-rat/mul");b.exports=function(t,a){for(var r=e(a),m=t.length,o=new Array(m),i=0;i<m;++i)o[i]=n(t[i],r);return o}},{"big-rat":18,"big-rat/mul":27}],275:[function(g,b,y){var e=g("big-rat/sub");b.exports=function(n,t){for(var a=n.length,r=new Array(a),m=0;m<a;++m)r[m]=e(n[m],t[m]);return r}},{"big-rat/sub":29}],276:[function(g,b,y){var e=g("compare-cell"),n=g("compare-oriented-cell"),t=g("cell-orientation");b.exports=function(a){a.sort(n);for(var r=a.length,m=0,o=0;o<r;++o){var i=a[o],u=t(i);if(u!==0){if(m>0){var f=a[m-1];if(e(i,f)===0&&t(f)!==u){m-=1;continue}}a[m++]=i}}return a.length=m,a}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(g,b,y){var e,n="";b.exports=function(t,a){if(typeof t!="string")throw new TypeError("expected a string");if(a===1)return t;if(a===2)return t+t;var r=t.length*a;if(e!==t||e===void 0)e=t,n="";else if(n.length>=r)return n.substr(0,r);for(;r>n.length&&a>1;)1&a&&(n+=t),a>>=1,t+=t;return n=(n+=t).substr(0,r)}},{}],278:[function(g,b,y){(function(e){(function(){b.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,p!==void 0?p:typeof self<"u"?self:typeof window<"u"?window:{})},{}],279:[function(g,b,y){b.exports=function(e){for(var n=e.length,t=e[e.length-1],a=n,r=n-2;r>=0;--r){var m=t,o=e[r];(u=o-((t=m+o)-m))&&(e[--a]=t,t=u)}var i=0;for(r=a;r<n;++r){var u;m=e[r],(u=(o=t)-((t=m+o)-m))&&(e[i++]=u)}return e[i++]=t,e.length=i,e}},{}],280:[function(g,b,y){var e=g("two-product"),n=g("robust-sum"),t=g("robust-scale"),a=g("robust-compress");function r(h,d,s,x){return function(c){return x(h(s(c[0][0],c[1][1]),s(-c[0][1],c[1][0])))}}function m(h,d,s,x){return function(c){return x(h(d(h(s(c[1][1],c[2][2]),s(-c[1][2],c[2][1])),c[0][0]),h(d(h(s(c[1][0],c[2][2]),s(-c[1][2],c[2][0])),-c[0][1]),d(h(s(c[1][0],c[2][1]),s(-c[1][1],c[2][0])),c[0][2]))))}}function o(h,d,s,x){return function(c){return x(h(h(d(h(d(h(s(c[2][2],c[3][3]),s(-c[2][3],c[3][2])),c[1][1]),h(d(h(s(c[2][1],c[3][3]),s(-c[2][3],c[3][1])),-c[1][2]),d(h(s(c[2][1],c[3][2]),s(-c[2][2],c[3][1])),c[1][3]))),c[0][0]),d(h(d(h(s(c[2][2],c[3][3]),s(-c[2][3],c[3][2])),c[1][0]),h(d(h(s(c[2][0],c[3][3]),s(-c[2][3],c[3][0])),-c[1][2]),d(h(s(c[2][0],c[3][2]),s(-c[2][2],c[3][0])),c[1][3]))),-c[0][1])),h(d(h(d(h(s(c[2][1],c[3][3]),s(-c[2][3],c[3][1])),c[1][0]),h(d(h(s(c[2][0],c[3][3]),s(-c[2][3],c[3][0])),-c[1][1]),d(h(s(c[2][0],c[3][1]),s(-c[2][1],c[3][0])),c[1][3]))),c[0][2]),d(h(d(h(s(c[2][1],c[3][2]),s(-c[2][2],c[3][1])),c[1][0]),h(d(h(s(c[2][0],c[3][2]),s(-c[2][2],c[3][0])),-c[1][1]),d(h(s(c[2][0],c[3][1]),s(-c[2][1],c[3][0])),c[1][2]))),-c[0][3]))))}}function i(h,d,s,x){return function(c){return x(h(h(d(h(h(d(h(d(h(s(c[3][3],c[4][4]),s(-c[3][4],c[4][3])),c[2][2]),h(d(h(s(c[3][2],c[4][4]),s(-c[3][4],c[4][2])),-c[2][3]),d(h(s(c[3][2],c[4][3]),s(-c[3][3],c[4][2])),c[2][4]))),c[1][1]),d(h(d(h(s(c[3][3],c[4][4]),s(-c[3][4],c[4][3])),c[2][1]),h(d(h(s(c[3][1],c[4][4]),s(-c[3][4],c[4][1])),-c[2][3]),d(h(s(c[3][1],c[4][3]),s(-c[3][3],c[4][1])),c[2][4]))),-c[1][2])),h(d(h(d(h(s(c[3][2],c[4][4]),s(-c[3][4],c[4][2])),c[2][1]),h(d(h(s(c[3][1],c[4][4]),s(-c[3][4],c[4][1])),-c[2][2]),d(h(s(c[3][1],c[4][2]),s(-c[3][2],c[4][1])),c[2][4]))),c[1][3]),d(h(d(h(s(c[3][2],c[4][3]),s(-c[3][3],c[4][2])),c[2][1]),h(d(h(s(c[3][1],c[4][3]),s(-c[3][3],c[4][1])),-c[2][2]),d(h(s(c[3][1],c[4][2]),s(-c[3][2],c[4][1])),c[2][3]))),-c[1][4]))),c[0][0]),d(h(h(d(h(d(h(s(c[3][3],c[4][4]),s(-c[3][4],c[4][3])),c[2][2]),h(d(h(s(c[3][2],c[4][4]),s(-c[3][4],c[4][2])),-c[2][3]),d(h(s(c[3][2],c[4][3]),s(-c[3][3],c[4][2])),c[2][4]))),c[1][0]),d(h(d(h(s(c[3][3],c[4][4]),s(-c[3][4],c[4][3])),c[2][0]),h(d(h(s(c[3][0],c[4][4]),s(-c[3][4],c[4][0])),-c[2][3]),d(h(s(c[3][0],c[4][3]),s(-c[3][3],c[4][0])),c[2][4]))),-c[1][2])),h(d(h(d(h(s(c[3][2],c[4][4]),s(-c[3][4],c[4][2])),c[2][0]),h(d(h(s(c[3][0],c[4][4]),s(-c[3][4],c[4][0])),-c[2][2]),d(h(s(c[3][0],c[4][2]),s(-c[3][2],c[4][0])),c[2][4]))),c[1][3]),d(h(d(h(s(c[3][2],c[4][3]),s(-c[3][3],c[4][2])),c[2][0]),h(d(h(s(c[3][0],c[4][3]),s(-c[3][3],c[4][0])),-c[2][2]),d(h(s(c[3][0],c[4][2]),s(-c[3][2],c[4][0])),c[2][3]))),-c[1][4]))),-c[0][1])),h(d(h(h(d(h(d(h(s(c[3][3],c[4][4]),s(-c[3][4],c[4][3])),c[2][1]),h(d(h(s(c[3][1],c[4][4]),s(-c[3][4],c[4][1])),-c[2][3]),d(h(s(c[3][1],c[4][3]),s(-c[3][3],c[4][1])),c[2][4]))),c[1][0]),d(h(d(h(s(c[3][3],c[4][4]),s(-c[3][4],c[4][3])),c[2][0]),h(d(h(s(c[3][0],c[4][4]),s(-c[3][4],c[4][0])),-c[2][3]),d(h(s(c[3][0],c[4][3]),s(-c[3][3],c[4][0])),c[2][4]))),-c[1][1])),h(d(h(d(h(s(c[3][1],c[4][4]),s(-c[3][4],c[4][1])),c[2][0]),h(d(h(s(c[3][0],c[4][4]),s(-c[3][4],c[4][0])),-c[2][1]),d(h(s(c[3][0],c[4][1]),s(-c[3][1],c[4][0])),c[2][4]))),c[1][3]),d(h(d(h(s(c[3][1],c[4][3]),s(-c[3][3],c[4][1])),c[2][0]),h(d(h(s(c[3][0],c[4][3]),s(-c[3][3],c[4][0])),-c[2][1]),d(h(s(c[3][0],c[4][1]),s(-c[3][1],c[4][0])),c[2][3]))),-c[1][4]))),c[0][2]),h(d(h(h(d(h(d(h(s(c[3][2],c[4][4]),s(-c[3][4],c[4][2])),c[2][1]),h(d(h(s(c[3][1],c[4][4]),s(-c[3][4],c[4][1])),-c[2][2]),d(h(s(c[3][1],c[4][2]),s(-c[3][2],c[4][1])),c[2][4]))),c[1][0]),d(h(d(h(s(c[3][2],c[4][4]),s(-c[3][4],c[4][2])),c[2][0]),h(d(h(s(c[3][0],c[4][4]),s(-c[3][4],c[4][0])),-c[2][2]),d(h(s(c[3][0],c[4][2]),s(-c[3][2],c[4][0])),c[2][4]))),-c[1][1])),h(d(h(d(h(s(c[3][1],c[4][4]),s(-c[3][4],c[4][1])),c[2][0]),h(d(h(s(c[3][0],c[4][4]),s(-c[3][4],c[4][0])),-c[2][1]),d(h(s(c[3][0],c[4][1]),s(-c[3][1],c[4][0])),c[2][4]))),c[1][2]),d(h(d(h(s(c[3][1],c[4][2]),s(-c[3][2],c[4][1])),c[2][0]),h(d(h(s(c[3][0],c[4][2]),s(-c[3][2],c[4][0])),-c[2][1]),d(h(s(c[3][0],c[4][1]),s(-c[3][1],c[4][0])),c[2][2]))),-c[1][4]))),-c[0][3]),d(h(h(d(h(d(h(s(c[3][2],c[4][3]),s(-c[3][3],c[4][2])),c[2][1]),h(d(h(s(c[3][1],c[4][3]),s(-c[3][3],c[4][1])),-c[2][2]),d(h(s(c[3][1],c[4][2]),s(-c[3][2],c[4][1])),c[2][3]))),c[1][0]),d(h(d(h(s(c[3][2],c[4][3]),s(-c[3][3],c[4][2])),c[2][0]),h(d(h(s(c[3][0],c[4][3]),s(-c[3][3],c[4][0])),-c[2][2]),d(h(s(c[3][0],c[4][2]),s(-c[3][2],c[4][0])),c[2][3]))),-c[1][1])),h(d(h(d(h(s(c[3][1],c[4][3]),s(-c[3][3],c[4][1])),c[2][0]),h(d(h(s(c[3][0],c[4][3]),s(-c[3][3],c[4][0])),-c[2][1]),d(h(s(c[3][0],c[4][1]),s(-c[3][1],c[4][0])),c[2][3]))),c[1][2]),d(h(d(h(s(c[3][1],c[4][2]),s(-c[3][2],c[4][1])),c[2][0]),h(d(h(s(c[3][0],c[4][2]),s(-c[3][2],c[4][0])),-c[2][1]),d(h(s(c[3][0],c[4][1]),s(-c[3][1],c[4][0])),c[2][2]))),-c[1][3]))),c[0][4])))))}}function u(h){return(h===2?r:h===3?m:h===4?o:h===5?i:void 0)(n,t,e,a)}var f=[function(){return[0]},function(h){return[h[0][0]]}];function l(h,d,s,x,c,T,_,w){return function(k){switch(k.length){case 0:return h(k);case 1:return d(k);case 2:return s(k);case 3:return x(k);case 4:return c(k);case 5:return T(k)}var L=_[k.length];return L||(L=_[k.length]=w(k.length)),L(k)}}(function(){for(;f.length<6;)f.push(u(f.length));b.exports=l.apply(void 0,f.concat([f,u]));for(var h=0;h<f.length;++h)b.exports[h]=f[h]})()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(g,b,y){var e=g("two-product"),n=g("robust-sum");b.exports=function(t,a){for(var r=e(t[0],a[0]),m=1;m<t.length;++m)r=n(r,e(t[m],a[m]));return r}},{"robust-sum":289,"two-product":306}],282:[function(g,b,y){var e=g("two-product"),n=g("robust-sum"),t=g("robust-subtract"),a=g("robust-scale");function r(d){return(d===3?m:d===4?o:d===5?i:u)(n,t,e,a)}function m(d,s,x,c){return function(T,_,w){var k=x(T[0],T[0]),L=c(k,_[0]),A=c(k,w[0]),I=x(_[0],_[0]),P=c(I,T[0]),S=c(I,w[0]),E=x(w[0],w[0]),D=c(E,T[0]),R=c(E,_[0]),H=d(s(R,S),s(P,L)),V=s(D,A),X=s(H,V);return X[X.length-1]}}function o(d,s,x,c){return function(T,_,w,k){var L=d(x(T[0],T[0]),x(T[1],T[1])),A=c(L,_[0]),I=c(L,w[0]),P=c(L,k[0]),S=d(x(_[0],_[0]),x(_[1],_[1])),E=c(S,T[0]),D=c(S,w[0]),R=c(S,k[0]),H=d(x(w[0],w[0]),x(w[1],w[1])),V=c(H,T[0]),X=c(H,_[0]),$=c(H,k[0]),G=d(x(k[0],k[0]),x(k[1],k[1])),W=c(G,T[0]),te=c(G,_[0]),N=c(G,w[0]),B=d(d(c(s(N,$),_[1]),d(c(s(te,R),-w[1]),c(s(X,D),k[1]))),d(c(s(te,R),T[1]),d(c(s(W,P),-_[1]),c(s(E,A),k[1])))),U=d(d(c(s(N,$),T[1]),d(c(s(W,P),-w[1]),c(s(V,I),k[1]))),d(c(s(X,D),T[1]),d(c(s(V,I),-_[1]),c(s(E,A),w[1])))),ee=s(B,U);return ee[ee.length-1]}}function i(d,s,x,c){return function(T,_,w,k,L){var A=d(x(T[0],T[0]),d(x(T[1],T[1]),x(T[2],T[2]))),I=c(A,_[0]),P=c(A,w[0]),S=c(A,k[0]),E=c(A,L[0]),D=d(x(_[0],_[0]),d(x(_[1],_[1]),x(_[2],_[2]))),R=c(D,T[0]),H=c(D,w[0]),V=c(D,k[0]),X=c(D,L[0]),$=d(x(w[0],w[0]),d(x(w[1],w[1]),x(w[2],w[2]))),G=c($,T[0]),W=c($,_[0]),te=c($,k[0]),N=c($,L[0]),B=d(x(k[0],k[0]),d(x(k[1],k[1]),x(k[2],k[2]))),U=c(B,T[0]),ee=c(B,_[0]),j=c(B,w[0]),Q=c(B,L[0]),K=d(x(L[0],L[0]),d(x(L[1],L[1]),x(L[2],L[2]))),re=c(K,T[0]),ne=c(K,_[0]),le=c(K,w[0]),oe=c(K,k[0]),de=d(d(d(c(d(c(s(oe,Q),w[1]),d(c(s(le,N),-k[1]),c(s(j,te),L[1]))),_[2]),d(c(d(c(s(oe,Q),_[1]),d(c(s(ne,X),-k[1]),c(s(ee,V),L[1]))),-w[2]),c(d(c(s(le,N),_[1]),d(c(s(ne,X),-w[1]),c(s(W,H),L[1]))),k[2]))),d(c(d(c(s(j,te),_[1]),d(c(s(ee,V),-w[1]),c(s(W,H),k[1]))),-L[2]),d(c(d(c(s(oe,Q),_[1]),d(c(s(ne,X),-k[1]),c(s(ee,V),L[1]))),T[2]),c(d(c(s(oe,Q),T[1]),d(c(s(re,E),-k[1]),c(s(U,S),L[1]))),-_[2])))),d(d(c(d(c(s(ne,X),T[1]),d(c(s(re,E),-_[1]),c(s(R,I),L[1]))),k[2]),d(c(d(c(s(ee,V),T[1]),d(c(s(U,S),-_[1]),c(s(R,I),k[1]))),-L[2]),c(d(c(s(j,te),_[1]),d(c(s(ee,V),-w[1]),c(s(W,H),k[1]))),T[2]))),d(c(d(c(s(j,te),T[1]),d(c(s(U,S),-w[1]),c(s(G,P),k[1]))),-_[2]),d(c(d(c(s(ee,V),T[1]),d(c(s(U,S),-_[1]),c(s(R,I),k[1]))),w[2]),c(d(c(s(W,H),T[1]),d(c(s(G,P),-_[1]),c(s(R,I),w[1]))),-k[2]))))),se=d(d(d(c(d(c(s(oe,Q),w[1]),d(c(s(le,N),-k[1]),c(s(j,te),L[1]))),T[2]),c(d(c(s(oe,Q),T[1]),d(c(s(re,E),-k[1]),c(s(U,S),L[1]))),-w[2])),d(c(d(c(s(le,N),T[1]),d(c(s(re,E),-w[1]),c(s(G,P),L[1]))),k[2]),c(d(c(s(j,te),T[1]),d(c(s(U,S),-w[1]),c(s(G,P),k[1]))),-L[2]))),d(d(c(d(c(s(le,N),_[1]),d(c(s(ne,X),-w[1]),c(s(W,H),L[1]))),T[2]),c(d(c(s(le,N),T[1]),d(c(s(re,E),-w[1]),c(s(G,P),L[1]))),-_[2])),d(c(d(c(s(ne,X),T[1]),d(c(s(re,E),-_[1]),c(s(R,I),L[1]))),w[2]),c(d(c(s(W,H),T[1]),d(c(s(G,P),-_[1]),c(s(R,I),w[1]))),-L[2])))),me=s(de,se);return me[me.length-1]}}function u(d,s,x,c){return function(T,_,w,k,L,A){var I=d(d(x(T[0],T[0]),x(T[1],T[1])),d(x(T[2],T[2]),x(T[3],T[3]))),P=c(I,_[0]),S=c(I,w[0]),E=c(I,k[0]),D=c(I,L[0]),R=c(I,A[0]),H=d(d(x(_[0],_[0]),x(_[1],_[1])),d(x(_[2],_[2]),x(_[3],_[3]))),V=c(H,T[0]),X=c(H,w[0]),$=c(H,k[0]),G=c(H,L[0]),W=c(H,A[0]),te=d(d(x(w[0],w[0]),x(w[1],w[1])),d(x(w[2],w[2]),x(w[3],w[3]))),N=c(te,T[0]),B=c(te,_[0]),U=c(te,k[0]),ee=c(te,L[0]),j=c(te,A[0]),Q=d(d(x(k[0],k[0]),x(k[1],k[1])),d(x(k[2],k[2]),x(k[3],k[3]))),K=c(Q,T[0]),re=c(Q,_[0]),ne=c(Q,w[0]),le=c(Q,L[0]),oe=c(Q,A[0]),de=d(d(x(L[0],L[0]),x(L[1],L[1])),d(x(L[2],L[2]),x(L[3],L[3]))),se=c(de,T[0]),me=c(de,_[0]),Te=c(de,w[0]),_e=c(de,k[0]),be=c(de,A[0]),Ce=d(d(x(A[0],A[0]),x(A[1],A[1])),d(x(A[2],A[2]),x(A[3],A[3]))),fe=c(Ce,T[0]),ve=c(Ce,_[0]),Me=c(Ce,w[0]),ke=c(Ce,k[0]),Le=c(Ce,L[0]),ze=d(d(d(c(d(d(c(d(c(s(Le,be),k[1]),d(c(s(ke,oe),-L[1]),c(s(_e,le),A[1]))),w[2]),c(d(c(s(Le,be),w[1]),d(c(s(Me,j),-L[1]),c(s(Te,ee),A[1]))),-k[2])),d(c(d(c(s(ke,oe),w[1]),d(c(s(Me,j),-k[1]),c(s(ne,U),A[1]))),L[2]),c(d(c(s(_e,le),w[1]),d(c(s(Te,ee),-k[1]),c(s(ne,U),L[1]))),-A[2]))),_[3]),d(c(d(d(c(d(c(s(Le,be),k[1]),d(c(s(ke,oe),-L[1]),c(s(_e,le),A[1]))),_[2]),c(d(c(s(Le,be),_[1]),d(c(s(ve,W),-L[1]),c(s(me,G),A[1]))),-k[2])),d(c(d(c(s(ke,oe),_[1]),d(c(s(ve,W),-k[1]),c(s(re,$),A[1]))),L[2]),c(d(c(s(_e,le),_[1]),d(c(s(me,G),-k[1]),c(s(re,$),L[1]))),-A[2]))),-w[3]),c(d(d(c(d(c(s(Le,be),w[1]),d(c(s(Me,j),-L[1]),c(s(Te,ee),A[1]))),_[2]),c(d(c(s(Le,be),_[1]),d(c(s(ve,W),-L[1]),c(s(me,G),A[1]))),-w[2])),d(c(d(c(s(Me,j),_[1]),d(c(s(ve,W),-w[1]),c(s(B,X),A[1]))),L[2]),c(d(c(s(Te,ee),_[1]),d(c(s(me,G),-w[1]),c(s(B,X),L[1]))),-A[2]))),k[3]))),d(d(c(d(d(c(d(c(s(ke,oe),w[1]),d(c(s(Me,j),-k[1]),c(s(ne,U),A[1]))),_[2]),c(d(c(s(ke,oe),_[1]),d(c(s(ve,W),-k[1]),c(s(re,$),A[1]))),-w[2])),d(c(d(c(s(Me,j),_[1]),d(c(s(ve,W),-w[1]),c(s(B,X),A[1]))),k[2]),c(d(c(s(ne,U),_[1]),d(c(s(re,$),-w[1]),c(s(B,X),k[1]))),-A[2]))),-L[3]),c(d(d(c(d(c(s(_e,le),w[1]),d(c(s(Te,ee),-k[1]),c(s(ne,U),L[1]))),_[2]),c(d(c(s(_e,le),_[1]),d(c(s(me,G),-k[1]),c(s(re,$),L[1]))),-w[2])),d(c(d(c(s(Te,ee),_[1]),d(c(s(me,G),-w[1]),c(s(B,X),L[1]))),k[2]),c(d(c(s(ne,U),_[1]),d(c(s(re,$),-w[1]),c(s(B,X),k[1]))),-L[2]))),A[3])),d(c(d(d(c(d(c(s(Le,be),k[1]),d(c(s(ke,oe),-L[1]),c(s(_e,le),A[1]))),_[2]),c(d(c(s(Le,be),_[1]),d(c(s(ve,W),-L[1]),c(s(me,G),A[1]))),-k[2])),d(c(d(c(s(ke,oe),_[1]),d(c(s(ve,W),-k[1]),c(s(re,$),A[1]))),L[2]),c(d(c(s(_e,le),_[1]),d(c(s(me,G),-k[1]),c(s(re,$),L[1]))),-A[2]))),T[3]),c(d(d(c(d(c(s(Le,be),k[1]),d(c(s(ke,oe),-L[1]),c(s(_e,le),A[1]))),T[2]),c(d(c(s(Le,be),T[1]),d(c(s(fe,R),-L[1]),c(s(se,D),A[1]))),-k[2])),d(c(d(c(s(ke,oe),T[1]),d(c(s(fe,R),-k[1]),c(s(K,E),A[1]))),L[2]),c(d(c(s(_e,le),T[1]),d(c(s(se,D),-k[1]),c(s(K,E),L[1]))),-A[2]))),-_[3])))),d(d(d(c(d(d(c(d(c(s(Le,be),_[1]),d(c(s(ve,W),-L[1]),c(s(me,G),A[1]))),T[2]),c(d(c(s(Le,be),T[1]),d(c(s(fe,R),-L[1]),c(s(se,D),A[1]))),-_[2])),d(c(d(c(s(ve,W),T[1]),d(c(s(fe,R),-_[1]),c(s(V,P),A[1]))),L[2]),c(d(c(s(me,G),T[1]),d(c(s(se,D),-_[1]),c(s(V,P),L[1]))),-A[2]))),k[3]),c(d(d(c(d(c(s(ke,oe),_[1]),d(c(s(ve,W),-k[1]),c(s(re,$),A[1]))),T[2]),c(d(c(s(ke,oe),T[1]),d(c(s(fe,R),-k[1]),c(s(K,E),A[1]))),-_[2])),d(c(d(c(s(ve,W),T[1]),d(c(s(fe,R),-_[1]),c(s(V,P),A[1]))),k[2]),c(d(c(s(re,$),T[1]),d(c(s(K,E),-_[1]),c(s(V,P),k[1]))),-A[2]))),-L[3])),d(c(d(d(c(d(c(s(_e,le),_[1]),d(c(s(me,G),-k[1]),c(s(re,$),L[1]))),T[2]),c(d(c(s(_e,le),T[1]),d(c(s(se,D),-k[1]),c(s(K,E),L[1]))),-_[2])),d(c(d(c(s(me,G),T[1]),d(c(s(se,D),-_[1]),c(s(V,P),L[1]))),k[2]),c(d(c(s(re,$),T[1]),d(c(s(K,E),-_[1]),c(s(V,P),k[1]))),-L[2]))),A[3]),c(d(d(c(d(c(s(ke,oe),w[1]),d(c(s(Me,j),-k[1]),c(s(ne,U),A[1]))),_[2]),c(d(c(s(ke,oe),_[1]),d(c(s(ve,W),-k[1]),c(s(re,$),A[1]))),-w[2])),d(c(d(c(s(Me,j),_[1]),d(c(s(ve,W),-w[1]),c(s(B,X),A[1]))),k[2]),c(d(c(s(ne,U),_[1]),d(c(s(re,$),-w[1]),c(s(B,X),k[1]))),-A[2]))),T[3]))),d(d(c(d(d(c(d(c(s(ke,oe),w[1]),d(c(s(Me,j),-k[1]),c(s(ne,U),A[1]))),T[2]),c(d(c(s(ke,oe),T[1]),d(c(s(fe,R),-k[1]),c(s(K,E),A[1]))),-w[2])),d(c(d(c(s(Me,j),T[1]),d(c(s(fe,R),-w[1]),c(s(N,S),A[1]))),k[2]),c(d(c(s(ne,U),T[1]),d(c(s(K,E),-w[1]),c(s(N,S),k[1]))),-A[2]))),-_[3]),c(d(d(c(d(c(s(ke,oe),_[1]),d(c(s(ve,W),-k[1]),c(s(re,$),A[1]))),T[2]),c(d(c(s(ke,oe),T[1]),d(c(s(fe,R),-k[1]),c(s(K,E),A[1]))),-_[2])),d(c(d(c(s(ve,W),T[1]),d(c(s(fe,R),-_[1]),c(s(V,P),A[1]))),k[2]),c(d(c(s(re,$),T[1]),d(c(s(K,E),-_[1]),c(s(V,P),k[1]))),-A[2]))),w[3])),d(c(d(d(c(d(c(s(Me,j),_[1]),d(c(s(ve,W),-w[1]),c(s(B,X),A[1]))),T[2]),c(d(c(s(Me,j),T[1]),d(c(s(fe,R),-w[1]),c(s(N,S),A[1]))),-_[2])),d(c(d(c(s(ve,W),T[1]),d(c(s(fe,R),-_[1]),c(s(V,P),A[1]))),w[2]),c(d(c(s(B,X),T[1]),d(c(s(N,S),-_[1]),c(s(V,P),w[1]))),-A[2]))),-k[3]),c(d(d(c(d(c(s(ne,U),_[1]),d(c(s(re,$),-w[1]),c(s(B,X),k[1]))),T[2]),c(d(c(s(ne,U),T[1]),d(c(s(K,E),-w[1]),c(s(N,S),k[1]))),-_[2])),d(c(d(c(s(re,$),T[1]),d(c(s(K,E),-_[1]),c(s(V,P),k[1]))),w[2]),c(d(c(s(B,X),T[1]),d(c(s(N,S),-_[1]),c(s(V,P),w[1]))),-k[2]))),A[3]))))),Re=d(d(d(c(d(d(c(d(c(s(Le,be),k[1]),d(c(s(ke,oe),-L[1]),c(s(_e,le),A[1]))),w[2]),c(d(c(s(Le,be),w[1]),d(c(s(Me,j),-L[1]),c(s(Te,ee),A[1]))),-k[2])),d(c(d(c(s(ke,oe),w[1]),d(c(s(Me,j),-k[1]),c(s(ne,U),A[1]))),L[2]),c(d(c(s(_e,le),w[1]),d(c(s(Te,ee),-k[1]),c(s(ne,U),L[1]))),-A[2]))),T[3]),d(c(d(d(c(d(c(s(Le,be),k[1]),d(c(s(ke,oe),-L[1]),c(s(_e,le),A[1]))),T[2]),c(d(c(s(Le,be),T[1]),d(c(s(fe,R),-L[1]),c(s(se,D),A[1]))),-k[2])),d(c(d(c(s(ke,oe),T[1]),d(c(s(fe,R),-k[1]),c(s(K,E),A[1]))),L[2]),c(d(c(s(_e,le),T[1]),d(c(s(se,D),-k[1]),c(s(K,E),L[1]))),-A[2]))),-w[3]),c(d(d(c(d(c(s(Le,be),w[1]),d(c(s(Me,j),-L[1]),c(s(Te,ee),A[1]))),T[2]),c(d(c(s(Le,be),T[1]),d(c(s(fe,R),-L[1]),c(s(se,D),A[1]))),-w[2])),d(c(d(c(s(Me,j),T[1]),d(c(s(fe,R),-w[1]),c(s(N,S),A[1]))),L[2]),c(d(c(s(Te,ee),T[1]),d(c(s(se,D),-w[1]),c(s(N,S),L[1]))),-A[2]))),k[3]))),d(d(c(d(d(c(d(c(s(ke,oe),w[1]),d(c(s(Me,j),-k[1]),c(s(ne,U),A[1]))),T[2]),c(d(c(s(ke,oe),T[1]),d(c(s(fe,R),-k[1]),c(s(K,E),A[1]))),-w[2])),d(c(d(c(s(Me,j),T[1]),d(c(s(fe,R),-w[1]),c(s(N,S),A[1]))),k[2]),c(d(c(s(ne,U),T[1]),d(c(s(K,E),-w[1]),c(s(N,S),k[1]))),-A[2]))),-L[3]),c(d(d(c(d(c(s(_e,le),w[1]),d(c(s(Te,ee),-k[1]),c(s(ne,U),L[1]))),T[2]),c(d(c(s(_e,le),T[1]),d(c(s(se,D),-k[1]),c(s(K,E),L[1]))),-w[2])),d(c(d(c(s(Te,ee),T[1]),d(c(s(se,D),-w[1]),c(s(N,S),L[1]))),k[2]),c(d(c(s(ne,U),T[1]),d(c(s(K,E),-w[1]),c(s(N,S),k[1]))),-L[2]))),A[3])),d(c(d(d(c(d(c(s(Le,be),w[1]),d(c(s(Me,j),-L[1]),c(s(Te,ee),A[1]))),_[2]),c(d(c(s(Le,be),_[1]),d(c(s(ve,W),-L[1]),c(s(me,G),A[1]))),-w[2])),d(c(d(c(s(Me,j),_[1]),d(c(s(ve,W),-w[1]),c(s(B,X),A[1]))),L[2]),c(d(c(s(Te,ee),_[1]),d(c(s(me,G),-w[1]),c(s(B,X),L[1]))),-A[2]))),T[3]),c(d(d(c(d(c(s(Le,be),w[1]),d(c(s(Me,j),-L[1]),c(s(Te,ee),A[1]))),T[2]),c(d(c(s(Le,be),T[1]),d(c(s(fe,R),-L[1]),c(s(se,D),A[1]))),-w[2])),d(c(d(c(s(Me,j),T[1]),d(c(s(fe,R),-w[1]),c(s(N,S),A[1]))),L[2]),c(d(c(s(Te,ee),T[1]),d(c(s(se,D),-w[1]),c(s(N,S),L[1]))),-A[2]))),-_[3])))),d(d(d(c(d(d(c(d(c(s(Le,be),_[1]),d(c(s(ve,W),-L[1]),c(s(me,G),A[1]))),T[2]),c(d(c(s(Le,be),T[1]),d(c(s(fe,R),-L[1]),c(s(se,D),A[1]))),-_[2])),d(c(d(c(s(ve,W),T[1]),d(c(s(fe,R),-_[1]),c(s(V,P),A[1]))),L[2]),c(d(c(s(me,G),T[1]),d(c(s(se,D),-_[1]),c(s(V,P),L[1]))),-A[2]))),w[3]),c(d(d(c(d(c(s(Me,j),_[1]),d(c(s(ve,W),-w[1]),c(s(B,X),A[1]))),T[2]),c(d(c(s(Me,j),T[1]),d(c(s(fe,R),-w[1]),c(s(N,S),A[1]))),-_[2])),d(c(d(c(s(ve,W),T[1]),d(c(s(fe,R),-_[1]),c(s(V,P),A[1]))),w[2]),c(d(c(s(B,X),T[1]),d(c(s(N,S),-_[1]),c(s(V,P),w[1]))),-A[2]))),-L[3])),d(c(d(d(c(d(c(s(Te,ee),_[1]),d(c(s(me,G),-w[1]),c(s(B,X),L[1]))),T[2]),c(d(c(s(Te,ee),T[1]),d(c(s(se,D),-w[1]),c(s(N,S),L[1]))),-_[2])),d(c(d(c(s(me,G),T[1]),d(c(s(se,D),-_[1]),c(s(V,P),L[1]))),w[2]),c(d(c(s(B,X),T[1]),d(c(s(N,S),-_[1]),c(s(V,P),w[1]))),-L[2]))),A[3]),c(d(d(c(d(c(s(_e,le),w[1]),d(c(s(Te,ee),-k[1]),c(s(ne,U),L[1]))),_[2]),c(d(c(s(_e,le),_[1]),d(c(s(me,G),-k[1]),c(s(re,$),L[1]))),-w[2])),d(c(d(c(s(Te,ee),_[1]),d(c(s(me,G),-w[1]),c(s(B,X),L[1]))),k[2]),c(d(c(s(ne,U),_[1]),d(c(s(re,$),-w[1]),c(s(B,X),k[1]))),-L[2]))),T[3]))),d(d(c(d(d(c(d(c(s(_e,le),w[1]),d(c(s(Te,ee),-k[1]),c(s(ne,U),L[1]))),T[2]),c(d(c(s(_e,le),T[1]),d(c(s(se,D),-k[1]),c(s(K,E),L[1]))),-w[2])),d(c(d(c(s(Te,ee),T[1]),d(c(s(se,D),-w[1]),c(s(N,S),L[1]))),k[2]),c(d(c(s(ne,U),T[1]),d(c(s(K,E),-w[1]),c(s(N,S),k[1]))),-L[2]))),-_[3]),c(d(d(c(d(c(s(_e,le),_[1]),d(c(s(me,G),-k[1]),c(s(re,$),L[1]))),T[2]),c(d(c(s(_e,le),T[1]),d(c(s(se,D),-k[1]),c(s(K,E),L[1]))),-_[2])),d(c(d(c(s(me,G),T[1]),d(c(s(se,D),-_[1]),c(s(V,P),L[1]))),k[2]),c(d(c(s(re,$),T[1]),d(c(s(K,E),-_[1]),c(s(V,P),k[1]))),-L[2]))),w[3])),d(c(d(d(c(d(c(s(Te,ee),_[1]),d(c(s(me,G),-w[1]),c(s(B,X),L[1]))),T[2]),c(d(c(s(Te,ee),T[1]),d(c(s(se,D),-w[1]),c(s(N,S),L[1]))),-_[2])),d(c(d(c(s(me,G),T[1]),d(c(s(se,D),-_[1]),c(s(V,P),L[1]))),w[2]),c(d(c(s(B,X),T[1]),d(c(s(N,S),-_[1]),c(s(V,P),w[1]))),-L[2]))),-k[3]),c(d(d(c(d(c(s(ne,U),_[1]),d(c(s(re,$),-w[1]),c(s(B,X),k[1]))),T[2]),c(d(c(s(ne,U),T[1]),d(c(s(K,E),-w[1]),c(s(N,S),k[1]))),-_[2])),d(c(d(c(s(re,$),T[1]),d(c(s(K,E),-_[1]),c(s(V,P),k[1]))),w[2]),c(d(c(s(B,X),T[1]),d(c(s(N,S),-_[1]),c(s(V,P),w[1]))),-k[2]))),L[3]))))),Oe=s(ze,Re);return Oe[Oe.length-1]}}var f=[function(){return 0},function(){return 0},function(){return 0}];function l(d){var s=f[d.length];return s||(s=f[d.length]=r(d.length)),s.apply(void 0,d)}function h(d,s,x,c,T,_,w,k){return function(L,A,I,P,S,E){switch(arguments.length){case 0:case 1:return 0;case 2:return c(L,A);case 3:return T(L,A,I);case 4:return _(L,A,I,P);case 5:return w(L,A,I,P,S);case 6:return k(L,A,I,P,S,E)}for(var D=new Array(arguments.length),R=0;R<arguments.length;++R)D[R]=arguments[R];return d(D)}}(function(){for(;f.length<=6;)f.push(r(f.length));b.exports=h.apply(void 0,[l].concat(f));for(var d=0;d<=6;++d)b.exports[d]=f[d]})()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(g,b,y){var e=g("robust-determinant");function n(f){var l=f===2?t:f===3?a:f===4?r:f===5?m:o;return l(f<6?e[f]:e)}function t(f){return function(l,h){return[f([[+h[0],+l[0][1]],[+h[1],+l[1][1]]]),f([[+l[0][0],+h[0]],[+l[1][0],+h[1]]]),f(l)]}}function a(f){return function(l,h){return[f([[+h[0],+l[0][1],+l[0][2]],[+h[1],+l[1][1],+l[1][2]],[+h[2],+l[2][1],+l[2][2]]]),f([[+l[0][0],+h[0],+l[0][2]],[+l[1][0],+h[1],+l[1][2]],[+l[2][0],+h[2],+l[2][2]]]),f([[+l[0][0],+l[0][1],+h[0]],[+l[1][0],+l[1][1],+h[1]],[+l[2][0],+l[2][1],+h[2]]]),f(l)]}}function r(f){return function(l,h){return[f([[+h[0],+l[0][1],+l[0][2],+l[0][3]],[+h[1],+l[1][1],+l[1][2],+l[1][3]],[+h[2],+l[2][1],+l[2][2],+l[2][3]],[+h[3],+l[3][1],+l[3][2],+l[3][3]]]),f([[+l[0][0],+h[0],+l[0][2],+l[0][3]],[+l[1][0],+h[1],+l[1][2],+l[1][3]],[+l[2][0],+h[2],+l[2][2],+l[2][3]],[+l[3][0],+h[3],+l[3][2],+l[3][3]]]),f([[+l[0][0],+l[0][1],+h[0],+l[0][3]],[+l[1][0],+l[1][1],+h[1],+l[1][3]],[+l[2][0],+l[2][1],+h[2],+l[2][3]],[+l[3][0],+l[3][1],+h[3],+l[3][3]]]),f([[+l[0][0],+l[0][1],+l[0][2],+h[0]],[+l[1][0],+l[1][1],+l[1][2],+h[1]],[+l[2][0],+l[2][1],+l[2][2],+h[2]],[+l[3][0],+l[3][1],+l[3][2],+h[3]]]),f(l)]}}function m(f){return function(l,h){return[f([[+h[0],+l[0][1],+l[0][2],+l[0][3],+l[0][4]],[+h[1],+l[1][1],+l[1][2],+l[1][3],+l[1][4]],[+h[2],+l[2][1],+l[2][2],+l[2][3],+l[2][4]],[+h[3],+l[3][1],+l[3][2],+l[3][3],+l[3][4]],[+h[4],+l[4][1],+l[4][2],+l[4][3],+l[4][4]]]),f([[+l[0][0],+h[0],+l[0][2],+l[0][3],+l[0][4]],[+l[1][0],+h[1],+l[1][2],+l[1][3],+l[1][4]],[+l[2][0],+h[2],+l[2][2],+l[2][3],+l[2][4]],[+l[3][0],+h[3],+l[3][2],+l[3][3],+l[3][4]],[+l[4][0],+h[4],+l[4][2],+l[4][3],+l[4][4]]]),f([[+l[0][0],+l[0][1],+h[0],+l[0][3],+l[0][4]],[+l[1][0],+l[1][1],+h[1],+l[1][3],+l[1][4]],[+l[2][0],+l[2][1],+h[2],+l[2][3],+l[2][4]],[+l[3][0],+l[3][1],+h[3],+l[3][3],+l[3][4]],[+l[4][0],+l[4][1],+h[4],+l[4][3],+l[4][4]]]),f([[+l[0][0],+l[0][1],+l[0][2],+h[0],+l[0][4]],[+l[1][0],+l[1][1],+l[1][2],+h[1],+l[1][4]],[+l[2][0],+l[2][1],+l[2][2],+h[2],+l[2][4]],[+l[3][0],+l[3][1],+l[3][2],+h[3],+l[3][4]],[+l[4][0],+l[4][1],+l[4][2],+h[4],+l[4][4]]]),f([[+l[0][0],+l[0][1],+l[0][2],+l[0][3],+h[0]],[+l[1][0],+l[1][1],+l[1][2],+l[1][3],+h[1]],[+l[2][0],+l[2][1],+l[2][2],+l[2][3],+h[2]],[+l[3][0],+l[3][1],+l[3][2],+l[3][3],+h[3]],[+l[4][0],+l[4][1],+l[4][2],+l[4][3],+h[4]]]),f(l)]}}function o(f){return function(l,h){return[f([[+h[0],+l[0][1],+l[0][2],+l[0][3],+l[0][4],+l[0][5]],[+h[1],+l[1][1],+l[1][2],+l[1][3],+l[1][4],+l[1][5]],[+h[2],+l[2][1],+l[2][2],+l[2][3],+l[2][4],+l[2][5]],[+h[3],+l[3][1],+l[3][2],+l[3][3],+l[3][4],+l[3][5]],[+h[4],+l[4][1],+l[4][2],+l[4][3],+l[4][4],+l[4][5]],[+h[5],+l[5][1],+l[5][2],+l[5][3],+l[5][4],+l[5][5]]]),f([[+l[0][0],+h[0],+l[0][2],+l[0][3],+l[0][4],+l[0][5]],[+l[1][0],+h[1],+l[1][2],+l[1][3],+l[1][4],+l[1][5]],[+l[2][0],+h[2],+l[2][2],+l[2][3],+l[2][4],+l[2][5]],[+l[3][0],+h[3],+l[3][2],+l[3][3],+l[3][4],+l[3][5]],[+l[4][0],+h[4],+l[4][2],+l[4][3],+l[4][4],+l[4][5]],[+l[5][0],+h[5],+l[5][2],+l[5][3],+l[5][4],+l[5][5]]]),f([[+l[0][0],+l[0][1],+h[0],+l[0][3],+l[0][4],+l[0][5]],[+l[1][0],+l[1][1],+h[1],+l[1][3],+l[1][4],+l[1][5]],[+l[2][0],+l[2][1],+h[2],+l[2][3],+l[2][4],+l[2][5]],[+l[3][0],+l[3][1],+h[3],+l[3][3],+l[3][4],+l[3][5]],[+l[4][0],+l[4][1],+h[4],+l[4][3],+l[4][4],+l[4][5]],[+l[5][0],+l[5][1],+h[5],+l[5][3],+l[5][4],+l[5][5]]]),f([[+l[0][0],+l[0][1],+l[0][2],+h[0],+l[0][4],+l[0][5]],[+l[1][0],+l[1][1],+l[1][2],+h[1],+l[1][4],+l[1][5]],[+l[2][0],+l[2][1],+l[2][2],+h[2],+l[2][4],+l[2][5]],[+l[3][0],+l[3][1],+l[3][2],+h[3],+l[3][4],+l[3][5]],[+l[4][0],+l[4][1],+l[4][2],+h[4],+l[4][4],+l[4][5]],[+l[5][0],+l[5][1],+l[5][2],+h[5],+l[5][4],+l[5][5]]]),f([[+l[0][0],+l[0][1],+l[0][2],+l[0][3],+h[0],+l[0][5]],[+l[1][0],+l[1][1],+l[1][2],+l[1][3],+h[1],+l[1][5]],[+l[2][0],+l[2][1],+l[2][2],+l[2][3],+h[2],+l[2][5]],[+l[3][0],+l[3][1],+l[3][2],+l[3][3],+h[3],+l[3][5]],[+l[4][0],+l[4][1],+l[4][2],+l[4][3],+h[4],+l[4][5]],[+l[5][0],+l[5][1],+l[5][2],+l[5][3],+h[5],+l[5][5]]]),f([[+l[0][0],+l[0][1],+l[0][2],+l[0][3],+l[0][4],+h[0]],[+l[1][0],+l[1][1],+l[1][2],+l[1][3],+l[1][4],+h[1]],[+l[2][0],+l[2][1],+l[2][2],+l[2][3],+l[2][4],+h[2]],[+l[3][0],+l[3][1],+l[3][2],+l[3][3],+l[3][4],+h[3]],[+l[4][0],+l[4][1],+l[4][2],+l[4][3],+l[4][4],+h[4]],[+l[5][0],+l[5][1],+l[5][2],+l[5][3],+l[5][4],+h[5]]]),f(l)]}}var i=[function(){return[[0]]},function(f,l){return[[l[0]],[f[0][0]]]}];function u(f,l,h,d,s,x,c,T){return function(_,w){switch(_.length){case 0:return f(_,w);case 1:return l(_,w);case 2:return h(_,w);case 3:return d(_,w);case 4:return s(_,w);case 5:return x(_,w)}var k=c[_.length];return k||(k=c[_.length]=T(_.length)),k(_,w)}}(function(){for(;i.length<6;)i.push(n(i.length));b.exports=u.apply(void 0,i.concat([i,n]));for(var f=0;f<6;++f)b.exports[f]=i[f]})()},{"robust-determinant":280}],284:[function(g,b,y){var e=g("two-product"),n=g("robust-sum"),t=g("robust-scale"),a=g("robust-subtract");function r(s,x,c,T){return function(_,w,k){var L=s(s(x(w[1],k[0]),x(-k[1],w[0])),s(x(_[1],w[0]),x(-w[1],_[0]))),A=s(x(_[1],k[0]),x(-k[1],_[0])),I=T(L,A);return I[I.length-1]}}function m(s,x,c,T){return function(_,w,k,L){var A=s(s(c(s(x(k[1],L[0]),x(-L[1],k[0])),w[2]),s(c(s(x(w[1],L[0]),x(-L[1],w[0])),-k[2]),c(s(x(w[1],k[0]),x(-k[1],w[0])),L[2]))),s(c(s(x(w[1],L[0]),x(-L[1],w[0])),_[2]),s(c(s(x(_[1],L[0]),x(-L[1],_[0])),-w[2]),c(s(x(_[1],w[0]),x(-w[1],_[0])),L[2])))),I=s(s(c(s(x(k[1],L[0]),x(-L[1],k[0])),_[2]),s(c(s(x(_[1],L[0]),x(-L[1],_[0])),-k[2]),c(s(x(_[1],k[0]),x(-k[1],_[0])),L[2]))),s(c(s(x(w[1],k[0]),x(-k[1],w[0])),_[2]),s(c(s(x(_[1],k[0]),x(-k[1],_[0])),-w[2]),c(s(x(_[1],w[0]),x(-w[1],_[0])),k[2])))),P=T(A,I);return P[P.length-1]}}function o(s,x,c,T){return function(_,w,k,L,A){var I=s(s(s(c(s(c(s(x(L[1],A[0]),x(-A[1],L[0])),k[2]),s(c(s(x(k[1],A[0]),x(-A[1],k[0])),-L[2]),c(s(x(k[1],L[0]),x(-L[1],k[0])),A[2]))),w[3]),s(c(s(c(s(x(L[1],A[0]),x(-A[1],L[0])),w[2]),s(c(s(x(w[1],A[0]),x(-A[1],w[0])),-L[2]),c(s(x(w[1],L[0]),x(-L[1],w[0])),A[2]))),-k[3]),c(s(c(s(x(k[1],A[0]),x(-A[1],k[0])),w[2]),s(c(s(x(w[1],A[0]),x(-A[1],w[0])),-k[2]),c(s(x(w[1],k[0]),x(-k[1],w[0])),A[2]))),L[3]))),s(c(s(c(s(x(k[1],L[0]),x(-L[1],k[0])),w[2]),s(c(s(x(w[1],L[0]),x(-L[1],w[0])),-k[2]),c(s(x(w[1],k[0]),x(-k[1],w[0])),L[2]))),-A[3]),s(c(s(c(s(x(L[1],A[0]),x(-A[1],L[0])),w[2]),s(c(s(x(w[1],A[0]),x(-A[1],w[0])),-L[2]),c(s(x(w[1],L[0]),x(-L[1],w[0])),A[2]))),_[3]),c(s(c(s(x(L[1],A[0]),x(-A[1],L[0])),_[2]),s(c(s(x(_[1],A[0]),x(-A[1],_[0])),-L[2]),c(s(x(_[1],L[0]),x(-L[1],_[0])),A[2]))),-w[3])))),s(s(c(s(c(s(x(w[1],A[0]),x(-A[1],w[0])),_[2]),s(c(s(x(_[1],A[0]),x(-A[1],_[0])),-w[2]),c(s(x(_[1],w[0]),x(-w[1],_[0])),A[2]))),L[3]),s(c(s(c(s(x(w[1],L[0]),x(-L[1],w[0])),_[2]),s(c(s(x(_[1],L[0]),x(-L[1],_[0])),-w[2]),c(s(x(_[1],w[0]),x(-w[1],_[0])),L[2]))),-A[3]),c(s(c(s(x(k[1],L[0]),x(-L[1],k[0])),w[2]),s(c(s(x(w[1],L[0]),x(-L[1],w[0])),-k[2]),c(s(x(w[1],k[0]),x(-k[1],w[0])),L[2]))),_[3]))),s(c(s(c(s(x(k[1],L[0]),x(-L[1],k[0])),_[2]),s(c(s(x(_[1],L[0]),x(-L[1],_[0])),-k[2]),c(s(x(_[1],k[0]),x(-k[1],_[0])),L[2]))),-w[3]),s(c(s(c(s(x(w[1],L[0]),x(-L[1],w[0])),_[2]),s(c(s(x(_[1],L[0]),x(-L[1],_[0])),-w[2]),c(s(x(_[1],w[0]),x(-w[1],_[0])),L[2]))),k[3]),c(s(c(s(x(w[1],k[0]),x(-k[1],w[0])),_[2]),s(c(s(x(_[1],k[0]),x(-k[1],_[0])),-w[2]),c(s(x(_[1],w[0]),x(-w[1],_[0])),k[2]))),-L[3]))))),P=s(s(s(c(s(c(s(x(L[1],A[0]),x(-A[1],L[0])),k[2]),s(c(s(x(k[1],A[0]),x(-A[1],k[0])),-L[2]),c(s(x(k[1],L[0]),x(-L[1],k[0])),A[2]))),_[3]),c(s(c(s(x(L[1],A[0]),x(-A[1],L[0])),_[2]),s(c(s(x(_[1],A[0]),x(-A[1],_[0])),-L[2]),c(s(x(_[1],L[0]),x(-L[1],_[0])),A[2]))),-k[3])),s(c(s(c(s(x(k[1],A[0]),x(-A[1],k[0])),_[2]),s(c(s(x(_[1],A[0]),x(-A[1],_[0])),-k[2]),c(s(x(_[1],k[0]),x(-k[1],_[0])),A[2]))),L[3]),c(s(c(s(x(k[1],L[0]),x(-L[1],k[0])),_[2]),s(c(s(x(_[1],L[0]),x(-L[1],_[0])),-k[2]),c(s(x(_[1],k[0]),x(-k[1],_[0])),L[2]))),-A[3]))),s(s(c(s(c(s(x(k[1],A[0]),x(-A[1],k[0])),w[2]),s(c(s(x(w[1],A[0]),x(-A[1],w[0])),-k[2]),c(s(x(w[1],k[0]),x(-k[1],w[0])),A[2]))),_[3]),c(s(c(s(x(k[1],A[0]),x(-A[1],k[0])),_[2]),s(c(s(x(_[1],A[0]),x(-A[1],_[0])),-k[2]),c(s(x(_[1],k[0]),x(-k[1],_[0])),A[2]))),-w[3])),s(c(s(c(s(x(w[1],A[0]),x(-A[1],w[0])),_[2]),s(c(s(x(_[1],A[0]),x(-A[1],_[0])),-w[2]),c(s(x(_[1],w[0]),x(-w[1],_[0])),A[2]))),k[3]),c(s(c(s(x(w[1],k[0]),x(-k[1],w[0])),_[2]),s(c(s(x(_[1],k[0]),x(-k[1],_[0])),-w[2]),c(s(x(_[1],w[0]),x(-w[1],_[0])),k[2]))),-A[3])))),S=T(I,P);return S[S.length-1]}}function i(s){return(s===3?r:s===4?m:o)(n,e,t,a)}var u=i(3),f=i(4),l=[function(){return 0},function(){return 0},function(s,x){return x[0]-s[0]},function(s,x,c){var T,_=(s[1]-c[1])*(x[0]-c[0]),w=(s[0]-c[0])*(x[1]-c[1]),k=_-w;if(_>0){if(w<=0)return k;T=_+w}else{if(!(_<0)||w>=0)return k;T=-(_+w)}var L=33306690738754716e-32*T;return k>=L||k<=-L?k:u(s,x,c)},function(s,x,c,T){var _=s[0]-T[0],w=x[0]-T[0],k=c[0]-T[0],L=s[1]-T[1],A=x[1]-T[1],I=c[1]-T[1],P=s[2]-T[2],S=x[2]-T[2],E=c[2]-T[2],D=w*I,R=k*A,H=k*L,V=_*I,X=_*A,$=w*L,G=P*(D-R)+S*(H-V)+E*(X-$),W=7771561172376103e-31*((Math.abs(D)+Math.abs(R))*Math.abs(P)+(Math.abs(H)+Math.abs(V))*Math.abs(S)+(Math.abs(X)+Math.abs($))*Math.abs(E));return G>W||-G>W?G:f(s,x,c,T)}];function h(s){var x=l[s.length];return x||(x=l[s.length]=i(s.length)),x.apply(void 0,s)}function d(s,x,c,T,_,w,k){return function(L,A,I,P,S){switch(arguments.length){case 0:case 1:return 0;case 2:return T(L,A);case 3:return _(L,A,I);case 4:return w(L,A,I,P);case 5:return k(L,A,I,P,S)}for(var E=new Array(arguments.length),D=0;D<arguments.length;++D)E[D]=arguments[D];return s(E)}}(function(){for(;l.length<=5;)l.push(i(l.length));b.exports=d.apply(void 0,[h].concat(l));for(var s=0;s<=5;++s)b.exports[s]=l[s]})()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(g,b,y){var e=g("robust-sum"),n=g("robust-scale");b.exports=function(t,a){if(t.length===1)return n(a,t[0]);if(a.length===1)return n(t,a[0]);if(t.length===0||a.length===0)return[0];var r=[0];if(t.length<a.length)for(var m=0;m<t.length;++m)r=e(r,n(a,t[m]));else for(m=0;m<a.length;++m)r=e(r,n(t,a[m]));return r}},{"robust-scale":286,"robust-sum":289}],286:[function(g,b,y){var e=g("two-product"),n=g("two-sum");b.exports=function(t,a){var r=t.length;if(r===1){var m=e(t[0],a);return m[0]?m:[m[1]]}var o=new Array(2*r),i=[.1,.1],u=[.1,.1],f=0;e(t[0],a,i),i[0]&&(o[f++]=i[0]);for(var l=1;l<r;++l){e(t[l],a,u);var h=i[1];n(h,u[0],i),i[0]&&(o[f++]=i[0]);var d=u[1],s=i[1],x=d+s,c=s-(x-d);i[1]=x,c&&(o[f++]=c)}return i[1]&&(o[f++]=i[1]),f===0&&(o[f++]=0),o.length=f,o}},{"two-product":306,"two-sum":307}],287:[function(g,b,y){b.exports=function(n,t,a,r){var m=e(n,a,r),o=e(t,a,r);if(m>0&&o>0||m<0&&o<0)return!1;var i=e(a,n,t),u=e(r,n,t);return i>0&&u>0||i<0&&u<0?!1:m===0&&o===0&&i===0&&u===0?function(f,l,h,d){for(var s=0;s<2;++s){var x=f[s],c=l[s],T=Math.min(x,c),_=Math.max(x,c),w=h[s],k=d[s],L=Math.min(w,k);if(Math.max(w,k)<T||_<L)return!1}return!0}(n,t,a,r):!0};var e=g("robust-orientation")[3]},{"robust-orientation":284}],288:[function(g,b,y){b.exports=function(e,n){var t=0|e.length,a=0|n.length;if(t===1&&a===1)return function(I,P){var S=I+P,E=S-I,D=I-(S-E)+(P-E);return D?[D,S]:[S]}(e[0],-n[0]);var r,m,o=new Array(t+a),i=0,u=0,f=0,l=Math.abs,h=e[u],d=l(h),s=-n[f],x=l(s);d<x?(m=h,(u+=1)<t&&(h=e[u],d=l(h))):(m=s,(f+=1)<a&&(s=-n[f],x=l(s))),u<t&&d<x||f>=a?(r=h,(u+=1)<t&&(h=e[u],d=l(h))):(r=s,(f+=1)<a&&(s=-n[f],x=l(s)));for(var c,T,_=r+m,w=_-r,k=m-w,L=k,A=_;u<t&&f<a;)d<x?(r=h,(u+=1)<t&&(h=e[u],d=l(h))):(r=s,(f+=1)<a&&(s=-n[f],x=l(s))),(k=(m=L)-(w=(_=r+m)-r))&&(o[i++]=k),L=A-((c=A+_)-(T=c-A))+(_-T),A=c;for(;u<t;)(k=(m=L)-(w=(_=(r=h)+m)-r))&&(o[i++]=k),L=A-((c=A+_)-(T=c-A))+(_-T),A=c,(u+=1)<t&&(h=e[u]);for(;f<a;)(k=(m=L)-(w=(_=(r=s)+m)-r))&&(o[i++]=k),L=A-((c=A+_)-(T=c-A))+(_-T),A=c,(f+=1)<a&&(s=-n[f]);return L&&(o[i++]=L),A&&(o[i++]=A),i||(o[i++]=0),o.length=i,o}},{}],289:[function(g,b,y){b.exports=function(e,n){var t=0|e.length,a=0|n.length;if(t===1&&a===1)return function(I,P){var S=I+P,E=S-I,D=I-(S-E)+(P-E);return D?[D,S]:[S]}(e[0],n[0]);var r,m,o=new Array(t+a),i=0,u=0,f=0,l=Math.abs,h=e[u],d=l(h),s=n[f],x=l(s);d<x?(m=h,(u+=1)<t&&(h=e[u],d=l(h))):(m=s,(f+=1)<a&&(s=n[f],x=l(s))),u<t&&d<x||f>=a?(r=h,(u+=1)<t&&(h=e[u],d=l(h))):(r=s,(f+=1)<a&&(s=n[f],x=l(s)));for(var c,T,_=r+m,w=_-r,k=m-w,L=k,A=_;u<t&&f<a;)d<x?(r=h,(u+=1)<t&&(h=e[u],d=l(h))):(r=s,(f+=1)<a&&(s=n[f],x=l(s))),(k=(m=L)-(w=(_=r+m)-r))&&(o[i++]=k),L=A-((c=A+_)-(T=c-A))+(_-T),A=c;for(;u<t;)(k=(m=L)-(w=(_=(r=h)+m)-r))&&(o[i++]=k),L=A-((c=A+_)-(T=c-A))+(_-T),A=c,(u+=1)<t&&(h=e[u]);for(;f<a;)(k=(m=L)-(w=(_=(r=s)+m)-r))&&(o[i++]=k),L=A-((c=A+_)-(T=c-A))+(_-T),A=c,(f+=1)<a&&(s=n[f]);return L&&(o[i++]=L),A&&(o[i++]=A),i||(o[i++]=0),o.length=i,o}},{}],290:[function(g,b,y){b.exports=function(t){return n(e(t))};var e=g("boundary-cells"),n=g("reduce-simplicial-complex")},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(g,b,y){b.exports=function(r,m,o,i){if(o=o||0,i===void 0&&(i=function(c){for(var T=c.length,_=0,w=0;w<T;++w)_=0|Math.max(_,c[w].length);return _-1}(r)),r.length===0||i<1)return{cells:[],vertexIds:[],vertexWeights:[]};var u=function(c,T){for(var _=c.length,w=n.mallocUint8(_),k=0;k<_;++k)w[k]=c[k]<T|0;return w}(m,+o),f=function(c,T){for(var _=c.length,w=T*(T+1)/2*_|0,k=n.mallocUint32(2*w),L=0,A=0;A<_;++A)for(var I=c[A],P=(T=I.length,0);P<T;++P)for(var S=0;S<P;++S){var E=I[S],D=I[P];k[L++]=0|Math.min(E,D),k[L++]=0|Math.max(E,D)}t(e(k,[L/2|0,2]));var R=2;for(A=2;A<L;A+=2)k[A-2]===k[A]&&k[A-1]===k[A+1]||(k[R++]=k[A],k[R++]=k[A+1]);return e(k,[R/2|0,2])}(r,i),l=function(c,T,_,w){for(var k=c.data,L=c.shape[0],A=n.mallocDouble(L),I=0,P=0;P<L;++P){var S=k[2*P],E=k[2*P+1];if(_[S]!==_[E]){var D=T[S],R=T[E];k[2*I]=S,k[2*I+1]=E,A[I++]=(R-w)/(R-D)}}return c.shape[0]=I,e(A,[I])}(f,m,u,+o),h=function(c,T){var _=n.mallocInt32(2*T),w=c.shape[0],k=c.data;_[0]=0;for(var L=0,A=0;A<w;++A){var I=k[2*A];if(I!==L){for(_[2*L+1]=A;++L<I;)_[2*L]=A,_[2*L+1]=A;_[2*L]=A}}for(_[2*L+1]=w;++L<T;)_[2*L]=_[2*L+1]=w;return _}(f,0|m.length),d=a(i)(r,f.data,h,u),s=function(c){for(var T=0|c.shape[0],_=c.data,w=new Array(T),k=0;k<T;++k)w[k]=[_[2*k],_[2*k+1]];return w}(f),x=[].slice.call(l.data,0,l.shape[0]);return n.free(u),n.free(f.data),n.free(l.data),n.free(h),{cells:d,vertexIds:s,vertexWeights:x}};var e=g("ndarray"),n=g("typedarray-pool"),t=g("ndarray-sort"),a=g("./lib/codegen")},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(g,b,y){b.exports=function(n){return e[n]()};var e=[function(){return function(n,t,a,r){for(var m=n.length,o=0;o<m;++o)n[o].length;return[]}},function(){function n(t,a,r,m){for(var o=0|Math.min(r,m),i=0|Math.max(r,m),u=t[2*o],f=t[2*o+1];u<f;){var l=u+f>>1,h=a[2*l+1];if(h===i)return l;i<h?f=l:u=l+1}return u}return function(t,a,r,m){for(var o=t.length,i=[],u=0;u<o;++u){var f=t[u];if(f.length===2){var l=(m[f[0]]<<0)+(m[f[1]]<<1);if(l===0||l===3)continue;switch(l){case 0:break;case 1:i.push([n(r,a,f[0],f[1])]);break;case 2:i.push([n(r,a,f[1],f[0])])}}}return i}},function(){function n(t,a,r,m){for(var o=0|Math.min(r,m),i=0|Math.max(r,m),u=t[2*o],f=t[2*o+1];u<f;){var l=u+f>>1,h=a[2*l+1];if(h===i)return l;i<h?f=l:u=l+1}return u}return function(t,a,r,m){for(var o=t.length,i=[],u=0;u<o;++u){var f=t[u],l=f.length;if(l===3){if((h=(m[f[0]]<<0)+(m[f[1]]<<1)+(m[f[2]]<<2))===0||h===7)continue;switch(h){case 0:break;case 1:i.push([n(r,a,f[0],f[2]),n(r,a,f[0],f[1])]);break;case 2:i.push([n(r,a,f[1],f[0]),n(r,a,f[1],f[2])]);break;case 3:i.push([n(r,a,f[0],f[2]),n(r,a,f[1],f[2])]);break;case 4:i.push([n(r,a,f[2],f[1]),n(r,a,f[2],f[0])]);break;case 5:i.push([n(r,a,f[2],f[1]),n(r,a,f[0],f[1])]);break;case 6:i.push([n(r,a,f[1],f[0]),n(r,a,f[2],f[0])])}}else if(l===2){var h;if((h=(m[f[0]]<<0)+(m[f[1]]<<1))===0||h===3)continue;switch(h){case 0:break;case 1:i.push([n(r,a,f[0],f[1])]);break;case 2:i.push([n(r,a,f[1],f[0])])}}}return i}},function(){function n(t,a,r,m){for(var o=0|Math.min(r,m),i=0|Math.max(r,m),u=t[2*o],f=t[2*o+1];u<f;){var l=u+f>>1,h=a[2*l+1];if(h===i)return l;i<h?f=l:u=l+1}return u}return function(t,a,r,m){for(var o=t.length,i=[],u=0;u<o;++u){var f=t[u],l=f.length;if(l===4){if((h=(m[f[0]]<<0)+(m[f[1]]<<1)+(m[f[2]]<<2)+(m[f[3]]<<3))===0||h===15)continue;switch(h){case 0:break;case 1:i.push([n(r,a,f[0],f[1]),n(r,a,f[0],f[2]),n(r,a,f[0],f[3])]);break;case 2:i.push([n(r,a,f[1],f[2]),n(r,a,f[1],f[0]),n(r,a,f[1],f[3])]);break;case 3:i.push([n(r,a,f[1],f[2]),n(r,a,f[0],f[2]),n(r,a,f[0],f[3])],[n(r,a,f[1],f[3]),n(r,a,f[1],f[2]),n(r,a,f[0],f[3])]);break;case 4:i.push([n(r,a,f[2],f[0]),n(r,a,f[2],f[1]),n(r,a,f[2],f[3])]);break;case 5:i.push([n(r,a,f[0],f[1]),n(r,a,f[2],f[1]),n(r,a,f[0],f[3])],[n(r,a,f[2],f[1]),n(r,a,f[2],f[3]),n(r,a,f[0],f[3])]);break;case 6:i.push([n(r,a,f[2],f[0]),n(r,a,f[1],f[0]),n(r,a,f[1],f[3])],[n(r,a,f[2],f[3]),n(r,a,f[2],f[0]),n(r,a,f[1],f[3])]);break;case 7:i.push([n(r,a,f[0],f[3]),n(r,a,f[1],f[3]),n(r,a,f[2],f[3])]);break;case 8:i.push([n(r,a,f[3],f[1]),n(r,a,f[3],f[0]),n(r,a,f[3],f[2])]);break;case 9:i.push([n(r,a,f[3],f[1]),n(r,a,f[0],f[1]),n(r,a,f[0],f[2])],[n(r,a,f[3],f[2]),n(r,a,f[3],f[1]),n(r,a,f[0],f[2])]);break;case 10:i.push([n(r,a,f[1],f[0]),n(r,a,f[3],f[0]),n(r,a,f[1],f[2])],[n(r,a,f[3],f[0]),n(r,a,f[3],f[2]),n(r,a,f[1],f[2])]);break;case 11:i.push([n(r,a,f[1],f[2]),n(r,a,f[0],f[2]),n(r,a,f[3],f[2])]);break;case 12:i.push([n(r,a,f[3],f[0]),n(r,a,f[2],f[0]),n(r,a,f[2],f[1])],[n(r,a,f[3],f[1]),n(r,a,f[3],f[0]),n(r,a,f[2],f[1])]);break;case 13:i.push([n(r,a,f[0],f[1]),n(r,a,f[2],f[1]),n(r,a,f[3],f[1])]);break;case 14:i.push([n(r,a,f[2],f[0]),n(r,a,f[1],f[0]),n(r,a,f[3],f[0])])}}else if(l===3){if((h=(m[f[0]]<<0)+(m[f[1]]<<1)+(m[f[2]]<<2))===0||h===7)continue;switch(h){case 0:break;case 1:i.push([n(r,a,f[0],f[2]),n(r,a,f[0],f[1])]);break;case 2:i.push([n(r,a,f[1],f[0]),n(r,a,f[1],f[2])]);break;case 3:i.push([n(r,a,f[0],f[2]),n(r,a,f[1],f[2])]);break;case 4:i.push([n(r,a,f[2],f[1]),n(r,a,f[2],f[0])]);break;case 5:i.push([n(r,a,f[2],f[1]),n(r,a,f[0],f[1])]);break;case 6:i.push([n(r,a,f[1],f[0]),n(r,a,f[2],f[0])])}}else if(l===2){var h;if((h=(m[f[0]]<<0)+(m[f[1]]<<1))===0||h===3)continue;switch(h){case 0:break;case 1:i.push([n(r,a,f[0],f[1])]);break;case 2:i.push([n(r,a,f[1],f[0])])}}}return i}}]},{}],293:[function(g,b,y){var e=g("bit-twiddle"),n=g("union-find");function t(f,l){var h=f.length,d=f.length-l.length,s=Math.min;if(d)return d;switch(h){case 0:return 0;case 1:return f[0]-l[0];case 2:return(T=f[0]+f[1]-l[0]-l[1])||s(f[0],f[1])-s(l[0],l[1]);case 3:var x=f[0]+f[1],c=l[0]+l[1];if(T=x+f[2]-(c+l[2]))return T;var T,_=s(f[0],f[1]),w=s(l[0],l[1]);return(T=s(_,f[2])-s(w,l[2]))||s(_+f[2],x)-s(w+l[2],c);default:var k=f.slice(0);k.sort();var L=l.slice(0);L.sort();for(var A=0;A<h;++A)if(d=k[A]-L[A])return d;return 0}}function a(f,l){return t(f[0],l[0])}function r(f,l){if(l){for(var h=f.length,d=new Array(h),s=0;s<h;++s)d[s]=[f[s],l[s]];for(d.sort(a),s=0;s<h;++s)f[s]=d[s][0],l[s]=d[s][1];return f}return f.sort(t),f}function m(f){if(f.length===0)return[];for(var l=1,h=f.length,d=1;d<h;++d){var s=f[d];if(t(s,f[d-1])){if(d===l){l++;continue}f[l++]=s}}return f.length=l,f}function o(f,l){for(var h=0,d=f.length-1,s=-1;h<=d;){var x=h+d>>1,c=t(f[x],l);c<=0?(c===0&&(s=x),h=x+1):c>0&&(d=x-1)}return s}function i(f,l){for(var h=new Array(f.length),d=0,s=h.length;d<s;++d)h[d]=[];for(var x=[],c=(d=0,l.length);d<c;++d)for(var T=l[d],_=T.length,w=1,k=1<<_;w<k;++w){x.length=e.popCount(w);for(var L=0,A=0;A<_;++A)w&1<<A&&(x[L++]=T[A]);var I=o(f,x);if(!(I<0))for(;h[I++].push(d),!(I>=f.length||t(f[I],x)!==0););}return h}function u(f,l){if(l<0)return[];for(var h=[],d=(1<<l+1)-1,s=0;s<f.length;++s)for(var x=f[s],c=d;c<1<<x.length;c=e.nextCombination(c)){for(var T=new Array(l+1),_=0,w=0;w<x.length;++w)c&1<<w&&(T[_++]=x[w]);h.push(T)}return r(h)}y.dimension=function(f){for(var l=0,h=Math.max,d=0,s=f.length;d<s;++d)l=h(l,f[d].length);return l-1},y.countVertices=function(f){for(var l=-1,h=Math.max,d=0,s=f.length;d<s;++d)for(var x=f[d],c=0,T=x.length;c<T;++c)l=h(l,x[c]);return l+1},y.cloneCells=function(f){for(var l=new Array(f.length),h=0,d=f.length;h<d;++h)l[h]=f[h].slice(0);return l},y.compareCells=t,y.normalize=r,y.unique=m,y.findCell=o,y.incidence=i,y.dual=function(f,l){if(!l)return i(m(u(f,0)),f);for(var h=new Array(l),d=0;d<l;++d)h[d]=[];d=0;for(var s=f.length;d<s;++d)for(var x=f[d],c=0,T=x.length;c<T;++c)h[x[c]].push(d);return h},y.explode=function(f){for(var l=[],h=0,d=f.length;h<d;++h)for(var s=f[h],x=0|s.length,c=1,T=1<<x;c<T;++c){for(var _=[],w=0;w<x;++w)c>>>w&1&&_.push(s[w]);l.push(_)}return r(l)},y.skeleton=u,y.boundary=function(f){for(var l=[],h=0,d=f.length;h<d;++h)for(var s=f[h],x=0,c=s.length;x<c;++x){for(var T=new Array(s.length-1),_=0,w=0;_<c;++_)_!==x&&(T[w++]=s[_]);l.push(T)}return r(l)},y.connectedComponents=function(f,l){return l?function(h,d){for(var s=new n(d),x=0;x<h.length;++x)for(var c=h[x],T=0;T<c.length;++T)for(var _=T+1;_<c.length;++_)s.link(c[T],c[_]);var w=[],k=s.ranks;for(x=0;x<k.length;++x)k[x]=-1;for(x=0;x<h.length;++x){var L=s.find(h[x][0]);k[L]<0?(k[L]=w.length,w.push([h[x].slice(0)])):w[k[L]].push(h[x].slice(0))}return w}(f,l):function(h){for(var d=m(r(u(h,0))),s=new n(d.length),x=0;x<h.length;++x)for(var c=h[x],T=0;T<c.length;++T)for(var _=o(d,[c[T]]),w=T+1;w<c.length;++w)s.link(_,o(d,[c[w]]));var k=[],L=s.ranks;for(x=0;x<L.length;++x)L[x]=-1;for(x=0;x<h.length;++x){var A=s.find(o(d,[h[x][0]]));L[A]<0?(L[A]=k.length,k.push([h[x].slice(0)])):k[L[A]].push(h[x].slice(0))}return k}(f)}},{"bit-twiddle":32,"union-find":309}],294:[function(g,b,y){arguments[4][32][0].apply(y,arguments)},{dup:32}],295:[function(g,b,y){arguments[4][293][0].apply(y,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(g,b,y){function e(n){this.roots=new Array(n),this.ranks=new Array(n);for(var t=0;t<n;++t)this.roots[t]=t,this.ranks[t]=0}b.exports=e,e.prototype.length=function(){return this.roots.length},e.prototype.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},e.prototype.find=function(n){for(var t=this.roots;t[n]!==n;){var a=t[n];t[n]=t[a],n=a}return n},e.prototype.link=function(n,t){var a=this.find(n),r=this.find(t);if(a!==r){var m=this.ranks,o=this.roots,i=m[a],u=m[r];i<u?o[a]=r:u<i?o[r]=a:(o[r]=a,++m[a])}}},{}],297:[function(g,b,y){b.exports=function(t,a,r){for(var m=a.length,o=t.length,i=new Array(m),u=new Array(m),f=new Array(m),l=new Array(m),h=0;h<m;++h)i[h]=u[h]=-1,f[h]=1/0,l[h]=!1;for(h=0;h<o;++h){var d=t[h];if(d.length!==2)throw new Error("Input must be a graph");var s=d[1],x=d[0];u[x]!==-1?u[x]=-2:u[x]=s,i[s]!==-1?i[s]=-2:i[s]=x}function c($){if(l[$])return 1/0;var G,W,te,N,B,U=i[$],ee=u[$];return U<0||ee<0?1/0:(G=a[$],W=a[U],te=a[ee],N=Math.abs(e(G,W,te)),B=Math.sqrt(Math.pow(W[0]-te[0],2)+Math.pow(W[1]-te[1],2)),N/B)}function T($,G){var W=S[$],te=S[G];S[$]=te,S[G]=W,E[W]=G,E[te]=$}function _($){return f[S[$]]}function w($){return 1&$?$-1>>1:($>>1)-1}function k($){for(var G=_($);;){var W=G,te=2*$+1,N=2*($+1),B=$;if(te<D){var U=_(te);U<W&&(B=te,W=U)}if(N<D&&_(N)<W&&(B=N),B===$)return $;T($,B),$=B}}function L($){for(var G=_($);$>0;){var W=w($);if(W>=0&&G<_(W)){T($,W),$=W;continue}return $}}function A(){if(D>0){var $=S[0];return T(0,D-1),D-=1,k(0),$}return-1}function I($,G){var W=S[$];return f[W]===G?$:(f[W]=-1/0,L($),A(),f[W]=G,L((D+=1)-1))}function P($){if(!l[$]){l[$]=!0;var G=i[$],W=u[$];i[W]>=0&&(i[W]=G),u[G]>=0&&(u[G]=W),E[G]>=0&&I(E[G],c(G)),E[W]>=0&&I(E[W],c(W))}}var S=[],E=new Array(m);for(h=0;h<m;++h)(f[h]=c(h))<1/0?(E[h]=S.length,S.push(h)):E[h]=-1;var D=S.length;for(h=D>>1;h>=0;--h)k(h);for(;;){var R=A();if(R<0||f[R]>r)break;P(R)}var H=[];for(h=0;h<m;++h)l[h]||(E[h]=H.length,H.push(a[h].slice()));H.length;function V($,G){if($[G]<0)return G;var W=G,te=G;do{var N=$[te];if(!l[te]||N<0||N===te||(N=$[te=N],!l[te]||N<0||N===te))break;te=N,W=$[W]}while(W!==te);for(var B=G;B!==te;B=$[B])$[B]=te;return te}var X=[];return t.forEach(function($){var G=V(i,$[0]),W=V(u,$[1]);if(G>=0&&W>=0&&G!==W){var te=E[G],N=E[W];te!==N&&X.push([te,N])}}),n.unique(n.normalize(X)),{positions:H,edges:X}};var e=g("robust-orientation"),n=g("simplicial-complex")},{"robust-orientation":284,"simplicial-complex":295}],298:[function(g,b,y){b.exports=function(t,a){var r,m,o,i;if(a[0][0]<a[1][0])r=a[0],m=a[1];else{if(!(a[0][0]>a[1][0]))return n(a,t);r=a[1],m=a[0]}if(t[0][0]<t[1][0])o=t[0],i=t[1];else{if(!(t[0][0]>t[1][0]))return-n(t,a);o=t[1],i=t[0]}var u=e(r,m,i),f=e(r,m,o);if(u<0){if(f<=0)return u}else if(u>0){if(f>=0)return u}else if(f)return f;if(u=e(i,o,m),f=e(i,o,r),u<0){if(f<=0)return u}else if(u>0){if(f>=0)return u}else if(f)return f;return m[0]-i[0]};var e=g("robust-orientation");function n(t,a){var r,m,o,i;if(a[0][0]<a[1][0])r=a[0],m=a[1];else{if(!(a[0][0]>a[1][0])){var u=Math.min(t[0][1],t[1][1]),f=Math.max(t[0][1],t[1][1]),l=Math.min(a[0][1],a[1][1]),h=Math.max(a[0][1],a[1][1]);return f<l?f-l:u>h?u-h:f-h}r=a[1],m=a[0]}t[0][1]<t[1][1]?(o=t[0],i=t[1]):(o=t[1],i=t[0]);var d=e(m,r,o);return d||(d=e(m,r,i))||i-m}},{"robust-orientation":284}],299:[function(g,b,y){b.exports=function(f){for(var l=f.length,h=2*l,d=new Array(h),s=0;s<l;++s){var x=f[s],c=x[0][0]<x[1][0];d[2*s]=new u(x[0][0],x,c,s),d[2*s+1]=new u(x[1][0],x,!c,s)}d.sort(function(P,S){var E=P.x-S.x;return E||(E=P.create-S.create)||Math.min(P.segment[0][1],P.segment[1][1])-Math.min(S.segment[0][1],S.segment[1][1])});var T=n(a),_=[],w=[],k=[];for(s=0;s<h;){for(var L=d[s].x,A=[];s<h;){var I=d[s];if(I.x!==L)break;s+=1,I.segment[0][0]===I.x&&I.segment[1][0]===I.x?I.create&&(I.segment[0][1]<I.segment[1][1]?(A.push(new i(I.segment[0][1],I.index,!0,!0)),A.push(new i(I.segment[1][1],I.index,!1,!1))):(A.push(new i(I.segment[1][1],I.index,!0,!1)),A.push(new i(I.segment[0][1],I.index,!1,!0)))):T=I.create?T.insert(I.segment,I.index):T.remove(I.segment)}_.push(T.root),w.push(L),k.push(A)}return new r(_,w,k)};var e=g("binary-search-bounds"),n=g("functional-red-black-tree"),t=g("robust-orientation"),a=g("./lib/order-segments");function r(f,l,h){this.slabs=f,this.coordinates=l,this.horizontal=h}function m(f,l){return f.y-l}function o(f,l){for(var h=null;f;){var d,s,x=f.key;x[0][0]<x[1][0]?(d=x[0],s=x[1]):(d=x[1],s=x[0]);var c=t(d,s,l);if(c<0)f=f.left;else if(c>0)if(l[0]!==x[1][0])h=f,f=f.right;else{if(T=o(f.right,l))return T;f=f.left}else{if(l[0]!==x[1][0])return f;var T;if(T=o(f.right,l))return T;f=f.left}}return h}function i(f,l,h,d){this.y=f,this.index=l,this.start=h,this.closed=d}function u(f,l,h,d){this.x=f,this.segment=l,this.create=h,this.index=d}r.prototype.castUp=function(f){var l=e.le(this.coordinates,f[0]);if(l<0)return-1;this.slabs[l];var h=o(this.slabs[l],f),d=-1;if(h&&(d=h.value),this.coordinates[l]===f[0]){var s=null;if(h&&(s=h.key),l>0){var x=o(this.slabs[l-1],f);x&&(s?a(x.key,s)>0&&(s=x.key,d=x.value):(d=x.value,s=x.key))}var c=this.horizontal[l];if(c.length>0){var T=e.ge(c,f[1],m);if(T<c.length){var _=c[T];if(f[1]===_.y){if(_.closed)return _.index;for(;T<c.length-1&&c[T+1].y===f[1];)if((_=c[T+=1]).closed)return _.index;if(_.y===f[1]&&!_.start){if((T+=1)>=c.length)return d;_=c[T]}}if(_.start)if(s){var w=t(s[0],s[1],[f[0],_.y]);s[0][0]>s[1][0]&&(w=-w),w>0&&(d=_.index)}else d=_.index;else _.y!==f[1]&&(d=_.index)}}}return d}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(g,b,y){var e=g("robust-dot-product"),n=g("robust-sum");function t(r,m){var o=n(e(r,m),[m[m.length-1]]);return o[o.length-1]}function a(r,m,o,i){var u=-m/(i-m);u<0?u=0:u>1&&(u=1);for(var f=1-u,l=r.length,h=new Array(l),d=0;d<l;++d)h[d]=u*r[d]+f*o[d];return h}b.exports=function(r,m){for(var o=[],i=[],u=t(r[r.length-1],m),f=r[r.length-1],l=r[0],h=0;h<r.length;++h,f=l){var d=t(l=r[h],m);if(u<0&&d>0||u>0&&d<0){var s=a(f,d,l,u);o.push(s),i.push(s.slice())}d<0?i.push(l.slice()):d>0?o.push(l.slice()):(o.push(l.slice()),i.push(l.slice())),u=d}return{positive:o,negative:i}},b.exports.positive=function(r,m){for(var o=[],i=t(r[r.length-1],m),u=r[r.length-1],f=r[0],l=0;l<r.length;++l,u=f){var h=t(f=r[l],m);(i<0&&h>0||i>0&&h<0)&&o.push(a(u,h,f,i)),h>=0&&o.push(f.slice()),i=h}return o},b.exports.negative=function(r,m){for(var o=[],i=t(r[r.length-1],m),u=r[r.length-1],f=r[0],l=0;l<r.length;++l,u=f){var h=t(f=r[l],m);(i<0&&h>0||i>0&&h<0)&&o.push(a(u,h,f,i)),h<=0&&o.push(f.slice()),i=h}return o}},{"robust-dot-product":281,"robust-sum":289}],301:[function(g,b,y){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function n(o){return a(m(o),arguments)}function t(o,i){return n.apply(null,[o].concat(i||[]))}function a(o,i){var u,f,l,h,d,s,x,c,T,_=1,w=o.length,k="";for(f=0;f<w;f++)if(typeof o[f]=="string")k+=o[f];else if(typeof o[f]=="object"){if((h=o[f]).keys)for(u=i[_],l=0;l<h.keys.length;l++){if(u==null)throw new Error(n('[sprintf] Cannot access property "%s" of undefined value "%s"',h.keys[l],h.keys[l-1]));u=u[h.keys[l]]}else u=h.param_no?i[h.param_no]:i[_++];if(e.not_type.test(h.type)&&e.not_primitive.test(h.type)&&u instanceof Function&&(u=u()),e.numeric_arg.test(h.type)&&typeof u!="number"&&isNaN(u))throw new TypeError(n("[sprintf] expecting number but found %T",u));switch(e.number.test(h.type)&&(c=u>=0),h.type){case"b":u=parseInt(u,10).toString(2);break;case"c":u=String.fromCharCode(parseInt(u,10));break;case"d":case"i":u=parseInt(u,10);break;case"j":u=JSON.stringify(u,null,h.width?parseInt(h.width):0);break;case"e":u=h.precision?parseFloat(u).toExponential(h.precision):parseFloat(u).toExponential();break;case"f":u=h.precision?parseFloat(u).toFixed(h.precision):parseFloat(u);break;case"g":u=h.precision?String(Number(u.toPrecision(h.precision))):parseFloat(u);break;case"o":u=(parseInt(u,10)>>>0).toString(8);break;case"s":u=String(u),u=h.precision?u.substring(0,h.precision):u;break;case"t":u=String(!!u),u=h.precision?u.substring(0,h.precision):u;break;case"T":u=Object.prototype.toString.call(u).slice(8,-1).toLowerCase(),u=h.precision?u.substring(0,h.precision):u;break;case"u":u=parseInt(u,10)>>>0;break;case"v":u=u.valueOf(),u=h.precision?u.substring(0,h.precision):u;break;case"x":u=(parseInt(u,10)>>>0).toString(16);break;case"X":u=(parseInt(u,10)>>>0).toString(16).toUpperCase()}e.json.test(h.type)?k+=u:(!e.number.test(h.type)||c&&!h.sign?T="":(T=c?"+":"-",u=u.toString().replace(e.sign,"")),s=h.pad_char?h.pad_char==="0"?"0":h.pad_char.charAt(1):" ",x=h.width-(T+u).length,d=h.width&&x>0?s.repeat(x):"",k+=h.align?T+u+d:s==="0"?T+d+u:d+T+u)}return k}var r=Object.create(null);function m(o){if(r[o])return r[o];for(var i,u=o,f=[],l=0;u;){if((i=e.text.exec(u))!==null)f.push(i[0]);else if((i=e.modulo.exec(u))!==null)f.push("%");else{if((i=e.placeholder.exec(u))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(i[2]){l|=1;var h=[],d=i[2],s=[];if((s=e.key.exec(d))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(h.push(s[1]);(d=d.substring(s[0].length))!=="";)if((s=e.key_access.exec(d))!==null)h.push(s[1]);else{if((s=e.index_access.exec(d))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");h.push(s[1])}i[2]=h}else l|=2;if(l===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");f.push({placeholder:i[0],param_no:i[1],keys:i[2],sign:i[3],pad_char:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}u=u.substring(i[0].length)}return r[o]=f}y!==void 0&&(y.sprintf=n,y.vsprintf=t),typeof window<"u"&&(window.sprintf=n,window.vsprintf=t)})()},{}],302:[function(g,b,y){b.exports=function(r,m){if(r.dimension<=0)return{positions:[],cells:[]};if(r.dimension===1)return function(u,f){for(var l=n(u,f),h=l.length,d=new Array(h),s=new Array(h),x=0;x<h;++x)d[x]=[l[x]],s[x]=[x];return{positions:d,cells:s}}(r,m);var o=r.order.join()+"-"+r.dtype,i=a[o];return m=+m||0,i||(i=a[o]=function(u,f){var l=u.length+"d",h=t[l];if(h)return h(e,u,f)}(r.order,r.dtype)),i(r,m)};var e=g("ndarray-extract-contour"),n=g("zero-crossings"),t={"2d":function(r,m,o){var i=r({order:m,scalarArguments:3,getters:o==="generic"?[0]:void 0,phase:function(u,f,l,h){return u>h|0},vertex:function(u,f,l,h,d,s,x,c,T,_,w,k,L){var A=(x<<0)+(c<<1)+(T<<2)+(_<<3)|0;if(A!==0&&A!==15)switch(A){case 0:w.push([u-.5,f-.5]);break;case 1:w.push([u-.25-.25*(h+l-2*L)/(l-h),f-.25-.25*(d+l-2*L)/(l-d)]);break;case 2:w.push([u-.75-.25*(-h-l+2*L)/(h-l),f-.25-.25*(s+h-2*L)/(h-s)]);break;case 3:w.push([u-.5,f-.5-.5*(d+l+s+h-4*L)/(l-d+h-s)]);break;case 4:w.push([u-.25-.25*(s+d-2*L)/(d-s),f-.75-.25*(-d-l+2*L)/(d-l)]);break;case 5:w.push([u-.5-.5*(h+l+s+d-4*L)/(l-h+d-s),f-.5]);break;case 6:w.push([u-.5-.25*(-h-l+s+d)/(h-l+d-s),f-.5-.25*(-d-l+s+h)/(d-l+h-s)]);break;case 7:w.push([u-.75-.25*(s+d-2*L)/(d-s),f-.75-.25*(s+h-2*L)/(h-s)]);break;case 8:w.push([u-.75-.25*(-s-d+2*L)/(s-d),f-.75-.25*(-s-h+2*L)/(s-h)]);break;case 9:w.push([u-.5-.25*(h+l+-s-d)/(l-h+s-d),f-.5-.25*(d+l+-s-h)/(l-d+s-h)]);break;case 10:w.push([u-.5-.5*(-h-l-s-d+4*L)/(h-l+s-d),f-.5]);break;case 11:w.push([u-.25-.25*(-s-d+2*L)/(s-d),f-.75-.25*(d+l-2*L)/(l-d)]);break;case 12:w.push([u-.5,f-.5-.5*(-d-l-s-h+4*L)/(d-l+s-h)]);break;case 13:w.push([u-.75-.25*(h+l-2*L)/(l-h),f-.25-.25*(-s-h+2*L)/(s-h)]);break;case 14:w.push([u-.25-.25*(-h-l+2*L)/(h-l),f-.25-.25*(-d-l+2*L)/(d-l)]);break;case 15:w.push([u-.5,f-.5])}},cell:function(u,f,l,h,d,s,x,c,T){d?c.push([u,f]):c.push([f,u])}});return function(u,f){var l=[],h=[];return i(u,l,h,f),{positions:l,cells:h}}}},a={}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(g,b,y){(function(e){(function(){b.exports=function r(m,o,i){i=i||{};var u=a[m];u||(u=a[m]={" ":{data:new Float32Array(0),shape:.2}});var f=u[o];if(!f)if(o.length<=1||!/\d/.test(o))f=u[o]=function(L){for(var A=L.cells,I=L.positions,P=new Float32Array(6*A.length),S=0,E=0,D=0;D<A.length;++D)for(var R=A[D],H=0;H<3;++H){var V=I[R[H]];P[S++]=V[0],P[S++]=V[1]+1.4,E=Math.max(V[0],E)}return{data:P,shape:E}}(n(o,{triangles:!0,font:m,textAlign:i.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var l=o.split(/(\d|\s)/),h=new Array(l.length),d=0,s=0,x=0;x<l.length;++x)h[x]=r(m,l[x]),d+=h[x].data.length,s+=h[x].shape,x>0&&(s+=.02);var c=new Float32Array(d),T=0,_=-.5*s;for(x=0;x<h.length;++x){for(var w=h[x].data,k=0;k<w.length;k+=2)c[T++]=w[k]+_,c[T++]=w[k+1];_+=h[x].shape+.02}f=u[o]={data:c,shape:s}}return f};var n=g("vectorize-text"),t=window||e.global||{},a=t.__TEXT_CACHE||{};t.__TEXT_CACHE={}}).call(this)}).call(this,g("_process"))},{_process:5,"vectorize-text":311}],304:[function(g,b,y){var e=g("parse-unit");b.exports=t;function n(a,r){var m=e(getComputedStyle(a).getPropertyValue(r));return m[0]*t(m[1],a)}function t(a,r){switch(r=r||document.body,a=(a||"px").trim().toLowerCase(),r!==window&&r!==document||(r=document.body),a){case"%":return r.clientHeight/100;case"ch":case"ex":return function(m,o){var i=document.createElement("div");i.style["font-size"]="128"+m,o.appendChild(i);var u=n(i,"font-size")/128;return o.removeChild(i),u}(a,r);case"em":return n(r,"font-size");case"rem":return n(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}},{"parse-unit":265}],305:[function(g,b,y){b.exports=function(d){var s=(d=d||{}).center||[0,0,0],x=d.up||[0,1,0],c=d.right||u(x),T=d.radius||1,_=d.theta||0,w=d.phi||0;if(s=[].slice.call(s,0,3),x=[].slice.call(x,0,3),r(x,x),c=[].slice.call(c,0,3),r(c,c),"eye"in d){var k=d.eye,L=[k[0]-s[0],k[1]-s[1],k[2]-s[2]];a(c,L,x),o(c[0],c[1],c[2])<1e-6?c=u(x):r(c,c),T=o(L[0],L[1],L[2]);var A=m(x,L)/T,I=m(c,L)/T;w=Math.acos(A),_=Math.acos(I)}return T=Math.log(T),new f(d.zoomMin,d.zoomMax,s,x,c,T,_,w)};var e=g("filtered-vector"),n=g("gl-mat4/invert"),t=g("gl-mat4/rotate"),a=g("gl-vec3/cross"),r=g("gl-vec3/normalize"),m=g("gl-vec3/dot");function o(d,s,x){return Math.sqrt(Math.pow(d,2)+Math.pow(s,2)+Math.pow(x,2))}function i(d){return Math.min(1,Math.max(-1,d))}function u(d){var s=Math.abs(d[0]),x=Math.abs(d[1]),c=Math.abs(d[2]),T=[0,0,0];s>Math.max(x,c)?T[2]=1:x>Math.max(s,c)?T[0]=1:T[1]=1;for(var _=0,w=0,k=0;k<3;++k)_+=d[k]*d[k],w+=T[k]*d[k];for(k=0;k<3;++k)T[k]-=w/_*d[k];return r(T,T),T}function f(d,s,x,c,T,_,w,k){this.center=e(x),this.up=e(c),this.right=e(T),this.radius=e([_]),this.angle=e([w,k]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(d,s),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var L=0;L<16;++L)this.computedMatrix[L]=.5;this.recalcMatrix(0)}var l=f.prototype;l.setDistanceLimits=function(d,s){d=d>0?Math.log(d):-1/0,s=s>0?Math.log(s):1/0,s=Math.max(s,d),this.radius.bounds[0][0]=d,this.radius.bounds[1][0]=s},l.getDistanceLimits=function(d){var s=this.radius.bounds[0];return d?(d[0]=Math.exp(s[0][0]),d[1]=Math.exp(s[1][0]),d):[Math.exp(s[0][0]),Math.exp(s[1][0])]},l.recalcMatrix=function(d){this.center.curve(d),this.up.curve(d),this.right.curve(d),this.radius.curve(d),this.angle.curve(d);for(var s=this.computedUp,x=this.computedRight,c=0,T=0,_=0;_<3;++_)T+=s[_]*x[_],c+=s[_]*s[_];var w=Math.sqrt(c),k=0;for(_=0;_<3;++_)x[_]-=s[_]*T/c,k+=x[_]*x[_],s[_]/=w;var L=Math.sqrt(k);for(_=0;_<3;++_)x[_]/=L;var A=this.computedToward;a(A,s,x),r(A,A);var I=Math.exp(this.computedRadius[0]),P=this.computedAngle[0],S=this.computedAngle[1],E=Math.cos(P),D=Math.sin(P),R=Math.cos(S),H=Math.sin(S),V=this.computedCenter,X=E*R,$=D*R,G=H,W=-E*H,te=-D*H,N=R,B=this.computedEye,U=this.computedMatrix;for(_=0;_<3;++_){var ee=X*x[_]+$*A[_]+G*s[_];U[4*_+1]=W*x[_]+te*A[_]+N*s[_],U[4*_+2]=ee,U[4*_+3]=0}var j=U[1],Q=U[5],K=U[9],re=U[2],ne=U[6],le=U[10],oe=Q*le-K*ne,de=K*re-j*le,se=j*ne-Q*re,me=o(oe,de,se);for(oe/=me,de/=me,se/=me,U[0]=oe,U[4]=de,U[8]=se,_=0;_<3;++_)B[_]=V[_]+U[2+4*_]*I;for(_=0;_<3;++_){k=0;for(var Te=0;Te<3;++Te)k+=U[_+4*Te]*B[Te];U[12+_]=-k}U[15]=1},l.getMatrix=function(d,s){this.recalcMatrix(d);var x=this.computedMatrix;if(s){for(var c=0;c<16;++c)s[c]=x[c];return s}return x};var h=[0,0,0];l.rotate=function(d,s,x,c){if(this.angle.move(d,s,x),c){this.recalcMatrix(d);var T=this.computedMatrix;h[0]=T[2],h[1]=T[6],h[2]=T[10];for(var _=this.computedUp,w=this.computedRight,k=this.computedToward,L=0;L<3;++L)T[4*L]=_[L],T[4*L+1]=w[L],T[4*L+2]=k[L];for(t(T,T,c,h),L=0;L<3;++L)_[L]=T[4*L],w[L]=T[4*L+1];this.up.set(d,_[0],_[1],_[2]),this.right.set(d,w[0],w[1],w[2])}},l.pan=function(d,s,x,c){s=s||0,x=x||0,c=c||0,this.recalcMatrix(d);var T=this.computedMatrix,_=(Math.exp(this.computedRadius[0]),T[1]),w=T[5],k=T[9],L=o(_,w,k);_/=L,w/=L,k/=L;var A=T[0],I=T[4],P=T[8],S=A*_+I*w+P*k,E=o(A-=_*S,I-=w*S,P-=k*S),D=(A/=E)*s+_*x,R=(I/=E)*s+w*x,H=(P/=E)*s+k*x;this.center.move(d,D,R,H);var V=Math.exp(this.computedRadius[0]);V=Math.max(1e-4,V+c),this.radius.set(d,Math.log(V))},l.translate=function(d,s,x,c){this.center.move(d,s||0,x||0,c||0)},l.setMatrix=function(d,s,x,c){var T=1;typeof x=="number"&&(T=0|x),(T<0||T>3)&&(T=1);var _=(T+2)%3;s||(this.recalcMatrix(d),s=this.computedMatrix);var w=s[T],k=s[T+4],L=s[T+8];if(c){var A=Math.abs(w),I=Math.abs(k),P=Math.abs(L),S=Math.max(A,I,P);A===S?(w=w<0?-1:1,k=L=0):P===S?(L=L<0?-1:1,w=k=0):(k=k<0?-1:1,w=L=0)}else{var E=o(w,k,L);w/=E,k/=E,L/=E}var D,R,H=s[_],V=s[_+4],X=s[_+8],$=H*w+V*k+X*L,G=o(H-=w*$,V-=k*$,X-=L*$),W=k*(X/=G)-L*(V/=G),te=L*(H/=G)-w*X,N=w*V-k*H,B=o(W,te,N);if(W/=B,te/=B,N/=B,this.center.jump(d,fe,ve,Me),this.radius.idle(d),this.up.jump(d,w,k,L),this.right.jump(d,H,V,X),T===2){var U=s[1],ee=s[5],j=s[9],Q=U*H+ee*V+j*X,K=U*W+ee*te+j*N;D=oe<0?-Math.PI/2:Math.PI/2,R=Math.atan2(K,Q)}else{var re=s[2],ne=s[6],le=s[10],oe=re*w+ne*k+le*L,de=re*H+ne*V+le*X,se=re*W+ne*te+le*N;D=Math.asin(i(oe)),R=Math.atan2(se,de)}this.angle.jump(d,R,D),this.recalcMatrix(d);var me=s[2],Te=s[6],_e=s[10],be=this.computedMatrix;n(be,s);var Ce=be[15],fe=be[12]/Ce,ve=be[13]/Ce,Me=be[14]/Ce,ke=Math.exp(this.computedRadius[0]);this.center.jump(d,fe-me*ke,ve-Te*ke,Me-_e*ke)},l.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},l.idle=function(d){this.center.idle(d),this.up.idle(d),this.right.idle(d),this.radius.idle(d),this.angle.idle(d)},l.flush=function(d){this.center.flush(d),this.up.flush(d),this.right.flush(d),this.radius.flush(d),this.angle.flush(d)},l.setDistance=function(d,s){s>0&&this.radius.set(d,Math.log(s))},l.lookAt=function(d,s,x,c){this.recalcMatrix(d),s=s||this.computedEye,x=x||this.computedCenter;var T=(c=c||this.computedUp)[0],_=c[1],w=c[2],k=o(T,_,w);if(!(k<1e-6)){T/=k,_/=k,w/=k;var L=s[0]-x[0],A=s[1]-x[1],I=s[2]-x[2],P=o(L,A,I);if(!(P<1e-6)){L/=P,A/=P,I/=P;var S=this.computedRight,E=S[0],D=S[1],R=S[2],H=T*E+_*D+w*R,V=o(E-=H*T,D-=H*_,R-=H*w);if(!(V<.01&&(V=o(E=_*I-w*A,D=w*L-T*I,R=T*A-_*L))<1e-6)){E/=V,D/=V,R/=V,this.up.set(d,T,_,w),this.right.set(d,E,D,R),this.center.set(d,x[0],x[1],x[2]),this.radius.set(d,Math.log(P));var X=_*R-w*D,$=w*E-T*R,G=T*D-_*E,W=o(X,$,G),te=T*L+_*A+w*I,N=E*L+D*A+R*I,B=(X/=W)*L+($/=W)*A+(G/=W)*I,U=Math.asin(i(te)),ee=Math.atan2(B,N),j=this.angle._state,Q=j[j.length-1],K=j[j.length-2];Q%=2*Math.PI;var re=Math.abs(Q+2*Math.PI-ee),ne=Math.abs(Q-ee),le=Math.abs(Q-2*Math.PI-ee);re<ne&&(Q+=2*Math.PI),le<ne&&(Q-=2*Math.PI),this.angle.jump(this.angle.lastT(),Q,K),this.angle.set(d,ee,U)}}}}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(g,b,y){b.exports=function(n,t,a){var r=n*t,m=e*n,o=m-(m-n),i=n-o,u=e*t,f=u-(u-t),l=t-f,h=i*l-(r-o*f-i*f-o*l);return a?(a[0]=h,a[1]=r,a):[h,r]};var e=+(Math.pow(2,27)+1)},{}],307:[function(g,b,y){b.exports=function(e,n,t){var a=e+n,r=a-e,m=n-r,o=e-(a-r);return t?(t[0]=o+m,t[1]=a,t):[o+m,a]}},{}],308:[function(g,b,y){(function(e){(function(){var n=g("bit-twiddle"),t=g("dup"),a=g("buffer").Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:t([32,0]),UINT16:t([32,0]),UINT32:t([32,0]),BIGUINT64:t([32,0]),INT8:t([32,0]),INT16:t([32,0]),INT32:t([32,0]),BIGINT64:t([32,0]),FLOAT:t([32,0]),DOUBLE:t([32,0]),DATA:t([32,0]),UINT8C:t([32,0]),BUFFER:t([32,0])});var r=typeof Uint8ClampedArray<"u",m=typeof BigUint64Array<"u",o=typeof BigInt64Array<"u",i=e.__TYPEDARRAY_POOL;i.UINT8C||(i.UINT8C=t([32,0])),i.BIGUINT64||(i.BIGUINT64=t([32,0])),i.BIGINT64||(i.BIGINT64=t([32,0])),i.BUFFER||(i.BUFFER=t([32,0]));var u=i.DATA,f=i.BUFFER;function l(E){if(E){var D=E.length||E.byteLength,R=n.log2(D);u[R].push(E)}}function h(E){E=n.nextPow2(E);var D=n.log2(E),R=u[D];return R.length>0?R.pop():new ArrayBuffer(E)}function d(E){return new Uint8Array(h(E),0,E)}function s(E){return new Uint16Array(h(2*E),0,E)}function x(E){return new Uint32Array(h(4*E),0,E)}function c(E){return new Int8Array(h(E),0,E)}function T(E){return new Int16Array(h(2*E),0,E)}function _(E){return new Int32Array(h(4*E),0,E)}function w(E){return new Float32Array(h(4*E),0,E)}function k(E){return new Float64Array(h(8*E),0,E)}function L(E){return r?new Uint8ClampedArray(h(E),0,E):d(E)}function A(E){return m?new BigUint64Array(h(8*E),0,E):null}function I(E){return o?new BigInt64Array(h(8*E),0,E):null}function P(E){return new DataView(h(E),0,E)}function S(E){E=n.nextPow2(E);var D=n.log2(E),R=f[D];return R.length>0?R.pop():new a(E)}y.free=function(E){if(a.isBuffer(E))f[n.log2(E.length)].push(E);else{if(Object.prototype.toString.call(E)!=="[object ArrayBuffer]"&&(E=E.buffer),!E)return;var D=E.length||E.byteLength,R=0|n.log2(D);u[R].push(E)}},y.freeUint8=y.freeUint16=y.freeUint32=y.freeBigUint64=y.freeInt8=y.freeInt16=y.freeInt32=y.freeBigInt64=y.freeFloat32=y.freeFloat=y.freeFloat64=y.freeDouble=y.freeUint8Clamped=y.freeDataView=function(E){l(E.buffer)},y.freeArrayBuffer=l,y.freeBuffer=function(E){f[n.log2(E.length)].push(E)},y.malloc=function(E,D){if(D===void 0||D==="arraybuffer")return h(E);switch(D){case"uint8":return d(E);case"uint16":return s(E);case"uint32":return x(E);case"int8":return c(E);case"int16":return T(E);case"int32":return _(E);case"float":case"float32":return w(E);case"double":case"float64":return k(E);case"uint8_clamped":return L(E);case"bigint64":return I(E);case"biguint64":return A(E);case"buffer":return S(E);case"data":case"dataview":return P(E);default:return null}return null},y.mallocArrayBuffer=h,y.mallocUint8=d,y.mallocUint16=s,y.mallocUint32=x,y.mallocInt8=c,y.mallocInt16=T,y.mallocInt32=_,y.mallocFloat32=y.mallocFloat=w,y.mallocFloat64=y.mallocDouble=k,y.mallocUint8Clamped=L,y.mallocBigUint64=A,y.mallocBigInt64=I,y.mallocDataView=P,y.mallocBuffer=S,y.clearCache=function(){for(var E=0;E<32;++E)i.UINT8[E].length=0,i.UINT16[E].length=0,i.UINT32[E].length=0,i.INT8[E].length=0,i.INT16[E].length=0,i.INT32[E].length=0,i.FLOAT[E].length=0,i.DOUBLE[E].length=0,i.BIGUINT64[E].length=0,i.BIGINT64[E].length=0,i.UINT8C[E].length=0,u[E].length=0,f[E].length=0}}).call(this)}).call(this,p!==void 0?p:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(g,b,y){function e(t){this.roots=new Array(t),this.ranks=new Array(t);for(var a=0;a<t;++a)this.roots[a]=a,this.ranks[a]=0}b.exports=e;var n=e.prototype;Object.defineProperty(n,"length",{get:function(){return this.roots.length}}),n.makeSet=function(){var t=this.roots.length;return this.roots.push(t),this.ranks.push(0),t},n.find=function(t){for(var a=t,r=this.roots;r[t]!==t;)t=r[t];for(;r[a]!==t;){var m=r[a];r[a]=t,a=m}return t},n.link=function(t,a){var r=this.find(t),m=this.find(a);if(r!==m){var o=this.ranks,i=this.roots,u=o[r],f=o[m];u<f?i[r]=m:f<u?i[m]=r:(i[m]=r,++o[r])}}},{}],310:[function(g,b,y){b.exports=function(e,n,t){return e.length===0?e:n?(t||e.sort(n),function(a,r){for(var m=1,o=a.length,i=a[0],u=a[0],f=1;f<o;++f)if(u=i,r(i=a[f],u)){if(f===m){m++;continue}a[m++]=i}return a.length=m,a}(e,n)):(t||e.sort(),function(a){for(var r=1,m=a.length,o=a[0],i=a[0],u=1;u<m;++u,i=o)if(i=o,(o=a[u])!==i){if(u===r){r++;continue}a[r++]=o}return a.length=r,a}(e))}},{}],311:[function(g,b,y){b.exports=function(a,r){return typeof r=="object"&&r!==null||(r={}),e(a,r.canvas||n,r.context||t,r)};var e=g("./lib/vtext"),n=null,t=null;typeof document<"u"&&((n=document.createElement("canvas")).width=8192,n.height=1024,t=n.getContext("2d"))},{"./lib/vtext":312}],312:[function(g,b,y){b.exports=function(l,h,d,s){var x=64,c=1.25,T={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return s&&(s.size&&s.size>0&&(x=s.size),s.lineSpacing&&s.lineSpacing>0&&(c=s.lineSpacing),s.styletags&&s.styletags.breaklines&&(T.breaklines=!!s.styletags.breaklines),s.styletags&&s.styletags.bolds&&(T.bolds=!!s.styletags.bolds),s.styletags&&s.styletags.italics&&(T.italics=!!s.styletags.italics),s.styletags&&s.styletags.subscripts&&(T.subscripts=!!s.styletags.subscripts),s.styletags&&s.styletags.superscripts&&(T.superscripts=!!s.styletags.superscripts)),d.font=[s.fontStyle,s.fontVariant,s.fontWeight,x+"px",s.font].filter(function(_){return _}).join(" "),d.textAlign="start",d.textBaseline="alphabetic",d.direction="ltr",f(function(_,w,k,L,A,I){k=k.replace(/\n/g,""),k=I.breaklines===!0?k.replace(/\<br\>/g,`
`):k.replace(/\<br\>/g," ");var P="",S=[];for(H=0;H<k.length;++H)S[H]=P;I.bolds===!0&&(S=o("b","b|",k,S)),I.italics===!0&&(S=o("i","i|",k,S)),I.superscripts===!0&&(S=o("sup","+1",k,S)),I.subscripts===!0&&(S=o("sub","-1",k,S));var E=[],D="";for(H=0;H<k.length;++H)S[H]!==null&&(D+=k[H],E.push(S[H]));var R,H,V,X,$,G=D.split(`
`),W=G.length,te=Math.round(A*L),N=L,B=2*L,U=0,ee=W*te+B;_.height<ee&&(_.height=ee),w.fillStyle="#000",w.fillRect(0,0,_.width,_.height),w.fillStyle="#fff";var j=0,Q="";function K(){if(Q!==""){var Te=w.measureText(Q).width;w.fillText(Q,N+V,B+X),V+=Te}}function re(){return Math.round($)+"px "}function ne(Te,_e){var be=""+w.font;if(I.subscripts===!0){var Ce=Te.indexOf("-"),fe=_e.indexOf("-"),ve=Ce>-1?parseInt(Te[1+Ce]):0,Me=fe>-1?parseInt(_e[1+fe]):0;ve!==Me&&(be=be.replace(re(),"?px "),$*=Math.pow(.75,Me-ve),be=be.replace("?px ",re())),X+=.25*te*(Me-ve)}if(I.superscripts===!0){var ke=Te.indexOf("+"),Le=_e.indexOf("+"),ze=ke>-1?parseInt(Te[1+ke]):0,Re=Le>-1?parseInt(_e[1+Le]):0;ze!==Re&&(be=be.replace(re(),"?px "),$*=Math.pow(.75,Re-ze),be=be.replace("?px ",re())),X-=.25*te*(Re-ze)}if(I.bolds===!0){var Oe=Te.indexOf("b|")>-1,Ze=_e.indexOf("b|")>-1;!Oe&&Ze&&(be=Pe?be.replace("italic ","italic bold "):"bold "+be),Oe&&!Ze&&(be=be.replace("bold ",""))}if(I.italics===!0){var Pe=Te.indexOf("i|")>-1,Ie=_e.indexOf("i|")>-1;!Pe&&Ie&&(be="italic "+be),Pe&&!Ie&&(be=be.replace("italic ",""))}w.font=be}for(R=0;R<W;++R){var le=G[R]+`
`;for(V=0,X=R*te,$=L,Q="",H=0;H<le.length;++H){var oe=H+j<E.length?E[H+j]:E[E.length-1];P===oe?Q+=le[H]:(K(),Q=le[H],oe!==void 0&&(ne(P,oe),P=oe))}K(),j+=le.length;var de=0|Math.round(V+2*N);U<de&&(U=de)}var se=U,me=B+te*W;return n(w.getImageData(0,0,se,me).data,[me,se,4]).pick(-1,-1,0).transpose(1,0)}(h,d,l,x,c,T),s,x)},b.exports.processPixels=f;var e=g("surface-nets"),n=g("ndarray"),t=g("simplify-planar-graph"),a=g("clean-pslg"),r=g("cdt2d"),m=g("planar-graph-to-polyline");function o(l,h,d,s){for(var x="<"+l+">",c="</"+l+">",T=x.length,_=c.length,w=h[0]==="+"||h[0]==="-",k=0,L=-_;k>-1&&(k=d.indexOf(x,k))!==-1&&(L=d.indexOf(c,k+T))!==-1&&!(L<=k);){for(var A=k;A<L+_;++A)if(A<k+T||A>=L)s[A]=null,d=d.substr(0,A)+" "+d.substr(A+1);else if(s[A]!==null){var I=s[A].indexOf(h[0]);I===-1?s[A]+=h:w&&(s[A]=s[A].substr(0,I+1)+(1+parseInt(s[A][I+1]))+s[A].substr(I+2))}var P=k+T,S=d.substr(P,L-P).indexOf(x);k=S!==-1?S:L+_}return s}function i(l,h){var d=e(l,128);return h?t(d.cells,d.positions,.25):{edges:d.cells,positions:d.positions}}function u(l,h,d,s){var x=i(l,s),c=function(R,H,V){for(var X=H.textAlign||"start",$=H.textBaseline||"alphabetic",G=[1<<30,1<<30],W=[0,0],te=R.length,N=0;N<te;++N)for(var B=R[N],U=0;U<2;++U)G[U]=0|Math.min(G[U],B[U]),W[U]=0|Math.max(W[U],B[U]);var ee=0;switch(X){case"center":ee=-.5*(G[0]+W[0]);break;case"right":case"end":ee=-W[0];break;case"left":case"start":ee=-G[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+X+"'")}var j=0;switch($){case"hanging":case"top":j=-G[1];break;case"middle":j=-.5*(G[1]+W[1]);break;case"alphabetic":case"ideographic":j=-3*V;break;case"bottom":j=-W[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+$+"'")}var Q=1/V;return"lineHeight"in H?Q*=+H.lineHeight:"width"in H?Q=H.width/(W[0]-G[0]):"height"in H&&(Q=H.height/(W[1]-G[1])),R.map(function(K){return[Q*(K[0]+ee),Q*(K[1]+j)]})}(x.positions,h,d),T=x.edges,_=h.orientation==="ccw";if(a(c,T),h.polygons||h.polygon||h.polyline){for(var w=m(T,c),k=new Array(w.length),L=0;L<w.length;++L){for(var A=w[L],I=new Array(A.length),P=0;P<A.length;++P){for(var S=A[P],E=new Array(S.length),D=0;D<S.length;++D)E[D]=c[S[D]].slice();_&&E.reverse(),I[P]=E}k[L]=I}return k}return h.triangles||h.triangulate||h.triangle?{cells:r(c,T,{delaunay:!1,exterior:!1,interior:!0}),positions:c}:{edges:T,positions:c}}function f(l,h,d){try{return u(l,h,d,!0)}catch{}try{return u(l,h,d,!1)}catch{}return h.polygons||h.polyline||h.polygon?[]:h.triangles||h.triangulate||h.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(g,b,y){(function(){if(typeof ses>"u"||!ses.ok||ses.ok()){typeof ses<"u"&&(ses.weakMapPermitHostObjects=x);var e=!1;if(typeof WeakMap=="function"){var n=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var t=new n,a=Object.freeze({});if(t.set(a,1),t.get(a)===1)return void(b.exports=WeakMap);e=!0}}var r=Object.getOwnPropertyNames,m=Object.defineProperty,o=Object.isExtensible,i="weakmap:ident:"+Math.random()+"___";if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var u=new ArrayBuffer(25),f=new Uint8Array(u);crypto.getRandomValues(f),i="weakmap:rand:"+Array.prototype.map.call(f,function(k){return(k%36).toString(36)}).join("")+"___"}if(m(Object,"getOwnPropertyNames",{value:function(k){return r(k).filter(c)}}),"getPropertyNames"in Object){var l=Object.getPropertyNames;m(Object,"getPropertyNames",{value:function(k){return l(k).filter(c)}})}(function(){var k=Object.freeze;m(Object,"freeze",{value:function(I){return T(I),k(I)}});var L=Object.seal;m(Object,"seal",{value:function(I){return T(I),L(I)}});var A=Object.preventExtensions;m(Object,"preventExtensions",{value:function(I){return T(I),A(I)}})})();var h=!1,d=0,s=function(){this instanceof s||w();var k=[],L=[],A=d++;return Object.create(s.prototype,{get___:{value:_(function(I,P){var S,E=T(I);return E?A in E?E[A]:P:(S=k.indexOf(I))>=0?L[S]:P})},has___:{value:_(function(I){var P=T(I);return P?A in P:k.indexOf(I)>=0})},set___:{value:_(function(I,P){var S,E=T(I);return E?E[A]=P:(S=k.indexOf(I))>=0?L[S]=P:(S=k.length,L[S]=P,k[S]=I),this})},delete___:{value:_(function(I){var P,S,E=T(I);return E?A in E&&delete E[A]:!((P=k.indexOf(I))<0)&&(S=k.length-1,k[P]=void 0,L[P]=L[S],k[P]=k[S],k.length=S,L.length=S,!0)})}})};s.prototype=Object.create(Object.prototype,{get:{value:function(k,L){return this.get___(k,L)},writable:!0,configurable:!0},has:{value:function(k){return this.has___(k)},writable:!0,configurable:!0},set:{value:function(k,L){return this.set___(k,L)},writable:!0,configurable:!0},delete:{value:function(k){return this.delete___(k)},writable:!0,configurable:!0}}),typeof n=="function"?function(){function k(){this instanceof s||w();var L,A=new n,I=void 0,P=!1;return L=e?function(S,E){return A.set(S,E),A.has(S)||(I||(I=new s),I.set(S,E)),this}:function(S,E){if(P)try{A.set(S,E)}catch{I||(I=new s),I.set___(S,E)}else A.set(S,E);return this},Object.create(s.prototype,{get___:{value:_(function(S,E){return I?A.has(S)?A.get(S):I.get___(S,E):A.get(S,E)})},has___:{value:_(function(S){return A.has(S)||!!I&&I.has___(S)})},set___:{value:_(L)},delete___:{value:_(function(S){var E=!!A.delete(S);return I&&I.delete___(S)||E})},permitHostObjects___:{value:_(function(S){if(S!==x)throw new Error("bogus call to permitHostObjects___");P=!0})}})}e&&typeof Proxy<"u"&&(Proxy=void 0),k.prototype=s.prototype,b.exports=k,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),b.exports=s)}function x(k){k.permitHostObjects___&&k.permitHostObjects___(x)}function c(k){return!(k.substr(0,8)=="weakmap:"&&k.substr(k.length-3)==="___")}function T(k){if(k!==Object(k))throw new TypeError("Not an object: "+k);var L=k[i];if(L&&L.key===k)return L;if(o(k)){L={key:k};try{return m(k,i,{value:L,writable:!1,enumerable:!1,configurable:!1}),L}catch{return}}}function _(k){return k.prototype=null,Object.freeze(k)}function w(){h||typeof console>"u"||(h=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}})()},{}],314:[function(g,b,y){var e=g("./hidden-store.js");b.exports=function(){var n={};return function(t){if((typeof t!="object"||t===null)&&typeof t!="function")throw new Error("Weakmap-shim: Key must be object");var a=t.valueOf(n);return a&&a.identity===n?a:e(t,n)}}},{"./hidden-store.js":315}],315:[function(g,b,y){b.exports=function(e,n){var t={identity:n},a=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(r){return r!==n?a.apply(this,arguments):t},writable:!0}),t}},{}],316:[function(g,b,y){var e=g("./create-store.js");b.exports=function(){var n=e();return{get:function(t,a){var r=n(t);return r.hasOwnProperty("value")?r.value:a},set:function(t,a){return n(t).value=a,this},has:function(t){return"value"in n(t)},delete:function(t){return delete n(t).value}}}},{"./create-store.js":314}],317:[function(g,b,y){var e,n=function(){return function(t,a,r,m,o,i){var u=t[0],f=r[0],l=[0],h=f;m|=0;var d=0,s=f;for(d=0;d<u;++d){var x=a[m]-i,c=a[m+h]-i;x>=0!=c>=0&&o.push(l[0]+.5+.5*(x+c)/(x-c)),m+=s,++l[0]}}};b.exports=(e={funcName:"zeroCrossings"},function(t){var a={};return function(r,m,o){var i=r.dtype,u=r.order,f=[i,u.join()].join(),l=a[f];return l||(a[f]=l=t([i,u])),l(r.shape.slice(0),r.data,r.stride,0|r.offset,m,o)}}(n.bind(void 0,e)))},{}],318:[function(g,b,y){b.exports=function(n,t){var a=[];return t=+t||0,e(n.hi(n.shape[0]-1),a,t),a};var e=g("./lib/zc-core")},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,typeof Wi<"u"?Wi:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[27])(27)})})(Dp);const _p=em(Dp.exports);function tm(rr){let ar;return{c(){ar=fi("div")},m(v,J){xo(v,ar,J),rr[2](ar)},p:Ss,i:Ss,o:Ss,d(v){v&&$i(ar),rr[2](null)}}}function rm(rr,ar,v){let J,{data:Z}=ar,p=[];function g(){p.splice(Z.length),Z.forEach((y,e)=>{p[e]=y}),_p.redraw(J)}S0(()=>{let y={margin:{l:0,r:0,b:0,t:0},width:900,height:800};_p.newPlot(J,p,y)});function b(y){gc[y?"unshift":"push"](()=>{J=y,v(0,J)})}return rr.$$set=y=>{"data"in y&&v(1,Z=y.data)},rr.$$.update=()=>{rr.$$.dirty&3&&(v(1,Z),v(0,J),J&&g())},[J,Z,b]}class nm extends Ul{constructor(ar){super(),jl(this,ar,rm,tm,Nl,{data:1})}}const Af=210;function am(rr){const ar=new Array(rr);for(let v=0;v<rr;v++){const J=Sf(),Z=Sf();let p;J>Af&&Z>Af?p=Math.round(Math.random()*Af):p=Sf(),ar[v]=`rgb(${J}, ${Z}, ${p})`}return ar}function Sf(){return Math.round(Math.random()*255)}function im(rr){let ar,v,J,Z,p,g,b,y,e,n,t;function a(i){rr[9](i)}function r(i){rr[10](i)}function m(i){rr[11](i)}let o={};return rr[3]!==void 0&&(o.visualizationStatus=rr[3]),rr[0]!==void 0&&(o.showPlanes=rr[0]),rr[1]!==void 0&&(o.colorizePoints=rr[1]),ar=new $0({props:o}),gc.push(()=>Mf(ar,"visualizationStatus",a)),gc.push(()=>Mf(ar,"showPlanes",r)),gc.push(()=>Mf(ar,"colorizePoints",m)),y=new J0({props:{evaluation:rr[2]}}),y.$on("partitionEvent",rr[6]),y.$on("display",rr[5]),n=new nm({props:{data:rr[4]}}),{c(){Fl(ar.$$.fragment),p=gs(),g=fi("div"),b=fi("div"),Fl(y.$$.fragment),e=gs(),Fl(n.$$.fragment),li(g,"class","container svelte-1nyikog")},m(i,u){_l(ar,i,u),xo(i,p,u),xo(i,g,u),Ga(g,b),_l(y,b,null),Ga(g,e),_l(n,g,null),t=!0},p(i,[u]){const f={};!v&&u&8&&(v=!0,f.visualizationStatus=i[3],wf(()=>v=!1)),!J&&u&1&&(J=!0,f.showPlanes=i[0],wf(()=>J=!1)),!Z&&u&2&&(Z=!0,f.colorizePoints=i[1],wf(()=>Z=!1)),ar.$set(f);const l={};u&4&&(l.evaluation=i[2]),y.$set(l);const h={};u&16&&(h.data=i[4]),n.$set(h)},i(i){t||(Hs(ar.$$.fragment,i),Hs(y.$$.fragment,i),Hs(n.$$.fragment,i),t=!0)},o(i){ol(ar.$$.fragment,i),ol(y.$$.fragment,i),ol(n.$$.fragment,i),t=!1},d(i){wl(ar,i),i&&$i(p),i&&$i(g),wl(y),wl(n)}}}function om(rr,ar,v){let J,Z,p,g=[],b="ready",y=!0,e=!1,n=[],t=[];const a=new j0({X:-1,Y:-1,Z:-1},2,2,2);function r(){m(),g=[],v(2,p=null)}function m(){v(8,t=[])}function o(){m(),!(g==null||g.length===0)&&v(8,t=g.map(x=>({type:"mesh3d",x:x.map(c=>c.X),y:x.map(c=>c.Y),z:x.map(c=>c.Z),i:Array(x.length-2).fill(0),j:[...Array(x.length-2).keys()].map(c=>c+1),k:[...Array(x.length-2).keys()].map(c=>c+2),alphahull:5,opacity:.4,color:"rgb(200,100,300)"})))}function i(x){r();const{numOfPlanes:c,pointsPerPlane:T,mean:_,stddev:w}=x.detail;Z=D0(c,T,_,w),e?f():u()}function u(){Z!=null&&v(7,n=[{x:Z.Points.map(x=>x.X),y:Z.Points.map(x=>x.Y),z:Z.Points.map(x=>x.Z),mode:"markers",marker:{color:"rgb(0, 0, 225)",size:12,line:{color:"rgba(217, 217, 217, 0.14)",width:.5},opacity:.8},type:"scatter3d"}])}function f(){if(Z==null)return;const x=Z.Points.length/Z.NumOfPlanes,c=am(Z.NumOfPlanes),T=new Array(Z.NumOfPlanes);for(let _=0;_<Z.NumOfPlanes;_++){const w=Z.Points.slice(_*x,(_+1)*x);T[_]={x:w.map(k=>k.X),y:w.map(k=>k.Y),z:w.map(k=>k.Z),mode:"markers",marker:{color:c[_],size:12,line:{color:"rgba(217, 217, 217, 0.14)",width:.5},opacity:.8},type:"scatter3d"}}v(7,n=T)}async function l(x){if(Z==null)return;v(3,b="computing");const{algorithm:c,threshold:T,amplification:_}=x.detail;await E0(),setTimeout(()=>{v(2,p=R0(c,T,_)),g=p.ComputedPlanes.map(w=>a.planeIntersectSorted(w,0)),v(3,b="ready"),y&&o()},10)}function h(x){b=x,v(3,b)}function d(x){y=x,v(0,y)}function s(x){e=x,v(1,e)}return rr.$$.update=()=>{rr.$$.dirty&2&&(v(7,n=[]),e?f():u()),rr.$$.dirty&1&&(y?o():v(8,t=[])),rr.$$.dirty&384&&v(4,J=[{type:"scatter3d",mode:"lines",x:[-1,1,1,-1,-1,-1,1,1,-1,-1,-1,-1,1,1,1,1],y:[1,1,-1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,1],z:[-1,-1,-1,-1,-1,1,1,1,1,1,1,-1,-1,1,1,-1]},...n,...t])},[y,e,p,b,J,i,l,n,t,h,d,s]}class sm extends Ul{constructor(ar){super(),jl(this,ar,om,im,Nl,{})}}function lm(rr){let ar,v,J,Z,p;return Z=new sm({}),{c(){ar=fi("main"),v=fi("a"),v.innerHTML='<svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>',J=gs(),Fl(Z.$$.fragment),li(v,"class","github svelte-j6omrx"),li(v,"href","https://github.com/JlsBssmnn/local-search-algorithm-for-cubic-clustering"),li(v,"target","_blank")},m(g,b){xo(g,ar,b),Ga(ar,v),Ga(ar,J),_l(Z,ar,null),p=!0},p:Ss,i(g){p||(Hs(Z.$$.fragment,g),p=!0)},o(g){ol(Z.$$.fragment,g),p=!1},d(g){g&&$i(ar),wl(Z)}}}class cm extends Ul{constructor(ar){super(),jl(this,ar,null,lm,Nl,{})}}new cm({target:document.getElementById("app")});
